run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 13-42-26', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 13-42-26
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 2.175  loss:2.175,stance loss: 1.6603 
Train step: 10 acc:0.28409 total_loss: 2.22  loss:2.3333,stance loss: 2.3372 
Better F1! Saving model!
Saving model of best f1: 0.023121387283236993
              precision    recall  f1-score   support

           0   0.025000  0.307692  0.046243        26
           1   0.045082  0.054187  0.049217       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.033688       564
   macro avg   0.023361  0.120626  0.031820       564
weighted avg   0.017379  0.033688  0.019846       564

Test Acc: 0.03368794326241135 F1_ma:0.023121387283236993
Train step: 20 acc:0.32143 total_loss: 2.1681  loss:1.7151,stance loss: 1.0657 
Better F1! Saving model!
Saving model of best f1: 0.024930747922437674
              precision    recall  f1-score   support

           0   0.026866  0.346154  0.049861        26
           1   0.039301  0.044335  0.041667       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.031915       564
   macro avg   0.022056  0.130163  0.030509       564
weighted avg   0.015384  0.031915  0.017296       564

Test Acc: 0.031914893617021274 F1_ma:0.024930747922437674
Train step: 30 acc:0.35484 total_loss: 2.1695  loss:2.037,stance loss: 1.7485 
Better F1! Saving model!
Saving model of best f1: 0.0325
              precision    recall  f1-score   support

           0   0.034759  0.500000  0.065000        26
           1   0.031579  0.029557  0.030534       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.033688       564
   macro avg   0.022113  0.176519  0.031845       564
weighted avg   0.012969  0.033688  0.013987       564

Test Acc: 0.03368794326241135 F1_ma:0.0325
Train step: 40 acc:0.39024 total_loss: 2.1917  loss:1.8447,stance loss: 1.0159 
Better F1! Saving model!
Saving model of best f1: 0.04488330341113106
              precision    recall  f1-score   support

           0   0.047081  0.961538  0.089767        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.044326       564
   macro avg   0.015694  0.320513  0.029922       564
weighted avg   0.002170  0.044326  0.004138       564

Test Acc: 0.044326241134751775 F1_ma:0.04488330341113106
Train step: 50 acc:0.40686 total_loss: 2.1455  loss:2.6406,stance loss: 2.8102 
Train step: 60 acc:0.42623 total_loss: 2.068  loss:1.6864,stance loss: 1.2323 
Train step: 70 acc:0.44366 total_loss: 2.0154  loss:1.5932,stance loss: 1.1486 
Train step: 80 acc:0.4591 total_loss: 1.964  loss:1.5438,stance loss: 1.1304 
Train step: 90 acc:0.46223 total_loss: 1.9306  loss:1.635,stance loss: 1.1049 
Train step: 100 acc:0.46782 total_loss: 1.9048  loss:2.0421,stance loss: 1.7827 
Train step: 110 acc:0.47804 total_loss: 1.8785  loss:1.5003,stance loss: 1.0586 
Train step: 120 acc:0.48399 total_loss: 1.8571  loss:1.7398,stance loss: 1.2068 
Train step: 130 acc:0.48998 total_loss: 1.8347  loss:1.8668,stance loss: 1.2361 
Train step: 140 acc:0.49246 total_loss: 1.8202  loss:1.4872,stance loss: 1.0688 
Train step: 150 acc:0.49752 total_loss: 1.8019  loss:1.6915,stance loss: 1.1893 
Train step: 160 acc:0.50116 total_loss: 1.7893  loss:1.6442,stance loss: 1.6331 
Train step: 170 acc:0.50475 total_loss: 1.7786  loss:1.7546,stance loss: 1.6856 
Train step: 180 acc:0.5076 total_loss: 1.7682  loss:1.6204,stance loss: 1.0921 
Train step: 190 acc:0.50949 total_loss: 1.759  loss:1.7641,stance loss: 1.2352 
Train step: 200 acc:0.50995 total_loss: 1.7501  loss:1.5739,stance loss: 1.1175 
Train step: 210 acc:0.51214 total_loss: 1.7413  loss:1.8306,stance loss: 1.2357 
Train step: 220 acc:0.51131 total_loss: 1.7349  loss:1.1882,stance loss: 0.67405 
Train step: 230 acc:0.51353 total_loss: 1.726  loss:1.2822,stance loss: 0.70097 
Train step: 240 acc:0.51841 total_loss: 1.7159  loss:1.5989,stance loss: 1.1017 
Train step: 250 acc:0.51693 total_loss: 1.7145  loss:1.6563,stance loss: 1.197 
Train step: 260 acc:0.5194 total_loss: 1.7069  loss:1.5831,stance loss: 1.1325 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.375 total_loss: 1.5775  loss:1.5775,stance loss: 1.0907 
Train step: 280 acc:0.53409 total_loss: 1.4843  loss:1.8657,stance loss: 1.1959 
Train step: 290 acc:0.52381 total_loss: 1.5314  loss:1.5338,stance loss: 1.1692 
Train step: 300 acc:0.52621 total_loss: 1.5504  loss:1.5004,stance loss: 1.1318 
Train step: 310 acc:0.53354 total_loss: 1.5612  loss:1.6682,stance loss: 1.2527 
Train step: 320 acc:0.54289 total_loss: 1.5563  loss:1.6832,stance loss: 1.1747 
Train step: 330 acc:0.54201 total_loss: 1.5488  loss:1.3037,stance loss: 1.1105 
Train step: 340 acc:0.55722 total_loss: 1.5356  loss:1.538,stance loss: 1.0757 
Train step: 350 acc:0.55324 total_loss: 1.5391  loss:1.7825,stance loss: 1.2394 
Train step: 360 acc:0.55838 total_loss: 1.5297  loss:1.5408,stance loss: 1.1146 
Train step: 370 acc:0.55384 total_loss: 1.54  loss:1.6201,stance loss: 1.5884 
Train step: 380 acc:0.55462 total_loss: 1.5354  loss:1.9294,stance loss: 1.771 
Train step: 390 acc:0.55165 total_loss: 1.5369  loss:1.4019,stance loss: 0.98484 
Train step: 400 acc:0.54914 total_loss: 1.5394  loss:1.2884,stance loss: 0.87796 
Train step: 410 acc:0.55053 total_loss: 1.5382  loss:1.415,stance loss: 1.1267 
Train step: 420 acc:0.55381 total_loss: 1.5361  loss:1.561,stance loss: 1.5581 
Train step: 430 acc:0.55318 total_loss: 1.534  loss:1.3552,stance loss: 1.0402 
Train step: 440 acc:0.55556 total_loss: 1.5282  loss:1.5243,stance loss: 1.2163 
Train step: 450 acc:0.55663 total_loss: 1.5266  loss:1.2678,stance loss: 0.94879 
Train step: 460 acc:0.55563 total_loss: 1.5219  loss:1.2891,stance loss: 0.77793 
Train step: 470 acc:0.5541 total_loss: 1.5179  loss:1.4154,stance loss: 0.89893 
Train step: 480 acc:0.55658 total_loss: 1.5114  loss:1.3761,stance loss: 1.1648 
Train step: 490 acc:0.55826 total_loss: 1.5071  loss:1.275,stance loss: 0.9923 
Better F1! Saving model!
Saving model of best f1: 0.04528985507246377
              precision    recall  f1-score   support

           0   0.047529  0.961538  0.090580        26
           1   0.894737  0.167488  0.282158       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.104610       564
   macro avg   0.314088  0.376342  0.124246       564
weighted avg   0.324233  0.104610  0.105732       564

Test Acc: 0.10460992907801418 F1_ma:0.04528985507246377
Train step: 500 acc:0.55682 total_loss: 1.5051  loss:1.4991,stance loss: 1.1438 
Train step: 510 acc:0.55602 total_loss: 1.5111  loss:1.8189,stance loss: 1.7927 
Better F1! Saving model!
Saving model of best f1: 0.04553415061295973
              precision    recall  f1-score   support

           0   0.047706  1.000000  0.091068        26
           1   0.894737  0.083744  0.153153       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.076241       564
   macro avg   0.314148  0.361248  0.081407       564
weighted avg   0.324241  0.076241  0.059322       564

Test Acc: 0.07624113475177305 F1_ma:0.04553415061295973
Train step: 520 acc:0.55702 total_loss: 1.5047  loss:1.3251,stance loss: 0.96585 
Train step: 530 acc:0.55627 total_loss: 1.5044  loss:1.239,stance loss: 0.89733 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.5625 total_loss: 1.5237  loss:1.5237,stance loss: 1.1569 
Train step: 550 acc:0.53409 total_loss: 1.5666  loss:1.3753,stance loss: 1.0282 
Train step: 560 acc:0.52976 total_loss: 1.5411  loss:1.2896,stance loss: 0.94669 
Train step: 570 acc:0.54839 total_loss: 1.531  loss:1.5602,stance loss: 1.1606 
Train step: 580 acc:0.54421 total_loss: 1.5129  loss:1.3992,stance loss: 1.0558 
Train step: 590 acc:0.55515 total_loss: 1.4908  loss:1.5101,stance loss: 1.4921 
Train step: 600 acc:0.55225 total_loss: 1.4825  loss:1.0621,stance loss: 0.64694 
Train step: 610 acc:0.55634 total_loss: 1.4811  loss:1.6198,stance loss: 1.16 
Train step: 620 acc:0.56404 total_loss: 1.4685  loss:1.5403,stance loss: 1.1436 
Train step: 630 acc:0.56799 total_loss: 1.4635  loss:1.79,stance loss: 1.8149 
Train step: 640 acc:0.57178 total_loss: 1.461  loss:0.95765,stance loss: 0.42859 
Train step: 650 acc:0.57601 total_loss: 1.4557  loss:1.3166,stance loss: 0.9678 
Train step: 660 acc:0.57696 total_loss: 1.4506  loss:1.3828,stance loss: 1.0134 
Train step: 670 acc:0.57729 total_loss: 1.4449  loss:1.2282,stance loss: 0.79273 
Train step: 680 acc:0.57713 total_loss: 1.4424  loss:1.4625,stance loss: 1.4914 
Train step: 690 acc:0.57823 total_loss: 1.4451  loss:1.7298,stance loss: 1.7434 
Better F1! Saving model!
Saving model of best f1: 0.05025125628140704
              precision    recall  f1-score   support

           0   0.053763  0.769231  0.100503        26
           1   0.765625  0.724138  0.744304       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.296099       564
   macro avg   0.273129  0.497790  0.281602       564
weighted avg   0.278049  0.296099  0.272530       564

Test Acc: 0.29609929078014185 F1_ma:0.05025125628140704
Train step: 700 acc:0.57803 total_loss: 1.4468  loss:1.652,stance loss: 1.1233 
Better F1! Saving model!
Saving model of best f1: 0.052054794520547946
              precision    recall  f1-score   support

           0   0.056047  0.730769  0.104110        26
           1   0.742222  0.822660  0.780374       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.329787       564
   macro avg   0.266090  0.517810  0.294828       564
weighted avg   0.269731  0.329787  0.285679       564

Test Acc: 0.32978723404255317 F1_ma:0.052054794520547946
Train step: 710 acc:0.58187 total_loss: 1.4393  loss:1.3473,stance loss: 0.93441 
Train step: 720 acc:0.58287 total_loss: 1.4323  loss:1.4891,stance loss: 1.022 
Train step: 730 acc:0.5805 total_loss: 1.4316  loss:1.1895,stance loss: 0.74054 
Train step: 740 acc:0.57867 total_loss: 1.4294  loss:1.275,stance loss: 0.92256 
Train step: 750 acc:0.58146 total_loss: 1.4297  loss:1.2673,stance loss: 0.9314 
Train step: 760 acc:0.58343 total_loss: 1.4246  loss:0.8897,stance loss: 0.50023 
Train step: 770 acc:0.5836 total_loss: 1.4214  loss:1.5252,stance loss: 1.1007 
Train step: 780 acc:0.58169 total_loss: 1.4215  loss:1.5432,stance loss: 1.1273 
Train step: 790 acc:0.58441 total_loss: 1.4196  loss:1.1835,stance loss: 0.80932 
Train step: 800 acc:0.58501 total_loss: 1.4181  loss:1.7777,stance loss: 1.616 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.4375 total_loss: 1.3697  loss:1.3697,stance loss: 0.95728 
Train step: 820 acc:0.625 total_loss: 1.2891  loss:1.0759,stance loss: 0.77841 
Train step: 830 acc:0.63095 total_loss: 1.2882  loss:1.0071,stance loss: 0.60875 
Train step: 840 acc:0.64516 total_loss: 1.3102  loss:1.4902,stance loss: 1.4935 
Train step: 850 acc:0.65854 total_loss: 1.324  loss:1.2287,stance loss: 0.86059 
Train step: 860 acc:0.65319 total_loss: 1.3252  loss:1.6012,stance loss: 1.26 
Train step: 870 acc:0.64344 total_loss: 1.3401  loss:1.3121,stance loss: 0.95257 
Train step: 880 acc:0.6382 total_loss: 1.346  loss:1.369,stance loss: 1.0666 
Train step: 890 acc:0.63117 total_loss: 1.3528  loss:1.2485,stance loss: 0.90379 
Train step: 900 acc:0.625 total_loss: 1.3525  loss:0.97145,stance loss: 0.69222 
Train step: 910 acc:0.62067 total_loss: 1.3689  loss:1.3148,stance loss: 0.89214 
Train step: 920 acc:0.61824 total_loss: 1.3674  loss:1.3534,stance loss: 1.089 
Train step: 930 acc:0.61777 total_loss: 1.3709  loss:1.3076,stance loss: 1.017 
Train step: 940 acc:0.61927 total_loss: 1.372  loss:0.97653,stance loss: 0.69457 
Train step: 950 acc:0.62057 total_loss: 1.3628  loss:1.213,stance loss: 0.85503 
Better F1! Saving model!
Saving model of best f1: 0.05449591280653951
              precision    recall  f1-score   support

           0   0.058651  0.769231  0.108992        26
           1   0.739910  0.812808  0.774648       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.328014       564
   macro avg   0.266187  0.527346  0.294547       564
weighted avg   0.269019  0.328014  0.283843       564

Test Acc: 0.3280141843971631 F1_ma:0.05449591280653951
Train step: 960 acc:0.6221 total_loss: 1.3599  loss:1.4415,stance loss: 0.9707 
Train step: 970 acc:0.62578 total_loss: 1.3541  loss:1.1383,stance loss: 0.84173 
Train step: 980 acc:0.62354 total_loss: 1.3578  loss:1.2294,stance loss: 0.89243 
Better F1! Saving model!
Saving model of best f1: 0.05654761904761905
              precision    recall  f1-score   support

           0   0.061290  0.730769  0.113095        26
           1   0.724409  0.906404  0.805252       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.359929       564
   macro avg   0.261900  0.545724  0.306116       564
weighted avg   0.263561  0.359929  0.295047       564

Test Acc: 0.3599290780141844 F1_ma:0.05654761904761905
Train step: 990 acc:0.62431 total_loss: 1.3556  loss:1.1831,stance loss: 0.77358 
Train step: 1000 acc:0.62369 total_loss: 1.3569  loss:0.96578,stance loss: 0.73656 
Train step: 1010 acc:0.62531 total_loss: 1.3592  loss:1.2563,stance loss: 1.3069 
Train step: 1020 acc:0.625 total_loss: 1.3602  loss:1.1364,stance loss: 0.82815 
Train step: 1030 acc:0.62443 total_loss: 1.3596  loss:1.35,stance loss: 1.0691 
Train step: 1040 acc:0.62473 total_loss: 1.3619  loss:1.5574,stance loss: 1.5336 
Train step: 1050 acc:0.62733 total_loss: 1.359  loss:1.4263,stance loss: 1.1654 
Train step: 1060 acc:0.62898 total_loss: 1.3587  loss:1.3725,stance loss: 1.4999 
Train step: 1070 acc:0.62763 total_loss: 1.3584  loss:1.2567,stance loss: 0.89563 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.5 total_loss: 1.3211  loss:1.3211,stance loss: 1.0278 
Train step: 1090 acc:0.61932 total_loss: 1.4467  loss:1.0342,stance loss: 0.75588 
Train step: 1100 acc:0.61012 total_loss: 1.3708  loss:1.2696,stance loss: 0.79484 
Train step: 1110 acc:0.63508 total_loss: 1.3493  loss:1.3762,stance loss: 1.0116 
Train step: 1120 acc:0.64024 total_loss: 1.3276  loss:1.3314,stance loss: 0.97995 
Train step: 1130 acc:0.64461 total_loss: 1.3274  loss:1.5674,stance loss: 1.0413 
Train step: 1140 acc:0.64447 total_loss: 1.3049  loss:1.0001,stance loss: 0.5172 
Train step: 1150 acc:0.64613 total_loss: 1.302  loss:1.2924,stance loss: 0.74624 
Better F1! Saving model!
Saving model of best f1: 0.057228915662650606
              precision    recall  f1-score   support

           0   0.062092  0.730769  0.114458        26
           1   0.720930  0.916256  0.806941       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.363475       564
   macro avg   0.261007  0.549008  0.307133       564
weighted avg   0.262346  0.363475  0.295718       564

Test Acc: 0.36347517730496454 F1_ma:0.057228915662650606
Train step: 1160 acc:0.64583 total_loss: 1.3012  loss:1.0638,stance loss: 0.76808 
Train step: 1170 acc:0.65041 total_loss: 1.2956  loss:1.0005,stance loss: 0.71843 
Train step: 1180 acc:0.65347 total_loss: 1.2907  loss:1.3326,stance loss: 1.0204 
Train step: 1190 acc:0.65428 total_loss: 1.2916  loss:1.2943,stance loss: 0.91199 
Train step: 1200 acc:0.64876 total_loss: 1.2935  loss:1.0477,stance loss: 0.76666 
Train step: 1210 acc:0.64838 total_loss: 1.2928  loss:1.7604,stance loss: 1.7638 
Train step: 1220 acc:0.64628 total_loss: 1.2925  loss:1.2507,stance loss: 0.90695 
Train step: 1230 acc:0.64652 total_loss: 1.2874  loss:1.1846,stance loss: 0.84424 
Train step: 1240 acc:0.64557 total_loss: 1.2881  loss:1.4799,stance loss: 1.0951 
Train step: 1250 acc:0.64474 total_loss: 1.2945  loss:0.93873,stance loss: 0.66704 
Train step: 1260 acc:0.64365 total_loss: 1.2951  loss:0.95548,stance loss: 0.69013 
Train step: 1270 acc:0.64267 total_loss: 1.2939  loss:1.0798,stance loss: 0.75752 
Train step: 1280 acc:0.64397 total_loss: 1.2883  loss:1.3475,stance loss: 0.86179 
Train step: 1290 acc:0.64366 total_loss: 1.284  loss:1.3049,stance loss: 0.89436 
Train step: 1300 acc:0.64508 total_loss: 1.2821  loss:1.1733,stance loss: 0.90598 
Train step: 1310 acc:0.6434 total_loss: 1.283  loss:1.2067,stance loss: 0.88353 
Train step: 1320 acc:0.64186 total_loss: 1.2847  loss:1.3494,stance loss: 1.0549 
Train step: 1330 acc:0.64268 total_loss: 1.281  loss:1.3588,stance loss: 0.85861 
Train step: 1340 acc:0.6432 total_loss: 1.2785  loss:1.3991,stance loss: 0.96644 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.625 total_loss: 1.4453  loss:1.4453,stance loss: 1.1933 
Train step: 1360 acc:0.64773 total_loss: 1.192  loss:1.018,stance loss: 0.774 
Train step: 1370 acc:0.625 total_loss: 1.1988  loss:1.3587,stance loss: 1.0576 
Train step: 1380 acc:0.62702 total_loss: 1.2134  loss:1.1287,stance loss: 0.93273 
Train step: 1390 acc:0.62652 total_loss: 1.2164  loss:1.2968,stance loss: 1.3467 
Train step: 1400 acc:0.62745 total_loss: 1.2202  loss:1.0918,stance loss: 0.79886 
Train step: 1410 acc:0.63832 total_loss: 1.2111  loss:1.236,stance loss: 0.97081 
Train step: 1420 acc:0.64525 total_loss: 1.2184  loss:1.3626,stance loss: 1.5697 
Train step: 1430 acc:0.6466 total_loss: 1.2308  loss:1.5028,stance loss: 1.7292 
Train step: 1440 acc:0.6456 total_loss: 1.2285  loss:1.1635,stance loss: 0.89539 
Train step: 1450 acc:0.64975 total_loss: 1.2274  loss:1.0452,stance loss: 0.83838 
Train step: 1460 acc:0.64471 total_loss: 1.2358  loss:1.2082,stance loss: 0.90373 
Train step: 1470 acc:0.64979 total_loss: 1.225  loss:0.69514,stance loss: 0.34505 
Train step: 1480 acc:0.64981 total_loss: 1.2245  loss:1.7385,stance loss: 1.9699 
Train step: 1490 acc:0.65027 total_loss: 1.2304  loss:1.3302,stance loss: 1.4482 
Train step: 1500 acc:0.65439 total_loss: 1.2255  loss:0.7972,stance loss: 0.51481 
Train step: 1510 acc:0.65295 total_loss: 1.2328  loss:1.091,stance loss: 0.86061 
Train step: 1520 acc:0.65205 total_loss: 1.2341  loss:1.3068,stance loss: 1.4357 
Train step: 1530 acc:0.65159 total_loss: 1.2354  loss:1.4332,stance loss: 1.6599 
Train step: 1540 acc:0.65412 total_loss: 1.2349  loss:1.0516,stance loss: 0.80552 
Train step: 1550 acc:0.6533 total_loss: 1.2373  loss:1.0899,stance loss: 0.8338 
Train step: 1560 acc:0.6561 total_loss: 1.2332  loss:1.3993,stance loss: 1.1401 
Train step: 1570 acc:0.65611 total_loss: 1.23  loss:1.0414,stance loss: 0.82361 
Train step: 1580 acc:0.65855 total_loss: 1.2273  loss:1.0661,stance loss: 1.1912 
Train step: 1590 acc:0.65871 total_loss: 1.2258  loss:1.0773,stance loss: 0.8083 
Train step: 1600 acc:0.65737 total_loss: 1.2312  loss:1.7196,stance loss: 1.8144 
Train step: 1610 acc:0.65781 total_loss: 1.231  loss:0.75264,stance loss: 0.52163 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.875 total_loss: 1.1172  loss:1.1172,stance loss: 1.28 
Train step: 1630 acc:0.66477 total_loss: 1.0941  loss:1.1591,stance loss: 0.85433 
Train step: 1640 acc:0.65476 total_loss: 1.1772  loss:1.4859,stance loss: 1.175 
Train step: 1650 acc:0.66935 total_loss: 1.1626  loss:1.2257,stance loss: 1.3333 
Train step: 1660 acc:0.66311 total_loss: 1.1611  loss:1.2237,stance loss: 0.77085 
Train step: 1670 acc:0.67402 total_loss: 1.1544  loss:1.1098,stance loss: 0.85838 
Train step: 1680 acc:0.66906 total_loss: 1.1696  loss:1.1714,stance loss: 0.91319 
Train step: 1690 acc:0.66725 total_loss: 1.1774  loss:1.3714,stance loss: 1.5219 
Train step: 1700 acc:0.66975 total_loss: 1.1713  loss:1.2812,stance loss: 1.4284 
Train step: 1710 acc:0.6717 total_loss: 1.1826  loss:1.1181,stance loss: 0.87401 
Train step: 1720 acc:0.68255 total_loss: 1.1649  loss:1.0304,stance loss: 0.80744 
Train step: 1730 acc:0.67849 total_loss: 1.171  loss:1.0246,stance loss: 0.81701 
Train step: 1740 acc:0.67769 total_loss: 1.172  loss:1.0288,stance loss: 0.77039 
Train step: 1750 acc:0.67748 total_loss: 1.1684  loss:1.0098,stance loss: 0.72852 
Train step: 1760 acc:0.68262 total_loss: 1.1665  loss:1.2993,stance loss: 1.4139 
Train step: 1770 acc:0.68295 total_loss: 1.1659  loss:1.1959,stance loss: 0.95059 
Train step: 1780 acc:0.68323 total_loss: 1.1696  loss:1.1567,stance loss: 0.81181 
Train step: 1790 acc:0.67909 total_loss: 1.177  loss:1.1227,stance loss: 0.84601 
Train step: 1800 acc:0.67852 total_loss: 1.1777  loss:1.2267,stance loss: 0.83187 
Train step: 1810 acc:0.67441 total_loss: 1.1833  loss:1.076,stance loss: 0.76807 
Better F1! Saving model!
Saving model of best f1: 0.06632434745400086
              precision    recall  f1-score   support

           0   0.052083  0.769231  0.097561        26
           1   0.820809  0.699507  0.755319       203
           2   0.857143  0.017910  0.035088       335

    accuracy                       0.297872       564
   macro avg   0.576678  0.495550  0.295989       564
weighted avg   0.806953  0.297872  0.297200       564

Test Acc: 0.2978723404255319 F1_ma:0.06632434745400086
Train step: 1820 acc:0.67289 total_loss: 1.1832  loss:1.1214,stance loss: 0.90491 
Better F1! Saving model!
Saving model of best f1: 0.13389746142359382
              precision    recall  f1-score   support

           0   0.053012  0.846154  0.099773        26
           1   0.913043  0.517241  0.660377       203
           2   0.911765  0.092537  0.168022       335

    accuracy                       0.280142       564
   macro avg   0.625940  0.485311  0.309391       564
weighted avg   0.872637  0.280142  0.342089       564

Test Acc: 0.2801418439716312 F1_ma:0.13389746142359382
Train step: 1830 acc:0.67121 total_loss: 1.1859  loss:0.96895,stance loss: 0.68494 
Train step: 1840 acc:0.67336 total_loss: 1.1856  loss:1.4697,stance loss: 1.4811 
Train step: 1850 acc:0.67451 total_loss: 1.1861  loss:0.94778,stance loss: 0.70631 
Train step: 1860 acc:0.67272 total_loss: 1.1854  loss:1.3007,stance loss: 0.92395 
Train step: 1870 acc:0.67231 total_loss: 1.1838  loss:1.1973,stance loss: 0.80938 
Train step: 1880 acc:0.67385 total_loss: 1.1775  loss:1.1776,stance loss: 0.83077 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.5625 total_loss: 1.1746  loss:1.1746,stance loss: 0.78779 
Train step: 1900 acc:0.65909 total_loss: 1.1714  loss:1.3703,stance loss: 1.5842 
Train step: 1910 acc:0.6875 total_loss: 1.1113  loss:0.83497,stance loss: 0.66542 
Train step: 1920 acc:0.6996 total_loss: 1.0905  loss:0.92171,stance loss: 0.65358 
Train step: 1930 acc:0.70884 total_loss: 1.1141  loss:1.3015,stance loss: 1.3879 
Train step: 1940 acc:0.69485 total_loss: 1.1261  loss:0.97348,stance loss: 0.78536 
Train step: 1950 acc:0.68852 total_loss: 1.1476  loss:1.5101,stance loss: 1.6687 
Train step: 1960 acc:0.69014 total_loss: 1.1433  loss:1.1298,stance loss: 0.87086 
Train step: 1970 acc:0.68827 total_loss: 1.1363  loss:1.1932,stance loss: 0.96002 
Train step: 1980 acc:0.69093 total_loss: 1.1362  loss:1.19,stance loss: 0.90529 
Train step: 1990 acc:0.68936 total_loss: 1.1324  loss:1.4373,stance loss: 1.5798 
Train step: 2000 acc:0.68975 total_loss: 1.1336  loss:1.4885,stance loss: 1.1881 
Train step: 2010 acc:0.68905 total_loss: 1.1477  loss:1.0886,stance loss: 1.2876 
Train step: 2020 acc:0.69227 total_loss: 1.1433  loss:0.82633,stance loss: 0.48877 
Train step: 2030 acc:0.69016 total_loss: 1.1473  loss:1.0943,stance loss: 0.75934 
Train step: 2040 acc:0.69288 total_loss: 1.142  loss:1.4316,stance loss: 1.5343 
Train step: 2050 acc:0.69138 total_loss: 1.1409  loss:1.0747,stance loss: 0.83178 
Train step: 2060 acc:0.69262 total_loss: 1.1439  loss:0.99017,stance loss: 0.7757 
Train step: 2070 acc:0.69095 total_loss: 1.1438  loss:1.282,stance loss: 0.92084 
Train step: 2080 acc:0.6947 total_loss: 1.1363  loss:1.2376,stance loss: 1.0375 
Train step: 2090 acc:0.69465 total_loss: 1.1326  loss:1.1174,stance loss: 0.84806 
Train step: 2100 acc:0.6952 total_loss: 1.1265  loss:0.82687,stance loss: 0.62173 
Train step: 2110 acc:0.69316 total_loss: 1.1316  loss:1.1196,stance loss: 0.8534 
Train step: 2120 acc:0.69129 total_loss: 1.1372  loss:1.3875,stance loss: 1.1692 
Train step: 2130 acc:0.6888 total_loss: 1.1418  loss:1.3185,stance loss: 1.0542 
Train step: 2140 acc:0.68949 total_loss: 1.1408  loss:1.45,stance loss: 1.6662 
Train step: 2150 acc:0.69085 total_loss: 1.1417  loss:1.2857,stance loss: 0.97402 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.625 total_loss: 1.1887  loss:1.1887,stance loss: 0.90344 
Train step: 2170 acc:0.67045 total_loss: 1.1356  loss:1.3748,stance loss: 0.9494 
Better F1! Saving model!
Saving model of best f1: 0.24950659943742504
              precision    recall  f1-score   support

           0   0.049536  0.615385  0.091691        26
           1   0.877698  0.600985  0.713450       203
           2   0.872549  0.265672  0.407323       335

    accuracy                       0.402482       564
   macro avg   0.599927  0.494014  0.404154       564
weighted avg   0.836462  0.402482  0.502956       564

Test Acc: 0.4024822695035461 F1_ma:0.24950659943742504
Train step: 2180 acc:0.70238 total_loss: 1.0603  loss:0.96245,stance loss: 0.77431 
Train step: 2190 acc:0.69556 total_loss: 1.0763  loss:0.82542,stance loss: 0.67178 
Train step: 2200 acc:0.6936 total_loss: 1.0864  loss:1.3305,stance loss: 0.83396 
Train step: 2210 acc:0.69608 total_loss: 1.0723  loss:0.81445,stance loss: 0.66487 
Train step: 2220 acc:0.69672 total_loss: 1.07  loss:1.0219,stance loss: 0.77086 
Train step: 2230 acc:0.69806 total_loss: 1.0784  loss:1.1003,stance loss: 0.91097 
Train step: 2240 acc:0.70062 total_loss: 1.0733  loss:0.97477,stance loss: 0.69361 
Train step: 2250 acc:0.69918 total_loss: 1.0853  loss:1.12,stance loss: 0.86252 
Train step: 2260 acc:0.70297 total_loss: 1.0841  loss:1.4727,stance loss: 1.6547 
Train step: 2270 acc:0.70608 total_loss: 1.0742  loss:0.86436,stance loss: 0.66895 
Train step: 2280 acc:0.70868 total_loss: 1.0691  loss:1.0425,stance loss: 0.62657 
Train step: 2290 acc:0.70897 total_loss: 1.0646  loss:1.1374,stance loss: 0.92241 
Train step: 2300 acc:0.71011 total_loss: 1.0594  loss:0.79731,stance loss: 0.65691 
Train step: 2310 acc:0.71358 total_loss: 1.0579  loss:1.0076,stance loss: 1.1262 
Train step: 2320 acc:0.7139 total_loss: 1.059  loss:1.5259,stance loss: 1.7057 
Train step: 2330 acc:0.71528 total_loss: 1.0574  loss:1.3179,stance loss: 0.93879 
Train step: 2340 acc:0.71305 total_loss: 1.0574  loss:1.0694,stance loss: 0.82548 
Train step: 2350 acc:0.71433 total_loss: 1.0548  loss:0.7461,stance loss: 0.61297 
Train step: 2360 acc:0.71175 total_loss: 1.0568  loss:1.5444,stance loss: 1.6523 
Train step: 2370 acc:0.71268 total_loss: 1.057  loss:0.70571,stance loss: 0.531 
Train step: 2380 acc:0.71295 total_loss: 1.0519  loss:0.367,stance loss: 0.1025 
Train step: 2390 acc:0.71672 total_loss: 1.0479  loss:0.70015,stance loss: 0.44673 
Train step: 2400 acc:0.71577 total_loss: 1.0556  loss:1.0454,stance loss: 0.83084 
Train step: 2410 acc:0.71688 total_loss: 1.0528  loss:1.0012,stance loss: 0.81469 
Better F1! Saving model!
Saving model of best f1: 0.26258162743395463
              precision    recall  f1-score   support

           0   0.048433  0.653846  0.090186        26
           1   0.901961  0.453202  0.603279       203
           2   0.873874  0.289552  0.434978       335

    accuracy                       0.365248       564
   macro avg   0.608089  0.465533  0.376147       564
weighted avg   0.845931  0.365248  0.479659       564

Test Acc: 0.36524822695035464 F1_ma:0.26258162743395463
Train step: 2420 acc:0.71791 total_loss: 1.0504  loss:0.6715,stance loss: 0.41384 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.6875 total_loss: 0.95749  loss:0.95749,stance loss: 0.78139 
Train step: 2440 acc:0.73864 total_loss: 1.005  loss:0.99614,stance loss: 0.86901 
Better F1! Saving model!
Saving model of best f1: 0.3268924755626279
              precision    recall  f1-score   support

           0   0.041096  0.461538  0.075472        26
           1   0.889908  0.477833  0.621795       203
           2   0.883436  0.429851  0.578313       335

    accuracy                       0.448582       564
   macro avg   0.604813  0.456407  0.425193       564
weighted avg   0.846934  0.448582  0.570783       564

Test Acc: 0.44858156028368795 F1_ma:0.3268924755626279
Train step: 2450 acc:0.75 total_loss: 0.98394  loss:0.87325,stance loss: 0.72339 
Train step: 2460 acc:0.74194 total_loss: 0.99068  loss:1.2565,stance loss: 0.87678 
Train step: 2470 acc:0.75 total_loss: 0.9606  loss:0.82138,stance loss: 0.65043 
Train step: 2480 acc:0.76103 total_loss: 0.93887  loss:0.85619,stance loss: 0.86846 
Train step: 2490 acc:0.75512 total_loss: 0.9625  loss:0.69971,stance loss: 0.53834 
Train step: 2500 acc:0.75352 total_loss: 0.96151  loss:0.51235,stance loss: 0.38447 
Train step: 2510 acc:0.75849 total_loss: 0.94578  loss:0.82215,stance loss: 1.0919 
Train step: 2520 acc:0.76168 total_loss: 0.94209  loss:0.9134,stance loss: 0.91429 
Train step: 2530 acc:0.75433 total_loss: 0.95357  loss:1.1722,stance loss: 0.9809 
Train step: 2540 acc:0.75619 total_loss: 0.95252  loss:0.83432,stance loss: 0.66571 
Train step: 2550 acc:0.75671 total_loss: 0.96387  loss:1.1238,stance loss: 1.4148 
Train step: 2560 acc:0.7562 total_loss: 0.96042  loss:0.90738,stance loss: 0.71512 
Train step: 2570 acc:0.75576 total_loss: 0.96467  loss:1.2215,stance loss: 1.0188 
Better F1! Saving model!
Saving model of best f1: 0.37800687285223367
              precision    recall  f1-score   support

           0   0.049057  0.500000  0.089347        26
           1   0.925532  0.428571  0.585859       203
           2   0.878049  0.537313  0.666667       335

    accuracy                       0.496454       564
   macro avg   0.617546  0.488628  0.447291       564
weighted avg   0.856923  0.496454  0.610967       564

Test Acc: 0.49645390070921985 F1_ma:0.37800687285223367
Train step: 2580 acc:0.7529 total_loss: 0.96824  loss:0.86047,stance loss: 0.70312 
Train step: 2590 acc:0.74845 total_loss: 0.9765  loss:0.99439,stance loss: 0.79613 
Train step: 2600 acc:0.74781 total_loss: 0.97523  loss:0.9547,stance loss: 0.70526 
Better F1! Saving model!
Saving model of best f1: 0.43712038759962085
              precision    recall  f1-score   support

           0   0.038462  0.230769  0.065934        26
           1   0.863248  0.497537  0.631250       203
           2   0.869416  0.755224  0.808307       335

    accuracy                       0.638298       564
   macro avg   0.590375  0.494510  0.501830       564
weighted avg   0.828889  0.638298  0.710356       564

Test Acc: 0.6382978723404256 F1_ma:0.43712038759962085
Train step: 2610 acc:0.7462 total_loss: 0.97579  loss:0.89006,stance loss: 0.65317 
Train step: 2620 acc:0.74346 total_loss: 0.98106  loss:0.79297,stance loss: 0.55391 
Train step: 2630 acc:0.74223 total_loss: 0.98419  loss:0.60241,stance loss: 0.44845 
Train step: 2640 acc:0.74171 total_loss: 0.98207  loss:0.883,stance loss: 0.73006 
Train step: 2650 acc:0.74378 total_loss: 0.97883  loss:0.91332,stance loss: 0.58969 
Train step: 2660 acc:0.74594 total_loss: 0.97389  loss:1.035,stance loss: 1.3559 
Train step: 2670 acc:0.74429 total_loss: 0.97823  loss:1.4086,stance loss: 0.94531 
Train step: 2680 acc:0.74626 total_loss: 0.97579  loss:1.2795,stance loss: 1.6092 
Train step: 2690 acc:0.74569 total_loss: 0.97407  loss:1.3414,stance loss: 0.9892 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.6875 total_loss: 1.0188  loss:1.0188,stance loss: 0.80352 
Train step: 2710 acc:0.76705 total_loss: 0.89882  loss:0.83346,stance loss: 0.70521 
Train step: 2720 acc:0.77083 total_loss: 0.89564  loss:0.88798,stance loss: 0.58135 
Train step: 2730 acc:0.76008 total_loss: 0.93033  loss:1.005,stance loss: 1.2164 
Train step: 2740 acc:0.75457 total_loss: 0.90241  loss:0.79738,stance loss: 0.55398 
Train step: 2750 acc:0.75613 total_loss: 0.89153  loss:0.7245,stance loss: 0.50697 
Train step: 2760 acc:0.76025 total_loss: 0.89053  loss:0.54531,stance loss: 0.35461 
Train step: 2770 acc:0.76408 total_loss: 0.88905  loss:1.1269,stance loss: 1.379 
Train step: 2780 acc:0.76775 total_loss: 0.87095  loss:0.45254,stance loss: 0.31502 
Train step: 2790 acc:0.76923 total_loss: 0.87598  loss:0.9611,stance loss: 0.77435 
Train step: 2800 acc:0.76856 total_loss: 0.89002  loss:0.66749,stance loss: 0.4855 
Train step: 2810 acc:0.76914 total_loss: 0.88582  loss:0.88044,stance loss: 1.1037 
Train step: 2820 acc:0.76705 total_loss: 0.88975  loss:1.0756,stance loss: 0.84318 
Train step: 2830 acc:0.76861 total_loss: 0.88133  loss:0.66406,stance loss: 0.45342 
Train step: 2840 acc:0.77083 total_loss: 0.88725  loss:0.83995,stance loss: 0.60657 
Train step: 2850 acc:0.77235 total_loss: 0.88542  loss:1.1742,stance loss: 0.92873 
Train step: 2860 acc:0.77135 total_loss: 0.88745  loss:0.99337,stance loss: 0.84682 
Train step: 2870 acc:0.77193 total_loss: 0.88131  loss:0.76161,stance loss: 0.57895 
Train step: 2880 acc:0.76968 total_loss: 0.88077  loss:0.75362,stance loss: 0.60072 
Train step: 2890 acc:0.77291 total_loss: 0.87414  loss:0.36126,stance loss: 0.10285 
Train step: 2900 acc:0.77177 total_loss: 0.87649  loss:0.66069,stance loss: 0.54343 
Train step: 2910 acc:0.77044 total_loss: 0.87851  loss:0.66136,stance loss: 0.48458 
Train step: 2920 acc:0.76923 total_loss: 0.88213  loss:0.7096,stance loss: 0.48593 
Train step: 2930 acc:0.7711 total_loss: 0.87913  loss:1.0807,stance loss: 0.83539 
Train step: 2940 acc:0.77049 total_loss: 0.88597  loss:0.68273,stance loss: 0.58833 
Train step: 2950 acc:0.76967 total_loss: 0.88587  loss:0.89866,stance loss: 0.78045 
Train step: 2960 acc:0.76892 total_loss: 0.88477  loss:1.3692,stance loss: 1.0319 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.8125 total_loss: 0.82432  loss:0.82432,stance loss: 0.71053 
Train step: 2980 acc:0.8125 total_loss: 0.85703  loss:1.058,stance loss: 0.86804 
Train step: 2990 acc:0.8006 total_loss: 0.83564  loss:0.74109,stance loss: 0.47411 
Train step: 3000 acc:0.82056 total_loss: 0.76316  loss:0.70201,stance loss: 0.55193 
Train step: 3010 acc:0.80488 total_loss: 0.81366  loss:1.0512,stance loss: 0.94932 
Train step: 3020 acc:0.79412 total_loss: 0.84409  loss:1.489,stance loss: 1.2956 
Train step: 3030 acc:0.79713 total_loss: 0.85123  loss:0.85075,stance loss: 1.1512 
Train step: 3040 acc:0.8037 total_loss: 0.82911  loss:0.65196,stance loss: 0.4728 
Train step: 3050 acc:0.80478 total_loss: 0.82648  loss:1.4272,stance loss: 1.5543 
Train step: 3060 acc:0.80975 total_loss: 0.80322  loss:0.87465,stance loss: 0.7935 
Train step: 3070 acc:0.81188 total_loss: 0.79923  loss:0.27554,stance loss: 0.094728 
Better F1! Saving model!
Saving model of best f1: 0.44361624742934636
              precision    recall  f1-score   support

           0   0.072727  0.461538  0.125654        26
           1   0.854305  0.635468  0.728814       203
           2   0.895161  0.662687  0.761578       335

    accuracy                       0.643617       564
   macro avg   0.607398  0.586564  0.538682       564
weighted avg   0.842542  0.643617  0.720470       564

Test Acc: 0.6436170212765957 F1_ma:0.44361624742934636
Train step: 3080 acc:0.80574 total_loss: 0.81616  loss:1.3479,stance loss: 1.3956 
Train step: 3090 acc:0.80062 total_loss: 0.81548  loss:0.64074,stance loss: 0.50829 
Train step: 3100 acc:0.80248 total_loss: 0.8182  loss:0.63311,stance loss: 0.49518 
Train step: 3110 acc:0.80319 total_loss: 0.81878  loss:0.61476,stance loss: 0.4869 
Train step: 3120 acc:0.80422 total_loss: 0.81833  loss:0.86889,stance loss: 0.72155 
Train step: 3130 acc:0.8059 total_loss: 0.81889  loss:1.251,stance loss: 1.3996 
Train step: 3140 acc:0.80482 total_loss: 0.8106  loss:0.72191,stance loss: 0.41786 
Train step: 3150 acc:0.80145 total_loss: 0.81254  loss:0.96534,stance loss: 1.1837 
Train step: 3160 acc:0.80366 total_loss: 0.81179  loss:0.54166,stance loss: 0.39669 
Train step: 3170 acc:0.80193 total_loss: 0.81391  loss:0.81919,stance loss: 0.64593 
Train step: 3180 acc:0.80421 total_loss: 0.80978  loss:0.6308,stance loss: 0.48318 
Train step: 3190 acc:0.80486 total_loss: 0.81824  loss:0.7344,stance loss: 0.68132 
Train step: 3200 acc:0.8033 total_loss: 0.82161  loss:0.80204,stance loss: 0.53973 
Train step: 3210 acc:0.80342 total_loss: 0.82578  loss:0.33951,stance loss: 0.21315 
Train step: 3220 acc:0.80403 total_loss: 0.81796  loss:0.47476,stance loss: 0.30443 
Train step: 3230 acc:0.80412 total_loss: 0.81231  loss:0.60898,stance loss: 0.4621 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.75 total_loss: 0.88927  loss:0.88927,stance loss: 0.6607 
Train step: 3250 acc:0.77273 total_loss: 0.86125  loss:0.70385,stance loss: 0.50655 
Train step: 3260 acc:0.81845 total_loss: 0.78878  loss:0.56194,stance loss: 0.39462 
Train step: 3270 acc:0.83669 total_loss: 0.7492  loss:0.54784,stance loss: 0.35829 
Train step: 3280 acc:0.85061 total_loss: 0.69731  loss:0.38898,stance loss: 0.31595 
Train step: 3290 acc:0.84926 total_loss: 0.67592  loss:0.62106,stance loss: 0.44566 
Train step: 3300 acc:0.84426 total_loss: 0.68093  loss:0.99669,stance loss: 0.79652 
Train step: 3310 acc:0.83715 total_loss: 0.69817  loss:1.1251,stance loss: 1.2505 
Better F1! Saving model!
Saving model of best f1: 0.45028011204481794
              precision    recall  f1-score   support

           0   0.073034  0.500000  0.127451        26
           1   0.880952  0.546798  0.674772       203
           2   0.884615  0.686567  0.773109       335

    accuracy                       0.627660       564
   macro avg   0.612867  0.577788  0.525111       564
weighted avg   0.845884  0.627660  0.707950       564

Test Acc: 0.6276595744680851 F1_ma:0.45028011204481794
Train step: 3320 acc:0.84105 total_loss: 0.69444  loss:0.73953,stance loss: 0.52631 
Train step: 3330 acc:0.83379 total_loss: 0.70188  loss:0.86336,stance loss: 0.77141 
Better F1! Saving model!
Saving model of best f1: 0.4771331314059584
              precision    recall  f1-score   support

           0   0.076923  0.423077  0.130178        26
           1   0.880000  0.541872  0.670732       203
           2   0.878378  0.776119  0.824089       335

    accuracy                       0.675532       564
   macro avg   0.611767  0.580356  0.541666       564
weighted avg   0.842016  0.675532  0.736902       564

Test Acc: 0.675531914893617 F1_ma:0.4771331314059584
Train step: 3340 acc:0.83416 total_loss: 0.7168  loss:0.94632,stance loss: 1.2233 
Train step: 3350 acc:0.83727 total_loss: 0.71245  loss:1.1535,stance loss: 1.3259 
Train step: 3360 acc:0.83781 total_loss: 0.71527  loss:0.51135,stance loss: 0.30451 
Train step: 3370 acc:0.84256 total_loss: 0.70525  loss:0.52051,stance loss: 0.32391 
Train step: 3380 acc:0.84486 total_loss: 0.70312  loss:0.5769,stance loss: 0.41672 
Train step: 3390 acc:0.84603 total_loss: 0.69945  loss:0.82425,stance loss: 0.86803 
Train step: 3400 acc:0.8486 total_loss: 0.69109  loss:0.39567,stance loss: 0.3075 
Train step: 3410 acc:0.84942 total_loss: 0.69314  loss:0.87676,stance loss: 1.1457 
Train step: 3420 acc:0.84841 total_loss: 0.70536  loss:0.481,stance loss: 0.34361 
Train step: 3430 acc:0.84522 total_loss: 0.71465  loss:1.1246,stance loss: 0.9453 
Train step: 3440 acc:0.84546 total_loss: 0.7187  loss:0.62584,stance loss: 0.44818 
Train step: 3450 acc:0.84508 total_loss: 0.72094  loss:0.67407,stance loss: 0.5837 
Train step: 3460 acc:0.84531 total_loss: 0.71491  loss:0.98302,stance loss: 0.5283 
Train step: 3470 acc:0.84361 total_loss: 0.71498  loss:1.0015,stance loss: 1.3152 
Train step: 3480 acc:0.8431 total_loss: 0.71408  loss:0.79106,stance loss: 0.67174 
Train step: 3490 acc:0.84288 total_loss: 0.70935  loss:0.61701,stance loss: 0.60143 
Train step: 3500 acc:0.84291 total_loss: 0.70709  loss:1.1347,stance loss: 1.0437 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.75 total_loss: 0.82693  loss:0.82693,stance loss: 0.758 
Train step: 3520 acc:0.84091 total_loss: 0.66768  loss:0.58095,stance loss: 0.42645 
Train step: 3530 acc:0.83631 total_loss: 0.73536  loss:1.1177,stance loss: 0.93287 
Train step: 3540 acc:0.84274 total_loss: 0.6988  loss:0.3904,stance loss: 0.30286 
Train step: 3550 acc:0.85671 total_loss: 0.66841  loss:0.62064,stance loss: 0.53363 
Train step: 3560 acc:0.85539 total_loss: 0.67924  loss:0.28931,stance loss: 0.18485 
Train step: 3570 acc:0.85861 total_loss: 0.65512  loss:0.44171,stance loss: 0.36446 
Train step: 3580 acc:0.85739 total_loss: 0.64058  loss:1.1796,stance loss: 1.3372 
Train step: 3590 acc:0.8588 total_loss: 0.63404  loss:0.47684,stance loss: 0.35385 
Train step: 3600 acc:0.86332 total_loss: 0.61313  loss:0.52771,stance loss: 0.4382 
Train step: 3610 acc:0.86139 total_loss: 0.63294  loss:1.0287,stance loss: 1.4007 
Train step: 3620 acc:0.86149 total_loss: 0.62999  loss:0.18836,stance loss: 0.045935 
Train step: 3630 acc:0.86364 total_loss: 0.62592  loss:0.25424,stance loss: 0.19636 
Train step: 3640 acc:0.86737 total_loss: 0.62509  loss:0.52959,stance loss: 0.51947 
Train step: 3650 acc:0.86924 total_loss: 0.62187  loss:1.0911,stance loss: 1.3559 
Train step: 3660 acc:0.86921 total_loss: 0.62038  loss:0.4432,stance loss: 0.41338 
Train step: 3670 acc:0.87151 total_loss: 0.6111  loss:0.28074,stance loss: 0.21839 
Train step: 3680 acc:0.87244 total_loss: 0.61116  loss:0.26599,stance loss: 0.122 
Train step: 3690 acc:0.8712 total_loss: 0.60691  loss:0.71065,stance loss: 0.48904 
Train step: 3700 acc:0.87173 total_loss: 0.60769  loss:0.84875,stance loss: 1.2114 
Train step: 3710 acc:0.87189 total_loss: 0.61068  loss:0.7377,stance loss: 0.7536 
Train step: 3720 acc:0.87411 total_loss: 0.60015  loss:0.10722,stance loss: 0.020172 
Train step: 3730 acc:0.875 total_loss: 0.59906  loss:1.0384,stance loss: 1.3899 
Train step: 3740 acc:0.875 total_loss: 0.59678  loss:0.81664,stance loss: 1.2379 
Train step: 3750 acc:0.875 total_loss: 0.60586  loss:0.52567,stance loss: 0.41847 
Train step: 3760 acc:0.87699 total_loss: 0.59881  loss:0.6667,stance loss: 0.70415 
Train step: 3770 acc:0.87787 total_loss: 0.5978  loss:0.4981,stance loss: 0.46248 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.875 total_loss: 0.44161  loss:0.44161,stance loss: 0.36685 
Train step: 3790 acc:0.9375 total_loss: 0.4581  loss:0.37793,stance loss: 0.23823 
Train step: 3800 acc:0.92857 total_loss: 0.48671  loss:0.35872,stance loss: 0.26932 
Train step: 3810 acc:0.93347 total_loss: 0.44089  loss:0.28132,stance loss: 0.21807 
Train step: 3820 acc:0.9314 total_loss: 0.47156  loss:0.35893,stance loss: 0.31338 
Train step: 3830 acc:0.9277 total_loss: 0.47396  loss:0.44506,stance loss: 0.35342 
Better F1! Saving model!
Saving model of best f1: 0.49158434650455923
              precision    recall  f1-score   support

           0   0.097015  0.500000  0.162500        26
           1   0.906542  0.477833  0.625806       203
           2   0.835913  0.805970  0.820669       335

    accuracy                       0.673759       564
   macro avg   0.613157  0.594601  0.536325       564
weighted avg   0.827272  0.673759  0.720191       564

Test Acc: 0.6737588652482269 F1_ma:0.49158434650455923
Train step: 3840 acc:0.92418 total_loss: 0.47427  loss:0.2642,stance loss: 0.19035 
Train step: 3850 acc:0.92518 total_loss: 0.47057  loss:0.22497,stance loss: 0.13299 
Train step: 3860 acc:0.91898 total_loss: 0.48391  loss:0.54765,stance loss: 0.39198 
Train step: 3870 acc:0.92308 total_loss: 0.47141  loss:0.26328,stance loss: 0.19962 
Train step: 3880 acc:0.91832 total_loss: 0.47949  loss:0.54111,stance loss: 0.43968 
Train step: 3890 acc:0.91216 total_loss: 0.49911  loss:1.196,stance loss: 1.5963 
Train step: 3900 acc:0.90909 total_loss: 0.50575  loss:0.93523,stance loss: 0.86228 
Train step: 3910 acc:0.9084 total_loss: 0.49945  loss:0.15852,stance loss: 0.095738 
Train step: 3920 acc:0.9047 total_loss: 0.50373  loss:0.71652,stance loss: 0.57285 
Train step: 3930 acc:0.90811 total_loss: 0.5004  loss:0.18866,stance loss: 0.13766 
Train step: 3940 acc:0.90761 total_loss: 0.50175  loss:0.29388,stance loss: 0.27142 
Train step: 3950 acc:0.90753 total_loss: 0.50099  loss:0.88331,stance loss: 0.76933 
Train step: 3960 acc:0.90746 total_loss: 0.51017  loss:0.2856,stance loss: 0.22261 
Train step: 3970 acc:0.90609 total_loss: 0.51852  loss:0.8003,stance loss: 0.49926 
Train step: 3980 acc:0.90392 total_loss: 0.52261  loss:0.33745,stance loss: 0.25822 
Train step: 3990 acc:0.90462 total_loss: 0.52025  loss:0.28193,stance loss: 0.26936 
Train step: 4000 acc:0.90526 total_loss: 0.51546  loss:0.77804,stance loss: 0.81661 
Train step: 4010 acc:0.90503 total_loss: 0.51703  loss:0.21409,stance loss: 0.098606 
Train step: 4020 acc:0.9056 total_loss: 0.52018  loss:0.522,stance loss: 0.43953 
Train step: 4030 acc:0.90588 total_loss: 0.52062  loss:0.59365,stance loss: 0.45538 
Train step: 4040 acc:0.90709 total_loss: 0.51657  loss:0.59198,stance loss: 0.52218 
Training finished.


Reload the best model with best f1 0.49158434650455923 from path test_outputs/bert-cross-topic/cc/2023-08-14 13-42-26/state_dict


              precision    recall  f1-score   support

           0   0.097015  0.500000  0.162500        26
           1   0.906542  0.477833  0.625806       203
           2   0.835913  0.805970  0.820669       335

    accuracy                       0.673759       564
   macro avg   0.613157  0.594601  0.536325       564
weighted avg   0.827272  0.673759  0.720191       564

Test Acc: 0.6737588652482269 F1_ma:0.49158434650455923
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.49158434650455923
acc: 0.6737588652482269, f1 :0.5363250482073406
classification report: 
              precision    recall  f1-score   support

         Con     0.0970    0.5000    0.1625        26
        None     0.9065    0.4778    0.6258       203
         Pro     0.8359    0.8060    0.8207       335

    accuracy                         0.6738       564
   macro avg     0.6132    0.5946    0.5363       564
weighted avg     0.8273    0.6738    0.7202       564

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 13-59-59', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 13-59-59
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.6208  loss:1.6208,stance loss: 0.96139 
Train step: 10 acc:0.44886 total_loss: 1.642  loss:1.6755,stance loss: 1.1789 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 20 acc:0.50595 total_loss: 1.6098  loss:1.3268,stance loss: 0.58634 
Train step: 30 acc:0.52823 total_loss: 1.5986  loss:1.5909,stance loss: 1.1553 
Train step: 40 acc:0.54573 total_loss: 1.5772  loss:1.5575,stance loss: 1.0808 
Train step: 50 acc:0.53064 total_loss: 1.5978  loss:1.5969,stance loss: 0.93418 
Train step: 60 acc:0.52971 total_loss: 1.5857  loss:1.7368,stance loss: 1.0604 
Better F1! Saving model!
Saving model of best f1: 0.044293015332197615
              precision    recall  f1-score   support

           0   0.046346  1.000000  0.088586        26
           1   1.000000  0.014778  0.029126       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.051418       564
   macro avg   0.348782  0.338259  0.039237       564
weighted avg   0.362066  0.051418  0.014567       564

Test Acc: 0.051418439716312055 F1_ma:0.044293015332197615
Train step: 70 acc:0.52729 total_loss: 1.5883  loss:1.8514,stance loss: 1.4924 
Train step: 80 acc:0.53009 total_loss: 1.5829  loss:1.4169,stance loss: 0.94708 
Better F1! Saving model!
Saving model of best f1: 0.04436860068259386
              precision    recall  f1-score   support

           0   0.046429  1.000000  0.088737        26
           1   1.000000  0.019704  0.038647       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.053191       564
   macro avg   0.348810  0.339901  0.042462       564
weighted avg   0.362069  0.053191  0.018001       564

Test Acc: 0.05319148936170213 F1_ma:0.04436860068259386
Train step: 90 acc:0.53503 total_loss: 1.5746  loss:1.513,stance loss: 1.0831 
Better F1! Saving model!
Saving model of best f1: 0.04452054794520548
              precision    recall  f1-score   support

           0   0.046595  1.000000  0.089041        26
           1   1.000000  0.029557  0.057416       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.056738       564
   macro avg   0.348865  0.343186  0.048819       564
weighted avg   0.362077  0.056738  0.024771       564

Test Acc: 0.05673758865248227 F1_ma:0.04452054794520548
Train step: 100 acc:0.53837 total_loss: 1.5748  loss:1.5564,stance loss: 1.1373 
Train step: 110 acc:0.54279 total_loss: 1.5715  loss:1.1895,stance loss: 0.74953 
Train step: 120 acc:0.54804 total_loss: 1.5549  loss:1.3598,stance loss: 0.87243 
Train step: 130 acc:0.54962 total_loss: 1.5507  loss:1.4093,stance loss: 0.93098 
Better F1! Saving model!
Saving model of best f1: 0.044905008635578586
              precision    recall  f1-score   support

           0   0.047016  1.000000  0.089810        26
           1   0.909091  0.049261  0.093458       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.063830       564
   macro avg   0.318702  0.349754  0.061089       564
weighted avg   0.329376  0.063830  0.037778       564

Test Acc: 0.06382978723404255 F1_ma:0.044905008635578586
Train step: 140 acc:0.55142 total_loss: 1.5548  loss:1.7316,stance loss: 1.6679 
Train step: 150 acc:0.55422 total_loss: 1.5502  loss:1.667,stance loss: 1.0688 
Train step: 160 acc:0.55357 total_loss: 1.5479  loss:1.3015,stance loss: 0.90995 
Train step: 170 acc:0.55629 total_loss: 1.5448  loss:1.6723,stance loss: 1.6535 
Better F1! Saving model!
Saving model of best f1: 0.04496402877697842
              precision    recall  f1-score   support

           0   0.047170  0.961538  0.089928        26
           1   0.941176  0.157635  0.270042       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.101064       564
   macro avg   0.329449  0.373058  0.119990       564
weighted avg   0.340931  0.101064  0.101342       564

Test Acc: 0.10106382978723404 F1_ma:0.04496402877697842
Train step: 180 acc:0.55594 total_loss: 1.5494  loss:2.037,stance loss: 1.808 
Train step: 190 acc:0.55236 total_loss: 1.5467  loss:1.6684,stance loss: 1.1837 
Train step: 200 acc:0.55006 total_loss: 1.5462  loss:1.3063,stance loss: 0.87577 
Better F1! Saving model!
Saving model of best f1: 0.0450281425891182
              precision    recall  f1-score   support

           0   0.047337  0.923077  0.090056        26
           1   0.947368  0.266010  0.415385       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.138298       564
   macro avg   0.331569  0.396362  0.168480       564
weighted avg   0.343168  0.138298  0.153661       564

Test Acc: 0.13829787234042554 F1_ma:0.0450281425891182
Train step: 210 acc:0.54858 total_loss: 1.549  loss:1.5104,stance loss: 1.1213 
Train step: 220 acc:0.55373 total_loss: 1.5431  loss:1.1402,stance loss: 0.77424 
Train step: 230 acc:0.55519 total_loss: 1.5389  loss:1.2674,stance loss: 0.82081 
Train step: 240 acc:0.55576 total_loss: 1.5353  loss:1.4168,stance loss: 1.041 
Better F1! Saving model!
Saving model of best f1: 0.05031446540880503
              precision    recall  f1-score   support

           0   0.053215  0.923077  0.100629        26
           1   0.893805  0.497537  0.639241       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.221631       564
   macro avg   0.315673  0.473538  0.246623       564
weighted avg   0.324160  0.221631  0.234720       564

Test Acc: 0.22163120567375885 F1_ma:0.05031446540880503
Train step: 250 acc:0.55702 total_loss: 1.5321  loss:1.4919,stance loss: 0.88818 
Train step: 260 acc:0.55747 total_loss: 1.5298  loss:1.5225,stance loss: 1.0876 
Better F1! Saving model!
Saving model of best f1: 0.0511727078891258
              precision    recall  f1-score   support

           0   0.054176  0.923077  0.102345        26
           1   0.925620  0.551724  0.691358       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.241135       564
   macro avg   0.326599  0.491600  0.264568       564
weighted avg   0.335655  0.241135  0.253558       564

Test Acc: 0.24113475177304963 F1_ma:0.0511727078891258
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.5625 total_loss: 1.3938  loss:1.3938,stance loss: 0.99068 
Better F1! Saving model!
Saving model of best f1: 0.05491990846681922
              precision    recall  f1-score   support

           0   0.058394  0.923077  0.109840        26
           1   0.862745  0.650246  0.741573       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.276596       564
   macro avg   0.307046  0.524441  0.283804       564
weighted avg   0.313219  0.276596  0.271977       564

Test Acc: 0.2765957446808511 F1_ma:0.05491990846681922
Train step: 280 acc:0.57955 total_loss: 1.4856  loss:1.41,stance loss: 1.004 
Train step: 290 acc:0.61012 total_loss: 1.4508  loss:1.172,stance loss: 0.92455 
Train step: 300 acc:0.61895 total_loss: 1.4287  loss:1.2352,stance loss: 0.98089 
Train step: 310 acc:0.60671 total_loss: 1.4391  loss:1.5254,stance loss: 1.0161 
Train step: 320 acc:0.59926 total_loss: 1.4464  loss:1.5173,stance loss: 1.181 
Train step: 330 acc:0.59426 total_loss: 1.4413  loss:1.4757,stance loss: 1.0766 
Train step: 340 acc:0.59595 total_loss: 1.4427  loss:1.4794,stance loss: 1.1647 
Train step: 350 acc:0.59954 total_loss: 1.4362  loss:1.4939,stance loss: 1.0424 
Train step: 360 acc:0.60302 total_loss: 1.4229  loss:1.4064,stance loss: 0.95998 
Train step: 370 acc:0.60829 total_loss: 1.4159  loss:1.4636,stance loss: 1.0916 
Train step: 380 acc:0.61149 total_loss: 1.4047  loss:1.2389,stance loss: 0.8441 
Train step: 390 acc:0.61002 total_loss: 1.4075  loss:1.2881,stance loss: 0.84556 
Train step: 400 acc:0.60926 total_loss: 1.4059  loss:1.051,stance loss: 0.73194 
Train step: 410 acc:0.61303 total_loss: 1.3953  loss:1.3765,stance loss: 1.5167 
Train step: 420 acc:0.61879 total_loss: 1.3851  loss:1.1792,stance loss: 0.84506 
Train step: 430 acc:0.62189 total_loss: 1.379  loss:1.5688,stance loss: 1.1752 
Train step: 440 acc:0.62902 total_loss: 1.3618  loss:0.96435,stance loss: 0.72647 
Train step: 450 acc:0.62983 total_loss: 1.3601  loss:1.4377,stance loss: 0.98973 
Train step: 460 acc:0.63024 total_loss: 1.3633  loss:1.1758,stance loss: 0.8482 
Train step: 470 acc:0.6306 total_loss: 1.3619  loss:1.4355,stance loss: 1.1119 
Train step: 480 acc:0.63092 total_loss: 1.3636  loss:1.2962,stance loss: 1.0258 
Train step: 490 acc:0.63235 total_loss: 1.3602  loss:0.9849,stance loss: 0.69696 
Train step: 500 acc:0.63447 total_loss: 1.3554  loss:1.1995,stance loss: 0.91701 
Train step: 510 acc:0.63408 total_loss: 1.3526  loss:1.4458,stance loss: 1.0944 
Train step: 520 acc:0.63745 total_loss: 1.3438  loss:0.74688,stance loss: 0.41641 
Train step: 530 acc:0.63721 total_loss: 1.343  loss:1.1496,stance loss: 0.89412 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.625 total_loss: 1.1464  loss:1.1464,stance loss: 0.68537 
Train step: 550 acc:0.65341 total_loss: 1.2425  loss:1.0494,stance loss: 0.76106 
Train step: 560 acc:0.63095 total_loss: 1.3075  loss:0.98028,stance loss: 0.63101 
Train step: 570 acc:0.63306 total_loss: 1.3026  loss:1.5183,stance loss: 1.5403 
Train step: 580 acc:0.64482 total_loss: 1.2929  loss:1.1513,stance loss: 0.85783 
Train step: 590 acc:0.65441 total_loss: 1.309  loss:1.3459,stance loss: 1.0025 
Train step: 600 acc:0.66393 total_loss: 1.3005  loss:1.1641,stance loss: 0.81368 
Train step: 610 acc:0.66021 total_loss: 1.2888  loss:1.4411,stance loss: 1.0768 
Train step: 620 acc:0.66821 total_loss: 1.2704  loss:1.4994,stance loss: 1.6375 
Train step: 630 acc:0.67239 total_loss: 1.2669  loss:1.3512,stance loss: 0.98547 
Train step: 640 acc:0.67079 total_loss: 1.2598  loss:1.1262,stance loss: 1.2065 
Train step: 650 acc:0.67173 total_loss: 1.2578  loss:1.2835,stance loss: 0.88588 
Train step: 660 acc:0.67149 total_loss: 1.2597  loss:0.89351,stance loss: 0.70377 
Train step: 670 acc:0.67128 total_loss: 1.2503  loss:1.5179,stance loss: 0.9405 
Train step: 680 acc:0.66312 total_loss: 1.2667  loss:1.224,stance loss: 0.97108 
Train step: 690 acc:0.66308 total_loss: 1.2655  loss:1.3653,stance loss: 1.1543 
Train step: 700 acc:0.66498 total_loss: 1.2585  loss:0.9949,stance loss: 0.69437 
Train step: 710 acc:0.66886 total_loss: 1.2483  loss:1.2076,stance loss: 0.8786 
Train step: 720 acc:0.67127 total_loss: 1.2437  loss:1.2021,stance loss: 0.86551 
Train step: 730 acc:0.67245 total_loss: 1.2439  loss:0.87536,stance loss: 0.65361 
Train step: 740 acc:0.66636 total_loss: 1.2463  loss:1.1194,stance loss: 0.75836 
Train step: 750 acc:0.66528 total_loss: 1.2475  loss:0.91987,stance loss: 0.63788 
Train step: 760 acc:0.66544 total_loss: 1.2489  loss:0.8973,stance loss: 0.64453 
Train step: 770 acc:0.6645 total_loss: 1.2443  loss:1.4212,stance loss: 1.1219 
Train step: 780 acc:0.66416 total_loss: 1.2448  loss:1.179,stance loss: 0.81228 
Train step: 790 acc:0.6631 total_loss: 1.2444  loss:1.4005,stance loss: 0.9765 
Train step: 800 acc:0.66164 total_loss: 1.2508  loss:1.5742,stance loss: 1.6104 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.75 total_loss: 1.1775  loss:1.1775,stance loss: 0.92672 
Train step: 820 acc:0.65909 total_loss: 1.2269  loss:1.2396,stance loss: 1.0556 
Train step: 830 acc:0.66667 total_loss: 1.1887  loss:1.5237,stance loss: 1.5849 
Train step: 840 acc:0.68347 total_loss: 1.1617  loss:0.87024,stance loss: 0.69256 
Train step: 850 acc:0.6936 total_loss: 1.1549  loss:0.90222,stance loss: 0.69031 
Train step: 860 acc:0.6875 total_loss: 1.1584  loss:1.3696,stance loss: 1.4577 
Train step: 870 acc:0.6916 total_loss: 1.1632  loss:1.409,stance loss: 1.4863 
Train step: 880 acc:0.69102 total_loss: 1.1812  loss:1.2374,stance loss: 1.3237 
Train step: 890 acc:0.69676 total_loss: 1.172  loss:1.6417,stance loss: 1.2957 
Train step: 900 acc:0.69368 total_loss: 1.1711  loss:1.1299,stance loss: 0.79676 
Train step: 910 acc:0.69802 total_loss: 1.1661  loss:1.2409,stance loss: 1.0953 
Train step: 920 acc:0.69595 total_loss: 1.1677  loss:1.6397,stance loss: 1.8002 
Train step: 930 acc:0.69318 total_loss: 1.1752  loss:1.1058,stance loss: 0.79566 
Train step: 940 acc:0.68989 total_loss: 1.1742  loss:1.4669,stance loss: 1.0094 
Train step: 950 acc:0.68972 total_loss: 1.1716  loss:1.0907,stance loss: 0.86517 
Train step: 960 acc:0.69205 total_loss: 1.1708  loss:1.1304,stance loss: 0.82709 
Train step: 970 acc:0.69061 total_loss: 1.1715  loss:1.105,stance loss: 0.81739 
Train step: 980 acc:0.68969 total_loss: 1.166  loss:1.0077,stance loss: 0.51439 
Train step: 990 acc:0.69095 total_loss: 1.1599  loss:1.2352,stance loss: 0.97818 
Train step: 1000 acc:0.69045 total_loss: 1.161  loss:1.4103,stance loss: 0.99305 
Train step: 1010 acc:0.68968 total_loss: 1.1674  loss:1.0516,stance loss: 0.93733 
Train step: 1020 acc:0.68928 total_loss: 1.1664  loss:1.1971,stance loss: 1.1531 
Train step: 1030 acc:0.69061 total_loss: 1.1619  loss:0.76697,stance loss: 0.43575 
Train step: 1040 acc:0.69129 total_loss: 1.1591  loss:1.1992,stance loss: 0.99135 
Train step: 1050 acc:0.69035 total_loss: 1.1581  loss:0.79814,stance loss: 0.47103 
Train step: 1060 acc:0.68999 total_loss: 1.161  loss:1.4472,stance loss: 1.5502 
Train step: 1070 acc:0.69013 total_loss: 1.1614  loss:1.0506,stance loss: 0.84311 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.6875 total_loss: 1.3877  loss:1.3877,stance loss: 1.135 
Train step: 1090 acc:0.68182 total_loss: 1.2159  loss:0.95673,stance loss: 0.78607 
Better F1! Saving model!
Saving model of best f1: 0.05583756345177665
              precision    recall  f1-score   support

           0   0.059783  0.846154  0.111675        26
           1   0.852041  0.822660  0.837093       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.335106       564
   macro avg   0.303941  0.556271  0.316256       564
weighted avg   0.309430  0.335106  0.306442       564

Test Acc: 0.3351063829787234 F1_ma:0.05583756345177665
Train step: 1100 acc:0.68155 total_loss: 1.2  loss:0.90803,stance loss: 0.57388 
Train step: 1110 acc:0.69355 total_loss: 1.1356  loss:0.98712,stance loss: 0.76403 
Train step: 1120 acc:0.68598 total_loss: 1.159  loss:1.1723,stance loss: 0.94011 
Train step: 1130 acc:0.69118 total_loss: 1.135  loss:1.1309,stance loss: 0.8577 
Train step: 1140 acc:0.6998 total_loss: 1.136  loss:1.0301,stance loss: 0.7808 
Train step: 1150 acc:0.69806 total_loss: 1.1424  loss:1.1057,stance loss: 0.781 
Train step: 1160 acc:0.69599 total_loss: 1.1442  loss:1.1319,stance loss: 0.76728 
Train step: 1170 acc:0.6978 total_loss: 1.1397  loss:0.79235,stance loss: 0.5193 
Train step: 1180 acc:0.70173 total_loss: 1.1425  loss:1.5205,stance loss: 1.2004 
Train step: 1190 acc:0.70608 total_loss: 1.1303  loss:0.91922,stance loss: 0.63504 
Train step: 1200 acc:0.70506 total_loss: 1.1244  loss:1.2605,stance loss: 0.98904 
Train step: 1210 acc:0.70324 total_loss: 1.118  loss:1.0616,stance loss: 0.83812 
Train step: 1220 acc:0.69991 total_loss: 1.1116  loss:1.0967,stance loss: 0.7934 
Train step: 1230 acc:0.69992 total_loss: 1.103  loss:1.1525,stance loss: 0.81468 
Train step: 1240 acc:0.70186 total_loss: 1.0938  loss:1.2482,stance loss: 0.9587 
Train step: 1250 acc:0.70358 total_loss: 1.0973  loss:0.77095,stance loss: 0.50555 
Train step: 1260 acc:0.70407 total_loss: 1.0987  loss:1.0969,stance loss: 0.77493 
Train step: 1270 acc:0.7055 total_loss: 1.096  loss:1.2726,stance loss: 1.4391 
Train step: 1280 acc:0.70709 total_loss: 1.0898  loss:1.0409,stance loss: 0.84628 
Train step: 1290 acc:0.70883 total_loss: 1.0888  loss:1.3294,stance loss: 1.4989 
Train step: 1300 acc:0.70899 total_loss: 1.0824  loss:1.1363,stance loss: 0.73308 
Train step: 1310 acc:0.70969 total_loss: 1.0783  loss:0.93545,stance loss: 0.83509 
Train step: 1320 acc:0.7098 total_loss: 1.0812  loss:1.4697,stance loss: 1.2551 
Train step: 1330 acc:0.70867 total_loss: 1.0823  loss:1.0642,stance loss: 0.67889 
Train step: 1340 acc:0.70857 total_loss: 1.084  loss:0.94761,stance loss: 0.77438 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.5625 total_loss: 1.4605  loss:1.4605,stance loss: 1.2289 
Train step: 1360 acc:0.65341 total_loss: 1.0688  loss:1.1267,stance loss: 0.98631 
Train step: 1370 acc:0.68452 total_loss: 1.0518  loss:0.77405,stance loss: 0.59145 
Train step: 1380 acc:0.69355 total_loss: 1.0447  loss:0.8085,stance loss: 0.67215 
Train step: 1390 acc:0.70579 total_loss: 1.0234  loss:0.73236,stance loss: 0.55947 
Train step: 1400 acc:0.71201 total_loss: 1.0422  loss:1.2856,stance loss: 1.0824 
Better F1! Saving model!
Saving model of best f1: 0.05755395683453238
              precision    recall  f1-score   support

           0   0.061381  0.923077  0.115108        26
           1   0.878613  0.748768  0.808511       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.312057       564
   macro avg   0.313331  0.557282  0.307873       564
weighted avg   0.319068  0.312057  0.296313       564

Test Acc: 0.3120567375886525 F1_ma:0.05755395683453238
Train step: 1410 acc:0.71824 total_loss: 1.0253  loss:0.84363,stance loss: 0.64033 
Train step: 1420 acc:0.72271 total_loss: 1.0167  loss:0.56628,stance loss: 0.40979 
Train step: 1430 acc:0.71836 total_loss: 1.0371  loss:1.1065,stance loss: 0.82702 
Train step: 1440 acc:0.71703 total_loss: 1.0272  loss:0.94353,stance loss: 0.73776 
Train step: 1450 acc:0.7203 total_loss: 1.0265  loss:0.72545,stance loss: 0.56332 
Train step: 1460 acc:0.7241 total_loss: 1.0189  loss:1.0995,stance loss: 0.87006 
Train step: 1470 acc:0.72366 total_loss: 1.0147  loss:0.73006,stance loss: 0.56668 
Train step: 1480 acc:0.72137 total_loss: 1.0204  loss:0.88907,stance loss: 0.60558 
Train step: 1490 acc:0.72429 total_loss: 1.0143  loss:0.89902,stance loss: 0.73464 
Train step: 1500 acc:0.72724 total_loss: 1.0063  loss:0.92956,stance loss: 0.76291 
Train step: 1510 acc:0.73059 total_loss: 0.99319  loss:0.82075,stance loss: 0.7209 
Train step: 1520 acc:0.73575 total_loss: 0.98134  loss:1.0187,stance loss: 0.90314 
Train step: 1530 acc:0.73688 total_loss: 0.98486  loss:1.9887,stance loss: 2.0592 
Train step: 1540 acc:0.73658 total_loss: 0.98105  loss:1.0126,stance loss: 0.75951 
Train step: 1550 acc:0.73601 total_loss: 0.98547  loss:1.4028,stance loss: 1.6548 
Train step: 1560 acc:0.73489 total_loss: 0.98709  loss:1.1421,stance loss: 0.88356 
Train step: 1570 acc:0.73558 total_loss: 0.98597  loss:1.2068,stance loss: 1.0186 
Train step: 1580 acc:0.73647 total_loss: 0.98158  loss:0.66227,stance loss: 0.48079 
Train step: 1590 acc:0.73574 total_loss: 0.98279  loss:0.97835,stance loss: 0.75606 
Train step: 1600 acc:0.73904 total_loss: 0.9754  loss:1.1119,stance loss: 0.90905 
Train step: 1610 acc:0.73827 total_loss: 0.97469  loss:0.60117,stance loss: 0.44832 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.875 total_loss: 0.638  loss:0.638,stance loss: 0.43658 
Train step: 1630 acc:0.79545 total_loss: 0.89252  loss:0.97051,stance loss: 0.75465 
Train step: 1640 acc:0.78869 total_loss: 0.84036  loss:0.97427,stance loss: 0.80955 
Train step: 1650 acc:0.79435 total_loss: 0.86351  loss:0.56556,stance loss: 0.39621 
Train step: 1660 acc:0.77591 total_loss: 0.8924  loss:0.78955,stance loss: 0.6182 
Train step: 1670 acc:0.77696 total_loss: 0.89905  loss:0.69348,stance loss: 0.51882 
Train step: 1680 acc:0.76844 total_loss: 0.91076  loss:0.8522,stance loss: 0.64498 
Train step: 1690 acc:0.76673 total_loss: 0.93312  loss:0.75925,stance loss: 0.50873 
Train step: 1700 acc:0.76003 total_loss: 0.95676  loss:0.94651,stance loss: 0.76079 
Train step: 1710 acc:0.7603 total_loss: 0.9503  loss:0.94996,stance loss: 0.63057 
Train step: 1720 acc:0.75866 total_loss: 0.96072  loss:1.2805,stance loss: 1.3806 
Train step: 1730 acc:0.7545 total_loss: 0.96407  loss:0.86953,stance loss: 0.59273 
Train step: 1740 acc:0.75413 total_loss: 0.96307  loss:0.95441,stance loss: 0.87945 
Train step: 1750 acc:0.75477 total_loss: 0.95942  loss:0.67951,stance loss: 0.51097 
Train step: 1760 acc:0.76197 total_loss: 0.94063  loss:0.68248,stance loss: 0.5428 
Train step: 1770 acc:0.76076 total_loss: 0.93797  loss:0.72627,stance loss: 0.35924 
Train step: 1780 acc:0.76048 total_loss: 0.93001  loss:0.69295,stance loss: 0.5208 
Train step: 1790 acc:0.7595 total_loss: 0.93261  loss:1.509,stance loss: 1.7132 
Train step: 1800 acc:0.76105 total_loss: 0.92934  loss:1.2246,stance loss: 1.0715 
Train step: 1810 acc:0.76505 total_loss: 0.9146  loss:0.36945,stance loss: 0.29284 
Train step: 1820 acc:0.76493 total_loss: 0.91368  loss:1.1082,stance loss: 1.0349 
Train step: 1830 acc:0.76422 total_loss: 0.91929  loss:1.3761,stance loss: 1.359 
Train step: 1840 acc:0.76244 total_loss: 0.92336  loss:0.93349,stance loss: 0.75288 
Train step: 1850 acc:0.76055 total_loss: 0.93307  loss:1.4706,stance loss: 1.6909 
Train step: 1860 acc:0.76063 total_loss: 0.932  loss:1.2479,stance loss: 0.92954 
Train step: 1870 acc:0.7617 total_loss: 0.92603  loss:0.47801,stance loss: 0.37534 
Train step: 1880 acc:0.76221 total_loss: 0.92698  loss:0.70973,stance loss: 0.48329 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.9375 total_loss: 0.45129  loss:0.45129,stance loss: 0.30593 
Train step: 1900 acc:0.80682 total_loss: 0.72115  loss:0.58108,stance loss: 0.4052 
Train step: 1910 acc:0.77976 total_loss: 0.74404  loss:0.63492,stance loss: 0.49557 
Train step: 1920 acc:0.77823 total_loss: 0.75596  loss:0.86622,stance loss: 0.58554 
Train step: 1930 acc:0.78354 total_loss: 0.77516  loss:0.74706,stance loss: 0.55464 
Train step: 1940 acc:0.77941 total_loss: 0.78094  loss:0.57652,stance loss: 0.43694 
Train step: 1950 acc:0.77664 total_loss: 0.80965  loss:1.0925,stance loss: 1.0586 
Train step: 1960 acc:0.77817 total_loss: 0.80349  loss:0.72352,stance loss: 0.68556 
Train step: 1970 acc:0.77855 total_loss: 0.80593  loss:1.0726,stance loss: 0.80947 
Train step: 1980 acc:0.77885 total_loss: 0.8076  loss:1.1579,stance loss: 1.018 
Train step: 1990 acc:0.78032 total_loss: 0.81241  loss:1.0822,stance loss: 1.4744 
Better F1! Saving model!
Saving model of best f1: 0.05825242718446602
              precision    recall  f1-score   support

           0   0.062176  0.923077  0.116505        26
           1   0.842697  0.738916  0.787402       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.308511       564
   macro avg   0.301624  0.553998  0.301302       564
weighted avg   0.306177  0.308511  0.288780       564

Test Acc: 0.30851063829787234 F1_ma:0.05825242718446602
Train step: 2000 acc:0.77815 total_loss: 0.82487  loss:0.83081,stance loss: 1.069 
Train step: 2010 acc:0.78254 total_loss: 0.81279  loss:0.80693,stance loss: 0.62448 
Train step: 2020 acc:0.78244 total_loss: 0.81069  loss:0.65125,stance loss: 0.52579 
Train step: 2030 acc:0.78369 total_loss: 0.80116  loss:0.66571,stance loss: 0.46062 
Train step: 2040 acc:0.78146 total_loss: 0.80572  loss:0.59969,stance loss: 0.33998 
Train step: 2050 acc:0.78222 total_loss: 0.80972  loss:1.3166,stance loss: 0.96255 
Train step: 2060 acc:0.78143 total_loss: 0.81403  loss:0.75647,stance loss: 0.63382 
Train step: 2070 acc:0.7797 total_loss: 0.81573  loss:0.80496,stance loss: 0.70377 
Train step: 2080 acc:0.77912 total_loss: 0.8169  loss:1.359,stance loss: 1.1472 
Train step: 2090 acc:0.77954 total_loss: 0.81613  loss:1.0349,stance loss: 0.76262 
Train step: 2100 acc:0.78021 total_loss: 0.81843  loss:1.0109,stance loss: 0.93676 
Train step: 2110 acc:0.78026 total_loss: 0.81495  loss:0.49664,stance loss: 0.4011 
Train step: 2120 acc:0.78193 total_loss: 0.81988  loss:0.85305,stance loss: 0.76312 
Train step: 2130 acc:0.78242 total_loss: 0.81797  loss:0.55333,stance loss: 0.41357 
Train step: 2140 acc:0.78386 total_loss: 0.82105  loss:1.1245,stance loss: 0.89162 
Train step: 2150 acc:0.78664 total_loss: 0.81679  loss:0.78956,stance loss: 1.0848 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:1.0 total_loss: 0.3911  loss:0.3911,stance loss: 0.28551 
Train step: 2170 acc:0.84091 total_loss: 0.66631  loss:0.60744,stance loss: 0.41397 
Train step: 2180 acc:0.83036 total_loss: 0.63629  loss:0.35911,stance loss: 0.23638 
Train step: 2190 acc:0.82661 total_loss: 0.69131  loss:0.73898,stance loss: 0.58118 
Train step: 2200 acc:0.82774 total_loss: 0.71171  loss:1.0704,stance loss: 0.97062 
Better F1! Saving model!
Saving model of best f1: 0.0617486715892623
              precision    recall  f1-score   support

           0   0.059406  0.923077  0.111628        26
           1   0.860759  0.669951  0.753463       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.287234       564
   macro avg   0.640055  0.532999  0.292320       564
weighted avg   0.906523  0.287234  0.283389       564

Test Acc: 0.2872340425531915 F1_ma:0.0617486715892623
Train step: 2210 acc:0.82966 total_loss: 0.72109  loss:0.28422,stance loss: 0.18443 
Train step: 2220 acc:0.82684 total_loss: 0.72617  loss:0.98433,stance loss: 1.2957 
Train step: 2230 acc:0.82835 total_loss: 0.71959  loss:0.97898,stance loss: 1.224 
Train step: 2240 acc:0.82407 total_loss: 0.73125  loss:0.36292,stance loss: 0.3363 
Train step: 2250 acc:0.82418 total_loss: 0.73359  loss:0.51891,stance loss: 0.3378 
Better F1! Saving model!
Saving model of best f1: 0.07026143790849673
              precision    recall  f1-score   support

           0   0.059113  0.923077  0.111111        26
           1   0.862745  0.650246  0.741573       203
           2   1.000000  0.014925  0.029412       335

    accuracy                       0.285461       564
   macro avg   0.640619  0.529416  0.294032       564
weighted avg   0.907224  0.285461  0.289506       564

Test Acc: 0.2854609929078014 F1_ma:0.07026143790849673
Train step: 2260 acc:0.82488 total_loss: 0.72387  loss:0.74,stance loss: 0.49652 
Train step: 2270 acc:0.82489 total_loss: 0.72445  loss:0.84215,stance loss: 0.60135 
Train step: 2280 acc:0.82128 total_loss: 0.7255  loss:0.64252,stance loss: 0.47574 
Better F1! Saving model!
Saving model of best f1: 0.07401485939998119
              precision    recall  f1-score   support

           0   0.053922  0.846154  0.101382        26
           1   0.851351  0.620690  0.717949       203
           2   1.000000  0.023881  0.046647       335

    accuracy                       0.276596       564
   macro avg   0.635091  0.496908  0.288659       564
weighted avg   0.902883  0.276596  0.290791       564

Test Acc: 0.2765957446808511 F1_ma:0.07401485939998119
Train step: 2290 acc:0.8187 total_loss: 0.7273  loss:0.57817,stance loss: 0.42603 
Better F1! Saving model!
Saving model of best f1: 0.10679009929411151
              precision    recall  f1-score   support

           0   0.056511  0.884615  0.106236        26
           1   0.855072  0.581281  0.692082       203
           2   1.000000  0.056716  0.107345       335

    accuracy                       0.283688       564
   macro avg   0.637195  0.507538  0.301887       564
weighted avg   0.904342  0.283688  0.317758       564

Test Acc: 0.28368794326241137 F1_ma:0.10679009929411151
Train step: 2300 acc:0.82181 total_loss: 0.72531  loss:0.71199,stance loss: 1.0132 
Train step: 2310 acc:0.81954 total_loss: 0.73025  loss:1.2496,stance loss: 1.5959 
Train step: 2320 acc:0.82065 total_loss: 0.73681  loss:0.98114,stance loss: 1.1751 
Train step: 2330 acc:0.81981 total_loss: 0.74221  loss:0.42356,stance loss: 0.30462 
Train step: 2340 acc:0.82217 total_loss: 0.73941  loss:0.52443,stance loss: 0.44762 
Train step: 2350 acc:0.82166 total_loss: 0.74133  loss:0.74757,stance loss: 0.73718 
Train step: 2360 acc:0.82338 total_loss: 0.74494  loss:0.53752,stance loss: 0.42749 
Train step: 2370 acc:0.82109 total_loss: 0.75232  loss:0.60956,stance loss: 0.45934 
Train step: 2380 acc:0.82014 total_loss: 0.75263  loss:0.70116,stance loss: 0.54885 
Train step: 2390 acc:0.82089 total_loss: 0.7512  loss:1.3885,stance loss: 1.2389 
Train step: 2400 acc:0.8221 total_loss: 0.74941  loss:0.87736,stance loss: 1.2466 
Train step: 2410 acc:0.82196 total_loss: 0.74826  loss:0.60196,stance loss: 0.36164 
Train step: 2420 acc:0.82304 total_loss: 0.74777  loss:0.73783,stance loss: 0.70512 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.8125 total_loss: 0.60705  loss:0.60705,stance loss: 0.33299 
Train step: 2440 acc:0.88636 total_loss: 0.48362  loss:0.22621,stance loss: 0.078159 
Train step: 2450 acc:0.875 total_loss: 0.52891  loss:0.76956,stance loss: 1.0412 
Train step: 2460 acc:0.86895 total_loss: 0.59368  loss:1.0958,stance loss: 1.3957 
Train step: 2470 acc:0.8628 total_loss: 0.64954  loss:0.4887,stance loss: 0.36405 
Train step: 2480 acc:0.85294 total_loss: 0.65878  loss:0.65889,stance loss: 0.45252 
Better F1! Saving model!
Saving model of best f1: 0.11312217194570134
              precision    recall  f1-score   support

           0   0.057692  0.923077  0.108597        26
           1   0.841270  0.522167  0.644377       203
           2   0.954545  0.062687  0.117647       335

    accuracy                       0.267730       564
   macro avg   0.617836  0.502644  0.290207       564
weighted avg   0.872430  0.267730  0.306815       564

Test Acc: 0.26773049645390073 F1_ma:0.11312217194570134
Train step: 2490 acc:0.85348 total_loss: 0.64462  loss:0.54599,stance loss: 0.39088 
Train step: 2500 acc:0.84507 total_loss: 0.64287  loss:0.85649,stance loss: 0.59752 
Train step: 2510 acc:0.84568 total_loss: 0.63273  loss:0.55125,stance loss: 0.45122 
Train step: 2520 acc:0.8386 total_loss: 0.63841  loss:0.7044,stance loss: 0.41777 
Train step: 2530 acc:0.83911 total_loss: 0.64434  loss:0.58029,stance loss: 0.4615 
Train step: 2540 acc:0.83333 total_loss: 0.66003  loss:0.79681,stance loss: 0.58954 
Train step: 2550 acc:0.83574 total_loss: 0.66295  loss:1.0229,stance loss: 0.82677 
Train step: 2560 acc:0.83826 total_loss: 0.66479  loss:0.76617,stance loss: 1.0829 
Train step: 2570 acc:0.8391 total_loss: 0.67231  loss:0.76581,stance loss: 1.0978 
Train step: 2580 acc:0.83775 total_loss: 0.67669  loss:0.51693,stance loss: 0.3916 
Train step: 2590 acc:0.8389 total_loss: 0.67666  loss:1.1028,stance loss: 1.4739 
Train step: 2600 acc:0.83845 total_loss: 0.67868  loss:0.82359,stance loss: 0.69182 
Train step: 2610 acc:0.83805 total_loss: 0.67692  loss:0.49789,stance loss: 0.27211 
Train step: 2620 acc:0.84031 total_loss: 0.67046  loss:0.23882,stance loss: 0.12555 
Train step: 2630 acc:0.84017 total_loss: 0.6716  loss:0.68779,stance loss: 0.49834 
Train step: 2640 acc:0.84064 total_loss: 0.66955  loss:1.0656,stance loss: 1.4032 
Train step: 2650 acc:0.84248 total_loss: 0.66969  loss:0.66961,stance loss: 0.46748 
Train step: 2660 acc:0.8428 total_loss: 0.6669  loss:0.76842,stance loss: 0.58835 
Train step: 2670 acc:0.84414 total_loss: 0.66937  loss:0.73679,stance loss: 0.49306 
Train step: 2680 acc:0.84462 total_loss: 0.66547  loss:0.90327,stance loss: 1.3085 
Train step: 2690 acc:0.84435 total_loss: 0.66395  loss:0.74448,stance loss: 1.0895 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.8125 total_loss: 1.1051  loss:1.1051,stance loss: 1.5037 
Train step: 2710 acc:0.88636 total_loss: 0.56026  loss:0.15931,stance loss: 0.053594 
Train step: 2720 acc:0.875 total_loss: 0.59652  loss:0.62983,stance loss: 0.57794 
Train step: 2730 acc:0.8629 total_loss: 0.62925  loss:0.49198,stance loss: 0.37428 
Better F1! Saving model!
Saving model of best f1: 0.11608434294510278
              precision    recall  f1-score   support

           0   0.058228  0.884615  0.109264        26
           1   0.856164  0.615764  0.716332       203
           2   0.956522  0.065672  0.122905       335

    accuracy                       0.301418       564
   macro avg   0.623638  0.522017  0.316167       564
weighted avg   0.878989  0.301418  0.335868       564

Test Acc: 0.30141843971631205 F1_ma:0.11608434294510278
Train step: 2740 acc:0.87043 total_loss: 0.6029  loss:0.50864,stance loss: 0.42293 
Better F1! Saving model!
Saving model of best f1: 0.11954022988505747
              precision    recall  f1-score   support

           0   0.056235  0.884615  0.105747        26
           1   0.861538  0.551724  0.672673       203
           2   0.960000  0.071642  0.133333       335

    accuracy                       0.281915       564
   macro avg   0.625924  0.502660  0.303918       564
weighted avg   0.882898  0.281915  0.326186       564

Test Acc: 0.28191489361702127 F1_ma:0.11954022988505747
Train step: 2750 acc:0.8799 total_loss: 0.55274  loss:0.45167,stance loss: 0.30195 
Train step: 2760 acc:0.88012 total_loss: 0.55894  loss:0.23733,stance loss: 0.13948 
Train step: 2770 acc:0.88116 total_loss: 0.57337  loss:0.3674,stance loss: 0.23793 
Train step: 2780 acc:0.8804 total_loss: 0.58015  loss:1.2121,stance loss: 1.5497 
Train step: 2790 acc:0.88187 total_loss: 0.57905  loss:0.2738,stance loss: 0.20305 
Train step: 2800 acc:0.88304 total_loss: 0.57767  loss:0.47272,stance loss: 0.39649 
Train step: 2810 acc:0.87669 total_loss: 0.59077  loss:0.86325,stance loss: 0.77345 
Train step: 2820 acc:0.87138 total_loss: 0.5984  loss:0.37555,stance loss: 0.23339 
Train step: 2830 acc:0.86498 total_loss: 0.61013  loss:0.57419,stance loss: 0.53855 
Train step: 2840 acc:0.86569 total_loss: 0.60579  loss:0.81141,stance loss: 1.1644 
Better F1! Saving model!
Saving model of best f1: 0.12325610363726955
              precision    recall  f1-score   support

           0   0.057143  0.923077  0.107623        26
           1   0.848739  0.497537  0.627329       203
           2   1.000000  0.074627  0.138889       335

    accuracy                       0.265957       564
   macro avg   0.635294  0.498414  0.291280       564
weighted avg   0.902092  0.265957  0.313251       564

Test Acc: 0.26595744680851063 F1_ma:0.12325610363726955
Train step: 2850 acc:0.86796 total_loss: 0.5951  loss:0.28343,stance loss: 0.19945 
Train step: 2860 acc:0.86491 total_loss: 0.59478  loss:0.2165,stance loss: 0.18337 
Train step: 2870 acc:0.86696 total_loss: 0.59271  loss:0.16878,stance loss: 0.07266 
Train step: 2880 acc:0.8674 total_loss: 0.58984  loss:0.12113,stance loss: 0.028636 
Better F1! Saving model!
Saving model of best f1: 0.14146709340396574
              precision    recall  f1-score   support

           0   0.055288  0.884615  0.104072        26
           1   0.868421  0.487685  0.624606       203
           2   0.970588  0.098507  0.178862       335

    accuracy                       0.274823       564
   macro avg   0.631433  0.490269  0.302513       564
weighted avg   0.891621  0.274823  0.335850       564

Test Acc: 0.274822695035461 F1_ma:0.14146709340396574
Train step: 2890 acc:0.86747 total_loss: 0.58902  loss:0.50827,stance loss: 0.36825 
Train step: 2900 acc:0.86847 total_loss: 0.58416  loss:0.37492,stance loss: 0.12556 
Train step: 2910 acc:0.8673 total_loss: 0.59341  loss:0.43698,stance loss: 0.40776 
Train step: 2920 acc:0.86736 total_loss: 0.59448  loss:0.57159,stance loss: 0.46174 
Train step: 2930 acc:0.86526 total_loss: 0.5955  loss:0.32595,stance loss: 0.22878 
Train step: 2940 acc:0.86618 total_loss: 0.59338  loss:0.69259,stance loss: 0.42327 
Train step: 2950 acc:0.86604 total_loss: 0.59522  loss:1.1812,stance loss: 1.5029 
Better F1! Saving model!
Saving model of best f1: 0.16131951614342344
              precision    recall  f1-score   support

           0   0.056701  0.846154  0.106280        26
           1   0.863636  0.561576  0.680597       203
           2   0.931818  0.122388  0.216359       335

    accuracy                       0.313830       564
   macro avg   0.617385  0.510039  0.334412       564
weighted avg   0.866935  0.313830  0.378377       564

Test Acc: 0.31382978723404253 F1_ma:0.16131951614342344
Train step: 2960 acc:0.86398 total_loss: 0.59708  loss:0.38805,stance loss: 0.30311 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.9375 total_loss: 0.2756  loss:0.2756,stance loss: 0.13765 
Train step: 2980 acc:0.89773 total_loss: 0.49707  loss:1.0944,stance loss: 1.4869 
Train step: 2990 acc:0.88393 total_loss: 0.531  loss:0.38961,stance loss: 0.34897 
Train step: 3000 acc:0.89919 total_loss: 0.46642  loss:0.35548,stance loss: 0.27961 
Train step: 3010 acc:0.90091 total_loss: 0.47426  loss:0.282,stance loss: 0.26424 
Train step: 3020 acc:0.90196 total_loss: 0.51697  loss:0.39395,stance loss: 0.29377 
Train step: 3030 acc:0.90164 total_loss: 0.49687  loss:0.32677,stance loss: 0.25291 
Train step: 3040 acc:0.90053 total_loss: 0.48984  loss:0.46226,stance loss: 0.33036 
Train step: 3050 acc:0.90123 total_loss: 0.4962  loss:0.70698,stance loss: 0.51883 
Train step: 3060 acc:0.90385 total_loss: 0.47889  loss:0.50178,stance loss: 0.40248 
Train step: 3070 acc:0.90037 total_loss: 0.49288  loss:0.37356,stance loss: 0.27406 
Train step: 3080 acc:0.89865 total_loss: 0.50527  loss:0.56909,stance loss: 0.2906 
Train step: 3090 acc:0.89773 total_loss: 0.51367  loss:0.71138,stance loss: 0.59932 
Train step: 3100 acc:0.89647 total_loss: 0.52685  loss:0.75243,stance loss: 1.0734 
Train step: 3110 acc:0.89583 total_loss: 0.52647  loss:0.71495,stance loss: 1.0683 
Train step: 3120 acc:0.89404 total_loss: 0.52788  loss:0.21188,stance loss: 0.00078918 
Train step: 3130 acc:0.8948 total_loss: 0.5206  loss:0.32435,stance loss: 0.24873 
Train step: 3140 acc:0.89693 total_loss: 0.5185  loss:0.40165,stance loss: 0.37981 
Train step: 3150 acc:0.89744 total_loss: 0.51614  loss:0.21558,stance loss: 0.18111 
Train step: 3160 acc:0.89627 total_loss: 0.51763  loss:0.36807,stance loss: 0.29174 
Train step: 3170 acc:0.89677 total_loss: 0.51789  loss:0.44046,stance loss: 0.35516 
Train step: 3180 acc:0.89425 total_loss: 0.51618  loss:0.31958,stance loss: 0.19728 
Train step: 3190 acc:0.89451 total_loss: 0.51824  loss:0.61233,stance loss: 0.37445 
Train step: 3200 acc:0.89502 total_loss: 0.51459  loss:0.60504,stance loss: 0.4438 
Train step: 3210 acc:0.89678 total_loss: 0.51146  loss:0.44366,stance loss: 0.39522 
Train step: 3220 acc:0.89766 total_loss: 0.51113  loss:0.87278,stance loss: 1.1815 
Train step: 3230 acc:0.89751 total_loss: 0.51477  loss:0.5245,stance loss: 0.45181 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:1.0 total_loss: 0.18332  loss:0.18332,stance loss: 0.12885 
Train step: 3250 acc:0.94886 total_loss: 0.32177  loss:0.43958,stance loss: 0.42188 
Train step: 3260 acc:0.92262 total_loss: 0.43137  loss:0.72614,stance loss: 0.65349 
Train step: 3270 acc:0.90927 total_loss: 0.41201  loss:0.15485,stance loss: 0.089076 
Train step: 3280 acc:0.91006 total_loss: 0.41258  loss:0.32414,stance loss: 0.26323 
Train step: 3290 acc:0.90196 total_loss: 0.44992  loss:0.37863,stance loss: 0.28197 
Train step: 3300 acc:0.90164 total_loss: 0.45563  loss:0.61714,stance loss: 0.51939 
Train step: 3310 acc:0.90581 total_loss: 0.44807  loss:0.51263,stance loss: 0.43585 
Train step: 3320 acc:0.91049 total_loss: 0.43282  loss:0.43919,stance loss: 0.32109 
Train step: 3330 acc:0.91484 total_loss: 0.41868  loss:0.35579,stance loss: 0.29861 
Train step: 3340 acc:0.91089 total_loss: 0.4337  loss:0.4494,stance loss: 0.35597 
Train step: 3350 acc:0.90935 total_loss: 0.43684  loss:0.25306,stance loss: 0.15784 
Train step: 3360 acc:0.91064 total_loss: 0.44029  loss:0.28872,stance loss: 0.275 
Train step: 3370 acc:0.90792 total_loss: 0.44563  loss:0.2906,stance loss: 0.25411 
Train step: 3380 acc:0.9047 total_loss: 0.44962  loss:0.80053,stance loss: 1.0848 
Train step: 3390 acc:0.90646 total_loss: 0.44761  loss:0.10153,stance loss: 0.050825 
Train step: 3400 acc:0.90567 total_loss: 0.45209  loss:0.5029,stance loss: 0.3847 
Train step: 3410 acc:0.9068 total_loss: 0.45228  loss:0.053515,stance loss: 0.017412 
Train step: 3420 acc:0.90711 total_loss: 0.45178  loss:0.35462,stance loss: 0.23038 
Train step: 3430 acc:0.90838 total_loss: 0.45626  loss:0.59058,stance loss: 1.0266 
Train step: 3440 acc:0.90703 total_loss: 0.46621  loss:1.1322,stance loss: 1.4118 
Train step: 3450 acc:0.90847 total_loss: 0.46191  loss:0.2105,stance loss: 0.14532 
Train step: 3460 acc:0.90809 total_loss: 0.45891  loss:0.45335,stance loss: 0.35141 
Train step: 3470 acc:0.90693 total_loss: 0.46296  loss:0.82324,stance loss: 1.0627 
Train step: 3480 acc:0.90742 total_loss: 0.46364  loss:0.2029,stance loss: 0.093212 
Train step: 3490 acc:0.90613 total_loss: 0.46345  loss:0.74975,stance loss: 0.59797 
Train step: 3500 acc:0.90398 total_loss: 0.47112  loss:0.89323,stance loss: 0.84855 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:1.0 total_loss: 0.25359  loss:0.25359,stance loss: 0.23452 
Train step: 3520 acc:0.97727 total_loss: 0.2062  loss:0.2996,stance loss: 0.24705 
Train step: 3530 acc:0.96131 total_loss: 0.27498  loss:0.097615,stance loss: 0.053659 
Train step: 3540 acc:0.94355 total_loss: 0.33354  loss:0.42861,stance loss: 0.38287 
Train step: 3550 acc:0.94512 total_loss: 0.30987  loss:0.18116,stance loss: 0.14967 
Train step: 3560 acc:0.94363 total_loss: 0.32256  loss:0.47524,stance loss: 0.40191 
Train step: 3570 acc:0.94057 total_loss: 0.32461  loss:0.46163,stance loss: 0.39838 
Train step: 3580 acc:0.9375 total_loss: 0.33216  loss:0.29242,stance loss: 0.27172 
Train step: 3590 acc:0.93673 total_loss: 0.34238  loss:0.15639,stance loss: 0.068676 
Train step: 3600 acc:0.93613 total_loss: 0.34694  loss:0.23966,stance loss: 0.222 
Train step: 3610 acc:0.93502 total_loss: 0.35866  loss:0.22315,stance loss: 0.16836 
Train step: 3620 acc:0.933 total_loss: 0.37061  loss:0.67171,stance loss: 1.0539 
Train step: 3630 acc:0.9313 total_loss: 0.37415  loss:0.21901,stance loss: 0.13316 
Train step: 3640 acc:0.93273 total_loss: 0.38677  loss:0.085326,stance loss: 0.073287 
Train step: 3650 acc:0.93174 total_loss: 0.38212  loss:0.31164,stance loss: 0.27513 
Train step: 3660 acc:0.93129 total_loss: 0.37491  loss:0.25541,stance loss: 0.27634 
Train step: 3670 acc:0.93323 total_loss: 0.36911  loss:0.53124,stance loss: 0.35283 
Train step: 3680 acc:0.93092 total_loss: 0.37925  loss:0.59602,stance loss: 0.42507 
Train step: 3690 acc:0.93232 total_loss: 0.37894  loss:0.18962,stance loss: 0.061603 
Train step: 3700 acc:0.93423 total_loss: 0.37432  loss:0.14685,stance loss: 0.099774 
Train step: 3710 acc:0.93408 total_loss: 0.37346  loss:0.78747,stance loss: 1.2379 
Train step: 3720 acc:0.93335 total_loss: 0.37642  loss:0.26482,stance loss: 0.22968 
Train step: 3730 acc:0.93298 total_loss: 0.37373  loss:0.15124,stance loss: 0.1771 
Train step: 3740 acc:0.93344 total_loss: 0.37445  loss:0.1039,stance loss: 0.0709 
Train step: 3750 acc:0.93309 total_loss: 0.37257  loss:0.18484,stance loss: 0.13567 
Train step: 3760 acc:0.93252 total_loss: 0.3766  loss:0.24993,stance loss: 0.27048 
Train step: 3770 acc:0.93343 total_loss: 0.37073  loss:0.40875,stance loss: 0.39287 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.875 total_loss: 0.28183  loss:0.28183,stance loss: 0.075364 
Train step: 3790 acc:0.97727 total_loss: 0.23465  loss:0.093608,stance loss: 0.034714 
Train step: 3800 acc:0.95833 total_loss: 0.31441  loss:0.81857,stance loss: 1.2379 
Train step: 3810 acc:0.95565 total_loss: 0.29943  loss:0.091814,stance loss: 0.023661 
Train step: 3820 acc:0.95122 total_loss: 0.31631  loss:0.87156,stance loss: 1.3268 
Train step: 3830 acc:0.95098 total_loss: 0.31927  loss:0.44281,stance loss: 0.293 
Train step: 3840 acc:0.95184 total_loss: 0.30656  loss:0.11585,stance loss: 0.051359 
Train step: 3850 acc:0.95158 total_loss: 0.29332  loss:0.38978,stance loss: 0.31182 
Train step: 3860 acc:0.94599 total_loss: 0.29868  loss:0.37394,stance loss: 0.27022 
Train step: 3870 acc:0.94437 total_loss: 0.31988  loss:0.78308,stance loss: 0.86181 
Train step: 3880 acc:0.94183 total_loss: 0.33661  loss:0.17015,stance loss: 0.12886 
Train step: 3890 acc:0.94313 total_loss: 0.34797  loss:1.064,stance loss: 1.4826 
Train step: 3900 acc:0.94267 total_loss: 0.35074  loss:0.62568,stance loss: 1.0591 
Train step: 3910 acc:0.94084 total_loss: 0.34794  loss:0.046549,stance loss: 0.020759 
Train step: 3920 acc:0.94105 total_loss: 0.34429  loss:0.51747,stance loss: 0.42728 
Train step: 3930 acc:0.94247 total_loss: 0.34129  loss:0.86115,stance loss: 1.2838 
Train step: 3940 acc:0.94216 total_loss: 0.34392  loss:0.13647,stance loss: 0.13726 
Train step: 3950 acc:0.94262 total_loss: 0.34417  loss:0.105,stance loss: 0.055815 
Train step: 3960 acc:0.94268 total_loss: 0.34593  loss:0.28704,stance loss: 0.10682 
Train step: 3970 acc:0.94306 total_loss: 0.34997  loss:0.075433,stance loss: 0.05012 
Train step: 3980 acc:0.94372 total_loss: 0.34712  loss:0.089565,stance loss: 0.070738 
Train step: 3990 acc:0.94342 total_loss: 0.34673  loss:0.36973,stance loss: 0.32585 
Train step: 4000 acc:0.94344 total_loss: 0.34615  loss:0.1597,stance loss: 0.11656 
Train step: 4010 acc:0.94345 total_loss: 0.34869  loss:0.83997,stance loss: 0.53862 
Train step: 4020 acc:0.94165 total_loss: 0.3539  loss:0.47126,stance loss: 0.37491 
Train step: 4030 acc:0.94173 total_loss: 0.35633  loss:0.14252,stance loss: 0.10296 
Train step: 4040 acc:0.93966 total_loss: 0.3608  loss:0.49008,stance loss: 0.36376 
Training finished.


Reload the best model with best f1 0.16131951614342344 from path test_outputs/bert-cross-topic/cc/2023-08-14 13-59-59/state_dict


              precision    recall  f1-score   support

           0   0.056701  0.846154  0.106280        26
           1   0.863636  0.561576  0.680597       203
           2   0.931818  0.122388  0.216359       335

    accuracy                       0.313830       564
   macro avg   0.617385  0.510039  0.334412       564
weighted avg   0.866935  0.313830  0.378377       564

Test Acc: 0.31382978723404253 F1_ma:0.16131951614342344
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.16131951614342344
acc: 0.31382978723404253, f1 :0.33441201573740664
classification report: 
              precision    recall  f1-score   support

         Con     0.0567    0.8462    0.1063        26
        None     0.8636    0.5616    0.6806       203
         Pro     0.9318    0.1224    0.2164       335

    accuracy                         0.3138       564
   macro avg     0.6174    0.5100    0.3344       564
weighted avg     0.8669    0.3138    0.3784       564

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 14-17-43', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 14-17-43
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.7465  loss:1.7465,stance loss: 1.1767 
Train step: 10 acc:0.32386 total_loss: 1.731  loss:1.6769,stance loss: 1.1487 
Better F1! Saving model!
Saving model of best f1: 0.03763440860215053
              precision    recall  f1-score   support

           0   0.039474  0.807692  0.075269        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.037234       564
   macro avg   0.013158  0.269231  0.025090       564
weighted avg   0.001820  0.037234  0.003470       564

Test Acc: 0.03723404255319149 F1_ma:0.03763440860215053
Train step: 20 acc:0.45238 total_loss: 1.6478  loss:1.5277,stance loss: 1.0985 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 30 acc:0.50806 total_loss: 1.6023  loss:1.2851,stance loss: 0.70335 
Train step: 40 acc:0.51982 total_loss: 1.592  loss:1.4683,stance loss: 1.0293 
Train step: 50 acc:0.52696 total_loss: 1.5916  loss:1.4984,stance loss: 1.0111 
Train step: 60 acc:0.53074 total_loss: 1.5952  loss:1.6964,stance loss: 1.6206 
Train step: 70 acc:0.53697 total_loss: 1.5758  loss:1.4648,stance loss: 1.0749 
Better F1! Saving model!
Saving model of best f1: 0.04421768707482993
              precision    recall  f1-score   support

           0   0.046263  1.000000  0.088435        26
           1   1.000000  0.009852  0.019512       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.049645       564
   macro avg   0.348754  0.336617  0.035983       564
weighted avg   0.362062  0.049645  0.011100       564

Test Acc: 0.04964539007092199 F1_ma:0.04421768707482993
Train step: 80 acc:0.53858 total_loss: 1.5745  loss:1.5295,stance loss: 1.0652 
Train step: 90 acc:0.53503 total_loss: 1.5746  loss:1.8487,stance loss: 1.0142 
Train step: 100 acc:0.53465 total_loss: 1.5646  loss:1.0324,stance loss: 0.62039 
Train step: 110 acc:0.53435 total_loss: 1.5674  loss:1.498,stance loss: 1.0928 
Train step: 120 acc:0.53409 total_loss: 1.5609  loss:1.4609,stance loss: 0.86843 
Train step: 130 acc:0.53292 total_loss: 1.559  loss:1.6466,stance loss: 1.5739 
Train step: 140 acc:0.53059 total_loss: 1.5607  loss:1.5586,stance loss: 1.4467 
Train step: 150 acc:0.53063 total_loss: 1.557  loss:1.4683,stance loss: 0.99495 
Train step: 160 acc:0.52873 total_loss: 1.5547  loss:1.5647,stance loss: 1.0297 
Train step: 170 acc:0.52961 total_loss: 1.5493  loss:1.5496,stance loss: 1.1318 
Train step: 180 acc:0.53488 total_loss: 1.5442  loss:1.4406,stance loss: 1.0679 
Better F1! Saving model!
Saving model of best f1: 0.04452054794520548
              precision    recall  f1-score   support

           0   0.046595  1.000000  0.089041        26
           1   1.000000  0.029557  0.057416       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.056738       564
   macro avg   0.348865  0.343186  0.048819       564
weighted avg   0.362077  0.056738  0.024771       564

Test Acc: 0.05673758865248227 F1_ma:0.04452054794520548
Train step: 190 acc:0.53829 total_loss: 1.5386  loss:1.4985,stance loss: 1.0634 
Train step: 200 acc:0.53887 total_loss: 1.535  loss:1.501,stance loss: 0.99346 
Train step: 210 acc:0.5394 total_loss: 1.5316  loss:1.4045,stance loss: 1.0298 
Train step: 220 acc:0.54157 total_loss: 1.5288  loss:0.98428,stance loss: 0.64385 
Train step: 230 acc:0.54383 total_loss: 1.5232  loss:1.449,stance loss: 1.3125 
Train step: 240 acc:0.54201 total_loss: 1.5201  loss:1.5968,stance loss: 1.1832 
Train step: 250 acc:0.54482 total_loss: 1.5143  loss:1.585,stance loss: 1.2483 
Train step: 260 acc:0.54765 total_loss: 1.505  loss:1.1862,stance loss: 0.86296 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.8125 total_loss: 1.2262  loss:1.2262,stance loss: 1.0277 
Train step: 280 acc:0.5625 total_loss: 1.418  loss:1.2705,stance loss: 0.90603 
Train step: 290 acc:0.55357 total_loss: 1.4293  loss:1.4371,stance loss: 1.0894 
Train step: 300 acc:0.58266 total_loss: 1.4012  loss:1.5337,stance loss: 1.6616 
Train step: 310 acc:0.57622 total_loss: 1.3809  loss:1.3894,stance loss: 0.98334 
Train step: 320 acc:0.58088 total_loss: 1.3611  loss:1.3666,stance loss: 0.9586 
Train step: 330 acc:0.5748 total_loss: 1.3606  loss:1.3178,stance loss: 0.91044 
Better F1! Saving model!
Saving model of best f1: 0.04475043029259897
              precision    recall  f1-score   support

           0   0.046847  1.000000  0.089501        26
           1   0.888889  0.039409  0.075472       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.060284       564
   macro avg   0.311912  0.346470  0.054991       564
weighted avg   0.322097  0.060284  0.031290       564

Test Acc: 0.06028368794326241 F1_ma:0.04475043029259897
Train step: 340 acc:0.58451 total_loss: 1.3553  loss:1.0032,stance loss: 0.62892 
Train step: 350 acc:0.58873 total_loss: 1.3517  loss:1.1124,stance loss: 0.816 
Train step: 360 acc:0.59203 total_loss: 1.3527  loss:1.1994,stance loss: 1.1001 
Train step: 370 acc:0.59406 total_loss: 1.3437  loss:1.1586,stance loss: 0.97502 
Train step: 380 acc:0.58953 total_loss: 1.3498  loss:1.5426,stance loss: 1.0837 
Train step: 390 acc:0.59452 total_loss: 1.3466  loss:1.3662,stance loss: 0.93764 
Train step: 400 acc:0.59208 total_loss: 1.358  loss:1.4629,stance loss: 1.0282 
Train step: 410 acc:0.59619 total_loss: 1.3565  loss:1.0965,stance loss: 0.74651 
Train step: 420 acc:0.59975 total_loss: 1.3551  loss:1.6527,stance loss: 1.7624 
Train step: 430 acc:0.59666 total_loss: 1.3546  loss:1.5293,stance loss: 1.3723 
Train step: 440 acc:0.59942 total_loss: 1.3482  loss:1.4761,stance loss: 1.1078 
Better F1! Saving model!
Saving model of best f1: 0.051470588235294115
              precision    recall  f1-score   support

           0   0.054974  0.807692  0.102941        26
           1   0.813187  0.729064  0.768831       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.299645       564
   macro avg   0.289387  0.512252  0.290591       564
weighted avg   0.295224  0.299645  0.281470       564

Test Acc: 0.299645390070922 F1_ma:0.051470588235294115
Train step: 450 acc:0.59738 total_loss: 1.3517  loss:1.1708,stance loss: 0.85393 
Train step: 460 acc:0.60144 total_loss: 1.3468  loss:1.3848,stance loss: 0.94368 
Train step: 470 acc:0.60479 total_loss: 1.3388  loss:1.3189,stance loss: 0.97197 
Train step: 480 acc:0.60575 total_loss: 1.342  loss:1.7852,stance loss: 1.28 
Train step: 490 acc:0.60973 total_loss: 1.3354  loss:0.98665,stance loss: 0.63966 
Train step: 500 acc:0.6112 total_loss: 1.3346  loss:1.3037,stance loss: 1.0239 
Train step: 510 acc:0.61489 total_loss: 1.3317  loss:1.2792,stance loss: 1.0031 
Train step: 520 acc:0.61379 total_loss: 1.333  loss:1.2473,stance loss: 0.9087 
Train step: 530 acc:0.61494 total_loss: 1.3285  loss:1.4685,stance loss: 0.96221 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.625 total_loss: 1.3507  loss:1.3507,stance loss: 1.0452 
Train step: 550 acc:0.61364 total_loss: 1.2812  loss:1.162,stance loss: 0.80022 
Train step: 560 acc:0.65179 total_loss: 1.2173  loss:0.85885,stance loss: 0.50305 
Train step: 570 acc:0.67137 total_loss: 1.2058  loss:0.94996,stance loss: 0.74521 
Train step: 580 acc:0.66006 total_loss: 1.2098  loss:1.4883,stance loss: 1.1374 
Train step: 590 acc:0.65931 total_loss: 1.2323  loss:1.1516,stance loss: 1.213 
Train step: 600 acc:0.66393 total_loss: 1.2368  loss:1.2795,stance loss: 1.4137 
Train step: 610 acc:0.65757 total_loss: 1.2462  loss:1.3273,stance loss: 0.92419 
Train step: 620 acc:0.65432 total_loss: 1.2424  loss:1.1102,stance loss: 0.73143 
Train step: 630 acc:0.65179 total_loss: 1.2354  loss:1.5283,stance loss: 1.692 
Train step: 640 acc:0.6479 total_loss: 1.2426  loss:1.3485,stance loss: 1.5683 
Train step: 650 acc:0.63908 total_loss: 1.2526  loss:1.2364,stance loss: 0.96425 
Better F1! Saving model!
Saving model of best f1: 0.052173913043478265
              precision    recall  f1-score   support

           0   0.055300  0.923077  0.104348        26
           1   0.892308  0.571429  0.696697       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.248227       564
   macro avg   0.315869  0.498168  0.267015       564
weighted avg   0.323717  0.248227  0.255572       564

Test Acc: 0.24822695035460993 F1_ma:0.052173913043478265
Train step: 660 acc:0.63791 total_loss: 1.2686  loss:1.9881,stance loss: 1.8982 
Train step: 670 acc:0.64313 total_loss: 1.2625  loss:1.0225,stance loss: 0.63873 
Train step: 680 acc:0.64894 total_loss: 1.2565  loss:1.4058,stance loss: 1.082 
Train step: 690 acc:0.64776 total_loss: 1.2588  loss:1.3431,stance loss: 1.0063 
Train step: 700 acc:0.64984 total_loss: 1.2542  loss:1.1876,stance loss: 0.70654 
Better F1! Saving model!
Saving model of best f1: 0.053452115812917596
              precision    recall  f1-score   support

           0   0.056738  0.923077  0.106904        26
           1   0.886525  0.615764  0.726744       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.264184       564
   macro avg   0.314421  0.512947  0.277883       564
weighted avg   0.321702  0.264184  0.266505       564

Test Acc: 0.2641843971631206 F1_ma:0.053452115812917596
Train step: 710 acc:0.64985 total_loss: 1.2506  loss:1.6025,stance loss: 1.636 
Train step: 720 acc:0.64917 total_loss: 1.2458  loss:1.2228,stance loss: 0.88692 
Train step: 730 acc:0.65314 total_loss: 1.2407  loss:0.97015,stance loss: 0.76255 
Train step: 740 acc:0.65703 total_loss: 1.2331  loss:1.044,stance loss: 0.8162 
Train step: 750 acc:0.65581 total_loss: 1.2277  loss:0.91532,stance loss: 0.48876 
Train step: 760 acc:0.65752 total_loss: 1.2262  loss:1.2132,stance loss: 0.82811 
Train step: 770 acc:0.65747 total_loss: 1.2223  loss:0.83959,stance loss: 0.48902 
Train step: 780 acc:0.65794 total_loss: 1.2262  loss:1.4665,stance loss: 1.3034 
Better F1! Saving model!
Saving model of best f1: 0.05570291777188329
              precision    recall  f1-score   support

           0   0.059829  0.807692  0.111406        26
           1   0.784038  0.822660  0.802885       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.333333       564
   macro avg   0.281289  0.543451  0.304763       564
weighted avg   0.284956  0.333333  0.294117       564

Test Acc: 0.3333333333333333 F1_ma:0.05570291777188329
Train step: 790 acc:0.65936 total_loss: 1.2236  loss:0.93653,stance loss: 0.7095 
Train step: 800 acc:0.659 total_loss: 1.2294  loss:1.5138,stance loss: 1.6301 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.6875 total_loss: 1.4369  loss:1.4369,stance loss: 1.1198 
Train step: 820 acc:0.72727 total_loss: 1.0964  loss:1.1058,stance loss: 0.66021 
Train step: 830 acc:0.70833 total_loss: 1.0723  loss:1.3676,stance loss: 1.1006 
Train step: 840 acc:0.70766 total_loss: 1.0584  loss:0.67756,stance loss: 0.33824 
Train step: 850 acc:0.6936 total_loss: 1.073  loss:0.76426,stance loss: 0.63877 
Train step: 860 acc:0.69975 total_loss: 1.1095  loss:1.0632,stance loss: 0.8051 
Train step: 870 acc:0.69262 total_loss: 1.122  loss:1.6539,stance loss: 1.7583 
Train step: 880 acc:0.6963 total_loss: 1.1223  loss:1.0385,stance loss: 0.65498 
Train step: 890 acc:0.6983 total_loss: 1.1299  loss:0.72622,stance loss: 0.54708 
Train step: 900 acc:0.69437 total_loss: 1.1358  loss:1.4564,stance loss: 1.2524 
Train step: 910 acc:0.69493 total_loss: 1.1305  loss:1.0376,stance loss: 0.78881 
Train step: 920 acc:0.69707 total_loss: 1.12  loss:0.95048,stance loss: 0.63986 
Train step: 930 acc:0.69112 total_loss: 1.1337  loss:1.1459,stance loss: 1.0009 
Train step: 940 acc:0.69561 total_loss: 1.1277  loss:1.015,stance loss: 0.85428 
Train step: 950 acc:0.69947 total_loss: 1.1119  loss:0.51836,stance loss: 0.25957 
Train step: 960 acc:0.69619 total_loss: 1.111  loss:0.90713,stance loss: 0.6656 
Train step: 970 acc:0.69604 total_loss: 1.124  loss:1.5938,stance loss: 1.083 
Train step: 980 acc:0.69554 total_loss: 1.1315  loss:1.2713,stance loss: 0.82703 
Train step: 990 acc:0.69544 total_loss: 1.1295  loss:1.2089,stance loss: 0.86915 
Train step: 1000 acc:0.69077 total_loss: 1.1372  loss:1.2724,stance loss: 0.92993 
Train step: 1010 acc:0.69154 total_loss: 1.1344  loss:1.0481,stance loss: 0.64675 
Train step: 1020 acc:0.68957 total_loss: 1.137  loss:0.84348,stance loss: 0.64659 
Train step: 1030 acc:0.68891 total_loss: 1.1399  loss:1.0944,stance loss: 0.79107 
Train step: 1040 acc:0.69075 total_loss: 1.1374  loss:0.99126,stance loss: 0.90432 
Train step: 1050 acc:0.69269 total_loss: 1.1352  loss:1.3793,stance loss: 1.706 
Train step: 1060 acc:0.69248 total_loss: 1.132  loss:0.67622,stance loss: 0.49137 
Train step: 1070 acc:0.69325 total_loss: 1.1282  loss:0.82803,stance loss: 0.60627 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.75 total_loss: 1.1891  loss:1.1891,stance loss: 1.0268 
Train step: 1090 acc:0.75 total_loss: 1.1143  loss:0.84899,stance loss: 0.54545 
Train step: 1100 acc:0.73214 total_loss: 1.0714  loss:0.95538,stance loss: 0.73961 
Train step: 1110 acc:0.72581 total_loss: 1.0562  loss:1.2797,stance loss: 1.2085 
Train step: 1120 acc:0.71341 total_loss: 1.0646  loss:0.95063,stance loss: 0.68205 
Better F1! Saving model!
Saving model of best f1: 0.05842528919451996
              precision    recall  f1-score   support

           0   0.052632  0.846154  0.099099        26
           1   0.860140  0.605911  0.710983       203
           2   1.000000  0.008955  0.017751       335

    accuracy                       0.262411       564
   macro avg   0.637590  0.487007  0.275944       564
weighted avg   0.905987  0.262411  0.271016       564

Test Acc: 0.2624113475177305 F1_ma:0.05842528919451996
Train step: 1130 acc:0.71446 total_loss: 1.031  loss:0.78435,stance loss: 0.60083 
Train step: 1140 acc:0.71414 total_loss: 1.0384  loss:1.1974,stance loss: 0.91418 
Train step: 1150 acc:0.70951 total_loss: 1.0468  loss:0.98195,stance loss: 0.80654 
Train step: 1160 acc:0.70833 total_loss: 1.0518  loss:0.87731,stance loss: 0.63013 
Train step: 1170 acc:0.70536 total_loss: 1.0508  loss:0.75197,stance loss: 0.39016 
Train step: 1180 acc:0.70483 total_loss: 1.0452  loss:0.61956,stance loss: 0.34859 
Better F1! Saving model!
Saving model of best f1: 0.06554051339734061
              precision    recall  f1-score   support

           0   0.050971  0.807692  0.095890        26
           1   0.856164  0.615764  0.716332       203
           2   1.000000  0.017910  0.035191       335

    accuracy                       0.269504       564
   macro avg   0.635712  0.480455  0.282471       564
weighted avg   0.904480  0.269504  0.283152       564

Test Acc: 0.2695035460992908 F1_ma:0.06554051339734061
Train step: 1190 acc:0.70495 total_loss: 1.045  loss:1.0183,stance loss: 0.7186 
Better F1! Saving model!
Saving model of best f1: 0.06875809861556298
              precision    recall  f1-score   support

           0   0.054455  0.846154  0.102326        26
           1   0.857143  0.650246  0.739496       203
           2   1.000000  0.017910  0.035191       335

    accuracy                       0.283688       564
   macro avg   0.637199  0.504770  0.292337       564
weighted avg   0.904993  0.283688  0.291785       564

Test Acc: 0.28368794326241137 F1_ma:0.06875809861556298
Train step: 1200 acc:0.70713 total_loss: 1.0518  loss:1.0814,stance loss: 1.1651 
Better F1! Saving model!
Saving model of best f1: 0.07309941520467836
              precision    recall  f1-score   support

           0   0.055961  0.884615  0.105263        26
           1   0.876712  0.630542  0.733524       203
           2   1.000000  0.020896  0.040936       335

    accuracy                       0.280142       564
   macro avg   0.644224  0.512018  0.293241       564
weighted avg   0.912106  0.280142  0.293184       564

Test Acc: 0.2801418439716312 F1_ma:0.07309941520467836
Train step: 1210 acc:0.71231 total_loss: 1.048  loss:1.4472,stance loss: 1.1632 
Train step: 1220 acc:0.7141 total_loss: 1.0454  loss:0.6925,stance loss: 0.46268 
Better F1! Saving model!
Saving model of best f1: 0.13082035418552188
              precision    recall  f1-score   support

           0   0.060052  0.884615  0.112469        26
           1   0.863636  0.655172  0.745098       203
           2   1.000000  0.080597  0.149171       335

    accuracy                       0.324468       564
   macro avg   0.641230  0.540128  0.335580       564
weighted avg   0.907588  0.324468  0.361971       564

Test Acc: 0.324468085106383 F1_ma:0.13082035418552188
Train step: 1230 acc:0.71772 total_loss: 1.0408  loss:0.96092,stance loss: 0.79345 
Train step: 1240 acc:0.71972 total_loss: 1.0467  loss:1.544,stance loss: 1.0716 
Train step: 1250 acc:0.71674 total_loss: 1.0589  loss:1.0546,stance loss: 0.79835 
Train step: 1260 acc:0.71581 total_loss: 1.0651  loss:1.6197,stance loss: 1.7004 
Train step: 1270 acc:0.71662 total_loss: 1.0589  loss:1.0924,stance loss: 1.3106 
Train step: 1280 acc:0.71642 total_loss: 1.0598  loss:0.81457,stance loss: 0.54143 
Train step: 1290 acc:0.72038 total_loss: 1.0525  loss:0.68802,stance loss: 0.47992 
Train step: 1300 acc:0.71974 total_loss: 1.0542  loss:1.254,stance loss: 1.1246 
Train step: 1310 acc:0.72051 total_loss: 1.0515  loss:0.72618,stance loss: 0.56128 
Train step: 1320 acc:0.72251 total_loss: 1.0485  loss:0.99981,stance loss: 1.207 
Train step: 1330 acc:0.72485 total_loss: 1.0467  loss:0.68688,stance loss: 0.44549 
Train step: 1340 acc:0.72486 total_loss: 1.0459  loss:0.84234,stance loss: 0.62191 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.6875 total_loss: 1.0658  loss:1.0658,stance loss: 0.82552 
Train step: 1360 acc:0.75568 total_loss: 1.0592  loss:1.143,stance loss: 1.38 
Train step: 1370 acc:0.77083 total_loss: 0.99356  loss:0.66586,stance loss: 0.41447 
Train step: 1380 acc:0.75 total_loss: 0.95796  loss:1.7282,stance loss: 1.3145 
Train step: 1390 acc:0.76067 total_loss: 0.93288  loss:0.79893,stance loss: 0.79279 
Train step: 1400 acc:0.7598 total_loss: 0.9776  loss:1.2261,stance loss: 1.514 
Train step: 1410 acc:0.75102 total_loss: 0.98354  loss:1.6276,stance loss: 1.0186 
Train step: 1420 acc:0.74824 total_loss: 0.9911  loss:1.0195,stance loss: 0.75716 
Train step: 1430 acc:0.75231 total_loss: 0.98137  loss:0.98272,stance loss: 0.73357 
Train step: 1440 acc:0.75824 total_loss: 0.97306  loss:0.76867,stance loss: 0.63194 
Train step: 1450 acc:0.75928 total_loss: 0.97604  loss:0.62969,stance loss: 0.46785 
Train step: 1460 acc:0.75507 total_loss: 0.9666  loss:0.61951,stance loss: 0.4122 
Better F1! Saving model!
Saving model of best f1: 0.14954464209719978
              precision    recall  f1-score   support

           0   0.056657  0.769231  0.105541        26
           1   0.821839  0.704433  0.758621       203
           2   0.972973  0.107463  0.193548       335

    accuracy                       0.352837       564
   macro avg   0.617156  0.527042  0.352570       564
weighted avg   0.876334  0.352837  0.392877       564

Test Acc: 0.3528368794326241 F1_ma:0.14954464209719978
Train step: 1470 acc:0.76085 total_loss: 0.95247  loss:0.42192,stance loss: 0.2424 
Better F1! Saving model!
Saving model of best f1: 0.17273942838041118
              precision    recall  f1-score   support

           0   0.052023  0.692308  0.096774        26
           1   0.820359  0.674877  0.740541       203
           2   0.941176  0.143284  0.248705       335

    accuracy                       0.359929       564
   macro avg   0.604520  0.503489  0.362006       564
weighted avg   0.856702  0.359929  0.418727       564

Test Acc: 0.3599290780141844 F1_ma:0.17273942838041118
Train step: 1480 acc:0.75525 total_loss: 0.9538  loss:0.89589,stance loss: 0.69092 
Train step: 1490 acc:0.75621 total_loss: 0.95431  loss:1.1688,stance loss: 1.0224 
Train step: 1500 acc:0.75828 total_loss: 0.95843  loss:0.59666,stance loss: 0.47967 
Train step: 1510 acc:0.75932 total_loss: 0.95525  loss:0.91666,stance loss: 0.83611 
Train step: 1520 acc:0.76096 total_loss: 0.94828  loss:1.0673,stance loss: 1.3907 
Train step: 1530 acc:0.76001 total_loss: 0.95374  loss:0.58938,stance loss: 0.23632 
Train step: 1540 acc:0.76047 total_loss: 0.95408  loss:0.72846,stance loss: 0.50831 
Train step: 1550 acc:0.7584 total_loss: 0.94993  loss:0.86027,stance loss: 0.69181 
Train step: 1560 acc:0.75859 total_loss: 0.95308  loss:0.5281,stance loss: 0.37743 
Train step: 1570 acc:0.75962 total_loss: 0.95947  loss:1.192,stance loss: 1.4435 
Train step: 1580 acc:0.7592 total_loss: 0.96378  loss:1.1915,stance loss: 1.083 
Train step: 1590 acc:0.75882 total_loss: 0.9691  loss:1.369,stance loss: 2.0937 
Train step: 1600 acc:0.7627 total_loss: 0.95984  loss:0.67689,stance loss: 0.50449 
Train step: 1610 acc:0.76269 total_loss: 0.96315  loss:1.3822,stance loss: 1.58 
Better F1! Saving model!
Saving model of best f1: 0.20402648934504888
              precision    recall  f1-score   support

           0   0.047761  0.615385  0.088643        26
           1   0.834395  0.645320  0.727778       203
           2   0.902778  0.194030  0.319410       335

    accuracy                       0.375887       564
   macro avg   0.594978  0.484912  0.378610       564
weighted avg   0.838749  0.375887  0.455755       564

Test Acc: 0.375886524822695 F1_ma:0.20402648934504888
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:1.0 total_loss: 0.50991  loss:0.50991,stance loss: 0.31218 
Better F1! Saving model!
Saving model of best f1: 0.25313601127554614
              precision    recall  f1-score   support

           0   0.052632  0.615385  0.096970        26
           1   0.830303  0.674877  0.744565       203
           2   0.926316  0.262687  0.409302       335

    accuracy                       0.427305       564
   macro avg   0.603083  0.517649  0.416946       564
weighted avg   0.851482  0.427305  0.515575       564

Test Acc: 0.42730496453900707 F1_ma:0.25313601127554614
Train step: 1630 acc:0.83523 total_loss: 0.70282  loss:0.63425,stance loss: 0.48327 
Train step: 1640 acc:0.78869 total_loss: 0.79667  loss:1.3316,stance loss: 1.6375 
Train step: 1650 acc:0.79032 total_loss: 0.79199  loss:1.1237,stance loss: 1.1815 
Train step: 1660 acc:0.79116 total_loss: 0.80339  loss:1.0263,stance loss: 1.193 
Train step: 1670 acc:0.79779 total_loss: 0.78799  loss:0.5279,stance loss: 0.31357 
Train step: 1680 acc:0.79816 total_loss: 0.80179  loss:0.70889,stance loss: 0.53835 
Train step: 1690 acc:0.79754 total_loss: 0.83108  loss:1.2195,stance loss: 1.5715 
Train step: 1700 acc:0.79861 total_loss: 0.82804  loss:0.75536,stance loss: 0.64288 
Train step: 1710 acc:0.79464 total_loss: 0.8226  loss:0.51775,stance loss: 0.31768 
Train step: 1720 acc:0.79579 total_loss: 0.80867  loss:0.75994,stance loss: 0.61133 
Train step: 1730 acc:0.79673 total_loss: 0.80615  loss:0.66974,stance loss: 0.62173 
Train step: 1740 acc:0.79752 total_loss: 0.81193  loss:0.49486,stance loss: 0.23699 
Train step: 1750 acc:0.79914 total_loss: 0.80971  loss:0.89496,stance loss: 0.81886 
Train step: 1760 acc:0.79832 total_loss: 0.81971  loss:1.3312,stance loss: 1.0303 
Train step: 1770 acc:0.7976 total_loss: 0.83095  loss:1.1543,stance loss: 0.93533 
Train step: 1780 acc:0.79852 total_loss: 0.83202  loss:0.71815,stance loss: 0.64951 
Train step: 1790 acc:0.79825 total_loss: 0.82958  loss:0.75989,stance loss: 0.59316 
Better F1! Saving model!
Saving model of best f1: 0.25803111788559435
              precision    recall  f1-score   support

           0   0.051195  0.576923  0.094044        26
           1   0.823529  0.689655  0.750670       203
           2   0.910891  0.274627  0.422018       335

    accuracy                       0.437943       564
   macro avg   0.595205  0.513735  0.422244       564
weighted avg   0.839816  0.437943  0.525190       564

Test Acc: 0.4379432624113475 F1_ma:0.25803111788559435
Train step: 1800 acc:0.79627 total_loss: 0.83962  loss:1.1076,stance loss: 1.3582 
Train step: 1810 acc:0.79483 total_loss: 0.8366  loss:0.68813,stance loss: 0.50285 
Train step: 1820 acc:0.79509 total_loss: 0.83695  loss:0.70918,stance loss: 0.58904 
Train step: 1830 acc:0.79414 total_loss: 0.83387  loss:0.90611,stance loss: 0.74438 
Train step: 1840 acc:0.79355 total_loss: 0.83861  loss:1.2809,stance loss: 1.4986 
Train step: 1850 acc:0.79085 total_loss: 0.84082  loss:0.73333,stance loss: 0.59472 
Train step: 1860 acc:0.79305 total_loss: 0.83979  loss:1.2799,stance loss: 1.4261 
Train step: 1870 acc:0.79258 total_loss: 0.84275  loss:1.5287,stance loss: 1.746 
Train step: 1880 acc:0.79358 total_loss: 0.84077  loss:0.53648,stance loss: 0.39873 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.875 total_loss: 0.87534  loss:0.87534,stance loss: 1.1651 
Train step: 1900 acc:0.85795 total_loss: 0.64191  loss:0.63829,stance loss: 0.45069 
Train step: 1910 acc:0.84524 total_loss: 0.71163  loss:0.69569,stance loss: 0.49175 
Train step: 1920 acc:0.85282 total_loss: 0.77875  loss:0.83157,stance loss: 1.1768 
Train step: 1930 acc:0.83841 total_loss: 0.7968  loss:0.75429,stance loss: 0.61755 
Train step: 1940 acc:0.84681 total_loss: 0.74915  loss:0.53506,stance loss: 0.44396 
Train step: 1950 acc:0.83914 total_loss: 0.74173  loss:0.80938,stance loss: 0.49144 
Train step: 1960 acc:0.83627 total_loss: 0.76013  loss:0.55515,stance loss: 0.36442 
Train step: 1970 acc:0.8341 total_loss: 0.78027  loss:0.84061,stance loss: 0.73337 
Train step: 1980 acc:0.83585 total_loss: 0.76379  loss:0.97687,stance loss: 1.2372 
Train step: 1990 acc:0.83354 total_loss: 0.76121  loss:0.38014,stance loss: 0.14475 
Train step: 2000 acc:0.83727 total_loss: 0.7525  loss:1.189,stance loss: 1.3825 
Train step: 2010 acc:0.83626 total_loss: 0.74092  loss:0.56163,stance loss: 0.47053 
Train step: 2020 acc:0.83397 total_loss: 0.74949  loss:1.4853,stance loss: 1.3852 
Train step: 2030 acc:0.83555 total_loss: 0.74236  loss:0.40633,stance loss: 0.24785 
Train step: 2040 acc:0.83982 total_loss: 0.73179  loss:0.68912,stance loss: 1.0454 
Train step: 2050 acc:0.8389 total_loss: 0.73119  loss:1.0838,stance loss: 0.86265 
Train step: 2060 acc:0.83882 total_loss: 0.731  loss:0.87893,stance loss: 0.72917 
Train step: 2070 acc:0.83771 total_loss: 0.73821  loss:0.5825,stance loss: 0.42273 
Train step: 2080 acc:0.83835 total_loss: 0.7313  loss:0.51349,stance loss: 0.42044 
Train step: 2090 acc:0.83986 total_loss: 0.72598  loss:0.5373,stance loss: 0.33402 
Train step: 2100 acc:0.83945 total_loss: 0.73072  loss:1.1572,stance loss: 1.5916 
Train step: 2110 acc:0.83937 total_loss: 0.73334  loss:0.59001,stance loss: 0.42078 
Train step: 2120 acc:0.83956 total_loss: 0.73814  loss:1.0449,stance loss: 0.94126 
Train step: 2130 acc:0.84051 total_loss: 0.73485  loss:0.58205,stance loss: 0.44284 
Better F1! Saving model!
Saving model of best f1: 0.29327387987536263
              precision    recall  f1-score   support

           0   0.052980  0.615385  0.097561        26
           1   0.839161  0.591133  0.693642       203
           2   0.932773  0.331343  0.488987       335

    accuracy                       0.437943       564
   macro avg   0.608305  0.512620  0.426730       564
weighted avg   0.858521  0.437943  0.544604       564

Test Acc: 0.4379432624113475 F1_ma:0.29327387987536263
Train step: 2140 acc:0.84039 total_loss: 0.73443  loss:1.2233,stance loss: 1.5302 
Train step: 2150 acc:0.83908 total_loss: 0.73458  loss:0.6686,stance loss: 0.39459 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.8125 total_loss: 0.88469  loss:0.88469,stance loss: 1.0844 
Train step: 2170 acc:0.91477 total_loss: 0.54257  loss:0.53756,stance loss: 0.37007 
Train step: 2180 acc:0.89881 total_loss: 0.55024  loss:1.0159,stance loss: 1.3474 
Train step: 2190 acc:0.89516 total_loss: 0.58287  loss:0.5573,stance loss: 0.40744 
Train step: 2200 acc:0.88872 total_loss: 0.56746  loss:0.62761,stance loss: 0.46959 
Train step: 2210 acc:0.89338 total_loss: 0.56912  loss:0.42395,stance loss: 0.29694 
Train step: 2220 acc:0.8873 total_loss: 0.58052  loss:0.48288,stance loss: 0.2924 
Train step: 2230 acc:0.88732 total_loss: 0.58567  loss:0.62031,stance loss: 0.37285 
Train step: 2240 acc:0.88657 total_loss: 0.60241  loss:0.30541,stance loss: 0.17809 
Train step: 2250 acc:0.88324 total_loss: 0.59491  loss:0.78372,stance loss: 0.62693 
Train step: 2260 acc:0.87995 total_loss: 0.60571  loss:0.86418,stance loss: 1.2269 
Train step: 2270 acc:0.87782 total_loss: 0.60792  loss:0.61876,stance loss: 0.67159 
Train step: 2280 acc:0.87552 total_loss: 0.59947  loss:0.45191,stance loss: 0.28048 
Train step: 2290 acc:0.87834 total_loss: 0.59571  loss:0.6032,stance loss: 0.41958 
Train step: 2300 acc:0.8781 total_loss: 0.59438  loss:0.47785,stance loss: 0.43828 
Train step: 2310 acc:0.88038 total_loss: 0.59583  loss:0.21968,stance loss: 0.1211 
Train step: 2320 acc:0.88043 total_loss: 0.59459  loss:0.50433,stance loss: 0.38314 
Train step: 2330 acc:0.88012 total_loss: 0.59206  loss:0.43989,stance loss: 0.30247 
Train step: 2340 acc:0.88052 total_loss: 0.58889  loss:0.96745,stance loss: 0.76369 
Train step: 2350 acc:0.88253 total_loss: 0.58051  loss:0.42752,stance loss: 0.32637 
Train step: 2360 acc:0.87966 total_loss: 0.58321  loss:0.53886,stance loss: 0.36369 
Train step: 2370 acc:0.87826 total_loss: 0.58947  loss:0.83054,stance loss: 1.1521 
Train step: 2380 acc:0.87726 total_loss: 0.59361  loss:1.2644,stance loss: 1.2554 
Train step: 2390 acc:0.87744 total_loss: 0.59128  loss:0.70701,stance loss: 0.62292 
Train step: 2400 acc:0.87604 total_loss: 0.5923  loss:0.56819,stance loss: 0.4031 
Train step: 2410 acc:0.87575 total_loss: 0.59397  loss:0.84006,stance loss: 0.72812 
Train step: 2420 acc:0.875 total_loss: 0.59536  loss:1.0577,stance loss: 1.4288 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.6875 total_loss: 1.0902  loss:1.0902,stance loss: 0.74741 
Better F1! Saving model!
Saving model of best f1: 0.3378667211217753
              precision    recall  f1-score   support

           0   0.044610  0.461538  0.081356        26
           1   0.825758  0.536946  0.650746       203
           2   0.907975  0.441791  0.594378       335

    accuracy                       0.476950       564
   macro avg   0.592781  0.480092  0.442160       564
weighted avg   0.838582  0.476950  0.591016       564

Test Acc: 0.4769503546099291 F1_ma:0.3378667211217753
Train step: 2440 acc:0.875 total_loss: 0.48414  loss:0.36093,stance loss: 0.2625 
Train step: 2450 acc:0.875 total_loss: 0.55188  loss:0.32595,stance loss: 0.08651 
Train step: 2460 acc:0.88105 total_loss: 0.51981  loss:0.44941,stance loss: 0.28878 
Train step: 2470 acc:0.89177 total_loss: 0.50026  loss:0.52535,stance loss: 0.48476 
Train step: 2480 acc:0.90074 total_loss: 0.48895  loss:0.19408,stance loss: 0.12535 
Train step: 2490 acc:0.90164 total_loss: 0.48479  loss:0.33281,stance loss: 0.22111 
Train step: 2500 acc:0.90053 total_loss: 0.49193  loss:0.60712,stance loss: 0.4673 
Train step: 2510 acc:0.89738 total_loss: 0.51338  loss:0.41658,stance loss: 0.34011 
Train step: 2520 acc:0.89629 total_loss: 0.51738  loss:0.16888,stance loss: 0.055993 
Train step: 2530 acc:0.89047 total_loss: 0.5286  loss:0.67724,stance loss: 0.56414 
Train step: 2540 acc:0.89245 total_loss: 0.528  loss:0.27976,stance loss: 0.13637 
Train step: 2550 acc:0.89205 total_loss: 0.52686  loss:0.4086,stance loss: 0.34034 
Train step: 2560 acc:0.89218 total_loss: 0.52426  loss:0.42766,stance loss: 0.27751 
Train step: 2570 acc:0.8945 total_loss: 0.52146  loss:0.22315,stance loss: 0.11741 
Train step: 2580 acc:0.89487 total_loss: 0.5145  loss:0.28814,stance loss: 0.16506 
Train step: 2590 acc:0.89596 total_loss: 0.51367  loss:1.1316,stance loss: 0.86299 
Train step: 2600 acc:0.89693 total_loss: 0.51666  loss:1.0794,stance loss: 1.48 
Train step: 2610 acc:0.8971 total_loss: 0.51722  loss:0.67482,stance loss: 0.6063 
Train step: 2620 acc:0.89562 total_loss: 0.51682  loss:0.88252,stance loss: 0.7826 
Train step: 2630 acc:0.89428 total_loss: 0.52125  loss:0.37214,stance loss: 0.20822 
Train step: 2640 acc:0.89455 total_loss: 0.52497  loss:0.76995,stance loss: 0.58966 
Train step: 2650 acc:0.89593 total_loss: 0.5248  loss:0.65749,stance loss: 1.0635 
Train step: 2660 acc:0.89665 total_loss: 0.52343  loss:0.29664,stance loss: 0.10924 
Train step: 2670 acc:0.8973 total_loss: 0.5194  loss:0.52969,stance loss: 0.37783 
Train step: 2680 acc:0.89691 total_loss: 0.52022  loss:0.47478,stance loss: 0.40178 
Train step: 2690 acc:0.89703 total_loss: 0.51785  loss:0.83136,stance loss: 0.72405 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.875 total_loss: 0.7389  loss:0.7389,stance loss: 1.0648 
Train step: 2710 acc:0.95455 total_loss: 0.35383  loss:0.12778,stance loss: 0.059343 
Train step: 2720 acc:0.94643 total_loss: 0.32612  loss:0.39699,stance loss: 0.34015 
Train step: 2730 acc:0.94758 total_loss: 0.34985  loss:0.30343,stance loss: 0.21512 
Train step: 2740 acc:0.9436 total_loss: 0.402  loss:0.67169,stance loss: 1.0618 
Train step: 2750 acc:0.93873 total_loss: 0.41449  loss:0.74669,stance loss: 0.72175 
Train step: 2760 acc:0.93545 total_loss: 0.41873  loss:0.52848,stance loss: 0.37946 
Train step: 2770 acc:0.92958 total_loss: 0.42618  loss:0.89742,stance loss: 0.72711 
Train step: 2780 acc:0.92747 total_loss: 0.42888  loss:0.33847,stance loss: 0.23745 
Train step: 2790 acc:0.93201 total_loss: 0.41106  loss:0.49161,stance loss: 0.44929 
Train step: 2800 acc:0.93255 total_loss: 0.40523  loss:0.48293,stance loss: 0.38894 
Train step: 2810 acc:0.93131 total_loss: 0.4086  loss:0.61638,stance loss: 0.50689 
Train step: 2820 acc:0.93027 total_loss: 0.41346  loss:0.9946,stance loss: 1.001 
Train step: 2830 acc:0.93082 total_loss: 0.42355  loss:0.71721,stance loss: 1.0646 
Train step: 2840 acc:0.92908 total_loss: 0.42183  loss:0.2884,stance loss: 0.23915 
Train step: 2850 acc:0.92674 total_loss: 0.42714  loss:0.95315,stance loss: 1.0889 
Train step: 2860 acc:0.92469 total_loss: 0.43728  loss:0.64352,stance loss: 0.49431 
Train step: 2870 acc:0.92544 total_loss: 0.43549  loss:0.096043,stance loss: 0.044272 
Train step: 2880 acc:0.92576 total_loss: 0.43911  loss:0.31615,stance loss: 0.30631 
Train step: 2890 acc:0.9231 total_loss: 0.44516  loss:0.74999,stance loss: 0.39115 
Train step: 2900 acc:0.92164 total_loss: 0.45123  loss:1.0618,stance loss: 1.3576 
Train step: 2910 acc:0.92032 total_loss: 0.45297  loss:0.28637,stance loss: 0.14229 
Train step: 2920 acc:0.92081 total_loss: 0.45633  loss:0.46181,stance loss: 0.29612 
Train step: 2930 acc:0.91991 total_loss: 0.46045  loss:0.81146,stance loss: 1.2424 
Train step: 2940 acc:0.92064 total_loss: 0.46  loss:0.24981,stance loss: 0.14175 
Train step: 2950 acc:0.92057 total_loss: 0.4608  loss:0.44079,stance loss: 0.36522 
Train step: 2960 acc:0.91834 total_loss: 0.46897  loss:1.3848,stance loss: 1.7316 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.9375 total_loss: 0.2632  loss:0.2632,stance loss: 0.23584 
Train step: 2980 acc:0.96023 total_loss: 0.2881  loss:0.19593,stance loss: 0.04048 
Train step: 2990 acc:0.94345 total_loss: 0.33163  loss:0.15491,stance loss: 0.042837 
Train step: 3000 acc:0.93952 total_loss: 0.35467  loss:0.80695,stance loss: 0.68686 
Train step: 3010 acc:0.94207 total_loss: 0.33982  loss:0.08364,stance loss: 0.01815 
Train step: 3020 acc:0.94363 total_loss: 0.32986  loss:0.44277,stance loss: 0.30047 
Train step: 3030 acc:0.94775 total_loss: 0.31281  loss:0.06154,stance loss: 0.0059608 
Train step: 3040 acc:0.94542 total_loss: 0.31117  loss:0.36931,stance loss: 0.27444 
Train step: 3050 acc:0.94213 total_loss: 0.32438  loss:0.3429,stance loss: 0.30902 
Train step: 3060 acc:0.94505 total_loss: 0.3261  loss:0.11921,stance loss: 0.020278 
Train step: 3070 acc:0.94369 total_loss: 0.34274  loss:0.17486,stance loss: 0.087916 
Train step: 3080 acc:0.94313 total_loss: 0.34642  loss:0.2018,stance loss: 0.1771 
Train step: 3090 acc:0.94421 total_loss: 0.34038  loss:0.70263,stance loss: 1.1443 
Train step: 3100 acc:0.94418 total_loss: 0.34292  loss:0.26227,stance loss: 0.23183 
Train step: 3110 acc:0.94326 total_loss: 0.34863  loss:0.36365,stance loss: 0.25957 
Train step: 3120 acc:0.94412 total_loss: 0.34631  loss:0.11281,stance loss: 0.042168 
Train step: 3130 acc:0.94293 total_loss: 0.34878  loss:0.2098,stance loss: 0.11084 
Train step: 3140 acc:0.94408 total_loss: 0.35487  loss:0.12527,stance loss: 0.025238 
Train step: 3150 acc:0.94544 total_loss: 0.34749  loss:0.073108,stance loss: 0.019428 
Train step: 3160 acc:0.94437 total_loss: 0.35633  loss:0.076398,stance loss: 0.0074758 
Train step: 3170 acc:0.94465 total_loss: 0.35236  loss:0.70816,stance loss: 1.2453 
Train step: 3180 acc:0.94461 total_loss: 0.35656  loss:0.072306,stance loss: 0.02373 
Train step: 3190 acc:0.944 total_loss: 0.35306  loss:0.70544,stance loss: 0.59537 
Train step: 3200 acc:0.94372 total_loss: 0.35163  loss:0.15795,stance loss: 0.089087 
Train step: 3210 acc:0.94321 total_loss: 0.35268  loss:0.44443,stance loss: 0.34841 
Train step: 3220 acc:0.94298 total_loss: 0.3514  loss:0.1651,stance loss: 0.15689 
Train step: 3230 acc:0.94205 total_loss: 0.35278  loss:0.17458,stance loss: 0.013093 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.20002  loss:0.20002,stance loss: 0.13096 
Train step: 3250 acc:0.97727 total_loss: 0.24664  loss:0.61339,stance loss: 1.0388 
Train step: 3260 acc:0.97321 total_loss: 0.21251  loss:0.57315,stance loss: 0.41602 
Train step: 3270 acc:0.96573 total_loss: 0.24816  loss:0.21299,stance loss: 0.14875 
Train step: 3280 acc:0.96951 total_loss: 0.25085  loss:0.55643,stance loss: 1.0228 
Train step: 3290 acc:0.96201 total_loss: 0.30327  loss:0.93417,stance loss: 1.1181 
Train step: 3300 acc:0.96107 total_loss: 0.30913  loss:0.36229,stance loss: 0.43688 
Train step: 3310 acc:0.96215 total_loss: 0.30515  loss:0.070348,stance loss: 0.021605 
Train step: 3320 acc:0.96296 total_loss: 0.29615  loss:0.10455,stance loss: 0.0015464 
Train step: 3330 acc:0.96566 total_loss: 0.28417  loss:0.20573,stance loss: 0.18281 
Train step: 3340 acc:0.96473 total_loss: 0.27249  loss:0.11618,stance loss: 0.071723 
Train step: 3350 acc:0.96227 total_loss: 0.27505  loss:0.067867,stance loss: 0.0089644 
Train step: 3360 acc:0.96023 total_loss: 0.27891  loss:0.19341,stance loss: 0.16496 
Train step: 3370 acc:0.95897 total_loss: 0.2799  loss:0.68568,stance loss: 1.016 
Train step: 3380 acc:0.95656 total_loss: 0.28273  loss:0.45459,stance loss: 0.0087476 
Train step: 3390 acc:0.95571 total_loss: 0.28772  loss:0.2266,stance loss: 0.13301 
Train step: 3400 acc:0.95652 total_loss: 0.28203  loss:0.045989,stance loss: 0.0090127 
Train step: 3410 acc:0.95614 total_loss: 0.28766  loss:0.10803,stance loss: 0.0012994 
Train step: 3420 acc:0.95442 total_loss: 0.29395  loss:0.55084,stance loss: 0.48692 
Train step: 3430 acc:0.95419 total_loss: 0.29454  loss:0.83327,stance loss: 1.0736 
Train step: 3440 acc:0.95274 total_loss: 0.29483  loss:0.1849,stance loss: 0.14468 
Train step: 3450 acc:0.95409 total_loss: 0.29249  loss:0.05977,stance loss: 0.031437 
Train step: 3460 acc:0.95475 total_loss: 0.29179  loss:0.26365,stance loss: 0.20691 
Train step: 3470 acc:0.95563 total_loss: 0.28988  loss:0.58467,stance loss: 1.0239 
Train step: 3480 acc:0.95539 total_loss: 0.29038  loss:0.70599,stance loss: 1.1601 
Train step: 3490 acc:0.95518 total_loss: 0.29643  loss:0.1309,stance loss: 0.049408 
Train step: 3500 acc:0.95426 total_loss: 0.29878  loss:0.78754,stance loss: 1.2663 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.9375 total_loss: 0.25788  loss:0.25788,stance loss: 0.22726 
Train step: 3520 acc:0.95455 total_loss: 0.44261  loss:0.5264,stance loss: 0.4891 
Train step: 3530 acc:0.94345 total_loss: 0.36835  loss:0.10321,stance loss: 0.068042 
Train step: 3540 acc:0.95968 total_loss: 0.29548  loss:0.034737,stance loss: 0.0067654 
Train step: 3550 acc:0.96189 total_loss: 0.29764  loss:0.37102,stance loss: 0.22478 
Train step: 3560 acc:0.96569 total_loss: 0.28455  loss:0.067164,stance loss: 0.034934 
Train step: 3570 acc:0.96311 total_loss: 0.28012  loss:0.26779,stance loss: 0.26279 
Train step: 3580 acc:0.96303 total_loss: 0.272  loss:0.072509,stance loss: 0.023402 
Train step: 3590 acc:0.96373 total_loss: 0.28957  loss:0.56539,stance loss: 1.0101 
Train step: 3600 acc:0.95879 total_loss: 0.29746  loss:0.57081,stance loss: 1.0199 
Train step: 3610 acc:0.96101 total_loss: 0.28657  loss:0.70358,stance loss: 0.61576 
Train step: 3620 acc:0.96227 total_loss: 0.2729  loss:0.12957,stance loss: 0.097333 
Train step: 3630 acc:0.96333 total_loss: 0.27291  loss:0.037322,stance loss: 0.013302 
Train step: 3640 acc:0.96469 total_loss: 0.27144  loss:0.22038,stance loss: 0.21253 
Train step: 3650 acc:0.96454 total_loss: 0.26347  loss:0.04088,stance loss: 0.018067 
Train step: 3660 acc:0.96482 total_loss: 0.26912  loss:0.8455,stance loss: 1.268 
Train step: 3670 acc:0.96351 total_loss: 0.27675  loss:0.21887,stance loss: 0.26524 
Train step: 3680 acc:0.96418 total_loss: 0.27526  loss:0.13461,stance loss: 0.09121 
Train step: 3690 acc:0.9634 total_loss: 0.27824  loss:0.081784,stance loss: 0.0638 
Train step: 3700 acc:0.96302 total_loss: 0.28087  loss:0.16916,stance loss: 0.062 
Train step: 3710 acc:0.96269 total_loss: 0.27754  loss:0.086521,stance loss: 0.012178 
Train step: 3720 acc:0.96179 total_loss: 0.27909  loss:0.04417,stance loss: 0.0078523 
Train step: 3730 acc:0.96267 total_loss: 0.27698  loss:0.066006,stance loss: 0.032992 
Train step: 3740 acc:0.96347 total_loss: 0.27575  loss:0.37404,stance loss: 0.36373 
Train step: 3750 acc:0.96343 total_loss: 0.28282  loss:0.053271,stance loss: 0.01413 
Train step: 3760 acc:0.96315 total_loss: 0.28509  loss:0.8205,stance loss: 0.79337 
Train step: 3770 acc:0.96312 total_loss: 0.28609  loss:0.33115,stance loss: 0.3588 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.9375 total_loss: 0.90738  loss:0.90738,stance loss: 1.0078 
Train step: 3790 acc:0.97159 total_loss: 0.18335  loss:0.046006,stance loss: 0.0021362 
Train step: 3800 acc:0.97619 total_loss: 0.20767  loss:0.032468,stance loss: 0.0047872 
Train step: 3810 acc:0.96573 total_loss: 0.21906  loss:0.34719,stance loss: 0.26642 
Train step: 3820 acc:0.96341 total_loss: 0.206  loss:0.18272,stance loss: 0.078785 
Train step: 3830 acc:0.96201 total_loss: 0.20863  loss:0.062604,stance loss: 0.048877 
Train step: 3840 acc:0.96619 total_loss: 0.19875  loss:0.090511,stance loss: 0.022355 
Train step: 3850 acc:0.96479 total_loss: 0.21592  loss:0.65068,stance loss: 1.0703 
Train step: 3860 acc:0.96836 total_loss: 0.20462  loss:0.040362,stance loss: 0.02126 
Train step: 3870 acc:0.96772 total_loss: 0.21343  loss:0.099698,stance loss: 0.078853 
Train step: 3880 acc:0.96906 total_loss: 0.2073  loss:0.05162,stance loss: 0.011022 
Train step: 3890 acc:0.97128 total_loss: 0.19424  loss:0.029393,stance loss: 0.0040188 
Train step: 3900 acc:0.97107 total_loss: 0.18767  loss:0.061899,stance loss: 0.016306 
Train step: 3910 acc:0.97185 total_loss: 0.18909  loss:0.038474,stance loss: 0.0071273 
Train step: 3920 acc:0.97074 total_loss: 0.19249  loss:0.075276,stance loss: 0.043105 
Train step: 3930 acc:0.97227 total_loss: 0.19354  loss:0.046007,stance loss: 0.010918 
Train step: 3940 acc:0.97205 total_loss: 0.19627  loss:0.34364,stance loss: 0.28024 
Train step: 3950 acc:0.97222 total_loss: 0.19999  loss:0.049107,stance loss: 0.015213 
Train step: 3960 acc:0.97099 total_loss: 0.20662  loss:1.0791,stance loss: 1.467 
Train step: 3970 acc:0.97186 total_loss: 0.20479  loss:0.10867,stance loss: 0.0032961 
Train step: 3980 acc:0.97139 total_loss: 0.20303  loss:0.48525,stance loss: 0.56296 
Train step: 3990 acc:0.97186 total_loss: 0.19894  loss:0.022601,stance loss: 0.0023705 
Train step: 4000 acc:0.97087 total_loss: 0.20546  loss:0.4441,stance loss: 0.36526 
Train step: 4010 acc:0.9697 total_loss: 0.21197  loss:0.18703,stance loss: 0.1419 
Train step: 4020 acc:0.96992 total_loss: 0.21059  loss:0.052482,stance loss: 0.0077957 
Train step: 4030 acc:0.97062 total_loss: 0.21401  loss:0.053009,stance loss: 0.0040936 
Train step: 4040 acc:0.97007 total_loss: 0.21405  loss:0.19402,stance loss: 0.085642 
Training finished.


Reload the best model with best f1 0.3378667211217753 from path test_outputs/bert-cross-topic/cc/2023-08-14 14-17-43/state_dict


              precision    recall  f1-score   support

           0   0.044610  0.461538  0.081356        26
           1   0.825758  0.536946  0.650746       203
           2   0.907975  0.441791  0.594378       335

    accuracy                       0.476950       564
   macro avg   0.592781  0.480092  0.442160       564
weighted avg   0.838582  0.476950  0.591016       564

Test Acc: 0.4769503546099291 F1_ma:0.3378667211217753
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.3378667211217753
acc: 0.4769503546099291, f1 :0.44215990363342234
classification report: 
              precision    recall  f1-score   support

         Con     0.0446    0.4615    0.0814        26
        None     0.8258    0.5369    0.6507       203
         Pro     0.9080    0.4418    0.5944       335

    accuracy                         0.4770       564
   macro avg     0.5928    0.4801    0.4422       564
weighted avg     0.8386    0.4770    0.5910       564

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 14-35-11', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 14-35-11
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.6875 total_loss: 1.8173  loss:1.8173,stance loss: 1.6925 
Train step: 10 acc:0.5625 total_loss: 1.7943  loss:2.097,stance loss: 2.0474 
Better F1! Saving model!
Saving model of best f1: 0.04301075268817205
              precision    recall  f1-score   support

           0   0.045558  0.769231  0.086022        26
           1   0.760000  0.467980  0.579268       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.203901       564
   macro avg   0.268519  0.412404  0.221763       564
weighted avg   0.275646  0.203901  0.212461       564

Test Acc: 0.20390070921985815 F1_ma:0.04301075268817205
Train step: 20 acc:0.52679 total_loss: 1.8921  loss:1.6905,stance loss: 1.4475 
Better F1! Saving model!
Saving model of best f1: 0.043209876543209874
              precision    recall  f1-score   support

           0   0.045652  0.807692  0.086420        26
           1   0.798077  0.408867  0.540717       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.184397       564
   macro avg   0.281243  0.405520  0.209045       564
weighted avg   0.289356  0.184397  0.198604       564

Test Acc: 0.18439716312056736 F1_ma:0.043209876543209874
Train step: 30 acc:0.54032 total_loss: 1.9001  loss:2.1018,stance loss: 2.1881 
Better F1! Saving model!
Saving model of best f1: 0.05714285714285715
              precision    recall  f1-score   support

           0   0.062284  0.692308  0.114286        26
           1   0.647273  0.876847  0.744770       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.347518       564
   macro avg   0.236519  0.523052  0.286352       564
weighted avg   0.235844  0.347518  0.273333       564

Test Acc: 0.3475177304964539 F1_ma:0.05714285714285715
Train step: 40 acc:0.53354 total_loss: 1.8577  loss:1.5829,stance loss: 1.051 
Train step: 50 acc:0.54412 total_loss: 1.8264  loss:1.8061,stance loss: 1.8251 
Train step: 60 acc:0.55533 total_loss: 1.7928  loss:1.5406,stance loss: 1.0626 
Train step: 70 acc:0.54842 total_loss: 1.767  loss:1.7292,stance loss: 1.2034 
Train step: 80 acc:0.55324 total_loss: 1.735  loss:1.3192,stance loss: 0.92901 
Train step: 90 acc:0.56456 total_loss: 1.7062  loss:1.2231,stance loss: 0.78664 
Train step: 100 acc:0.56993 total_loss: 1.6795  loss:1.3647,stance loss: 0.94063 
Train step: 110 acc:0.5625 total_loss: 1.6685  loss:1.6891,stance loss: 1.1966 
Train step: 120 acc:0.55992 total_loss: 1.6562  loss:1.6045,stance loss: 0.99525 
Train step: 130 acc:0.56107 total_loss: 1.64  loss:1.7265,stance loss: 1.5246 
Train step: 140 acc:0.55718 total_loss: 1.6324  loss:1.4221,stance loss: 0.92697 
Train step: 150 acc:0.55795 total_loss: 1.6293  loss:1.2881,stance loss: 0.82125 
Train step: 160 acc:0.55862 total_loss: 1.624  loss:1.3847,stance loss: 0.92448 
Train step: 170 acc:0.55958 total_loss: 1.617  loss:1.3637,stance loss: 1.0268 
Train step: 180 acc:0.56146 total_loss: 1.6078  loss:1.3505,stance loss: 0.92094 
Train step: 190 acc:0.56348 total_loss: 1.6068  loss:1.3355,stance loss: 0.97885 
Train step: 200 acc:0.55752 total_loss: 1.6083  loss:1.5012,stance loss: 1.2572 
Train step: 210 acc:0.55509 total_loss: 1.6008  loss:1.3779,stance loss: 1.0107 
Train step: 220 acc:0.55486 total_loss: 1.6007  loss:1.509,stance loss: 1.0745 
Train step: 230 acc:0.55601 total_loss: 1.5951  loss:1.7366,stance loss: 1.7408 
Train step: 240 acc:0.55913 total_loss: 1.5885  loss:1.429,stance loss: 1.1379 
Train step: 250 acc:0.55876 total_loss: 1.5843  loss:1.5762,stance loss: 1.2312 
Train step: 260 acc:0.55771 total_loss: 1.579  loss:1.482,stance loss: 1.0456 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.6875 total_loss: 1.1322  loss:1.1322,stance loss: 0.71628 
Train step: 280 acc:0.61364 total_loss: 1.4067  loss:1.4218,stance loss: 1.1193 
Train step: 290 acc:0.58631 total_loss: 1.4374  loss:1.5622,stance loss: 1.0719 
Train step: 300 acc:0.60081 total_loss: 1.4201  loss:1.0918,stance loss: 0.68784 
Train step: 310 acc:0.59756 total_loss: 1.4117  loss:1.0567,stance loss: 0.46985 
Train step: 320 acc:0.58578 total_loss: 1.4378  loss:1.5333,stance loss: 1.1376 
Train step: 330 acc:0.58197 total_loss: 1.4384  loss:1.466,stance loss: 1.4775 
Train step: 340 acc:0.58979 total_loss: 1.4331  loss:1.2134,stance loss: 0.80581 
Train step: 350 acc:0.58256 total_loss: 1.4334  loss:1.902,stance loss: 1.8878 
Train step: 360 acc:0.58654 total_loss: 1.431  loss:1.389,stance loss: 1.0313 
Train step: 370 acc:0.58292 total_loss: 1.4328  loss:1.4898,stance loss: 0.98953 
Train step: 380 acc:0.58164 total_loss: 1.431  loss:1.5738,stance loss: 1.2729 
Train step: 390 acc:0.57851 total_loss: 1.4408  loss:1.4665,stance loss: 1.1762 
Train step: 400 acc:0.58015 total_loss: 1.4376  loss:1.2043,stance loss: 0.85111 
Train step: 410 acc:0.57801 total_loss: 1.4331  loss:1.5327,stance loss: 1.141 
Train step: 420 acc:0.57864 total_loss: 1.4272  loss:1.3552,stance loss: 0.92753 
Train step: 430 acc:0.5823 total_loss: 1.4212  loss:1.5117,stance loss: 1.6194 
Train step: 440 acc:0.5848 total_loss: 1.4174  loss:1.3939,stance loss: 1.5093 
Train step: 450 acc:0.58702 total_loss: 1.4141  loss:1.6695,stance loss: 1.7324 
Train step: 460 acc:0.59031 total_loss: 1.4077  loss:1.3748,stance loss: 1.4572 
Train step: 470 acc:0.59359 total_loss: 1.3988  loss:1.1512,stance loss: 0.80895 
Train step: 480 acc:0.59331 total_loss: 1.3998  loss:1.554,stance loss: 1.1727 
Train step: 490 acc:0.59417 total_loss: 1.4017  loss:1.3245,stance loss: 0.84227 
Train step: 500 acc:0.59416 total_loss: 1.3984  loss:1.2596,stance loss: 0.87273 
Train step: 510 acc:0.59829 total_loss: 1.3967  loss:1.5276,stance loss: 1.6903 
Train step: 520 acc:0.59985 total_loss: 1.3907  loss:0.98211,stance loss: 0.72261 
Train step: 530 acc:0.60177 total_loss: 1.3818  loss:0.96072,stance loss: 0.71557 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.5625 total_loss: 1.3383  loss:1.3383,stance loss: 0.90868 
Train step: 550 acc:0.53977 total_loss: 1.4271  loss:1.9851,stance loss: 1.748 
Train step: 560 acc:0.61905 total_loss: 1.2975  loss:1.0771,stance loss: 0.73851 
Train step: 570 acc:0.62903 total_loss: 1.3086  loss:1.2402,stance loss: 0.73499 
Better F1! Saving model!
Saving model of best f1: 0.07171314741035857
              precision    recall  f1-score   support

           0   0.080000  0.692308  0.143426        26
           1   0.572271  0.955665  0.715867       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.375887       564
   macro avg   0.217424  0.549324  0.286431       564
weighted avg   0.209665  0.375887  0.264273       564

Test Acc: 0.375886524822695 F1_ma:0.07171314741035857
Train step: 580 acc:0.62957 total_loss: 1.3099  loss:1.1356,stance loss: 0.88864 
Train step: 590 acc:0.62623 total_loss: 1.31  loss:1.3636,stance loss: 0.96603 
Train step: 600 acc:0.625 total_loss: 1.3103  loss:1.133,stance loss: 0.90341 
Train step: 610 acc:0.62676 total_loss: 1.3161  loss:1.5767,stance loss: 1.567 
Train step: 620 acc:0.6304 total_loss: 1.3118  loss:1.3514,stance loss: 0.95811 
Train step: 630 acc:0.63049 total_loss: 1.2983  loss:1.4147,stance loss: 1.0407 
Train step: 640 acc:0.6349 total_loss: 1.2979  loss:0.99923,stance loss: 0.6875 
Train step: 650 acc:0.63288 total_loss: 1.2981  loss:1.4842,stance loss: 1.4897 
Train step: 660 acc:0.63326 total_loss: 1.29  loss:1.1446,stance loss: 0.79432 
Train step: 670 acc:0.63502 total_loss: 1.2841  loss:1.5211,stance loss: 1.3059 
Train step: 680 acc:0.62943 total_loss: 1.2926  loss:1.2141,stance loss: 1.3333 
Train step: 690 acc:0.63411 total_loss: 1.2917  loss:1.4895,stance loss: 1.1229 
Train step: 700 acc:0.63587 total_loss: 1.2884  loss:1.0344,stance loss: 0.77343 
Train step: 710 acc:0.63341 total_loss: 1.2906  loss:1.5842,stance loss: 0.93124 
Train step: 720 acc:0.63605 total_loss: 1.2848  loss:0.9167,stance loss: 0.69252 
Train step: 730 acc:0.63547 total_loss: 1.2852  loss:1.104,stance loss: 0.70932 
Train step: 740 acc:0.63713 total_loss: 1.2787  loss:1.3892,stance loss: 0.98752 
Train step: 750 acc:0.63626 total_loss: 1.2816  loss:1.6127,stance loss: 1.2502 
Train step: 760 acc:0.63886 total_loss: 1.281  loss:1.25,stance loss: 0.90564 
Train step: 770 acc:0.64177 total_loss: 1.2768  loss:1.1784,stance loss: 0.82606 
Train step: 780 acc:0.64263 total_loss: 1.2743  loss:0.91037,stance loss: 0.67456 
Train step: 790 acc:0.64442 total_loss: 1.2768  loss:1.683,stance loss: 1.7856 
Train step: 800 acc:0.64416 total_loss: 1.2787  loss:1.1016,stance loss: 0.74488 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.625 total_loss: 1.255  loss:1.255,stance loss: 0.8661 
Train step: 820 acc:0.66477 total_loss: 1.2821  loss:1.0661,stance loss: 0.76044 
Train step: 830 acc:0.66964 total_loss: 1.2601  loss:1.2329,stance loss: 0.87993 
Train step: 840 acc:0.68145 total_loss: 1.242  loss:1.1248,stance loss: 0.81078 
Train step: 850 acc:0.68598 total_loss: 1.2438  loss:1.4407,stance loss: 1.1338 
Train step: 860 acc:0.6826 total_loss: 1.2363  loss:0.93853,stance loss: 0.61538 
Train step: 870 acc:0.68135 total_loss: 1.2449  loss:1.1708,stance loss: 0.93373 
Train step: 880 acc:0.68134 total_loss: 1.2238  loss:1.0247,stance loss: 1.1023 
Train step: 890 acc:0.67978 total_loss: 1.2209  loss:1.0831,stance loss: 0.80575 
Train step: 900 acc:0.67582 total_loss: 1.2298  loss:1.2226,stance loss: 0.87806 
Train step: 910 acc:0.67141 total_loss: 1.2371  loss:1.1969,stance loss: 0.84509 
Train step: 920 acc:0.66723 total_loss: 1.2338  loss:1.491,stance loss: 1.1119 
Train step: 930 acc:0.66736 total_loss: 1.2344  loss:1.3503,stance loss: 1.0055 
Train step: 940 acc:0.66412 total_loss: 1.2392  loss:1.1862,stance loss: 1.3615 
Train step: 950 acc:0.67021 total_loss: 1.225  loss:1.5794,stance loss: 1.5798 
Train step: 960 acc:0.6697 total_loss: 1.2281  loss:1.5424,stance loss: 1.7537 
Train step: 970 acc:0.66615 total_loss: 1.2243  loss:1.0194,stance loss: 0.76329 
Train step: 980 acc:0.66374 total_loss: 1.2209  loss:1.1934,stance loss: 0.83074 
Train step: 990 acc:0.66506 total_loss: 1.2181  loss:1.3721,stance loss: 1.5118 
Train step: 1000 acc:0.66459 total_loss: 1.2205  loss:1.1835,stance loss: 0.82924 
Train step: 1010 acc:0.66636 total_loss: 1.2241  loss:0.92396,stance loss: 0.5894 
Train step: 1020 acc:0.66617 total_loss: 1.2271  loss:1.198,stance loss: 0.82415 
Train step: 1030 acc:0.6677 total_loss: 1.2302  loss:1.3137,stance loss: 1.4556 
Train step: 1040 acc:0.66667 total_loss: 1.2339  loss:1.3526,stance loss: 0.92596 
Train step: 1050 acc:0.66416 total_loss: 1.2382  loss:1.1203,stance loss: 0.8234 
Train step: 1060 acc:0.66609 total_loss: 1.2382  loss:1.1669,stance loss: 0.87213 
Train step: 1070 acc:0.66691 total_loss: 1.2398  loss:1.5932,stance loss: 1.2007 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.5625 total_loss: 1.2776  loss:1.2776,stance loss: 1.0053 
Train step: 1090 acc:0.61364 total_loss: 1.2816  loss:1.758,stance loss: 1.8749 
Train step: 1100 acc:0.6131 total_loss: 1.2596  loss:1.4631,stance loss: 1.2874 
Train step: 1110 acc:0.63306 total_loss: 1.2164  loss:0.93811,stance loss: 0.65543 
Train step: 1120 acc:0.64177 total_loss: 1.193  loss:1.0285,stance loss: 1.0892 
Train step: 1130 acc:0.65931 total_loss: 1.1725  loss:1.5312,stance loss: 1.4966 
Train step: 1140 acc:0.66393 total_loss: 1.176  loss:1.4542,stance loss: 1.0842 
Train step: 1150 acc:0.66021 total_loss: 1.1938  loss:1.842,stance loss: 1.8191 
Train step: 1160 acc:0.66204 total_loss: 1.2009  loss:1.0659,stance loss: 0.80485 
Train step: 1170 acc:0.66415 total_loss: 1.2136  loss:1.6943,stance loss: 1.7841 
Train step: 1180 acc:0.67203 total_loss: 1.2135  loss:1.6786,stance loss: 1.2366 
Train step: 1190 acc:0.67286 total_loss: 1.2067  loss:1.0428,stance loss: 0.77707 
Train step: 1200 acc:0.67562 total_loss: 1.1985  loss:1.0793,stance loss: 0.7735 
Train step: 1210 acc:0.6751 total_loss: 1.2023  loss:1.1218,stance loss: 0.7819 
Train step: 1220 acc:0.67465 total_loss: 1.1999  loss:1.2462,stance loss: 0.92731 
Train step: 1230 acc:0.6755 total_loss: 1.1903  loss:0.93378,stance loss: 0.70765 
Train step: 1240 acc:0.67857 total_loss: 1.186  loss:0.97526,stance loss: 0.79447 
Train step: 1250 acc:0.67982 total_loss: 1.1837  loss:1.1788,stance loss: 1.4018 
Train step: 1260 acc:0.68405 total_loss: 1.1731  loss:0.91314,stance loss: 0.65421 
Train step: 1270 acc:0.68194 total_loss: 1.1812  loss:0.9601,stance loss: 0.78228 
Train step: 1280 acc:0.68315 total_loss: 1.1855  loss:0.92432,stance loss: 0.72977 
Train step: 1290 acc:0.68335 total_loss: 1.1884  loss:1.0691,stance loss: 0.70508 
Train step: 1300 acc:0.68411 total_loss: 1.1923  loss:1.2632,stance loss: 1.4738 
Train step: 1310 acc:0.68128 total_loss: 1.1917  loss:1.1167,stance loss: 0.75496 
Train step: 1320 acc:0.68231 total_loss: 1.1876  loss:1.0129,stance loss: 0.77277 
Train step: 1330 acc:0.68177 total_loss: 1.19  loss:1.3156,stance loss: 0.91368 
Train step: 1340 acc:0.68175 total_loss: 1.1914  loss:0.96367,stance loss: 0.71241 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.75 total_loss: 1.2361  loss:1.2361,stance loss: 0.98694 
Train step: 1360 acc:0.63636 total_loss: 1.165  loss:0.91189,stance loss: 0.6599 
Train step: 1370 acc:0.6994 total_loss: 1.107  loss:1.0224,stance loss: 1.1577 
Train step: 1380 acc:0.69556 total_loss: 1.1031  loss:0.79866,stance loss: 0.49462 
Train step: 1390 acc:0.69665 total_loss: 1.1009  loss:1.265,stance loss: 1.0712 
Train step: 1400 acc:0.70098 total_loss: 1.1054  loss:1.6666,stance loss: 1.4805 
Train step: 1410 acc:0.69467 total_loss: 1.1184  loss:1.3513,stance loss: 0.98651 
Train step: 1420 acc:0.69542 total_loss: 1.1083  loss:1.0325,stance loss: 0.72325 
Train step: 1430 acc:0.68673 total_loss: 1.1117  loss:0.98194,stance loss: 0.72408 
Train step: 1440 acc:0.69231 total_loss: 1.1077  loss:1.3681,stance loss: 0.96061 
Train step: 1450 acc:0.6974 total_loss: 1.1059  loss:0.90166,stance loss: 0.65431 
Train step: 1460 acc:0.69426 total_loss: 1.1093  loss:1.1424,stance loss: 0.84473 
Train step: 1470 acc:0.69731 total_loss: 1.1016  loss:1.1618,stance loss: 0.93824 
Train step: 1480 acc:0.69561 total_loss: 1.0997  loss:1.1918,stance loss: 0.93863 
Train step: 1490 acc:0.69016 total_loss: 1.1135  loss:1.0845,stance loss: 0.81785 
Train step: 1500 acc:0.69164 total_loss: 1.1127  loss:1.0345,stance loss: 0.84553 
Train step: 1510 acc:0.69371 total_loss: 1.1069  loss:0.80533,stance loss: 0.53618 
Train step: 1520 acc:0.69079 total_loss: 1.1134  loss:1.2868,stance loss: 0.93436 
Train step: 1530 acc:0.68923 total_loss: 1.1129  loss:1.3521,stance loss: 0.86485 
Train step: 1540 acc:0.69208 total_loss: 1.1086  loss:0.85773,stance loss: 0.56388 
Train step: 1550 acc:0.69434 total_loss: 1.1062  loss:1.4513,stance loss: 1.5508 
Train step: 1560 acc:0.6952 total_loss: 1.1079  loss:0.76094,stance loss: 0.55249 
Train step: 1570 acc:0.69796 total_loss: 1.1023  loss:0.67925,stance loss: 0.49321 
Train step: 1580 acc:0.69778 total_loss: 1.1094  loss:1.4808,stance loss: 1.2214 
Train step: 1590 acc:0.70124 total_loss: 1.1036  loss:0.73608,stance loss: 0.487 
Train step: 1600 acc:0.7007 total_loss: 1.1042  loss:1.5939,stance loss: 1.751 
Train step: 1610 acc:0.70235 total_loss: 1.1012  loss:0.87111,stance loss: 0.60015 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.5625 total_loss: 1.458  loss:1.458,stance loss: 1.1271 
Train step: 1630 acc:0.73295 total_loss: 0.9735  loss:1.0322,stance loss: 0.83872 
Train step: 1640 acc:0.72321 total_loss: 1.0395  loss:1.0322,stance loss: 1.2205 
Train step: 1650 acc:0.73992 total_loss: 1.0118  loss:0.87679,stance loss: 0.72046 
Train step: 1660 acc:0.71189 total_loss: 1.0431  loss:1.1283,stance loss: 0.8618 
Train step: 1670 acc:0.71691 total_loss: 1.0155  loss:0.9554,stance loss: 0.77534 
Train step: 1680 acc:0.70799 total_loss: 1.0499  loss:1.991,stance loss: 1.7559 
Train step: 1690 acc:0.70158 total_loss: 1.0875  loss:1.152,stance loss: 1.3868 
Train step: 1700 acc:0.6983 total_loss: 1.079  loss:0.74161,stance loss: 0.51795 
Train step: 1710 acc:0.70192 total_loss: 1.0827  loss:1.1965,stance loss: 1.3552 
Train step: 1720 acc:0.7005 total_loss: 1.0812  loss:0.89158,stance loss: 0.60927 
Train step: 1730 acc:0.69989 total_loss: 1.0849  loss:0.98703,stance loss: 0.74089 
Train step: 1740 acc:0.70506 total_loss: 1.0682  loss:0.87031,stance loss: 0.51168 
Train step: 1750 acc:0.70515 total_loss: 1.071  loss:1.5503,stance loss: 1.3236 
Train step: 1760 acc:0.70922 total_loss: 1.0614  loss:0.86402,stance loss: 0.55897 
Train step: 1770 acc:0.70985 total_loss: 1.0598  loss:0.95935,stance loss: 0.73731 
Train step: 1780 acc:0.71351 total_loss: 1.0596  loss:1.5153,stance loss: 1.5773 
Train step: 1790 acc:0.71491 total_loss: 1.0615  loss:0.89348,stance loss: 0.65792 
Train step: 1800 acc:0.71478 total_loss: 1.0546  loss:0.72582,stance loss: 0.58889 
Train step: 1810 acc:0.71499 total_loss: 1.0525  loss:0.63915,stance loss: 0.49277 
Train step: 1820 acc:0.71331 total_loss: 1.0549  loss:1.1194,stance loss: 0.79791 
Train step: 1830 acc:0.71179 total_loss: 1.054  loss:1.0016,stance loss: 0.8219 
Train step: 1840 acc:0.71267 total_loss: 1.0515  loss:0.92574,stance loss: 0.76198 
Train step: 1850 acc:0.71402 total_loss: 1.0449  loss:0.70458,stance loss: 0.54612 
Train step: 1860 acc:0.71525 total_loss: 1.0503  loss:1.2818,stance loss: 1.482 
Train step: 1870 acc:0.71439 total_loss: 1.0476  loss:0.97515,stance loss: 0.75324 
Train step: 1880 acc:0.71336 total_loss: 1.05  loss:1.151,stance loss: 0.9048 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.6875 total_loss: 1.1126  loss:1.1126,stance loss: 0.97423 
Train step: 1900 acc:0.71591 total_loss: 1.1229  loss:1.0429,stance loss: 0.83128 
Train step: 1910 acc:0.71131 total_loss: 1.1278  loss:0.90773,stance loss: 0.70244 
Train step: 1920 acc:0.70363 total_loss: 1.084  loss:0.83837,stance loss: 0.59256 
Train step: 1930 acc:0.71341 total_loss: 1.038  loss:0.67176,stance loss: 0.48037 
Train step: 1940 acc:0.71201 total_loss: 1.0313  loss:0.94253,stance loss: 1.0779 
Train step: 1950 acc:0.71516 total_loss: 1.0378  loss:0.8585,stance loss: 0.61008 
Train step: 1960 acc:0.72623 total_loss: 1.0064  loss:0.21491,stance loss: 0.014426 
Train step: 1970 acc:0.73225 total_loss: 0.98479  loss:1.1511,stance loss: 1.092 
Train step: 1980 acc:0.73558 total_loss: 0.96969  loss:0.69388,stance loss: 0.50676 
Train step: 1990 acc:0.73267 total_loss: 0.96976  loss:0.97439,stance loss: 0.65956 
Train step: 2000 acc:0.73311 total_loss: 0.97438  loss:0.92213,stance loss: 0.67322 
Train step: 2010 acc:0.73347 total_loss: 0.97446  loss:1.0751,stance loss: 0.81598 
Train step: 2020 acc:0.73569 total_loss: 0.96449  loss:0.66994,stance loss: 0.49674 
Train step: 2030 acc:0.73892 total_loss: 0.95139  loss:0.56989,stance loss: 0.40179 
Train step: 2040 acc:0.74089 total_loss: 0.95961  loss:0.9852,stance loss: 1.1659 
Train step: 2050 acc:0.73641 total_loss: 0.97159  loss:0.96929,stance loss: 0.65152 
Train step: 2060 acc:0.73538 total_loss: 0.97763  loss:1.1423,stance loss: 1.1757 
Train step: 2070 acc:0.73791 total_loss: 0.96805  loss:1.0146,stance loss: 0.73882 
Train step: 2080 acc:0.73724 total_loss: 0.97472  loss:0.70463,stance loss: 0.58247 
Train step: 2090 acc:0.73881 total_loss: 0.97202  loss:0.64275,stance loss: 0.50378 
Train step: 2100 acc:0.73904 total_loss: 0.97051  loss:0.88097,stance loss: 0.72728 
Train step: 2110 acc:0.7401 total_loss: 0.97632  loss:1.0809,stance loss: 1.273 
Train step: 2120 acc:0.73945 total_loss: 0.97911  loss:1.0618,stance loss: 0.85938 
Train step: 2130 acc:0.73807 total_loss: 0.98041  loss:0.82949,stance loss: 0.65255 
Train step: 2140 acc:0.73581 total_loss: 0.98062  loss:1.1673,stance loss: 0.97747 
Train step: 2150 acc:0.73779 total_loss: 0.98087  loss:1.07,stance loss: 0.94186 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.6875 total_loss: 0.84086  loss:0.84086,stance loss: 0.64483 
Train step: 2170 acc:0.77841 total_loss: 0.86433  loss:0.54133,stance loss: 0.42326 
Train step: 2180 acc:0.75298 total_loss: 0.87727  loss:1.5677,stance loss: 1.6133 
Train step: 2190 acc:0.75403 total_loss: 0.84463  loss:0.6153,stance loss: 0.43765 
Train step: 2200 acc:0.7622 total_loss: 0.82123  loss:0.71731,stance loss: 0.4918 
Train step: 2210 acc:0.76225 total_loss: 0.84972  loss:1.026,stance loss: 0.75186 
Train step: 2220 acc:0.76025 total_loss: 0.88962  loss:0.92016,stance loss: 0.76463 
Train step: 2230 acc:0.75968 total_loss: 0.8974  loss:1.2758,stance loss: 1.4815 
Train step: 2240 acc:0.76235 total_loss: 0.91313  loss:0.88563,stance loss: 0.71463 
Train step: 2250 acc:0.76442 total_loss: 0.90746  loss:0.68267,stance loss: 0.52378 
Train step: 2260 acc:0.76856 total_loss: 0.91071  loss:1.281,stance loss: 1.5434 
Train step: 2270 acc:0.76858 total_loss: 0.90493  loss:0.57949,stance loss: 0.46612 
Train step: 2280 acc:0.76808 total_loss: 0.89792  loss:0.60147,stance loss: 0.32994 
Train step: 2290 acc:0.76336 total_loss: 0.89399  loss:0.6556,stance loss: 0.5103 
Train step: 2300 acc:0.7602 total_loss: 0.89687  loss:1.1832,stance loss: 1.4694 
Train step: 2310 acc:0.75952 total_loss: 0.89965  loss:1.1453,stance loss: 0.69301 
Train step: 2320 acc:0.75466 total_loss: 0.90173  loss:1.6088,stance loss: 1.7531 
Train step: 2330 acc:0.75621 total_loss: 0.90003  loss:0.80441,stance loss: 0.60523 
Train step: 2340 acc:0.75725 total_loss: 0.89751  loss:0.72069,stance loss: 0.55461 
Train step: 2350 acc:0.75884 total_loss: 0.8898  loss:0.74442,stance loss: 0.57887 
Train step: 2360 acc:0.75715 total_loss: 0.89019  loss:0.90239,stance loss: 0.66474 
Train step: 2370 acc:0.75889 total_loss: 0.88378  loss:0.48407,stance loss: 0.36633 
Train step: 2380 acc:0.75877 total_loss: 0.88788  loss:0.70574,stance loss: 0.58511 
Train step: 2390 acc:0.75839 total_loss: 0.88864  loss:0.83673,stance loss: 0.72448 
Train step: 2400 acc:0.75882 total_loss: 0.88869  loss:0.79888,stance loss: 0.53509 
Train step: 2410 acc:0.75847 total_loss: 0.88604  loss:0.70208,stance loss: 0.50975 
Train step: 2420 acc:0.75934 total_loss: 0.88993  loss:1.0754,stance loss: 1.287 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.875 total_loss: 1.0499  loss:1.0499,stance loss: 1.3069 
Train step: 2440 acc:0.78977 total_loss: 0.87314  loss:0.71044,stance loss: 0.55771 
Train step: 2450 acc:0.79464 total_loss: 0.83627  loss:1.3648,stance loss: 1.6136 
Train step: 2460 acc:0.78831 total_loss: 0.80113  loss:0.88998,stance loss: 0.68419 
Train step: 2470 acc:0.79116 total_loss: 0.80194  loss:0.82345,stance loss: 0.5529 
Train step: 2480 acc:0.79044 total_loss: 0.7901  loss:0.66334,stance loss: 0.44646 
Train step: 2490 acc:0.78791 total_loss: 0.8096  loss:1.1649,stance loss: 1.3326 
Train step: 2500 acc:0.78785 total_loss: 0.80627  loss:0.62637,stance loss: 0.48558 
Train step: 2510 acc:0.7909 total_loss: 0.79709  loss:0.28734,stance loss: 0.076797 
Train step: 2520 acc:0.78709 total_loss: 0.79764  loss:0.78924,stance loss: 0.66669 
Train step: 2530 acc:0.78713 total_loss: 0.80762  loss:1.2779,stance loss: 1.2691 
Train step: 2540 acc:0.78604 total_loss: 0.80665  loss:0.99301,stance loss: 0.71394 
Train step: 2550 acc:0.78822 total_loss: 0.80491  loss:0.84179,stance loss: 0.66546 
Train step: 2560 acc:0.78531 total_loss: 0.80857  loss:0.77952,stance loss: 0.57756 
Train step: 2570 acc:0.78413 total_loss: 0.8181  loss:0.82501,stance loss: 0.6885 
Train step: 2580 acc:0.78767 total_loss: 0.81533  loss:0.84611,stance loss: 1.1854 
Train step: 2590 acc:0.78804 total_loss: 0.81037  loss:0.55564,stance loss: 0.41641 
Train step: 2600 acc:0.78253 total_loss: 0.81611  loss:0.8329,stance loss: 0.56244 
Train step: 2610 acc:0.78246 total_loss: 0.816  loss:0.97942,stance loss: 0.62834 
Train step: 2620 acc:0.78403 total_loss: 0.81519  loss:0.93305,stance loss: 0.77124 
Train step: 2630 acc:0.78358 total_loss: 0.81392  loss:0.78369,stance loss: 0.64039 
Train step: 2640 acc:0.78021 total_loss: 0.81474  loss:0.9016,stance loss: 0.71686 
Train step: 2650 acc:0.78026 total_loss: 0.81588  loss:0.75254,stance loss: 0.53216 
Train step: 2660 acc:0.77976 total_loss: 0.81465  loss:0.59674,stance loss: 0.46395 
Train step: 2670 acc:0.78138 total_loss: 0.811  loss:0.81121,stance loss: 1.171 
Train step: 2680 acc:0.78312 total_loss: 0.80464  loss:0.77495,stance loss: 0.53118 
Train step: 2690 acc:0.78305 total_loss: 0.80728  loss:0.72967,stance loss: 0.53874 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.875 total_loss: 0.63505  loss:0.63505,stance loss: 0.44263 
Train step: 2710 acc:0.83523 total_loss: 0.7396  loss:0.4363,stance loss: 0.36757 
Train step: 2720 acc:0.83036 total_loss: 0.74967  loss:0.64284,stance loss: 0.44879 
Train step: 2730 acc:0.8246 total_loss: 0.71902  loss:0.55324,stance loss: 0.54641 
Train step: 2740 acc:0.8247 total_loss: 0.72955  loss:0.88679,stance loss: 0.61516 
Train step: 2750 acc:0.8223 total_loss: 0.73434  loss:0.67964,stance loss: 0.46931 
Train step: 2760 acc:0.82172 total_loss: 0.73612  loss:0.4217,stance loss: 0.35093 
Train step: 2770 acc:0.82306 total_loss: 0.74374  loss:0.34999,stance loss: 0.2979 
Train step: 2780 acc:0.82099 total_loss: 0.74819  loss:0.96101,stance loss: 0.68093 
Train step: 2790 acc:0.81731 total_loss: 0.77119  loss:0.61035,stance loss: 0.49213 
Train step: 2800 acc:0.81745 total_loss: 0.76085  loss:0.51344,stance loss: 0.40616 
Train step: 2810 acc:0.81194 total_loss: 0.75962  loss:0.62499,stance loss: 0.48016 
Train step: 2820 acc:0.81147 total_loss: 0.77047  loss:0.44626,stance loss: 0.37424 
Better F1! Saving model!
Saving model of best f1: 0.0725417242479005
              precision    recall  f1-score   support

           0   0.049608  0.730769  0.092910        26
           1   0.807018  0.679803  0.737968       203
           2   0.900000  0.026866  0.052174       335

    accuracy                       0.294326       564
   macro avg   0.585542  0.479146  0.294350       564
weighted avg   0.827330  0.294326  0.300889       564

Test Acc: 0.29432624113475175 F1_ma:0.0725417242479005
Train step: 2830 acc:0.80916 total_loss: 0.76834  loss:0.72705,stance loss: 0.54793 
Better F1! Saving model!
Saving model of best f1: 0.07664042757138292
              precision    recall  f1-score   support

           0   0.051075  0.730769  0.095477        26
           1   0.795580  0.709360  0.750000       203
           2   0.909091  0.029851  0.057803       335

    accuracy                       0.306738       564
   macro avg   0.585249  0.489993  0.301094       564
weighted avg   0.828681  0.306738  0.308682       564

Test Acc: 0.3067375886524823 F1_ma:0.07664042757138292
Train step: 2840 acc:0.80895 total_loss: 0.77578  loss:0.92167,stance loss: 0.70946 
Train step: 2850 acc:0.81167 total_loss: 0.77083  loss:1.1792,stance loss: 1.4704 
Train step: 2860 acc:0.81366 total_loss: 0.76113  loss:0.60697,stance loss: 0.55928 
Train step: 2870 acc:0.81542 total_loss: 0.76348  loss:0.82851,stance loss: 1.0926 
Train step: 2880 acc:0.81561 total_loss: 0.75887  loss:0.82656,stance loss: 0.58823 
Train step: 2890 acc:0.81675 total_loss: 0.75005  loss:0.50469,stance loss: 0.4445 
Train step: 2900 acc:0.81592 total_loss: 0.75151  loss:1.1934,stance loss: 1.5175 
Better F1! Saving model!
Saving model of best f1: 0.09788106630211893
              precision    recall  f1-score   support

           0   0.058673  0.884615  0.110048        26
           1   0.815287  0.630542  0.711111       203
           2   1.000000  0.044776  0.085714       335

    accuracy                       0.294326       564
   macro avg   0.624653  0.519978  0.302291       564
weighted avg   0.890122  0.294326  0.311935       564

Test Acc: 0.29432624113475175 F1_ma:0.09788106630211893
Train step: 2910 acc:0.81517 total_loss: 0.74822  loss:0.57391,stance loss: 0.41502 
Better F1! Saving model!
Saving model of best f1: 0.10703658552571212
              precision    recall  f1-score   support

           0   0.056790  0.884615  0.106729        26
           1   0.842857  0.581281  0.688047       203
           2   1.000000  0.056716  0.107345       335

    accuracy                       0.283688       564
   macro avg   0.633216  0.507538  0.300707       564
weighted avg   0.899958  0.283688  0.316328       564

Test Acc: 0.28368794326241137 F1_ma:0.10703658552571212
Train step: 2920 acc:0.81702 total_loss: 0.7485  loss:0.53104,stance loss: 0.36877 
Train step: 2930 acc:0.81737 total_loss: 0.7423  loss:0.59459,stance loss: 0.47404 
Train step: 2940 acc:0.81872 total_loss: 0.73471  loss:0.40351,stance loss: 0.3476 
Train step: 2950 acc:0.81823 total_loss: 0.7359  loss:0.78935,stance loss: 1.1919 
Train step: 2960 acc:0.81777 total_loss: 0.73693  loss:0.70322,stance loss: 0.48931 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.875 total_loss: 0.58333  loss:0.58333,stance loss: 0.43305 
Train step: 2980 acc:0.84091 total_loss: 0.65729  loss:0.94389,stance loss: 0.69391 
Train step: 2990 acc:0.83631 total_loss: 0.64372  loss:0.47354,stance loss: 0.36468 
Train step: 3000 acc:0.83669 total_loss: 0.63757  loss:0.3122,stance loss: 0.12004 
Train step: 3010 acc:0.83994 total_loss: 0.62783  loss:1.1603,stance loss: 1.1436 
Train step: 3020 acc:0.84191 total_loss: 0.63681  loss:0.57229,stance loss: 0.48309 
Train step: 3030 acc:0.83811 total_loss: 0.67781  loss:0.79733,stance loss: 0.60574 
Train step: 3040 acc:0.83011 total_loss: 0.70878  loss:0.46585,stance loss: 0.41529 
Train step: 3050 acc:0.83102 total_loss: 0.70187  loss:0.97689,stance loss: 0.95238 
Train step: 3060 acc:0.83104 total_loss: 0.70516  loss:0.86371,stance loss: 1.1169 
Better F1! Saving model!
Saving model of best f1: 0.15291151856248808
              precision    recall  f1-score   support

           0   0.050746  0.653846  0.094183        26
           1   0.790323  0.724138  0.755784       203
           2   0.930233  0.119403  0.211640       335

    accuracy                       0.361702       564
   macro avg   0.590434  0.499129  0.353869       564
weighted avg   0.839331  0.361702  0.402079       564

Test Acc: 0.3617021276595745 F1_ma:0.15291151856248808
Train step: 3070 acc:0.83478 total_loss: 0.69024  loss:0.69861,stance loss: 0.56039 
Train step: 3080 acc:0.83333 total_loss: 0.69652  loss:0.39496,stance loss: 0.3046 
Train step: 3090 acc:0.83368 total_loss: 0.69912  loss:0.6429,stance loss: 0.46818 
Train step: 3100 acc:0.83588 total_loss: 0.69202  loss:0.75377,stance loss: 0.56501 
Train step: 3110 acc:0.83821 total_loss: 0.67957  loss:0.2929,stance loss: 0.25383 
Train step: 3120 acc:0.8394 total_loss: 0.67471  loss:0.71384,stance loss: 0.52515 
Train step: 3130 acc:0.83929 total_loss: 0.67888  loss:0.89545,stance loss: 0.81678 
Train step: 3140 acc:0.83553 total_loss: 0.67606  loss:0.92717,stance loss: 0.76204 
Train step: 3150 acc:0.83771 total_loss: 0.66979  loss:0.50518,stance loss: 0.48014 
Train step: 3160 acc:0.8377 total_loss: 0.67243  loss:0.6742,stance loss: 0.47026 
Train step: 3170 acc:0.84017 total_loss: 0.66593  loss:0.32389,stance loss: 0.2626 
Train step: 3180 acc:0.84123 total_loss: 0.65695  loss:0.1598,stance loss: 0.0062833 
Train step: 3190 acc:0.83908 total_loss: 0.65996  loss:0.6012,stance loss: 0.44383 
Train step: 3200 acc:0.84091 total_loss: 0.65549  loss:0.36321,stance loss: 0.26296 
Train step: 3210 acc:0.83869 total_loss: 0.65933  loss:0.99973,stance loss: 0.60712 
Train step: 3220 acc:0.84039 total_loss: 0.65959  loss:0.48673,stance loss: 0.41163 
Better F1! Saving model!
Saving model of best f1: 0.1592825419983265
              precision    recall  f1-score   support

           0   0.052786  0.692308  0.098093        26
           1   0.824859  0.719212  0.768421       203
           2   0.913043  0.125373  0.220472       335

    accuracy                       0.365248       564
   macro avg   0.596896  0.512298  0.362329       564
weighted avg   0.841646  0.365248  0.412053       564

Test Acc: 0.36524822695035464 F1_ma:0.1592825419983265
Train step: 3230 acc:0.84195 total_loss: 0.65839  loss:1.2568,stance loss: 1.4303 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.875 total_loss: 0.41685  loss:0.41685,stance loss: 0.31429 
Train step: 3250 acc:0.91477 total_loss: 0.55843  loss:0.65196,stance loss: 0.55907 
Train step: 3260 acc:0.91071 total_loss: 0.51747  loss:0.27035,stance loss: 0.20447 
Train step: 3270 acc:0.90323 total_loss: 0.5285  loss:0.38674,stance loss: 0.33085 
Train step: 3280 acc:0.89482 total_loss: 0.5336  loss:0.79647,stance loss: 0.75198 
Train step: 3290 acc:0.89828 total_loss: 0.5074  loss:0.25404,stance loss: 0.18951 
Train step: 3300 acc:0.89857 total_loss: 0.50041  loss:0.35992,stance loss: 0.28868 
Train step: 3310 acc:0.88556 total_loss: 0.54075  loss:0.80614,stance loss: 0.54724 
Train step: 3320 acc:0.88349 total_loss: 0.53858  loss:0.40964,stance loss: 0.30656 
Train step: 3330 acc:0.88599 total_loss: 0.5485  loss:0.40362,stance loss: 0.33783 
Train step: 3340 acc:0.88428 total_loss: 0.5509  loss:0.60775,stance loss: 0.40083 
Train step: 3350 acc:0.87894 total_loss: 0.57098  loss:1.5272,stance loss: 1.8929 
Train step: 3360 acc:0.87655 total_loss: 0.57292  loss:0.42141,stance loss: 0.36954 
Train step: 3370 acc:0.87691 total_loss: 0.57302  loss:0.69855,stance loss: 1.0729 
Train step: 3380 acc:0.87323 total_loss: 0.57584  loss:0.39134,stance loss: 0.31043 
Train step: 3390 acc:0.87376 total_loss: 0.58072  loss:0.86697,stance loss: 0.79912 
Train step: 3400 acc:0.87267 total_loss: 0.58767  loss:0.33804,stance loss: 0.2724 
Train step: 3410 acc:0.87025 total_loss: 0.5911  loss:0.58095,stance loss: 0.46172 
Train step: 3420 acc:0.87155 total_loss: 0.58434  loss:0.20606,stance loss: 0.18079 
Train step: 3430 acc:0.86944 total_loss: 0.58461  loss:0.48065,stance loss: 0.36158 
Train step: 3440 acc:0.87002 total_loss: 0.58225  loss:0.87447,stance loss: 1.0619 
Train step: 3450 acc:0.87085 total_loss: 0.58016  loss:0.63276,stance loss: 0.41606 
Train step: 3460 acc:0.87359 total_loss: 0.57875  loss:1.1822,stance loss: 1.5328 
Train step: 3470 acc:0.87175 total_loss: 0.57844  loss:0.71303,stance loss: 0.49479 
Train step: 3480 acc:0.87267 total_loss: 0.57857  loss:0.36301,stance loss: 0.28375 
Train step: 3490 acc:0.87102 total_loss: 0.58061  loss:0.3831,stance loss: 0.31712 
Train step: 3500 acc:0.87141 total_loss: 0.57578  loss:0.68576,stance loss: 0.72612 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.9375 total_loss: 0.38568  loss:0.38568,stance loss: 0.34432 
Train step: 3520 acc:0.92045 total_loss: 0.3916  loss:0.21243,stance loss: 0.16543 
Train step: 3530 acc:0.90774 total_loss: 0.48371  loss:0.41096,stance loss: 0.31311 
Train step: 3540 acc:0.90927 total_loss: 0.46675  loss:0.42014,stance loss: 0.34269 
Train step: 3550 acc:0.90244 total_loss: 0.4962  loss:0.49494,stance loss: 0.41946 
Train step: 3560 acc:0.90441 total_loss: 0.48244  loss:0.51636,stance loss: 0.37552 
Train step: 3570 acc:0.89959 total_loss: 0.50355  loss:0.55246,stance loss: 0.43827 
Train step: 3580 acc:0.89613 total_loss: 0.50248  loss:0.53964,stance loss: 0.43245 
Train step: 3590 acc:0.89352 total_loss: 0.50414  loss:0.44582,stance loss: 0.47234 
Train step: 3600 acc:0.89217 total_loss: 0.49454  loss:0.52767,stance loss: 0.47589 
Train step: 3610 acc:0.89109 total_loss: 0.49522  loss:0.40343,stance loss: 0.3142 
Train step: 3620 acc:0.88851 total_loss: 0.5009  loss:0.36875,stance loss: 0.31006 
Train step: 3630 acc:0.8874 total_loss: 0.51439  loss:0.4659,stance loss: 0.36522 
Train step: 3640 acc:0.88645 total_loss: 0.5138  loss:0.44726,stance loss: 0.33014 
Train step: 3650 acc:0.88298 total_loss: 0.52588  loss:0.74551,stance loss: 0.56258 
Train step: 3660 acc:0.88369 total_loss: 0.52147  loss:0.53677,stance loss: 0.37893 
Train step: 3670 acc:0.88199 total_loss: 0.52577  loss:0.73883,stance loss: 1.0926 
Train step: 3680 acc:0.88121 total_loss: 0.53351  loss:1.5267,stance loss: 2.0122 
Train step: 3690 acc:0.88501 total_loss: 0.52543  loss:0.80329,stance loss: 1.2358 
Train step: 3700 acc:0.88416 total_loss: 0.53179  loss:0.40501,stance loss: 0.35056 
Train step: 3710 acc:0.88308 total_loss: 0.53922  loss:0.78277,stance loss: 1.0575 
Train step: 3720 acc:0.88211 total_loss: 0.53562  loss:0.38717,stance loss: 0.29441 
Train step: 3730 acc:0.8832 total_loss: 0.53477  loss:0.2593,stance loss: 0.2049 
Train step: 3740 acc:0.88339 total_loss: 0.5337  loss:1.3456,stance loss: 1.6251 
Train step: 3750 acc:0.88408 total_loss: 0.52951  loss:0.24796,stance loss: 0.20169 
Train step: 3760 acc:0.88421 total_loss: 0.53046  loss:0.39807,stance loss: 0.30404 
Train step: 3770 acc:0.8853 total_loss: 0.52604  loss:0.28292,stance loss: 0.25446 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.6875 total_loss: 1.2825  loss:1.2825,stance loss: 1.5524 
Train step: 3790 acc:0.94886 total_loss: 0.40582  loss:0.2081,stance loss: 0.19297 
Train step: 3800 acc:0.91369 total_loss: 0.40217  loss:0.37985,stance loss: 0.28544 
Train step: 3810 acc:0.91935 total_loss: 0.39313  loss:0.41765,stance loss: 0.44786 
Train step: 3820 acc:0.91311 total_loss: 0.41171  loss:0.60978,stance loss: 1.0294 
Train step: 3830 acc:0.91176 total_loss: 0.42868  loss:0.21178,stance loss: 0.15784 
Train step: 3840 acc:0.91393 total_loss: 0.43343  loss:0.78967,stance loss: 1.1831 
Train step: 3850 acc:0.91901 total_loss: 0.42748  loss:0.28189,stance loss: 0.28363 
Train step: 3860 acc:0.9213 total_loss: 0.41553  loss:0.61721,stance loss: 1.0341 
Train step: 3870 acc:0.91964 total_loss: 0.41935  loss:0.3435,stance loss: 0.23601 
Train step: 3880 acc:0.91646 total_loss: 0.4229  loss:0.17579,stance loss: 1.824e-05 
Train step: 3890 acc:0.91385 total_loss: 0.43344  loss:0.37142,stance loss: 0.32829 
Train step: 3900 acc:0.91374 total_loss: 0.43823  loss:0.97356,stance loss: 0.94535 
Train step: 3910 acc:0.91221 total_loss: 0.44957  loss:0.20651,stance loss: 0.1163 
Train step: 3920 acc:0.9109 total_loss: 0.45266  loss:0.16547,stance loss: 0.06799 
Train step: 3930 acc:0.90811 total_loss: 0.45308  loss:0.46684,stance loss: 0.37904 
Train step: 3940 acc:0.90877 total_loss: 0.44376  loss:0.086792,stance loss: 0.017903 
Train step: 3950 acc:0.90936 total_loss: 0.44263  loss:0.11331,stance loss: 0.067263 
Train step: 3960 acc:0.90849 total_loss: 0.44026  loss:0.40909,stance loss: 0.31376 
Train step: 3970 acc:0.90936 total_loss: 0.44616  loss:1.2081,stance loss: 1.5244 
Train step: 3980 acc:0.91138 total_loss: 0.43727  loss:0.44699,stance loss: 0.35226 
Train step: 3990 acc:0.91291 total_loss: 0.43461  loss:0.27199,stance loss: 0.22937 
Train step: 4000 acc:0.91374 total_loss: 0.43572  loss:0.56782,stance loss: 0.469 
Train step: 4010 acc:0.91342 total_loss: 0.44028  loss:0.88388,stance loss: 1.298 
Train step: 4020 acc:0.9126 total_loss: 0.44351  loss:0.46405,stance loss: 0.31665 
Train step: 4030 acc:0.91235 total_loss: 0.44588  loss:0.23967,stance loss: 0.10341 
Train step: 4040 acc:0.91427 total_loss: 0.44312  loss:0.37738,stance loss: 0.28212 
Training finished.


Reload the best model with best f1 0.1592825419983265 from path test_outputs/bert-cross-topic/cc/2023-08-14 14-35-11/state_dict


              precision    recall  f1-score   support

           0   0.052786  0.692308  0.098093        26
           1   0.824859  0.719212  0.768421       203
           2   0.913043  0.125373  0.220472       335

    accuracy                       0.365248       564
   macro avg   0.596896  0.512298  0.362329       564
weighted avg   0.841646  0.365248  0.412053       564

Test Acc: 0.36524822695035464 F1_ma:0.1592825419983265
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.1592825419983265
acc: 0.36524822695035464, f1 :0.3623287122094106
classification report: 
              precision    recall  f1-score   support

         Con     0.0528    0.6923    0.0981        26
        None     0.8249    0.7192    0.7684       203
         Pro     0.9130    0.1254    0.2205       335

    accuracy                         0.3652       564
   macro avg     0.5969    0.5123    0.3623       564
weighted avg     0.8416    0.3652    0.4121       564

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 14-52-04', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 14-52-04
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5625 total_loss: 1.4852  loss:1.4852,stance loss: 0.96701 
Train step: 10 acc:0.53977 total_loss: 1.5628  loss:1.1605,stance loss: 0.62128 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 20 acc:0.53869 total_loss: 1.6106  loss:1.5566,stance loss: 1.1265 
Train step: 30 acc:0.53024 total_loss: 1.6291  loss:1.4373,stance loss: 1.0102 
Train step: 40 acc:0.53963 total_loss: 1.6198  loss:1.7643,stance loss: 1.1948 
Train step: 50 acc:0.52451 total_loss: 1.6282  loss:1.5039,stance loss: 1.1003 
Train step: 60 acc:0.53381 total_loss: 1.6165  loss:1.7547,stance loss: 1.1831 
Train step: 70 acc:0.54665 total_loss: 1.5955  loss:1.2344,stance loss: 0.85963 
Train step: 80 acc:0.55478 total_loss: 1.5878  loss:1.5698,stance loss: 1.188 
Train step: 90 acc:0.56181 total_loss: 1.5828  loss:1.4026,stance loss: 1.084 
Train step: 100 acc:0.56126 total_loss: 1.5859  loss:1.5033,stance loss: 1.0244 
Train step: 110 acc:0.56306 total_loss: 1.5894  loss:1.7234,stance loss: 1.2968 
Train step: 120 acc:0.55992 total_loss: 1.5837  loss:1.3556,stance loss: 1.0192 
Train step: 130 acc:0.55773 total_loss: 1.5823  loss:1.5989,stance loss: 1.2133 
Train step: 140 acc:0.56427 total_loss: 1.5707  loss:1.191,stance loss: 0.73446 
Train step: 150 acc:0.56457 total_loss: 1.5653  loss:1.9493,stance loss: 1.8867 
Train step: 160 acc:0.56328 total_loss: 1.5645  loss:1.6999,stance loss: 0.99235 
Train step: 170 acc:0.56031 total_loss: 1.5678  loss:1.6509,stance loss: 1.2152 
Train step: 180 acc:0.55974 total_loss: 1.5636  loss:1.4566,stance loss: 0.93635 
Train step: 190 acc:0.55955 total_loss: 1.559  loss:1.2722,stance loss: 0.76392 
Train step: 200 acc:0.56095 total_loss: 1.5559  loss:1.5987,stance loss: 1.1351 
Train step: 210 acc:0.55835 total_loss: 1.5543  loss:1.4232,stance loss: 1.0137 
Better F1! Saving model!
Saving model of best f1: 0.04444444444444444
              precision    recall  f1-score   support

           0   0.046512  1.000000  0.088889        26
           1   0.800000  0.019704  0.038462       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.053191       564
   macro avg   0.282171  0.339901  0.042450       564
weighted avg   0.290087  0.053191  0.017941       564

Test Acc: 0.05319148936170213 F1_ma:0.04444444444444444
Train step: 220 acc:0.55967 total_loss: 1.5508  loss:1.6305,stance loss: 1.1491 
Train step: 230 acc:0.56169 total_loss: 1.5454  loss:1.4378,stance loss: 1.0647 
Train step: 240 acc:0.55887 total_loss: 1.5468  loss:1.6812,stance loss: 1.1932 
Train step: 250 acc:0.55901 total_loss: 1.5454  loss:1.7123,stance loss: 1.6088 
Better F1! Saving model!
Saving model of best f1: 0.04526748971193415
              precision    recall  f1-score   support

           0   0.047826  0.846154  0.090535        26
           1   0.750000  0.384236  0.508143       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.177305       564
   macro avg   0.265942  0.410130  0.199559       564
weighted avg   0.272152  0.177305  0.187069       564

Test Acc: 0.1773049645390071 F1_ma:0.04526748971193415
Train step: 260 acc:0.55843 total_loss: 1.5431  loss:1.355,stance loss: 0.97503 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.5625 total_loss: 1.5282  loss:1.5282,stance loss: 1.0821 
Better F1! Saving model!
Saving model of best f1: 0.045454545454545456
              precision    recall  f1-score   support

           0   0.047710  0.961538  0.090909        26
           1   0.850000  0.167488  0.279835       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.104610       564
   macro avg   0.299237  0.376342  0.123581       564
weighted avg   0.308139  0.104610  0.104912       564

Test Acc: 0.10460992907801418 F1_ma:0.045454545454545456
Train step: 280 acc:0.55682 total_loss: 1.4766  loss:1.598,stance loss: 1.6169 
Better F1! Saving model!
Saving model of best f1: 0.0468384074941452
              precision    recall  f1-score   support

           0   0.049875  0.769231  0.093677        26
           1   0.748466  0.600985  0.666667       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.251773       564
   macro avg   0.266114  0.456739  0.253448       564
weighted avg   0.271694  0.251773  0.244271       564

Test Acc: 0.25177304964539005 F1_ma:0.0468384074941452
Train step: 290 acc:0.5744 total_loss: 1.4287  loss:1.3707,stance loss: 1.4256 
Train step: 300 acc:0.56048 total_loss: 1.4319  loss:1.5081,stance loss: 0.92164 
Train step: 310 acc:0.57317 total_loss: 1.441  loss:1.1617,stance loss: 0.86622 
Train step: 320 acc:0.58701 total_loss: 1.4207  loss:1.1162,stance loss: 0.71106 
Train step: 330 acc:0.58094 total_loss: 1.4392  loss:1.8208,stance loss: 1.4559 
Train step: 340 acc:0.57923 total_loss: 1.4411  loss:1.4904,stance loss: 1.1043 
Train step: 350 acc:0.58025 total_loss: 1.4334  loss:1.3047,stance loss: 0.97676 
Better F1! Saving model!
Saving model of best f1: 0.05194805194805194
              precision    recall  f1-score   support

           0   0.055710  0.769231  0.103896        26
           1   0.741463  0.748768  0.745098       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.304965       564
   macro avg   0.265725  0.506000  0.282998       564
weighted avg   0.269442  0.304965  0.272972       564

Test Acc: 0.3049645390070922 F1_ma:0.05194805194805194
Train step: 360 acc:0.58242 total_loss: 1.4408  loss:1.2773,stance loss: 0.89606 
Better F1! Saving model!
Saving model of best f1: 0.05235602094240837
              precision    recall  f1-score   support

           0   0.056180  0.769231  0.104712        26
           1   0.721154  0.738916  0.729927       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.301418       564
   macro avg   0.259111  0.502716  0.278213       564
weighted avg   0.262154  0.301418  0.267549       564

Test Acc: 0.30141843971631205 F1_ma:0.05235602094240837
Train step: 370 acc:0.58354 total_loss: 1.4356  loss:1.4636,stance loss: 1.1076 
Train step: 380 acc:0.5884 total_loss: 1.4388  loss:1.3598,stance loss: 1.0939 
Train step: 390 acc:0.58884 total_loss: 1.4355  loss:1.3934,stance loss: 1.1105 
Train step: 400 acc:0.58588 total_loss: 1.4306  loss:1.4842,stance loss: 1.1444 
Train step: 410 acc:0.58112 total_loss: 1.4339  loss:1.556,stance loss: 1.1963 
Train step: 420 acc:0.57947 total_loss: 1.4344  loss:1.1876,stance loss: 0.80122 
Train step: 430 acc:0.57803 total_loss: 1.4324  loss:1.4841,stance loss: 1.2127 
Train step: 440 acc:0.57968 total_loss: 1.4222  loss:1.1944,stance loss: 0.87699 
Train step: 450 acc:0.58356 total_loss: 1.4223  loss:1.3361,stance loss: 1.0339 
Train step: 460 acc:0.58442 total_loss: 1.4173  loss:1.1482,stance loss: 0.81728 
Better F1! Saving model!
Saving model of best f1: 0.05249343832020997
              precision    recall  f1-score   support

           0   0.056338  0.769231  0.104987        26
           1   0.732057  0.753695  0.742718       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.306738       564
   macro avg   0.262798  0.507642  0.282568       564
weighted avg   0.266086  0.306738  0.272166       564

Test Acc: 0.3067375886524823 F1_ma:0.05249343832020997
Train step: 470 acc:0.58582 total_loss: 1.415  loss:1.2757,stance loss: 1.2983 
Better F1! Saving model!
Saving model of best f1: 0.05463182897862233
              precision    recall  f1-score   support

           0   0.058228  0.884615  0.109264        26
           1   0.739645  0.615764  0.672043       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.262411       564
   macro avg   0.265958  0.500126  0.260436       564
weighted avg   0.268904  0.262411  0.246925       564

Test Acc: 0.2624113475177305 F1_ma:0.05463182897862233
Train step: 480 acc:0.59034 total_loss: 1.4105  loss:1.2491,stance loss: 0.96089 
Train step: 490 acc:0.59106 total_loss: 1.4068  loss:1.5655,stance loss: 0.99873 
Train step: 500 acc:0.5928 total_loss: 1.4034  loss:1.629,stance loss: 1.1044 
Better F1! Saving model!
Saving model of best f1: 0.058823529411764705
              precision    recall  f1-score   support

           0   0.063694  0.769231  0.117647        26
           1   0.704000  0.866995  0.777042       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.347518       564
   macro avg   0.255898  0.545409  0.298230       564
weighted avg   0.256326  0.347518  0.285103       564

Test Acc: 0.3475177304964539 F1_ma:0.058823529411764705
Train step: 510 acc:0.59336 total_loss: 1.4001  loss:1.1818,stance loss: 0.83092 
Train step: 520 acc:0.59562 total_loss: 1.395  loss:0.99815,stance loss: 0.76816 
Train step: 530 acc:0.59818 total_loss: 1.3928  loss:0.77526,stance loss: 0.27988 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.75 total_loss: 0.99753  loss:0.99753,stance loss: 0.71448 
Train step: 550 acc:0.67045 total_loss: 1.2607  loss:1.4416,stance loss: 1.0254 
Train step: 560 acc:0.64286 total_loss: 1.2387  loss:1.016,stance loss: 0.55234 
Train step: 570 acc:0.64718 total_loss: 1.2694  loss:1.2249,stance loss: 1.3783 
Train step: 580 acc:0.62652 total_loss: 1.2779  loss:1.0333,stance loss: 0.70469 
Train step: 590 acc:0.61152 total_loss: 1.2959  loss:1.226,stance loss: 0.90387 
Train step: 600 acc:0.61578 total_loss: 1.2937  loss:1.1809,stance loss: 0.86159 
Train step: 610 acc:0.62236 total_loss: 1.2933  loss:0.88155,stance loss: 0.42679 
Better F1! Saving model!
Saving model of best f1: 0.05899705014749262
              precision    recall  f1-score   support

           0   0.063898  0.769231  0.117994        26
           1   0.709163  0.876847  0.784141       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.351064       564
   macro avg   0.257687  0.548693  0.300712       564
weighted avg   0.258194  0.351064  0.287675       564

Test Acc: 0.35106382978723405 F1_ma:0.05899705014749262
Train step: 620 acc:0.62423 total_loss: 1.2985  loss:1.0634,stance loss: 0.75727 
Train step: 630 acc:0.62775 total_loss: 1.3117  loss:1.5077,stance loss: 1.0333 
Train step: 640 acc:0.63552 total_loss: 1.3023  loss:1.2472,stance loss: 1.3698 
Train step: 650 acc:0.63401 total_loss: 1.2999  loss:1.1058,stance loss: 0.78186 
Train step: 660 acc:0.64411 total_loss: 1.2853  loss:0.80733,stance loss: 0.42664 
Train step: 670 acc:0.64838 total_loss: 1.2782  loss:1.2741,stance loss: 0.9689 
Train step: 680 acc:0.64539 total_loss: 1.278  loss:1.2156,stance loss: 0.81269 
Train step: 690 acc:0.64694 total_loss: 1.2717  loss:0.96657,stance loss: 0.71125 
Train step: 700 acc:0.64752 total_loss: 1.2666  loss:1.2534,stance loss: 0.91645 
Train step: 710 acc:0.65095 total_loss: 1.2654  loss:0.91834,stance loss: 0.70878 
Train step: 720 acc:0.64883 total_loss: 1.2651  loss:1.2445,stance loss: 0.83976 
Train step: 730 acc:0.64791 total_loss: 1.2674  loss:1.3337,stance loss: 1.3873 
Better F1! Saving model!
Saving model of best f1: 0.06042296072507554
              precision    recall  f1-score   support

           0   0.065574  0.769231  0.120846        26
           1   0.687259  0.876847  0.770563       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.351064       564
   macro avg   0.250944  0.548693  0.297136       564
weighted avg   0.250387  0.351064  0.282919       564

Test Acc: 0.35106382978723405 F1_ma:0.06042296072507554
Train step: 740 acc:0.64832 total_loss: 1.2675  loss:1.1251,stance loss: 0.9024 
Train step: 750 acc:0.64929 total_loss: 1.2698  loss:1.381,stance loss: 1.049 
Train step: 760 acc:0.64989 total_loss: 1.2659  loss:1.3124,stance loss: 1.1187 
Train step: 770 acc:0.64827 total_loss: 1.2705  loss:1.4324,stance loss: 1.035 
Train step: 780 acc:0.64549 total_loss: 1.2782  loss:1.443,stance loss: 1.1133 
Train step: 790 acc:0.64492 total_loss: 1.279  loss:1.3037,stance loss: 1.0408 
Better F1! Saving model!
Saving model of best f1: 0.06081081081081081
              precision    recall  f1-score   support

           0   0.066667  0.692308  0.121622        26
           1   0.639456  0.926108  0.756539       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.365248       564
   macro avg   0.235374  0.539472  0.292720       564
weighted avg   0.233232  0.365248  0.277907       564

Test Acc: 0.36524822695035464 F1_ma:0.06081081081081081
Train step: 800 acc:0.64535 total_loss: 1.2763  loss:0.96014,stance loss: 0.67052 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.8125 total_loss: 0.90886  loss:0.90886,stance loss: 0.70673 
Train step: 820 acc:0.64205 total_loss: 1.2727  loss:0.8246,stance loss: 0.59859 
Train step: 830 acc:0.65774 total_loss: 1.2254  loss:1.2443,stance loss: 0.99082 
Train step: 840 acc:0.67137 total_loss: 1.204  loss:0.8909,stance loss: 0.6433 
Train step: 850 acc:0.67073 total_loss: 1.2213  loss:1.2721,stance loss: 0.8493 
Better F1! Saving model!
Saving model of best f1: 0.062111801242236024
              precision    recall  f1-score   support

           0   0.067568  0.769231  0.124224        26
           1   0.671642  0.886700  0.764331       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.354610       564
   macro avg   0.246403  0.551977  0.296185       564
weighted avg   0.244858  0.354610  0.280832       564

Test Acc: 0.3546099290780142 F1_ma:0.062111801242236024
Train step: 860 acc:0.67279 total_loss: 1.2211  loss:0.95517,stance loss: 0.71538 
Train step: 870 acc:0.66701 total_loss: 1.2142  loss:1.4392,stance loss: 1.0661 
Train step: 880 acc:0.66461 total_loss: 1.2199  loss:0.70447,stance loss: 0.38697 
Better F1! Saving model!
Saving model of best f1: 0.06229508196721312
              precision    recall  f1-score   support

           0   0.068100  0.730769  0.124590        26
           1   0.656140  0.921182  0.766393       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.365248       564
   macro avg   0.241414  0.550650  0.296995       564
weighted avg   0.239303  0.365248  0.281591       564

Test Acc: 0.36524822695035464 F1_ma:0.06229508196721312
Train step: 890 acc:0.66975 total_loss: 1.2021  loss:1.2812,stance loss: 0.87469 
Train step: 900 acc:0.66621 total_loss: 1.2011  loss:1.1329,stance loss: 0.88056 
Train step: 910 acc:0.66337 total_loss: 1.2115  loss:1.1509,stance loss: 1.0095 
Train step: 920 acc:0.6616 total_loss: 1.2135  loss:0.88813,stance loss: 0.66121 
Train step: 930 acc:0.66012 total_loss: 1.2073  loss:1.169,stance loss: 0.84493 
Train step: 940 acc:0.66555 total_loss: 1.1976  loss:1.0495,stance loss: 0.73195 
Train step: 950 acc:0.66888 total_loss: 1.198  loss:1.5749,stance loss: 1.7429 
Train step: 960 acc:0.67136 total_loss: 1.1984  loss:1.4796,stance loss: 1.1704 
Train step: 970 acc:0.67469 total_loss: 1.1959  loss:0.702,stance loss: 0.48985 
Train step: 980 acc:0.67654 total_loss: 1.1873  loss:1.2051,stance loss: 0.83 
Better F1! Saving model!
Saving model of best f1: 0.0703125
              precision    recall  f1-score   support

           0   0.078261  0.692308  0.140625        26
           1   0.582583  0.955665  0.723881       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.375887       564
   macro avg   0.220281  0.549324  0.288169       564
weighted avg   0.213296  0.375887  0.267028       564

Test Acc: 0.375886524822695 F1_ma:0.0703125
Train step: 990 acc:0.67265 total_loss: 1.1924  loss:1.0257,stance loss: 0.78785 
Train step: 1000 acc:0.67114 total_loss: 1.1997  loss:1.5503,stance loss: 1.2054 
Train step: 1010 acc:0.67102 total_loss: 1.197  loss:0.99415,stance loss: 0.7296 
Train step: 1020 acc:0.67002 total_loss: 1.1973  loss:1.0411,stance loss: 0.78261 
Train step: 1030 acc:0.66827 total_loss: 1.2017  loss:0.95912,stance loss: 0.73515 
Train step: 1040 acc:0.66613 total_loss: 1.2024  loss:1.2829,stance loss: 0.95253 
Train step: 1050 acc:0.66494 total_loss: 1.2012  loss:1.1435,stance loss: 0.75791 
Train step: 1060 acc:0.66509 total_loss: 1.2007  loss:1.3889,stance loss: 1.6481 
Train step: 1070 acc:0.66595 total_loss: 1.2046  loss:1.596,stance loss: 1.0613 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.75 total_loss: 1.2178  loss:1.2178,stance loss: 0.96867 
Better F1! Saving model!
Saving model of best f1: 0.07545403482493915
              precision    recall  f1-score   support

           0   0.059801  0.692308  0.110092        26
           1   0.701961  0.881773  0.781659       203
           2   0.875000  0.020896  0.040816       335

    accuracy                       0.361702       564
   macro avg   0.545587  0.531659  0.310856       564
weighted avg   0.775138  0.361702  0.310661       564

Test Acc: 0.3617021276595745 F1_ma:0.07545403482493915
Train step: 1090 acc:0.72727 total_loss: 1.2422  loss:1.178,stance loss: 0.95092 
Train step: 1100 acc:0.72024 total_loss: 1.1386  loss:1.3132,stance loss: 0.96255 
Train step: 1110 acc:0.71774 total_loss: 1.1272  loss:1.0992,stance loss: 0.96018 
Train step: 1120 acc:0.71189 total_loss: 1.1421  loss:1.3617,stance loss: 1.6109 
Better F1! Saving model!
Saving model of best f1: 0.09408544669204122
              precision    recall  f1-score   support

           0   0.064725  0.769231  0.119403        26
           1   0.721992  0.857143  0.783784       203
           2   0.857143  0.035821  0.068768       335

    accuracy                       0.365248       564
   macro avg   0.547953  0.554065  0.323985       564
weighted avg   0.771968  0.365248  0.328457       564

Test Acc: 0.36524822695035464 F1_ma:0.09408544669204122
Train step: 1130 acc:0.71324 total_loss: 1.1481  loss:1.5765,stance loss: 1.7352 
Train step: 1140 acc:0.70082 total_loss: 1.1559  loss:1.4321,stance loss: 1.0968 
Train step: 1150 acc:0.70599 total_loss: 1.1405  loss:1.1283,stance loss: 0.76819 
Train step: 1160 acc:0.69985 total_loss: 1.139  loss:1.0871,stance loss: 0.77377 
Better F1! Saving model!
Saving model of best f1: 0.1301147657802948
              precision    recall  f1-score   support

           0   0.067416  0.692308  0.122867        26
           1   0.679104  0.896552  0.772824       203
           2   0.862069  0.074627  0.137363       335

    accuracy                       0.398936       564
   macro avg   0.536196  0.554495  0.344351       564
weighted avg   0.759582  0.398936  0.365415       564

Test Acc: 0.39893617021276595 F1_ma:0.1301147657802948
Train step: 1170 acc:0.69368 total_loss: 1.1449  loss:1.3133,stance loss: 1.0748 
Train step: 1180 acc:0.69183 total_loss: 1.1464  loss:1.391,stance loss: 1.1157 
Train step: 1190 acc:0.692 total_loss: 1.1547  loss:1.0661,stance loss: 0.80397 
Train step: 1200 acc:0.69112 total_loss: 1.1531  loss:1.0234,stance loss: 0.69313 
Train step: 1210 acc:0.68989 total_loss: 1.1552  loss:0.90745,stance loss: 0.74207 
Train step: 1220 acc:0.6906 total_loss: 1.1549  loss:1.2962,stance loss: 0.92601 
Train step: 1230 acc:0.69081 total_loss: 1.1501  loss:1.0506,stance loss: 0.87434 
Train step: 1240 acc:0.68866 total_loss: 1.1515  loss:1.0736,stance loss: 0.88739 
Better F1! Saving model!
Saving model of best f1: 0.158307507431535
              precision    recall  f1-score   support

           0   0.060000  0.692308  0.110429        26
           1   0.744076  0.773399  0.758454       203
           2   0.754717  0.119403  0.206186       335

    accuracy                       0.381206       564
   macro avg   0.519598  0.528370  0.358356       564
weighted avg   0.718861  0.381206  0.400549       564

Test Acc: 0.38120567375886527 F1_ma:0.158307507431535
Train step: 1250 acc:0.6886 total_loss: 1.1557  loss:1.0191,stance loss: 0.78797 
Train step: 1260 acc:0.68819 total_loss: 1.1575  loss:1.4441,stance loss: 1.1303 
Train step: 1270 acc:0.68881 total_loss: 1.1552  loss:0.73416,stance loss: 0.48727 
Train step: 1280 acc:0.68812 total_loss: 1.1466  loss:1.0731,stance loss: 0.89251 
Train step: 1290 acc:0.68898 total_loss: 1.15  loss:1.6182,stance loss: 1.6939 
Train step: 1300 acc:0.69089 total_loss: 1.1485  loss:1.1855,stance loss: 0.94513 
Train step: 1310 acc:0.69183 total_loss: 1.1471  loss:1.6059,stance loss: 1.0247 
Train step: 1320 acc:0.69191 total_loss: 1.1462  loss:0.94748,stance loss: 0.59444 
Train step: 1330 acc:0.69273 total_loss: 1.1417  loss:1.0627,stance loss: 0.81359 
Train step: 1340 acc:0.69157 total_loss: 1.1407  loss:0.79201,stance loss: 0.61071 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.3125 total_loss: 1.5659  loss:1.5659,stance loss: 1.2643 
Train step: 1360 acc:0.70455 total_loss: 1.0567  loss:0.758,stance loss: 0.52798 
Train step: 1370 acc:0.69643 total_loss: 1.0459  loss:1.2086,stance loss: 0.83798 
Train step: 1380 acc:0.71774 total_loss: 1.0345  loss:1.3047,stance loss: 1.4508 
Train step: 1390 acc:0.71494 total_loss: 1.0663  loss:1.1581,stance loss: 1.016 
Train step: 1400 acc:0.72794 total_loss: 1.0329  loss:0.92056,stance loss: 0.6402 
Train step: 1410 acc:0.72643 total_loss: 1.0531  loss:1.135,stance loss: 0.67386 
Train step: 1420 acc:0.72535 total_loss: 1.0556  loss:1.329,stance loss: 0.73171 
Train step: 1430 acc:0.71914 total_loss: 1.0591  loss:1.1435,stance loss: 0.91759 
Better F1! Saving model!
Saving model of best f1: 0.36325738289205706
              precision    recall  f1-score   support

           0   0.098039  0.384615  0.156250        26
           1   0.598039  0.901478  0.719057       203
           2   0.897436  0.417910  0.570265       335

    accuracy                       0.590426       564
   macro avg   0.531171  0.568001  0.481857       564
weighted avg   0.752823  0.590426  0.604734       564

Test Acc: 0.5904255319148937 F1_ma:0.36325738289205706
Train step: 1440 acc:0.7081 total_loss: 1.0731  loss:1.0948,stance loss: 0.81 
Train step: 1450 acc:0.71101 total_loss: 1.0732  loss:0.83278,stance loss: 0.55571 
Train step: 1460 acc:0.71509 total_loss: 1.0647  loss:1.0361,stance loss: 0.98288 
Train step: 1470 acc:0.71229 total_loss: 1.0872  loss:1.6705,stance loss: 1.7406 
Train step: 1480 acc:0.71708 total_loss: 1.0849  loss:1.1139,stance loss: 0.87856 
Train step: 1490 acc:0.71631 total_loss: 1.0853  loss:0.88084,stance loss: 0.69785 
Train step: 1500 acc:0.71896 total_loss: 1.0777  loss:1.3318,stance loss: 1.5115 
Train step: 1510 acc:0.71933 total_loss: 1.0714  loss:0.95275,stance loss: 0.57226 
Train step: 1520 acc:0.72149 total_loss: 1.0645  loss:0.77383,stance loss: 0.61467 
Train step: 1530 acc:0.72479 total_loss: 1.058  loss:1.0004,stance loss: 1.0933 
Train step: 1540 acc:0.7248 total_loss: 1.0515  loss:0.9323,stance loss: 0.65316 
Train step: 1550 acc:0.72295 total_loss: 1.0521  loss:1.1973,stance loss: 0.98592 
Train step: 1560 acc:0.72156 total_loss: 1.0525  loss:1.1725,stance loss: 0.61681 
Train step: 1570 acc:0.71946 total_loss: 1.0554  loss:1.0581,stance loss: 1.2024 
Train step: 1580 acc:0.71645 total_loss: 1.0592  loss:1.1941,stance loss: 0.96107 
Train step: 1590 acc:0.71551 total_loss: 1.0599  loss:1.237,stance loss: 1.0218 
Train step: 1600 acc:0.71464 total_loss: 1.0614  loss:0.9847,stance loss: 1.1583 
Train step: 1610 acc:0.71671 total_loss: 1.0557  loss:0.58457,stance loss: 0.39811 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.5625 total_loss: 1.2587  loss:1.2587,stance loss: 0.92866 
Train step: 1630 acc:0.6875 total_loss: 0.99381  loss:0.87229,stance loss: 1.1975 
Train step: 1640 acc:0.69345 total_loss: 0.98705  loss:0.74547,stance loss: 0.49917 
Train step: 1650 acc:0.73387 total_loss: 0.92839  loss:0.55351,stance loss: 0.35807 
Train step: 1660 acc:0.73628 total_loss: 0.93919  loss:0.70277,stance loss: 0.53494 
Train step: 1670 acc:0.74265 total_loss: 0.96305  loss:0.64807,stance loss: 0.47521 
Train step: 1680 acc:0.75205 total_loss: 0.94457  loss:0.86058,stance loss: 0.699 
Train step: 1690 acc:0.74648 total_loss: 0.9515  loss:1.1274,stance loss: 0.88613 
Train step: 1700 acc:0.74151 total_loss: 0.96437  loss:1.1458,stance loss: 0.83875 
Train step: 1710 acc:0.73764 total_loss: 0.96269  loss:0.54131,stance loss: 0.22322 
Train step: 1720 acc:0.74196 total_loss: 0.95856  loss:1.2219,stance loss: 1.4678 
Train step: 1730 acc:0.7455 total_loss: 0.95022  loss:0.80968,stance loss: 0.45591 
Train step: 1740 acc:0.74742 total_loss: 0.94174  loss:0.86522,stance loss: 0.63655 
Train step: 1750 acc:0.75 total_loss: 0.93559  loss:1.0881,stance loss: 0.48102 
Train step: 1760 acc:0.7531 total_loss: 0.92244  loss:0.8368,stance loss: 0.66777 
Train step: 1770 acc:0.75207 total_loss: 0.92782  loss:0.32641,stance loss: 0.11041 
Train step: 1780 acc:0.75349 total_loss: 0.92823  loss:1.0345,stance loss: 0.864 
Train step: 1790 acc:0.75621 total_loss: 0.92993  loss:0.62668,stance loss: 0.43793 
Train step: 1800 acc:0.75449 total_loss: 0.93878  loss:0.8719,stance loss: 1.1311 
Train step: 1810 acc:0.75556 total_loss: 0.92984  loss:0.66272,stance loss: 0.52085 
Train step: 1820 acc:0.75529 total_loss: 0.93283  loss:1.3402,stance loss: 1.5677 
Train step: 1830 acc:0.75504 total_loss: 0.93866  loss:1.2233,stance loss: 1.5608 
Train step: 1840 acc:0.75537 total_loss: 0.93547  loss:0.63382,stance loss: 0.39116 
Train step: 1850 acc:0.75487 total_loss: 0.93485  loss:0.80308,stance loss: 0.58571 
Train step: 1860 acc:0.75519 total_loss: 0.93026  loss:0.86343,stance loss: 0.71614 
Train step: 1870 acc:0.75672 total_loss: 0.92912  loss:0.95711,stance loss: 0.79298 
Train step: 1880 acc:0.75623 total_loss: 0.93523  loss:0.70136,stance loss: 0.51677 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.8125 total_loss: 0.84522  loss:0.84522,stance loss: 0.5739 
Train step: 1900 acc:0.81818 total_loss: 0.8848  loss:1.1425,stance loss: 1.5012 
Train step: 1910 acc:0.79762 total_loss: 0.92552  loss:0.76373,stance loss: 0.52482 
Train step: 1920 acc:0.79032 total_loss: 0.91033  loss:0.88798,stance loss: 0.71537 
Train step: 1930 acc:0.78963 total_loss: 0.885  loss:0.58918,stance loss: 0.46192 
Train step: 1940 acc:0.78554 total_loss: 0.86695  loss:0.98258,stance loss: 0.74597 
Train step: 1950 acc:0.78176 total_loss: 0.87961  loss:0.73198,stance loss: 0.5313 
Train step: 1960 acc:0.78697 total_loss: 0.87739  loss:1.1695,stance loss: 0.88251 
Train step: 1970 acc:0.78858 total_loss: 0.8895  loss:1.3513,stance loss: 1.6745 
Train step: 1980 acc:0.78915 total_loss: 0.88064  loss:1.1591,stance loss: 0.72935 
Train step: 1990 acc:0.79022 total_loss: 0.87218  loss:0.91308,stance loss: 0.8833 
Train step: 2000 acc:0.7911 total_loss: 0.87053  loss:1.328,stance loss: 1.5932 
Train step: 2010 acc:0.79081 total_loss: 0.87008  loss:0.18327,stance loss: 0.0032259 
Train step: 2020 acc:0.78865 total_loss: 0.86923  loss:0.8595,stance loss: 0.54403 
Train step: 2030 acc:0.79078 total_loss: 0.86742  loss:0.64454,stance loss: 0.36145 
Train step: 2040 acc:0.79636 total_loss: 0.86327  loss:0.88261,stance loss: 0.73728 
Train step: 2050 acc:0.79658 total_loss: 0.86536  loss:0.82196,stance loss: 0.9475 
Train step: 2060 acc:0.79715 total_loss: 0.86079  loss:1.001,stance loss: 0.84737 
Train step: 2070 acc:0.79765 total_loss: 0.85876  loss:0.86501,stance loss: 0.7325 
Train step: 2080 acc:0.7981 total_loss: 0.85863  loss:0.80764,stance loss: 1.1033 
Train step: 2090 acc:0.79726 total_loss: 0.86318  loss:0.80082,stance loss: 1.0974 
Train step: 2100 acc:0.79739 total_loss: 0.86388  loss:0.92075,stance loss: 0.58441 
Train step: 2110 acc:0.79779 total_loss: 0.86318  loss:0.82675,stance loss: 0.70674 
Train step: 2120 acc:0.79708 total_loss: 0.86382  loss:0.8082,stance loss: 0.67528 
Train step: 2130 acc:0.79772 total_loss: 0.85824  loss:0.50395,stance loss: 0.38203 
Train step: 2140 acc:0.79781 total_loss: 0.86293  loss:0.95421,stance loss: 1.3011 
Train step: 2150 acc:0.79765 total_loss: 0.85889  loss:0.41629,stance loss: 0.21319 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.9375 total_loss: 0.94019  loss:0.94019,stance loss: 1.2594 
Train step: 2170 acc:0.86364 total_loss: 0.6479  loss:0.87192,stance loss: 0.94451 
Train step: 2180 acc:0.85119 total_loss: 0.6948  loss:1.0248,stance loss: 1.4286 
Train step: 2190 acc:0.85685 total_loss: 0.68515  loss:0.61205,stance loss: 0.5332 
Train step: 2200 acc:0.83994 total_loss: 0.70917  loss:0.65953,stance loss: 0.49892 
Train step: 2210 acc:0.84314 total_loss: 0.70852  loss:0.69804,stance loss: 0.46915 
Train step: 2220 acc:0.83607 total_loss: 0.73222  loss:0.69007,stance loss: 0.42606 
Train step: 2230 acc:0.83979 total_loss: 0.74884  loss:0.77631,stance loss: 1.0703 
Train step: 2240 acc:0.84259 total_loss: 0.7465  loss:0.7616,stance loss: 0.71111 
Train step: 2250 acc:0.84272 total_loss: 0.74001  loss:0.70244,stance loss: 0.5762 
Train step: 2260 acc:0.84344 total_loss: 0.73975  loss:0.44562,stance loss: 0.31089 
Train step: 2270 acc:0.84403 total_loss: 0.73276  loss:0.25291,stance loss: 0.14057 
Train step: 2280 acc:0.84246 total_loss: 0.73789  loss:0.50705,stance loss: 0.40799 
Train step: 2290 acc:0.84303 total_loss: 0.73317  loss:0.65504,stance loss: 0.57348 
Train step: 2300 acc:0.84397 total_loss: 0.73316  loss:0.86996,stance loss: 1.0691 
Train step: 2310 acc:0.84313 total_loss: 0.73408  loss:0.66309,stance loss: 0.52518 
Train step: 2320 acc:0.84045 total_loss: 0.74067  loss:0.74633,stance loss: 0.5475 
Train step: 2330 acc:0.84101 total_loss: 0.74223  loss:0.96411,stance loss: 1.2904 
Train step: 2340 acc:0.84358 total_loss: 0.73143  loss:0.51238,stance loss: 0.38107 
Train step: 2350 acc:0.8449 total_loss: 0.73065  loss:0.82987,stance loss: 1.1399 
Train step: 2360 acc:0.84546 total_loss: 0.73088  loss:0.38006,stance loss: 0.27848 
Train step: 2370 acc:0.84301 total_loss: 0.72939  loss:0.83474,stance loss: 1.1321 
Train step: 2380 acc:0.84304 total_loss: 0.72883  loss:0.79082,stance loss: 0.59275 
Train step: 2390 acc:0.84361 total_loss: 0.72455  loss:0.68438,stance loss: 0.45831 
Train step: 2400 acc:0.84362 total_loss: 0.72143  loss:1.0014,stance loss: 0.90719 
Train step: 2410 acc:0.84288 total_loss: 0.72042  loss:0.99534,stance loss: 0.9021 
Train step: 2420 acc:0.84243 total_loss: 0.72213  loss:0.66284,stance loss: 0.48414 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.875 total_loss: 0.51372  loss:0.51372,stance loss: 0.2731 
Train step: 2440 acc:0.875 total_loss: 0.53831  loss:0.62076,stance loss: 0.48 
Train step: 2450 acc:0.87202 total_loss: 0.57011  loss:0.31467,stance loss: 0.1184 
Train step: 2460 acc:0.86694 total_loss: 0.60661  loss:1.576,stance loss: 1.9487 
Train step: 2470 acc:0.87957 total_loss: 0.59221  loss:1.091,stance loss: 1.0196 
Train step: 2480 acc:0.87868 total_loss: 0.59005  loss:0.31542,stance loss: 0.25282 
Train step: 2490 acc:0.8791 total_loss: 0.59357  loss:0.41089,stance loss: 0.31481 
Train step: 2500 acc:0.87588 total_loss: 0.60704  loss:0.78557,stance loss: 1.0808 
Train step: 2510 acc:0.87654 total_loss: 0.60755  loss:0.26469,stance loss: 0.1419 
Train step: 2520 acc:0.87843 total_loss: 0.60677  loss:0.53776,stance loss: 0.29121 
Train step: 2530 acc:0.87686 total_loss: 0.61351  loss:1.0615,stance loss: 0.81652 
Train step: 2540 acc:0.87894 total_loss: 0.60386  loss:0.46279,stance loss: 0.46036 
Train step: 2550 acc:0.87552 total_loss: 0.60219  loss:0.95277,stance loss: 1.3692 
Train step: 2560 acc:0.87452 total_loss: 0.60932  loss:0.95777,stance loss: 0.93647 
Train step: 2570 acc:0.87677 total_loss: 0.60708  loss:0.9359,stance loss: 1.2988 
Train step: 2580 acc:0.87417 total_loss: 0.61627  loss:0.51118,stance loss: 0.35986 
Train step: 2590 acc:0.87461 total_loss: 0.61528  loss:0.6274,stance loss: 1.0214 
Train step: 2600 acc:0.87354 total_loss: 0.6162  loss:0.28498,stance loss: 0.10873 
Train step: 2610 acc:0.87189 total_loss: 0.62354  loss:0.742,stance loss: 0.65304 
Train step: 2620 acc:0.87304 total_loss: 0.61962  loss:0.4268,stance loss: 0.30974 
Train step: 2630 acc:0.87251 total_loss: 0.62176  loss:0.47924,stance loss: 0.42112 
Train step: 2640 acc:0.87204 total_loss: 0.62364  loss:0.78797,stance loss: 0.50141 
Train step: 2650 acc:0.87189 total_loss: 0.62007  loss:0.93444,stance loss: 0.53243 
Train step: 2660 acc:0.87094 total_loss: 0.62452  loss:0.56194,stance loss: 0.46161 
Train step: 2670 acc:0.87137 total_loss: 0.62409  loss:0.15874,stance loss: 0.065901 
Train step: 2680 acc:0.87102 total_loss: 0.62064  loss:0.47723,stance loss: 0.39443 
Train step: 2690 acc:0.87117 total_loss: 0.62252  loss:0.33804,stance loss: 0.24468 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:1.0 total_loss: 0.69911  loss:0.69911,stance loss: 1.0875 
Train step: 2710 acc:0.89773 total_loss: 0.57203  loss:0.48036,stance loss: 0.41791 
Train step: 2720 acc:0.90774 total_loss: 0.53781  loss:0.83877,stance loss: 0.49669 
Train step: 2730 acc:0.90524 total_loss: 0.56053  loss:1.7734,stance loss: 2.3417 
Better F1! Saving model!
Saving model of best f1: 0.3654490106544901
              precision    recall  f1-score   support

           0   0.090909  0.538462  0.155556        26
           1   0.700855  0.807882  0.750572       203
           2   0.835227  0.438806  0.575342       335

    accuracy                       0.576241       564
   macro avg   0.542330  0.595050  0.493823       564
weighted avg   0.752550  0.576241  0.619061       564

Test Acc: 0.5762411347517731 F1_ma:0.3654490106544901
Train step: 2740 acc:0.90091 total_loss: 0.57447  loss:1.0476,stance loss: 1.3896 
Train step: 2750 acc:0.89338 total_loss: 0.56063  loss:1.13,stance loss: 0.82757 
Train step: 2760 acc:0.89652 total_loss: 0.54165  loss:0.29699,stance loss: 0.10419 
Train step: 2770 acc:0.89613 total_loss: 0.54782  loss:0.68617,stance loss: 0.45551 
Train step: 2780 acc:0.8912 total_loss: 0.56056  loss:0.8512,stance loss: 0.72136 
Train step: 2790 acc:0.8908 total_loss: 0.5565  loss:0.34505,stance loss: 0.2659 
Train step: 2800 acc:0.89109 total_loss: 0.55728  loss:0.63216,stance loss: 1.0535 
Train step: 2810 acc:0.89245 total_loss: 0.55199  loss:0.42959,stance loss: 0.32869 
Train step: 2820 acc:0.89205 total_loss: 0.55699  loss:0.35,stance loss: 0.30147 
Train step: 2830 acc:0.89456 total_loss: 0.54693  loss:0.28071,stance loss: 0.24264 
Train step: 2840 acc:0.89583 total_loss: 0.54502  loss:0.36029,stance loss: 0.27994 
Train step: 2850 acc:0.8957 total_loss: 0.54039  loss:0.5286,stance loss: 0.55699 
Train step: 2860 acc:0.89325 total_loss: 0.55152  loss:1.2253,stance loss: 1.1174 
Train step: 2870 acc:0.89437 total_loss: 0.54652  loss:0.4116,stance loss: 0.29949 
Train step: 2880 acc:0.89572 total_loss: 0.55225  loss:0.23445,stance loss: 0.18808 
Train step: 2890 acc:0.89725 total_loss: 0.54214  loss:0.13831,stance loss: 0.065389 
Train step: 2900 acc:0.89552 total_loss: 0.54556  loss:0.97353,stance loss: 0.81927 
Train step: 2910 acc:0.89751 total_loss: 0.54016  loss:0.32262,stance loss: 0.29376 
Train step: 2920 acc:0.89791 total_loss: 0.53395  loss:0.27118,stance loss: 0.23836 
Train step: 2930 acc:0.89881 total_loss: 0.52899  loss:0.41998,stance loss: 0.2763 
Train step: 2940 acc:0.89886 total_loss: 0.52908  loss:0.57559,stance loss: 1.0124 
Train step: 2950 acc:0.89766 total_loss: 0.52868  loss:0.16355,stance loss: 0.0089366 
Train step: 2960 acc:0.90038 total_loss: 0.52037  loss:0.23757,stance loss: 0.19251 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.8125 total_loss: 0.82906  loss:0.82906,stance loss: 0.56145 
Train step: 2980 acc:0.93182 total_loss: 0.41938  loss:0.29618,stance loss: 0.21151 
Train step: 2990 acc:0.93155 total_loss: 0.46253  loss:0.38499,stance loss: 0.24217 
Train step: 3000 acc:0.93347 total_loss: 0.46909  loss:1.1606,stance loss: 2.0323 
Train step: 3010 acc:0.92988 total_loss: 0.48925  loss:0.83719,stance loss: 0.65313 
Train step: 3020 acc:0.92647 total_loss: 0.49587  loss:0.065432,stance loss: 0.016857 
Train step: 3030 acc:0.92725 total_loss: 0.48429  loss:0.56495,stance loss: 1.0077 
Train step: 3040 acc:0.92606 total_loss: 0.48086  loss:0.50841,stance loss: 0.48567 
Better F1! Saving model!
Saving model of best f1: 0.4160307991120977
              precision    recall  f1-score   support

           0   0.112782  0.576923  0.188679        26
           1   0.711712  0.778325  0.743529       203
           2   0.837321  0.522388  0.643382       335

    accuracy                       0.617021       564
   macro avg   0.553938  0.625879  0.525197       564
weighted avg   0.758710  0.617021  0.658467       564

Test Acc: 0.6170212765957447 F1_ma:0.4160307991120977
Train step: 3050 acc:0.92593 total_loss: 0.47403  loss:0.28621,stance loss: 0.23473 
Train step: 3060 acc:0.92582 total_loss: 0.46766  loss:0.2342,stance loss: 0.17932 
Train step: 3070 acc:0.9276 total_loss: 0.45463  loss:0.21591,stance loss: 0.16917 
Train step: 3080 acc:0.92849 total_loss: 0.4446  loss:0.33686,stance loss: 0.28124 
Train step: 3090 acc:0.92924 total_loss: 0.43937  loss:0.12532,stance loss: 0.067497 
Train step: 3100 acc:0.92748 total_loss: 0.4488  loss:0.37311,stance loss: 0.29452 
Train step: 3110 acc:0.92642 total_loss: 0.45426  loss:0.64759,stance loss: 0.53644 
Train step: 3120 acc:0.92467 total_loss: 0.46074  loss:0.82933,stance loss: 0.76636 
Train step: 3130 acc:0.92391 total_loss: 0.46219  loss:0.39372,stance loss: 0.34999 
Train step: 3140 acc:0.92178 total_loss: 0.46127  loss:0.80879,stance loss: 1.0629 
Train step: 3150 acc:0.92231 total_loss: 0.45068  loss:0.055221,stance loss: 0.0093365 
Train step: 3160 acc:0.92212 total_loss: 0.45197  loss:0.23756,stance loss: 0.20623 
Train step: 3170 acc:0.9232 total_loss: 0.44728  loss:0.60175,stance loss: 0.45856 
Train step: 3180 acc:0.9221 total_loss: 0.44681  loss:0.56605,stance loss: 1.0174 
Train step: 3190 acc:0.92364 total_loss: 0.44371  loss:0.6051,stance loss: 0.56671 
Train step: 3200 acc:0.92451 total_loss: 0.44133  loss:0.43077,stance loss: 0.49492 
Train step: 3210 acc:0.92453 total_loss: 0.43594  loss:0.22051,stance loss: 0.18967 
Train step: 3220 acc:0.9248 total_loss: 0.43171  loss:0.14297,stance loss: 0.12483 
Train step: 3230 acc:0.92553 total_loss: 0.42426  loss:0.21298,stance loss: 0.11899 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.875 total_loss: 0.46654  loss:0.46654,stance loss: 0.3589 
Train step: 3250 acc:0.90341 total_loss: 0.40719  loss:0.1957,stance loss: 0.12855 
Train step: 3260 acc:0.92857 total_loss: 0.37245  loss:0.12773,stance loss: 0.039807 
Train step: 3270 acc:0.93952 total_loss: 0.37479  loss:0.55664,stance loss: 1.0096 
Train step: 3280 acc:0.94207 total_loss: 0.36602  loss:0.31616,stance loss: 0.29516 
Train step: 3290 acc:0.9375 total_loss: 0.37048  loss:0.84582,stance loss: 0.49938 
Train step: 3300 acc:0.93443 total_loss: 0.37449  loss:0.28112,stance loss: 0.27475 
Train step: 3310 acc:0.93926 total_loss: 0.35973  loss:0.33041,stance loss: 0.24926 
Train step: 3320 acc:0.9429 total_loss: 0.34481  loss:0.17281,stance loss: 0.22888 
Train step: 3330 acc:0.94368 total_loss: 0.33599  loss:0.25098,stance loss: 0.15886 
Train step: 3340 acc:0.94554 total_loss: 0.33021  loss:0.2908,stance loss: 0.1982 
Train step: 3350 acc:0.94426 total_loss: 0.33141  loss:0.02061,stance loss: 0.00021495 
Train step: 3360 acc:0.94318 total_loss: 0.33374  loss:0.42201,stance loss: 0.27796 
Train step: 3370 acc:0.94513 total_loss: 0.333  loss:0.080379,stance loss: 0.0492 
Train step: 3380 acc:0.94238 total_loss: 0.33359  loss:0.5721,stance loss: 0.53797 
Better F1! Saving model!
Saving model of best f1: 0.4181315446402288
              precision    recall  f1-score   support

           0   0.102740  0.576923  0.174419        26
           1   0.755000  0.743842  0.749380       203
           2   0.839450  0.546269  0.661844       335

    accuracy                       0.618794       564
   macro avg   0.565730  0.622345  0.528548       564
weighted avg   0.775092  0.618794  0.670881       564

Test Acc: 0.6187943262411347 F1_ma:0.4181315446402288
Train step: 3390 acc:0.94247 total_loss: 0.33405  loss:0.18568,stance loss: 0.13962 
Train step: 3400 acc:0.94061 total_loss: 0.34229  loss:0.59646,stance loss: 0.45348 
Train step: 3410 acc:0.94189 total_loss: 0.33961  loss:0.12719,stance loss: 0.071834 
Train step: 3420 acc:0.9413 total_loss: 0.34425  loss:0.9028,stance loss: 1.2829 
Train step: 3430 acc:0.94306 total_loss: 0.34434  loss:0.082831,stance loss: 0.04852 
Train step: 3440 acc:0.94248 total_loss: 0.34207  loss:0.10975,stance loss: 0.03736 
Train step: 3450 acc:0.94283 total_loss: 0.34133  loss:0.42935,stance loss: 0.34604 
Train step: 3460 acc:0.94231 total_loss: 0.34148  loss:0.44147,stance loss: 0.36628 
Train step: 3470 acc:0.9421 total_loss: 0.34378  loss:0.92138,stance loss: 1.2251 
Train step: 3480 acc:0.94243 total_loss: 0.34175  loss:0.37891,stance loss: 0.24528 
Train step: 3490 acc:0.94298 total_loss: 0.33632  loss:0.04164,stance loss: 0.020703 
Train step: 3500 acc:0.94253 total_loss: 0.33523  loss:0.17695,stance loss: 0.13724 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:1.0 total_loss: 0.083312  loss:0.083312,stance loss: 0.064233 
Train step: 3520 acc:0.95455 total_loss: 0.32811  loss:0.050999,stance loss: 0.0067632 
Train step: 3530 acc:0.97024 total_loss: 0.26929  loss:0.042048,stance loss: 0.0073652 
Train step: 3540 acc:0.97379 total_loss: 0.25436  loss:0.1862,stance loss: 0.14849 
Train step: 3550 acc:0.97104 total_loss: 0.23691  loss:0.089172,stance loss: 0.018972 
Train step: 3560 acc:0.97059 total_loss: 0.24921  loss:0.65198,stance loss: 1.0646 
Train step: 3570 acc:0.96619 total_loss: 0.2539  loss:0.08749,stance loss: 0.076072 
Train step: 3580 acc:0.96919 total_loss: 0.24934  loss:0.52217,stance loss: 1.0079 
Train step: 3590 acc:0.96759 total_loss: 0.26133  loss:0.59027,stance loss: 1.0304 
Train step: 3600 acc:0.96635 total_loss: 0.2642  loss:0.2574,stance loss: 0.19269 
Train step: 3610 acc:0.96535 total_loss: 0.26445  loss:0.24417,stance loss: 0.15022 
Train step: 3620 acc:0.96734 total_loss: 0.25272  loss:0.48785,stance loss: 0.51649 
Train step: 3630 acc:0.96694 total_loss: 0.24939  loss:0.55266,stance loss: 0.32965 
Train step: 3640 acc:0.96708 total_loss: 0.25468  loss:0.84881,stance loss: 1.2489 
Train step: 3650 acc:0.96543 total_loss: 0.25964  loss:0.026518,stance loss: 0.0053122 
Train step: 3660 acc:0.96316 total_loss: 0.26514  loss:0.20938,stance loss: 0.18764 
Better F1! Saving model!
Saving model of best f1: 0.42751045522280445
              precision    recall  f1-score   support

           0   0.103448  0.461538  0.169014        26
           1   0.741117  0.719212  0.730000       203
           2   0.800797  0.600000  0.686007       335

    accuracy                       0.636525       564
   macro avg   0.548454  0.593583  0.528340       564
weighted avg   0.747169  0.636525  0.678008       564

Test Acc: 0.6365248226950354 F1_ma:0.42751045522280445
Train step: 3670 acc:0.96273 total_loss: 0.26842  loss:0.55011,stance loss: 1.0114 
Train step: 3680 acc:0.9598 total_loss: 0.27642  loss:0.30234,stance loss: 0.26918 
Train step: 3690 acc:0.96098 total_loss: 0.27359  loss:0.042596,stance loss: 0.011857 
Train step: 3700 acc:0.96073 total_loss: 0.27022  loss:0.22558,stance loss: 0.16929 
Train step: 3710 acc:0.96082 total_loss: 0.26967  loss:0.04592,stance loss: 0.011241 
Train step: 3720 acc:0.96031 total_loss: 0.2694  loss:0.56459,stance loss: 0.53865 
Train step: 3730 acc:0.95984 total_loss: 0.27492  loss:0.80835,stance loss: 1.2629 
Train step: 3740 acc:0.96023 total_loss: 0.27274  loss:0.21256,stance loss: 0.13189 
Train step: 3750 acc:0.95954 total_loss: 0.28183  loss:0.82793,stance loss: 0.70021 
Train step: 3760 acc:0.95916 total_loss: 0.2848  loss:0.17188,stance loss: 0.10628 
Train step: 3770 acc:0.95881 total_loss: 0.28607  loss:0.042261,stance loss: 0.017667 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:1.0 total_loss: 0.045029  loss:0.045029,stance loss: 0.0063842 
Train step: 3790 acc:0.98295 total_loss: 0.15641  loss:0.15665,stance loss: 0.1271 
Train step: 3800 acc:0.97321 total_loss: 0.19752  loss:0.030741,stance loss: 0.009114 
Train step: 3810 acc:0.97581 total_loss: 0.24663  loss:0.5235,stance loss: 1.0082 
Train step: 3820 acc:0.96646 total_loss: 0.25716  loss:0.2704,stance loss: 0.18646 
Train step: 3830 acc:0.96569 total_loss: 0.26349  loss:0.29259,stance loss: 0.22081 
Train step: 3840 acc:0.96311 total_loss: 0.27667  loss:0.069961,stance loss: 0.050225 
Train step: 3850 acc:0.96479 total_loss: 0.25674  loss:0.045784,stance loss: 0.001069 
Train step: 3860 acc:0.96142 total_loss: 0.26842  loss:0.20577,stance loss: 0.17353 
Train step: 3870 acc:0.96016 total_loss: 0.27365  loss:0.50204,stance loss: 0.64641 
Train step: 3880 acc:0.96101 total_loss: 0.27665  loss:0.65665,stance loss: 1.1056 
Train step: 3890 acc:0.96227 total_loss: 0.27737  loss:0.9337,stance loss: 1.2447 
Train step: 3900 acc:0.96436 total_loss: 0.27786  loss:0.51568,stance loss: 1.0076 
Train step: 3910 acc:0.96517 total_loss: 0.27001  loss:0.072971,stance loss: 0.027338 
Train step: 3920 acc:0.96587 total_loss: 0.26572  loss:0.58154,stance loss: 1.0239 
Train step: 3930 acc:0.9673 total_loss: 0.26068  loss:0.14892,stance loss: 0.061243 
Train step: 3940 acc:0.96584 total_loss: 0.26467  loss:0.3333,stance loss: 0.2317 
Train step: 3950 acc:0.96491 total_loss: 0.26693  loss:0.032706,stance loss: 0.012011 
Train step: 3960 acc:0.96581 total_loss: 0.27144  loss:0.10607,stance loss: 0.075887 
Train step: 3970 acc:0.96564 total_loss: 0.26925  loss:0.041846,stance loss: 0.012773 
Train step: 3980 acc:0.96549 total_loss: 0.27157  loss:0.040832,stance loss: 0.0071252 
Train step: 3990 acc:0.96594 total_loss: 0.27196  loss:0.12191,stance loss: 0.10522 
Train step: 4000 acc:0.96578 total_loss: 0.26633  loss:0.014454,stance loss: 0.0010783 
Train step: 4010 acc:0.96429 total_loss: 0.26598  loss:0.2455,stance loss: 0.15516 
Train step: 4020 acc:0.96473 total_loss: 0.26718  loss:0.14845,stance loss: 0.088813 
Train step: 4030 acc:0.96414 total_loss: 0.26741  loss:0.11137,stance loss: 0.011886 
Train step: 4040 acc:0.96384 total_loss: 0.26675  loss:0.25902,stance loss: 0.20196 
Training finished.


Reload the best model with best f1 0.42751045522280445 from path test_outputs/bert-cross-topic/cc/2023-08-14 14-52-04/state_dict


              precision    recall  f1-score   support

           0   0.103448  0.461538  0.169014        26
           1   0.741117  0.719212  0.730000       203
           2   0.800797  0.600000  0.686007       335

    accuracy                       0.636525       564
   macro avg   0.548454  0.593583  0.528340       564
weighted avg   0.747169  0.636525  0.678008       564

Test Acc: 0.6365248226950354 F1_ma:0.42751045522280445
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.42751045522280445
acc: 0.6365248226950354, f1 :0.5283403034818696
classification report: 
              precision    recall  f1-score   support

         Con     0.1034    0.4615    0.1690        26
        None     0.7411    0.7192    0.7300       203
         Pro     0.8008    0.6000    0.6860       335

    accuracy                         0.6365       564
   macro avg     0.5485    0.5936    0.5283       564
weighted avg     0.7472    0.6365    0.6780       564

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 15-09-50', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 15-09-50
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.8125 total_loss: 1.203  loss:1.203,stance loss: 0.66022 
Train step: 10 acc:0.57955 total_loss: 1.6435  loss:1.7998,stance loss: 1.7671 
Better F1! Saving model!
Saving model of best f1: 0.04421768707482993
              precision    recall  f1-score   support

           0   0.046263  1.000000  0.088435        26
           1   1.000000  0.004926  0.009804       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.047872       564
   macro avg   0.348754  0.334975  0.032746       564
weighted avg   0.362062  0.047872  0.007606       564

Test Acc: 0.047872340425531915 F1_ma:0.04421768707482993
Train step: 20 acc:0.59226 total_loss: 1.6086  loss:1.5757,stance loss: 1.6306 
Train step: 30 acc:0.57863 total_loss: 1.6276  loss:1.3941,stance loss: 1.0237 
Train step: 40 acc:0.58841 total_loss: 1.596  loss:1.6674,stance loss: 1.1686 
Train step: 50 acc:0.58333 total_loss: 1.5992  loss:1.3569,stance loss: 0.92031 
Train step: 60 acc:0.58094 total_loss: 1.5945  loss:1.2761,stance loss: 0.92126 
Train step: 70 acc:0.57923 total_loss: 1.5854  loss:1.6336,stance loss: 1.2454 
Better F1! Saving model!
Saving model of best f1: 0.04571428571428571
              precision    recall  f1-score   support

           0   0.048096  0.923077  0.091429        26
           1   0.923077  0.295567  0.447761       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.148936       564
   macro avg   0.323724  0.406214  0.179730       564
weighted avg   0.334459  0.148936  0.165377       564

Test Acc: 0.14893617021276595 F1_ma:0.04571428571428571
Train step: 80 acc:0.5787 total_loss: 1.58  loss:1.663,stance loss: 1.2257 
Train step: 90 acc:0.58242 total_loss: 1.551  loss:1.6293,stance loss: 1.2155 
Train step: 100 acc:0.58045 total_loss: 1.5485  loss:1.5428,stance loss: 1.1846 
Train step: 110 acc:0.57038 total_loss: 1.5495  loss:1.6204,stance loss: 1.1691 
Better F1! Saving model!
Saving model of best f1: 0.049140049140049144
              precision    recall  f1-score   support

           0   0.052493  0.769231  0.098280        26
           1   0.781421  0.704433  0.740933       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.289007       564
   macro avg   0.277971  0.491221  0.279738       564
weighted avg   0.283676  0.289007  0.271214       564

Test Acc: 0.28900709219858156 F1_ma:0.049140049140049144
Train step: 120 acc:0.57386 total_loss: 1.5494  loss:1.4815,stance loss: 0.96435 
Train step: 130 acc:0.57395 total_loss: 1.5377  loss:1.229,stance loss: 0.80135 
Train step: 140 acc:0.57624 total_loss: 1.533  loss:1.6692,stance loss: 1.0604 
Train step: 150 acc:0.5803 total_loss: 1.5186  loss:1.1337,stance loss: 0.67536 
Train step: 160 acc:0.57803 total_loss: 1.5168  loss:1.3951,stance loss: 0.79362 
Train step: 170 acc:0.57712 total_loss: 1.5124  loss:1.1084,stance loss: 0.71745 
Train step: 180 acc:0.57735 total_loss: 1.5111  loss:1.4092,stance loss: 1.1562 
Train step: 190 acc:0.58017 total_loss: 1.5125  loss:1.6295,stance loss: 1.0965 
Train step: 200 acc:0.58209 total_loss: 1.5089  loss:1.1412,stance loss: 0.8362 
Train step: 210 acc:0.57909 total_loss: 1.5064  loss:1.647,stance loss: 1.1979 
Train step: 220 acc:0.58032 total_loss: 1.5033  loss:1.5587,stance loss: 0.9907 
Better F1! Saving model!
Saving model of best f1: 0.05152224824355972
              precision    recall  f1-score   support

           0   0.054863  0.846154  0.103044        26
           1   0.834356  0.669951  0.743169       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.280142       564
   macro avg   0.296406  0.505368  0.282071       564
weighted avg   0.302838  0.280142  0.272239       564

Test Acc: 0.2801418439716312 F1_ma:0.05152224824355972
Train step: 230 acc:0.57982 total_loss: 1.5  loss:1.2233,stance loss: 0.82721 
Train step: 240 acc:0.57962 total_loss: 1.4981  loss:1.5493,stance loss: 1.2051 
Train step: 250 acc:0.57968 total_loss: 1.4935  loss:1.2655,stance loss: 0.8356 
Train step: 260 acc:0.57926 total_loss: 1.4933  loss:1.6893,stance loss: 1.0804 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.75 total_loss: 1.2015  loss:1.2015,stance loss: 0.85395 
Train step: 280 acc:0.59091 total_loss: 1.4131  loss:0.98205,stance loss: 0.56485 
Train step: 290 acc:0.60714 total_loss: 1.3958  loss:1.4235,stance loss: 0.87575 
Better F1! Saving model!
Saving model of best f1: 0.05191873589164785
              precision    recall  f1-score   support

           0   0.055156  0.884615  0.103837        26
           1   0.891156  0.645320  0.748571       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.273050       564
   macro avg   0.315437  0.509979  0.284136       564
weighted avg   0.323296  0.273050  0.274219       564

Test Acc: 0.2730496453900709 F1_ma:0.05191873589164785
Train step: 300 acc:0.6129 total_loss: 1.3934  loss:1.3251,stance loss: 0.9311 
Train step: 310 acc:0.60518 total_loss: 1.4189  loss:1.3485,stance loss: 1.0398 
Better F1! Saving model!
Saving model of best f1: 0.05198019801980198
              precision    recall  f1-score   support

           0   0.055556  0.807692  0.103960        26
           1   0.833333  0.763547  0.796915       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.312057       564
   macro avg   0.296296  0.523746  0.300292       564
weighted avg   0.302502  0.312057  0.291625       564

Test Acc: 0.3120567375886525 F1_ma:0.05198019801980198
Train step: 320 acc:0.60172 total_loss: 1.4254  loss:1.5181,stance loss: 1.5666 
Train step: 330 acc:0.60861 total_loss: 1.4065  loss:1.3749,stance loss: 1.1295 
Train step: 340 acc:0.60915 total_loss: 1.4051  loss:1.4763,stance loss: 1.1557 
Better F1! Saving model!
Saving model of best f1: 0.05555555555555555
              precision    recall  f1-score   support

           0   0.059113  0.923077  0.111111        26
           1   0.860759  0.669951  0.753463       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.283688       564
   macro avg   0.306624  0.531009  0.288191       564
weighted avg   0.312537  0.283688  0.276315       564

Test Acc: 0.28368794326241137 F1_ma:0.05555555555555555
Train step: 350 acc:0.61806 total_loss: 1.3973  loss:1.22,stance loss: 0.87898 
Train step: 360 acc:0.61882 total_loss: 1.3891  loss:1.1482,stance loss: 0.82062 
Train step: 370 acc:0.61572 total_loss: 1.392  loss:1.6205,stance loss: 1.2082 
Train step: 380 acc:0.61374 total_loss: 1.3971  loss:1.505,stance loss: 0.90109 
Train step: 390 acc:0.61054 total_loss: 1.4061  loss:1.7856,stance loss: 1.2294 
Train step: 400 acc:0.61546 total_loss: 1.3953  loss:1.2659,stance loss: 1.032 
Train step: 410 acc:0.61968 total_loss: 1.3942  loss:1.2954,stance loss: 0.99432 
Train step: 420 acc:0.62169 total_loss: 1.3942  loss:1.3874,stance loss: 1.0797 
Train step: 430 acc:0.62228 total_loss: 1.3904  loss:1.6509,stance loss: 1.3649 
Train step: 440 acc:0.6239 total_loss: 1.3883  loss:1.2444,stance loss: 0.71065 
Train step: 450 acc:0.62465 total_loss: 1.3879  loss:1.3481,stance loss: 0.94725 
Train step: 460 acc:0.62107 total_loss: 1.39  loss:1.4592,stance loss: 1.517 
Train step: 470 acc:0.62251 total_loss: 1.3852  loss:1.6247,stance loss: 1.7026 
Train step: 480 acc:0.62293 total_loss: 1.3842  loss:0.97873,stance loss: 0.70569 
Train step: 490 acc:0.62415 total_loss: 1.3753  loss:0.99212,stance loss: 0.58823 
Train step: 500 acc:0.62446 total_loss: 1.3729  loss:1.3169,stance loss: 0.95788 
Train step: 510 acc:0.625 total_loss: 1.3683  loss:1.4142,stance loss: 1.5156 
Train step: 520 acc:0.62849 total_loss: 1.3603  loss:1.4549,stance loss: 1.6314 
Train step: 530 acc:0.62787 total_loss: 1.3642  loss:1.7147,stance loss: 1.6923 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.8125 total_loss: 1.003  loss:1.003,stance loss: 0.69799 
Train step: 550 acc:0.65341 total_loss: 1.2603  loss:1.2426,stance loss: 1.3906 
Train step: 560 acc:0.6875 total_loss: 1.2458  loss:1.3801,stance loss: 1.3123 
Train step: 570 acc:0.69556 total_loss: 1.2459  loss:1.2762,stance loss: 1.3715 
Train step: 580 acc:0.6875 total_loss: 1.2557  loss:1.3337,stance loss: 1.0242 
Train step: 590 acc:0.68382 total_loss: 1.2476  loss:1.3042,stance loss: 0.90328 
Better F1! Saving model!
Saving model of best f1: 0.05555555555555556
              precision    recall  f1-score   support

           0   0.059459  0.846154  0.111111        26
           1   0.814433  0.778325  0.795970       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.319149       564
   macro avg   0.291297  0.541493  0.302360       564
weighted avg   0.295879  0.319149  0.291615       564

Test Acc: 0.3191489361702128 F1_ma:0.05555555555555556
Train step: 600 acc:0.68238 total_loss: 1.2715  loss:1.1102,stance loss: 1.0172 
Train step: 610 acc:0.67518 total_loss: 1.2682  loss:0.87886,stance loss: 0.5849 
Train step: 620 acc:0.67438 total_loss: 1.2786  loss:1.8891,stance loss: 1.9247 
Better F1! Saving model!
Saving model of best f1: 0.05612244897959184
              precision    recall  f1-score   support

           0   0.060109  0.846154  0.112245        26
           1   0.803030  0.783251  0.793017       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.320922       564
   macro avg   0.287713  0.543135  0.301754       564
weighted avg   0.291805  0.320922  0.290604       564

Test Acc: 0.32092198581560283 F1_ma:0.05612244897959184
Train step: 630 acc:0.67857 total_loss: 1.2577  loss:1.136,stance loss: 0.79911 
Train step: 640 acc:0.67574 total_loss: 1.2564  loss:0.94223,stance loss: 0.65964 
Train step: 650 acc:0.67117 total_loss: 1.2595  loss:1.1491,stance loss: 0.84974 
Train step: 660 acc:0.6689 total_loss: 1.2617  loss:1.1509,stance loss: 0.68839 
Train step: 670 acc:0.66889 total_loss: 1.2633  loss:0.87549,stance loss: 0.67583 
Train step: 680 acc:0.66578 total_loss: 1.2678  loss:0.91233,stance loss: 0.57089 
Train step: 690 acc:0.66763 total_loss: 1.2642  loss:1.7728,stance loss: 1.7354 
Train step: 700 acc:0.67003 total_loss: 1.2574  loss:1.0055,stance loss: 0.72689 
Train step: 710 acc:0.66776 total_loss: 1.2576  loss:1.1576,stance loss: 0.81225 
Train step: 720 acc:0.66644 total_loss: 1.2637  loss:1.155,stance loss: 1.2529 
Train step: 730 acc:0.66459 total_loss: 1.2675  loss:1.2395,stance loss: 0.73635 
Train step: 740 acc:0.6676 total_loss: 1.262  loss:1.0049,stance loss: 0.75524 
Train step: 750 acc:0.66795 total_loss: 1.2634  loss:1.2919,stance loss: 1.4945 
Train step: 760 acc:0.66629 total_loss: 1.2676  loss:1.9902,stance loss: 1.9216 
Train step: 770 acc:0.66531 total_loss: 1.2642  loss:1.1678,stance loss: 0.86652 
Train step: 780 acc:0.66572 total_loss: 1.2632  loss:1.1809,stance loss: 0.92 
Train step: 790 acc:0.66584 total_loss: 1.262  loss:1.5193,stance loss: 1.6828 
Train step: 800 acc:0.66715 total_loss: 1.2621  loss:1.0855,stance loss: 0.78392 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.4375 total_loss: 1.6629  loss:1.6629,stance loss: 1.1329 
Train step: 820 acc:0.65909 total_loss: 1.1779  loss:1.1531,stance loss: 0.89096 
Train step: 830 acc:0.70238 total_loss: 1.1361  loss:0.86405,stance loss: 0.57221 
Train step: 840 acc:0.69556 total_loss: 1.1336  loss:1.0088,stance loss: 0.78102 
Train step: 850 acc:0.68902 total_loss: 1.145  loss:1.2404,stance loss: 0.80253 
Train step: 860 acc:0.68505 total_loss: 1.1524  loss:1.5266,stance loss: 1.206 
Train step: 870 acc:0.68545 total_loss: 1.1476  loss:1.0843,stance loss: 0.81243 
Train step: 880 acc:0.6875 total_loss: 1.1532  loss:1.1381,stance loss: 0.8952 
Train step: 890 acc:0.68596 total_loss: 1.152  loss:1.0187,stance loss: 0.67243 
Train step: 900 acc:0.68887 total_loss: 1.1502  loss:1.1676,stance loss: 1.2974 
Train step: 910 acc:0.68069 total_loss: 1.1666  loss:1.0113,stance loss: 0.76531 
Train step: 920 acc:0.68131 total_loss: 1.173  loss:1.4108,stance loss: 1.6319 
Train step: 930 acc:0.68182 total_loss: 1.1747  loss:1.0336,stance loss: 0.71297 
Train step: 940 acc:0.68416 total_loss: 1.173  loss:0.81049,stance loss: 0.64043 
Train step: 950 acc:0.68174 total_loss: 1.1766  loss:1.0883,stance loss: 0.81218 
Train step: 960 acc:0.67964 total_loss: 1.1753  loss:1.3462,stance loss: 1.0454 
Train step: 970 acc:0.68012 total_loss: 1.1695  loss:1.1156,stance loss: 0.84019 
Train step: 980 acc:0.68056 total_loss: 1.166  loss:1.0331,stance loss: 0.76732 
Train step: 990 acc:0.67956 total_loss: 1.1655  loss:1.0502,stance loss: 0.6988 
Train step: 1000 acc:0.67932 total_loss: 1.1639  loss:1.7171,stance loss: 1.7774 
Train step: 1010 acc:0.68066 total_loss: 1.1662  loss:1.2925,stance loss: 0.8912 
Train step: 1020 acc:0.68009 total_loss: 1.1641  loss:0.95951,stance loss: 0.78477 
Train step: 1030 acc:0.68354 total_loss: 1.1594  loss:1.2705,stance loss: 1.0042 
Train step: 1040 acc:0.68182 total_loss: 1.1628  loss:1.3612,stance loss: 0.94455 
Train step: 1050 acc:0.68076 total_loss: 1.1624  loss:1.2664,stance loss: 0.96038 
Train step: 1060 acc:0.68003 total_loss: 1.1667  loss:0.98107,stance loss: 0.72857 
Train step: 1070 acc:0.6808 total_loss: 1.1644  loss:1.4481,stance loss: 1.5625 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.75 total_loss: 1.2456  loss:1.2456,stance loss: 1.4476 
Train step: 1090 acc:0.74432 total_loss: 1.0184  loss:1.0264,stance loss: 0.84563 
Train step: 1100 acc:0.72619 total_loss: 1.0686  loss:1.5266,stance loss: 1.6262 
Train step: 1110 acc:0.6996 total_loss: 1.077  loss:1.1145,stance loss: 0.80097 
Train step: 1120 acc:0.6936 total_loss: 1.1082  loss:1.2863,stance loss: 1.4633 
Train step: 1130 acc:0.68627 total_loss: 1.1251  loss:0.96625,stance loss: 0.71922 
Train step: 1140 acc:0.69057 total_loss: 1.1195  loss:1.4139,stance loss: 1.1631 
Train step: 1150 acc:0.69278 total_loss: 1.1203  loss:1.1035,stance loss: 0.82976 
Train step: 1160 acc:0.69367 total_loss: 1.1058  loss:0.81399,stance loss: 0.51158 
Train step: 1170 acc:0.69437 total_loss: 1.1092  loss:1.3608,stance loss: 0.90066 
Train step: 1180 acc:0.69183 total_loss: 1.124  loss:1.3176,stance loss: 0.94361 
Train step: 1190 acc:0.68975 total_loss: 1.12  loss:1.1942,stance loss: 0.60899 
Train step: 1200 acc:0.69112 total_loss: 1.1085  loss:0.86361,stance loss: 0.63393 
Train step: 1210 acc:0.698 total_loss: 1.0951  loss:1.1615,stance loss: 0.85535 
Train step: 1220 acc:0.69991 total_loss: 1.0978  loss:1.2549,stance loss: 1.167 
Train step: 1230 acc:0.69868 total_loss: 1.0991  loss:0.896,stance loss: 0.59461 
Train step: 1240 acc:0.69992 total_loss: 1.1008  loss:1.1331,stance loss: 1.2987 
Train step: 1250 acc:0.70175 total_loss: 1.1011  loss:1.2724,stance loss: 1.4623 
Train step: 1260 acc:0.70235 total_loss: 1.1008  loss:1.047,stance loss: 1.1893 
Train step: 1270 acc:0.70386 total_loss: 1.1022  loss:1.2718,stance loss: 1.0061 
Train step: 1280 acc:0.70149 total_loss: 1.105  loss:1.142,stance loss: 0.66073 
Better F1! Saving model!
Saving model of best f1: 0.05687203791469195
              precision    recall  f1-score   support

           0   0.060606  0.923077  0.113744        26
           1   0.851190  0.704433  0.770889       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.296099       564
   macro avg   0.303932  0.542503  0.294878       564
weighted avg   0.309162  0.296099  0.282709       564

Test Acc: 0.29609929078014185 F1_ma:0.05687203791469195
Train step: 1290 acc:0.69846 total_loss: 1.1075  loss:1.1551,stance loss: 0.79747 
Train step: 1300 acc:0.69881 total_loss: 1.1076  loss:1.7017,stance loss: 1.2877 
Train step: 1310 acc:0.69859 total_loss: 1.1046  loss:0.8473,stance loss: 0.51371 
Train step: 1320 acc:0.69865 total_loss: 1.099  loss:0.85005,stance loss: 0.71841 
Train step: 1330 acc:0.70095 total_loss: 1.0968  loss:0.69974,stance loss: 0.48394 
Train step: 1340 acc:0.70067 total_loss: 1.0995  loss:0.86467,stance loss: 0.67022 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.9375 total_loss: 0.44443  loss:0.44443,stance loss: 0.17523 
Train step: 1360 acc:0.75568 total_loss: 0.98378  loss:1.101,stance loss: 0.87537 
Train step: 1370 acc:0.77381 total_loss: 1.0303  loss:1.017,stance loss: 1.2093 
Train step: 1380 acc:0.76008 total_loss: 1.0242  loss:0.65481,stance loss: 0.48382 
Train step: 1390 acc:0.75457 total_loss: 1.0412  loss:0.82113,stance loss: 0.67803 
Train step: 1400 acc:0.74142 total_loss: 1.0576  loss:1.1725,stance loss: 1.0046 
Train step: 1410 acc:0.74283 total_loss: 1.0515  loss:1.2961,stance loss: 1.5861 
Train step: 1420 acc:0.74208 total_loss: 1.0486  loss:1.0717,stance loss: 0.84153 
Train step: 1430 acc:0.73611 total_loss: 1.0457  loss:1.0136,stance loss: 0.76182 
Train step: 1440 acc:0.73832 total_loss: 1.0453  loss:0.66083,stance loss: 0.55998 
Train step: 1450 acc:0.73762 total_loss: 1.0523  loss:0.86163,stance loss: 0.6039 
Train step: 1460 acc:0.73592 total_loss: 1.0492  loss:1.1068,stance loss: 0.85627 
Train step: 1470 acc:0.7376 total_loss: 1.0467  loss:0.83519,stance loss: 0.69864 
Train step: 1480 acc:0.73139 total_loss: 1.0479  loss:0.81015,stance loss: 0.52429 
Train step: 1490 acc:0.73183 total_loss: 1.0519  loss:1.1589,stance loss: 1.3834 
Train step: 1500 acc:0.73137 total_loss: 1.0393  loss:0.74807,stance loss: 0.5744 
Train step: 1510 acc:0.7302 total_loss: 1.0413  loss:0.86658,stance loss: 0.7135 
Train step: 1520 acc:0.73063 total_loss: 1.0453  loss:1.4452,stance loss: 1.5626 
Train step: 1530 acc:0.73204 total_loss: 1.0431  loss:0.93644,stance loss: 0.69747 
Train step: 1540 acc:0.73266 total_loss: 1.0386  loss:0.72711,stance loss: 0.56895 
Train step: 1550 acc:0.72917 total_loss: 1.0402  loss:1.0348,stance loss: 0.70207 
Train step: 1560 acc:0.7263 total_loss: 1.0387  loss:0.90603,stance loss: 0.67976 
Train step: 1570 acc:0.7254 total_loss: 1.0408  loss:1.1703,stance loss: 0.97792 
Train step: 1580 acc:0.727 total_loss: 1.038  loss:0.81103,stance loss: 0.60915 
Train step: 1590 acc:0.72614 total_loss: 1.0434  loss:1.2483,stance loss: 0.96455 
Train step: 1600 acc:0.72834 total_loss: 1.0404  loss:0.95105,stance loss: 1.1863 
Train step: 1610 acc:0.72917 total_loss: 1.0389  loss:0.8175,stance loss: 0.52242 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.8125 total_loss: 0.74584  loss:0.74584,stance loss: 0.5877 
Train step: 1630 acc:0.80114 total_loss: 0.83944  loss:0.93599,stance loss: 0.72117 
Train step: 1640 acc:0.76488 total_loss: 0.97998  loss:0.8748,stance loss: 0.7051 
Train step: 1650 acc:0.76815 total_loss: 0.97461  loss:1.0144,stance loss: 0.8039 
Train step: 1660 acc:0.75152 total_loss: 0.99655  loss:1.3874,stance loss: 1.6052 
Train step: 1670 acc:0.75245 total_loss: 0.994  loss:1.1409,stance loss: 0.91218 
Train step: 1680 acc:0.74488 total_loss: 1.0135  loss:1.4597,stance loss: 1.6317 
Train step: 1690 acc:0.74648 total_loss: 1.0187  loss:0.61449,stance loss: 0.42381 
Train step: 1700 acc:0.75077 total_loss: 1.008  loss:1.1302,stance loss: 0.66562 
Train step: 1710 acc:0.74931 total_loss: 0.99494  loss:1.4351,stance loss: 1.2455 
Train step: 1720 acc:0.75309 total_loss: 0.9866  loss:0.96354,stance loss: 1.1456 
Train step: 1730 acc:0.75 total_loss: 0.98136  loss:0.77009,stance loss: 0.54427 
Train step: 1740 acc:0.75052 total_loss: 0.973  loss:0.62705,stance loss: 0.46606 
Train step: 1750 acc:0.74618 total_loss: 0.97285  loss:0.94309,stance loss: 1.1169 
Train step: 1760 acc:0.74778 total_loss: 0.96823  loss:1.0173,stance loss: 0.8078 
Train step: 1770 acc:0.75 total_loss: 0.96018  loss:1.0172,stance loss: 0.84035 
Train step: 1780 acc:0.74806 total_loss: 0.9578  loss:0.75618,stance loss: 0.55215 
Train step: 1790 acc:0.74744 total_loss: 0.95778  loss:1.5691,stance loss: 1.835 
Train step: 1800 acc:0.75035 total_loss: 0.95502  loss:0.81117,stance loss: 0.64764 
Train step: 1810 acc:0.74935 total_loss: 0.95902  loss:1.0044,stance loss: 0.80512 
Train step: 1820 acc:0.74813 total_loss: 0.96166  loss:1.0759,stance loss: 0.68723 
Train step: 1830 acc:0.74852 total_loss: 0.96487  loss:0.82234,stance loss: 0.6317 
Train step: 1840 acc:0.74576 total_loss: 0.96718  loss:0.89303,stance loss: 0.62838 
Train step: 1850 acc:0.74784 total_loss: 0.9595  loss:0.83227,stance loss: 0.5587 
Train step: 1860 acc:0.74715 total_loss: 0.95902  loss:1.038,stance loss: 0.80714 
Train step: 1870 acc:0.74726 total_loss: 0.95643  loss:1.3747,stance loss: 1.5591 
Train step: 1880 acc:0.74665 total_loss: 0.95642  loss:0.75012,stance loss: 0.58927 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.625 total_loss: 0.98518  loss:0.98518,stance loss: 0.72874 
Train step: 1900 acc:0.74432 total_loss: 0.91962  loss:0.93706,stance loss: 0.63854 
Train step: 1910 acc:0.76786 total_loss: 0.92393  loss:0.72101,stance loss: 0.49438 
Train step: 1920 acc:0.77823 total_loss: 0.90916  loss:1.1679,stance loss: 0.9824 
Train step: 1930 acc:0.78201 total_loss: 0.86935  loss:0.89841,stance loss: 0.67901 
Train step: 1940 acc:0.77451 total_loss: 0.87357  loss:1.3368,stance loss: 1.0546 
Train step: 1950 acc:0.77766 total_loss: 0.86422  loss:1.0134,stance loss: 1.1761 
Train step: 1960 acc:0.77201 total_loss: 0.88539  loss:0.60356,stance loss: 0.44139 
Train step: 1970 acc:0.77392 total_loss: 0.87741  loss:0.76929,stance loss: 0.59091 
Train step: 1980 acc:0.7761 total_loss: 0.86667  loss:0.25381,stance loss: 0.037971 
Train step: 1990 acc:0.76918 total_loss: 0.88095  loss:1.5639,stance loss: 1.1467 
Train step: 2000 acc:0.7714 total_loss: 0.88046  loss:0.49349,stance loss: 0.41013 
Train step: 2010 acc:0.77118 total_loss: 0.87464  loss:0.7334,stance loss: 0.52912 
Train step: 2020 acc:0.76908 total_loss: 0.88737  loss:1.1785,stance loss: 1.0239 
Train step: 2030 acc:0.76862 total_loss: 0.89111  loss:0.93637,stance loss: 0.65726 
Train step: 2040 acc:0.76697 total_loss: 0.89885  loss:0.61707,stance loss: 0.54619 
Train step: 2050 acc:0.76825 total_loss: 0.89732  loss:1.0713,stance loss: 0.83724 
Train step: 2060 acc:0.76535 total_loss: 0.89965  loss:0.8019,stance loss: 0.64645 
Train step: 2070 acc:0.76381 total_loss: 0.8996  loss:0.76992,stance loss: 0.58908 
Train step: 2080 acc:0.7644 total_loss: 0.89573  loss:0.37981,stance loss: 0.27067 
Train step: 2090 acc:0.76088 total_loss: 0.897  loss:0.70507,stance loss: 0.52197 
Train step: 2100 acc:0.76185 total_loss: 0.89601  loss:1.2456,stance loss: 0.99162 
Train step: 2110 acc:0.76414 total_loss: 0.89279  loss:1.3953,stance loss: 1.6631 
Train step: 2120 acc:0.76218 total_loss: 0.89397  loss:0.85135,stance loss: 0.62546 
Train step: 2130 acc:0.76193 total_loss: 0.89051  loss:0.87126,stance loss: 0.67569 
Train step: 2140 acc:0.7632 total_loss: 0.88678  loss:0.93813,stance loss: 1.1339 
Train step: 2150 acc:0.76341 total_loss: 0.88947  loss:1.0927,stance loss: 0.79744 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.8125 total_loss: 0.78252  loss:0.78252,stance loss: 0.62319 
Train step: 2170 acc:0.81818 total_loss: 0.82553  loss:0.45156,stance loss: 0.35762 
Train step: 2180 acc:0.82738 total_loss: 0.81837  loss:0.76962,stance loss: 0.5754 
Train step: 2190 acc:0.81653 total_loss: 0.79956  loss:0.97951,stance loss: 0.66476 
Train step: 2200 acc:0.8125 total_loss: 0.79412  loss:0.98572,stance loss: 0.79413 
Train step: 2210 acc:0.80515 total_loss: 0.83536  loss:1.3056,stance loss: 1.2556 
Train step: 2220 acc:0.80328 total_loss: 0.82827  loss:0.93632,stance loss: 0.87409 
Train step: 2230 acc:0.80458 total_loss: 0.839  loss:0.76779,stance loss: 0.70539 
Train step: 2240 acc:0.79784 total_loss: 0.83345  loss:0.68946,stance loss: 0.54031 
Train step: 2250 acc:0.80151 total_loss: 0.83293  loss:0.60357,stance loss: 0.47185 
Train step: 2260 acc:0.80136 total_loss: 0.84007  loss:0.74958,stance loss: 0.53606 
Train step: 2270 acc:0.7973 total_loss: 0.83883  loss:0.8576,stance loss: 0.65559 
Train step: 2280 acc:0.79597 total_loss: 0.83971  loss:0.6688,stance loss: 0.49403 
Train step: 2290 acc:0.79771 total_loss: 0.83188  loss:0.7785,stance loss: 0.6175 
Train step: 2300 acc:0.79699 total_loss: 0.83909  loss:0.63855,stance loss: 0.50148 
Train step: 2310 acc:0.79263 total_loss: 0.83987  loss:0.56373,stance loss: 0.44784 
Train step: 2320 acc:0.79231 total_loss: 0.83999  loss:0.66987,stance loss: 0.4918 
Train step: 2330 acc:0.7902 total_loss: 0.84731  loss:0.96267,stance loss: 1.0686 
Train step: 2340 acc:0.78971 total_loss: 0.842  loss:0.78713,stance loss: 0.64633 
Train step: 2350 acc:0.78959 total_loss: 0.84491  loss:0.40653,stance loss: 0.24451 
Train step: 2360 acc:0.78887 total_loss: 0.84529  loss:0.60305,stance loss: 0.4121 
Train step: 2370 acc:0.78851 total_loss: 0.84632  loss:0.75604,stance loss: 0.46265 
Train step: 2380 acc:0.78931 total_loss: 0.84417  loss:0.41596,stance loss: 0.29837 
Train step: 2390 acc:0.78977 total_loss: 0.83621  loss:0.67206,stance loss: 0.5564 
Train step: 2400 acc:0.79098 total_loss: 0.83382  loss:0.70008,stance loss: 0.51783 
Train step: 2410 acc:0.78984 total_loss: 0.83122  loss:0.7805,stance loss: 0.50386 
Train step: 2420 acc:0.78951 total_loss: 0.8321  loss:0.80503,stance loss: 0.57435 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.75 total_loss: 0.72376  loss:0.72376,stance loss: 0.49413 
Train step: 2440 acc:0.80682 total_loss: 0.69514  loss:0.89908,stance loss: 1.0892 
Train step: 2450 acc:0.81548 total_loss: 0.73572  loss:0.39123,stance loss: 0.2753 
Train step: 2460 acc:0.8246 total_loss: 0.71465  loss:0.43124,stance loss: 0.29136 
Train step: 2470 acc:0.82012 total_loss: 0.72409  loss:0.7748,stance loss: 0.53704 
Train step: 2480 acc:0.82108 total_loss: 0.73174  loss:0.47935,stance loss: 0.37025 
Train step: 2490 acc:0.81148 total_loss: 0.73247  loss:0.58026,stance loss: 0.45346 
Train step: 2500 acc:0.81514 total_loss: 0.71151  loss:0.46098,stance loss: 0.29691 
Train step: 2510 acc:0.81559 total_loss: 0.71965  loss:0.81106,stance loss: 0.68837 
Train step: 2520 acc:0.81937 total_loss: 0.71009  loss:1.1432,stance loss: 1.1831 
Train step: 2530 acc:0.81436 total_loss: 0.72707  loss:0.60408,stance loss: 0.48616 
Train step: 2540 acc:0.81757 total_loss: 0.72834  loss:0.57999,stance loss: 0.39616 
Train step: 2550 acc:0.8156 total_loss: 0.73213  loss:0.55046,stance loss: 0.39025 
Train step: 2560 acc:0.81632 total_loss: 0.72929  loss:0.61339,stance loss: 0.46346 
Train step: 2570 acc:0.81649 total_loss: 0.72969  loss:0.73489,stance loss: 0.52964 
Train step: 2580 acc:0.81871 total_loss: 0.72576  loss:0.79142,stance loss: 0.61854 
Train step: 2590 acc:0.8191 total_loss: 0.72795  loss:1.1266,stance loss: 0.88431 
Train step: 2600 acc:0.81689 total_loss: 0.73292  loss:0.49802,stance loss: 0.37125 
Train step: 2610 acc:0.81768 total_loss: 0.7284  loss:0.90625,stance loss: 1.1815 
Train step: 2620 acc:0.81839 total_loss: 0.72585  loss:0.48749,stance loss: 0.32603 
Train step: 2630 acc:0.81872 total_loss: 0.72545  loss:0.68878,stance loss: 0.60549 
Train step: 2640 acc:0.82109 total_loss: 0.72211  loss:0.15581,stance loss: 0.026986 
Train step: 2650 acc:0.82268 total_loss: 0.71656  loss:0.57609,stance loss: 0.42251 
Train step: 2660 acc:0.82359 total_loss: 0.71282  loss:0.75607,stance loss: 0.56008 
Train step: 2670 acc:0.82313 total_loss: 0.70931  loss:0.39383,stance loss: 0.26572 
Train step: 2680 acc:0.82196 total_loss: 0.70963  loss:0.7468,stance loss: 0.56321 
Train step: 2690 acc:0.82256 total_loss: 0.71277  loss:0.95586,stance loss: 0.74595 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.6875 total_loss: 0.76089  loss:0.76089,stance loss: 0.67607 
Train step: 2710 acc:0.85795 total_loss: 0.62487  loss:0.44,stance loss: 0.329 
Train step: 2720 acc:0.83333 total_loss: 0.69695  loss:1.1273,stance loss: 0.88394 
Train step: 2730 acc:0.82258 total_loss: 0.69932  loss:0.63896,stance loss: 0.43922 
Train step: 2740 acc:0.82927 total_loss: 0.67649  loss:0.44926,stance loss: 0.32438 
Train step: 2750 acc:0.82353 total_loss: 0.67787  loss:0.85321,stance loss: 1.0843 
Train step: 2760 acc:0.83299 total_loss: 0.66787  loss:0.52945,stance loss: 0.35828 
Train step: 2770 acc:0.82923 total_loss: 0.67298  loss:1.0822,stance loss: 0.97722 
Train step: 2780 acc:0.83488 total_loss: 0.67905  loss:0.71647,stance loss: 1.0731 
Train step: 2790 acc:0.83723 total_loss: 0.67502  loss:0.93132,stance loss: 0.64829 
Train step: 2800 acc:0.83911 total_loss: 0.67257  loss:0.73384,stance loss: 0.58699 
Train step: 2810 acc:0.84234 total_loss: 0.66816  loss:0.66889,stance loss: 0.47457 
Train step: 2820 acc:0.84039 total_loss: 0.66862  loss:0.91476,stance loss: 0.5326 
Train step: 2830 acc:0.84447 total_loss: 0.65881  loss:0.37253,stance loss: 0.24318 
Train step: 2840 acc:0.84397 total_loss: 0.66125  loss:0.66742,stance loss: 0.48411 
Train step: 2850 acc:0.8481 total_loss: 0.65419  loss:0.50807,stance loss: 0.48957 
Train step: 2860 acc:0.84783 total_loss: 0.64983  loss:0.51501,stance loss: 0.44642 
Train step: 2870 acc:0.84759 total_loss: 0.6509  loss:0.42327,stance loss: 0.29142 
Train step: 2880 acc:0.84807 total_loss: 0.64639  loss:0.56047,stance loss: 0.46706 
Train step: 2890 acc:0.84817 total_loss: 0.6418  loss:0.94155,stance loss: 0.63595 
Train step: 2900 acc:0.84919 total_loss: 0.63988  loss:0.58765,stance loss: 0.48005 
Better F1! Saving model!
Saving model of best f1: 0.05727400381517592
              precision    recall  f1-score   support

           0   0.054502  0.884615  0.102679        26
           1   0.857143  0.591133  0.699708       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.257092       564
   macro avg   0.637215  0.493906  0.271419       564
weighted avg   0.904995  0.257092  0.263629       564

Test Acc: 0.2570921985815603 F1_ma:0.05727400381517592
Train step: 2910 acc:0.84864 total_loss: 0.64314  loss:0.43287,stance loss: 0.41119 
Train step: 2920 acc:0.84842 total_loss: 0.64178  loss:0.67822,stance loss: 0.52882 
Train step: 2930 acc:0.84713 total_loss: 0.64378  loss:0.69378,stance loss: 0.51905 
Better F1! Saving model!
Saving model of best f1: 0.05762011135931717
              precision    recall  f1-score   support

           0   0.054893  0.884615  0.103371        26
           1   0.846154  0.596059  0.699422       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.258865       564
   macro avg   0.633682  0.495548  0.271554       564
weighted avg   0.901058  0.258865  0.263558       564

Test Acc: 0.25886524822695034 F1_ma:0.05762011135931717
Train step: 2940 acc:0.84518 total_loss: 0.64718  loss:0.42235,stance loss: 0.35623 
Train step: 2950 acc:0.84462 total_loss: 0.65117  loss:0.56636,stance loss: 0.44968 
Train step: 2960 acc:0.84507 total_loss: 0.65788  loss:1.0301,stance loss: 1.3478 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.8125 total_loss: 0.50658  loss:0.50658,stance loss: 0.37784 
Train step: 2980 acc:0.89205 total_loss: 0.53747  loss:0.29744,stance loss: 0.18895 
Train step: 2990 acc:0.87798 total_loss: 0.58925  loss:0.87042,stance loss: 0.49255 
Train step: 3000 acc:0.87097 total_loss: 0.57468  loss:0.81828,stance loss: 0.65524 
Train step: 3010 acc:0.8628 total_loss: 0.63945  loss:0.70898,stance loss: 0.51798 
Train step: 3020 acc:0.8652 total_loss: 0.61656  loss:0.16192,stance loss: 0.087593 
Train step: 3030 acc:0.86885 total_loss: 0.61613  loss:0.34907,stance loss: 0.23706 
Train step: 3040 acc:0.8662 total_loss: 0.61954  loss:0.99107,stance loss: 0.91907 
Train step: 3050 acc:0.86883 total_loss: 0.61251  loss:1.0478,stance loss: 1.2901 
Train step: 3060 acc:0.87088 total_loss: 0.59941  loss:0.24294,stance loss: 0.14748 
Train step: 3070 acc:0.87314 total_loss: 0.59965  loss:0.26212,stance loss: 0.1464 
Train step: 3080 acc:0.87162 total_loss: 0.59919  loss:0.40581,stance loss: 0.29699 
Train step: 3090 acc:0.87242 total_loss: 0.60252  loss:0.33759,stance loss: 0.27669 
Train step: 3100 acc:0.87452 total_loss: 0.5955  loss:0.23584,stance loss: 0.11112 
Train step: 3110 acc:0.87367 total_loss: 0.59436  loss:0.81433,stance loss: 0.63669 
Train step: 3120 acc:0.8721 total_loss: 0.59031  loss:0.45919,stance loss: 0.43938 
Train step: 3130 acc:0.87112 total_loss: 0.59072  loss:0.80427,stance loss: 0.58478 
Train step: 3140 acc:0.87208 total_loss: 0.58365  loss:0.34581,stance loss: 0.22327 
Train step: 3150 acc:0.87086 total_loss: 0.582  loss:0.68096,stance loss: 0.56876 
Train step: 3160 acc:0.86911 total_loss: 0.57979  loss:0.55822,stance loss: 0.36671 
Train step: 3170 acc:0.87158 total_loss: 0.57631  loss:0.43692,stance loss: 0.51038 
Train step: 3180 acc:0.87026 total_loss: 0.58123  loss:0.63482,stance loss: 0.51939 
Train step: 3190 acc:0.87076 total_loss: 0.57618  loss:0.22511,stance loss: 0.052788 
Train step: 3200 acc:0.86959 total_loss: 0.58226  loss:1.1053,stance loss: 0.76433 
Train step: 3210 acc:0.86929 total_loss: 0.58941  loss:1.1791,stance loss: 0.95274 
Train step: 3220 acc:0.86927 total_loss: 0.59192  loss:0.73914,stance loss: 1.0719 
Train step: 3230 acc:0.86877 total_loss: 0.5962  loss:0.73594,stance loss: 1.0876 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.28809  loss:0.28809,stance loss: 0.18443 
Train step: 3250 acc:0.86932 total_loss: 0.52549  loss:0.79834,stance loss: 1.0753 
Train step: 3260 acc:0.88393 total_loss: 0.4895  loss:0.39845,stance loss: 0.32257 
Better F1! Saving model!
Saving model of best f1: 0.0617486715892623
              precision    recall  f1-score   support

           0   0.059406  0.923077  0.111628        26
           1   0.841772  0.655172  0.736842       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.281915       564
   macro avg   0.633726  0.528073  0.286780       564
weighted avg   0.899688  0.281915  0.277407       564

Test Acc: 0.28191489361702127 F1_ma:0.0617486715892623
Train step: 3270 acc:0.88911 total_loss: 0.51895  loss:0.53562,stance loss: 0.41716 
Train step: 3280 acc:0.89329 total_loss: 0.52642  loss:0.66912,stance loss: 1.0462 
Train step: 3290 acc:0.89583 total_loss: 0.52564  loss:0.71927,stance loss: 0.53392 
Train step: 3300 acc:0.89344 total_loss: 0.53305  loss:0.55459,stance loss: 0.48434 
Train step: 3310 acc:0.89085 total_loss: 0.55505  loss:0.36981,stance loss: 0.30934 
Train step: 3320 acc:0.8912 total_loss: 0.53941  loss:0.46701,stance loss: 0.32928 
Train step: 3330 acc:0.8908 total_loss: 0.53585  loss:0.85391,stance loss: 0.91121 
Train step: 3340 acc:0.89109 total_loss: 0.53752  loss:0.61251,stance loss: 0.42724 
Train step: 3350 acc:0.89245 total_loss: 0.53657  loss:0.81064,stance loss: 0.63927 
Train step: 3360 acc:0.89101 total_loss: 0.53149  loss:1.0124,stance loss: 1.3934 
Train step: 3370 acc:0.89122 total_loss: 0.52467  loss:0.49854,stance loss: 0.3797 
Train step: 3380 acc:0.89051 total_loss: 0.52307  loss:0.33113,stance loss: 0.23308 
Train step: 3390 acc:0.88742 total_loss: 0.52764  loss:0.22264,stance loss: 0.165 
Train step: 3400 acc:0.88703 total_loss: 0.52495  loss:0.22393,stance loss: 0.10843 
Train step: 3410 acc:0.8867 total_loss: 0.53209  loss:0.85059,stance loss: 1.3052 
Train step: 3420 acc:0.88467 total_loss: 0.53613  loss:0.47354,stance loss: 0.4541 
Train step: 3430 acc:0.88449 total_loss: 0.53337  loss:0.46851,stance loss: 0.37444 
Train step: 3440 acc:0.88526 total_loss: 0.52946  loss:0.24399,stance loss: 0.18495 
Train step: 3450 acc:0.88685 total_loss: 0.52451  loss:0.19397,stance loss: 0.13765 
Train step: 3460 acc:0.88575 total_loss: 0.52072  loss:0.31634,stance loss: 0.29601 
Train step: 3470 acc:0.88772 total_loss: 0.51807  loss:0.33698,stance loss: 0.25716 
Train step: 3480 acc:0.88797 total_loss: 0.52047  loss:0.58303,stance loss: 0.50114 
Train step: 3490 acc:0.8867 total_loss: 0.52241  loss:0.25187,stance loss: 0.16837 
Train step: 3500 acc:0.88578 total_loss: 0.52615  loss:0.67963,stance loss: 0.54031 
Better F1! Saving model!
Saving model of best f1: 0.06702302631578946
              precision    recall  f1-score   support

           0   0.053073  0.730769  0.098958        26
           1   0.768844  0.753695  0.761194       203
           2   0.857143  0.017910  0.035088       335

    accuracy                       0.315603       564
   macro avg   0.559687  0.500791  0.298413       564
weighted avg   0.788295  0.315603  0.299379       564

Test Acc: 0.31560283687943264 F1_ma:0.06702302631578946
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.875 total_loss: 0.35855  loss:0.35855,stance loss: 0.24875 
Train step: 3520 acc:0.89773 total_loss: 0.36634  loss:0.21303,stance loss: 0.11685 
Train step: 3530 acc:0.91667 total_loss: 0.39547  loss:0.29822,stance loss: 0.24607 
Train step: 3540 acc:0.90927 total_loss: 0.42468  loss:0.41687,stance loss: 0.36563 
Train step: 3550 acc:0.90701 total_loss: 0.42475  loss:0.85671,stance loss: 0.76708 
Train step: 3560 acc:0.91299 total_loss: 0.40962  loss:0.16167,stance loss: 0.12958 
Train step: 3570 acc:0.91701 total_loss: 0.39893  loss:0.20279,stance loss: 0.18307 
Train step: 3580 acc:0.91549 total_loss: 0.4068  loss:0.64074,stance loss: 1.0225 
Train step: 3590 acc:0.91281 total_loss: 0.40223  loss:0.078635,stance loss: 0.0077144 
Train step: 3600 acc:0.91209 total_loss: 0.41114  loss:0.18144,stance loss: 0.087705 
Train step: 3610 acc:0.91584 total_loss: 0.40825  loss:0.82721,stance loss: 1.2097 
Train step: 3620 acc:0.91723 total_loss: 0.41263  loss:1.01,stance loss: 1.3649 
Train step: 3630 acc:0.91684 total_loss: 0.42282  loss:0.94933,stance loss: 1.3485 
Train step: 3640 acc:0.91603 total_loss: 0.44493  loss:1.0292,stance loss: 0.72873 
Train step: 3650 acc:0.91445 total_loss: 0.44696  loss:0.37467,stance loss: 0.30711 
Train step: 3660 acc:0.91432 total_loss: 0.44992  loss:0.25471,stance loss: 0.1463 
Train step: 3670 acc:0.91304 total_loss: 0.45102  loss:0.37952,stance loss: 0.31682 
Train step: 3680 acc:0.91374 total_loss: 0.44155  loss:0.17413,stance loss: 0.13175 
Train step: 3690 acc:0.91402 total_loss: 0.44803  loss:0.7207,stance loss: 0.58368 
Train step: 3700 acc:0.91296 total_loss: 0.45233  loss:0.43343,stance loss: 0.35277 
Train step: 3710 acc:0.91045 total_loss: 0.46082  loss:1.5833,stance loss: 1.7634 
Train step: 3720 acc:0.90788 total_loss: 0.46297  loss:0.20181,stance loss: 0.12836 
Train step: 3730 acc:0.90752 total_loss: 0.46342  loss:0.2776,stance loss: 0.21972 
Train step: 3740 acc:0.9072 total_loss: 0.47006  loss:0.9626,stance loss: 1.111 
Train step: 3750 acc:0.9069 total_loss: 0.47032  loss:0.31142,stance loss: 0.30901 
Train step: 3760 acc:0.90762 total_loss: 0.47045  loss:0.62689,stance loss: 1.0478 
Train step: 3770 acc:0.90685 total_loss: 0.47071  loss:0.57892,stance loss: 0.54388 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.9375 total_loss: 0.33926  loss:0.33926,stance loss: 0.24581 
Train step: 3790 acc:0.95455 total_loss: 0.27452  loss:0.19508,stance loss: 0.096389 
Train step: 3800 acc:0.93452 total_loss: 0.38908  loss:0.80183,stance loss: 1.0777 
Train step: 3810 acc:0.92944 total_loss: 0.39024  loss:0.46603,stance loss: 0.29233 
Train step: 3820 acc:0.93445 total_loss: 0.39103  loss:0.56467,stance loss: 1.0098 
Train step: 3830 acc:0.93505 total_loss: 0.39934  loss:0.69339,stance loss: 1.0679 
Train step: 3840 acc:0.93545 total_loss: 0.38374  loss:0.09281,stance loss: 0.028363 
Train step: 3850 acc:0.9375 total_loss: 0.38034  loss:0.16503,stance loss: 0.087653 
Train step: 3860 acc:0.93673 total_loss: 0.37937  loss:0.13326,stance loss: 0.030911 
Train step: 3870 acc:0.93613 total_loss: 0.38258  loss:0.10123,stance loss: 0.073843 
Train step: 3880 acc:0.93564 total_loss: 0.38316  loss:0.29867,stance loss: 0.23471 
Train step: 3890 acc:0.93412 total_loss: 0.38409  loss:0.26661,stance loss: 0.20829 
Train step: 3900 acc:0.93543 total_loss: 0.37708  loss:0.16725,stance loss: 0.090582 
Train step: 3910 acc:0.93702 total_loss: 0.37517  loss:0.2579,stance loss: 0.24608 
Train step: 3920 acc:0.93484 total_loss: 0.37265  loss:0.7748,stance loss: 1.15 
Train step: 3930 acc:0.93419 total_loss: 0.37296  loss:0.23538,stance loss: 0.14028 
Train step: 3940 acc:0.93323 total_loss: 0.37403  loss:0.3433,stance loss: 0.26822 
Train step: 3950 acc:0.93238 total_loss: 0.37511  loss:0.40371,stance loss: 0.40404 
Train step: 3960 acc:0.93059 total_loss: 0.38312  loss:0.34049,stance loss: 0.23914 
Train step: 3970 acc:0.9303 total_loss: 0.38326  loss:0.95324,stance loss: 0.6775 
Better F1! Saving model!
Saving model of best f1: 0.07055590784189389
              precision    recall  f1-score   support

           0   0.056555  0.846154  0.106024        26
           1   0.815476  0.674877  0.738544       203
           2   0.857143  0.017910  0.035088       335

    accuracy                       0.292553       564
   macro avg   0.576391  0.512980  0.293219       564
weighted avg   0.805239  0.292553  0.291552       564

Test Acc: 0.2925531914893617 F1_ma:0.07055590784189389
Train step: 3980 acc:0.92973 total_loss: 0.39013  loss:0.65968,stance loss: 0.36428 
Train step: 3990 acc:0.92921 total_loss: 0.39465  loss:0.64026,stance loss: 1.0733 
Train step: 4000 acc:0.92958 total_loss: 0.39481  loss:1.0633,stance loss: 1.4349 
Train step: 4010 acc:0.92857 total_loss: 0.40422  loss:0.7221,stance loss: 1.1577 
Train step: 4020 acc:0.92868 total_loss: 0.40747  loss:0.24108,stance loss: 0.18413 
Better F1! Saving model!
Saving model of best f1: 0.07510656436487638
              precision    recall  f1-score   support

           0   0.052356  0.769231  0.098039        26
           1   0.802326  0.679803  0.736000       203
           2   0.900000  0.026866  0.052174       335

    accuracy                       0.296099       564
   macro avg   0.584894  0.491966  0.295404       564
weighted avg   0.825768  0.296099  0.300417       564

Test Acc: 0.29609929078014185 F1_ma:0.07510656436487638
Train step: 4030 acc:0.92754 total_loss: 0.4088  loss:0.6095,stance loss: 1.0427 
Train step: 4040 acc:0.92792 total_loss: 0.4066  loss:0.11115,stance loss: 0.073088 
Training finished.


Reload the best model with best f1 0.07510656436487638 from path test_outputs/bert-cross-topic/cc/2023-08-14 15-09-50/state_dict


              precision    recall  f1-score   support

           0   0.052356  0.769231  0.098039        26
           1   0.802326  0.679803  0.736000       203
           2   0.900000  0.026866  0.052174       335

    accuracy                       0.296099       564
   macro avg   0.584894  0.491966  0.295404       564
weighted avg   0.825768  0.296099  0.300417       564

Test Acc: 0.29609929078014185 F1_ma:0.07510656436487638
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.07510656436487638
acc: 0.29609929078014185, f1 :0.29540437624325094
classification report: 
              precision    recall  f1-score   support

         Con     0.0524    0.7692    0.0980        26
        None     0.8023    0.6798    0.7360       203
         Pro     0.9000    0.0269    0.0522       335

    accuracy                         0.2961       564
   macro avg     0.5849    0.4920    0.2954       564
weighted avg     0.8258    0.2961    0.3004       564

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 15-26-59', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 15-26-59
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.6994  loss:1.6994,stance loss: 1.1762 
Train step: 10 acc:0.46023 total_loss: 1.6507  loss:1.8619,stance loss: 1.7851 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 20 acc:0.46726 total_loss: 1.6711  loss:1.7316,stance loss: 1.6883 
Train step: 30 acc:0.49194 total_loss: 1.6367  loss:1.6866,stance loss: 1.1753 
Train step: 40 acc:0.5061 total_loss: 1.6187  loss:1.5559,stance loss: 1.0789 
Train step: 50 acc:0.49387 total_loss: 1.6242  loss:1.5608,stance loss: 1.1165 
Train step: 60 acc:0.49898 total_loss: 1.6145  loss:1.4741,stance loss: 1.0744 
Train step: 70 acc:0.51056 total_loss: 1.5931  loss:1.6152,stance loss: 1.0234 
Train step: 80 acc:0.51543 total_loss: 1.5959  loss:1.4982,stance loss: 1.4693 
Train step: 90 acc:0.52266 total_loss: 1.5936  loss:1.364,stance loss: 0.91412 
Train step: 100 acc:0.52599 total_loss: 1.5911  loss:1.4449,stance loss: 0.95086 
Train step: 110 acc:0.52815 total_loss: 1.5752  loss:1.4078,stance loss: 0.75799 
Train step: 120 acc:0.53306 total_loss: 1.5638  loss:1.543,stance loss: 1.1246 
Train step: 130 acc:0.53531 total_loss: 1.5606  loss:1.641,stance loss: 1.2793 
Train step: 140 acc:0.5359 total_loss: 1.5588  loss:1.5145,stance loss: 1.5096 
Train step: 150 acc:0.54139 total_loss: 1.541  loss:1.6311,stance loss: 1.1663 
Train step: 160 acc:0.54387 total_loss: 1.5374  loss:1.5329,stance loss: 1.5545 
Train step: 170 acc:0.54751 total_loss: 1.532  loss:1.4556,stance loss: 1.0543 
Train step: 180 acc:0.54903 total_loss: 1.525  loss:1.5787,stance loss: 1.1522 
Better F1! Saving model!
Saving model of best f1: 0.04452054794520548
              precision    recall  f1-score   support

           0   0.046595  1.000000  0.089041        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015532  0.333333  0.029680       564
weighted avg   0.002148  0.046099  0.004105       564

Test Acc: 0.04609929078014184 F1_ma:0.04452054794520548
Train step: 190 acc:0.54876 total_loss: 1.528  loss:1.6048,stance loss: 1.0641 
Train step: 200 acc:0.55224 total_loss: 1.5219  loss:1.5291,stance loss: 1.6085 
Train step: 210 acc:0.55421 total_loss: 1.5184  loss:1.7223,stance loss: 1.7403 
Train step: 220 acc:0.55458 total_loss: 1.5148  loss:1.2425,stance loss: 0.85892 
Better F1! Saving model!
Saving model of best f1: 0.047058823529411764
              precision    recall  f1-score   support

           0   0.049587  0.923077  0.094118        26
           1   0.912500  0.359606  0.515901       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.171986       564
   macro avg   0.320696  0.427561  0.203340       564
weighted avg   0.330721  0.171986  0.190027       564

Test Acc: 0.17198581560283688 F1_ma:0.047058823529411764
Train step: 230 acc:0.55032 total_loss: 1.5166  loss:1.4168,stance loss: 0.86628 
Train step: 240 acc:0.55109 total_loss: 1.5158  loss:1.3597,stance loss: 0.93137 
Train step: 250 acc:0.55304 total_loss: 1.5126  loss:1.4079,stance loss: 1.133 
Train step: 260 acc:0.55436 total_loss: 1.5129  loss:1.4562,stance loss: 1.1207 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.25 total_loss: 1.8397  loss:1.8397,stance loss: 1.3246 
Train step: 280 acc:0.56818 total_loss: 1.3493  loss:1.0514,stance loss: 0.66866 
Train step: 290 acc:0.5506 total_loss: 1.428  loss:1.679,stance loss: 1.2614 
Train step: 300 acc:0.56855 total_loss: 1.4153  loss:1.2526,stance loss: 0.70751 
Train step: 310 acc:0.58079 total_loss: 1.4223  loss:1.4518,stance loss: 1.503 
Train step: 320 acc:0.59069 total_loss: 1.4003  loss:1.8043,stance loss: 1.7735 
Better F1! Saving model!
Saving model of best f1: 0.04838709677419354
              precision    recall  f1-score   support

           0   0.051471  0.807692  0.096774        26
           1   0.858974  0.660099  0.746518       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.274823       564
   macro avg   0.303482  0.489264  0.281097       564
weighted avg   0.311543  0.274823  0.273155       564

Test Acc: 0.274822695035461 F1_ma:0.04838709677419354
Train step: 330 acc:0.59836 total_loss: 1.3821  loss:1.6948,stance loss: 1.3103 
Better F1! Saving model!
Saving model of best f1: 0.050955414012738856
              precision    recall  f1-score   support

           0   0.053933  0.923077  0.101911        26
           1   0.899160  0.527094  0.664596       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.232270       564
   macro avg   0.317697  0.483390  0.255502       564
weighted avg   0.326120  0.232270  0.243906       564

Test Acc: 0.2322695035460993 F1_ma:0.050955414012738856
Train step: 340 acc:0.59683 total_loss: 1.3837  loss:0.83029,stance loss: 0.51435 
Better F1! Saving model!
Saving model of best f1: 0.05236907730673317
              precision    recall  f1-score   support

           0   0.056000  0.807692  0.104738        26
           1   0.825397  0.768473  0.795918       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.313830       564
   macro avg   0.293799  0.525388  0.300219       564
weighted avg   0.299666  0.313830  0.291303       564

Test Acc: 0.31382978723404253 F1_ma:0.05236907730673317
Train step: 350 acc:0.60108 total_loss: 1.3765  loss:1.5515,stance loss: 1.4593 
Train step: 360 acc:0.6044 total_loss: 1.3636  loss:1.2594,stance loss: 0.92184 
Train step: 370 acc:0.60767 total_loss: 1.3618  loss:1.4005,stance loss: 1.124 
Better F1! Saving model!
Saving model of best f1: 0.05263157894736842
              precision    recall  f1-score   support

           0   0.056497  0.769231  0.105263        26
           1   0.800000  0.827586  0.813559       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.333333       564
   macro avg   0.285499  0.532272  0.306274       564
weighted avg   0.290548  0.333333  0.297676       564

Test Acc: 0.3333333333333333 F1_ma:0.05263157894736842
Train step: 380 acc:0.60811 total_loss: 1.3565  loss:1.357,stance loss: 0.94286 
Train step: 390 acc:0.61209 total_loss: 1.3544  loss:1.382,stance loss: 1.4443 
Better F1! Saving model!
Saving model of best f1: 0.056497175141242945
              precision    recall  f1-score   support

           0   0.060976  0.769231  0.112994        26
           1   0.754237  0.876847  0.810934       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.351064       564
   macro avg   0.271738  0.548693  0.307976       564
weighted avg   0.274283  0.351064  0.297088       564

Test Acc: 0.35106382978723405 F1_ma:0.056497175141242945
Train step: 400 acc:0.6126 total_loss: 1.3609  loss:1.5925,stance loss: 1.1598 
Train step: 410 acc:0.61746 total_loss: 1.3519  loss:1.3016,stance loss: 1.3288 
Train step: 420 acc:0.62003 total_loss: 1.3467  loss:1.2437,stance loss: 0.91371 
Better F1! Saving model!
Saving model of best f1: 0.058111380145278446
              precision    recall  f1-score   support

           0   0.062016  0.923077  0.116223        26
           1   0.864407  0.753695  0.805263       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.313830       564
   macro avg   0.308807  0.558924  0.307162       564
weighted avg   0.313984  0.313830  0.295195       564

Test Acc: 0.31382978723404253 F1_ma:0.058111380145278446
Train step: 430 acc:0.62034 total_loss: 1.3424  loss:1.2441,stance loss: 0.89712 
Train step: 440 acc:0.62317 total_loss: 1.3309  loss:1.2955,stance loss: 0.97192 
Train step: 450 acc:0.62465 total_loss: 1.3283  loss:1.3054,stance loss: 1.4699 
Train step: 460 acc:0.62664 total_loss: 1.3275  loss:1.4814,stance loss: 1.1499 
Train step: 470 acc:0.625 total_loss: 1.3292  loss:1.718,stance loss: 1.7916 
Train step: 480 acc:0.625 total_loss: 1.328  loss:1.1267,stance loss: 0.8523 
Train step: 490 acc:0.62443 total_loss: 1.3298  loss:1.3281,stance loss: 1.0323 
Train step: 500 acc:0.62581 total_loss: 1.3266  loss:1.5426,stance loss: 1.5721 
Train step: 510 acc:0.62682 total_loss: 1.3314  loss:1.6646,stance loss: 2.134 
Train step: 520 acc:0.63098 total_loss: 1.3263  loss:0.62138,stance loss: 0.19709 
Train step: 530 acc:0.62979 total_loss: 1.3269  loss:1.0615,stance loss: 0.80943 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.5625 total_loss: 1.3589  loss:1.3589,stance loss: 0.85061 
Better F1! Saving model!
Saving model of best f1: 0.05852417302798982
              precision    recall  f1-score   support

           0   0.062670  0.884615  0.117048        26
           1   0.827411  0.802956  0.815000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.329787       564
   macro avg   0.296694  0.562524  0.310683       564
weighted avg   0.300698  0.329787  0.298738       564

Test Acc: 0.32978723404255317 F1_ma:0.05852417302798982
Train step: 550 acc:0.58523 total_loss: 1.4136  loss:1.7081,stance loss: 1.4603 
Train step: 560 acc:0.63095 total_loss: 1.2933  loss:1.3715,stance loss: 0.95995 
Train step: 570 acc:0.63306 total_loss: 1.301  loss:1.498,stance loss: 1.5872 
Train step: 580 acc:0.62805 total_loss: 1.2986  loss:1.3147,stance loss: 0.92614 
Better F1! Saving model!
Saving model of best f1: 0.05956112852664576
              precision    recall  f1-score   support

           0   0.064846  0.730769  0.119122        26
           1   0.686347  0.916256  0.784810       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.363475       564
   macro avg   0.250398  0.549008  0.301311       564
weighted avg   0.250026  0.363475  0.287967       564

Test Acc: 0.36347517730496454 F1_ma:0.05956112852664576
Train step: 590 acc:0.62255 total_loss: 1.2962  loss:0.98176,stance loss: 0.71275 
Train step: 600 acc:0.62193 total_loss: 1.2812  loss:1.7488,stance loss: 1.3448 
Train step: 610 acc:0.63468 total_loss: 1.277  loss:1.1426,stance loss: 0.95577 
Train step: 620 acc:0.63812 total_loss: 1.2826  loss:1.1309,stance loss: 0.80285 
Train step: 630 acc:0.64011 total_loss: 1.2818  loss:1.21,stance loss: 1.0288 
Train step: 640 acc:0.638 total_loss: 1.2821  loss:1.494,stance loss: 0.98092 
Train step: 650 acc:0.63795 total_loss: 1.2718  loss:1.385,stance loss: 1.0783 
Train step: 660 acc:0.64205 total_loss: 1.2612  loss:1.3595,stance loss: 1.049 
Train step: 670 acc:0.65029 total_loss: 1.2504  loss:1.0059,stance loss: 0.56492 
Train step: 680 acc:0.65071 total_loss: 1.2571  loss:1.7523,stance loss: 1.8104 
Train step: 690 acc:0.64901 total_loss: 1.2643  loss:1.4272,stance loss: 1.1429 
Train step: 700 acc:0.64984 total_loss: 1.261  loss:1.1732,stance loss: 0.82657 
Train step: 710 acc:0.65168 total_loss: 1.2604  loss:1.0915,stance loss: 1.2043 
Train step: 720 acc:0.65331 total_loss: 1.2534  loss:1.1594,stance loss: 0.93923 
Train step: 730 acc:0.65412 total_loss: 1.2509  loss:1.0532,stance loss: 0.78414 
Train step: 740 acc:0.65578 total_loss: 1.2444  loss:1.237,stance loss: 0.84715 
Train step: 750 acc:0.65699 total_loss: 1.243  loss:1.2056,stance loss: 1.0008 
Train step: 760 acc:0.65894 total_loss: 1.2422  loss:1.2271,stance loss: 1.3918 
Train step: 770 acc:0.65963 total_loss: 1.2361  loss:1.2225,stance loss: 0.97538 
Train step: 780 acc:0.65975 total_loss: 1.2362  loss:1.2931,stance loss: 1.2471 
Train step: 790 acc:0.65837 total_loss: 1.2388  loss:1.1264,stance loss: 0.85955 
Train step: 800 acc:0.66044 total_loss: 1.2341  loss:0.9725,stance loss: 0.74619 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.6875 total_loss: 1.1852  loss:1.1852,stance loss: 0.64994 
Train step: 820 acc:0.69886 total_loss: 1.1512  loss:1.4581,stance loss: 1.1341 
Train step: 830 acc:0.72619 total_loss: 1.0621  loss:0.85658,stance loss: 0.59026 
Train step: 840 acc:0.72177 total_loss: 1.1156  loss:1.5071,stance loss: 1.4971 
Train step: 850 acc:0.72256 total_loss: 1.0872  loss:1.2108,stance loss: 0.82816 
Train step: 860 acc:0.71814 total_loss: 1.0852  loss:0.84496,stance loss: 0.64526 
Train step: 870 acc:0.71311 total_loss: 1.0887  loss:1.5545,stance loss: 1.6814 
Train step: 880 acc:0.69894 total_loss: 1.1122  loss:1.4042,stance loss: 1.0774 
Train step: 890 acc:0.69444 total_loss: 1.1239  loss:1.4675,stance loss: 1.5543 
Train step: 900 acc:0.69162 total_loss: 1.1387  loss:1.2097,stance loss: 0.98851 
Train step: 910 acc:0.69183 total_loss: 1.1431  loss:1.4679,stance loss: 1.4264 
Train step: 920 acc:0.69032 total_loss: 1.1416  loss:1.2604,stance loss: 0.93022 
Train step: 930 acc:0.68905 total_loss: 1.1476  loss:1.3201,stance loss: 1.0757 
Train step: 940 acc:0.69084 total_loss: 1.1493  loss:1.3581,stance loss: 1.0737 
Train step: 950 acc:0.68706 total_loss: 1.1522  loss:1.0449,stance loss: 0.85947 
Train step: 960 acc:0.68833 total_loss: 1.1509  loss:1.007,stance loss: 0.81405 
Train step: 970 acc:0.68828 total_loss: 1.1543  loss:1.352,stance loss: 1.0924 
Train step: 980 acc:0.68567 total_loss: 1.1566  loss:1.8343,stance loss: 1.5374 
Train step: 990 acc:0.68405 total_loss: 1.1629  loss:1.4701,stance loss: 1.5735 
Train step: 1000 acc:0.68488 total_loss: 1.1587  loss:1.3708,stance loss: 1.46 
Train step: 1010 acc:0.68595 total_loss: 1.1549  loss:1.2724,stance loss: 1.1339 
Train step: 1020 acc:0.68572 total_loss: 1.1513  loss:1.2578,stance loss: 1.0066 
Train step: 1030 acc:0.68495 total_loss: 1.1489  loss:1.2245,stance loss: 0.87594 
Train step: 1040 acc:0.68398 total_loss: 1.1454  loss:0.96636,stance loss: 0.72421 
Train step: 1050 acc:0.68257 total_loss: 1.1449  loss:1.3283,stance loss: 1.0224 
Train step: 1060 acc:0.68401 total_loss: 1.1435  loss:0.79397,stance loss: 0.60884 
Train step: 1070 acc:0.68295 total_loss: 1.146  loss:1.6115,stance loss: 1.3187 
Better F1! Saving model!
Saving model of best f1: 0.061490273656445764
              precision    recall  f1-score   support

           0   0.059659  0.807692  0.111111        26
           1   0.795238  0.822660  0.808717       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.336879       564
   macro avg   0.618299  0.545441  0.310566       564
weighted avg   0.882951  0.336879  0.303253       564

Test Acc: 0.33687943262411346 F1_ma:0.061490273656445764
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.8125 total_loss: 0.93508  loss:0.93508,stance loss: 0.71743 
Train step: 1090 acc:0.75568 total_loss: 0.99331  loss:1.4144,stance loss: 1.089 
Train step: 1100 acc:0.74702 total_loss: 1.0334  loss:0.86091,stance loss: 0.63506 
Train step: 1110 acc:0.73992 total_loss: 1.0429  loss:1.1665,stance loss: 0.92845 
Train step: 1120 acc:0.72866 total_loss: 1.0826  loss:1.1361,stance loss: 0.78298 
Train step: 1130 acc:0.72181 total_loss: 1.0865  loss:1.0983,stance loss: 0.83715 
Train step: 1140 acc:0.71516 total_loss: 1.0766  loss:0.8195,stance loss: 0.6479 
Train step: 1150 acc:0.71303 total_loss: 1.087  loss:1.2192,stance loss: 0.87219 
Better F1! Saving model!
Saving model of best f1: 0.06971630177371804
              precision    recall  f1-score   support

           0   0.059347  0.769231  0.110193        26
           1   0.772727  0.837438  0.803783       203
           2   0.714286  0.014925  0.029240       335

    accuracy                       0.345745       564
   macro avg   0.515453  0.540532  0.314405       564
weighted avg   0.705128  0.345745  0.311752       564

Test Acc: 0.34574468085106386 F1_ma:0.06971630177371804
Train step: 1160 acc:0.71451 total_loss: 1.0831  loss:0.84672,stance loss: 0.70494 
Train step: 1170 acc:0.71085 total_loss: 1.0875  loss:1.4231,stance loss: 1.0696 
Train step: 1180 acc:0.70545 total_loss: 1.084  loss:0.98902,stance loss: 0.71647 
Train step: 1190 acc:0.71284 total_loss: 1.088  loss:0.89745,stance loss: 0.6019 
Train step: 1200 acc:0.71488 total_loss: 1.0789  loss:1.0293,stance loss: 0.72199 
Train step: 1210 acc:0.71279 total_loss: 1.092  loss:1.2134,stance loss: 0.89341 
Train step: 1220 acc:0.71321 total_loss: 1.0885  loss:0.82301,stance loss: 0.67959 
Train step: 1230 acc:0.71068 total_loss: 1.0905  loss:1.0526,stance loss: 0.67386 
Train step: 1240 acc:0.70963 total_loss: 1.0942  loss:1.1014,stance loss: 0.80771 
Train step: 1250 acc:0.71053 total_loss: 1.0906  loss:1.6184,stance loss: 1.3489 
Train step: 1260 acc:0.71271 total_loss: 1.0872  loss:0.90265,stance loss: 0.67845 
Train step: 1270 acc:0.71106 total_loss: 1.091  loss:0.90996,stance loss: 0.67947 
Train step: 1280 acc:0.7102 total_loss: 1.094  loss:0.91089,stance loss: 0.83786 
Train step: 1290 acc:0.70853 total_loss: 1.0967  loss:1.1527,stance loss: 0.85028 
Train step: 1300 acc:0.70956 total_loss: 1.0922  loss:1.5294,stance loss: 1.6223 
Train step: 1310 acc:0.71212 total_loss: 1.0912  loss:1.0696,stance loss: 0.75286 
Train step: 1320 acc:0.71343 total_loss: 1.0893  loss:0.87097,stance loss: 0.63762 
Train step: 1330 acc:0.71365 total_loss: 1.087  loss:1.0093,stance loss: 0.79706 
Train step: 1340 acc:0.7148 total_loss: 1.0908  loss:1.4708,stance loss: 1.6083 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.625 total_loss: 1.6347  loss:1.6347,stance loss: 1.8141 
Train step: 1360 acc:0.76136 total_loss: 1.0559  loss:0.87158,stance loss: 0.67583 
Train step: 1370 acc:0.7381 total_loss: 1.0666  loss:1.1152,stance loss: 0.83639 
Better F1! Saving model!
Saving model of best f1: 0.20938609076493245
              precision    recall  f1-score   support

           0   0.060606  0.692308  0.111455        26
           1   0.796875  0.753695  0.774684       203
           2   0.840000  0.188060  0.307317       335

    accuracy                       0.414894       564
   macro avg   0.565827  0.544687  0.397819       564
weighted avg   0.788549  0.414894  0.466507       564

Test Acc: 0.4148936170212766 F1_ma:0.20938609076493245
Train step: 1380 acc:0.72581 total_loss: 1.0344  loss:0.69259,stance loss: 0.51388 
Train step: 1390 acc:0.74238 total_loss: 0.98331  loss:0.70811,stance loss: 0.2822 
Train step: 1400 acc:0.72426 total_loss: 1.0201  loss:0.78932,stance loss: 0.59866 
Train step: 1410 acc:0.72848 total_loss: 1.0122  loss:0.8235,stance loss: 0.8022 
Train step: 1420 acc:0.73063 total_loss: 1.0041  loss:0.91252,stance loss: 0.65537 
Train step: 1430 acc:0.73071 total_loss: 0.99705  loss:0.87508,stance loss: 0.83512 
Train step: 1440 acc:0.73558 total_loss: 0.9877  loss:1.0081,stance loss: 1.2008 
Train step: 1450 acc:0.73886 total_loss: 0.97426  loss:1.0609,stance loss: 0.80861 
Train step: 1460 acc:0.74099 total_loss: 0.97486  loss:1.2488,stance loss: 1.2246 
Train step: 1470 acc:0.74277 total_loss: 0.9693  loss:0.38625,stance loss: 0.19872 
Train step: 1480 acc:0.74475 total_loss: 0.9733  loss:0.82747,stance loss: 0.6978 
Train step: 1490 acc:0.74113 total_loss: 0.98307  loss:1.1563,stance loss: 0.84106 
Train step: 1500 acc:0.73758 total_loss: 0.99305  loss:0.72757,stance loss: 0.56113 
Train step: 1510 acc:0.73719 total_loss: 0.99175  loss:1.4748,stance loss: 1.5005 
Train step: 1520 acc:0.7383 total_loss: 0.99107  loss:0.92685,stance loss: 0.7013 
Train step: 1530 acc:0.7393 total_loss: 0.98791  loss:0.6088,stance loss: 0.47083 
Train step: 1540 acc:0.74215 total_loss: 0.98646  loss:1.1259,stance loss: 1.4209 
Train step: 1550 acc:0.74316 total_loss: 0.98758  loss:0.7455,stance loss: 0.50834 
Train step: 1560 acc:0.74082 total_loss: 0.99401  loss:0.92536,stance loss: 0.74774 
Train step: 1570 acc:0.73925 total_loss: 0.99868  loss:1.1496,stance loss: 0.87332 
Train step: 1580 acc:0.73891 total_loss: 0.99717  loss:0.5144,stance loss: 0.3463 
Train step: 1590 acc:0.7404 total_loss: 0.99239  loss:0.78563,stance loss: 0.70032 
Train step: 1600 acc:0.74153 total_loss: 0.99253  loss:1.081,stance loss: 1.3577 
Train step: 1610 acc:0.74306 total_loss: 0.986  loss:0.48017,stance loss: 0.31007 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.8125 total_loss: 1.373  loss:1.373,stance loss: 1.7495 
Train step: 1630 acc:0.75 total_loss: 0.87208  loss:0.68356,stance loss: 0.48888 
Train step: 1640 acc:0.77976 total_loss: 0.84168  loss:0.46582,stance loss: 0.33387 
Train step: 1650 acc:0.78629 total_loss: 0.86582  loss:0.74243,stance loss: 0.60845 
Train step: 1660 acc:0.78811 total_loss: 0.87304  loss:1.0746,stance loss: 0.91813 
Train step: 1670 acc:0.77819 total_loss: 0.88664  loss:0.63699,stance loss: 0.48414 
Train step: 1680 acc:0.77561 total_loss: 0.88168  loss:0.87393,stance loss: 0.66398 
Train step: 1690 acc:0.77817 total_loss: 0.87395  loss:0.88498,stance loss: 0.78995 
Train step: 1700 acc:0.77701 total_loss: 0.8754  loss:0.79744,stance loss: 0.70474 
Train step: 1710 acc:0.77885 total_loss: 0.87393  loss:0.74035,stance loss: 0.66132 
Train step: 1720 acc:0.7828 total_loss: 0.88093  loss:1.5956,stance loss: 1.6974 
Train step: 1730 acc:0.78209 total_loss: 0.88247  loss:0.91548,stance loss: 0.68947 
Train step: 1740 acc:0.78202 total_loss: 0.89114  loss:1.258,stance loss: 1.5513 
Train step: 1750 acc:0.78292 total_loss: 0.88921  loss:0.9801,stance loss: 1.2076 
Train step: 1760 acc:0.7828 total_loss: 0.89321  loss:1.3992,stance loss: 1.573 
Train step: 1770 acc:0.7856 total_loss: 0.88908  loss:1.0154,stance loss: 0.88124 
Train step: 1780 acc:0.78882 total_loss: 0.88346  loss:1.286,stance loss: 1.4136 
Train step: 1790 acc:0.78765 total_loss: 0.88396  loss:0.75379,stance loss: 0.54375 
Train step: 1800 acc:0.78798 total_loss: 0.88344  loss:0.936,stance loss: 0.78753 
Train step: 1810 acc:0.7873 total_loss: 0.88119  loss:0.8126,stance loss: 0.63532 
Train step: 1820 acc:0.78887 total_loss: 0.87479  loss:0.42286,stance loss: 0.29208 
Better F1! Saving model!
Saving model of best f1: 0.2097530864197531
              precision    recall  f1-score   support

           0   0.062044  0.653846  0.113333        26
           1   0.759091  0.822660  0.789598       203
           2   0.885714  0.185075  0.306173       335

    accuracy                       0.436170       564
   macro avg   0.568950  0.553860  0.403035       564
weighted avg   0.802168  0.436170  0.471282       564

Test Acc: 0.43617021276595747 F1_ma:0.2097530864197531
Train step: 1830 acc:0.78821 total_loss: 0.87749  loss:0.69545,stance loss: 0.4928 
Train step: 1840 acc:0.78761 total_loss: 0.87827  loss:0.5519,stance loss: 0.45453 
Train step: 1850 acc:0.78544 total_loss: 0.87598  loss:1.0154,stance loss: 0.80104 
Better F1! Saving model!
Saving model of best f1: 0.23331898407232027
              precision    recall  f1-score   support

           0   0.064982  0.692308  0.118812        26
           1   0.778846  0.798030  0.788321       203
           2   0.911392  0.214925  0.347826       335

    accuracy                       0.446809       564
   macro avg   0.585074  0.568421  0.418320       564
weighted avg   0.824666  0.446809  0.495816       564

Test Acc: 0.44680851063829785 F1_ma:0.23331898407232027
Train step: 1860 acc:0.78423 total_loss: 0.87569  loss:0.62345,stance loss: 0.44333 
Train step: 1870 acc:0.78262 total_loss: 0.87678  loss:0.88306,stance loss: 0.71768 
Train step: 1880 acc:0.78209 total_loss: 0.87604  loss:1.0215,stance loss: 0.95977 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.8125 total_loss: 0.70602  loss:0.70602,stance loss: 0.56742 
Train step: 1900 acc:0.83523 total_loss: 0.81437  loss:0.41682,stance loss: 0.30599 
Train step: 1910 acc:0.82143 total_loss: 0.79377  loss:0.65097,stance loss: 0.48332 
Train step: 1920 acc:0.80645 total_loss: 0.80109  loss:0.63987,stance loss: 0.52209 
Train step: 1930 acc:0.78811 total_loss: 0.83089  loss:0.60029,stance loss: 0.4368 
Train step: 1940 acc:0.80147 total_loss: 0.81561  loss:1.2924,stance loss: 0.97137 
Train step: 1950 acc:0.81455 total_loss: 0.79326  loss:0.79377,stance loss: 0.57106 
Train step: 1960 acc:0.8169 total_loss: 0.79026  loss:0.85116,stance loss: 1.0786 
Train step: 1970 acc:0.82022 total_loss: 0.78925  loss:0.75661,stance loss: 0.57347 
Train step: 1980 acc:0.81799 total_loss: 0.7898  loss:0.67089,stance loss: 0.47587 
Train step: 1990 acc:0.81498 total_loss: 0.80121  loss:0.61529,stance loss: 0.6148 
Train step: 2000 acc:0.81926 total_loss: 0.79717  loss:0.619,stance loss: 0.52347 
Train step: 2010 acc:0.82231 total_loss: 0.80325  loss:0.46227,stance loss: 0.32721 
Train step: 2020 acc:0.81727 total_loss: 0.81197  loss:0.89349,stance loss: 0.73713 
Train step: 2030 acc:0.81871 total_loss: 0.80333  loss:0.82089,stance loss: 0.56799 
Train step: 2040 acc:0.81705 total_loss: 0.80791  loss:1.1665,stance loss: 0.81335 
Train step: 2050 acc:0.81638 total_loss: 0.80378  loss:0.57465,stance loss: 0.49553 
Train step: 2060 acc:0.81433 total_loss: 0.81545  loss:1.1702,stance loss: 0.76572 
Train step: 2070 acc:0.81354 total_loss: 0.81245  loss:1.0248,stance loss: 0.84962 
Train step: 2080 acc:0.81217 total_loss: 0.80924  loss:1.014,stance loss: 0.85193 
Train step: 2090 acc:0.81157 total_loss: 0.813  loss:1.0506,stance loss: 1.1095 
Train step: 2100 acc:0.81072 total_loss: 0.81598  loss:0.5589,stance loss: 0.3587 
Train step: 2110 acc:0.80995 total_loss: 0.81457  loss:1.3552,stance loss: 1.1199 
Train step: 2120 acc:0.80925 total_loss: 0.82127  loss:0.60957,stance loss: 0.45067 
Train step: 2130 acc:0.81068 total_loss: 0.8203  loss:0.71693,stance loss: 0.62521 
Better F1! Saving model!
Saving model of best f1: 0.2505057551447506
              precision    recall  f1-score   support

           0   0.064516  0.692308  0.118033        26
           1   0.781726  0.758621  0.770000       203
           2   0.920455  0.241791  0.382979       335

    accuracy                       0.448582       564
   macro avg   0.588899  0.564240  0.423671       564
weighted avg   0.831064  0.448582  0.510065       564

Test Acc: 0.44858156028368795 F1_ma:0.2505057551447506
Train step: 2140 acc:0.81001 total_loss: 0.81964  loss:0.76305,stance loss: 0.62576 
Train step: 2150 acc:0.80963 total_loss: 0.82396  loss:1.182,stance loss: 1.5158 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.875 total_loss: 0.5961  loss:0.5961,stance loss: 0.51441 
Train step: 2170 acc:0.84091 total_loss: 0.64222  loss:0.68644,stance loss: 0.57864 
Train step: 2180 acc:0.84226 total_loss: 0.65437  loss:0.77558,stance loss: 0.5905 
Train step: 2190 acc:0.83266 total_loss: 0.69309  loss:0.82351,stance loss: 0.60399 
Train step: 2200 acc:0.82622 total_loss: 0.72331  loss:1.1672,stance loss: 0.59733 
Train step: 2210 acc:0.83333 total_loss: 0.72708  loss:0.98885,stance loss: 1.1466 
Train step: 2220 acc:0.83299 total_loss: 0.71928  loss:0.46066,stance loss: 0.39018 
Train step: 2230 acc:0.83011 total_loss: 0.72634  loss:1.2065,stance loss: 1.106 
Train step: 2240 acc:0.83565 total_loss: 0.71934  loss:0.36746,stance loss: 0.342 
Train step: 2250 acc:0.83036 total_loss: 0.73088  loss:0.32357,stance loss: 0.055777 
Train step: 2260 acc:0.83478 total_loss: 0.72197  loss:0.68103,stance loss: 0.54663 
Train step: 2270 acc:0.83164 total_loss: 0.72925  loss:1.7175,stance loss: 1.6084 
Train step: 2280 acc:0.83161 total_loss: 0.72438  loss:0.48295,stance loss: 0.31461 
Better F1! Saving model!
Saving model of best f1: 0.2956410869391983
              precision    recall  f1-score   support

           0   0.078125  0.769231  0.141844        26
           1   0.792929  0.773399  0.783042       203
           2   0.909091  0.298507  0.449438       335

    accuracy                       0.491135       564
   macro avg   0.593382  0.613712  0.458108       564
weighted avg   0.828974  0.491135  0.555332       564

Test Acc: 0.49113475177304966 F1_ma:0.2956410869391983
Train step: 2290 acc:0.83254 total_loss: 0.71716  loss:1.0835,stance loss: 1.489 
Train step: 2300 acc:0.83156 total_loss: 0.70851  loss:1.0098,stance loss: 0.85334 
Train step: 2310 acc:0.82988 total_loss: 0.70929  loss:0.39727,stance loss: 0.31953 
Train step: 2320 acc:0.83113 total_loss: 0.70844  loss:0.54195,stance loss: 0.46035 
Train step: 2330 acc:0.82895 total_loss: 0.71205  loss:0.80105,stance loss: 0.56018 
Train step: 2340 acc:0.8308 total_loss: 0.70945  loss:0.7833,stance loss: 1.0932 
Train step: 2350 acc:0.83442 total_loss: 0.69944  loss:0.63403,stance loss: 0.40703 
Train step: 2360 acc:0.83458 total_loss: 0.69817  loss:0.82211,stance loss: 0.57737 
Train step: 2370 acc:0.83442 total_loss: 0.69856  loss:0.97005,stance loss: 1.0686 
Train step: 2380 acc:0.83682 total_loss: 0.69804  loss:0.66724,stance loss: 0.5474 
Train step: 2390 acc:0.8355 total_loss: 0.70646  loss:1.093,stance loss: 0.76562 
Train step: 2400 acc:0.8348 total_loss: 0.71012  loss:0.65416,stance loss: 1.0407 
Train step: 2410 acc:0.83566 total_loss: 0.71222  loss:0.97727,stance loss: 1.2758 
Train step: 2420 acc:0.83525 total_loss: 0.71265  loss:0.3352,stance loss: 0.26259 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.875 total_loss: 0.40257  loss:0.40257,stance loss: 0.30107 
Train step: 2440 acc:0.875 total_loss: 0.61734  loss:0.85747,stance loss: 0.70323 
Train step: 2450 acc:0.8631 total_loss: 0.63475  loss:0.39996,stance loss: 0.178 
Train step: 2460 acc:0.87702 total_loss: 0.59037  loss:0.4508,stance loss: 0.35183 
Train step: 2470 acc:0.87805 total_loss: 0.59033  loss:0.87022,stance loss: 1.0849 
Train step: 2480 acc:0.8799 total_loss: 0.57301  loss:0.28879,stance loss: 0.25196 
Train step: 2490 acc:0.87807 total_loss: 0.57587  loss:0.64575,stance loss: 0.33766 
Train step: 2500 acc:0.87236 total_loss: 0.59344  loss:0.64715,stance loss: 0.52683 
Train step: 2510 acc:0.87191 total_loss: 0.585  loss:0.58194,stance loss: 0.37132 
Train step: 2520 acc:0.87225 total_loss: 0.60244  loss:0.35727,stance loss: 0.26314 
Train step: 2530 acc:0.86634 total_loss: 0.59975  loss:0.29559,stance loss: 0.191 
Train step: 2540 acc:0.86937 total_loss: 0.59327  loss:0.14975,stance loss: 0.010154 
Train step: 2550 acc:0.86932 total_loss: 0.60298  loss:0.75177,stance loss: 0.59545 
Train step: 2560 acc:0.87166 total_loss: 0.60107  loss:0.65051,stance loss: 0.61939 
Train step: 2570 acc:0.87057 total_loss: 0.6001  loss:0.45024,stance loss: 0.32593 
Train step: 2580 acc:0.86879 total_loss: 0.60206  loss:0.47215,stance loss: 0.32316 
Train step: 2590 acc:0.86879 total_loss: 0.60544  loss:0.44391,stance loss: 0.30759 
Train step: 2600 acc:0.86952 total_loss: 0.60952  loss:0.43766,stance loss: 0.39548 
Train step: 2610 acc:0.86706 total_loss: 0.61617  loss:0.8532,stance loss: 0.55147 
Train step: 2620 acc:0.87009 total_loss: 0.60661  loss:0.78993,stance loss: 0.65493 
Train step: 2630 acc:0.87065 total_loss: 0.60236  loss:0.29603,stance loss: 0.14172 
Train step: 2640 acc:0.87085 total_loss: 0.61024  loss:0.14151,stance loss: 0.041634 
Train step: 2650 acc:0.86963 total_loss: 0.61292  loss:0.78454,stance loss: 0.75221 
Train step: 2660 acc:0.86932 total_loss: 0.61037  loss:0.53011,stance loss: 0.44324 
Train step: 2670 acc:0.868 total_loss: 0.61374  loss:0.72011,stance loss: 0.62724 
Better F1! Saving model!
Saving model of best f1: 0.3144373260855497
              precision    recall  f1-score   support

           0   0.079422  0.846154  0.145215        26
           1   0.815951  0.655172  0.726776       203
           2   0.895161  0.331343  0.483660       335

    accuracy                       0.471631       564
   macro avg   0.596845  0.610890  0.451884       564
weighted avg   0.829046  0.471631  0.555562       564

Test Acc: 0.4716312056737589 F1_ma:0.3144373260855497
Train step: 2680 acc:0.86728 total_loss: 0.61405  loss:0.37977,stance loss: 0.30053 
Train step: 2690 acc:0.86494 total_loss: 0.61693  loss:1.1188,stance loss: 0.78811 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.8125 total_loss: 0.97527  loss:0.97527,stance loss: 0.90682 
Train step: 2710 acc:0.86364 total_loss: 0.78901  loss:0.9581,stance loss: 1.0799 
Train step: 2720 acc:0.8869 total_loss: 0.62695  loss:0.071079,stance loss: 0.0097313 
Train step: 2730 acc:0.88508 total_loss: 0.60818  loss:0.52678,stance loss: 0.42447 
Train step: 2740 acc:0.88415 total_loss: 0.56376  loss:0.68545,stance loss: 0.52303 
Train step: 2750 acc:0.88358 total_loss: 0.57183  loss:0.71923,stance loss: 0.73218 
Train step: 2760 acc:0.88012 total_loss: 0.58304  loss:0.59097,stance loss: 1.0127 
Train step: 2770 acc:0.88644 total_loss: 0.57372  loss:0.7042,stance loss: 1.0504 
Train step: 2780 acc:0.89043 total_loss: 0.57373  loss:0.85356,stance loss: 0.61707 
Train step: 2790 acc:0.89492 total_loss: 0.55893  loss:0.33482,stance loss: 0.20778 
Train step: 2800 acc:0.89356 total_loss: 0.56247  loss:0.93154,stance loss: 0.80794 
Train step: 2810 acc:0.89302 total_loss: 0.56641  loss:1.0558,stance loss: 1.3359 
Train step: 2820 acc:0.88998 total_loss: 0.5678  loss:1.0347,stance loss: 0.93414 
Train step: 2830 acc:0.89027 total_loss: 0.56972  loss:0.097879,stance loss: 0.04608 
Train step: 2840 acc:0.89362 total_loss: 0.56612  loss:0.44454,stance loss: 0.3794 
Train step: 2850 acc:0.89487 total_loss: 0.56265  loss:0.94127,stance loss: 1.0786 
Train step: 2860 acc:0.8948 total_loss: 0.56153  loss:0.54641,stance loss: 0.41659 
Train step: 2870 acc:0.89656 total_loss: 0.55478  loss:0.1855,stance loss: 0.0059728 
Train step: 2880 acc:0.89641 total_loss: 0.55354  loss:0.31717,stance loss: 0.25621 
Train step: 2890 acc:0.89627 total_loss: 0.55541  loss:0.40855,stance loss: 0.41781 
Train step: 2900 acc:0.89552 total_loss: 0.54931  loss:0.52477,stance loss: 0.39567 
Train step: 2910 acc:0.89396 total_loss: 0.55054  loss:1.1374,stance loss: 0.99457 
Train step: 2920 acc:0.89536 total_loss: 0.54539  loss:0.22856,stance loss: 0.24793 
Train step: 2930 acc:0.89394 total_loss: 0.54594  loss:0.39336,stance loss: 0.27576 
Train step: 2940 acc:0.89315 total_loss: 0.54858  loss:0.17163,stance loss: 0.097166 
Train step: 2950 acc:0.89318 total_loss: 0.54415  loss:0.29486,stance loss: 0.32641 
Train step: 2960 acc:0.89248 total_loss: 0.54585  loss:0.36628,stance loss: 0.30349 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.9375 total_loss: 0.80672  loss:0.80672,stance loss: 1.2244 
Train step: 2980 acc:0.94318 total_loss: 0.48615  loss:0.45377,stance loss: 0.35202 
Train step: 2990 acc:0.91071 total_loss: 0.45349  loss:0.1957,stance loss: 0.0014066 
Train step: 3000 acc:0.90121 total_loss: 0.51399  loss:0.68896,stance loss: 0.67958 
Train step: 3010 acc:0.90396 total_loss: 0.51618  loss:0.12374,stance loss: 0.052621 
Train step: 3020 acc:0.90931 total_loss: 0.49801  loss:0.43346,stance loss: 0.36585 
Train step: 3030 acc:0.91086 total_loss: 0.49719  loss:0.19681,stance loss: 0.1156 
Train step: 3040 acc:0.90933 total_loss: 0.49172  loss:0.33504,stance loss: 0.12958 
Train step: 3050 acc:0.91512 total_loss: 0.48436  loss:0.12875,stance loss: 0.053669 
Train step: 3060 acc:0.91484 total_loss: 0.47846  loss:0.30787,stance loss: 0.2262 
Train step: 3070 acc:0.91894 total_loss: 0.46699  loss:0.042563,stance loss: 0.0012327 
Train step: 3080 acc:0.91836 total_loss: 0.4756  loss:0.86473,stance loss: 0.61709 
Train step: 3090 acc:0.91684 total_loss: 0.47035  loss:0.22428,stance loss: 0.086104 
Train step: 3100 acc:0.91698 total_loss: 0.46891  loss:0.40187,stance loss: 0.41182 
Train step: 3110 acc:0.91933 total_loss: 0.46471  loss:0.13021,stance loss: 0.038688 
Train step: 3120 acc:0.91929 total_loss: 0.47533  loss:0.60198,stance loss: 0.68541 
Train step: 3130 acc:0.91848 total_loss: 0.47444  loss:0.38215,stance loss: 0.34784 
Train step: 3140 acc:0.92032 total_loss: 0.47348  loss:0.70398,stance loss: 1.0698 
Train step: 3150 acc:0.9192 total_loss: 0.47158  loss:0.49663,stance loss: 0.4101 
Train step: 3160 acc:0.91852 total_loss: 0.46886  loss:0.71847,stance loss: 0.53535 
Train step: 3170 acc:0.91853 total_loss: 0.47308  loss:0.40176,stance loss: 0.35955 
Train step: 3180 acc:0.91558 total_loss: 0.47857  loss:0.37482,stance loss: 0.32559 
Train step: 3190 acc:0.91488 total_loss: 0.48405  loss:0.72563,stance loss: 1.1152 
Train step: 3200 acc:0.91585 total_loss: 0.47889  loss:0.44951,stance loss: 0.34881 
Train step: 3210 acc:0.91468 total_loss: 0.47806  loss:0.30517,stance loss: 0.19537 
Train step: 3220 acc:0.9136 total_loss: 0.48513  loss:0.41262,stance loss: 0.33755 
Train step: 3230 acc:0.91284 total_loss: 0.48764  loss:0.75564,stance loss: 1.197 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.32241  loss:0.32241,stance loss: 0.28335 
Train step: 3250 acc:0.95455 total_loss: 0.25988  loss:0.37909,stance loss: 0.40032 
Train step: 3260 acc:0.93452 total_loss: 0.32659  loss:0.56277,stance loss: 0.49839 
Train step: 3270 acc:0.93145 total_loss: 0.34201  loss:0.56582,stance loss: 1.0085 
Train step: 3280 acc:0.93598 total_loss: 0.33312  loss:0.12658,stance loss: 0.070556 
Train step: 3290 acc:0.94118 total_loss: 0.31711  loss:0.28137,stance loss: 0.21814 
Train step: 3300 acc:0.9375 total_loss: 0.34001  loss:1.0344,stance loss: 0.90664 
Train step: 3310 acc:0.93662 total_loss: 0.3404  loss:0.28706,stance loss: 0.21683 
Train step: 3320 acc:0.93441 total_loss: 0.33986  loss:0.4277,stance loss: 0.38322 
Train step: 3330 acc:0.93544 total_loss: 0.33363  loss:0.40003,stance loss: 0.35953 
Train step: 3340 acc:0.93193 total_loss: 0.35846  loss:0.4526,stance loss: 0.36914 
Train step: 3350 acc:0.933 total_loss: 0.35695  loss:0.59884,stance loss: 1.0199 
Train step: 3360 acc:0.93337 total_loss: 0.37135  loss:0.28366,stance loss: 0.15782 
Train step: 3370 acc:0.93273 total_loss: 0.37243  loss:0.25556,stance loss: 0.13577 
Train step: 3380 acc:0.93262 total_loss: 0.38911  loss:0.18304,stance loss: 0.12193 
Train step: 3390 acc:0.93419 total_loss: 0.38407  loss:0.19127,stance loss: 0.079844 
Train step: 3400 acc:0.93323 total_loss: 0.38874  loss:0.36597,stance loss: 0.37069 
Train step: 3410 acc:0.93238 total_loss: 0.39242  loss:0.55075,stance loss: 0.38965 
Train step: 3420 acc:0.93094 total_loss: 0.40054  loss:1.0463,stance loss: 1.2887 
Train step: 3430 acc:0.93096 total_loss: 0.3993  loss:0.060851,stance loss: 0.024479 
Train step: 3440 acc:0.92973 total_loss: 0.40632  loss:0.21362,stance loss: 0.25644 
Train step: 3450 acc:0.93009 total_loss: 0.4094  loss:0.31524,stance loss: 0.1935 
Train step: 3460 acc:0.9293 total_loss: 0.41074  loss:0.6695,stance loss: 1.0726 
Train step: 3470 acc:0.92911 total_loss: 0.41295  loss:0.7554,stance loss: 1.2482 
Train step: 3480 acc:0.92894 total_loss: 0.41487  loss:0.17023,stance loss: 0.14476 
Train step: 3490 acc:0.92953 total_loss: 0.41449  loss:0.18163,stance loss: 0.16201 
Train step: 3500 acc:0.92936 total_loss: 0.41439  loss:0.40808,stance loss: 0.30243 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.8125 total_loss: 0.50966  loss:0.50966,stance loss: 0.5141 
Train step: 3520 acc:0.88068 total_loss: 0.44222  loss:0.52311,stance loss: 0.37565 
Train step: 3530 acc:0.91964 total_loss: 0.36461  loss:0.23753,stance loss: 0.17318 
Train step: 3540 acc:0.9375 total_loss: 0.34354  loss:0.30154,stance loss: 0.28063 
Train step: 3550 acc:0.92835 total_loss: 0.38567  loss:0.38282,stance loss: 0.30612 
Train step: 3560 acc:0.93015 total_loss: 0.39293  loss:0.65132,stance loss: 1.0366 
Train step: 3570 acc:0.9334 total_loss: 0.38993  loss:0.47112,stance loss: 0.41027 
Train step: 3580 acc:0.93662 total_loss: 0.38094  loss:0.2892,stance loss: 0.23589 
Train step: 3590 acc:0.9375 total_loss: 0.36673  loss:0.40123,stance loss: 0.36789 
Train step: 3600 acc:0.93956 total_loss: 0.35475  loss:0.21064,stance loss: 0.14442 
Train step: 3610 acc:0.94059 total_loss: 0.3468  loss:0.13405,stance loss: 0.021605 
Train step: 3620 acc:0.942 total_loss: 0.33674  loss:0.2039,stance loss: 0.20107 
Train step: 3630 acc:0.94215 total_loss: 0.32728  loss:0.15494,stance loss: 0.12979 
Train step: 3640 acc:0.9437 total_loss: 0.32705  loss:0.18644,stance loss: 0.14102 
Train step: 3650 acc:0.94371 total_loss: 0.33261  loss:0.032945,stance loss: 0.0019537 
Train step: 3660 acc:0.94288 total_loss: 0.33925  loss:0.99791,stance loss: 1.172 
Train step: 3670 acc:0.94255 total_loss: 0.33868  loss:0.18454,stance loss: 0.14493 
Train step: 3680 acc:0.94189 total_loss: 0.34009  loss:0.26586,stance loss: 0.22409 
Train step: 3690 acc:0.94061 total_loss: 0.33865  loss:0.14083,stance loss: 0.12013 
Train step: 3700 acc:0.93881 total_loss: 0.34981  loss:0.45137,stance loss: 0.24657 
Train step: 3710 acc:0.93968 total_loss: 0.34463  loss:0.091375,stance loss: 0.072021 
Train step: 3720 acc:0.93868 total_loss: 0.34826  loss:0.86571,stance loss: 0.93452 
Train step: 3730 acc:0.93863 total_loss: 0.34476  loss:0.31315,stance loss: 0.26888 
Train step: 3740 acc:0.93939 total_loss: 0.34506  loss:0.028171,stance loss: 0.0037814 
Train step: 3750 acc:0.94113 total_loss: 0.34271  loss:0.54404,stance loss: 1.0094 
Train step: 3760 acc:0.94099 total_loss: 0.33861  loss:0.089266,stance loss: 0.0011061 
Train step: 3770 acc:0.94205 total_loss: 0.33591  loss:0.18457,stance loss: 0.16334 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:1.0 total_loss: 0.19972  loss:0.19972,stance loss: 0.15481 
Train step: 3790 acc:0.96023 total_loss: 0.38829  loss:0.73637,stance loss: 1.149 
Train step: 3800 acc:0.95833 total_loss: 0.3135  loss:0.09761,stance loss: 0.046159 
Train step: 3810 acc:0.95565 total_loss: 0.28539  loss:0.35417,stance loss: 0.29973 
Train step: 3820 acc:0.95732 total_loss: 0.27049  loss:0.38984,stance loss: 0.24255 
Train step: 3830 acc:0.95466 total_loss: 0.29602  loss:0.67399,stance loss: 0.55803 
Train step: 3840 acc:0.95492 total_loss: 0.28674  loss:0.38777,stance loss: 0.45267 
Train step: 3850 acc:0.95511 total_loss: 0.28992  loss:0.24978,stance loss: 0.22329 
Train step: 3860 acc:0.95525 total_loss: 0.29098  loss:0.063146,stance loss: 0.006152 
Train step: 3870 acc:0.95879 total_loss: 0.28632  loss:0.55299,stance loss: 1.0095 
Train step: 3880 acc:0.95606 total_loss: 0.29606  loss:0.16459,stance loss: 0.068637 
Train step: 3890 acc:0.95552 total_loss: 0.29803  loss:0.2367,stance loss: 0.18637 
Train step: 3900 acc:0.95558 total_loss: 0.30903  loss:0.047838,stance loss: 0.012841 
Train step: 3910 acc:0.9542 total_loss: 0.30439  loss:0.21367,stance loss: 0.20483 
Train step: 3920 acc:0.95434 total_loss: 0.30739  loss:0.097721,stance loss: 0.096274 
Train step: 3930 acc:0.95406 total_loss: 0.31667  loss:0.50325,stance loss: 0.50015 
Train step: 3940 acc:0.95691 total_loss: 0.30815  loss:0.065133,stance loss: 0.033839 
Train step: 3950 acc:0.95614 total_loss: 0.30792  loss:0.28095,stance loss: 0.28224 
Train step: 3960 acc:0.9558 total_loss: 0.30567  loss:0.45507,stance loss: 0.34937 
Train step: 3970 acc:0.95713 total_loss: 0.30678  loss:0.57245,stance loss: 1.0308 
Train step: 3980 acc:0.95709 total_loss: 0.31464  loss:0.28354,stance loss: 0.26685 
Train step: 3990 acc:0.95675 total_loss: 0.31317  loss:0.17766,stance loss: 0.15679 
Train step: 4000 acc:0.9556 total_loss: 0.31743  loss:0.40103,stance loss: 0.33855 
Train step: 4010 acc:0.95563 total_loss: 0.31952  loss:0.70362,stance loss: 0.70273 
Train step: 4020 acc:0.95539 total_loss: 0.322  loss:0.84137,stance loss: 0.54746 
Train step: 4030 acc:0.95543 total_loss: 0.31759  loss:0.32941,stance loss: 0.28357 
Train step: 4040 acc:0.95594 total_loss: 0.31451  loss:0.16198,stance loss: 0.13081 
Training finished.


Reload the best model with best f1 0.3144373260855497 from path test_outputs/bert-cross-topic/cc/2023-08-14 15-26-59/state_dict


              precision    recall  f1-score   support

           0   0.079422  0.846154  0.145215        26
           1   0.815951  0.655172  0.726776       203
           2   0.895161  0.331343  0.483660       335

    accuracy                       0.471631       564
   macro avg   0.596845  0.610890  0.451884       564
weighted avg   0.829046  0.471631  0.555562       564

Test Acc: 0.4716312056737589 F1_ma:0.3144373260855497
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.3144373260855497
acc: 0.4716312056737589, f1 :0.4518835361517508
classification report: 
              precision    recall  f1-score   support

         Con     0.0794    0.8462    0.1452        26
        None     0.8160    0.6552    0.7268       203
         Pro     0.8952    0.3313    0.4837       335

    accuracy                         0.4716       564
   macro avg     0.5968    0.6109    0.4519       564
weighted avg     0.8290    0.4716    0.5556       564

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 15-44-09', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 15-44-09
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.7757  loss:1.7757,stance loss: 1.2326 
Train step: 10 acc:0.32386 total_loss: 1.7375  loss:1.6978,stance loss: 1.1171 
Better F1! Saving model!
Saving model of best f1: 0.44556145131220415
              precision    recall  f1-score   support

           0   0.042683  0.269231  0.073684        26
           1   1.000000  0.004926  0.009804       203
           2   0.751880  0.895522  0.817439       335

    accuracy                       0.546099       564
   macro avg   0.598188  0.389893  0.300309       564
weighted avg   0.808492  0.546099  0.492461       564

Test Acc: 0.5460992907801419 F1_ma:0.44556145131220415
Train step: 20 acc:0.34821 total_loss: 1.7066  loss:1.5788,stance loss: 1.0852 
Train step: 30 acc:0.39516 total_loss: 1.6578  loss:1.404,stance loss: 0.97989 
Train step: 40 acc:0.43902 total_loss: 1.6389  loss:1.4747,stance loss: 0.9185 
Train step: 50 acc:0.47304 total_loss: 1.6253  loss:1.472,stance loss: 1.0028 
Train step: 60 acc:0.49283 total_loss: 1.6046  loss:1.6238,stance loss: 1.2662 
Train step: 70 acc:0.50264 total_loss: 1.5889  loss:1.5067,stance loss: 1.0754 
Train step: 80 acc:0.52006 total_loss: 1.5947  loss:1.7569,stance loss: 1.7369 
Train step: 90 acc:0.52198 total_loss: 1.5943  loss:1.4123,stance loss: 0.83 
Train step: 100 acc:0.52723 total_loss: 1.5892  loss:1.6159,stance loss: 1.2051 
Train step: 110 acc:0.53322 total_loss: 1.5858  loss:1.8099,stance loss: 1.7511 
Train step: 120 acc:0.53409 total_loss: 1.5853  loss:1.5635,stance loss: 1.1688 
Train step: 130 acc:0.5334 total_loss: 1.5791  loss:1.5176,stance loss: 1.2355 
Train step: 140 acc:0.53413 total_loss: 1.5697  loss:1.4204,stance loss: 0.91134 
Train step: 150 acc:0.53642 total_loss: 1.5631  loss:1.3934,stance loss: 0.96119 
Train step: 160 acc:0.53843 total_loss: 1.5558  loss:1.4502,stance loss: 1.3122 
Train step: 170 acc:0.53765 total_loss: 1.5552  loss:1.4766,stance loss: 1.1287 
Train step: 180 acc:0.53833 total_loss: 1.5451  loss:1.555,stance loss: 1.1778 
Train step: 190 acc:0.53665 total_loss: 1.5376  loss:1.1079,stance loss: 0.52857 
Train step: 200 acc:0.54136 total_loss: 1.5326  loss:1.3904,stance loss: 1.1718 
Train step: 210 acc:0.54591 total_loss: 1.5312  loss:1.28,stance loss: 1.0086 
Train step: 220 acc:0.54893 total_loss: 1.5284  loss:1.7112,stance loss: 1.562 
Train step: 230 acc:0.55005 total_loss: 1.5267  loss:1.6882,stance loss: 1.2414 
Train step: 240 acc:0.55109 total_loss: 1.5202  loss:1.4872,stance loss: 1.2032 
Train step: 250 acc:0.55204 total_loss: 1.516  loss:1.149,stance loss: 0.75312 
Train step: 260 acc:0.5522 total_loss: 1.5112  loss:1.5841,stance loss: 1.2309 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.5625 total_loss: 1.575  loss:1.575,stance loss: 1.2569 
Train step: 280 acc:0.65341 total_loss: 1.348  loss:1.7101,stance loss: 2.1352 
Train step: 290 acc:0.625 total_loss: 1.3478  loss:1.1869,stance loss: 0.91516 
Train step: 300 acc:0.60081 total_loss: 1.3847  loss:1.5985,stance loss: 1.2788 
Train step: 310 acc:0.62348 total_loss: 1.3682  loss:1.0714,stance loss: 0.73983 
Train step: 320 acc:0.6201 total_loss: 1.3787  loss:1.4714,stance loss: 1.3815 
Train step: 330 acc:0.6127 total_loss: 1.3807  loss:1.1658,stance loss: 0.79786 
Train step: 340 acc:0.61708 total_loss: 1.3737  loss:1.3403,stance loss: 1.394 
Train step: 350 acc:0.61574 total_loss: 1.3692  loss:1.5788,stance loss: 1.303 
Train step: 360 acc:0.61813 total_loss: 1.3588  loss:1.3876,stance loss: 1.4719 
Train step: 370 acc:0.61386 total_loss: 1.3641  loss:1.4231,stance loss: 0.96358 
Train step: 380 acc:0.60642 total_loss: 1.3688  loss:1.3296,stance loss: 0.9117 
Train step: 390 acc:0.61519 total_loss: 1.3597  loss:1.3719,stance loss: 1.3833 
Train step: 400 acc:0.61689 total_loss: 1.3584  loss:1.3903,stance loss: 1.5319 
Train step: 410 acc:0.61924 total_loss: 1.3558  loss:1.1118,stance loss: 0.66295 
Train step: 420 acc:0.61589 total_loss: 1.3569  loss:1.3765,stance loss: 0.86114 
Train step: 430 acc:0.61335 total_loss: 1.3539  loss:1.2308,stance loss: 0.978 
Train step: 440 acc:0.61806 total_loss: 1.3442  loss:1.1876,stance loss: 0.87396 
Train step: 450 acc:0.61706 total_loss: 1.3397  loss:1.0285,stance loss: 0.7656 
Train step: 460 acc:0.6214 total_loss: 1.3401  loss:1.0189,stance loss: 0.74935 
Train step: 470 acc:0.62282 total_loss: 1.3386  loss:1.1038,stance loss: 0.75605 
Train step: 480 acc:0.61937 total_loss: 1.3401  loss:1.1124,stance loss: 0.64395 
Train step: 490 acc:0.61934 total_loss: 1.3361  loss:1.1059,stance loss: 0.82285 
Train step: 500 acc:0.61878 total_loss: 1.3353  loss:1.5172,stance loss: 1.1279 
Train step: 510 acc:0.62137 total_loss: 1.3305  loss:1.2592,stance loss: 1.0324 
Train step: 520 acc:0.62425 total_loss: 1.3246  loss:1.2657,stance loss: 0.87522 
Train step: 530 acc:0.62404 total_loss: 1.3213  loss:1.4798,stance loss: 1.2073 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.8125 total_loss: 0.92842  loss:0.92842,stance loss: 0.61059 
Train step: 550 acc:0.67614 total_loss: 1.2034  loss:1.6269,stance loss: 1.7744 
Train step: 560 acc:0.66071 total_loss: 1.2394  loss:1.2149,stance loss: 0.92402 
Train step: 570 acc:0.66331 total_loss: 1.2571  loss:1.0709,stance loss: 0.76161 
Train step: 580 acc:0.67073 total_loss: 1.2469  loss:1.2205,stance loss: 0.76912 
Train step: 590 acc:0.67892 total_loss: 1.2465  loss:1.2251,stance loss: 1.0942 
Train step: 600 acc:0.67418 total_loss: 1.2423  loss:0.89381,stance loss: 0.66601 
Train step: 610 acc:0.67518 total_loss: 1.2391  loss:1.1101,stance loss: 1.1927 
Train step: 620 acc:0.67207 total_loss: 1.2378  loss:1.6579,stance loss: 1.344 
Train step: 630 acc:0.66415 total_loss: 1.256  loss:1.6595,stance loss: 1.2455 
Train step: 640 acc:0.66151 total_loss: 1.2541  loss:1.4116,stance loss: 1.0377 
Train step: 650 acc:0.65766 total_loss: 1.2555  loss:1.2943,stance loss: 1.0111 
Train step: 660 acc:0.65548 total_loss: 1.2568  loss:1.1695,stance loss: 0.85349 
Train step: 670 acc:0.65935 total_loss: 1.2483  loss:1.0663,stance loss: 0.73568 
Train step: 680 acc:0.65647 total_loss: 1.2557  loss:1.7276,stance loss: 1.7754 
Train step: 690 acc:0.65356 total_loss: 1.2582  loss:1.2981,stance loss: 0.93517 
Train step: 700 acc:0.65761 total_loss: 1.2499  loss:1.0734,stance loss: 0.60832 
Train step: 710 acc:0.65789 total_loss: 1.2482  loss:0.96947,stance loss: 0.51242 
Train step: 720 acc:0.65988 total_loss: 1.2481  loss:1.4037,stance loss: 1.4703 
Train step: 730 acc:0.65641 total_loss: 1.2534  loss:1.3106,stance loss: 0.88196 
Train step: 740 acc:0.6592 total_loss: 1.253  loss:1.5049,stance loss: 1.2579 
Train step: 750 acc:0.65966 total_loss: 1.2513  loss:0.87615,stance loss: 0.65369 
Train step: 760 acc:0.66063 total_loss: 1.2548  loss:1.7007,stance loss: 1.3506 
Train step: 770 acc:0.65828 total_loss: 1.2572  loss:1.3069,stance loss: 0.86866 
Train step: 780 acc:0.65794 total_loss: 1.2541  loss:1.0558,stance loss: 0.78298 
Train step: 790 acc:0.65911 total_loss: 1.2491  loss:1.4221,stance loss: 1.0455 
Train step: 800 acc:0.66044 total_loss: 1.2463  loss:1.1298,stance loss: 0.99246 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.8125 total_loss: 0.87279  loss:0.87279,stance loss: 0.5401 
Train step: 820 acc:0.72727 total_loss: 1.046  loss:1.4497,stance loss: 1.6467 
Train step: 830 acc:0.70833 total_loss: 1.1318  loss:1.0496,stance loss: 0.75951 
Train step: 840 acc:0.69556 total_loss: 1.1688  loss:1.1056,stance loss: 0.9183 
Train step: 850 acc:0.70884 total_loss: 1.1342  loss:1.1537,stance loss: 0.90963 
Train step: 860 acc:0.70098 total_loss: 1.1284  loss:0.91887,stance loss: 0.65342 
Train step: 870 acc:0.68955 total_loss: 1.1418  loss:1.0054,stance loss: 0.86609 
Train step: 880 acc:0.68926 total_loss: 1.1313  loss:1.0837,stance loss: 0.76312 
Train step: 890 acc:0.69599 total_loss: 1.1304  loss:1.0011,stance loss: 0.71822 
Train step: 900 acc:0.69299 total_loss: 1.1346  loss:1.7558,stance loss: 1.7638 
Train step: 910 acc:0.68317 total_loss: 1.1446  loss:1.2767,stance loss: 1.0386 
Train step: 920 acc:0.68187 total_loss: 1.1422  loss:1.0489,stance loss: 0.69067 
Train step: 930 acc:0.68285 total_loss: 1.1439  loss:1.0322,stance loss: 0.73655 
Train step: 940 acc:0.68416 total_loss: 1.1415  loss:1.3131,stance loss: 0.80378 
Train step: 950 acc:0.6844 total_loss: 1.133  loss:0.94883,stance loss: 0.70045 
Train step: 960 acc:0.68419 total_loss: 1.1355  loss:1.4966,stance loss: 1.5224 
Train step: 970 acc:0.68478 total_loss: 1.1422  loss:0.9458,stance loss: 0.68212 
Train step: 980 acc:0.68421 total_loss: 1.1419  loss:1.3435,stance loss: 0.8896 
Train step: 990 acc:0.68267 total_loss: 1.1452  loss:1.4883,stance loss: 1.1484 
Train step: 1000 acc:0.68226 total_loss: 1.1431  loss:1.0418,stance loss: 0.7956 
Train step: 1010 acc:0.67942 total_loss: 1.1473  loss:1.5636,stance loss: 1.1491 
Train step: 1020 acc:0.67802 total_loss: 1.1468  loss:1.135,stance loss: 1.2693 
Train step: 1030 acc:0.67704 total_loss: 1.1539  loss:1.3786,stance loss: 0.93979 
Train step: 1040 acc:0.67884 total_loss: 1.1539  loss:1.3292,stance loss: 1.478 
Train step: 1050 acc:0.67946 total_loss: 1.1574  loss:1.3297,stance loss: 1.0187 
Train step: 1060 acc:0.67928 total_loss: 1.1566  loss:0.95608,stance loss: 0.75677 
Train step: 1070 acc:0.67864 total_loss: 1.1582  loss:1.1493,stance loss: 0.90214 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.8125 total_loss: 0.7941  loss:0.7941,stance loss: 0.56828 
Train step: 1090 acc:0.69886 total_loss: 1.1217  loss:1.3035,stance loss: 1.0689 
Train step: 1100 acc:0.70833 total_loss: 1.1066  loss:1.0451,stance loss: 0.74765 
Train step: 1110 acc:0.6996 total_loss: 1.0857  loss:1.0469,stance loss: 0.74259 
Train step: 1120 acc:0.71646 total_loss: 1.0774  loss:1.3135,stance loss: 1.4576 
Train step: 1130 acc:0.70956 total_loss: 1.0885  loss:1.2711,stance loss: 0.96857 
Train step: 1140 acc:0.71311 total_loss: 1.0765  loss:1.0429,stance loss: 0.79888 
Train step: 1150 acc:0.70599 total_loss: 1.0795  loss:1.2012,stance loss: 1.0154 
Train step: 1160 acc:0.70988 total_loss: 1.0935  loss:1.5278,stance loss: 1.7046 
Train step: 1170 acc:0.7081 total_loss: 1.1103  loss:1.0439,stance loss: 0.80589 
Train step: 1180 acc:0.70421 total_loss: 1.1066  loss:1.2887,stance loss: 0.86542 
Train step: 1190 acc:0.70439 total_loss: 1.1051  loss:1.0959,stance loss: 0.87228 
Train step: 1200 acc:0.70558 total_loss: 1.1028  loss:1.0726,stance loss: 0.82552 
Train step: 1210 acc:0.70563 total_loss: 1.0933  loss:0.80653,stance loss: 0.53583 
Train step: 1220 acc:0.70523 total_loss: 1.0999  loss:0.88562,stance loss: 0.68425 
Train step: 1230 acc:0.70654 total_loss: 1.0978  loss:0.86376,stance loss: 0.67095 
Train step: 1240 acc:0.71351 total_loss: 1.0896  loss:0.82098,stance loss: 0.54492 
Train step: 1250 acc:0.70833 total_loss: 1.097  loss:1.6182,stance loss: 1.6209 
Train step: 1260 acc:0.70787 total_loss: 1.1018  loss:1.6819,stance loss: 2.006 
Train step: 1270 acc:0.70582 total_loss: 1.1039  loss:1.5644,stance loss: 1.3036 
Train step: 1280 acc:0.7046 total_loss: 1.1046  loss:1.0693,stance loss: 0.7942 
Train step: 1290 acc:0.7032 total_loss: 1.1065  loss:0.82459,stance loss: 0.60412 
Train step: 1300 acc:0.70192 total_loss: 1.1054  loss:0.83917,stance loss: 0.71467 
Train step: 1310 acc:0.7013 total_loss: 1.1095  loss:1.2372,stance loss: 1.3682 
Train step: 1320 acc:0.70047 total_loss: 1.1061  loss:0.74463,stance loss: 0.44152 
Train step: 1330 acc:0.70144 total_loss: 1.1048  loss:0.85692,stance loss: 0.63279 
Train step: 1340 acc:0.70091 total_loss: 1.105  loss:0.86862,stance loss: 0.6746 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.625 total_loss: 0.97416  loss:0.97416,stance loss: 0.74358 
Train step: 1360 acc:0.73864 total_loss: 0.96817  loss:1.3208,stance loss: 0.95074 
Train step: 1370 acc:0.71726 total_loss: 0.99694  loss:0.79379,stance loss: 0.55937 
Train step: 1380 acc:0.70968 total_loss: 1.017  loss:1.1285,stance loss: 0.67682 
Train step: 1390 acc:0.70732 total_loss: 1.0486  loss:0.96016,stance loss: 0.69334 
Train step: 1400 acc:0.71324 total_loss: 1.0623  loss:1.0601,stance loss: 1.2504 
Train step: 1410 acc:0.71414 total_loss: 1.043  loss:1.1193,stance loss: 1.3397 
Train step: 1420 acc:0.71215 total_loss: 1.0484  loss:0.98133,stance loss: 1.2223 
Train step: 1430 acc:0.71451 total_loss: 1.0508  loss:1.07,stance loss: 0.82489 
Train step: 1440 acc:0.71978 total_loss: 1.0462  loss:0.8964,stance loss: 0.67003 
Train step: 1450 acc:0.71535 total_loss: 1.0556  loss:1.7446,stance loss: 1.8134 
Train step: 1460 acc:0.71903 total_loss: 1.0473  loss:1.2579,stance loss: 1.039 
Train step: 1470 acc:0.71643 total_loss: 1.048  loss:1.5447,stance loss: 1.3343 
Train step: 1480 acc:0.71708 total_loss: 1.053  loss:1.1982,stance loss: 1.3665 
Train step: 1490 acc:0.71631 total_loss: 1.0492  loss:1.0478,stance loss: 0.69896 
Train step: 1500 acc:0.71523 total_loss: 1.0406  loss:0.94636,stance loss: 0.66977 
Train step: 1510 acc:0.7205 total_loss: 1.0367  loss:0.95046,stance loss: 1.1166 
Train step: 1520 acc:0.72149 total_loss: 1.0351  loss:1.1924,stance loss: 0.76225 
Train step: 1530 acc:0.72238 total_loss: 1.0358  loss:0.37727,stance loss: 0.091677 
Train step: 1540 acc:0.72317 total_loss: 1.0283  loss:0.71962,stance loss: 0.51341 
Train step: 1550 acc:0.72388 total_loss: 1.0268  loss:0.68539,stance loss: 0.45639 
Train step: 1560 acc:0.72482 total_loss: 1.0287  loss:0.9398,stance loss: 0.74296 
Train step: 1570 acc:0.72483 total_loss: 1.0291  loss:0.98883,stance loss: 0.74207 
Train step: 1580 acc:0.7243 total_loss: 1.0298  loss:1.0324,stance loss: 0.67559 
Train step: 1590 acc:0.72329 total_loss: 1.0287  loss:1.4653,stance loss: 0.97009 
Train step: 1600 acc:0.72585 total_loss: 1.0204  loss:0.75712,stance loss: 0.58564 
Train step: 1610 acc:0.72342 total_loss: 1.0225  loss:1.1264,stance loss: 1.2862 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.5625 total_loss: 0.92997  loss:0.92997,stance loss: 0.61962 
Train step: 1630 acc:0.70455 total_loss: 0.98394  loss:0.96311,stance loss: 0.74345 
Train step: 1640 acc:0.74405 total_loss: 0.91653  loss:0.94253,stance loss: 0.64852 
Train step: 1650 acc:0.74194 total_loss: 0.93257  loss:1.0716,stance loss: 0.97224 
Train step: 1660 acc:0.73171 total_loss: 0.92506  loss:0.97365,stance loss: 0.66192 
Train step: 1670 acc:0.72672 total_loss: 0.95214  loss:0.88997,stance loss: 0.79878 
Train step: 1680 acc:0.73053 total_loss: 0.96181  loss:1.3962,stance loss: 1.5758 
Train step: 1690 acc:0.73151 total_loss: 0.96851  loss:0.87615,stance loss: 0.65196 
Train step: 1700 acc:0.7338 total_loss: 0.95403  loss:1.0155,stance loss: 0.78695 
Train step: 1710 acc:0.73901 total_loss: 0.94212  loss:0.74647,stance loss: 0.56471 
Train step: 1720 acc:0.74319 total_loss: 0.93388  loss:0.76544,stance loss: 0.56831 
Train step: 1730 acc:0.74381 total_loss: 0.92737  loss:0.98233,stance loss: 0.6663 
Train step: 1740 acc:0.74225 total_loss: 0.92651  loss:0.66127,stance loss: 0.5149 
Train step: 1750 acc:0.74094 total_loss: 0.937  loss:1.108,stance loss: 1.1647 
Train step: 1760 acc:0.74246 total_loss: 0.9419  loss:0.82461,stance loss: 0.5993 
Train step: 1770 acc:0.74503 total_loss: 0.93614  loss:0.95037,stance loss: 0.8415 
Train step: 1780 acc:0.74262 total_loss: 0.93658  loss:0.85752,stance loss: 0.64235 
Train step: 1790 acc:0.7405 total_loss: 0.944  loss:0.83027,stance loss: 0.65354 
Train step: 1800 acc:0.74102 total_loss: 0.94581  loss:1.0234,stance loss: 1.2803 
Train step: 1810 acc:0.74084 total_loss: 0.93971  loss:1.2378,stance loss: 1.0785 
Train step: 1820 acc:0.74316 total_loss: 0.94031  loss:0.68505,stance loss: 0.54403 
Train step: 1830 acc:0.74259 total_loss: 0.9328  loss:1.0186,stance loss: 0.79895 
Train step: 1840 acc:0.74321 total_loss: 0.93212  loss:1.0952,stance loss: 0.8146 
Train step: 1850 acc:0.74405 total_loss: 0.93034  loss:0.69093,stance loss: 0.53144 
Train step: 1860 acc:0.74741 total_loss: 0.92953  loss:0.72285,stance loss: 0.45138 
Train step: 1870 acc:0.74676 total_loss: 0.92844  loss:0.71312,stance loss: 0.49664 
Train step: 1880 acc:0.74737 total_loss: 0.9283  loss:1.5068,stance loss: 1.7234 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.6875 total_loss: 0.85823  loss:0.85823,stance loss: 0.64152 
Train step: 1900 acc:0.76136 total_loss: 0.82977  loss:0.73072,stance loss: 0.53577 
Train step: 1910 acc:0.77083 total_loss: 0.86722  loss:0.83842,stance loss: 0.6359 
Train step: 1920 acc:0.77419 total_loss: 0.83965  loss:0.62674,stance loss: 0.45139 
Train step: 1930 acc:0.78811 total_loss: 0.83431  loss:0.62629,stance loss: 0.53801 
Train step: 1940 acc:0.78554 total_loss: 0.83895  loss:1.2304,stance loss: 1.4743 
Train step: 1950 acc:0.77869 total_loss: 0.85455  loss:0.84084,stance loss: 0.68883 
Train step: 1960 acc:0.77641 total_loss: 0.8667  loss:1.3199,stance loss: 1.1472 
Train step: 1970 acc:0.77546 total_loss: 0.86219  loss:0.58961,stance loss: 0.45052 
Train step: 1980 acc:0.77473 total_loss: 0.86389  loss:0.90296,stance loss: 0.75464 
Train step: 1990 acc:0.77723 total_loss: 0.85704  loss:0.81145,stance loss: 0.65697 
Train step: 2000 acc:0.7759 total_loss: 0.8547  loss:0.5073,stance loss: 0.38757 
Train step: 2010 acc:0.77738 total_loss: 0.8442  loss:0.35061,stance loss: 0.22419 
Train step: 2020 acc:0.78006 total_loss: 0.84097  loss:0.72445,stance loss: 0.55539 
Train step: 2030 acc:0.78324 total_loss: 0.83807  loss:0.88246,stance loss: 0.66403 
Train step: 2040 acc:0.78063 total_loss: 0.84388  loss:0.86525,stance loss: 0.68476 
Train step: 2050 acc:0.77989 total_loss: 0.84387  loss:0.9191,stance loss: 0.58943 
Train step: 2060 acc:0.77668 total_loss: 0.84147  loss:0.92934,stance loss: 0.81285 
Train step: 2070 acc:0.77624 total_loss: 0.84906  loss:0.57867,stance loss: 0.4647 
Train step: 2080 acc:0.77651 total_loss: 0.85764  loss:0.6997,stance loss: 0.55779 
Train step: 2090 acc:0.77488 total_loss: 0.8589  loss:1.0226,stance loss: 0.94329 
Train step: 2100 acc:0.77459 total_loss: 0.85979  loss:0.83104,stance loss: 0.61484 
Train step: 2110 acc:0.77319 total_loss: 0.86743  loss:0.59546,stance loss: 0.44908 
Train step: 2120 acc:0.77381 total_loss: 0.86417  loss:0.43603,stance loss: 0.34479 
Train step: 2130 acc:0.77412 total_loss: 0.86567  loss:0.88582,stance loss: 0.74054 
Train step: 2140 acc:0.77415 total_loss: 0.86306  loss:0.82116,stance loss: 0.66448 
Train step: 2150 acc:0.77586 total_loss: 0.86205  loss:0.74647,stance loss: 0.66698 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.9375 total_loss: 0.51472  loss:0.51472,stance loss: 0.2808 
Train step: 2170 acc:0.84091 total_loss: 0.72061  loss:0.6475,stance loss: 0.49113 
Train step: 2180 acc:0.84226 total_loss: 0.7035  loss:0.51985,stance loss: 0.24314 
Train step: 2190 acc:0.84274 total_loss: 0.7206  loss:0.45266,stance loss: 0.36487 
Train step: 2200 acc:0.82774 total_loss: 0.76467  loss:0.6616,stance loss: 0.41309 
Train step: 2210 acc:0.82108 total_loss: 0.7559  loss:0.62298,stance loss: 0.4646 
Train step: 2220 acc:0.81455 total_loss: 0.77086  loss:0.99794,stance loss: 0.85412 
Train step: 2230 acc:0.80722 total_loss: 0.78169  loss:0.63832,stance loss: 0.49119 
Train step: 2240 acc:0.80787 total_loss: 0.77997  loss:0.62676,stance loss: 0.49371 
Train step: 2250 acc:0.80495 total_loss: 0.78806  loss:1.3341,stance loss: 1.5798 
Train step: 2260 acc:0.80879 total_loss: 0.78827  loss:0.90418,stance loss: 0.82941 
Train step: 2270 acc:0.80462 total_loss: 0.79259  loss:0.93851,stance loss: 1.2571 
Train step: 2280 acc:0.8063 total_loss: 0.78723  loss:0.70515,stance loss: 0.55338 
Train step: 2290 acc:0.80821 total_loss: 0.7757  loss:0.65086,stance loss: 0.45609 
Train step: 2300 acc:0.80984 total_loss: 0.77042  loss:0.70565,stance loss: 0.5259 
Train step: 2310 acc:0.81167 total_loss: 0.76702  loss:0.53572,stance loss: 0.3337 
Train step: 2320 acc:0.81134 total_loss: 0.76714  loss:0.62546,stance loss: 0.22086 
Train step: 2330 acc:0.8136 total_loss: 0.76861  loss:0.90099,stance loss: 1.1809 
Train step: 2340 acc:0.81388 total_loss: 0.76455  loss:0.57002,stance loss: 0.43185 
Train step: 2350 acc:0.81577 total_loss: 0.7626  loss:0.6974,stance loss: 1.0443 
Train step: 2360 acc:0.81437 total_loss: 0.76616  loss:0.71593,stance loss: 0.68861 
Train step: 2370 acc:0.81398 total_loss: 0.76054  loss:0.77691,stance loss: 0.56872 
Train step: 2380 acc:0.81476 total_loss: 0.76216  loss:0.33365,stance loss: 0.15104 
Train step: 2390 acc:0.81439 total_loss: 0.76944  loss:0.65383,stance loss: 0.46325 
Train step: 2400 acc:0.81509 total_loss: 0.76117  loss:0.35418,stance loss: 0.1569 
Train step: 2410 acc:0.812 total_loss: 0.76725  loss:0.37037,stance loss: 0.29385 
Train step: 2420 acc:0.8125 total_loss: 0.76958  loss:0.79978,stance loss: 0.73965 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.36544  loss:0.36544,stance loss: 0.23071 
Train step: 2440 acc:0.80682 total_loss: 0.66967  loss:0.603,stance loss: 0.47735 
Train step: 2450 acc:0.82143 total_loss: 0.6511  loss:0.71858,stance loss: 0.63267 
Train step: 2460 acc:0.83065 total_loss: 0.60753  loss:0.42506,stance loss: 0.3805 
Train step: 2470 acc:0.83232 total_loss: 0.63483  loss:0.6401,stance loss: 0.5074 
Train step: 2480 acc:0.83211 total_loss: 0.65306  loss:0.6607,stance loss: 0.50917 
Train step: 2490 acc:0.82992 total_loss: 0.66676  loss:1.4427,stance loss: 1.6736 
Train step: 2500 acc:0.83539 total_loss: 0.65864  loss:0.39318,stance loss: 0.29923 
Train step: 2510 acc:0.83951 total_loss: 0.64379  loss:0.32175,stance loss: 0.23313 
Train step: 2520 acc:0.83791 total_loss: 0.65242  loss:0.73287,stance loss: 0.64893 
Train step: 2530 acc:0.8422 total_loss: 0.65047  loss:0.6156,stance loss: 0.50967 
Train step: 2540 acc:0.83896 total_loss: 0.64569  loss:0.60381,stance loss: 0.43564 
Train step: 2550 acc:0.83523 total_loss: 0.65224  loss:1.322,stance loss: 1.2115 
Train step: 2560 acc:0.83588 total_loss: 0.65274  loss:0.29807,stance loss: 0.22511 
Train step: 2570 acc:0.83599 total_loss: 0.65217  loss:0.80972,stance loss: 0.53806 
Train step: 2580 acc:0.83609 total_loss: 0.6494  loss:0.5237,stance loss: 0.39362 
Train step: 2590 acc:0.83734 total_loss: 0.64951  loss:0.38803,stance loss: 0.27321 
Train step: 2600 acc:0.83699 total_loss: 0.65132  loss:0.54291,stance loss: 0.28312 
Train step: 2610 acc:0.8384 total_loss: 0.65237  loss:0.40498,stance loss: 0.23894 
Train step: 2620 acc:0.83671 total_loss: 0.66024  loss:1.0759,stance loss: 1.4344 
Train step: 2630 acc:0.83675 total_loss: 0.6582  loss:0.55986,stance loss: 0.49945 
Train step: 2640 acc:0.83797 total_loss: 0.65704  loss:0.43961,stance loss: 0.35055 
Train step: 2650 acc:0.8371 total_loss: 0.6602  loss:0.4782,stance loss: 0.40113 
Train step: 2660 acc:0.83712 total_loss: 0.6612  loss:0.7281,stance loss: 0.51558 
Train step: 2670 acc:0.83714 total_loss: 0.65613  loss:0.64164,stance loss: 0.45168 
Train step: 2680 acc:0.83715 total_loss: 0.65826  loss:0.60091,stance loss: 0.54275 
Train step: 2690 acc:0.8374 total_loss: 0.657  loss:0.55513,stance loss: 0.42133 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.875 total_loss: 0.79562  loss:0.79562,stance loss: 1.0895 
Train step: 2710 acc:0.88636 total_loss: 0.52946  loss:0.45388,stance loss: 0.37649 
Train step: 2720 acc:0.86012 total_loss: 0.58715  loss:0.45905,stance loss: 0.3289 
Train step: 2730 acc:0.85887 total_loss: 0.5898  loss:0.73248,stance loss: 1.136 
Train step: 2740 acc:0.85823 total_loss: 0.57911  loss:0.4127,stance loss: 0.30903 
Train step: 2750 acc:0.86397 total_loss: 0.59581  loss:1.3003,stance loss: 2.0907 
Train step: 2760 acc:0.85758 total_loss: 0.60764  loss:0.46896,stance loss: 0.41834 
Train step: 2770 acc:0.86092 total_loss: 0.59852  loss:0.4064,stance loss: 0.34503 
Train step: 2780 acc:0.85494 total_loss: 0.59894  loss:0.51211,stance loss: 0.41421 
Train step: 2790 acc:0.85989 total_loss: 0.58704  loss:0.29951,stance loss: 0.19077 
Train step: 2800 acc:0.85829 total_loss: 0.58987  loss:0.82263,stance loss: 0.71976 
Train step: 2810 acc:0.86092 total_loss: 0.5842  loss:0.76554,stance loss: 0.67034 
Train step: 2820 acc:0.85744 total_loss: 0.60165  loss:0.81527,stance loss: 1.0653 
Train step: 2830 acc:0.85592 total_loss: 0.60195  loss:0.62983,stance loss: 0.45464 
Train step: 2840 acc:0.85328 total_loss: 0.60714  loss:0.59989,stance loss: 0.48928 
Train step: 2850 acc:0.85099 total_loss: 0.61613  loss:0.43213,stance loss: 0.29878 
Train step: 2860 acc:0.84821 total_loss: 0.62318  loss:0.58413,stance loss: 0.42149 
Train step: 2870 acc:0.84613 total_loss: 0.62209  loss:0.29419,stance loss: 0.17081 
Train step: 2880 acc:0.8453 total_loss: 0.62474  loss:0.43697,stance loss: 0.34503 
Train step: 2890 acc:0.84588 total_loss: 0.62636  loss:0.43892,stance loss: 0.35 
Train step: 2900 acc:0.8467 total_loss: 0.62554  loss:0.29499,stance loss: 0.25254 
Train step: 2910 acc:0.84775 total_loss: 0.62424  loss:0.88859,stance loss: 1.2882 
Train step: 2920 acc:0.84785 total_loss: 0.61989  loss:0.36007,stance loss: 0.31022 
Train step: 2930 acc:0.84767 total_loss: 0.61856  loss:0.98537,stance loss: 0.89451 
Train step: 2940 acc:0.84829 total_loss: 0.61824  loss:0.30273,stance loss: 0.08017 
Train step: 2950 acc:0.84836 total_loss: 0.62025  loss:0.83628,stance loss: 0.73529 
Train step: 2960 acc:0.85081 total_loss: 0.61234  loss:0.34281,stance loss: 0.2899 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.75 total_loss: 0.67941  loss:0.67941,stance loss: 0.4527 
Train step: 2980 acc:0.88068 total_loss: 0.49165  loss:0.5294,stance loss: 0.42059 
Train step: 2990 acc:0.89583 total_loss: 0.48673  loss:0.56852,stance loss: 0.45953 
Train step: 3000 acc:0.90121 total_loss: 0.49505  loss:0.43174,stance loss: 0.42566 
Train step: 3010 acc:0.89329 total_loss: 0.51605  loss:0.90659,stance loss: 1.3034 
Train step: 3020 acc:0.89461 total_loss: 0.51815  loss:0.41119,stance loss: 0.34146 
Train step: 3030 acc:0.89037 total_loss: 0.51345  loss:0.23959,stance loss: 0.24601 
Train step: 3040 acc:0.89085 total_loss: 0.53266  loss:0.27383,stance loss: 0.23006 
Train step: 3050 acc:0.88889 total_loss: 0.52775  loss:0.58431,stance loss: 0.52464 
Train step: 3060 acc:0.88874 total_loss: 0.52764  loss:0.80759,stance loss: 1.0563 
Train step: 3070 acc:0.8849 total_loss: 0.52632  loss:0.19232,stance loss: 0.1529 
Train step: 3080 acc:0.88514 total_loss: 0.53218  loss:0.34045,stance loss: 0.21436 
Train step: 3090 acc:0.88223 total_loss: 0.54343  loss:0.71331,stance loss: 1.0795 
Train step: 3100 acc:0.87977 total_loss: 0.54182  loss:0.31474,stance loss: 0.24851 
Train step: 3110 acc:0.87855 total_loss: 0.55258  loss:0.65823,stance loss: 0.519 
Train step: 3120 acc:0.87873 total_loss: 0.54838  loss:0.19839,stance loss: 0.11513 
Train step: 3130 acc:0.87966 total_loss: 0.54742  loss:0.60396,stance loss: 0.50952 
Train step: 3140 acc:0.88012 total_loss: 0.54955  loss:0.85209,stance loss: 0.59603 
Train step: 3150 acc:0.88156 total_loss: 0.54935  loss:0.69852,stance loss: 0.46837 
Train step: 3160 acc:0.88384 total_loss: 0.54058  loss:0.12002,stance loss: 0.034493 
Train step: 3170 acc:0.88433 total_loss: 0.53598  loss:0.44297,stance loss: 0.27109 
Train step: 3180 acc:0.88389 total_loss: 0.53715  loss:0.56966,stance loss: 0.41532 
Train step: 3190 acc:0.88462 total_loss: 0.53288  loss:0.50485,stance loss: 0.48869 
Train step: 3200 acc:0.8842 total_loss: 0.54157  loss:0.96895,stance loss: 1.1159 
Train step: 3210 acc:0.88615 total_loss: 0.53263  loss:0.38238,stance loss: 0.30986 
Train step: 3220 acc:0.88446 total_loss: 0.54122  loss:1.538,stance loss: 1.9805 
Train step: 3230 acc:0.88578 total_loss: 0.53663  loss:0.23025,stance loss: 0.15639 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.23437  loss:0.23437,stance loss: 0.16893 
Train step: 3250 acc:0.94886 total_loss: 0.40893  loss:0.17498,stance loss: 0.049934 
Train step: 3260 acc:0.92857 total_loss: 0.42612  loss:0.38167,stance loss: 0.32338 
Train step: 3270 acc:0.9254 total_loss: 0.42244  loss:0.57844,stance loss: 0.4434 
Train step: 3280 acc:0.91463 total_loss: 0.43843  loss:0.49133,stance loss: 0.36218 
Train step: 3290 acc:0.90931 total_loss: 0.45044  loss:0.36424,stance loss: 0.30533 
Train step: 3300 acc:0.90779 total_loss: 0.46446  loss:0.42191,stance loss: 0.32814 
Train step: 3310 acc:0.90845 total_loss: 0.45867  loss:0.4202,stance loss: 0.3381 
Train step: 3320 acc:0.91127 total_loss: 0.46263  loss:0.46268,stance loss: 0.3603 
Train step: 3330 acc:0.90591 total_loss: 0.47911  loss:0.79437,stance loss: 1.0903 
Train step: 3340 acc:0.90347 total_loss: 0.48111  loss:0.1434,stance loss: 0.06658 
Train step: 3350 acc:0.90372 total_loss: 0.4832  loss:0.37493,stance loss: 0.30025 
Train step: 3360 acc:0.89979 total_loss: 0.50079  loss:1.2665,stance loss: 1.5842 
Train step: 3370 acc:0.89981 total_loss: 0.50719  loss:1.1282,stance loss: 1.5532 
Train step: 3380 acc:0.9016 total_loss: 0.49627  loss:0.28785,stance loss: 0.19634 
Train step: 3390 acc:0.90273 total_loss: 0.49653  loss:0.45996,stance loss: 0.39156 
Train step: 3400 acc:0.90373 total_loss: 0.49071  loss:0.27017,stance loss: 0.24095 
Train step: 3410 acc:0.90314 total_loss: 0.48466  loss:0.18225,stance loss: 0.064248 
Train step: 3420 acc:0.90366 total_loss: 0.47877  loss:0.23487,stance loss: 0.085332 
Train step: 3430 acc:0.90609 total_loss: 0.4712  loss:0.48862,stance loss: 0.39038 
Train step: 3440 acc:0.90672 total_loss: 0.47628  loss:0.81402,stance loss: 1.2935 
Train step: 3450 acc:0.90669 total_loss: 0.47433  loss:0.32601,stance loss: 0.19748 
Train step: 3460 acc:0.90837 total_loss: 0.47686  loss:0.93622,stance loss: 1.247 
Train step: 3470 acc:0.90936 total_loss: 0.47445  loss:0.40212,stance loss: 0.24644 
Train step: 3480 acc:0.91079 total_loss: 0.46872  loss:0.20426,stance loss: 0.13954 
Train step: 3490 acc:0.90961 total_loss: 0.46963  loss:0.2174,stance loss: 0.18668 
Train step: 3500 acc:0.91068 total_loss: 0.47142  loss:1.4926,stance loss: 1.9754 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.9375 total_loss: 0.95385  loss:0.95385,stance loss: 1.1082 
Train step: 3520 acc:0.92614 total_loss: 0.42932  loss:0.53929,stance loss: 0.56618 
Train step: 3530 acc:0.92262 total_loss: 0.4381  loss:0.29533,stance loss: 0.25746 
Train step: 3540 acc:0.92944 total_loss: 0.42325  loss:0.53312,stance loss: 1.0086 
Train step: 3550 acc:0.9314 total_loss: 0.39726  loss:0.40052,stance loss: 0.38937 
Train step: 3560 acc:0.92892 total_loss: 0.39959  loss:0.82821,stance loss: 1.2278 
Train step: 3570 acc:0.93033 total_loss: 0.38531  loss:0.26142,stance loss: 0.30206 
Train step: 3580 acc:0.92958 total_loss: 0.3832  loss:0.44932,stance loss: 0.35262 
Train step: 3590 acc:0.92747 total_loss: 0.39206  loss:0.60866,stance loss: 0.42706 
Train step: 3600 acc:0.92788 total_loss: 0.4023  loss:0.24937,stance loss: 0.18406 
Train step: 3610 acc:0.9245 total_loss: 0.40646  loss:0.44487,stance loss: 0.55338 
Train step: 3620 acc:0.9223 total_loss: 0.4091  loss:0.35674,stance loss: 0.27932 
Train step: 3630 acc:0.92304 total_loss: 0.41057  loss:0.18279,stance loss: 0.13479 
Train step: 3640 acc:0.92271 total_loss: 0.41421  loss:0.35286,stance loss: 0.31706 
Train step: 3650 acc:0.92066 total_loss: 0.41919  loss:0.59285,stance loss: 0.56079 
Train step: 3660 acc:0.92177 total_loss: 0.4203  loss:0.7135,stance loss: 1.0584 
Train step: 3670 acc:0.92158 total_loss: 0.419  loss:0.71074,stance loss: 0.55406 
Train step: 3680 acc:0.92178 total_loss: 0.41714  loss:0.24403,stance loss: 0.20103 
Train step: 3690 acc:0.92196 total_loss: 0.4151  loss:0.33915,stance loss: 0.24864 
Train step: 3700 acc:0.9231 total_loss: 0.40946  loss:0.19805,stance loss: 0.11569 
Train step: 3710 acc:0.92351 total_loss: 0.40791  loss:0.78946,stance loss: 1.2914 
Train step: 3720 acc:0.92299 total_loss: 0.40965  loss:0.8832,stance loss: 1.331 
Train step: 3730 acc:0.92364 total_loss: 0.40673  loss:0.2486,stance loss: 0.23385 
Train step: 3740 acc:0.92451 total_loss: 0.40384  loss:0.26965,stance loss: 0.23151 
Train step: 3750 acc:0.92557 total_loss: 0.40483  loss:0.76154,stance loss: 0.6196 
Train step: 3760 acc:0.9253 total_loss: 0.40837  loss:0.1096,stance loss: 0.08295 
Train step: 3770 acc:0.92553 total_loss: 0.411  loss:0.26413,stance loss: 0.17487 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.9375 total_loss: 0.46263  loss:0.46263,stance loss: 0.37803 
Train step: 3790 acc:0.96591 total_loss: 0.26676  loss:0.10338,stance loss: 0.067956 
Train step: 3800 acc:0.95536 total_loss: 0.39741  loss:0.89501,stance loss: 1.3309 
Train step: 3810 acc:0.95363 total_loss: 0.38041  loss:0.72185,stance loss: 1.0866 
Train step: 3820 acc:0.95122 total_loss: 0.37191  loss:0.45191,stance loss: 0.3462 
Train step: 3830 acc:0.94363 total_loss: 0.39896  loss:0.31785,stance loss: 0.27738 
Train step: 3840 acc:0.93443 total_loss: 0.45543  loss:0.5445,stance loss: 0.35573 
Train step: 3850 acc:0.93398 total_loss: 0.44971  loss:0.32821,stance loss: 0.28616 
Train step: 3860 acc:0.93364 total_loss: 0.43147  loss:0.1418,stance loss: 0.088717 
Train step: 3870 acc:0.93407 total_loss: 0.43163  loss:0.31967,stance loss: 0.26829 
Train step: 3880 acc:0.93812 total_loss: 0.40829  loss:0.25825,stance loss: 0.23113 
Train step: 3890 acc:0.93975 total_loss: 0.40951  loss:0.66034,stance loss: 1.0661 
Train step: 3900 acc:0.93698 total_loss: 0.41191  loss:0.41232,stance loss: 0.34715 
Train step: 3910 acc:0.93845 total_loss: 0.40489  loss:0.62061,stance loss: 0.50823 
Train step: 3920 acc:0.93927 total_loss: 0.39209  loss:0.090798,stance loss: 0.034683 
Train step: 3930 acc:0.94081 total_loss: 0.39289  loss:0.072999,stance loss: 0.047323 
Train step: 3940 acc:0.94099 total_loss: 0.3902  loss:0.6505,stance loss: 0.64953 
Train step: 3950 acc:0.93969 total_loss: 0.3824  loss:0.31512,stance loss: 0.23856 
Train step: 3960 acc:0.93854 total_loss: 0.37912  loss:0.14515,stance loss: 0.081927 
Train step: 3970 acc:0.93914 total_loss: 0.37528  loss:0.069232,stance loss: 0.0087116 
Train step: 3980 acc:0.93657 total_loss: 0.383  loss:0.93229,stance loss: 1.2567 
Train step: 3990 acc:0.9375 total_loss: 0.38124  loss:0.19948,stance loss: 0.15232 
Train step: 4000 acc:0.93722 total_loss: 0.38323  loss:0.62292,stance loss: 1.0552 
Train step: 4010 acc:0.9375 total_loss: 0.38411  loss:0.24095,stance loss: 0.24372 
Train step: 4020 acc:0.93828 total_loss: 0.37994  loss:0.13603,stance loss: 0.11705 
Train step: 4030 acc:0.93875 total_loss: 0.37441  loss:0.14782,stance loss: 0.1101 
Train step: 4040 acc:0.93989 total_loss: 0.36948  loss:0.099545,stance loss: 0.071132 
Training finished.


Reload the best model with best f1 0.44556145131220415 from path test_outputs/bert-cross-topic/cc/2023-08-14 15-44-09/state_dict


              precision    recall  f1-score   support

           0   0.042683  0.269231  0.073684        26
           1   1.000000  0.004926  0.009804       203
           2   0.751880  0.895522  0.817439       335

    accuracy                       0.546099       564
   macro avg   0.598188  0.389893  0.300309       564
weighted avg   0.808492  0.546099  0.492461       564

Test Acc: 0.5460992907801419 F1_ma:0.44556145131220415
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.44556145131220415
acc: 0.5460992907801419, f1 :0.30030894139767855
classification report: 
              precision    recall  f1-score   support

         Con     0.0427    0.2692    0.0737        26
        None     1.0000    0.0049    0.0098       203
         Pro     0.7519    0.8955    0.8174       335

    accuracy                         0.5461       564
   macro avg     0.5982    0.3899    0.3003       564
weighted avg     0.8085    0.5461    0.4925       564

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 16-00-23', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 16-00-23
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5 total_loss: 1.7098  loss:1.7098,stance loss: 1.286 
Train step: 10 acc:0.26136 total_loss: 1.8538  loss:1.8248,stance loss: 1.7472 
Better F1! Saving model!
Saving model of best f1: 0.045060658578856154
              precision    recall  f1-score   support

           0   0.047187  1.000000  0.090121        26
           1   0.076923  0.004926  0.009259       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.047872       564
   macro avg   0.041370  0.334975  0.033127       564
weighted avg   0.029862  0.047872  0.007487       564

Test Acc: 0.047872340425531915 F1_ma:0.045060658578856154
Train step: 20 acc:0.41369 total_loss: 1.7308  loss:1.452,stance loss: 1.0761 
Train step: 30 acc:0.45968 total_loss: 1.6964  loss:1.5912,stance loss: 1.1838 
Train step: 40 acc:0.49543 total_loss: 1.6442  loss:1.2962,stance loss: 0.9269 
Train step: 50 acc:0.5098 total_loss: 1.6395  loss:1.7383,stance loss: 1.1686 
Train step: 60 acc:0.52357 total_loss: 1.6283  loss:1.7937,stance loss: 1.8864 
Train step: 70 acc:0.52641 total_loss: 1.6085  loss:1.4894,stance loss: 1.0949 
Train step: 80 acc:0.52546 total_loss: 1.6106  loss:1.5789,stance loss: 1.1134 
Train step: 90 acc:0.52404 total_loss: 1.603  loss:1.3926,stance loss: 0.89477 
Train step: 100 acc:0.52537 total_loss: 1.6049  loss:1.737,stance loss: 1.0853 
Train step: 110 acc:0.53266 total_loss: 1.5985  loss:0.94034,stance loss: 0.39937 
Train step: 120 acc:0.53306 total_loss: 1.5876  loss:1.5943,stance loss: 1.1661 
Train step: 130 acc:0.53101 total_loss: 1.5884  loss:1.1659,stance loss: 0.76084 
Train step: 140 acc:0.53147 total_loss: 1.5855  loss:1.6152,stance loss: 1.2834 
Train step: 150 acc:0.5327 total_loss: 1.582  loss:1.4165,stance loss: 0.97955 
Train step: 160 acc:0.53183 total_loss: 1.5766  loss:1.343,stance loss: 0.86715 
Train step: 170 acc:0.53363 total_loss: 1.5694  loss:1.3246,stance loss: 0.99297 
Train step: 180 acc:0.53453 total_loss: 1.561  loss:1.3471,stance loss: 0.9112 
Train step: 190 acc:0.53763 total_loss: 1.5566  loss:1.6523,stance loss: 1.7832 
Train step: 200 acc:0.54011 total_loss: 1.5529  loss:1.4894,stance loss: 1.2611 
Train step: 210 acc:0.54028 total_loss: 1.544  loss:1.2265,stance loss: 0.85156 
Train step: 220 acc:0.54299 total_loss: 1.5419  loss:1.6162,stance loss: 1.0795 
Train step: 230 acc:0.5441 total_loss: 1.5358  loss:1.2417,stance loss: 0.82991 
Train step: 240 acc:0.54357 total_loss: 1.5346  loss:1.4188,stance loss: 1.0779 
Train step: 250 acc:0.54482 total_loss: 1.5333  loss:1.3592,stance loss: 0.85451 
Train step: 260 acc:0.54382 total_loss: 1.531  loss:1.2508,stance loss: 0.87479 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.75 total_loss: 1.1779  loss:1.1779,stance loss: 0.80925 
Train step: 280 acc:0.52841 total_loss: 1.4623  loss:1.634,stance loss: 1.137 
Train step: 290 acc:0.55952 total_loss: 1.4552  loss:1.6408,stance loss: 1.2594 
Train step: 300 acc:0.55444 total_loss: 1.4177  loss:1.5463,stance loss: 1.1573 
Better F1! Saving model!
Saving model of best f1: 0.046511627906976744
              precision    recall  f1-score   support

           0   0.048780  1.000000  0.093023        26
           1   0.903226  0.137931  0.239316       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.095745       564
   macro avg   0.317335  0.379310  0.110780       564
weighted avg   0.327346  0.095745  0.090425       564

Test Acc: 0.09574468085106383 F1_ma:0.046511627906976744
Train step: 310 acc:0.55793 total_loss: 1.4139  loss:1.2729,stance loss: 0.83018 
Train step: 320 acc:0.55882 total_loss: 1.4008  loss:1.2721,stance loss: 0.94924 
Train step: 330 acc:0.5502 total_loss: 1.4216  loss:1.7055,stance loss: 1.1353 
Train step: 340 acc:0.55898 total_loss: 1.4174  loss:1.4751,stance loss: 1.2414 
Better F1! Saving model!
Saving model of best f1: 0.04888888888888889
              precision    recall  f1-score   support

           0   0.051887  0.846154  0.097778        26
           1   0.807143  0.556650  0.658892       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.239362       564
   macro avg   0.286343  0.467601  0.252223       564
weighted avg   0.292906  0.239362  0.241662       564

Test Acc: 0.2393617021276596 F1_ma:0.04888888888888889
Train step: 350 acc:0.5733 total_loss: 1.3896  loss:1.2889,stance loss: 0.91283 
Train step: 360 acc:0.57143 total_loss: 1.3833  loss:0.93964,stance loss: 0.47287 
Train step: 370 acc:0.5755 total_loss: 1.3816  loss:1.4945,stance loss: 1.2188 
Better F1! Saving model!
Saving model of best f1: 0.05521472392638036
              precision    recall  f1-score   support

           0   0.060000  0.692308  0.110429        26
           1   0.693182  0.901478  0.783726       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.356383       564
   macro avg   0.251061  0.531262  0.298052       564
weighted avg   0.252262  0.356383  0.287176       564

Test Acc: 0.35638297872340424 F1_ma:0.05521472392638036
Train step: 380 acc:0.57883 total_loss: 1.3822  loss:1.4821,stance loss: 1.2548 
Train step: 390 acc:0.58523 total_loss: 1.3852  loss:1.6509,stance loss: 1.0853 
Train step: 400 acc:0.58969 total_loss: 1.3771  loss:1.315,stance loss: 1.0128 
Train step: 410 acc:0.5922 total_loss: 1.3713  loss:1.5178,stance loss: 1.3697 
Train step: 420 acc:0.59272 total_loss: 1.3736  loss:1.7794,stance loss: 1.7485 
Train step: 430 acc:0.59045 total_loss: 1.3741  loss:1.2559,stance loss: 0.96626 
Train step: 440 acc:0.58918 total_loss: 1.3727  loss:1.1049,stance loss: 0.74135 
Train step: 450 acc:0.59116 total_loss: 1.3668  loss:1.1637,stance loss: 0.73845 
Better F1! Saving model!
Saving model of best f1: 0.05555555555555556
              precision    recall  f1-score   support

           0   0.060127  0.730769  0.111111        26
           1   0.721774  0.881773  0.793792       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.351064       564
   macro avg   0.260634  0.537514  0.301634       564
weighted avg   0.262559  0.351064  0.290831       564

Test Acc: 0.35106382978723405 F1_ma:0.05555555555555556
Train step: 460 acc:0.59097 total_loss: 1.3699  loss:1.1678,stance loss: 0.76166 
Train step: 470 acc:0.59266 total_loss: 1.3674  loss:1.2901,stance loss: 0.87082 
Train step: 480 acc:0.59479 total_loss: 1.3618  loss:1.2418,stance loss: 0.71058 
Train step: 490 acc:0.59474 total_loss: 1.3699  loss:1.855,stance loss: 1.915 
Train step: 500 acc:0.59605 total_loss: 1.3678  loss:1.2346,stance loss: 0.99464 
Train step: 510 acc:0.59725 total_loss: 1.3682  loss:1.4433,stance loss: 1.0798 
Train step: 520 acc:0.5991 total_loss: 1.3638  loss:1.2333,stance loss: 0.87787 
Train step: 530 acc:0.60081 total_loss: 1.3616  loss:1.3523,stance loss: 1.0589 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.75 total_loss: 1.6396  loss:1.6396,stance loss: 1.6899 
Train step: 550 acc:0.67614 total_loss: 1.4703  loss:1.3477,stance loss: 0.88619 
Better F1! Saving model!
Saving model of best f1: 0.05830903790087464
              precision    recall  f1-score   support

           0   0.063091  0.769231  0.116618        26
           1   0.720648  0.876847  0.791111       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.351064       564
   macro avg   0.261246  0.548693  0.302576       564
weighted avg   0.262291  0.351064  0.290120       564

Test Acc: 0.35106382978723405 F1_ma:0.05830903790087464
Train step: 560 acc:0.66071 total_loss: 1.4152  loss:1.3283,stance loss: 1.1014 
Train step: 570 acc:0.66532 total_loss: 1.3425  loss:1.1071,stance loss: 0.63092 
Train step: 580 acc:0.66159 total_loss: 1.3233  loss:1.4295,stance loss: 1.0469 
Train step: 590 acc:0.65931 total_loss: 1.3399  loss:1.1615,stance loss: 0.94875 
Train step: 600 acc:0.65369 total_loss: 1.3304  loss:1.1563,stance loss: 0.69371 
Train step: 610 acc:0.64789 total_loss: 1.3337  loss:1.5177,stance loss: 1.6727 
Train step: 620 acc:0.64815 total_loss: 1.3129  loss:1.5883,stance loss: 1.1718 
Train step: 630 acc:0.64904 total_loss: 1.3102  loss:1.2032,stance loss: 0.96449 
Train step: 640 acc:0.64851 total_loss: 1.3118  loss:1.0884,stance loss: 0.81481 
Train step: 650 acc:0.65034 total_loss: 1.3043  loss:1.6755,stance loss: 1.2453 
Train step: 660 acc:0.64876 total_loss: 1.2969  loss:1.0765,stance loss: 0.81831 
Train step: 670 acc:0.64838 total_loss: 1.2972  loss:1.1519,stance loss: 0.77208 
Train step: 680 acc:0.64539 total_loss: 1.3003  loss:1.7792,stance loss: 1.339 
Train step: 690 acc:0.64983 total_loss: 1.292  loss:1.053,stance loss: 0.77188 
Train step: 700 acc:0.65256 total_loss: 1.2888  loss:1.4181,stance loss: 1.5174 
Train step: 710 acc:0.65607 total_loss: 1.2811  loss:1.1132,stance loss: 0.75497 
Train step: 720 acc:0.65539 total_loss: 1.2808  loss:1.5489,stance loss: 1.3286 
Train step: 730 acc:0.65576 total_loss: 1.285  loss:0.96793,stance loss: 0.58005 
Train step: 740 acc:0.65889 total_loss: 1.2804  loss:1.1265,stance loss: 0.65701 
Train step: 750 acc:0.65847 total_loss: 1.2813  loss:1.2333,stance loss: 0.90108 
Train step: 760 acc:0.65752 total_loss: 1.2799  loss:1.0488,stance loss: 0.82919 
Train step: 770 acc:0.65557 total_loss: 1.2795  loss:1.6542,stance loss: 1.6978 
Train step: 780 acc:0.65716 total_loss: 1.2799  loss:1.3866,stance loss: 0.97475 
Better F1! Saving model!
Saving model of best f1: 0.05865102639296187
              precision    recall  f1-score   support

           0   0.063492  0.769231  0.117302        26
           1   0.738956  0.906404  0.814159       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.361702       564
   macro avg   0.267483  0.558545  0.310487       564
weighted avg   0.268899  0.361702  0.298447       564

Test Acc: 0.3617021276595745 F1_ma:0.05865102639296187
Train step: 790 acc:0.65463 total_loss: 1.2844  loss:1.4782,stance loss: 1.0545 
Train step: 800 acc:0.65445 total_loss: 1.2815  loss:1.2236,stance loss: 0.87209 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.6875 total_loss: 1.075  loss:1.075,stance loss: 0.63767 
Train step: 820 acc:0.6875 total_loss: 1.1364  loss:1.4119,stance loss: 1.0632 
Train step: 830 acc:0.68452 total_loss: 1.13  loss:1.3472,stance loss: 1.0474 
Train step: 840 acc:0.66734 total_loss: 1.1915  loss:1.2884,stance loss: 0.98742 
Train step: 850 acc:0.65549 total_loss: 1.2336  loss:1.1497,stance loss: 0.87931 
Train step: 860 acc:0.65931 total_loss: 1.2322  loss:1.307,stance loss: 1.4212 
Train step: 870 acc:0.66393 total_loss: 1.2151  loss:1.0965,stance loss: 0.81264 
Train step: 880 acc:0.66461 total_loss: 1.2193  loss:1.3742,stance loss: 1.0768 
Train step: 890 acc:0.65818 total_loss: 1.2279  loss:1.6007,stance loss: 1.6691 
Train step: 900 acc:0.65797 total_loss: 1.225  loss:1.5218,stance loss: 1.1925 
Train step: 910 acc:0.65656 total_loss: 1.2246  loss:0.92308,stance loss: 0.67013 
Train step: 920 acc:0.66723 total_loss: 1.2109  loss:1.2252,stance loss: 0.9328 
Train step: 930 acc:0.66581 total_loss: 1.2103  loss:1.0039,stance loss: 0.65972 
Train step: 940 acc:0.66317 total_loss: 1.2205  loss:1.5707,stance loss: 1.1941 
Train step: 950 acc:0.66002 total_loss: 1.2242  loss:1.3081,stance loss: 1.0193 
Train step: 960 acc:0.6606 total_loss: 1.2277  loss:1.7359,stance loss: 1.6204 
Train step: 970 acc:0.66033 total_loss: 1.2228  loss:1.13,stance loss: 0.80999 
Train step: 980 acc:0.6652 total_loss: 1.2166  loss:1.0212,stance loss: 0.73671 
Train step: 990 acc:0.66575 total_loss: 1.2154  loss:1.1013,stance loss: 0.79684 
Train step: 1000 acc:0.66754 total_loss: 1.213  loss:1.4532,stance loss: 1.6758 
Train step: 1010 acc:0.66947 total_loss: 1.2075  loss:1.2385,stance loss: 0.871 
Train step: 1020 acc:0.66677 total_loss: 1.2108  loss:1.3032,stance loss: 0.98905 
Train step: 1030 acc:0.66686 total_loss: 1.2105  loss:1.3062,stance loss: 0.97835 
Train step: 1040 acc:0.66613 total_loss: 1.2097  loss:1.228,stance loss: 0.99978 
Train step: 1050 acc:0.66546 total_loss: 1.2162  loss:1.1557,stance loss: 0.86111 
Train step: 1060 acc:0.66833 total_loss: 1.2135  loss:1.267,stance loss: 0.90338 
Train step: 1070 acc:0.66978 total_loss: 1.211  loss:1.0302,stance loss: 0.589 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.8125 total_loss: 0.90648  loss:0.90648,stance loss: 0.61531 
Train step: 1090 acc:0.6875 total_loss: 1.0443  loss:1.0753,stance loss: 0.87785 
Train step: 1100 acc:0.66964 total_loss: 1.1849  loss:1.2039,stance loss: 0.95629 
Train step: 1110 acc:0.67944 total_loss: 1.1584  loss:1.2575,stance loss: 0.96467 
Train step: 1120 acc:0.69207 total_loss: 1.1368  loss:1.3965,stance loss: 1.0653 
Train step: 1130 acc:0.67402 total_loss: 1.1825  loss:1.1797,stance loss: 0.83866 
Train step: 1140 acc:0.67828 total_loss: 1.1796  loss:1.2862,stance loss: 0.90773 
Train step: 1150 acc:0.67165 total_loss: 1.1965  loss:1.3784,stance loss: 1.1138 
Train step: 1160 acc:0.6713 total_loss: 1.204  loss:1.3828,stance loss: 1.502 
Train step: 1170 acc:0.67445 total_loss: 1.1998  loss:1.1684,stance loss: 0.86467 
Train step: 1180 acc:0.67636 total_loss: 1.1938  loss:1.0351,stance loss: 0.6047 
Train step: 1190 acc:0.68018 total_loss: 1.1906  loss:1.1312,stance loss: 0.89482 
Train step: 1200 acc:0.68079 total_loss: 1.1898  loss:1.6812,stance loss: 1.4426 
Train step: 1210 acc:0.68177 total_loss: 1.191  loss:1.3381,stance loss: 1.0843 
Train step: 1220 acc:0.67686 total_loss: 1.1931  loss:1.5425,stance loss: 1.0759 
Train step: 1230 acc:0.68212 total_loss: 1.188  loss:1.1356,stance loss: 0.94705 
Train step: 1240 acc:0.68323 total_loss: 1.1866  loss:0.98232,stance loss: 0.75457 
Train step: 1250 acc:0.68385 total_loss: 1.1829  loss:1.1927,stance loss: 0.92964 
Train step: 1260 acc:0.68888 total_loss: 1.1722  loss:1.0674,stance loss: 1.2081 
Train step: 1270 acc:0.68717 total_loss: 1.1704  loss:1.234,stance loss: 0.89684 
Train step: 1280 acc:0.68719 total_loss: 1.1688  loss:0.98218,stance loss: 1.0797 
Train step: 1290 acc:0.6875 total_loss: 1.1645  loss:1.2085,stance loss: 0.85615 
Train step: 1300 acc:0.68948 total_loss: 1.1596  loss:1.5327,stance loss: 1.5492 
Train step: 1310 acc:0.69129 total_loss: 1.1562  loss:0.94556,stance loss: 0.70887 
Train step: 1320 acc:0.69113 total_loss: 1.1548  loss:1.3685,stance loss: 1.0342 
Train step: 1330 acc:0.69074 total_loss: 1.1619  loss:1.2234,stance loss: 1.0045 
Train step: 1340 acc:0.69229 total_loss: 1.1565  loss:1.3796,stance loss: 0.95788 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.875 total_loss: 0.69381  loss:0.69381,stance loss: 0.39588 
Train step: 1360 acc:0.73864 total_loss: 0.98486  loss:1.0886,stance loss: 0.77902 
Train step: 1370 acc:0.73214 total_loss: 1.0191  loss:1.4419,stance loss: 1.3833 
Train step: 1380 acc:0.71774 total_loss: 1.1127  loss:1.6576,stance loss: 1.7084 
Train step: 1390 acc:0.69817 total_loss: 1.1156  loss:1.3195,stance loss: 0.8356 
Train step: 1400 acc:0.69853 total_loss: 1.1101  loss:1.5264,stance loss: 1.1427 
Train step: 1410 acc:0.69877 total_loss: 1.1131  loss:1.0904,stance loss: 0.80968 
Train step: 1420 acc:0.6963 total_loss: 1.1037  loss:1.2166,stance loss: 0.99891 
Train step: 1430 acc:0.69907 total_loss: 1.1166  loss:1.5055,stance loss: 1.1544 
Train step: 1440 acc:0.69643 total_loss: 1.1161  loss:0.95146,stance loss: 0.78211 
Train step: 1450 acc:0.69554 total_loss: 1.1222  loss:1.0441,stance loss: 0.87284 
Train step: 1460 acc:0.69876 total_loss: 1.1164  loss:1.1569,stance loss: 0.88453 
Train step: 1470 acc:0.69938 total_loss: 1.1102  loss:1.2786,stance loss: 1.0827 
Train step: 1480 acc:0.69609 total_loss: 1.1119  loss:1.0686,stance loss: 0.86186 
Train step: 1490 acc:0.69592 total_loss: 1.1114  loss:1.199,stance loss: 0.91575 
Train step: 1500 acc:0.69412 total_loss: 1.1129  loss:0.9,stance loss: 0.62769 
Train step: 1510 acc:0.6941 total_loss: 1.1102  loss:1.171,stance loss: 1.0286 
Train step: 1520 acc:0.69737 total_loss: 1.1077  loss:0.94242,stance loss: 0.73458 
Train step: 1530 acc:0.69682 total_loss: 1.1065  loss:1.0221,stance loss: 0.83204 
Train step: 1540 acc:0.69666 total_loss: 1.1094  loss:0.90542,stance loss: 0.6695 
Train step: 1550 acc:0.69963 total_loss: 1.1073  loss:1.4229,stance loss: 2.07 
Train step: 1560 acc:0.70142 total_loss: 1.113  loss:1.1601,stance loss: 0.85079 
Train step: 1570 acc:0.70107 total_loss: 1.1139  loss:1.1026,stance loss: 0.85545 
Train step: 1580 acc:0.70157 total_loss: 1.1113  loss:1.0935,stance loss: 0.86614 
Train step: 1590 acc:0.70228 total_loss: 1.1097  loss:1.7265,stance loss: 1.902 
Train step: 1600 acc:0.70294 total_loss: 1.1068  loss:0.82281,stance loss: 0.57128 
Train step: 1610 acc:0.7033 total_loss: 1.1029  loss:1.1817,stance loss: 0.92006 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.625 total_loss: 1.371  loss:1.371,stance loss: 1.0478 
Train step: 1630 acc:0.73295 total_loss: 1.107  loss:1.1971,stance loss: 1.3163 
Train step: 1640 acc:0.70238 total_loss: 1.0687  loss:0.89976,stance loss: 0.59926 
Train step: 1650 acc:0.71976 total_loss: 1.0398  loss:1.3927,stance loss: 1.0926 
Train step: 1660 acc:0.71951 total_loss: 1.0441  loss:1.3838,stance loss: 1.4889 
Train step: 1670 acc:0.72672 total_loss: 1.0217  loss:0.96972,stance loss: 1.0889 
Train step: 1680 acc:0.73156 total_loss: 1.0199  loss:1.3847,stance loss: 1.5635 
Train step: 1690 acc:0.73239 total_loss: 1.0334  loss:0.91355,stance loss: 1.1236 
Train step: 1700 acc:0.73457 total_loss: 1.0325  loss:1.1914,stance loss: 0.95576 
Train step: 1710 acc:0.73352 total_loss: 1.0423  loss:0.90319,stance loss: 0.60842 
Train step: 1720 acc:0.7302 total_loss: 1.0429  loss:1.1555,stance loss: 1.3999 
Train step: 1730 acc:0.72635 total_loss: 1.0422  loss:1.097,stance loss: 0.90235 
Train step: 1740 acc:0.72469 total_loss: 1.0345  loss:0.73633,stance loss: 0.50602 
Train step: 1750 acc:0.72615 total_loss: 1.0291  loss:0.77969,stance loss: 0.47834 
Train step: 1760 acc:0.72651 total_loss: 1.0284  loss:1.0189,stance loss: 0.88178 
Train step: 1770 acc:0.72682 total_loss: 1.0284  loss:1.304,stance loss: 1.0739 
Train step: 1780 acc:0.72399 total_loss: 1.0235  loss:0.9126,stance loss: 0.60969 
Train step: 1790 acc:0.72551 total_loss: 1.0261  loss:0.68398,stance loss: 0.49201 
Train step: 1800 acc:0.72686 total_loss: 1.0145  loss:0.41304,stance loss: 0.18958 
Train step: 1810 acc:0.72808 total_loss: 1.015  loss:0.98841,stance loss: 1.1129 
Train step: 1820 acc:0.73134 total_loss: 1.0084  loss:1.0067,stance loss: 0.6288 
Train step: 1830 acc:0.73045 total_loss: 1.0097  loss:0.82411,stance loss: 0.67719 
Train step: 1840 acc:0.73162 total_loss: 1.0146  loss:1.1511,stance loss: 1.4333 
Train step: 1850 acc:0.73106 total_loss: 1.0157  loss:0.95516,stance loss: 0.85025 
Train step: 1860 acc:0.73211 total_loss: 1.0135  loss:0.94683,stance loss: 0.75094 
Train step: 1870 acc:0.73357 total_loss: 1.0143  loss:0.74564,stance loss: 0.52316 
Train step: 1880 acc:0.73252 total_loss: 1.0181  loss:1.1786,stance loss: 0.94928 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.8125 total_loss: 0.73133  loss:0.73133,stance loss: 0.52973 
Train step: 1900 acc:0.75568 total_loss: 0.87014  loss:1.2728,stance loss: 1.3151 
Train step: 1910 acc:0.76488 total_loss: 0.88303  loss:1.1588,stance loss: 1.2295 
Train step: 1920 acc:0.77621 total_loss: 0.86072  loss:1.142,stance loss: 0.95094 
Train step: 1930 acc:0.75762 total_loss: 0.89616  loss:1.0338,stance loss: 1.0496 
Train step: 1940 acc:0.75123 total_loss: 0.91637  loss:0.79583,stance loss: 0.59857 
Train step: 1950 acc:0.74283 total_loss: 0.92925  loss:1.1707,stance loss: 0.9192 
Train step: 1960 acc:0.74472 total_loss: 0.92927  loss:0.74123,stance loss: 0.54225 
Train step: 1970 acc:0.74228 total_loss: 0.93768  loss:1.1711,stance loss: 1.3552 
Train step: 1980 acc:0.74107 total_loss: 0.93837  loss:1.0656,stance loss: 0.85276 
Train step: 1990 acc:0.74443 total_loss: 0.94047  loss:1.0724,stance loss: 1.3519 
Train step: 2000 acc:0.73986 total_loss: 0.94695  loss:1.0189,stance loss: 0.84169 
Train step: 2010 acc:0.74483 total_loss: 0.94617  loss:0.84664,stance loss: 0.59353 
Train step: 2020 acc:0.74475 total_loss: 0.94858  loss:1.1945,stance loss: 1.0303 
Train step: 2030 acc:0.74424 total_loss: 0.94123  loss:0.74944,stance loss: 0.57788 
Train step: 2040 acc:0.74545 total_loss: 0.94461  loss:0.86443,stance loss: 0.63322 
Train step: 2050 acc:0.74612 total_loss: 0.94659  loss:1.0776,stance loss: 0.76654 
Train step: 2060 acc:0.74452 total_loss: 0.94988  loss:0.89665,stance loss: 0.65758 
Train step: 2070 acc:0.74655 total_loss: 0.95026  loss:1.0019,stance loss: 0.81837 
Train step: 2080 acc:0.75098 total_loss: 0.9438  loss:0.5966,stance loss: 0.37499 
Train step: 2090 acc:0.75342 total_loss: 0.94296  loss:0.83206,stance loss: 0.65205 
Train step: 2100 acc:0.75533 total_loss: 0.94272  loss:1.2312,stance loss: 1.3943 
Train step: 2110 acc:0.75509 total_loss: 0.94391  loss:0.612,stance loss: 0.48315 
Train step: 2120 acc:0.75541 total_loss: 0.93918  loss:0.67624,stance loss: 0.53485 
Train step: 2130 acc:0.75752 total_loss: 0.93802  loss:0.89644,stance loss: 0.96493 
Train step: 2140 acc:0.75573 total_loss: 0.94022  loss:0.7607,stance loss: 0.464 
Train step: 2150 acc:0.75623 total_loss: 0.93867  loss:0.924,stance loss: 0.87023 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.8125 total_loss: 0.78627  loss:0.78627,stance loss: 0.73795 
Train step: 2170 acc:0.73295 total_loss: 0.96926  loss:1.1522,stance loss: 1.0839 
Better F1! Saving model!
Saving model of best f1: 0.06423417290673929
              precision    recall  f1-score   support

           0   0.060201  0.692308  0.110769        26
           1   0.689655  0.886700  0.775862       203
           2   0.750000  0.008955  0.017699       335

    accuracy                       0.356383       564
   macro avg   0.499952  0.529321  0.301443       564
weighted avg   0.696481  0.356383  0.294874       564

Test Acc: 0.35638297872340424 F1_ma:0.06423417290673929
Train step: 2180 acc:0.75893 total_loss: 0.94648  loss:1.1266,stance loss: 0.88239 
Train step: 2190 acc:0.76815 total_loss: 0.91049  loss:0.62278,stance loss: 0.4085 
Train step: 2200 acc:0.77287 total_loss: 0.88393  loss:0.61053,stance loss: 0.42602 
Train step: 2210 acc:0.77451 total_loss: 0.86655  loss:0.74195,stance loss: 0.53088 
Train step: 2220 acc:0.77357 total_loss: 0.85368  loss:0.6523,stance loss: 0.42095 
Train step: 2230 acc:0.77465 total_loss: 0.84565  loss:0.5974,stance loss: 0.42429 
Better F1! Saving model!
Saving model of best f1: 0.06771077987695198
              precision    recall  f1-score   support

           0   0.068670  0.615385  0.123552        26
           1   0.571429  0.926108  0.706767       203
           2   1.000000  0.005970  0.011869       335

    accuracy                       0.365248       564
   macro avg   0.546699  0.515821  0.280729       564
weighted avg   0.802811  0.365248  0.267132       564

Test Acc: 0.36524822695035464 F1_ma:0.06771077987695198
Train step: 2240 acc:0.77778 total_loss: 0.85123  loss:1.0362,stance loss: 1.3096 
Train step: 2250 acc:0.77266 total_loss: 0.86552  loss:0.61282,stance loss: 0.42494 
Train step: 2260 acc:0.7698 total_loss: 0.8754  loss:0.99751,stance loss: 1.2353 
Train step: 2270 acc:0.76971 total_loss: 0.86378  loss:0.69057,stance loss: 0.49358 
Train step: 2280 acc:0.76653 total_loss: 0.87629  loss:0.85007,stance loss: 0.63242 
Better F1! Saving model!
Saving model of best f1: 0.09109897789143073
              precision    recall  f1-score   support

           0   0.055072  0.730769  0.102426        26
           1   0.773399  0.773399  0.773399       203
           2   0.875000  0.041791  0.079772       335

    accuracy                       0.336879       564
   macro avg   0.567824  0.515320  0.318532       564
weighted avg   0.800633  0.336879  0.330473       564

Test Acc: 0.33687943262411346 F1_ma:0.09109897789143073
Train step: 2290 acc:0.77052 total_loss: 0.87127  loss:0.8857,stance loss: 1.1118 
Train step: 2300 acc:0.76995 total_loss: 0.87181  loss:0.67203,stance loss: 0.47017 
Train step: 2310 acc:0.77028 total_loss: 0.86711  loss:0.92548,stance loss: 0.50096 
Train step: 2320 acc:0.76825 total_loss: 0.87824  loss:1.226,stance loss: 1.4456 
Train step: 2330 acc:0.76827 total_loss: 0.87811  loss:1.3799,stance loss: 1.1689 
Train step: 2340 acc:0.77141 total_loss: 0.87089  loss:0.94405,stance loss: 0.86478 
Train step: 2350 acc:0.77552 total_loss: 0.86383  loss:0.71259,stance loss: 1.0411 
Train step: 2360 acc:0.77674 total_loss: 0.86275  loss:0.42922,stance loss: 0.32081 
Train step: 2370 acc:0.77666 total_loss: 0.86684  loss:0.99348,stance loss: 0.77849 
Train step: 2380 acc:0.77828 total_loss: 0.86161  loss:0.83178,stance loss: 0.61669 
Train step: 2390 acc:0.77706 total_loss: 0.85914  loss:0.31106,stance loss: 0.078144 
Train step: 2400 acc:0.77723 total_loss: 0.85832  loss:0.58443,stance loss: 0.2857 
Train step: 2410 acc:0.77864 total_loss: 0.85702  loss:0.80144,stance loss: 1.0902 
Train step: 2420 acc:0.77993 total_loss: 0.8541  loss:0.64006,stance loss: 0.64061 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.875 total_loss: 0.74383  loss:0.74383,stance loss: 0.70272 
Train step: 2440 acc:0.83523 total_loss: 0.75983  loss:0.57298,stance loss: 0.29902 
Train step: 2450 acc:0.80952 total_loss: 0.79208  loss:0.90228,stance loss: 1.1572 
Train step: 2460 acc:0.79637 total_loss: 0.81987  loss:0.97105,stance loss: 1.1041 
Better F1! Saving model!
Saving model of best f1: 0.10834016057676552
              precision    recall  f1-score   support

           0   0.050125  0.769231  0.094118        26
           1   0.851064  0.591133  0.697674       203
           2   0.916667  0.065672  0.122563       335

    accuracy                       0.287234       564
   macro avg   0.605952  0.475345  0.304785       564
weighted avg   0.853107  0.287234  0.328251       564

Test Acc: 0.2872340425531915 F1_ma:0.10834016057676552
Train step: 2470 acc:0.80793 total_loss: 0.79449  loss:0.46458,stance loss: 0.31417 
Train step: 2480 acc:0.80392 total_loss: 0.79031  loss:0.46373,stance loss: 0.27619 
Train step: 2490 acc:0.80738 total_loss: 0.79274  loss:0.72475,stance loss: 0.7038 
Train step: 2500 acc:0.80634 total_loss: 0.76125  loss:0.4087,stance loss: 0.25914 
Train step: 2510 acc:0.81173 total_loss: 0.76267  loss:0.63978,stance loss: 0.46888 
Train step: 2520 acc:0.80907 total_loss: 0.75522  loss:0.61721,stance loss: 0.40981 
Train step: 2530 acc:0.80817 total_loss: 0.74963  loss:0.52127,stance loss: 0.3166 
Train step: 2540 acc:0.81025 total_loss: 0.74232  loss:0.60872,stance loss: 0.41647 
Train step: 2550 acc:0.80733 total_loss: 0.73937  loss:0.98989,stance loss: 0.60647 
Train step: 2560 acc:0.80868 total_loss: 0.7334  loss:0.63402,stance loss: 0.46216 
Train step: 2570 acc:0.80895 total_loss: 0.73303  loss:1.1764,stance loss: 1.115 
Better F1! Saving model!
Saving model of best f1: 0.11479117320379514
              precision    recall  f1-score   support

           0   0.051546  0.769231  0.096618        26
           1   0.846667  0.625616  0.719547       203
           2   0.923077  0.071642  0.132964       335

    accuracy                       0.303191       564
   macro avg   0.607097  0.488829  0.316376       564
weighted avg   0.855398  0.303191  0.342417       564

Test Acc: 0.30319148936170215 F1_ma:0.11479117320379514
Train step: 2580 acc:0.80671 total_loss: 0.74384  loss:0.76174,stance loss: 0.73984 
Train step: 2590 acc:0.80668 total_loss: 0.74365  loss:0.47291,stance loss: 0.30627 
Train step: 2600 acc:0.80665 total_loss: 0.74651  loss:0.39506,stance loss: 0.25303 
Better F1! Saving model!
Saving model of best f1: 0.11957054983206913
              precision    recall  f1-score   support

           0   0.050971  0.807692  0.095890        26
           1   0.895161  0.546798  0.678899       203
           2   0.928571  0.077612  0.143251       335

    accuracy                       0.280142       564
   macro avg   0.624901  0.477367  0.306013       564
weighted avg   0.876089  0.280142  0.333863       564

Test Acc: 0.2801418439716312 F1_ma:0.11957054983206913
Train step: 2610 acc:0.80663 total_loss: 0.74517  loss:1.0829,stance loss: 0.91187 
Train step: 2620 acc:0.80432 total_loss: 0.75196  loss:0.56565,stance loss: 0.42506 
Train step: 2630 acc:0.80348 total_loss: 0.75357  loss:1.1488,stance loss: 0.8017 
Train step: 2640 acc:0.80539 total_loss: 0.751  loss:0.62389,stance loss: 0.52727 
Train step: 2650 acc:0.80515 total_loss: 0.75499  loss:0.55425,stance loss: 0.48735 
Train step: 2660 acc:0.80519 total_loss: 0.75301  loss:0.71047,stance loss: 0.54187 
Better F1! Saving model!
Saving model of best f1: 0.12493567902093039
              precision    recall  f1-score   support

           0   0.051630  0.730769  0.096447        26
           1   0.813253  0.665025  0.731707       203
           2   0.933333  0.083582  0.153425       335

    accuracy                       0.322695       564
   macro avg   0.599406  0.493125  0.327193       564
weighted avg   0.849467  0.322695  0.358939       564

Test Acc: 0.32269503546099293 F1_ma:0.12493567902093039
Train step: 2670 acc:0.80394 total_loss: 0.75444  loss:0.93898,stance loss: 1.2448 
Better F1! Saving model!
Saving model of best f1: 0.14686379928315413
              precision    recall  f1-score   support

           0   0.056886  0.730769  0.105556        26
           1   0.782383  0.743842  0.762626       203
           2   0.945946  0.104478  0.188172       335

    accuracy                       0.363475       564
   macro avg   0.595072  0.526363  0.352118       564
weighted avg   0.846090  0.363475  0.391126       564

Test Acc: 0.36347517730496454 F1_ma:0.14686379928315413
Train step: 2680 acc:0.80503 total_loss: 0.75543  loss:0.49208,stance loss: 0.40874 
Train step: 2690 acc:0.80723 total_loss: 0.75306  loss:0.57237,stance loss: 0.38681 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:1.0 total_loss: 0.71756  loss:0.71756,stance loss: 1.0348 
Train step: 2710 acc:0.84659 total_loss: 0.6492  loss:0.74525,stance loss: 0.68264 
Better F1! Saving model!
Saving model of best f1: 0.15904139433551198
              precision    recall  f1-score   support

           0   0.057402  0.730769  0.106443        26
           1   0.794737  0.743842  0.768448       203
           2   0.930233  0.119403  0.211640       335

    accuracy                       0.372340       564
   macro avg   0.594124  0.531338  0.362177       564
weighted avg   0.841227  0.372340  0.407202       564

Test Acc: 0.3723404255319149 F1_ma:0.15904139433551198
Train step: 2720 acc:0.8244 total_loss: 0.67516  loss:0.91199,stance loss: 1.1455 
Train step: 2730 acc:0.83065 total_loss: 0.65892  loss:0.67102,stance loss: 0.51153 
Train step: 2740 acc:0.82165 total_loss: 0.68353  loss:0.46495,stance loss: 0.39308 
Train step: 2750 acc:0.83211 total_loss: 0.66031  loss:0.78696,stance loss: 0.70978 
Train step: 2760 acc:0.83504 total_loss: 0.68026  loss:0.71969,stance loss: 1.0541 
Train step: 2770 acc:0.84155 total_loss: 0.66627  loss:0.35808,stance loss: 0.1652 
Train step: 2780 acc:0.83796 total_loss: 0.66256  loss:0.65968,stance loss: 0.54637 
Train step: 2790 acc:0.83654 total_loss: 0.66409  loss:1.0529,stance loss: 0.82407 
Better F1! Saving model!
Saving model of best f1: 0.1685058519531844
              precision    recall  f1-score   support

           0   0.050955  0.615385  0.094118        26
           1   0.777778  0.758621  0.768080       203
           2   0.903846  0.140299  0.242894       335

    accuracy                       0.384752       564
   macro avg   0.577526  0.504768  0.368364       564
weighted avg   0.819153  0.384752  0.425065       564

Test Acc: 0.38475177304964536 F1_ma:0.1685058519531844
Train step: 2800 acc:0.83601 total_loss: 0.6588  loss:0.57011,stance loss: 0.62394 
Train step: 2810 acc:0.83559 total_loss: 0.66488  loss:0.73341,stance loss: 0.68318 
Better F1! Saving model!
Saving model of best f1: 0.21163019079685746
              precision    recall  f1-score   support

           0   0.055215  0.692308  0.102273        26
           1   0.815476  0.674877  0.738544       203
           2   0.928571  0.194030  0.320988       335

    accuracy                       0.390071       564
   macro avg   0.599754  0.520405  0.387268       564
weighted avg   0.847604  0.390071  0.461196       564

Test Acc: 0.3900709219858156 F1_ma:0.21163019079685746
Train step: 2820 acc:0.83678 total_loss: 0.66156  loss:0.42926,stance loss: 0.25287 
Train step: 2830 acc:0.83826 total_loss: 0.66135  loss:0.75462,stance loss: 0.56575 
Train step: 2840 acc:0.83688 total_loss: 0.66977  loss:0.3863,stance loss: 0.25451 
Train step: 2850 acc:0.83444 total_loss: 0.67335  loss:0.52806,stance loss: 0.37004 
Train step: 2860 acc:0.83502 total_loss: 0.67122  loss:0.51496,stance loss: 0.38322 
Train step: 2870 acc:0.83589 total_loss: 0.66904  loss:0.60868,stance loss: 0.34673 
Train step: 2880 acc:0.83529 total_loss: 0.66432  loss:0.47844,stance loss: 0.37892 
Train step: 2890 acc:0.83508 total_loss: 0.66704  loss:0.83426,stance loss: 0.85154 
Train step: 2900 acc:0.83396 total_loss: 0.67466  loss:0.84547,stance loss: 1.0529 
Train step: 2910 acc:0.83235 total_loss: 0.68153  loss:0.79545,stance loss: 1.1617 
Better F1! Saving model!
Saving model of best f1: 0.2658064113952655
              precision    recall  f1-score   support

           0   0.056180  0.576923  0.102389        26
           1   0.783505  0.748768  0.765743       203
           2   0.912621  0.280597  0.429224       335

    accuracy                       0.462766       564
   macro avg   0.584102  0.535430  0.432452       564
weighted avg   0.826667  0.462766  0.535280       564

Test Acc: 0.4627659574468085 F1_ma:0.2658064113952655
Train step: 2920 acc:0.83117 total_loss: 0.68636  loss:0.52189,stance loss: 0.32545 
Train step: 2930 acc:0.83279 total_loss: 0.68484  loss:0.83906,stance loss: 1.0827 
Train step: 2940 acc:0.83377 total_loss: 0.68504  loss:0.536,stance loss: 0.49479 
Train step: 2950 acc:0.83566 total_loss: 0.6779  loss:0.64012,stance loss: 0.52464 
Train step: 2960 acc:0.83381 total_loss: 0.67983  loss:0.60296,stance loss: 0.5051 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.8125 total_loss: 0.65452  loss:0.65452,stance loss: 0.50205 
Train step: 2980 acc:0.875 total_loss: 0.58251  loss:0.61205,stance loss: 0.30593 
Train step: 2990 acc:0.86607 total_loss: 0.62859  loss:0.86631,stance loss: 0.61319 
Train step: 3000 acc:0.86694 total_loss: 0.6002  loss:0.65633,stance loss: 0.53739 
Train step: 3010 acc:0.85366 total_loss: 0.63494  loss:0.57407,stance loss: 0.47368 
Train step: 3020 acc:0.84804 total_loss: 0.63776  loss:0.68956,stance loss: 0.55935 
Train step: 3030 acc:0.85246 total_loss: 0.63722  loss:1.1456,stance loss: 0.98377 
Train step: 3040 acc:0.85299 total_loss: 0.63094  loss:0.48328,stance loss: 0.3453 
Train step: 3050 acc:0.85494 total_loss: 0.6433  loss:0.74984,stance loss: 0.55107 
Train step: 3060 acc:0.85165 total_loss: 0.63857  loss:0.4378,stance loss: 0.29175 
Train step: 3070 acc:0.85149 total_loss: 0.63524  loss:1.4579,stance loss: 1.7731 
Train step: 3080 acc:0.85023 total_loss: 0.63276  loss:0.6707,stance loss: 0.3518 
Train step: 3090 acc:0.85434 total_loss: 0.62614  loss:0.76492,stance loss: 0.55297 
Train step: 3100 acc:0.85401 total_loss: 0.62877  loss:0.44441,stance loss: 0.44806 
Train step: 3110 acc:0.85417 total_loss: 0.6288  loss:0.43108,stance loss: 0.29953 
Train step: 3120 acc:0.85679 total_loss: 0.62858  loss:0.50009,stance loss: 0.40361 
Train step: 3130 acc:0.85598 total_loss: 0.6252  loss:0.36852,stance loss: 0.35121 
Train step: 3140 acc:0.85599 total_loss: 0.63124  loss:0.75434,stance loss: 1.0436 
Train step: 3150 acc:0.85394 total_loss: 0.62886  loss:0.65756,stance loss: 0.48312 
Train step: 3160 acc:0.85209 total_loss: 0.63669  loss:0.76546,stance loss: 0.57171 
Better F1! Saving model!
Saving model of best f1: 0.285897616346942
              precision    recall  f1-score   support

           0   0.057613  0.538462  0.104089        26
           1   0.743961  0.758621  0.751220       203
           2   0.921053  0.313433  0.467706       335

    accuracy                       0.484043       564
   macro avg   0.574209  0.536838  0.441005       564
weighted avg   0.817508  0.484043  0.552988       564

Test Acc: 0.48404255319148937 F1_ma:0.285897616346942
Train step: 3170 acc:0.85292 total_loss: 0.63207  loss:0.30701,stance loss: 0.20009 
Train step: 3180 acc:0.85338 total_loss: 0.62909  loss:0.46378,stance loss: 0.37743 
Train step: 3190 acc:0.85351 total_loss: 0.63201  loss:0.44618,stance loss: 0.25498 
Train step: 3200 acc:0.85308 total_loss: 0.63814  loss:0.9321,stance loss: 0.68358 
Train step: 3210 acc:0.85322 total_loss: 0.63883  loss:0.3137,stance loss: 0.11818 
Train step: 3220 acc:0.85433 total_loss: 0.6358  loss:0.80387,stance loss: 1.2517 
Train step: 3230 acc:0.8556 total_loss: 0.63315  loss:0.83588,stance loss: 1.28 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.6875 total_loss: 1.0979  loss:1.0979,stance loss: 0.75797 
Train step: 3250 acc:0.85227 total_loss: 0.64822  loss:0.70384,stance loss: 1.0764 
Train step: 3260 acc:0.86607 total_loss: 0.64834  loss:0.93685,stance loss: 1.0843 
Train step: 3270 acc:0.875 total_loss: 0.58779  loss:0.49922,stance loss: 0.46905 
Train step: 3280 acc:0.87043 total_loss: 0.59082  loss:1.1123,stance loss: 1.252 
Train step: 3290 acc:0.88113 total_loss: 0.56912  loss:0.63474,stance loss: 0.67988 
Train step: 3300 acc:0.88525 total_loss: 0.56606  loss:0.4965,stance loss: 0.32611 
Train step: 3310 acc:0.88556 total_loss: 0.57746  loss:0.85117,stance loss: 1.145 
Train step: 3320 acc:0.8858 total_loss: 0.57135  loss:0.40126,stance loss: 0.25875 
Better F1! Saving model!
Saving model of best f1: 0.2880282301217713
              precision    recall  f1-score   support

           0   0.056738  0.615385  0.103896        26
           1   0.803571  0.665025  0.727763       203
           2   0.929825  0.316418  0.472160       335

    accuracy                       0.455674       564
   macro avg   0.596711  0.532276  0.434606       564
weighted avg   0.844134  0.455674  0.547182       564

Test Acc: 0.45567375886524825 F1_ma:0.2880282301217713
Train step: 3330 acc:0.88874 total_loss: 0.56323  loss:0.81115,stance loss: 1.1396 
Train step: 3340 acc:0.888 total_loss: 0.56921  loss:0.46761,stance loss: 0.32922 
Train step: 3350 acc:0.8857 total_loss: 0.58124  loss:1.0367,stance loss: 1.3613 
Train step: 3360 acc:0.88585 total_loss: 0.57625  loss:0.36645,stance loss: 0.22987 
Train step: 3370 acc:0.88597 total_loss: 0.58001  loss:1.5803,stance loss: 1.9679 
Train step: 3380 acc:0.88475 total_loss: 0.58148  loss:1.3819,stance loss: 2.0859 
Train step: 3390 acc:0.88535 total_loss: 0.5766  loss:0.39575,stance loss: 0.33335 
Train step: 3400 acc:0.88742 total_loss: 0.57737  loss:0.71927,stance loss: 1.0484 
Train step: 3410 acc:0.88779 total_loss: 0.57388  loss:0.34315,stance loss: 0.18478 
Train step: 3420 acc:0.88432 total_loss: 0.57899  loss:0.60174,stance loss: 0.4376 
Train step: 3430 acc:0.88449 total_loss: 0.57449  loss:0.22165,stance loss: 0.084994 
Train step: 3440 acc:0.88433 total_loss: 0.57999  loss:0.73933,stance loss: 1.1014 
Train step: 3450 acc:0.88596 total_loss: 0.57203  loss:0.21742,stance loss: 0.13003 
Train step: 3460 acc:0.88546 total_loss: 0.57001  loss:1.1666,stance loss: 1.5938 
Train step: 3470 acc:0.88447 total_loss: 0.5647  loss:0.68438,stance loss: 0.58198 
Train step: 3480 acc:0.88434 total_loss: 0.56502  loss:0.63251,stance loss: 0.56641 
Train step: 3490 acc:0.88446 total_loss: 0.56179  loss:0.40479,stance loss: 0.34171 
Train step: 3500 acc:0.88578 total_loss: 0.55951  loss:0.17096,stance loss: 0.0018947 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.875 total_loss: 0.4877  loss:0.4877,stance loss: 0.35528 
Train step: 3520 acc:0.90909 total_loss: 0.46288  loss:0.8441,stance loss: 0.77778 
Train step: 3530 acc:0.91667 total_loss: 0.44254  loss:0.33008,stance loss: 0.25763 
Train step: 3540 acc:0.90726 total_loss: 0.46062  loss:0.64348,stance loss: 0.23589 
Train step: 3550 acc:0.90701 total_loss: 0.49729  loss:1.2208,stance loss: 1.5718 
Train step: 3560 acc:0.91054 total_loss: 0.47872  loss:0.15261,stance loss: 0.066506 
Train step: 3570 acc:0.91189 total_loss: 0.45841  loss:0.31013,stance loss: 0.24202 
Train step: 3580 acc:0.91549 total_loss: 0.44783  loss:0.72447,stance loss: 1.0512 
Train step: 3590 acc:0.91358 total_loss: 0.4535  loss:0.48172,stance loss: 0.42795 
Train step: 3600 acc:0.91552 total_loss: 0.44471  loss:0.11758,stance loss: 0.034908 
Train step: 3610 acc:0.91522 total_loss: 0.44455  loss:0.62821,stance loss: 0.4547 
Train step: 3620 acc:0.91667 total_loss: 0.44497  loss:0.21421,stance loss: 0.15557 
Train step: 3630 acc:0.91581 total_loss: 0.4519  loss:0.47359,stance loss: 0.41358 
Train step: 3640 acc:0.91651 total_loss: 0.4558  loss:0.70765,stance loss: 1.1435 
Train step: 3650 acc:0.91667 total_loss: 0.45884  loss:0.8133,stance loss: 0.72784 
Train step: 3660 acc:0.91515 total_loss: 0.46805  loss:0.84638,stance loss: 0.71489 
Train step: 3670 acc:0.91343 total_loss: 0.47108  loss:0.45725,stance loss: 0.44537 
Train step: 3680 acc:0.91155 total_loss: 0.47307  loss:0.72906,stance loss: 0.53603 
Train step: 3690 acc:0.90988 total_loss: 0.47108  loss:0.30103,stance loss: 0.24143 
Train step: 3700 acc:0.9074 total_loss: 0.47003  loss:0.61123,stance loss: 0.45318 
Train step: 3710 acc:0.90672 total_loss: 0.46922  loss:0.45902,stance loss: 0.34095 
Train step: 3720 acc:0.90551 total_loss: 0.46913  loss:0.23698,stance loss: 0.22563 
Train step: 3730 acc:0.90724 total_loss: 0.46987  loss:0.23305,stance loss: 0.19598 
Train step: 3740 acc:0.90855 total_loss: 0.47353  loss:0.36122,stance loss: 0.34154 
Train step: 3750 acc:0.90871 total_loss: 0.47235  loss:0.36962,stance loss: 0.27869 
Train step: 3760 acc:0.90837 total_loss: 0.47506  loss:0.60391,stance loss: 1.0145 
Train step: 3770 acc:0.90781 total_loss: 0.47561  loss:0.52609,stance loss: 0.4139 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:1.0 total_loss: 0.65235  loss:0.65235,stance loss: 1.047 
Train step: 3790 acc:0.90341 total_loss: 0.56874  loss:0.074639,stance loss: 0.017868 
Train step: 3800 acc:0.91964 total_loss: 0.47953  loss:0.54582,stance loss: 0.41094 
Train step: 3810 acc:0.93145 total_loss: 0.4578  loss:0.16674,stance loss: 0.071872 
Train step: 3820 acc:0.92835 total_loss: 0.4464  loss:0.093975,stance loss: 0.048085 
Train step: 3830 acc:0.9326 total_loss: 0.43128  loss:0.30632,stance loss: 0.23999 
Train step: 3840 acc:0.9293 total_loss: 0.41607  loss:0.40448,stance loss: 0.30338 
Train step: 3850 acc:0.92782 total_loss: 0.41955  loss:0.32295,stance loss: 0.24053 
Train step: 3860 acc:0.92747 total_loss: 0.41171  loss:0.13433,stance loss: 0.088535 
Train step: 3870 acc:0.92651 total_loss: 0.40898  loss:0.36162,stance loss: 0.0976 
Train step: 3880 acc:0.9245 total_loss: 0.4223  loss:0.89523,stance loss: 1.2087 
Train step: 3890 acc:0.92342 total_loss: 0.42377  loss:0.56562,stance loss: 1.008 
Train step: 3900 acc:0.92149 total_loss: 0.42332  loss:0.26169,stance loss: 0.18989 
Train step: 3910 acc:0.92271 total_loss: 0.41849  loss:0.38666,stance loss: 0.33908 
Train step: 3920 acc:0.92243 total_loss: 0.41295  loss:0.27756,stance loss: 0.18938 
Train step: 3930 acc:0.9226 total_loss: 0.41774  loss:0.6882,stance loss: 1.1033 
Train step: 3940 acc:0.92314 total_loss: 0.41993  loss:0.77864,stance loss: 1.252 
Train step: 3950 acc:0.92142 total_loss: 0.4222  loss:0.20099,stance loss: 0.16406 
Train step: 3960 acc:0.92058 total_loss: 0.42337  loss:0.23919,stance loss: 0.15432 
Train step: 3970 acc:0.92147 total_loss: 0.42073  loss:0.66624,stance loss: 1.0128 
Train step: 3980 acc:0.92226 total_loss: 0.42057  loss:0.076931,stance loss: 0.0092078 
Train step: 3990 acc:0.9215 total_loss: 0.42394  loss:0.66925,stance loss: 0.58617 
Train step: 4000 acc:0.92081 total_loss: 0.42031  loss:0.28688,stance loss: 0.26722 
Train step: 4010 acc:0.92127 total_loss: 0.41696  loss:0.77044,stance loss: 1.1681 
Train step: 4020 acc:0.92194 total_loss: 0.41566  loss:0.067567,stance loss: 0.0038565 
Train step: 4030 acc:0.92356 total_loss: 0.40938  loss:0.11262,stance loss: 0.020284 
Train step: 4040 acc:0.92409 total_loss: 0.4091  loss:0.1441,stance loss: 0.053842 
Training finished.


Reload the best model with best f1 0.2880282301217713 from path test_outputs/bert-cross-topic/cc/2023-08-14 16-00-23/state_dict


              precision    recall  f1-score   support

           0   0.056738  0.615385  0.103896        26
           1   0.803571  0.665025  0.727763       203
           2   0.929825  0.316418  0.472160       335

    accuracy                       0.455674       564
   macro avg   0.596711  0.532276  0.434606       564
weighted avg   0.844134  0.455674  0.547182       564

Test Acc: 0.45567375886524825 F1_ma:0.2880282301217713
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.2880282301217713
acc: 0.45567375886524825, f1 :0.43460642115934806
classification report: 
              precision    recall  f1-score   support

         Con     0.0567    0.6154    0.1039        26
        None     0.8036    0.6650    0.7278       203
         Pro     0.9298    0.3164    0.4722       335

    accuracy                         0.4557       564
   macro avg     0.5967    0.5323    0.4346       564
weighted avg     0.8441    0.4557    0.5472       564

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 16-17-57', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 16-17-57
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 2.0028  loss:2.0028,stance loss: 1.5627 
Train step: 10 acc:0.23295 total_loss: 1.8166  loss:1.7848,stance loss: 1.2008 
Train step: 20 acc:0.28869 total_loss: 1.7439  loss:1.6489,stance loss: 1.115 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 30 acc:0.35685 total_loss: 1.7252  loss:1.5997,stance loss: 1.1271 
Train step: 40 acc:0.41159 total_loss: 1.6954  loss:1.6779,stance loss: 1.2298 
Train step: 50 acc:0.43627 total_loss: 1.6801  loss:1.6757,stance loss: 1.6302 
Train step: 60 acc:0.4457 total_loss: 1.6705  loss:1.7779,stance loss: 1.2263 
Train step: 70 acc:0.45687 total_loss: 1.6559  loss:1.526,stance loss: 1.0449 
Train step: 80 acc:0.47454 total_loss: 1.651  loss:1.7828,stance loss: 1.6983 
Train step: 90 acc:0.48626 total_loss: 1.6404  loss:1.8193,stance loss: 1.7721 
Train step: 100 acc:0.49505 total_loss: 1.6375  loss:1.48,stance loss: 1.0854 
Train step: 110 acc:0.5045 total_loss: 1.6331  loss:1.5421,stance loss: 1.1422 
Train step: 120 acc:0.51291 total_loss: 1.632  loss:1.7906,stance loss: 1.7384 
Train step: 130 acc:0.51908 total_loss: 1.6208  loss:1.4457,stance loss: 1.0594 
Train step: 140 acc:0.52083 total_loss: 1.6174  loss:1.2344,stance loss: 0.90369 
Train step: 150 acc:0.51863 total_loss: 1.6219  loss:1.8551,stance loss: 1.7474 
Train step: 160 acc:0.52252 total_loss: 1.6128  loss:1.5321,stance loss: 1.0915 
Train step: 170 acc:0.52303 total_loss: 1.6136  loss:1.7866,stance loss: 1.7661 
Train step: 180 acc:0.52417 total_loss: 1.6155  loss:1.9117,stance loss: 1.1945 
Train step: 190 acc:0.52421 total_loss: 1.6145  loss:1.4859,stance loss: 1.0904 
Train step: 200 acc:0.52674 total_loss: 1.6133  loss:1.7636,stance loss: 1.6961 
Train step: 210 acc:0.5311 total_loss: 1.6096  loss:1.2641,stance loss: 0.71858 
Train step: 220 acc:0.52885 total_loss: 1.6112  loss:1.4578,stance loss: 1.0937 
Train step: 230 acc:0.53301 total_loss: 1.6076  loss:1.8192,stance loss: 1.1967 
Train step: 240 acc:0.53008 total_loss: 1.6111  loss:1.3883,stance loss: 0.76683 
Train step: 250 acc:0.53038 total_loss: 1.611  loss:1.5855,stance loss: 1.1795 
Train step: 260 acc:0.53137 total_loss: 1.6109  loss:1.5623,stance loss: 1.1103 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.4375 total_loss: 1.6734  loss:1.6734,stance loss: 1.1934 
Train step: 280 acc:0.60227 total_loss: 1.5328  loss:1.5486,stance loss: 1.1426 
Train step: 290 acc:0.56845 total_loss: 1.5624  loss:1.7537,stance loss: 1.2464 
Train step: 300 acc:0.56048 total_loss: 1.5592  loss:1.2319,stance loss: 0.73459 
Train step: 310 acc:0.54268 total_loss: 1.5902  loss:1.6768,stance loss: 1.1871 
Train step: 320 acc:0.54167 total_loss: 1.591  loss:1.7133,stance loss: 1.2341 
Train step: 330 acc:0.53279 total_loss: 1.6036  loss:1.855,stance loss: 1.7503 
Train step: 340 acc:0.53081 total_loss: 1.599  loss:1.6895,stance loss: 1.2156 
Train step: 350 acc:0.53781 total_loss: 1.5921  loss:1.5765,stance loss: 1.1097 
Train step: 360 acc:0.54052 total_loss: 1.5879  loss:1.5319,stance loss: 1.0858 
Train step: 370 acc:0.54208 total_loss: 1.5851  loss:1.4641,stance loss: 1.0663 
Train step: 380 acc:0.54392 total_loss: 1.5862  loss:1.6769,stance loss: 1.1283 
Train step: 390 acc:0.54649 total_loss: 1.5863  loss:1.4599,stance loss: 1.057 
Train step: 400 acc:0.54914 total_loss: 1.5782  loss:1.2571,stance loss: 0.86191 
Train step: 410 acc:0.55009 total_loss: 1.5731  loss:1.5757,stance loss: 1.2264 
Train step: 420 acc:0.55008 total_loss: 1.5743  loss:1.8975,stance loss: 1.8292 
Train step: 430 acc:0.54775 total_loss: 1.574  loss:1.6953,stance loss: 1.2468 
Train step: 440 acc:0.54861 total_loss: 1.5744  loss:1.4142,stance loss: 1.016 
Train step: 450 acc:0.55076 total_loss: 1.5736  loss:1.4297,stance loss: 1.0291 
Train step: 460 acc:0.55137 total_loss: 1.5741  loss:1.6398,stance loss: 1.1333 
Train step: 470 acc:0.55442 total_loss: 1.5705  loss:1.7321,stance loss: 1.1774 
Train step: 480 acc:0.55421 total_loss: 1.5685  loss:1.5792,stance loss: 1.2219 
Train step: 490 acc:0.55458 total_loss: 1.5716  loss:1.8324,stance loss: 1.2404 
Train step: 500 acc:0.55384 total_loss: 1.5711  loss:1.7128,stance loss: 1.427 
Train step: 510 acc:0.55628 total_loss: 1.5688  loss:1.5863,stance loss: 1.3387 
Train step: 520 acc:0.55677 total_loss: 1.5681  loss:1.3037,stance loss: 0.88319 
Train step: 530 acc:0.55603 total_loss: 1.5669  loss:1.6621,stance loss: 1.2643 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.375 total_loss: 1.4864  loss:1.4864,stance loss: 1.0051 
Better F1! Saving model!
Saving model of best f1: 0.044142614601018676
              precision    recall  f1-score   support

           0   0.046181  1.000000  0.088285        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015394  0.333333  0.029428       564
weighted avg   0.002129  0.046099  0.004070       564

Test Acc: 0.04609929078014184 F1_ma:0.044142614601018676
Train step: 550 acc:0.54545 total_loss: 1.5181  loss:1.5526,stance loss: 1.0337 
Train step: 560 acc:0.55655 total_loss: 1.5178  loss:1.6196,stance loss: 1.2088 
Better F1! Saving model!
Saving model of best f1: 0.04452054794520548
              precision    recall  f1-score   support

           0   0.046595  1.000000  0.089041        26
           1   0.333333  0.009852  0.019139       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.049645       564
   macro avg   0.126643  0.336617  0.036060       564
weighted avg   0.122124  0.049645  0.010993       564

Test Acc: 0.04964539007092199 F1_ma:0.04452054794520548
Train step: 570 acc:0.57258 total_loss: 1.496  loss:1.5085,stance loss: 1.2187 
Train step: 580 acc:0.57317 total_loss: 1.5119  loss:1.9042,stance loss: 1.807 
Train step: 590 acc:0.5674 total_loss: 1.5013  loss:1.2921,stance loss: 0.93836 
Train step: 600 acc:0.57172 total_loss: 1.5055  loss:1.8855,stance loss: 1.7944 
Train step: 610 acc:0.5757 total_loss: 1.5026  loss:1.7147,stance loss: 1.6682 
Train step: 620 acc:0.5787 total_loss: 1.4938  loss:1.2842,stance loss: 1.0112 
Train step: 630 acc:0.57349 total_loss: 1.4973  loss:1.7606,stance loss: 1.3258 
Train step: 640 acc:0.56807 total_loss: 1.499  loss:1.4018,stance loss: 1.4198 
Train step: 650 acc:0.57207 total_loss: 1.4852  loss:1.5191,stance loss: 1.0312 
Train step: 660 acc:0.57076 total_loss: 1.4759  loss:1.1991,stance loss: 0.81248 
Train step: 670 acc:0.56918 total_loss: 1.4814  loss:1.4153,stance loss: 0.9111 
Train step: 680 acc:0.57225 total_loss: 1.4808  loss:1.7661,stance loss: 1.8054 
Train step: 690 acc:0.57078 total_loss: 1.4826  loss:1.4886,stance loss: 1.1561 
Train step: 700 acc:0.57026 total_loss: 1.4817  loss:1.4319,stance loss: 1.1654 
Better F1! Saving model!
Saving model of best f1: 0.04553415061295973
              precision    recall  f1-score   support

           0   0.047706  1.000000  0.091068        26
           1   0.473684  0.044335  0.081081       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.062057       564
   macro avg   0.173797  0.348112  0.057383       564
weighted avg   0.172692  0.062057  0.033382       564

Test Acc: 0.06205673758865248 F1_ma:0.04553415061295973
Train step: 710 acc:0.56835 total_loss: 1.4756  loss:1.4186,stance loss: 1.0014 
Train step: 720 acc:0.56837 total_loss: 1.4803  loss:1.3562,stance loss: 1.4203 
Train step: 730 acc:0.57166 total_loss: 1.4753  loss:1.7375,stance loss: 1.4724 
Train step: 740 acc:0.5709 total_loss: 1.472  loss:1.3161,stance loss: 1.0031 
Train step: 750 acc:0.57227 total_loss: 1.4687  loss:1.2676,stance loss: 0.9057 
Train step: 760 acc:0.57579 total_loss: 1.4625  loss:1.2428,stance loss: 0.87512 
Train step: 770 acc:0.57819 total_loss: 1.4573  loss:1.8482,stance loss: 2.1003 
Train step: 780 acc:0.5791 total_loss: 1.4518  loss:1.2206,stance loss: 0.94733 
Train step: 790 acc:0.58292 total_loss: 1.4479  loss:1.5685,stance loss: 1.6924 
Train step: 800 acc:0.58381 total_loss: 1.4448  loss:1.3377,stance loss: 1.0597 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.75 total_loss: 1.3432  loss:1.3432,stance loss: 1.5068 
Train step: 820 acc:0.625 total_loss: 1.3925  loss:1.4276,stance loss: 0.96198 
Train step: 830 acc:0.60714 total_loss: 1.4034  loss:1.7078,stance loss: 1.1667 
Train step: 840 acc:0.60081 total_loss: 1.4074  loss:1.2092,stance loss: 0.94519 
Train step: 850 acc:0.61128 total_loss: 1.3841  loss:1.3457,stance loss: 0.95323 
Better F1! Saving model!
Saving model of best f1: 0.04716981132075471
              precision    recall  f1-score   support

           0   0.049603  0.961538  0.094340        26
           1   0.700000  0.206897  0.319392       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.118794       564
   macro avg   0.249868  0.389478  0.137910       564
weighted avg   0.254237  0.118794  0.119307       564

Test Acc: 0.11879432624113476 F1_ma:0.04716981132075471
Train step: 860 acc:0.61029 total_loss: 1.3869  loss:1.3836,stance loss: 0.86052 
Train step: 870 acc:0.60041 total_loss: 1.4005  loss:1.6844,stance loss: 1.731 
Train step: 880 acc:0.59683 total_loss: 1.4098  loss:1.5033,stance loss: 1.6033 
Train step: 890 acc:0.60262 total_loss: 1.3938  loss:1.5449,stance loss: 1.0474 
Train step: 900 acc:0.60096 total_loss: 1.3793  loss:1.1422,stance loss: 0.85509 
Train step: 910 acc:0.60458 total_loss: 1.3827  loss:1.1823,stance loss: 0.70623 
Train step: 920 acc:0.60923 total_loss: 1.3714  loss:1.1583,stance loss: 0.88389 
Better F1! Saving model!
Saving model of best f1: 0.05022831050228311
              precision    recall  f1-score   support

           0   0.053398  0.846154  0.100457        26
           1   0.690789  0.517241  0.591549       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.225177       564
   macro avg   0.248063  0.454465  0.230669       564
weighted avg   0.251097  0.225177  0.217547       564

Test Acc: 0.225177304964539 F1_ma:0.05022831050228311
Train step: 930 acc:0.61209 total_loss: 1.3704  loss:0.87652,stance loss: 0.55904 
Train step: 940 acc:0.61069 total_loss: 1.3683  loss:1.4084,stance loss: 1.0867 
Train step: 950 acc:0.60816 total_loss: 1.3678  loss:1.4241,stance loss: 1.0389 
Train step: 960 acc:0.61258 total_loss: 1.3585  loss:1.2117,stance loss: 0.96251 
Better F1! Saving model!
Saving model of best f1: 0.05025125628140704
              precision    recall  f1-score   support

           0   0.053763  0.769231  0.100503        26
           1   0.625000  0.591133  0.607595       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.248227       564
   macro avg   0.226254  0.453455  0.236032       564
weighted avg   0.227434  0.248227  0.223324       564

Test Acc: 0.24822695035460993 F1_ma:0.05025125628140704
Train step: 970 acc:0.61452 total_loss: 1.3521  loss:1.3068,stance loss: 1.0323 
Better F1! Saving model!
Saving model of best f1: 0.05060728744939271
              precision    recall  f1-score   support

           0   0.053419  0.961538  0.101215        26
           1   0.708333  0.334975  0.454849       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.164894       564
   macro avg   0.253917  0.432171  0.185355       564
weighted avg   0.257412  0.164894  0.168379       564

Test Acc: 0.16489361702127658 F1_ma:0.05060728744939271
Train step: 980 acc:0.61806 total_loss: 1.349  loss:1.2604,stance loss: 1.0042 
Train step: 990 acc:0.62086 total_loss: 1.3485  loss:1.105,stance loss: 0.84096 
Train step: 1000 acc:0.62075 total_loss: 1.35  loss:1.5804,stance loss: 1.6284 
Train step: 1010 acc:0.61847 total_loss: 1.3458  loss:1.3612,stance loss: 1.1523 
Better F1! Saving model!
Saving model of best f1: 0.0529931407191852
              precision    recall  f1-score   support

           0   0.046296  0.961538  0.088339        26
           1   0.842105  0.078818  0.144144       203
           2   0.600000  0.008955  0.017647       335

    accuracy                       0.078014       564
   macro avg   0.496134  0.349770  0.083377       564
weighted avg   0.661615  0.078014  0.066436       564

Test Acc: 0.07801418439716312 F1_ma:0.0529931407191852
Train step: 1020 acc:0.61937 total_loss: 1.3451  loss:1.0435,stance loss: 0.79083 
Train step: 1030 acc:0.61906 total_loss: 1.3437  loss:1.1251,stance loss: 0.85635 
Train step: 1040 acc:0.61986 total_loss: 1.3445  loss:1.2959,stance loss: 0.94711 
Better F1! Saving model!
Saving model of best f1: 0.06057539937470555
              precision    recall  f1-score   support

           0   0.048356  0.961538  0.092081        26
           1   0.842105  0.157635  0.265560       203
           2   0.555556  0.014925  0.029070       335

    accuracy                       0.109929       564
   macro avg   0.482006  0.378033  0.128904       564
weighted avg   0.635312  0.109929  0.117094       564

Test Acc: 0.1099290780141844 F1_ma:0.06057539937470555
Train step: 1050 acc:0.61904 total_loss: 1.3399  loss:1.2405,stance loss: 0.92395 
Better F1! Saving model!
Saving model of best f1: 0.06143919891792836
              precision    recall  f1-score   support

           0   0.049310  0.961538  0.093809        26
           1   0.854167  0.201970  0.326693       203
           2   0.555556  0.014925  0.029070       335

    accuracy                       0.125887       564
   macro avg   0.486344  0.392811  0.149857       564
weighted avg   0.639697  0.125887  0.139178       564

Test Acc: 0.12588652482269502 F1_ma:0.06143919891792836
Train step: 1060 acc:0.61828 total_loss: 1.3379  loss:1.2549,stance loss: 0.97979 
Better F1! Saving model!
Saving model of best f1: 0.06978350250546062
              precision    recall  f1-score   support

           0   0.059524  0.769231  0.110497        26
           1   0.643836  0.694581  0.668246       203
           2   0.555556  0.014925  0.029070       335

    accuracy                       0.294326       564
   macro avg   0.419638  0.492912  0.269271       564
weighted avg   0.564463  0.294326  0.262882       564

Test Acc: 0.29432624113475175 F1_ma:0.06978350250546062
Train step: 1070 acc:0.61686 total_loss: 1.3362  loss:0.91338,stance loss: 0.6714 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.6875 total_loss: 1.1725  loss:1.1725,stance loss: 0.81602 
Train step: 1090 acc:0.64205 total_loss: 1.1456  loss:1.2203,stance loss: 0.90495 
Train step: 1100 acc:0.62798 total_loss: 1.2189  loss:1.2574,stance loss: 0.97777 
Train step: 1110 acc:0.62702 total_loss: 1.2646  loss:1.1803,stance loss: 0.86398 
Train step: 1120 acc:0.62805 total_loss: 1.2495  loss:1.2741,stance loss: 0.92099 
Train step: 1130 acc:0.6152 total_loss: 1.2639  loss:1.2015,stance loss: 0.90459 
Train step: 1140 acc:0.61988 total_loss: 1.2576  loss:1.0244,stance loss: 0.75619 
Train step: 1150 acc:0.6206 total_loss: 1.2742  loss:1.2221,stance loss: 0.90479 
Train step: 1160 acc:0.62114 total_loss: 1.2708  loss:1.0469,stance loss: 0.7966 
Train step: 1170 acc:0.62431 total_loss: 1.2602  loss:1.0163,stance loss: 0.79261 
Train step: 1180 acc:0.62562 total_loss: 1.2772  loss:1.2948,stance loss: 1.0397 
Train step: 1190 acc:0.63007 total_loss: 1.2763  loss:1.0403,stance loss: 0.80967 
Train step: 1200 acc:0.63481 total_loss: 1.2723  loss:1.3813,stance loss: 1.1346 
Train step: 1210 acc:0.63645 total_loss: 1.2739  loss:1.2121,stance loss: 0.96391 
Train step: 1220 acc:0.63342 total_loss: 1.2866  loss:1.601,stance loss: 1.6969 
Train step: 1230 acc:0.63535 total_loss: 1.28  loss:1.228,stance loss: 0.86349 
Train step: 1240 acc:0.63665 total_loss: 1.2791  loss:1.2149,stance loss: 0.91616 
Train step: 1250 acc:0.63523 total_loss: 1.2852  loss:1.2645,stance loss: 0.9495 
Train step: 1260 acc:0.63467 total_loss: 1.2906  loss:1.7427,stance loss: 1.2639 
Train step: 1270 acc:0.63154 total_loss: 1.2915  loss:1.5157,stance loss: 1.1206 
Train step: 1280 acc:0.63277 total_loss: 1.2881  loss:1.3993,stance loss: 1.5256 
Train step: 1290 acc:0.63211 total_loss: 1.2912  loss:1.3996,stance loss: 0.76332 
Train step: 1300 acc:0.6315 total_loss: 1.2939  loss:1.3571,stance loss: 1.0173 
Train step: 1310 acc:0.63366 total_loss: 1.2908  loss:1.4011,stance loss: 1.0817 
Train step: 1320 acc:0.6346 total_loss: 1.2914  loss:1.3627,stance loss: 1.0435 
Train step: 1330 acc:0.63446 total_loss: 1.2853  loss:0.87137,stance loss: 0.58949 
Train step: 1340 acc:0.63578 total_loss: 1.2855  loss:1.4699,stance loss: 0.99548 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.5625 total_loss: 1.4835  loss:1.4835,stance loss: 1.0702 
Train step: 1360 acc:0.61364 total_loss: 1.3819  loss:1.0718,stance loss: 0.78287 
Train step: 1370 acc:0.63988 total_loss: 1.3334  loss:0.88479,stance loss: 0.62506 
Train step: 1380 acc:0.65726 total_loss: 1.3007  loss:1.1436,stance loss: 0.91888 
Train step: 1390 acc:0.66921 total_loss: 1.2708  loss:1.2951,stance loss: 1.1605 
Train step: 1400 acc:0.66176 total_loss: 1.272  loss:1.198,stance loss: 0.89688 
Train step: 1410 acc:0.66393 total_loss: 1.2784  loss:1.1887,stance loss: 0.96962 
Train step: 1420 acc:0.65933 total_loss: 1.2681  loss:1.171,stance loss: 0.86993 
Train step: 1430 acc:0.66281 total_loss: 1.2641  loss:1.1197,stance loss: 0.86859 
Train step: 1440 acc:0.67033 total_loss: 1.2564  loss:0.9426,stance loss: 0.78716 
Train step: 1450 acc:0.66955 total_loss: 1.2494  loss:1.3032,stance loss: 0.9725 
Train step: 1460 acc:0.66892 total_loss: 1.2561  loss:1.3042,stance loss: 1.0841 
Train step: 1470 acc:0.66994 total_loss: 1.247  loss:1.2415,stance loss: 0.89611 
Better F1! Saving model!
Saving model of best f1: 0.07711436364731493
              precision    recall  f1-score   support

           0   0.061889  0.730769  0.114114        26
           1   0.633745  0.758621  0.690583       203
           2   0.500000  0.020896  0.040115       335

    accuracy                       0.319149       564
   macro avg   0.398545  0.503428  0.281604       564
weighted avg   0.527942  0.319149  0.277648       564

Test Acc: 0.3191489361702128 F1_ma:0.07711436364731493
Train step: 1480 acc:0.67032 total_loss: 1.245  loss:0.98097,stance loss: 0.80915 
Train step: 1490 acc:0.66489 total_loss: 1.2519  loss:1.7075,stance loss: 1.7626 
Train step: 1500 acc:0.66142 total_loss: 1.2563  loss:1.0306,stance loss: 0.78815 
Train step: 1510 acc:0.66382 total_loss: 1.2546  loss:1.177,stance loss: 0.91867 
Train step: 1520 acc:0.66301 total_loss: 1.2462  loss:1.3724,stance loss: 0.90902 
Train step: 1530 acc:0.66264 total_loss: 1.2523  loss:1.5711,stance loss: 1.0673 
Train step: 1540 acc:0.65969 total_loss: 1.2536  loss:1.0057,stance loss: 0.52138 
Train step: 1550 acc:0.66138 total_loss: 1.2454  loss:0.90169,stance loss: 0.70265 
Train step: 1560 acc:0.66084 total_loss: 1.2464  loss:0.97467,stance loss: 0.69172 
Train step: 1570 acc:0.66092 total_loss: 1.2436  loss:1.1769,stance loss: 0.8209 
Train step: 1580 acc:0.6645 total_loss: 1.2394  loss:1.4229,stance loss: 1.5894 
Train step: 1590 acc:0.66364 total_loss: 1.2358  loss:1.0506,stance loss: 0.89219 
Train step: 1600 acc:0.66509 total_loss: 1.2302  loss:0.92813,stance loss: 0.73472 
Train step: 1610 acc:0.66284 total_loss: 1.2333  loss:1.6053,stance loss: 1.372 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.75 total_loss: 0.96674  loss:0.96674,stance loss: 0.72927 
Train step: 1630 acc:0.64773 total_loss: 1.2668  loss:1.2285,stance loss: 0.96444 
Train step: 1640 acc:0.67262 total_loss: 1.2176  loss:1.3854,stance loss: 0.96404 
Train step: 1650 acc:0.67137 total_loss: 1.1807  loss:1.2556,stance loss: 1.0217 
Train step: 1660 acc:0.6753 total_loss: 1.196  loss:1.1614,stance loss: 1.2947 
Train step: 1670 acc:0.68137 total_loss: 1.1851  loss:1.391,stance loss: 1.4184 
Train step: 1680 acc:0.68443 total_loss: 1.1779  loss:1.0619,stance loss: 0.91727 
Train step: 1690 acc:0.68134 total_loss: 1.1806  loss:1.4118,stance loss: 1.5509 
Train step: 1700 acc:0.68287 total_loss: 1.1968  loss:1.4993,stance loss: 1.7298 
Train step: 1710 acc:0.67995 total_loss: 1.2086  loss:1.3665,stance loss: 1.5483 
Train step: 1720 acc:0.69121 total_loss: 1.1991  loss:1.0555,stance loss: 1.2747 
Train step: 1730 acc:0.69313 total_loss: 1.1915  loss:0.83888,stance loss: 0.63706 
Train step: 1740 acc:0.6906 total_loss: 1.1909  loss:1.1277,stance loss: 0.83394 
Train step: 1750 acc:0.68798 total_loss: 1.197  loss:1.5202,stance loss: 1.4666 
Train step: 1760 acc:0.68528 total_loss: 1.1946  loss:1.6988,stance loss: 1.1302 
Train step: 1770 acc:0.68377 total_loss: 1.1974  loss:1.2206,stance loss: 0.97685 
Train step: 1780 acc:0.68323 total_loss: 1.2003  loss:1.5628,stance loss: 1.683 
Train step: 1790 acc:0.68092 total_loss: 1.1998  loss:1.4013,stance loss: 0.9762 
Train step: 1800 acc:0.68163 total_loss: 1.1948  loss:1.2528,stance loss: 0.97409 
Train step: 1810 acc:0.68096 total_loss: 1.1902  loss:1.5118,stance loss: 1.0882 
Train step: 1820 acc:0.67786 total_loss: 1.1889  loss:1.3226,stance loss: 0.91922 
Train step: 1830 acc:0.67743 total_loss: 1.1902  loss:0.88175,stance loss: 0.68772 
Train step: 1840 acc:0.67506 total_loss: 1.1957  loss:1.1414,stance loss: 0.87343 
Train step: 1850 acc:0.67316 total_loss: 1.1976  loss:1.247,stance loss: 1.0106 
Train step: 1860 acc:0.67246 total_loss: 1.1964  loss:1.5866,stance loss: 1.1817 
Train step: 1870 acc:0.67156 total_loss: 1.2016  loss:1.336,stance loss: 1.058 
Train step: 1880 acc:0.6717 total_loss: 1.1976  loss:1.0314,stance loss: 0.81965 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.75 total_loss: 1.5393  loss:1.5393,stance loss: 1.5954 
Train step: 1900 acc:0.71591 total_loss: 1.2184  loss:1.4864,stance loss: 0.97313 
Train step: 1910 acc:0.72619 total_loss: 1.1894  loss:1.0316,stance loss: 0.87523 
Train step: 1920 acc:0.72177 total_loss: 1.1739  loss:1.2371,stance loss: 0.93919 
Train step: 1930 acc:0.69665 total_loss: 1.1826  loss:1.4365,stance loss: 0.99975 
Train step: 1940 acc:0.68873 total_loss: 1.2025  loss:1.4789,stance loss: 1.546 
Train step: 1950 acc:0.68135 total_loss: 1.19  loss:1.0964,stance loss: 0.73901 
Train step: 1960 acc:0.68046 total_loss: 1.1921  loss:0.98766,stance loss: 0.79075 
Train step: 1970 acc:0.67747 total_loss: 1.1942  loss:1.022,stance loss: 0.7668 
Train step: 1980 acc:0.67651 total_loss: 1.194  loss:1.7766,stance loss: 1.2997 
Train step: 1990 acc:0.68193 total_loss: 1.1911  loss:0.99219,stance loss: 0.74101 
Train step: 2000 acc:0.68356 total_loss: 1.1797  loss:1.048,stance loss: 0.75484 
Train step: 2010 acc:0.68285 total_loss: 1.1826  loss:0.92088,stance loss: 0.74851 
Train step: 2020 acc:0.68464 total_loss: 1.1764  loss:1.6296,stance loss: 1.5351 
Train step: 2030 acc:0.68218 total_loss: 1.1778  loss:0.95661,stance loss: 0.67284 
Train step: 2040 acc:0.68502 total_loss: 1.1731  loss:1.3567,stance loss: 0.90591 
Train step: 2050 acc:0.68517 total_loss: 1.1726  loss:1.441,stance loss: 1.2125 
Train step: 2060 acc:0.68311 total_loss: 1.1683  loss:1.007,stance loss: 0.74191 
Train step: 2070 acc:0.68267 total_loss: 1.1668  loss:1.2221,stance loss: 1.0188 
Train step: 2080 acc:0.68259 total_loss: 1.1694  loss:1.2469,stance loss: 0.83098 
Train step: 2090 acc:0.68315 total_loss: 1.1707  loss:1.2986,stance loss: 1.0061 
Train step: 2100 acc:0.6875 total_loss: 1.1614  loss:1.5472,stance loss: 1.6847 
Train step: 2110 acc:0.6875 total_loss: 1.161  loss:0.90203,stance loss: 0.74886 
Train step: 2120 acc:0.68669 total_loss: 1.1591  loss:1.1834,stance loss: 0.88421 
Train step: 2130 acc:0.68906 total_loss: 1.1538  loss:0.79482,stance loss: 0.51888 
Train step: 2140 acc:0.68899 total_loss: 1.1577  loss:1.3042,stance loss: 1.5202 
Train step: 2150 acc:0.68989 total_loss: 1.1527  loss:0.95283,stance loss: 0.73528 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.8125 total_loss: 0.70258  loss:0.70258,stance loss: 0.48604 
Train step: 2170 acc:0.71591 total_loss: 1.0231  loss:1.6172,stance loss: 1.8247 
Train step: 2180 acc:0.70536 total_loss: 1.0156  loss:0.84537,stance loss: 0.59847 
Train step: 2190 acc:0.68952 total_loss: 1.0321  loss:1.0692,stance loss: 0.85635 
Train step: 2200 acc:0.69512 total_loss: 1.0324  loss:1.016,stance loss: 0.75234 
Train step: 2210 acc:0.6924 total_loss: 1.0356  loss:0.76186,stance loss: 0.44985 
Train step: 2220 acc:0.69365 total_loss: 1.0321  loss:0.90684,stance loss: 0.72939 
Train step: 2230 acc:0.69542 total_loss: 1.0521  loss:1.2784,stance loss: 1.4666 
Train step: 2240 acc:0.69599 total_loss: 1.0584  loss:0.65754,stance loss: 0.50669 
Train step: 2250 acc:0.70192 total_loss: 1.0604  loss:0.76019,stance loss: 0.42197 
Train step: 2260 acc:0.70359 total_loss: 1.0566  loss:0.9968,stance loss: 0.69844 
Train step: 2270 acc:0.70327 total_loss: 1.0589  loss:1.1043,stance loss: 0.89013 
Train step: 2280 acc:0.70764 total_loss: 1.0596  loss:1.0019,stance loss: 0.83403 
Train step: 2290 acc:0.70706 total_loss: 1.0599  loss:1.157,stance loss: 0.84611 
Train step: 2300 acc:0.70567 total_loss: 1.0616  loss:0.99781,stance loss: 0.82209 
Train step: 2310 acc:0.70613 total_loss: 1.0702  loss:1.2446,stance loss: 1.3664 
Train step: 2320 acc:0.70264 total_loss: 1.0725  loss:1.1134,stance loss: 0.87764 
Train step: 2330 acc:0.70614 total_loss: 1.071  loss:0.85545,stance loss: 0.70505 
Train step: 2340 acc:0.71098 total_loss: 1.0636  loss:1.5592,stance loss: 1.5959 
Train step: 2350 acc:0.70942 total_loss: 1.0748  loss:1.3075,stance loss: 1.0954 
Train step: 2360 acc:0.70958 total_loss: 1.0753  loss:1.3202,stance loss: 1.1093 
Train step: 2370 acc:0.70735 total_loss: 1.0764  loss:0.91619,stance loss: 0.61171 
Train step: 2380 acc:0.70814 total_loss: 1.0731  loss:0.92354,stance loss: 0.73364 
Train step: 2390 acc:0.70915 total_loss: 1.0668  loss:0.67683,stance loss: 0.51008 
Train step: 2400 acc:0.70851 total_loss: 1.0679  loss:0.76786,stance loss: 0.62434 
Train step: 2410 acc:0.70692 total_loss: 1.0729  loss:1.3388,stance loss: 1.0273 
Train step: 2420 acc:0.70522 total_loss: 1.073  loss:1.023,stance loss: 0.67963 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.8125 total_loss: 0.57939  loss:0.57939,stance loss: 0.14756 
Train step: 2440 acc:0.69318 total_loss: 0.99289  loss:0.91276,stance loss: 0.6546 
Train step: 2450 acc:0.71131 total_loss: 0.98072  loss:1.5231,stance loss: 1.2985 
Train step: 2460 acc:0.72581 total_loss: 0.96731  loss:0.90773,stance loss: 0.76437 
Train step: 2470 acc:0.72561 total_loss: 0.96074  loss:1.0183,stance loss: 0.68112 
Train step: 2480 acc:0.72794 total_loss: 0.9593  loss:1.3476,stance loss: 1.617 
Train step: 2490 acc:0.72336 total_loss: 0.96429  loss:0.76523,stance loss: 0.57206 
Train step: 2500 acc:0.72271 total_loss: 0.97411  loss:0.81576,stance loss: 0.60565 
Train step: 2510 acc:0.71836 total_loss: 0.98335  loss:0.78105,stance loss: 0.58709 
Train step: 2520 acc:0.72047 total_loss: 0.98431  loss:1.0711,stance loss: 0.90195 
Train step: 2530 acc:0.71411 total_loss: 0.99952  loss:0.95081,stance loss: 0.55164 
Train step: 2540 acc:0.70439 total_loss: 1.0099  loss:1.0287,stance loss: 0.75851 
Train step: 2550 acc:0.7061 total_loss: 1.0121  loss:1.0007,stance loss: 0.75995 
Train step: 2560 acc:0.70658 total_loss: 1.009  loss:0.79526,stance loss: 0.61314 
Train step: 2570 acc:0.70656 total_loss: 1.0124  loss:1.1157,stance loss: 0.78831 
Train step: 2580 acc:0.71109 total_loss: 1.0157  loss:0.80831,stance loss: 0.70054 
Train step: 2590 acc:0.7104 total_loss: 1.0153  loss:1.3726,stance loss: 1.4984 
Train step: 2600 acc:0.71308 total_loss: 1.0064  loss:1.4526,stance loss: 0.85124 
Train step: 2610 acc:0.71167 total_loss: 1.0162  loss:1.6423,stance loss: 1.4223 
Train step: 2620 acc:0.71401 total_loss: 1.0236  loss:1.8272,stance loss: 1.7111 
Train step: 2630 acc:0.71206 total_loss: 1.0306  loss:0.95098,stance loss: 0.67081 
Train step: 2640 acc:0.7106 total_loss: 1.0392  loss:0.8923,stance loss: 0.68972 
Train step: 2650 acc:0.70984 total_loss: 1.0407  loss:0.58895,stance loss: 0.24211 
Train step: 2660 acc:0.71131 total_loss: 1.0336  loss:0.71574,stance loss: 0.55921 
Train step: 2670 acc:0.71473 total_loss: 1.0259  loss:0.91032,stance loss: 0.66712 
Train step: 2680 acc:0.71489 total_loss: 1.0247  loss:1.3947,stance loss: 0.99938 
Train step: 2690 acc:0.71624 total_loss: 1.0247  loss:1.235,stance loss: 0.93157 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.5 total_loss: 1.1931  loss:1.1931,stance loss: 0.9108 
Train step: 2710 acc:0.74432 total_loss: 0.94852  loss:0.98189,stance loss: 0.7087 
Train step: 2720 acc:0.7381 total_loss: 1.0107  loss:1.2227,stance loss: 0.94511 
Train step: 2730 acc:0.73589 total_loss: 0.98692  loss:0.55392,stance loss: 0.24819 
Train step: 2740 acc:0.7439 total_loss: 0.95741  loss:0.92612,stance loss: 0.67358 
Train step: 2750 acc:0.75 total_loss: 0.9558  loss:0.61829,stance loss: 0.4869 
Train step: 2760 acc:0.75205 total_loss: 0.96085  loss:0.76119,stance loss: 0.72153 
Train step: 2770 acc:0.75176 total_loss: 0.94886  loss:0.52492,stance loss: 0.38877 
Train step: 2780 acc:0.74537 total_loss: 0.96316  loss:0.78399,stance loss: 0.50752 
Train step: 2790 acc:0.74725 total_loss: 0.96327  loss:0.91427,stance loss: 0.73586 
Train step: 2800 acc:0.74814 total_loss: 0.96236  loss:1.134,stance loss: 0.69959 
Train step: 2810 acc:0.74662 total_loss: 0.96815  loss:1.0127,stance loss: 0.80756 
Train step: 2820 acc:0.75052 total_loss: 0.95616  loss:0.66503,stance loss: 0.52847 
Train step: 2830 acc:0.75286 total_loss: 0.95323  loss:1.3187,stance loss: 1.5493 
Train step: 2840 acc:0.75044 total_loss: 0.95768  loss:1.0839,stance loss: 0.89227 
Train step: 2850 acc:0.74917 total_loss: 0.95221  loss:0.65972,stance loss: 0.46558 
Train step: 2860 acc:0.75 total_loss: 0.94949  loss:1.318,stance loss: 1.0519 
Train step: 2870 acc:0.75183 total_loss: 0.94729  loss:0.89323,stance loss: 0.57034 
Train step: 2880 acc:0.75173 total_loss: 0.94979  loss:0.85812,stance loss: 0.69907 
Train step: 2890 acc:0.75131 total_loss: 0.94374  loss:0.884,stance loss: 0.92466 
Train step: 2900 acc:0.74907 total_loss: 0.95268  loss:1.0074,stance loss: 0.72856 
Train step: 2910 acc:0.7497 total_loss: 0.95531  loss:1.1802,stance loss: 1.4654 
Train step: 2920 acc:0.74859 total_loss: 0.9568  loss:0.75997,stance loss: 0.5442 
Train step: 2930 acc:0.74459 total_loss: 0.96726  loss:1.0987,stance loss: 0.85096 
Train step: 2940 acc:0.74352 total_loss: 0.96955  loss:1.1365,stance loss: 0.94294 
Train step: 2950 acc:0.74377 total_loss: 0.96844  loss:1.0275,stance loss: 0.82366 
Train step: 2960 acc:0.74449 total_loss: 0.967  loss:1.5893,stance loss: 1.7828 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:1.0 total_loss: 0.90965  loss:0.90965,stance loss: 1.2566 
Train step: 2980 acc:0.8125 total_loss: 0.84452  loss:1.1882,stance loss: 1.4721 
Train step: 2990 acc:0.77381 total_loss: 0.9123  loss:1.0593,stance loss: 0.90067 
Train step: 3000 acc:0.78024 total_loss: 0.89577  loss:0.73396,stance loss: 0.55538 
Train step: 3010 acc:0.77744 total_loss: 0.89002  loss:0.60908,stance loss: 0.51209 
Train step: 3020 acc:0.77206 total_loss: 0.88823  loss:1.5848,stance loss: 0.99926 
Train step: 3030 acc:0.77357 total_loss: 0.86663  loss:0.36017,stance loss: 0.25147 
Train step: 3040 acc:0.76937 total_loss: 0.86178  loss:0.97697,stance loss: 0.74942 
Train step: 3050 acc:0.76543 total_loss: 0.87133  loss:0.79288,stance loss: 0.73268 
Train step: 3060 acc:0.76442 total_loss: 0.88772  loss:1.0248,stance loss: 0.79569 
Train step: 3070 acc:0.7698 total_loss: 0.88155  loss:1.1633,stance loss: 1.115 
Train step: 3080 acc:0.76577 total_loss: 0.88263  loss:0.9219,stance loss: 0.56541 
Train step: 3090 acc:0.77169 total_loss: 0.87347  loss:0.77758,stance loss: 0.6432 
Train step: 3100 acc:0.76861 total_loss: 0.88721  loss:0.86294,stance loss: 0.73035 
Train step: 3110 acc:0.77039 total_loss: 0.88838  loss:0.90973,stance loss: 0.68848 
Train step: 3120 acc:0.76987 total_loss: 0.89108  loss:0.60605,stance loss: 0.4834 
Train step: 3130 acc:0.7729 total_loss: 0.88317  loss:0.49655,stance loss: 0.33626 
Train step: 3140 acc:0.77449 total_loss: 0.88482  loss:1.153,stance loss: 0.92405 
Train step: 3150 acc:0.77314 total_loss: 0.88579  loss:0.73094,stance loss: 0.55463 
Train step: 3160 acc:0.77618 total_loss: 0.87827  loss:0.66991,stance loss: 0.56631 
Train step: 3170 acc:0.77643 total_loss: 0.87479  loss:0.8803,stance loss: 1.2476 
Train step: 3180 acc:0.77607 total_loss: 0.87503  loss:1.058,stance loss: 1.4275 
Train step: 3190 acc:0.7746 total_loss: 0.87483  loss:0.58562,stance loss: 0.46243 
Train step: 3200 acc:0.77354 total_loss: 0.87392  loss:0.70923,stance loss: 0.45093 
Train step: 3210 acc:0.7736 total_loss: 0.87386  loss:0.66911,stance loss: 0.42082 
Train step: 3220 acc:0.77266 total_loss: 0.87987  loss:1.0197,stance loss: 0.9781 
Train step: 3230 acc:0.77275 total_loss: 0.87817  loss:1.1246,stance loss: 0.58737 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.45456  loss:0.45456,stance loss: 0.34612 
Train step: 3250 acc:0.80114 total_loss: 0.83066  loss:0.42853,stance loss: 0.32295 
Train step: 3260 acc:0.78869 total_loss: 0.8615  loss:0.85379,stance loss: 1.1421 
Train step: 3270 acc:0.79435 total_loss: 0.86838  loss:0.56251,stance loss: 0.40197 
Train step: 3280 acc:0.79726 total_loss: 0.86648  loss:0.61167,stance loss: 0.38747 
Train step: 3290 acc:0.79657 total_loss: 0.86241  loss:1.2111,stance loss: 1.0697 
Train step: 3300 acc:0.79303 total_loss: 0.84229  loss:0.45615,stance loss: 0.16048 
Train step: 3310 acc:0.78961 total_loss: 0.84577  loss:1.2373,stance loss: 1.4906 
Train step: 3320 acc:0.79012 total_loss: 0.83702  loss:0.74552,stance loss: 0.34206 
Train step: 3330 acc:0.79602 total_loss: 0.82353  loss:0.68355,stance loss: 0.39205 
Train step: 3340 acc:0.80322 total_loss: 0.8183  loss:0.8104,stance loss: 1.0963 
Train step: 3350 acc:0.80068 total_loss: 0.8278  loss:0.85509,stance loss: 0.69108 
Train step: 3360 acc:0.80114 total_loss: 0.82268  loss:0.61346,stance loss: 0.56029 
Train step: 3370 acc:0.80153 total_loss: 0.81547  loss:0.57876,stance loss: 0.33569 
Train step: 3380 acc:0.8023 total_loss: 0.80326  loss:0.67583,stance loss: 0.46167 
Train step: 3390 acc:0.80795 total_loss: 0.78953  loss:0.99064,stance loss: 1.306 
Train step: 3400 acc:0.80862 total_loss: 0.79262  loss:1.6947,stance loss: 1.7111 
Train step: 3410 acc:0.80921 total_loss: 0.78382  loss:0.37835,stance loss: 0.19741 
Train step: 3420 acc:0.80801 total_loss: 0.78106  loss:0.84936,stance loss: 0.70937 
Train step: 3430 acc:0.80759 total_loss: 0.78624  loss:1.291,stance loss: 1.0692 
Train step: 3440 acc:0.80784 total_loss: 0.78338  loss:0.83934,stance loss: 0.73405 
Train step: 3450 acc:0.80717 total_loss: 0.78775  loss:0.68433,stance loss: 0.58686 
Train step: 3460 acc:0.80656 total_loss: 0.7885  loss:0.62441,stance loss: 0.45263 
Train step: 3470 acc:0.8079 total_loss: 0.78323  loss:0.86343,stance loss: 0.62686 
Train step: 3480 acc:0.80679 total_loss: 0.78775  loss:1.1938,stance loss: 0.8073 
Train step: 3490 acc:0.80802 total_loss: 0.78735  loss:1.0928,stance loss: 0.82858 
Train step: 3500 acc:0.80915 total_loss: 0.78295  loss:1.0263,stance loss: 0.81226 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:0.8125 total_loss: 0.58413  loss:0.58413,stance loss: 0.46141 
Train step: 3520 acc:0.78409 total_loss: 0.83733  loss:1.2035,stance loss: 0.99543 
Train step: 3530 acc:0.80952 total_loss: 0.77084  loss:0.53661,stance loss: 0.43501 
Train step: 3540 acc:0.81452 total_loss: 0.74404  loss:0.25441,stance loss: 0.21723 
Train step: 3550 acc:0.81707 total_loss: 0.71695  loss:0.36109,stance loss: 0.16327 
Train step: 3560 acc:0.82843 total_loss: 0.69538  loss:0.95833,stance loss: 0.86539 
Train step: 3570 acc:0.82787 total_loss: 0.69934  loss:0.47634,stance loss: 0.29135 
Train step: 3580 acc:0.82658 total_loss: 0.71653  loss:0.73727,stance loss: 1.0742 
Train step: 3590 acc:0.83179 total_loss: 0.71495  loss:0.63472,stance loss: 0.41673 
Train step: 3600 acc:0.82761 total_loss: 0.71803  loss:1.0425,stance loss: 0.886 
Better F1! Saving model!
Saving model of best f1: 0.10525514421194587
              precision    recall  f1-score   support

           0   0.050704  0.692308  0.094488        26
           1   0.675824  0.605911  0.638961       203
           2   0.777778  0.062687  0.116022       335

    accuracy                       0.287234       564
   macro avg   0.501435  0.453635  0.283157       564
weighted avg   0.707564  0.287234  0.303250       564

Test Acc: 0.2872340425531915 F1_ma:0.10525514421194587
Train step: 3610 acc:0.82797 total_loss: 0.71842  loss:0.67262,stance loss: 0.56399 
Train step: 3620 acc:0.82827 total_loss: 0.72142  loss:0.37548,stance loss: 0.27429 
Train step: 3630 acc:0.8311 total_loss: 0.70652  loss:0.32924,stance loss: 0.11978 
Train step: 3640 acc:0.83015 total_loss: 0.70343  loss:0.55395,stance loss: 0.46637 
Train step: 3650 acc:0.83067 total_loss: 0.71241  loss:0.31457,stance loss: 0.20483 
Train step: 3660 acc:0.83237 total_loss: 0.71727  loss:0.5484,stance loss: 0.39454 
Train step: 3670 acc:0.83618 total_loss: 0.71104  loss:0.49157,stance loss: 0.42735 
Train step: 3680 acc:0.83516 total_loss: 0.71397  loss:1.3808,stance loss: 1.7319 
Train step: 3690 acc:0.83633 total_loss: 0.71242  loss:0.62051,stance loss: 0.57507 
Train step: 3700 acc:0.83802 total_loss: 0.70781  loss:0.63353,stance loss: 0.46677 
Train step: 3710 acc:0.83738 total_loss: 0.70629  loss:0.81178,stance loss: 1.0839 
Train step: 3720 acc:0.83857 total_loss: 0.70407  loss:0.60659,stance loss: 0.5821 
Train step: 3730 acc:0.84078 total_loss: 0.70278  loss:0.74684,stance loss: 0.64297 
Train step: 3740 acc:0.84172 total_loss: 0.69914  loss:0.44323,stance loss: 0.27794 
Train step: 3750 acc:0.84258 total_loss: 0.69874  loss:1.0163,stance loss: 1.3716 
Train step: 3760 acc:0.84437 total_loss: 0.69059  loss:0.20356,stance loss: 0.0095376 
Train step: 3770 acc:0.84483 total_loss: 0.68983  loss:0.81205,stance loss: 1.2672 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.8125 total_loss: 0.55313  loss:0.55313,stance loss: 0.45196 
Train step: 3790 acc:0.85795 total_loss: 0.53181  loss:0.25427,stance loss: 0.12997 
Better F1! Saving model!
Saving model of best f1: 0.11558666839515776
              precision    recall  f1-score   support

           0   0.050847  0.807692  0.095672        26
           1   0.717949  0.413793  0.525000       203
           2   0.735294  0.074627  0.135501       335

    accuracy                       0.230496       564
   macro avg   0.501363  0.432037  0.252058       564
weighted avg   0.697498  0.230496  0.273857       564

Test Acc: 0.23049645390070922 F1_ma:0.11558666839515776
Train step: 3800 acc:0.875 total_loss: 0.54245  loss:0.16296,stance loss: 0.014033 
Train step: 3810 acc:0.85887 total_loss: 0.591  loss:0.94675,stance loss: 1.2804 
Train step: 3820 acc:0.85518 total_loss: 0.61338  loss:1.1195,stance loss: 0.85603 
Train step: 3830 acc:0.84804 total_loss: 0.60788  loss:0.51858,stance loss: 0.315 
Train step: 3840 acc:0.85348 total_loss: 0.59939  loss:0.4897,stance loss: 0.35732 
Train step: 3850 acc:0.84947 total_loss: 0.62462  loss:1.3987,stance loss: 0.82274 
Train step: 3860 acc:0.85031 total_loss: 0.61791  loss:0.29596,stance loss: 0.24121 
Train step: 3870 acc:0.85096 total_loss: 0.61654  loss:0.376,stance loss: 0.18474 
Train step: 3880 acc:0.85396 total_loss: 0.62014  loss:0.45016,stance loss: 0.30273 
Train step: 3890 acc:0.86036 total_loss: 0.62457  loss:0.55761,stance loss: 0.42626 
Train step: 3900 acc:0.86209 total_loss: 0.62093  loss:0.27744,stance loss: 0.2313 
Train step: 3910 acc:0.86069 total_loss: 0.6212  loss:0.45676,stance loss: 0.27357 
Train step: 3920 acc:0.86082 total_loss: 0.6207  loss:0.50172,stance loss: 0.4786 
Train step: 3930 acc:0.85637 total_loss: 0.62907  loss:0.34084,stance loss: 0.35927 
Train step: 3940 acc:0.85598 total_loss: 0.6282  loss:0.72458,stance loss: 0.58332 
Train step: 3950 acc:0.85636 total_loss: 0.6262  loss:0.55842,stance loss: 0.32765 
Train step: 3960 acc:0.8567 total_loss: 0.62281  loss:0.5678,stance loss: 0.5406 
Train step: 3970 acc:0.85864 total_loss: 0.62278  loss:0.47913,stance loss: 0.34485 
Train step: 3980 acc:0.86039 total_loss: 0.61901  loss:0.59993,stance loss: 1.0321 
Train step: 3990 acc:0.86108 total_loss: 0.61367  loss:0.70157,stance loss: 0.66758 
Train step: 4000 acc:0.86086 total_loss: 0.61466  loss:0.58027,stance loss: 0.54793 
Train step: 4010 acc:0.86174 total_loss: 0.61045  loss:0.39496,stance loss: 0.28383 
Train step: 4020 acc:0.86203 total_loss: 0.61311  loss:1.0726,stance loss: 1.3835 
Train step: 4030 acc:0.86255 total_loss: 0.6128  loss:0.29144,stance loss: 0.23277 
Train step: 4040 acc:0.86255 total_loss: 0.61222  loss:0.49209,stance loss: 0.3545 
Training finished.


Reload the best model with best f1 0.11558666839515776 from path test_outputs/bert-cross-topic/cc/2023-08-14 16-17-57/state_dict


              precision    recall  f1-score   support

           0   0.050847  0.807692  0.095672        26
           1   0.717949  0.413793  0.525000       203
           2   0.735294  0.074627  0.135501       335

    accuracy                       0.230496       564
   macro avg   0.501363  0.432037  0.252058       564
weighted avg   0.697498  0.230496  0.273857       564

Test Acc: 0.23049645390070922 F1_ma:0.11558666839515776
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.11558666839515776
acc: 0.23049645390070922, f1 :0.2520577789301051
classification report: 
              precision    recall  f1-score   support

         Con     0.0508    0.8077    0.0957        26
        None     0.7179    0.4138    0.5250       203
         Pro     0.7353    0.0746    0.1355       335

    accuracy                         0.2305       564
   macro avg     0.5014    0.4320    0.2521       564
weighted avg     0.6975    0.2305    0.2739       564

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='cc', dataset_files={'train': './datasets/o_cc', 'test': './datasets/cc'}, dev_dir='./datasets/cc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/cc/2023-08-14 16-35-05', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/cc', train_dir='./datasets/o_cc', type=0)
using model:  bert-cross-topic
running dataset:  cc
output_dir:  test_outputs/bert-cross-topic/cc/2023-08-14 16-35-05
Train loader length: 270
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.9326  loss:1.9326,stance loss: 1.6429 
Train step: 10 acc:0.51705 total_loss: 1.6322  loss:1.6005,stance loss: 1.0949 
Better F1! Saving model!
Saving model of best f1: 0.04406779661016949
              precision    recall  f1-score   support

           0   0.046099  1.000000  0.088136        26
           1   0.000000  0.000000  0.000000       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.046099       564
   macro avg   0.015366  0.333333  0.029379       564
weighted avg   0.002125  0.046099  0.004063       564

Test Acc: 0.04609929078014184 F1_ma:0.04406779661016949
Train step: 20 acc:0.52083 total_loss: 1.6146  loss:1.4087,stance loss: 0.94729 
Train step: 30 acc:0.52016 total_loss: 1.6044  loss:1.6298,stance loss: 1.2033 
Train step: 40 acc:0.54116 total_loss: 1.5774  loss:1.3859,stance loss: 0.89027 
Train step: 50 acc:0.54167 total_loss: 1.5573  loss:1.3436,stance loss: 0.91023 
Train step: 60 acc:0.54303 total_loss: 1.5595  loss:1.7397,stance loss: 1.3479 
Train step: 70 acc:0.54137 total_loss: 1.573  loss:1.7751,stance loss: 1.556 
Train step: 80 acc:0.54707 total_loss: 1.5624  loss:1.4285,stance loss: 1.0284 
Train step: 90 acc:0.53915 total_loss: 1.5605  loss:1.7077,stance loss: 1.2083 
Better F1! Saving model!
Saving model of best f1: 0.044142614601018676
              precision    recall  f1-score   support

           0   0.046181  1.000000  0.088285        26
           1   1.000000  0.004926  0.009804       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.047872       564
   macro avg   0.348727  0.334975  0.032696       564
weighted avg   0.362058  0.047872  0.007599       564

Test Acc: 0.047872340425531915 F1_ma:0.044142614601018676
Train step: 100 acc:0.54208 total_loss: 1.5518  loss:1.4048,stance loss: 1.0428 
Train step: 110 acc:0.54505 total_loss: 1.5398  loss:1.2591,stance loss: 0.82214 
Train step: 120 acc:0.54339 total_loss: 1.535  loss:1.4053,stance loss: 0.95615 
Train step: 130 acc:0.5458 total_loss: 1.5376  loss:1.5841,stance loss: 1.5329 
Train step: 140 acc:0.54521 total_loss: 1.5354  loss:1.5919,stance loss: 1.378 
Train step: 150 acc:0.54553 total_loss: 1.5381  loss:1.6394,stance loss: 1.6579 
Train step: 160 acc:0.54464 total_loss: 1.5331  loss:1.3196,stance loss: 0.82501 
Train step: 170 acc:0.5508 total_loss: 1.5287  loss:1.2767,stance loss: 0.85249 
Train step: 180 acc:0.54972 total_loss: 1.5198  loss:1.2169,stance loss: 0.81703 
Train step: 190 acc:0.55137 total_loss: 1.5173  loss:1.5217,stance loss: 0.86679 
Train step: 200 acc:0.55286 total_loss: 1.5164  loss:1.5623,stance loss: 1.2708 
Train step: 210 acc:0.55361 total_loss: 1.512  loss:1.2962,stance loss: 0.84761 
Train step: 220 acc:0.5526 total_loss: 1.5116  loss:1.3273,stance loss: 0.90003 
Better F1! Saving model!
Saving model of best f1: 0.0446927374301676
              precision    recall  f1-score   support

           0   0.046967  0.923077  0.089385        26
           1   0.924528  0.241379  0.382813       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.129433       564
   macro avg   0.323832  0.388152  0.157399       564
weighted avg   0.334930  0.129433  0.141906       564

Test Acc: 0.12943262411347517 F1_ma:0.0446927374301676
Train step: 230 acc:0.5506 total_loss: 1.5143  loss:1.6336,stance loss: 1.2788 
Train step: 240 acc:0.54979 total_loss: 1.5086  loss:1.332,stance loss: 0.75261 
Train step: 250 acc:0.55129 total_loss: 1.5043  loss:1.6034,stance loss: 1.6518 
Train step: 260 acc:0.55196 total_loss: 1.4996  loss:1.3333,stance loss: 0.98347 
Better F1! Saving model!
Saving model of best f1: 0.050955414012738856
              precision    recall  f1-score   support

           0   0.053933  0.923077  0.101911        26
           1   0.890756  0.522167  0.658385       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.230496       564
   macro avg   0.314896  0.481748  0.253432       564
weighted avg   0.323095  0.230496  0.241670       564

Test Acc: 0.23049645390070922 F1_ma:0.050955414012738856
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.6875 total_loss: 1.2667  loss:1.2667,stance loss: 0.90052 
Better F1! Saving model!
Saving model of best f1: 0.0511727078891258
              precision    recall  f1-score   support

           0   0.054176  0.923077  0.102345        26
           1   0.884298  0.527094  0.660494       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.232270       564
   macro avg   0.312825  0.483390  0.254280       564
weighted avg   0.320782  0.232270  0.242449       564

Test Acc: 0.2322695035460993 F1_ma:0.0511727078891258
Train step: 280 acc:0.6875 total_loss: 1.2468  loss:1.2265,stance loss: 0.83163 
Train step: 290 acc:0.6756 total_loss: 1.3011  loss:1.7124,stance loss: 1.7548 
Train step: 300 acc:0.65323 total_loss: 1.3414  loss:1.4273,stance loss: 1.1189 
Train step: 310 acc:0.64939 total_loss: 1.3242  loss:1.4405,stance loss: 1.4597 
Train step: 320 acc:0.6299 total_loss: 1.3282  loss:1.5829,stance loss: 1.3089 
Train step: 330 acc:0.62398 total_loss: 1.3319  loss:1.1029,stance loss: 0.82626 
Train step: 340 acc:0.62412 total_loss: 1.3344  loss:1.6062,stance loss: 1.4105 
Better F1! Saving model!
Saving model of best f1: 0.052132701421800945
              precision    recall  f1-score   support

           0   0.055556  0.846154  0.104265        26
           1   0.869048  0.719212  0.787062       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.297872       564
   macro avg   0.308201  0.521789  0.297109       564
weighted avg   0.315357  0.297872  0.288093       564

Test Acc: 0.2978723404255319 F1_ma:0.052132701421800945
Train step: 350 acc:0.61806 total_loss: 1.348  loss:1.5011,stance loss: 1.0745 
Train step: 360 acc:0.62019 total_loss: 1.3469  loss:1.0797,stance loss: 0.76368 
Train step: 370 acc:0.62624 total_loss: 1.3454  loss:1.3466,stance loss: 1.2312 
Better F1! Saving model!
Saving model of best f1: 0.055684454756380515
              precision    recall  f1-score   support

           0   0.059259  0.923077  0.111369        26
           1   0.886792  0.694581  0.779006       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.292553       564
   macro avg   0.315351  0.539219  0.296791       564
weighted avg   0.321914  0.292553  0.285521       564

Test Acc: 0.2925531914893617 F1_ma:0.055684454756380515
Train step: 380 acc:0.62275 total_loss: 1.3383  loss:1.2761,stance loss: 0.84779 
Train step: 390 acc:0.62862 total_loss: 1.3308  loss:1.1443,stance loss: 0.76232 
Train step: 400 acc:0.6312 total_loss: 1.3214  loss:1.05,stance loss: 0.73762 
Train step: 410 acc:0.63165 total_loss: 1.3196  loss:1.5393,stance loss: 1.2183 
Train step: 420 acc:0.63162 total_loss: 1.3212  loss:1.4395,stance loss: 1.1488 
Better F1! Saving model!
Saving model of best f1: 0.058823529411764705
              precision    recall  f1-score   support

           0   0.062827  0.923077  0.117647        26
           1   0.873626  0.783251  0.825974       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.324468       564
   macro avg   0.312151  0.568776  0.314540       564
weighted avg   0.317340  0.324468  0.302716       564

Test Acc: 0.324468085106383 F1_ma:0.058823529411764705
Train step: 430 acc:0.62733 total_loss: 1.3341  loss:1.7376,stance loss: 1.7632 
Train step: 440 acc:0.62317 total_loss: 1.3393  loss:1.4187,stance loss: 1.0636 
Train step: 450 acc:0.62189 total_loss: 1.343  loss:1.5464,stance loss: 1.1166 
Train step: 460 acc:0.62205 total_loss: 1.3405  loss:1.1974,stance loss: 1.3437 
Train step: 470 acc:0.62469 total_loss: 1.334  loss:1.1573,stance loss: 0.89261 
Train step: 480 acc:0.62974 total_loss: 1.3269  loss:1.0593,stance loss: 0.66041 
Train step: 490 acc:0.62981 total_loss: 1.332  loss:1.2012,stance loss: 0.87618 
Train step: 500 acc:0.63068 total_loss: 1.332  loss:1.2484,stance loss: 0.87169 
Train step: 510 acc:0.63071 total_loss: 1.3268  loss:1.3288,stance loss: 0.80077 
Train step: 520 acc:0.63197 total_loss: 1.3229  loss:1.5078,stance loss: 1.1685 
Train step: 530 acc:0.63602 total_loss: 1.314  loss:1.1986,stance loss: 1.0124 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 540 acc:0.6875 total_loss: 1.351  loss:1.351,stance loss: 1.196 
Train step: 550 acc:0.63068 total_loss: 1.2969  loss:1.5696,stance loss: 1.6715 
Train step: 560 acc:0.62798 total_loss: 1.2858  loss:1.2507,stance loss: 0.89341 
Train step: 570 acc:0.64718 total_loss: 1.2671  loss:1.2578,stance loss: 1.0607 
Train step: 580 acc:0.64939 total_loss: 1.2465  loss:1.7886,stance loss: 1.4687 
Train step: 590 acc:0.65809 total_loss: 1.2351  loss:1.4411,stance loss: 1.0252 
Train step: 600 acc:0.66291 total_loss: 1.232  loss:1.2066,stance loss: 0.96245 
Train step: 610 acc:0.66109 total_loss: 1.2288  loss:0.90083,stance loss: 0.57306 
Train step: 620 acc:0.65972 total_loss: 1.225  loss:1.3825,stance loss: 1.4825 
Train step: 630 acc:0.66071 total_loss: 1.2288  loss:1.0652,stance loss: 0.74633 
Train step: 640 acc:0.65408 total_loss: 1.243  loss:1.078,stance loss: 0.75651 
Train step: 650 acc:0.65597 total_loss: 1.2451  loss:1.3286,stance loss: 1.1545 
Train step: 660 acc:0.65031 total_loss: 1.243  loss:1.1302,stance loss: 0.73615 
Train step: 670 acc:0.65315 total_loss: 1.2383  loss:0.77117,stance loss: 0.45864 
Train step: 680 acc:0.6516 total_loss: 1.2403  loss:1.217,stance loss: 0.92627 
Train step: 690 acc:0.65273 total_loss: 1.2374  loss:1.0255,stance loss: 0.76962 
Train step: 700 acc:0.65373 total_loss: 1.2374  loss:1.6332,stance loss: 1.2161 
Train step: 710 acc:0.65387 total_loss: 1.2347  loss:1.1742,stance loss: 0.85865 
Train step: 720 acc:0.65435 total_loss: 1.2418  loss:1.3639,stance loss: 1.189 
Train step: 730 acc:0.65609 total_loss: 1.238  loss:1.0798,stance loss: 0.82275 
Train step: 740 acc:0.65796 total_loss: 1.2394  loss:1.2162,stance loss: 0.90639 
Train step: 750 acc:0.6561 total_loss: 1.242  loss:1.0909,stance loss: 0.77908 
Train step: 760 acc:0.65639 total_loss: 1.2414  loss:1.4307,stance loss: 1.1807 
Train step: 770 acc:0.65855 total_loss: 1.2357  loss:1.1229,stance loss: 0.96941 
Train step: 780 acc:0.66079 total_loss: 1.2304  loss:0.90741,stance loss: 0.71495 
Train step: 790 acc:0.66111 total_loss: 1.2311  loss:1.1026,stance loss: 0.82237 
Train step: 800 acc:0.66499 total_loss: 1.2321  loss:1.2425,stance loss: 1.3559 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 810 acc:0.6875 total_loss: 1.1084  loss:1.1084,stance loss: 0.76975 
Train step: 820 acc:0.75 total_loss: 1.0781  loss:0.98172,stance loss: 0.76732 
Train step: 830 acc:0.72024 total_loss: 1.1298  loss:1.0825,stance loss: 0.63634 
Train step: 840 acc:0.71976 total_loss: 1.13  loss:1.1054,stance loss: 0.86771 
Train step: 850 acc:0.71951 total_loss: 1.1203  loss:1.0409,stance loss: 0.76304 
Train step: 860 acc:0.70833 total_loss: 1.1267  loss:1.2881,stance loss: 0.9879 
Train step: 870 acc:0.69877 total_loss: 1.1368  loss:1.3097,stance loss: 0.88285 
Train step: 880 acc:0.69982 total_loss: 1.133  loss:1.5529,stance loss: 1.7279 
Train step: 890 acc:0.69676 total_loss: 1.1357  loss:0.92044,stance loss: 0.69221 
Train step: 900 acc:0.69231 total_loss: 1.1323  loss:1.2582,stance loss: 0.82616 
Train step: 910 acc:0.68379 total_loss: 1.1434  loss:1.5989,stance loss: 1.3281 
Train step: 920 acc:0.68919 total_loss: 1.1321  loss:0.89785,stance loss: 0.67364 
Train step: 930 acc:0.68957 total_loss: 1.1435  loss:1.2205,stance loss: 0.82035 
Train step: 940 acc:0.68798 total_loss: 1.1563  loss:0.85953,stance loss: 0.69527 
Train step: 950 acc:0.68839 total_loss: 1.1641  loss:1.1893,stance loss: 0.87018 
Train step: 960 acc:0.68502 total_loss: 1.1655  loss:1.215,stance loss: 0.89446 
Train step: 970 acc:0.68595 total_loss: 1.1645  loss:1.4606,stance loss: 1.2313 
Train step: 980 acc:0.68275 total_loss: 1.1706  loss:1.1713,stance loss: 0.90557 
Train step: 990 acc:0.6837 total_loss: 1.17  loss:0.92376,stance loss: 0.68372 
Train step: 1000 acc:0.68292 total_loss: 1.1709  loss:1.2384,stance loss: 0.90779 
Train step: 1010 acc:0.68284 total_loss: 1.173  loss:1.2076,stance loss: 0.85438 
Train step: 1020 acc:0.68365 total_loss: 1.1734  loss:1.464,stance loss: 1.5889 
Train step: 1030 acc:0.68184 total_loss: 1.1768  loss:1.0781,stance loss: 0.75325 
Train step: 1040 acc:0.68155 total_loss: 1.176  loss:0.88316,stance loss: 0.65528 
Train step: 1050 acc:0.68102 total_loss: 1.1788  loss:1.1342,stance loss: 0.81066 
Train step: 1060 acc:0.68202 total_loss: 1.1767  loss:0.95872,stance loss: 0.6981 
Train step: 1070 acc:0.68127 total_loss: 1.1754  loss:1.1808,stance loss: 0.81209 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1080 acc:0.4375 total_loss: 1.3468  loss:1.3468,stance loss: 0.8812 
Train step: 1090 acc:0.60227 total_loss: 1.2647  loss:1.2126,stance loss: 0.93108 
Train step: 1100 acc:0.66071 total_loss: 1.1709  loss:1.0463,stance loss: 0.72486 
Train step: 1110 acc:0.65927 total_loss: 1.1883  loss:1.439,stance loss: 1.0938 
Train step: 1120 acc:0.66463 total_loss: 1.1726  loss:0.96358,stance loss: 0.69065 
Train step: 1130 acc:0.6777 total_loss: 1.1571  loss:0.81674,stance loss: 0.5824 
Train step: 1140 acc:0.68955 total_loss: 1.1245  loss:1.1734,stance loss: 0.97732 
Train step: 1150 acc:0.69366 total_loss: 1.1201  loss:0.99152,stance loss: 0.74042 
Train step: 1160 acc:0.69599 total_loss: 1.1088  loss:0.86687,stance loss: 0.65203 
Train step: 1170 acc:0.69231 total_loss: 1.1117  loss:1.046,stance loss: 0.79217 
Train step: 1180 acc:0.69369 total_loss: 1.0986  loss:0.97044,stance loss: 0.68997 
Train step: 1190 acc:0.6982 total_loss: 1.0877  loss:0.85802,stance loss: 0.53838 
Train step: 1200 acc:0.70196 total_loss: 1.0807  loss:0.83414,stance loss: 0.6798 
Train step: 1210 acc:0.69752 total_loss: 1.0816  loss:0.81143,stance loss: 0.63404 
Train step: 1220 acc:0.69858 total_loss: 1.0799  loss:0.84514,stance loss: 0.64726 
Train step: 1230 acc:0.6995 total_loss: 1.0832  loss:1.0035,stance loss: 0.61283 
Train step: 1240 acc:0.7007 total_loss: 1.0816  loss:0.77581,stance loss: 0.58509 
Train step: 1250 acc:0.70066 total_loss: 1.0847  loss:1.2078,stance loss: 0.88454 
Train step: 1260 acc:0.70166 total_loss: 1.0852  loss:1.0366,stance loss: 0.74872 
Train step: 1270 acc:0.70288 total_loss: 1.0762  loss:0.86023,stance loss: 0.52267 
Train step: 1280 acc:0.70522 total_loss: 1.0775  loss:0.84383,stance loss: 0.63105 
Train step: 1290 acc:0.70527 total_loss: 1.0766  loss:1.5092,stance loss: 1.5142 
Train step: 1300 acc:0.70645 total_loss: 1.0715  loss:0.84089,stance loss: 0.69633 
Train step: 1310 acc:0.70509 total_loss: 1.0721  loss:1.0662,stance loss: 0.76796 
Train step: 1320 acc:0.70513 total_loss: 1.0691  loss:0.79627,stance loss: 0.55381 
Train step: 1330 acc:0.70294 total_loss: 1.0732  loss:1.191,stance loss: 1.3295 
Train step: 1340 acc:0.70259 total_loss: 1.0799  loss:0.96856,stance loss: 0.71852 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1350 acc:0.75 total_loss: 0.86633  loss:0.86633,stance loss: 0.69302 
Train step: 1360 acc:0.65909 total_loss: 1.0578  loss:1.1396,stance loss: 1.336 
Train step: 1370 acc:0.72321 total_loss: 1.0394  loss:0.88132,stance loss: 0.63817 
Train step: 1380 acc:0.71774 total_loss: 1.0685  loss:0.67222,stance loss: 0.52582 
Train step: 1390 acc:0.71951 total_loss: 1.0454  loss:0.75113,stance loss: 0.53245 
Train step: 1400 acc:0.71078 total_loss: 1.0396  loss:0.99176,stance loss: 0.69259 
Train step: 1410 acc:0.71619 total_loss: 1.032  loss:0.60335,stance loss: 0.45093 
Train step: 1420 acc:0.72183 total_loss: 1.0286  loss:0.75398,stance loss: 0.49008 
Train step: 1430 acc:0.71836 total_loss: 1.028  loss:1.2656,stance loss: 1.0463 
Train step: 1440 acc:0.71841 total_loss: 1.0311  loss:0.88256,stance loss: 0.65023 
Train step: 1450 acc:0.7203 total_loss: 1.0335  loss:0.8227,stance loss: 0.61442 
Train step: 1460 acc:0.72128 total_loss: 1.0238  loss:0.93542,stance loss: 0.60784 
Train step: 1470 acc:0.72469 total_loss: 1.0232  loss:0.66256,stance loss: 0.53228 
Train step: 1480 acc:0.72805 total_loss: 1.0125  loss:0.90353,stance loss: 0.67201 
Train step: 1490 acc:0.72163 total_loss: 1.0192  loss:0.99402,stance loss: 0.75742 
Train step: 1500 acc:0.72103 total_loss: 1.0165  loss:0.84131,stance loss: 0.74329 
Train step: 1510 acc:0.72399 total_loss: 1.0101  loss:1.1908,stance loss: 1.0787 
Train step: 1520 acc:0.72807 total_loss: 1.0045  loss:0.61695,stance loss: 0.47082 
Train step: 1530 acc:0.72756 total_loss: 1.0039  loss:0.71384,stance loss: 0.46959 
Train step: 1540 acc:0.72611 total_loss: 1.0072  loss:0.90926,stance loss: 0.61974 
Train step: 1550 acc:0.72544 total_loss: 1.0098  loss:1.1888,stance loss: 1.362 
Train step: 1560 acc:0.72275 total_loss: 1.0187  loss:0.76016,stance loss: 0.55019 
Train step: 1570 acc:0.72455 total_loss: 1.0162  loss:0.6341,stance loss: 0.46935 
Train step: 1580 acc:0.72457 total_loss: 1.0136  loss:0.60754,stance loss: 0.42505 
Train step: 1590 acc:0.72355 total_loss: 1.0097  loss:1.1064,stance loss: 0.65078 
Train step: 1600 acc:0.72485 total_loss: 1.0068  loss:0.99806,stance loss: 1.1596 
Train step: 1610 acc:0.72438 total_loss: 1.0112  loss:1.4379,stance loss: 1.2293 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1620 acc:0.6875 total_loss: 0.93498  loss:0.93498,stance loss: 0.64342 
Train step: 1630 acc:0.74432 total_loss: 0.88408  loss:1.6,stance loss: 1.5094 
Train step: 1640 acc:0.75298 total_loss: 0.861  loss:0.85034,stance loss: 0.56846 
Better F1! Saving model!
Saving model of best f1: 0.05955334987593052
              precision    recall  f1-score   support

           0   0.063660  0.923077  0.119107        26
           1   0.802139  0.738916  0.769231       203
           2   0.000000  0.000000  0.000000       335

    accuracy                       0.308511       564
   macro avg   0.288600  0.553998  0.296112       564
weighted avg   0.291648  0.308511  0.282359       564

Test Acc: 0.30851063829787234 F1_ma:0.05955334987593052
Train step: 1650 acc:0.7621 total_loss: 0.85135  loss:1.0092,stance loss: 0.93792 
Train step: 1660 acc:0.75762 total_loss: 0.89101  loss:1.0429,stance loss: 1.1693 
Train step: 1670 acc:0.76103 total_loss: 0.91454  loss:0.82085,stance loss: 1.0673 
Train step: 1680 acc:0.76537 total_loss: 0.89382  loss:0.70669,stance loss: 0.47604 
Train step: 1690 acc:0.76232 total_loss: 0.91987  loss:0.55542,stance loss: 0.4527 
Train step: 1700 acc:0.76157 total_loss: 0.91353  loss:0.85514,stance loss: 0.6387 
Train step: 1710 acc:0.76648 total_loss: 0.91743  loss:1.1261,stance loss: 1.3984 
Train step: 1720 acc:0.763 total_loss: 0.92177  loss:0.83681,stance loss: 0.63319 
Train step: 1730 acc:0.75788 total_loss: 0.92731  loss:0.96204,stance loss: 0.73429 
Train step: 1740 acc:0.75517 total_loss: 0.92316  loss:1.062,stance loss: 0.8615 
Train step: 1750 acc:0.75525 total_loss: 0.92007  loss:1.2344,stance loss: 0.88041 
Train step: 1760 acc:0.75177 total_loss: 0.92247  loss:0.95934,stance loss: 1.3001 
Train step: 1770 acc:0.75 total_loss: 0.9176  loss:0.89877,stance loss: 0.57328 
Train step: 1780 acc:0.75039 total_loss: 0.92643  loss:1.2419,stance loss: 1.6001 
Train step: 1790 acc:0.74927 total_loss: 0.93708  loss:0.95878,stance loss: 0.77331 
Train step: 1800 acc:0.74931 total_loss: 0.93936  loss:1.123,stance loss: 1.2818 
Train step: 1810 acc:0.74902 total_loss: 0.93574  loss:0.65166,stance loss: 0.52222 
Train step: 1820 acc:0.74907 total_loss: 0.94214  loss:1.1856,stance loss: 0.95619 
Train step: 1830 acc:0.74526 total_loss: 0.94619  loss:0.86947,stance loss: 0.62861 
Train step: 1840 acc:0.74915 total_loss: 0.94308  loss:0.55762,stance loss: 0.3857 
Train step: 1850 acc:0.74838 total_loss: 0.93866  loss:0.66086,stance loss: 0.47032 
Train step: 1860 acc:0.74533 total_loss: 0.94657  loss:1.2314,stance loss: 1.4465 
Train step: 1870 acc:0.74402 total_loss: 0.9454  loss:1.2752,stance loss: 1.1065 
Train step: 1880 acc:0.7433 total_loss: 0.94981  loss:1.5286,stance loss: 1.2276 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1890 acc:0.6875 total_loss: 1.1259  loss:1.1259,stance loss: 0.93019 
Train step: 1900 acc:0.78409 total_loss: 0.86285  loss:0.5777,stance loss: 0.46699 
Train step: 1910 acc:0.78571 total_loss: 0.88174  loss:1.1165,stance loss: 0.56506 
Train step: 1920 acc:0.77823 total_loss: 0.90772  loss:0.64624,stance loss: 0.50247 
Train step: 1930 acc:0.78506 total_loss: 0.88339  loss:0.57485,stance loss: 0.39952 
Train step: 1940 acc:0.79289 total_loss: 0.85818  loss:0.64195,stance loss: 0.4752 
Train step: 1950 acc:0.78381 total_loss: 0.85775  loss:1.4788,stance loss: 1.6573 
Train step: 1960 acc:0.78257 total_loss: 0.84715  loss:0.59818,stance loss: 0.44427 
Train step: 1970 acc:0.78164 total_loss: 0.84582  loss:0.74042,stance loss: 0.5464 
Train step: 1980 acc:0.78434 total_loss: 0.82493  loss:0.56099,stance loss: 0.42015 
Train step: 1990 acc:0.78156 total_loss: 0.83607  loss:0.95045,stance loss: 0.80362 
Train step: 2000 acc:0.78097 total_loss: 0.82836  loss:0.54969,stance loss: 0.44202 
Train step: 2010 acc:0.77996 total_loss: 0.83034  loss:0.79127,stance loss: 0.70201 
Train step: 2020 acc:0.78244 total_loss: 0.82926  loss:0.97278,stance loss: 1.3167 
Train step: 2030 acc:0.77837 total_loss: 0.83831  loss:1.0248,stance loss: 0.74633 
Train step: 2040 acc:0.7769 total_loss: 0.82969  loss:0.8179,stance loss: 0.65631 
Train step: 2050 acc:0.77562 total_loss: 0.83914  loss:0.95034,stance loss: 0.62931 
Train step: 2060 acc:0.77632 total_loss: 0.83481  loss:0.47898,stance loss: 0.37676 
Train step: 2070 acc:0.77452 total_loss: 0.84262  loss:1.0571,stance loss: 0.85542 
Train step: 2080 acc:0.77552 total_loss: 0.83707  loss:0.71458,stance loss: 0.59958 
Train step: 2090 acc:0.7727 total_loss: 0.83565  loss:1.0863,stance loss: 0.90378 
Train step: 2100 acc:0.77073 total_loss: 0.83851  loss:0.6876,stance loss: 0.56502 
Train step: 2110 acc:0.77347 total_loss: 0.83553  loss:1.0076,stance loss: 1.219 
Train step: 2120 acc:0.77165 total_loss: 0.83871  loss:0.79075,stance loss: 0.54032 
Train step: 2130 acc:0.77204 total_loss: 0.84163  loss:0.78125,stance loss: 0.53714 
Train step: 2140 acc:0.77341 total_loss: 0.83988  loss:0.83198,stance loss: 0.62723 
Train step: 2150 acc:0.77562 total_loss: 0.83806  loss:0.50705,stance loss: 0.39454 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2160 acc:0.8125 total_loss: 0.76745  loss:0.76745,stance loss: 0.60666 
Train step: 2170 acc:0.78409 total_loss: 0.761  loss:1.2955,stance loss: 1.5861 
Train step: 2180 acc:0.77381 total_loss: 0.75653  loss:0.77699,stance loss: 0.58932 
Train step: 2190 acc:0.79032 total_loss: 0.78037  loss:1.0836,stance loss: 1.0167 
Train step: 2200 acc:0.79116 total_loss: 0.77829  loss:1.161,stance loss: 0.98789 
Better F1! Saving model!
Saving model of best f1: 0.06659753970872415
              precision    recall  f1-score   support

           0   0.049140  0.769231  0.092379        26
           1   0.818792  0.600985  0.693182       203
           2   0.875000  0.020896  0.040816       335

    accuracy                       0.264184       564
   macro avg   0.580977  0.463704  0.275459       564
weighted avg   0.816698  0.264184  0.277999       564

Test Acc: 0.2641843971631206 F1_ma:0.06659753970872415
Train step: 2210 acc:0.78554 total_loss: 0.80016  loss:0.5556,stance loss: 0.36088 
Better F1! Saving model!
Saving model of best f1: 0.10474216718585072
              precision    recall  f1-score   support

           0   0.049020  0.769231  0.092166        26
           1   0.819549  0.536946  0.648810       203
           2   0.913043  0.062687  0.117318       335

    accuracy                       0.265957       564
   macro avg   0.593871  0.456288  0.286098       564
weighted avg   0.839561  0.265957  0.307458       564

Test Acc: 0.26595744680851063 F1_ma:0.10474216718585072
Train step: 2220 acc:0.78893 total_loss: 0.80659  loss:1.1308,stance loss: 0.93089 
Train step: 2230 acc:0.78609 total_loss: 0.82304  loss:0.73986,stance loss: 0.60463 
Train step: 2240 acc:0.79012 total_loss: 0.82359  loss:0.62925,stance loss: 0.47187 
Train step: 2250 acc:0.7919 total_loss: 0.81905  loss:0.64673,stance loss: 0.50077 
Train step: 2260 acc:0.79703 total_loss: 0.82324  loss:0.52654,stance loss: 0.39689 
Train step: 2270 acc:0.80349 total_loss: 0.82766  loss:0.8799,stance loss: 1.1141 
Train step: 2280 acc:0.8032 total_loss: 0.82241  loss:1.1731,stance loss: 1.53 
Train step: 2290 acc:0.80344 total_loss: 0.82725  loss:1.0857,stance loss: 0.78735 
Train step: 2300 acc:0.80363 total_loss: 0.8222  loss:0.78249,stance loss: 1.0742 
Train step: 2310 acc:0.80505 total_loss: 0.81207  loss:0.52756,stance loss: 0.3945 
Train step: 2320 acc:0.80668 total_loss: 0.80729  loss:0.66715,stance loss: 0.53668 
Train step: 2330 acc:0.80702 total_loss: 0.79939  loss:0.41818,stance loss: 0.3167 
Train step: 2340 acc:0.8087 total_loss: 0.79866  loss:1.2372,stance loss: 1.4076 
Train step: 2350 acc:0.80563 total_loss: 0.80417  loss:0.6816,stance loss: 0.56366 
Train step: 2360 acc:0.80566 total_loss: 0.80669  loss:0.70663,stance loss: 0.6998 
Train step: 2370 acc:0.80746 total_loss: 0.80038  loss:0.43442,stance loss: 0.36168 
Train step: 2380 acc:0.80713 total_loss: 0.79921  loss:1.1867,stance loss: 1.4244 
Train step: 2390 acc:0.80682 total_loss: 0.7978  loss:0.71945,stance loss: 0.5908 
Train step: 2400 acc:0.80498 total_loss: 0.80244  loss:0.82571,stance loss: 0.51401 
Train step: 2410 acc:0.80652 total_loss: 0.79467  loss:0.46634,stance loss: 0.34447 
Train step: 2420 acc:0.80843 total_loss: 0.78802  loss:0.69532,stance loss: 0.52588 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.625 total_loss: 0.69048  loss:0.69048,stance loss: 0.45131 
Train step: 2440 acc:0.82386 total_loss: 0.6323  loss:0.5575,stance loss: 0.53051 
Train step: 2450 acc:0.8244 total_loss: 0.63468  loss:0.7308,stance loss: 0.58686 
Train step: 2460 acc:0.82661 total_loss: 0.69909  loss:0.44621,stance loss: 0.35355 
Train step: 2470 acc:0.83384 total_loss: 0.68217  loss:0.48461,stance loss: 0.4086 
Train step: 2480 acc:0.83701 total_loss: 0.69631  loss:0.55779,stance loss: 0.31144 
Train step: 2490 acc:0.83811 total_loss: 0.6972  loss:0.6793,stance loss: 1.0466 
Train step: 2500 acc:0.83627 total_loss: 0.69798  loss:0.59351,stance loss: 0.51675 
Train step: 2510 acc:0.83642 total_loss: 0.69444  loss:0.3216,stance loss: 0.23138 
Train step: 2520 acc:0.83104 total_loss: 0.68728  loss:0.50156,stance loss: 0.36935 
Train step: 2530 acc:0.83292 total_loss: 0.67968  loss:0.70348,stance loss: 0.62537 
Better F1! Saving model!
Saving model of best f1: 0.14616666666666667
              precision    recall  f1-score   support

           0   0.050802  0.730769  0.095000        26
           1   0.800000  0.591133  0.679887       203
           2   0.925000  0.110448  0.197333       335

    accuracy                       0.312057       564
   macro avg   0.591934  0.477450  0.324073       564
weighted avg   0.839709  0.312057  0.366301       564

Test Acc: 0.3120567375886525 F1_ma:0.14616666666666667
Train step: 2540 acc:0.83333 total_loss: 0.68013  loss:0.87965,stance loss: 1.146 
Train step: 2550 acc:0.83368 total_loss: 0.67446  loss:0.64205,stance loss: 0.50151 
Train step: 2560 acc:0.8354 total_loss: 0.66812  loss:0.58722,stance loss: 0.43087 
Train step: 2570 acc:0.83644 total_loss: 0.66269  loss:0.94026,stance loss: 1.1184 
Train step: 2580 acc:0.83485 total_loss: 0.67826  loss:1.2975,stance loss: 1.5543 
Train step: 2590 acc:0.83346 total_loss: 0.68077  loss:0.61831,stance loss: 0.50648 
Train step: 2600 acc:0.83297 total_loss: 0.68115  loss:0.58146,stance loss: 0.43253 
Train step: 2610 acc:0.83184 total_loss: 0.69293  loss:0.95382,stance loss: 0.86606 
Train step: 2620 acc:0.83017 total_loss: 0.69948  loss:1.2469,stance loss: 1.1937 
Train step: 2630 acc:0.83022 total_loss: 0.69902  loss:0.89852,stance loss: 0.59458 
Train step: 2640 acc:0.83057 total_loss: 0.69541  loss:0.84039,stance loss: 1.2331 
Train step: 2650 acc:0.83117 total_loss: 0.68895  loss:0.33535,stance loss: 0.097893 
Train step: 2660 acc:0.83144 total_loss: 0.68758  loss:0.22047,stance loss: 0.15154 
Train step: 2670 acc:0.83195 total_loss: 0.68867  loss:0.52195,stance loss: 0.37642 
Train step: 2680 acc:0.83167 total_loss: 0.69335  loss:1.0362,stance loss: 1.3941 
Train step: 2690 acc:0.83214 total_loss: 0.68681  loss:0.63826,stance loss: 0.39217 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.8125 total_loss: 0.58794  loss:0.58794,stance loss: 0.41558 
Train step: 2710 acc:0.875 total_loss: 0.62069  loss:0.9359,stance loss: 1.0848 
Train step: 2720 acc:0.87798 total_loss: 0.64116  loss:0.47615,stance loss: 0.26409 
Train step: 2730 acc:0.875 total_loss: 0.67033  loss:0.60717,stance loss: 0.41198 
Train step: 2740 acc:0.85518 total_loss: 0.6677  loss:0.74285,stance loss: 0.54927 
Train step: 2750 acc:0.85907 total_loss: 0.68389  loss:0.43249,stance loss: 0.31727 
Train step: 2760 acc:0.86066 total_loss: 0.6521  loss:0.55191,stance loss: 0.45127 
Train step: 2770 acc:0.86004 total_loss: 0.64098  loss:0.43712,stance loss: 0.30938 
Train step: 2780 acc:0.85725 total_loss: 0.6405  loss:0.76648,stance loss: 0.62696 
Better F1! Saving model!
Saving model of best f1: 0.22092009685230024
              precision    recall  f1-score   support

           0   0.055556  0.692308  0.102857        26
           1   0.814815  0.650246  0.723288       203
           2   0.897436  0.208955  0.338983       335

    accuracy                       0.390071       564
   macro avg   0.589269  0.517170  0.388376       564
weighted avg   0.828888  0.390071  0.466420       564

Test Acc: 0.3900709219858156 F1_ma:0.22092009685230024
Train step: 2790 acc:0.86401 total_loss: 0.62642  loss:0.5185,stance loss: 0.34637 
Train step: 2800 acc:0.86448 total_loss: 0.62982  loss:0.86093,stance loss: 0.70561 
Train step: 2810 acc:0.86543 total_loss: 0.6143  loss:0.21377,stance loss: 0.084166 
Train step: 2820 acc:0.86622 total_loss: 0.60732  loss:0.3677,stance loss: 0.29187 
Train step: 2830 acc:0.86546 total_loss: 0.61324  loss:0.39078,stance loss: 0.33915 
Train step: 2840 acc:0.86658 total_loss: 0.61069  loss:0.99068,stance loss: 1.3551 
Train step: 2850 acc:0.86548 total_loss: 0.60883  loss:0.24521,stance loss: 0.15033 
Train step: 2860 acc:0.86374 total_loss: 0.60173  loss:0.4902,stance loss: 0.35598 
Train step: 2870 acc:0.86623 total_loss: 0.59502  loss:0.63048,stance loss: 0.53475 
Train step: 2880 acc:0.86533 total_loss: 0.59412  loss:0.56538,stance loss: 0.40677 
Train step: 2890 acc:0.8642 total_loss: 0.60149  loss:1.021,stance loss: 1.3924 
Train step: 2900 acc:0.86381 total_loss: 0.60139  loss:0.6967,stance loss: 0.57227 
Train step: 2910 acc:0.86345 total_loss: 0.60579  loss:0.45303,stance loss: 0.43461 
Train step: 2920 acc:0.86171 total_loss: 0.60535  loss:0.41111,stance loss: 0.29571 
Train step: 2930 acc:0.86174 total_loss: 0.59838  loss:0.37634,stance loss: 0.30563 
Train step: 2940 acc:0.86203 total_loss: 0.59691  loss:0.7177,stance loss: 0.65288 
Train step: 2950 acc:0.86081 total_loss: 0.60359  loss:0.72144,stance loss: 1.0972 
Train step: 2960 acc:0.85991 total_loss: 0.60584  loss:0.39454,stance loss: 0.33811 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2970 acc:0.75 total_loss: 1.07  loss:1.07,stance loss: 1.2562 
Train step: 2980 acc:0.85227 total_loss: 0.59321  loss:0.52921,stance loss: 0.4492 
Train step: 2990 acc:0.85714 total_loss: 0.59236  loss:0.64371,stance loss: 0.45988 
Train step: 3000 acc:0.86895 total_loss: 0.56806  loss:0.39582,stance loss: 0.30619 
Train step: 3010 acc:0.87957 total_loss: 0.55831  loss:0.40696,stance loss: 0.23815 
Train step: 3020 acc:0.87377 total_loss: 0.54629  loss:0.8706,stance loss: 1.0845 
Train step: 3030 acc:0.86885 total_loss: 0.56876  loss:0.85664,stance loss: 0.61157 
Train step: 3040 acc:0.8706 total_loss: 0.56019  loss:0.90273,stance loss: 1.2571 
Train step: 3050 acc:0.8696 total_loss: 0.57781  loss:0.66239,stance loss: 1.0478 
Train step: 3060 acc:0.87569 total_loss: 0.56157  loss:0.23963,stance loss: 0.21535 
Better F1! Saving model!
Saving model of best f1: 0.24199843871975021
              precision    recall  f1-score   support

           0   0.051360  0.653846  0.095238        26
           1   0.822695  0.571429  0.674419       203
           2   0.902174  0.247761  0.388759       335

    accuracy                       0.382979       564
   macro avg   0.592076  0.491012  0.386138       564
weighted avg   0.834345  0.382979  0.478045       564

Test Acc: 0.3829787234042553 F1_ma:0.24199843871975021
Train step: 3070 acc:0.88119 total_loss: 0.55002  loss:0.45626,stance loss: 0.33974 
Train step: 3080 acc:0.88007 total_loss: 0.54919  loss:0.96289,stance loss: 1.274 
Train step: 3090 acc:0.88378 total_loss: 0.54259  loss:0.17495,stance loss: 0.072346 
Train step: 3100 acc:0.88454 total_loss: 0.53488  loss:0.36555,stance loss: 0.35801 
Train step: 3110 acc:0.88608 total_loss: 0.52495  loss:0.21151,stance loss: 0.12841 
Train step: 3120 acc:0.88286 total_loss: 0.53188  loss:0.84746,stance loss: 1.1428 
Train step: 3130 acc:0.88082 total_loss: 0.54376  loss:0.17156,stance loss: 0.095844 
Train step: 3140 acc:0.88121 total_loss: 0.54901  loss:0.48642,stance loss: 0.38523 
Train step: 3150 acc:0.88156 total_loss: 0.55786  loss:0.62573,stance loss: 1.0375 
Train step: 3160 acc:0.8822 total_loss: 0.56464  loss:0.53928,stance loss: 0.53782 
Train step: 3170 acc:0.88371 total_loss: 0.56311  loss:0.39898,stance loss: 0.35977 
Train step: 3180 acc:0.88181 total_loss: 0.56574  loss:0.30851,stance loss: 0.25668 
Train step: 3190 acc:0.8815 total_loss: 0.56062  loss:0.62444,stance loss: 0.40339 
Train step: 3200 acc:0.88258 total_loss: 0.55363  loss:1.1113,stance loss: 1.0046 
Train step: 3210 acc:0.88071 total_loss: 0.55513  loss:0.87674,stance loss: 0.72866 
Train step: 3220 acc:0.88073 total_loss: 0.5553  loss:0.59162,stance loss: 0.51822 
Train step: 3230 acc:0.88194 total_loss: 0.55121  loss:0.35983,stance loss: 0.29785 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3240 acc:0.9375 total_loss: 0.76347  loss:0.76347,stance loss: 1.1405 
Train step: 3250 acc:0.875 total_loss: 0.43563  loss:0.29576,stance loss: 0.23076 
Train step: 3260 acc:0.89286 total_loss: 0.47275  loss:0.11467,stance loss: 0.045996 
Train step: 3270 acc:0.90524 total_loss: 0.45504  loss:0.1882,stance loss: 0.084608 
Train step: 3280 acc:0.91159 total_loss: 0.49127  loss:0.87421,stance loss: 1.2317 
Train step: 3290 acc:0.90686 total_loss: 0.5084  loss:0.36673,stance loss: 0.31802 
Train step: 3300 acc:0.90881 total_loss: 0.52577  loss:0.32579,stance loss: 0.25583 
Train step: 3310 acc:0.91373 total_loss: 0.51822  loss:0.2737,stance loss: 0.1901 
Train step: 3320 acc:0.90972 total_loss: 0.51946  loss:0.26084,stance loss: 0.19655 
Train step: 3330 acc:0.90865 total_loss: 0.50229  loss:0.4138,stance loss: 0.32072 
Train step: 3340 acc:0.91027 total_loss: 0.4931  loss:0.37883,stance loss: 0.3054 
Train step: 3350 acc:0.91104 total_loss: 0.49282  loss:0.19631,stance loss: 0.15238 
Train step: 3360 acc:0.91219 total_loss: 0.47896  loss:0.37192,stance loss: 0.32279 
Train step: 3370 acc:0.91221 total_loss: 0.47799  loss:0.050348,stance loss: 0.0012244 
Train step: 3380 acc:0.9109 total_loss: 0.47419  loss:0.2772,stance loss: 0.24321 
Train step: 3390 acc:0.91349 total_loss: 0.46482  loss:0.34044,stance loss: 0.2691 
Train step: 3400 acc:0.91343 total_loss: 0.46218  loss:0.43347,stance loss: 0.342 
Train step: 3410 acc:0.91484 total_loss: 0.461  loss:0.67498,stance loss: 1.0718 
Train step: 3420 acc:0.91298 total_loss: 0.45852  loss:0.59329,stance loss: 1.0265 
Train step: 3430 acc:0.9123 total_loss: 0.45835  loss:0.14539,stance loss: 0.050438 
Train step: 3440 acc:0.91262 total_loss: 0.45706  loss:0.70889,stance loss: 1.0713 
Train step: 3450 acc:0.91143 total_loss: 0.46405  loss:0.4091,stance loss: 0.37578 
Train step: 3460 acc:0.9112 total_loss: 0.46487  loss:0.53038,stance loss: 0.53106 
Train step: 3470 acc:0.91126 total_loss: 0.46474  loss:1.2434,stance loss: 1.4739 
Train step: 3480 acc:0.91183 total_loss: 0.45928  loss:0.45447,stance loss: 0.37579 
Train step: 3490 acc:0.91185 total_loss: 0.46092  loss:0.66511,stance loss: 0.51482 
Train step: 3500 acc:0.9114 total_loss: 0.46187  loss:0.62995,stance loss: 0.50588 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3510 acc:1.0 total_loss: 0.64978  loss:0.64978,stance loss: 1.105 
Train step: 3520 acc:0.96023 total_loss: 0.3744  loss:0.18252,stance loss: 0.11442 
Train step: 3530 acc:0.96131 total_loss: 0.36004  loss:0.22339,stance loss: 0.16649 
Train step: 3540 acc:0.95968 total_loss: 0.36381  loss:1.0666,stance loss: 1.3534 
Train step: 3550 acc:0.95884 total_loss: 0.34012  loss:0.14677,stance loss: 0.03699 
Train step: 3560 acc:0.94853 total_loss: 0.37509  loss:0.37224,stance loss: 0.34336 
Train step: 3570 acc:0.9457 total_loss: 0.37564  loss:0.15689,stance loss: 0.084516 
Train step: 3580 acc:0.9419 total_loss: 0.37019  loss:0.43047,stance loss: 0.36712 
Train step: 3590 acc:0.93519 total_loss: 0.38614  loss:0.40146,stance loss: 0.28272 
Train step: 3600 acc:0.93681 total_loss: 0.38136  loss:0.17058,stance loss: 0.084189 
Train step: 3610 acc:0.92884 total_loss: 0.39035  loss:0.39606,stance loss: 0.35674 
Better F1! Saving model!
Saving model of best f1: 0.26047379244885044
              precision    recall  f1-score   support

           0   0.058282  0.730769  0.107955        26
           1   0.838028  0.586207  0.689855       203
           2   0.927083  0.265672  0.412993       335

    accuracy                       0.402482       564
   macro avg   0.607798  0.527549  0.403601       564
weighted avg   0.854979  0.402482  0.498582       564

Test Acc: 0.4024822695035461 F1_ma:0.26047379244885044
Train step: 3620 acc:0.92962 total_loss: 0.39093  loss:0.28354,stance loss: 0.24578 
Train step: 3630 acc:0.92717 total_loss: 0.41194  loss:1.3262,stance loss: 2.0955 
Train step: 3640 acc:0.92844 total_loss: 0.40694  loss:0.40456,stance loss: 0.36995 
Train step: 3650 acc:0.92908 total_loss: 0.39704  loss:0.22407,stance loss: 0.1668 
Train step: 3660 acc:0.92674 total_loss: 0.40991  loss:0.32578,stance loss: 0.25706 
Train step: 3670 acc:0.92741 total_loss: 0.40391  loss:0.10777,stance loss: 0.0037721 
Train step: 3680 acc:0.92727 total_loss: 0.40685  loss:0.34849,stance loss: 0.31912 
Train step: 3690 acc:0.92714 total_loss: 0.40666  loss:0.80718,stance loss: 1.0884 
Train step: 3700 acc:0.92605 total_loss: 0.40532  loss:0.35815,stance loss: 0.3227 
Train step: 3710 acc:0.92568 total_loss: 0.40886  loss:0.61068,stance loss: 0.63319 
Train step: 3720 acc:0.92506 total_loss: 0.40852  loss:0.22797,stance loss: 0.19743 
Train step: 3730 acc:0.92619 total_loss: 0.40997  loss:0.21448,stance loss: 0.13088 
Train step: 3740 acc:0.92614 total_loss: 0.40778  loss:0.47644,stance loss: 0.43402 
Train step: 3750 acc:0.92687 total_loss: 0.40769  loss:0.3654,stance loss: 0.23872 
Train step: 3760 acc:0.9258 total_loss: 0.41558  loss:0.19198,stance loss: 0.1038 
Train step: 3770 acc:0.92768 total_loss: 0.40683  loss:0.099493,stance loss: 0.047916 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3780 acc:0.875 total_loss: 1.0763  loss:1.0763,stance loss: 1.4581 
Train step: 3790 acc:0.9375 total_loss: 0.40306  loss:0.64076,stance loss: 0.39815 
Train step: 3800 acc:0.94345 total_loss: 0.4081  loss:0.34538,stance loss: 0.26368 
Train step: 3810 acc:0.94758 total_loss: 0.37107  loss:0.49874,stance loss: 0.44923 
Train step: 3820 acc:0.94817 total_loss: 0.34066  loss:0.084472,stance loss: 0.024842 
Train step: 3830 acc:0.9473 total_loss: 0.35565  loss:0.21685,stance loss: 0.16557 
Train step: 3840 acc:0.94775 total_loss: 0.36055  loss:1.2097,stance loss: 2.0724 
Train step: 3850 acc:0.94894 total_loss: 0.36134  loss:0.4624,stance loss: 0.26444 
Train step: 3860 acc:0.94985 total_loss: 0.35139  loss:0.24122,stance loss: 0.063024 
Train step: 3870 acc:0.94849 total_loss: 0.34658  loss:0.12293,stance loss: 0.032847 
Train step: 3880 acc:0.94678 total_loss: 0.35556  loss:0.086865,stance loss: 0.026341 
Train step: 3890 acc:0.94707 total_loss: 0.35795  loss:0.43919,stance loss: 0.27447 
Train step: 3900 acc:0.94783 total_loss: 0.34394  loss:0.25858,stance loss: 0.18004 
Train step: 3910 acc:0.9437 total_loss: 0.3512  loss:0.87068,stance loss: 1.255 
Train step: 3920 acc:0.94459 total_loss: 0.35141  loss:0.86264,stance loss: 0.85733 
Train step: 3930 acc:0.94371 total_loss: 0.35228  loss:0.23623,stance loss: 0.061852 
Train step: 3940 acc:0.94255 total_loss: 0.34831  loss:0.23469,stance loss: 0.20581 
Train step: 3950 acc:0.94444 total_loss: 0.34416  loss:0.57802,stance loss: 0.56159 
Train step: 3960 acc:0.9451 total_loss: 0.34155  loss:0.16632,stance loss: 0.15569 
Train step: 3970 acc:0.94372 total_loss: 0.34478  loss:0.70145,stance loss: 1.1726 
Train step: 3980 acc:0.94341 total_loss: 0.34025  loss:0.083878,stance loss: 0.033832 
Train step: 3990 acc:0.94254 total_loss: 0.34475  loss:0.32691,stance loss: 0.28096 
Train step: 4000 acc:0.94287 total_loss: 0.34402  loss:0.10065,stance loss: 0.052242 
Train step: 4010 acc:0.94129 total_loss: 0.35254  loss:0.31172,stance loss: 0.2804 
Train step: 4020 acc:0.94191 total_loss: 0.35748  loss:0.13018,stance loss: 0.086381 
Train step: 4030 acc:0.94148 total_loss: 0.36146  loss:0.1272,stance loss: 0.11185 
Train step: 4040 acc:0.94181 total_loss: 0.36065  loss:0.23971,stance loss: 0.20092 
Training finished.


Reload the best model with best f1 0.26047379244885044 from path test_outputs/bert-cross-topic/cc/2023-08-14 16-35-05/state_dict


              precision    recall  f1-score   support

           0   0.058282  0.730769  0.107955        26
           1   0.838028  0.586207  0.689855       203
           2   0.927083  0.265672  0.412993       335

    accuracy                       0.402482       564
   macro avg   0.607798  0.527549  0.403601       564
weighted avg   0.854979  0.402482  0.498582       564

Test Acc: 0.4024822695035461 F1_ma:0.26047379244885044
Test dataset: cc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.26047379244885044
acc: 0.4024822695035461, f1 :0.4036008857871563
classification report: 
              precision    recall  f1-score   support

         Con     0.0583    0.7308    0.1080        26
        None     0.8380    0.5862    0.6899       203
         Pro     0.9271    0.2657    0.4130       335

    accuracy                         0.4025       564
   macro avg     0.6078    0.5275    0.4036       564
weighted avg     0.8550    0.4025    0.4986       564

