run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 13-40-54', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 13-40-54
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.8432  loss:1.8432,stance loss: 0.81165 
Train step: 10 acc:0.24432 total_loss: 1.9525  loss:2.3176,stance loss: 1.7631 
Train step: 20 acc:0.28869 total_loss: 1.8688  loss:1.74,stance loss: 1.2544 
Train step: 30 acc:0.29637 total_loss: 1.8265  loss:1.6617,stance loss: 1.185 
Train step: 40 acc:0.28354 total_loss: 1.8079  loss:1.5897,stance loss: 0.97154 
Better F1! Saving model!
Saving model of best f1: 0.004282655246252677
              precision    recall  f1-score   support

           0   0.666667  0.004310  0.008565       464
           1   0.197260  0.993103  0.329143       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.199181       733
   macro avg   0.287976  0.332471  0.112569       733
weighted avg   0.461031  0.199181  0.070532       733

Test Acc: 0.19918144611186903 F1_ma:0.004282655246252677
Train step: 50 acc:0.29044 total_loss: 1.7876  loss:1.5777,stance loss: 1.0151 
Better F1! Saving model!
Saving model of best f1: 0.3875838926174497
              precision    recall  f1-score   support

           0   0.634615  0.995690  0.775168       464
           1   0.200000  0.006897  0.013333       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.631651       733
   macro avg   0.278205  0.334195  0.262834       733
weighted avg   0.441284  0.631651  0.493330       733

Test Acc: 0.6316507503410641 F1_ma:0.3875838926174497
Train step: 60 acc:0.29611 total_loss: 1.775  loss:1.6784,stance loss: 1.218 
Better F1! Saving model!
Saving model of best f1: 0.3879598662207358
              precision    recall  f1-score   support

           0   0.633880  1.000000  0.775920       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211293  0.333333  0.258640       733
weighted avg   0.401255  0.633015  0.491169       733

Test Acc: 0.6330150068212824 F1_ma:0.3879598662207358
Train step: 70 acc:0.32042 total_loss: 1.7642  loss:1.7899,stance loss: 1.2329 
Train step: 80 acc:0.33179 total_loss: 1.7485  loss:1.4461,stance loss: 0.9094 
Train step: 90 acc:0.34203 total_loss: 1.7407  loss:1.5831,stance loss: 1.1898 
Train step: 100 acc:0.35025 total_loss: 1.7342  loss:1.6738,stance loss: 1.1672 
Train step: 110 acc:0.36318 total_loss: 1.7231  loss:1.6448,stance loss: 1.1648 
Train step: 120 acc:0.37242 total_loss: 1.718  loss:1.5338,stance loss: 1.0652 
Train step: 130 acc:0.38502 total_loss: 1.7105  loss:1.6515,stance loss: 1.2052 
Train step: 140 acc:0.39007 total_loss: 1.7033  loss:1.6689,stance loss: 1.1295 
Train step: 150 acc:0.39528 total_loss: 1.6956  loss:1.5323,stance loss: 1.0562 
Train step: 160 acc:0.40023 total_loss: 1.6912  loss:1.5025,stance loss: 1.1029 
Train step: 170 acc:0.40716 total_loss: 1.6851  loss:1.5188,stance loss: 1.1139 
Train step: 180 acc:0.41057 total_loss: 1.6766  loss:1.6976,stance loss: 1.1441 
Train step: 190 acc:0.41623 total_loss: 1.6684  loss:1.2935,stance loss: 0.88616 
Train step: 200 acc:0.41978 total_loss: 1.6632  loss:1.5176,stance loss: 1.047 
Train step: 210 acc:0.42802 total_loss: 1.6529  loss:1.2342,stance loss: 0.84411 
Train step: 220 acc:0.43354 total_loss: 1.6457  loss:1.4392,stance loss: 1.0196 
Train step: 230 acc:0.43885 total_loss: 1.6411  loss:1.5503,stance loss: 1.1361 
Train step: 240 acc:0.44554 total_loss: 1.6306  loss:1.2077,stance loss: 0.79787 
Train step: 250 acc:0.4502 total_loss: 1.6251  loss:1.5902,stance loss: 1.2282 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.625 total_loss: 1.5942  loss:1.5598,stance loss: 1.6207 
Train step: 270 acc:0.5625 total_loss: 1.4853  loss:1.6499,stance loss: 1.267 
Train step: 280 acc:0.57955 total_loss: 1.4892  loss:1.3944,stance loss: 1.0959 
Train step: 290 acc:0.57617 total_loss: 1.4713  loss:1.2875,stance loss: 0.88198 
Train step: 300 acc:0.56101 total_loss: 1.4741  loss:1.2747,stance loss: 0.94366 
Train step: 310 acc:0.55889 total_loss: 1.4668  loss:1.5173,stance loss: 1.0574 
Train step: 320 acc:0.55444 total_loss: 1.4656  loss:1.2835,stance loss: 0.99458 
Train step: 330 acc:0.56858 total_loss: 1.4562  loss:1.2263,stance loss: 0.88616 
Train step: 340 acc:0.57317 total_loss: 1.4465  loss:1.3877,stance loss: 1.1021 
Train step: 350 acc:0.57405 total_loss: 1.4489  loss:1.5197,stance loss: 1.1468 
Train step: 360 acc:0.58027 total_loss: 1.4363  loss:1.3826,stance loss: 1.1418 
Train step: 370 acc:0.57087 total_loss: 1.4485  loss:1.4772,stance loss: 1.469 
Train step: 380 acc:0.57121 total_loss: 1.4441  loss:1.4516,stance loss: 1.1624 
Train step: 390 acc:0.57102 total_loss: 1.4384  loss:1.3456,stance loss: 0.83119 
Train step: 400 acc:0.5691 total_loss: 1.446  loss:1.3777,stance loss: 0.96773 
Train step: 410 acc:0.57072 total_loss: 1.4468  loss:1.4956,stance loss: 1.222 
Train step: 420 acc:0.57407 total_loss: 1.4429  loss:1.2588,stance loss: 0.9265 
Train step: 430 acc:0.58067 total_loss: 1.433  loss:1.3506,stance loss: 1.0964 
Train step: 440 acc:0.58276 total_loss: 1.4325  loss:1.4208,stance loss: 1.0107 
Train step: 450 acc:0.5804 total_loss: 1.4311  loss:1.7778,stance loss: 1.2722 
Train step: 460 acc:0.58168 total_loss: 1.4284  loss:1.1101,stance loss: 0.79163 
Train step: 470 acc:0.58137 total_loss: 1.4272  loss:0.84171,stance loss: 0.45322 
Train step: 480 acc:0.58305 total_loss: 1.428  loss:1.6624,stance loss: 1.2925 
Train step: 490 acc:0.58244 total_loss: 1.4258  loss:1.5484,stance loss: 1.2966 
Train step: 500 acc:0.58419 total_loss: 1.4221  loss:1.2228,stance loss: 0.96328 
Train step: 510 acc:0.58606 total_loss: 1.4187  loss:1.1039,stance loss: 0.80068 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.625 total_loss: 1.3158  loss:1.4993,stance loss: 1.5316 
Train step: 530 acc:0.62019 total_loss: 1.328  loss:1.1075,stance loss: 0.84716 
Train step: 540 acc:0.63859 total_loss: 1.2977  loss:1.5423,stance loss: 1.2444 
Train step: 550 acc:0.64962 total_loss: 1.2858  loss:1.3747,stance loss: 1.1522 
Train step: 560 acc:0.63953 total_loss: 1.303  loss:1.0424,stance loss: 0.76064 
Train step: 570 acc:0.63915 total_loss: 1.2859  loss:1.2654,stance loss: 0.83755 
Train step: 580 acc:0.64187 total_loss: 1.2686  loss:1.1405,stance loss: 0.89079 
Train step: 590 acc:0.64041 total_loss: 1.2706  loss:1.3616,stance loss: 1.0967 
Train step: 600 acc:0.63404 total_loss: 1.2902  loss:1.2562,stance loss: 0.91976 
Train step: 610 acc:0.62433 total_loss: 1.3105  loss:1.2801,stance loss: 0.96151 
Train step: 620 acc:0.62621 total_loss: 1.3055  loss:1.0673,stance loss: 0.7369 
Train step: 630 acc:0.62389 total_loss: 1.3172  loss:1.4796,stance loss: 1.1032 
Train step: 640 acc:0.62805 total_loss: 1.3127  loss:1.4368,stance loss: 1.0338 
Train step: 650 acc:0.62547 total_loss: 1.3173  loss:1.0151,stance loss: 0.89867 
Train step: 660 acc:0.625 total_loss: 1.3185  loss:1.1231,stance loss: 0.82417 
Train step: 670 acc:0.62663 total_loss: 1.3128  loss:1.1357,stance loss: 0.8908 
Train step: 680 acc:0.6273 total_loss: 1.316  loss:1.2247,stance loss: 0.88941 
Train step: 690 acc:0.62536 total_loss: 1.3198  loss:1.5446,stance loss: 1.2797 
Train step: 700 acc:0.6209 total_loss: 1.3213  loss:1.3143,stance loss: 0.99411 
Train step: 710 acc:0.62306 total_loss: 1.3192  loss:1.0282,stance loss: 0.81526 
Train step: 720 acc:0.62438 total_loss: 1.3175  loss:1.0609,stance loss: 0.81986 
Train step: 730 acc:0.62441 total_loss: 1.3194  loss:1.5894,stance loss: 1.7037 
Train step: 740 acc:0.62248 total_loss: 1.317  loss:1.3099,stance loss: 0.93488 
Train step: 750 acc:0.62285 total_loss: 1.3134  loss:1.2003,stance loss: 0.99664 
Train step: 760 acc:0.62526 total_loss: 1.3105  loss:1.1727,stance loss: 0.67868 
Train step: 770 acc:0.62698 total_loss: 1.3105  loss:0.80367,stance loss: 0.57112 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.64062 total_loss: 1.3387  loss:1.7726,stance loss: 1.7488 
Train step: 790 acc:0.64286 total_loss: 1.3057  loss:1.1474,stance loss: 0.92974 
Train step: 800 acc:0.66667 total_loss: 1.2348  loss:1.1687,stance loss: 0.87946 
Train step: 810 acc:0.66912 total_loss: 1.2479  loss:1.1656,stance loss: 0.87507 
Train step: 820 acc:0.64773 total_loss: 1.2547  loss:1.6914,stance loss: 1.2405 
Train step: 830 acc:0.65741 total_loss: 1.2635  loss:1.22,stance loss: 1.3346 
Train step: 840 acc:0.65332 total_loss: 1.2607  loss:0.968,stance loss: 0.68236 
Train step: 850 acc:0.65625 total_loss: 1.259  loss:1.4918,stance loss: 1.2657 
Train step: 860 acc:0.65923 total_loss: 1.2459  loss:1.3147,stance loss: 1.0635 
Train step: 870 acc:0.65891 total_loss: 1.2488  loss:1.187,stance loss: 0.94281 
Train step: 880 acc:0.65685 total_loss: 1.248  loss:1.3308,stance loss: 1.2099 
Train step: 890 acc:0.65789 total_loss: 1.2511  loss:0.98352,stance loss: 0.77204 
Train step: 900 acc:0.65776 total_loss: 1.2466  loss:1.1292,stance loss: 0.89146 
Train step: 910 acc:0.65438 total_loss: 1.2481  loss:0.96541,stance loss: 0.77905 
Train step: 920 acc:0.65885 total_loss: 1.2334  loss:1.3286,stance loss: 1.1035 
Train step: 930 acc:0.65909 total_loss: 1.2368  loss:0.86824,stance loss: 0.77504 
Train step: 940 acc:0.65625 total_loss: 1.2432  loss:1.2822,stance loss: 0.98383 
Train step: 950 acc:0.65876 total_loss: 1.2392  loss:1.0934,stance loss: 0.83041 
Train step: 960 acc:0.66202 total_loss: 1.2332  loss:1.0851,stance loss: 0.89306 
Train step: 970 acc:0.6643 total_loss: 1.2267  loss:0.97144,stance loss: 0.6954 
Train step: 980 acc:0.6636 total_loss: 1.2315  loss:1.0432,stance loss: 0.93251 
Train step: 990 acc:0.66414 total_loss: 1.2305  loss:1.332,stance loss: 1.0448 
Train step: 1000 acc:0.66211 total_loss: 1.2344  loss:1.0665,stance loss: 0.82655 
Train step: 1010 acc:0.66213 total_loss: 1.2383  loss:1.3212,stance loss: 1.0779 
Train step: 1020 acc:0.65984 total_loss: 1.2388  loss:1.185,stance loss: 0.72218 
Train step: 1030 acc:0.66019 total_loss: 1.237  loss:1.1021,stance loss: 0.90866 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.7125 total_loss: 1.2264  loss:1.3812,stance loss: 0.97436 
Train step: 1050 acc:0.68333 total_loss: 1.243  loss:1.2421,stance loss: 1.0774 
Train step: 1060 acc:0.69 total_loss: 1.2083  loss:0.90432,stance loss: 0.53624 
Train step: 1070 acc:0.69464 total_loss: 1.2021  loss:1.1543,stance loss: 0.90924 
Train step: 1080 acc:0.69583 total_loss: 1.1683  loss:1.3562,stance loss: 1.1608 
Train step: 1090 acc:0.69091 total_loss: 1.1613  loss:1.2946,stance loss: 1.1159 
Train step: 1100 acc:0.68462 total_loss: 1.1663  loss:1.1732,stance loss: 0.89259 
Train step: 1110 acc:0.69417 total_loss: 1.1512  loss:1.497,stance loss: 1.518 
Train step: 1120 acc:0.69559 total_loss: 1.1443  loss:1.055,stance loss: 0.87778 
Train step: 1130 acc:0.68947 total_loss: 1.1444  loss:1.2671,stance loss: 0.84446 
Train step: 1140 acc:0.6869 total_loss: 1.1499  loss:1.1867,stance loss: 0.97586 
Train step: 1150 acc:0.68641 total_loss: 1.1452  loss:0.99233,stance loss: 0.72812 
Train step: 1160 acc:0.6855 total_loss: 1.1437  loss:1.2188,stance loss: 0.96477 
Train step: 1170 acc:0.68194 total_loss: 1.1507  loss:1.3371,stance loss: 0.93915 
Train step: 1180 acc:0.68319 total_loss: 1.1499  loss:0.85332,stance loss: 0.63118 
Train step: 1190 acc:0.68145 total_loss: 1.1594  loss:1.3349,stance loss: 1.2344 
Train step: 1200 acc:0.68295 total_loss: 1.1619  loss:1.0465,stance loss: 0.72614 
Train step: 1210 acc:0.685 total_loss: 1.1545  loss:0.61749,stance loss: 0.37937 
Train step: 1220 acc:0.68243 total_loss: 1.1651  loss:1.132,stance loss: 0.87036 
Train step: 1230 acc:0.68269 total_loss: 1.1671  loss:0.95324,stance loss: 0.81887 
Train step: 1240 acc:0.68201 total_loss: 1.1658  loss:1.1701,stance loss: 0.98528 
Train step: 1250 acc:0.68343 total_loss: 1.1635  loss:1.3404,stance loss: 1.0759 
Train step: 1260 acc:0.68417 total_loss: 1.1613  loss:1.1218,stance loss: 0.78515 
Train step: 1270 acc:0.68564 total_loss: 1.1605  loss:1.1838,stance loss: 0.95543 
Train step: 1280 acc:0.68495 total_loss: 1.1609  loss:0.88961,stance loss: 0.71873 
Train step: 1290 acc:0.68578 total_loss: 1.1576  loss:0.99263,stance loss: 0.72351 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.64583 total_loss: 1.1407  loss:1.0457,stance loss: 0.78053 
Train step: 1310 acc:0.6875 total_loss: 1.1218  loss:0.98855,stance loss: 0.87705 
Train step: 1320 acc:0.71635 total_loss: 1.1104  loss:1.7195,stance loss: 1.2886 
Train step: 1330 acc:0.72569 total_loss: 1.075  loss:0.69146,stance loss: 0.56672 
Train step: 1340 acc:0.71875 total_loss: 1.0855  loss:1.1695,stance loss: 0.96684 
Train step: 1350 acc:0.72433 total_loss: 1.0714  loss:0.59937,stance loss: 0.3681 
Train step: 1360 acc:0.72064 total_loss: 1.079  loss:1.371,stance loss: 1.0233 
Train step: 1370 acc:0.71711 total_loss: 1.0834  loss:0.51466,stance loss: 0.26318 
Train step: 1380 acc:0.71148 total_loss: 1.0945  loss:0.6226,stance loss: 0.44066 
Train step: 1390 acc:0.70703 total_loss: 1.1107  loss:1.2114,stance loss: 0.85542 
Train step: 1400 acc:0.70637 total_loss: 1.1107  loss:1.1781,stance loss: 1.0188 
Train step: 1410 acc:0.70744 total_loss: 1.0999  loss:0.92617,stance loss: 0.78523 
Train step: 1420 acc:0.71032 total_loss: 1.0974  loss:1.0106,stance loss: 0.79319 
Train step: 1430 acc:0.70818 total_loss: 1.0998  loss:0.76247,stance loss: 0.6365 
Train step: 1440 acc:0.70762 total_loss: 1.0959  loss:0.76165,stance loss: 0.47929 
Train step: 1450 acc:0.70393 total_loss: 1.1042  loss:1.5194,stance loss: 1.1781 
Train step: 1460 acc:0.70256 total_loss: 1.1029  loss:1.1833,stance loss: 0.9284 
Train step: 1470 acc:0.70277 total_loss: 1.1062  loss:0.93506,stance loss: 0.59998 
Train step: 1480 acc:0.7043 total_loss: 1.1018  loss:1.0537,stance loss: 0.81914 
Train step: 1490 acc:0.70536 total_loss: 1.0979  loss:0.96925,stance loss: 0.80729 
Train step: 1500 acc:0.7051 total_loss: 1.0972  loss:0.83568,stance loss: 0.67848 
Train step: 1510 acc:0.70544 total_loss: 1.0934  loss:1.119,stance loss: 0.70329 
Train step: 1520 acc:0.70713 total_loss: 1.0908  loss:1.2276,stance loss: 1.0319 
Train step: 1530 acc:0.70975 total_loss: 1.0847  loss:0.66332,stance loss: 0.4417 
Train step: 1540 acc:0.70986 total_loss: 1.0837  loss:1.2746,stance loss: 0.98069 
Train step: 1550 acc:0.71021 total_loss: 1.0826  loss:1.1097,stance loss: 0.75154 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.75 total_loss: 0.9155  loss:0.80899,stance loss: 0.58692 
Train step: 1570 acc:0.71324 total_loss: 0.98182  loss:1.1801,stance loss: 0.9428 
Train step: 1580 acc:0.71065 total_loss: 1.0461  loss:0.89159,stance loss: 0.7711 
Train step: 1590 acc:0.71453 total_loss: 1.0465  loss:1.148,stance loss: 0.95033 
Train step: 1600 acc:0.71809 total_loss: 1.0365  loss:1.0918,stance loss: 1.3879 
Train step: 1610 acc:0.7182 total_loss: 1.0376  loss:1.0036,stance loss: 0.8548 
Train step: 1620 acc:0.72015 total_loss: 1.0476  loss:1.1623,stance loss: 0.98966 
Train step: 1630 acc:0.72565 total_loss: 1.0474  loss:1.4939,stance loss: 1.0935 
Train step: 1640 acc:0.71983 total_loss: 1.0607  loss:0.88035,stance loss: 0.72745 
Train step: 1650 acc:0.71714 total_loss: 1.0574  loss:1.2899,stance loss: 1.0357 
Train step: 1660 acc:0.72138 total_loss: 1.0483  loss:0.74602,stance loss: 0.61068 
Train step: 1670 acc:0.72222 total_loss: 1.0418  loss:1.0555,stance loss: 0.70277 
Train step: 1680 acc:0.7249 total_loss: 1.0367  loss:0.52471,stance loss: 0.12977 
Train step: 1690 acc:0.72491 total_loss: 1.0284  loss:0.93796,stance loss: 0.79187 
Train step: 1700 acc:0.72577 total_loss: 1.0321  loss:1.0554,stance loss: 0.85003 
Train step: 1710 acc:0.73089 total_loss: 1.0205  loss:0.89843,stance loss: 0.62279 
Train step: 1720 acc:0.73241 total_loss: 1.0195  loss:0.72966,stance loss: 0.568 
Train step: 1730 acc:0.73199 total_loss: 1.0189  loss:0.92824,stance loss: 0.70094 
Train step: 1740 acc:0.73162 total_loss: 1.0171  loss:1.055,stance loss: 0.58471 
Train step: 1750 acc:0.7335 total_loss: 1.0102  loss:0.65188,stance loss: 0.56026 
Train step: 1760 acc:0.734 total_loss: 1.0129  loss:0.73059,stance loss: 0.58578 
Train step: 1770 acc:0.73387 total_loss: 1.0099  loss:0.93309,stance loss: 0.75671 
Train step: 1780 acc:0.73431 total_loss: 1.009  loss:1.1303,stance loss: 0.89332 
Train step: 1790 acc:0.7355 total_loss: 1.0041  loss:1.2897,stance loss: 1.0861 
Train step: 1800 acc:0.73785 total_loss: 1.0007  loss:0.54099,stance loss: 0.39015 
Train step: 1810 acc:0.7376 total_loss: 1.0038  loss:0.81322,stance loss: 0.57473 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.77344 total_loss: 0.89783  loss:0.82867,stance loss: 0.55641 
Train step: 1830 acc:0.73611 total_loss: 0.95747  loss:1.0343,stance loss: 0.69929 
Train step: 1840 acc:0.75893 total_loss: 0.9183  loss:1.2785,stance loss: 0.98836 
Train step: 1850 acc:0.76809 total_loss: 0.90327  loss:0.898,stance loss: 0.7324 
Train step: 1860 acc:0.77214 total_loss: 0.89196  loss:0.84711,stance loss: 0.78799 
Train step: 1870 acc:0.76724 total_loss: 0.91716  loss:0.92724,stance loss: 0.80909 
Train step: 1880 acc:0.76287 total_loss: 0.92185  loss:0.6105,stance loss: 0.48814 
Train step: 1890 acc:0.76202 total_loss: 0.91604  loss:0.99263,stance loss: 0.86046 
Train step: 1900 acc:0.76705 total_loss: 0.91379  loss:0.81925,stance loss: 0.60344 
Train step: 1910 acc:0.76722 total_loss: 0.91837  loss:0.79418,stance loss: 0.64902 
Train step: 1920 acc:0.77373 total_loss: 0.89715  loss:1.2084,stance loss: 1.0303 
Train step: 1930 acc:0.7786 total_loss: 0.89082  loss:0.87026,stance loss: 1.183 
Train step: 1940 acc:0.77881 total_loss: 0.88975  loss:0.80884,stance loss: 0.62484 
Train step: 1950 acc:0.77808 total_loss: 0.89526  loss:0.89152,stance loss: 0.67531 
Train step: 1960 acc:0.77534 total_loss: 0.90376  loss:1.1211,stance loss: 0.84734 
Train step: 1970 acc:0.77492 total_loss: 0.90606  loss:0.80269,stance loss: 0.63331 
Train step: 1980 acc:0.77604 total_loss: 0.90896  loss:0.84139,stance loss: 0.76479 
Train step: 1990 acc:0.77704 total_loss: 0.90748  loss:0.80224,stance loss: 0.65449 
Train step: 2000 acc:0.77261 total_loss: 0.91687  loss:1.4597,stance loss: 1.1416 
Train step: 2010 acc:0.77146 total_loss: 0.91728  loss:1.1135,stance loss: 0.97629 
Train step: 2020 acc:0.77344 total_loss: 0.91182  loss:0.57671,stance loss: 0.40631 
Train step: 2030 acc:0.7715 total_loss: 0.91546  loss:0.52684,stance loss: 0.42003 
Train step: 2040 acc:0.77357 total_loss: 0.91029  loss:0.85093,stance loss: 0.68713 
Train step: 2050 acc:0.77127 total_loss: 0.91842  loss:1.2457,stance loss: 1.4254 
Train step: 2060 acc:0.77218 total_loss: 0.912  loss:0.80994,stance loss: 0.68799 
Train step: 2070 acc:0.77326 total_loss: 0.90786  loss:0.42216,stance loss: 0.28945 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.82639 total_loss: 0.71809  loss:0.58719,stance loss: 0.48258 
Train step: 2090 acc:0.78947 total_loss: 0.83745  loss:0.99264,stance loss: 0.82149 
Train step: 2100 acc:0.81681 total_loss: 0.76316  loss:0.60726,stance loss: 0.50683 
Train step: 2110 acc:0.82372 total_loss: 0.76382  loss:0.5122,stance loss: 0.48026 
Train step: 2120 acc:0.82908 total_loss: 0.76706  loss:0.77094,stance loss: 0.6285 
Train step: 2130 acc:0.82627 total_loss: 0.76669  loss:0.6714,stance loss: 0.42272 
Train step: 2140 acc:0.82518 total_loss: 0.77606  loss:0.53381,stance loss: 0.42181 
Train step: 2150 acc:0.82041 total_loss: 0.7756  loss:0.35905,stance loss: 0.21652 
Train step: 2160 acc:0.81952 total_loss: 0.79083  loss:0.98713,stance loss: 1.3688 
Train step: 2170 acc:0.82134 total_loss: 0.78261  loss:0.88966,stance loss: 0.6127 
Train step: 2180 acc:0.81995 total_loss: 0.78938  loss:0.8466,stance loss: 0.41946 
Train step: 2190 acc:0.82038 total_loss: 0.78731  loss:0.44978,stance loss: 0.3006 
Train step: 2200 acc:0.81734 total_loss: 0.79295  loss:0.85932,stance loss: 0.72362 
Train step: 2210 acc:0.81924 total_loss: 0.79674  loss:1.061,stance loss: 1.4296 
Train step: 2220 acc:0.81753 total_loss: 0.79551  loss:1.0179,stance loss: 0.94711 
Train step: 2230 acc:0.81525 total_loss: 0.8016  loss:0.98168,stance loss: 1.2928 
Train step: 2240 acc:0.81176 total_loss: 0.80266  loss:0.51342,stance loss: 0.43159 
Train step: 2250 acc:0.81145 total_loss: 0.80044  loss:0.26293,stance loss: 0.18829 
Train step: 2260 acc:0.81184 total_loss: 0.79441  loss:0.82272,stance loss: 0.6645 
Train step: 2270 acc:0.81407 total_loss: 0.79265  loss:1.0859,stance loss: 1.3339 
Train step: 2280 acc:0.81639 total_loss: 0.7864  loss:0.31301,stance loss: 0.12134 
Train step: 2290 acc:0.81707 total_loss: 0.7845  loss:0.83892,stance loss: 0.63861 
Train step: 2300 acc:0.81905 total_loss: 0.78052  loss:0.72557,stance loss: 0.53905 
Train step: 2310 acc:0.82035 total_loss: 0.77936  loss:0.6213,stance loss: 0.53592 
Train step: 2320 acc:0.82053 total_loss: 0.77819  loss:0.81344,stance loss: 0.83559 
Train step: 2330 acc:0.81968 total_loss: 0.78336  loss:1.0555,stance loss: 1.1718 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.85625 total_loss: 0.68896  loss:0.33736,stance loss: 0.17168 
Train step: 2350 acc:0.87187 total_loss: 0.67352  loss:0.27119,stance loss: 0.12706 
Train step: 2360 acc:0.86667 total_loss: 0.69116  loss:0.28128,stance loss: 0.2186 
Train step: 2370 acc:0.87031 total_loss: 0.66352  loss:1.035,stance loss: 1.4315 
Train step: 2380 acc:0.8675 total_loss: 0.65591  loss:0.76063,stance loss: 0.51929 
Train step: 2390 acc:0.86146 total_loss: 0.65599  loss:0.58561,stance loss: 0.34177 
Train step: 2400 acc:0.85982 total_loss: 0.66488  loss:0.55949,stance loss: 0.45655 
Train step: 2410 acc:0.85703 total_loss: 0.66623  loss:0.53342,stance loss: 0.49135 
Train step: 2420 acc:0.85139 total_loss: 0.6732  loss:0.66025,stance loss: 0.47299 
Train step: 2430 acc:0.85188 total_loss: 0.66969  loss:0.32673,stance loss: 0.17388 
Train step: 2440 acc:0.8483 total_loss: 0.68388  loss:0.88054,stance loss: 0.57127 
Train step: 2450 acc:0.84896 total_loss: 0.67967  loss:0.61771,stance loss: 0.42824 
Train step: 2460 acc:0.85 total_loss: 0.68368  loss:1.1235,stance loss: 1.4049 
Train step: 2470 acc:0.84866 total_loss: 0.68553  loss:0.2583,stance loss: 0.12003 
Train step: 2480 acc:0.84958 total_loss: 0.68125  loss:1.1233,stance loss: 1.1014 
Train step: 2490 acc:0.84805 total_loss: 0.68723  loss:0.93277,stance loss: 0.63568 
Train step: 2500 acc:0.84816 total_loss: 0.68481  loss:0.34591,stance loss: 0.28076 
Train step: 2510 acc:0.84792 total_loss: 0.68935  loss:0.67148,stance loss: 1.0637 
Train step: 2520 acc:0.85 total_loss: 0.68696  loss:0.6888,stance loss: 1.0646 
Train step: 2530 acc:0.85156 total_loss: 0.68593  loss:0.52223,stance loss: 0.48446 
Train step: 2540 acc:0.8503 total_loss: 0.69233  loss:0.80216,stance loss: 0.65201 
Train step: 2550 acc:0.84972 total_loss: 0.69889  loss:0.58653,stance loss: 0.48141 
Train step: 2560 acc:0.85 total_loss: 0.69882  loss:0.39319,stance loss: 0.29324 
Train step: 2570 acc:0.85026 total_loss: 0.69657  loss:0.47702,stance loss: 0.39262 
Train step: 2580 acc:0.8505 total_loss: 0.69241  loss:0.88904,stance loss: 0.76258 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.875 total_loss: 0.8901  loss:0.8901,stance loss: 1.2552 
Train step: 2600 acc:0.89773 total_loss: 0.51043  loss:0.49099,stance loss: 0.27465 
Train step: 2610 acc:0.88393 total_loss: 0.60264  loss:0.22291,stance loss: 0.13128 
Train step: 2620 acc:0.88105 total_loss: 0.60384  loss:0.46943,stance loss: 0.35386 
Train step: 2630 acc:0.8872 total_loss: 0.55031  loss:0.59288,stance loss: 0.46377 
Train step: 2640 acc:0.8848 total_loss: 0.54846  loss:0.5475,stance loss: 0.47436 
Train step: 2650 acc:0.89344 total_loss: 0.52533  loss:0.67046,stance loss: 1.0882 
Train step: 2660 acc:0.88468 total_loss: 0.55685  loss:0.66288,stance loss: 0.48309 
Train step: 2670 acc:0.88735 total_loss: 0.56325  loss:0.23612,stance loss: 0.2033 
Train step: 2680 acc:0.87637 total_loss: 0.59862  loss:0.95639,stance loss: 0.94194 
Train step: 2690 acc:0.87314 total_loss: 0.60498  loss:0.72081,stance loss: 0.45687 
Train step: 2700 acc:0.87106 total_loss: 0.6215  loss:0.84829,stance loss: 1.1541 
Train step: 2710 acc:0.87242 total_loss: 0.61329  loss:1.146,stance loss: 1.2788 
Train step: 2720 acc:0.87118 total_loss: 0.61396  loss:0.76878,stance loss: 0.61643 
Train step: 2730 acc:0.87234 total_loss: 0.61184  loss:0.53691,stance loss: 0.46957 
Train step: 2740 acc:0.87376 total_loss: 0.60085  loss:0.22615,stance loss: 0.12273 
Train step: 2750 acc:0.87539 total_loss: 0.59094  loss:0.69356,stance loss: 0.60855 
Train step: 2760 acc:0.87719 total_loss: 0.59224  loss:0.14422,stance loss: 0.072562 
Train step: 2770 acc:0.8788 total_loss: 0.58079  loss:0.8741,stance loss: 0.78346 
Train step: 2780 acc:0.87958 total_loss: 0.57967  loss:0.60582,stance loss: 0.39865 
Train step: 2790 acc:0.87935 total_loss: 0.58006  loss:0.45205,stance loss: 0.3331 
Train step: 2800 acc:0.87915 total_loss: 0.57555  loss:0.42346,stance loss: 0.35839 
Train step: 2810 acc:0.87755 total_loss: 0.58057  loss:1.052,stance loss: 1.0025 
Train step: 2820 acc:0.87716 total_loss: 0.57945  loss:0.25343,stance loss: 0.17993 
Train step: 2830 acc:0.87733 total_loss: 0.57354  loss:0.56352,stance loss: 0.51195 
Train step: 2840 acc:0.87699 total_loss: 0.57856  loss:0.79625,stance loss: 0.43181 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.90625 total_loss: 0.5245  loss:0.88042,stance loss: 0.80094 
Train step: 2860 acc:0.90625 total_loss: 0.54199  loss:0.5814,stance loss: 0.36985 
Train step: 2870 acc:0.89205 total_loss: 0.55552  loss:0.36224,stance loss: 0.30602 
Train step: 2880 acc:0.9043 total_loss: 0.50228  loss:0.5958,stance loss: 0.42607 
Train step: 2890 acc:0.90476 total_loss: 0.49628  loss:0.2064,stance loss: 0.056178 
Train step: 2900 acc:0.89784 total_loss: 0.49829  loss:0.71432,stance loss: 0.53166 
Train step: 2910 acc:0.90423 total_loss: 0.48957  loss:0.047565,stance loss: 0.0035101 
Train step: 2920 acc:0.90712 total_loss: 0.48657  loss:0.053204,stance loss: 0.011291 
Train step: 2930 acc:0.91159 total_loss: 0.47196  loss:0.10226,stance loss: 0.038709 
Train step: 2940 acc:0.91644 total_loss: 0.45779  loss:0.73051,stance loss: 1.1638 
Train step: 2950 acc:0.91912 total_loss: 0.44792  loss:0.11519,stance loss: 0.022273 
Train step: 2960 acc:0.91853 total_loss: 0.45905  loss:0.37112,stance loss: 0.39114 
Train step: 2970 acc:0.91547 total_loss: 0.46483  loss:0.73077,stance loss: 0.61659 
Train step: 2980 acc:0.91525 total_loss: 0.46755  loss:0.70179,stance loss: 1.1804 
Train step: 2990 acc:0.91417 total_loss: 0.46301  loss:0.44874,stance loss: 0.33167 
Train step: 3000 acc:0.91324 total_loss: 0.4596  loss:0.2728,stance loss: 0.15141 
Train step: 3010 acc:0.91011 total_loss: 0.46858  loss:0.93934,stance loss: 0.88304 
Train step: 3020 acc:0.90988 total_loss: 0.46885  loss:0.16694,stance loss: 0.10331 
Train step: 3030 acc:0.90934 total_loss: 0.47148  loss:0.68542,stance loss: 0.48066 
Train step: 3040 acc:0.91016 total_loss: 0.46744  loss:0.24572,stance loss: 0.17323 
Train step: 3050 acc:0.91089 total_loss: 0.46033  loss:0.24159,stance loss: 0.14561 
Train step: 3060 acc:0.91126 total_loss: 0.45763  loss:0.38909,stance loss: 0.35074 
Train step: 3070 acc:0.90935 total_loss: 0.46285  loss:0.31459,stance loss: 0.24457 
Train step: 3080 acc:0.90921 total_loss: 0.46255  loss:0.76738,stance loss: 0.48947 
Train step: 3090 acc:0.90935 total_loss: 0.46199  loss:0.31441,stance loss: 0.28052 
Train step: 3100 acc:0.91022 total_loss: 0.45618  loss:0.36303,stance loss: 0.32227 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.9375 total_loss: 0.35971  loss:0.36919,stance loss: 0.32509 
Train step: 3120 acc:0.89904 total_loss: 0.38632  loss:0.48475,stance loss: 0.317 
Train step: 3130 acc:0.91304 total_loss: 0.40401  loss:0.37493,stance loss: 0.32045 
Train step: 3140 acc:0.92235 total_loss: 0.36793  loss:0.47727,stance loss: 0.31775 
Train step: 3150 acc:0.92733 total_loss: 0.35774  loss:0.17887,stance loss: 0.12977 
Train step: 3160 acc:0.92335 total_loss: 0.36812  loss:0.54406,stance loss: 1.0151 
Train step: 3170 acc:0.91865 total_loss: 0.37552  loss:0.671,stance loss: 0.59398 
Train step: 3180 acc:0.91438 total_loss: 0.38957  loss:0.61833,stance loss: 0.59492 
Train step: 3190 acc:0.91867 total_loss: 0.38273  loss:0.40693,stance loss: 0.26845 
Train step: 3200 acc:0.9207 total_loss: 0.37949  loss:1.1962,stance loss: 1.5628 
Train step: 3210 acc:0.92172 total_loss: 0.37343  loss:0.70895,stance loss: 0.49515 
Train step: 3220 acc:0.92588 total_loss: 0.36288  loss:0.063343,stance loss: 0.01815 
Train step: 3230 acc:0.92378 total_loss: 0.36578  loss:0.50711,stance loss: 0.42445 
Train step: 3240 acc:0.92387 total_loss: 0.36826  loss:0.20585,stance loss: 0.15062 
Train step: 3250 acc:0.92177 total_loss: 0.37212  loss:0.27297,stance loss: 0.17201 
Train step: 3260 acc:0.92525 total_loss: 0.36638  loss:0.306,stance loss: 0.15041 
Train step: 3270 acc:0.92753 total_loss: 0.36359  loss:0.15581,stance loss: 0.08562 
Train step: 3280 acc:0.92811 total_loss: 0.36376  loss:0.47488,stance loss: 0.41375 
Train step: 3290 acc:0.92828 total_loss: 0.36011  loss:0.19283,stance loss: 0.15389 
Train step: 3300 acc:0.92811 total_loss: 0.35832  loss:0.024551,stance loss: 0.0021311 
Train step: 3310 acc:0.92549 total_loss: 0.36645  loss:0.9681,stance loss: 0.89509 
Train step: 3320 acc:0.92518 total_loss: 0.36757  loss:0.30923,stance loss: 0.20227 
Train step: 3330 acc:0.92629 total_loss: 0.36252  loss:0.15064,stance loss: 0.078492 
Train step: 3340 acc:0.9265 total_loss: 0.36187  loss:0.22578,stance loss: 0.15776 
Train step: 3350 acc:0.92695 total_loss: 0.35987  loss:0.59764,stance loss: 1.0664 
Train step: 3360 acc:0.92712 total_loss: 0.35915  loss:0.2791,stance loss: 0.2618 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.9375 total_loss: 0.35873  loss:0.10017,stance loss: 0.049116 
Train step: 3380 acc:0.95089 total_loss: 0.28487  loss:0.37945,stance loss: 0.30401 
Train step: 3390 acc:0.95052 total_loss: 0.2937  loss:0.30544,stance loss: 0.24805 
Train step: 3400 acc:0.95037 total_loss: 0.29635  loss:0.10142,stance loss: 0.050726 
Train step: 3410 acc:0.95028 total_loss: 0.28492  loss:0.10366,stance loss: 0.033606 
Train step: 3420 acc:0.94907 total_loss: 0.29604  loss:0.46479,stance loss: 0.37236 
Train step: 3430 acc:0.94727 total_loss: 0.29149  loss:0.10168,stance loss: 0.061101 
Train step: 3440 acc:0.94679 total_loss: 0.28158  loss:0.38452,stance loss: 0.20327 
Train step: 3450 acc:0.94866 total_loss: 0.27311  loss:0.039198,stance loss: 0.0085942 
Train step: 3460 acc:0.9488 total_loss: 0.26691  loss:0.38959,stance loss: 0.35493 
Train step: 3470 acc:0.95132 total_loss: 0.26534  loss:0.05322,stance loss: 0.014162 
Train step: 3480 acc:0.94901 total_loss: 0.28262  loss:0.21786,stance loss: 0.17736 
Train step: 3490 acc:0.9501 total_loss: 0.27474  loss:0.1685,stance loss: 0.14398 
Train step: 3500 acc:0.95009 total_loss: 0.27416  loss:0.41834,stance loss: 0.27317 
Train step: 3510 acc:0.94965 total_loss: 0.27781  loss:0.062521,stance loss: 0.032786 
Train step: 3520 acc:0.95049 total_loss: 0.27502  loss:0.41589,stance loss: 0.35562 
Train step: 3530 acc:0.94893 total_loss: 0.27868  loss:0.053892,stance loss: 0.018228 
Train step: 3540 acc:0.94971 total_loss: 0.27902  loss:0.48514,stance loss: 0.43168 
Train step: 3550 acc:0.95007 total_loss: 0.28208  loss:0.083592,stance loss: 0.034049 
Train step: 3560 acc:0.94974 total_loss: 0.28349  loss:0.28701,stance loss: 0.23895 
Train step: 3570 acc:0.94669 total_loss: 0.29572  loss:0.24267,stance loss: 0.18519 
Train step: 3580 acc:0.94626 total_loss: 0.29964  loss:0.12425,stance loss: 0.08061 
Train step: 3590 acc:0.9442 total_loss: 0.30596  loss:0.48709,stance loss: 0.37704 
Train step: 3600 acc:0.94284 total_loss: 0.31148  loss:0.77413,stance loss: 0.41753 
Train step: 3610 acc:0.94339 total_loss: 0.30768  loss:0.25584,stance loss: 0.28104 
Train step: 3620 acc:0.94291 total_loss: 0.30608  loss:0.46078,stance loss: 0.39617 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.95 total_loss: 0.12841  loss:0.19386,stance loss: 0.080742 
Train step: 3640 acc:0.95833 total_loss: 0.23773  loss:0.068165,stance loss: 0.055055 
Train step: 3650 acc:0.96 total_loss: 0.24388  loss:0.36312,stance loss: 0.2617 
Train step: 3660 acc:0.95536 total_loss: 0.2576  loss:0.20302,stance loss: 0.13565 
Train step: 3670 acc:0.95417 total_loss: 0.25439  loss:0.20089,stance loss: 0.15717 
Train step: 3680 acc:0.95341 total_loss: 0.25726  loss:0.51499,stance loss: 0.22 
Train step: 3690 acc:0.95577 total_loss: 0.25248  loss:0.24316,stance loss: 0.15832 
Train step: 3700 acc:0.95333 total_loss: 0.25694  loss:0.60709,stance loss: 0.45383 
Train step: 3710 acc:0.95221 total_loss: 0.25573  loss:0.16351,stance loss: 0.12777 
Train step: 3720 acc:0.95461 total_loss: 0.23982  loss:0.10589,stance loss: 0.11993 
Train step: 3730 acc:0.95476 total_loss: 0.2386  loss:0.12717,stance loss: 0.13487 
Train step: 3740 acc:0.95543 total_loss: 0.23908  loss:0.25867,stance loss: 0.1734 
Train step: 3750 acc:0.9525 total_loss: 0.24598  loss:0.028523,stance loss: 0.0026595 
Train step: 3760 acc:0.95231 total_loss: 0.24579  loss:0.71852,stance loss: 0.4287 
Train step: 3770 acc:0.95302 total_loss: 0.2418  loss:0.24295,stance loss: 0.19394 
Train step: 3780 acc:0.95121 total_loss: 0.25327  loss:1.0284,stance loss: 1.4583 
Train step: 3790 acc:0.95076 total_loss: 0.25403  loss:0.27208,stance loss: 0.16254 
Train step: 3800 acc:0.95143 total_loss: 0.25051  loss:0.27654,stance loss: 0.28365 
Train step: 3810 acc:0.95068 total_loss: 0.24897  loss:0.28362,stance loss: 0.11304 
Train step: 3820 acc:0.95 total_loss: 0.25014  loss:0.078511,stance loss: 0.04688 
Train step: 3830 acc:0.94909 total_loss: 0.25634  loss:0.67979,stance loss: 0.55252 
Train step: 3840 acc:0.95 total_loss: 0.25505  loss:0.16325,stance loss: 0.21455 
Train step: 3850 acc:0.95 total_loss: 0.25399  loss:0.04742,stance loss: 0.019851 
Train step: 3860 acc:0.9492 total_loss: 0.25658  loss:0.50255,stance loss: 0.42679 
Train step: 3870 acc:0.94872 total_loss: 0.26015  loss:0.28691,stance loss: 0.21636 
Train step: 3880 acc:0.94902 total_loss: 0.25796  loss:0.44611,stance loss: 0.32515 
Training finished.


Reload the best model with best f1 0.3879598662207358 from path test_outputs/bert-cross-topic/a/2023-08-14 13-40-54/state_dict


              precision    recall  f1-score   support

           0   0.633880  1.000000  0.775920       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211293  0.333333  0.258640       733
weighted avg   0.401255  0.633015  0.491169       733

Test Acc: 0.6330150068212824 F1_ma:0.3879598662207358
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.3879598662207358
acc: 0.6330150068212824, f1 :0.25863991081382387
classification report: 
              precision    recall  f1-score   support

         Con     0.6339    1.0000    0.7759       464
        None     0.0000    0.0000    0.0000       145
         Pro     0.0000    0.0000    0.0000       124

    accuracy                         0.6330       733
   macro avg     0.2113    0.3333    0.2586       733
weighted avg     0.4013    0.6330    0.4912       733

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 14-00-23', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 14-00-23
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 2.6652  loss:2.6652,stance loss: 3.0336 
Train step: 10 acc:0.28977 total_loss: 1.8134  loss:1.6853,stance loss: 1.0771 
Better F1! Saving model!
Saving model of best f1: 0.3668801463860934
              precision    recall  f1-score   support

           0   0.637520  0.864224  0.733760       464
           1   0.019231  0.013793  0.016064       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.549795       733
   macro avg   0.218917  0.292672  0.249942       733
weighted avg   0.407364  0.549795  0.467659       733

Test Acc: 0.5497953615279673 F1_ma:0.3668801463860934
Train step: 20 acc:0.35119 total_loss: 1.7521  loss:1.7022,stance loss: 1.1797 
Better F1! Saving model!
Saving model of best f1: 0.3880972338642079
              precision    recall  f1-score   support

           0   0.635117  0.997845  0.776194       464
           1   0.250000  0.006897  0.013423       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.295039  0.334914  0.263206       733
weighted avg   0.451493  0.633015  0.493998       733

Test Acc: 0.6330150068212824 F1_ma:0.3880972338642079
Train step: 30 acc:0.39113 total_loss: 1.7233  loss:1.8387,stance loss: 1.366 
Train step: 40 acc:0.4314 total_loss: 1.6932  loss:1.616,stance loss: 1.219 
Train step: 50 acc:0.44118 total_loss: 1.6811  loss:1.5945,stance loss: 1.2089 
Train step: 60 acc:0.44467 total_loss: 1.6755  loss:1.5718,stance loss: 1.0053 
Train step: 70 acc:0.45335 total_loss: 1.6723  loss:1.6308,stance loss: 1.115 
Train step: 80 acc:0.45216 total_loss: 1.6725  loss:1.8018,stance loss: 1.2073 
Train step: 90 acc:0.44643 total_loss: 1.6715  loss:1.6166,stance loss: 1.0293 
Train step: 100 acc:0.45173 total_loss: 1.6646  loss:1.5056,stance loss: 1.014 
Train step: 110 acc:0.4482 total_loss: 1.6625  loss:1.6938,stance loss: 1.2553 
Train step: 120 acc:0.44628 total_loss: 1.6589  loss:1.6474,stance loss: 1.1484 
Train step: 130 acc:0.45181 total_loss: 1.6535  loss:1.4945,stance loss: 1.0071 
Train step: 140 acc:0.45301 total_loss: 1.6521  loss:1.423,stance loss: 0.8563 
Train step: 150 acc:0.44992 total_loss: 1.6479  loss:1.6219,stance loss: 1.1506 
Train step: 160 acc:0.45148 total_loss: 1.6469  loss:1.8465,stance loss: 1.7036 
Train step: 170 acc:0.45687 total_loss: 1.6435  loss:1.5636,stance loss: 1.1177 
Train step: 180 acc:0.46512 total_loss: 1.6319  loss:1.178,stance loss: 0.53766 
Train step: 190 acc:0.46924 total_loss: 1.6246  loss:1.5193,stance loss: 1.0512 
Train step: 200 acc:0.47046 total_loss: 1.6226  loss:1.6407,stance loss: 1.3889 
Train step: 210 acc:0.47393 total_loss: 1.6176  loss:1.5287,stance loss: 1.0572 
Train step: 220 acc:0.47313 total_loss: 1.6163  loss:1.5166,stance loss: 1.1335 
Train step: 230 acc:0.47348 total_loss: 1.6126  loss:1.2458,stance loss: 0.61629 
Train step: 240 acc:0.47692 total_loss: 1.6069  loss:1.6833,stance loss: 1.2243 
Train step: 250 acc:0.47908 total_loss: 1.6024  loss:1.4774,stance loss: 0.98616 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5625 total_loss: 1.2997  loss:1.0513,stance loss: 0.50467 
Train step: 270 acc:0.59896 total_loss: 1.4202  loss:1.48,stance loss: 1.0641 
Train step: 280 acc:0.59659 total_loss: 1.4146  loss:1.6263,stance loss: 1.2037 
Train step: 290 acc:0.57812 total_loss: 1.4283  loss:1.5364,stance loss: 1.2465 
Train step: 300 acc:0.58185 total_loss: 1.43  loss:1.6355,stance loss: 1.2374 
Train step: 310 acc:0.58413 total_loss: 1.4176  loss:1.428,stance loss: 0.95852 
Train step: 320 acc:0.5877 total_loss: 1.4262  loss:1.6894,stance loss: 1.2135 
Train step: 330 acc:0.58941 total_loss: 1.4248  loss:1.5198,stance loss: 1.2034 
Train step: 340 acc:0.59375 total_loss: 1.4205  loss:1.3034,stance loss: 0.96244 
Train step: 350 acc:0.59986 total_loss: 1.4281  loss:1.6268,stance loss: 1.5016 
Train step: 360 acc:0.60417 total_loss: 1.4236  loss:1.4359,stance loss: 1.1355 
Train step: 370 acc:0.60156 total_loss: 1.4181  loss:1.2882,stance loss: 0.8425 
Train step: 380 acc:0.60553 total_loss: 1.4139  loss:1.4713,stance loss: 1.4408 
Train step: 390 acc:0.60464 total_loss: 1.4206  loss:1.4135,stance loss: 1.1855 
Train step: 400 acc:0.60871 total_loss: 1.4163  loss:1.6195,stance loss: 1.2975 
Train step: 410 acc:0.60691 total_loss: 1.4181  loss:1.7632,stance loss: 1.7352 
Train step: 420 acc:0.60918 total_loss: 1.4155  loss:1.388,stance loss: 1.0618 
Train step: 430 acc:0.61083 total_loss: 1.4135  loss:1.3008,stance loss: 1.2128 
Train step: 440 acc:0.60749 total_loss: 1.4152  loss:1.483,stance loss: 1.1286 
Train step: 450 acc:0.6084 total_loss: 1.417  loss:1.6216,stance loss: 1.7436 
Train step: 460 acc:0.61077 total_loss: 1.4098  loss:1.0362,stance loss: 0.70385 
Train step: 470 acc:0.61409 total_loss: 1.4047  loss:1.1608,stance loss: 0.75072 
Train step: 480 acc:0.61374 total_loss: 1.4011  loss:1.1762,stance loss: 0.81189 
Train step: 490 acc:0.61449 total_loss: 1.3998  loss:1.463,stance loss: 1.1531 
Train step: 500 acc:0.61519 total_loss: 1.3918  loss:1.3309,stance loss: 0.99325 
Train step: 510 acc:0.61806 total_loss: 1.3868  loss:1.3281,stance loss: 0.9716 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.52083 total_loss: 1.4455  loss:1.6864,stance loss: 1.2206 
Train step: 530 acc:0.62019 total_loss: 1.2935  loss:1.595,stance loss: 1.2493 
Train step: 540 acc:0.62772 total_loss: 1.2789  loss:1.3437,stance loss: 1.0064 
Train step: 550 acc:0.65152 total_loss: 1.2686  loss:1.3894,stance loss: 1.2352 
Train step: 560 acc:0.67297 total_loss: 1.2339  loss:1.1431,stance loss: 0.81255 
Train step: 570 acc:0.65802 total_loss: 1.23  loss:1.2991,stance loss: 0.86049 
Train step: 580 acc:0.65377 total_loss: 1.2372  loss:1.8529,stance loss: 1.9629 
Train step: 590 acc:0.66182 total_loss: 1.2256  loss:1.0361,stance loss: 0.76857 
Train step: 600 acc:0.67018 total_loss: 1.2115  loss:1.0043,stance loss: 0.74611 
Train step: 610 acc:0.66935 total_loss: 1.2184  loss:1.3058,stance loss: 0.57056 
Train step: 620 acc:0.66869 total_loss: 1.2201  loss:1.1693,stance loss: 0.86084 
Train step: 630 acc:0.66704 total_loss: 1.2325  loss:1.35,stance loss: 1.0157 
Train step: 640 acc:0.66616 total_loss: 1.2325  loss:1.4565,stance loss: 1.0221 
Train step: 650 acc:0.66588 total_loss: 1.2335  loss:0.87127,stance loss: 0.62582 
Train step: 660 acc:0.66871 total_loss: 1.2319  loss:0.92952,stance loss: 0.67535 
Train step: 670 acc:0.6683 total_loss: 1.2335  loss:1.2346,stance loss: 0.93157 
Train step: 680 acc:0.67101 total_loss: 1.228  loss:0.82437,stance loss: 0.65521 
Train step: 690 acc:0.67233 total_loss: 1.2275  loss:1.4714,stance loss: 1.3084 
Train step: 700 acc:0.67145 total_loss: 1.2282  loss:1.4173,stance loss: 0.98601 
Train step: 710 acc:0.67034 total_loss: 1.2312  loss:1.397,stance loss: 1.0721 
Train step: 720 acc:0.67149 total_loss: 1.2299  loss:1.4351,stance loss: 1.1897 
Train step: 730 acc:0.67048 total_loss: 1.2309  loss:0.988,stance loss: 0.79731 
Train step: 740 acc:0.67096 total_loss: 1.2279  loss:1.087,stance loss: 0.7999 
Train step: 750 acc:0.67087 total_loss: 1.2244  loss:1.339,stance loss: 1.2062 
Train step: 760 acc:0.6713 total_loss: 1.224  loss:1.1913,stance loss: 0.97051 
Train step: 770 acc:0.67218 total_loss: 1.2183  loss:0.67669,stance loss: 0.55865 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.625 total_loss: 1.2668  loss:1.1417,stance loss: 0.84853 
Train step: 790 acc:0.65179 total_loss: 1.2348  loss:1.1535,stance loss: 0.97869 
Train step: 800 acc:0.65104 total_loss: 1.2271  loss:1.2862,stance loss: 1.0043 
Train step: 810 acc:0.65441 total_loss: 1.1977  loss:1.1954,stance loss: 1.0679 
Train step: 820 acc:0.65625 total_loss: 1.19  loss:1.4763,stance loss: 0.98461 
Train step: 830 acc:0.66319 total_loss: 1.1649  loss:1.2843,stance loss: 0.99184 
Train step: 840 acc:0.65723 total_loss: 1.1719  loss:1.1409,stance loss: 0.80266 
Train step: 850 acc:0.66639 total_loss: 1.1499  loss:0.83604,stance loss: 0.65433 
Train step: 860 acc:0.6689 total_loss: 1.1466  loss:1.0912,stance loss: 0.77714 
Train step: 870 acc:0.67354 total_loss: 1.1468  loss:1.438,stance loss: 1.169 
Train step: 880 acc:0.67188 total_loss: 1.1525  loss:1.1924,stance loss: 0.91547 
Train step: 890 acc:0.67873 total_loss: 1.1367  loss:1.3453,stance loss: 0.97101 
Train step: 900 acc:0.68296 total_loss: 1.1301  loss:0.80364,stance loss: 0.62675 
Train step: 910 acc:0.68144 total_loss: 1.1353  loss:0.91445,stance loss: 0.64699 
Train step: 920 acc:0.68229 total_loss: 1.1334  loss:1.2086,stance loss: 0.96561 
Train step: 930 acc:0.68425 total_loss: 1.1272  loss:1.0464,stance loss: 0.88121 
Train step: 940 acc:0.68521 total_loss: 1.1304  loss:1.0558,stance loss: 0.78201 
Train step: 950 acc:0.68822 total_loss: 1.1265  loss:0.72889,stance loss: 0.4666 
Train step: 960 acc:0.6841 total_loss: 1.1375  loss:1.8699,stance loss: 1.9085 
Train step: 970 acc:0.68428 total_loss: 1.1308  loss:1.5134,stance loss: 1.1409 
Train step: 980 acc:0.68413 total_loss: 1.1284  loss:0.94008,stance loss: 0.71393 
Train step: 990 acc:0.68487 total_loss: 1.1293  loss:1.1057,stance loss: 0.78492 
Train step: 1000 acc:0.69029 total_loss: 1.1304  loss:1.1841,stance loss: 1.0915 
Train step: 1010 acc:0.6891 total_loss: 1.1359  loss:1.0853,stance loss: 0.69684 
Train step: 1020 acc:0.69032 total_loss: 1.1358  loss:1.1535,stance loss: 0.86736 
Train step: 1030 acc:0.69168 total_loss: 1.1305  loss:1.0643,stance loss: 0.95836 
Better F1! Saving model!
Saving model of best f1: 0.47799840034532226
              precision    recall  f1-score   support

           0   0.711340  0.743534  0.727081       464
           1   0.485437  0.689655  0.569801       145
           2   0.452381  0.153226  0.228916       124

    accuracy                       0.633015       733
   macro avg   0.549719  0.528805  0.508599       733
weighted avg   0.622845  0.633015  0.611695       733

Test Acc: 0.6330150068212824 F1_ma:0.47799840034532226
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.675 total_loss: 1.1268  loss:1.204,stance loss: 0.95416 
Train step: 1050 acc:0.67917 total_loss: 1.1099  loss:1.6567,stance loss: 1.7036 
Train step: 1060 acc:0.7125 total_loss: 1.0411  loss:1.192,stance loss: 0.93908 
Train step: 1070 acc:0.6875 total_loss: 1.0927  loss:1.0785,stance loss: 0.88463 
Train step: 1080 acc:0.70694 total_loss: 1.051  loss:0.86068,stance loss: 0.81118 
Train step: 1090 acc:0.70682 total_loss: 1.0603  loss:1.1427,stance loss: 1.0388 
Better F1! Saving model!
Saving model of best f1: 0.4893621816542709
              precision    recall  f1-score   support

           0   0.693487  0.780172  0.734280       464
           1   0.522581  0.558621  0.540000       145
           2   0.392857  0.177419  0.244444       124

    accuracy                       0.634379       733
   macro avg   0.536308  0.505404  0.506241       733
weighted avg   0.608822  0.634379  0.612984       733

Test Acc: 0.6343792633015006 F1_ma:0.4893621816542709
Train step: 1100 acc:0.71731 total_loss: 1.0511  loss:1.3694,stance loss: 1.2499 
Better F1! Saving model!
Saving model of best f1: 0.4904241254868332
              precision    recall  f1-score   support

           0   0.696911  0.778017  0.735234       464
           1   0.500000  0.579310  0.536741       145
           2   0.446809  0.169355  0.245614       124

    accuracy                       0.635744       733
   macro avg   0.547907  0.508894  0.505863       733
weighted avg   0.615649  0.635744  0.613141       733

Test Acc: 0.635743519781719 F1_ma:0.4904241254868332
Train step: 1110 acc:0.71917 total_loss: 1.041  loss:1.1068,stance loss: 0.7865 
Train step: 1120 acc:0.71765 total_loss: 1.0472  loss:1.0747,stance loss: 1.0466 
Train step: 1130 acc:0.71842 total_loss: 1.0596  loss:1.5612,stance loss: 1.3533 
Train step: 1140 acc:0.71905 total_loss: 1.0564  loss:0.84089,stance loss: 0.73265 
Train step: 1150 acc:0.72011 total_loss: 1.0565  loss:1.1704,stance loss: 0.91252 
Train step: 1160 acc:0.7195 total_loss: 1.0547  loss:1.2115,stance loss: 0.87763 
Train step: 1170 acc:0.71806 total_loss: 1.0636  loss:1.2184,stance loss: 0.71635 
Train step: 1180 acc:0.72155 total_loss: 1.052  loss:0.82071,stance loss: 0.62853 
Train step: 1190 acc:0.72339 total_loss: 1.0454  loss:0.84481,stance loss: 0.57586 
Train step: 1200 acc:0.72462 total_loss: 1.0472  loss:0.93229,stance loss: 0.71831 
Train step: 1210 acc:0.72571 total_loss: 1.0443  loss:0.71266,stance loss: 0.55867 
Train step: 1220 acc:0.72534 total_loss: 1.0455  loss:1.3559,stance loss: 1.0413 
Train step: 1230 acc:0.72468 total_loss: 1.0426  loss:0.87189,stance loss: 0.54939 
Train step: 1240 acc:0.72805 total_loss: 1.0354  loss:1.0658,stance loss: 0.9354 
Train step: 1250 acc:0.72645 total_loss: 1.0396  loss:0.92687,stance loss: 0.85256 
Train step: 1260 acc:0.72583 total_loss: 1.0335  loss:1.2876,stance loss: 0.88586 
Train step: 1270 acc:0.7258 total_loss: 1.0323  loss:1.1339,stance loss: 1.1104 
Train step: 1280 acc:0.72704 total_loss: 1.0314  loss:0.6426,stance loss: 0.44302 
Train step: 1290 acc:0.72672 total_loss: 1.0295  loss:0.78432,stance loss: 0.61527 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.71875 total_loss: 0.98426  loss:0.98022,stance loss: 0.83745 
Train step: 1310 acc:0.72266 total_loss: 0.96439  loss:1.0916,stance loss: 0.83468 
Train step: 1320 acc:0.7476 total_loss: 0.93238  loss:1.0385,stance loss: 0.83415 
Train step: 1330 acc:0.75521 total_loss: 0.91276  loss:0.91022,stance loss: 0.79519 
Train step: 1340 acc:0.75679 total_loss: 0.90958  loss:0.69542,stance loss: 0.49599 
Train step: 1350 acc:0.75223 total_loss: 0.92338  loss:0.85451,stance loss: 0.5603 
Train step: 1360 acc:0.74716 total_loss: 0.9284  loss:0.90787,stance loss: 0.82175 
Train step: 1370 acc:0.74178 total_loss: 0.94151  loss:0.97411,stance loss: 0.76896 
Train step: 1380 acc:0.74419 total_loss: 0.94601  loss:0.60378,stance loss: 0.4397 
Train step: 1390 acc:0.74544 total_loss: 0.93852  loss:0.99618,stance loss: 0.68752 
Train step: 1400 acc:0.74882 total_loss: 0.93565  loss:0.78964,stance loss: 0.65951 
Better F1! Saving model!
Saving model of best f1: 0.5471050708507975
              precision    recall  f1-score   support

           0   0.743210  0.648707  0.692750       464
           1   0.539326  0.662069  0.594427       145
           2   0.366667  0.443548  0.401460       124

    accuracy                       0.616644       733
   macro avg   0.549734  0.584775  0.562879       733
weighted avg   0.639179  0.616644  0.624023       733

Test Acc: 0.616643929058663 F1_ma:0.5471050708507975
Train step: 1410 acc:0.74784 total_loss: 0.93667  loss:0.93562,stance loss: 0.8004 
Train step: 1420 acc:0.74752 total_loss: 0.93459  loss:0.71592,stance loss: 0.52577 
Train step: 1430 acc:0.7454 total_loss: 0.94204  loss:1.2843,stance loss: 1.1554 
Train step: 1440 acc:0.74401 total_loss: 0.94858  loss:0.74706,stance loss: 0.49053 
Train step: 1450 acc:0.7484 total_loss: 0.94217  loss:0.78395,stance loss: 0.75491 
Train step: 1460 acc:0.74849 total_loss: 0.94692  loss:1.1214,stance loss: 1.0105 
Train step: 1470 acc:0.74964 total_loss: 0.94305  loss:0.60934,stance loss: 0.47468 
Train step: 1480 acc:0.74966 total_loss: 0.94169  loss:0.70956,stance loss: 0.52286 
Train step: 1490 acc:0.75415 total_loss: 0.93297  loss:0.69241,stance loss: 0.52623 
Train step: 1500 acc:0.75637 total_loss: 0.93186  loss:0.83523,stance loss: 0.7023 
Train step: 1510 acc:0.75521 total_loss: 0.93624  loss:0.85529,stance loss: 0.63267 
Train step: 1520 acc:0.7547 total_loss: 0.93399  loss:1.3154,stance loss: 1.0421 
Train step: 1530 acc:0.75238 total_loss: 0.9361  loss:0.66575,stance loss: 0.50297 
Train step: 1540 acc:0.75178 total_loss: 0.93811  loss:1.2634,stance loss: 1.0476 
Train step: 1550 acc:0.75317 total_loss: 0.93478  loss:0.53869,stance loss: 0.29909 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.75 total_loss: 0.78768  loss:0.66461,stance loss: 0.39995 
Train step: 1570 acc:0.77941 total_loss: 0.78748  loss:1.2458,stance loss: 0.9698 
Train step: 1580 acc:0.79861 total_loss: 0.78432  loss:0.50338,stance loss: 0.35722 
Train step: 1590 acc:0.78547 total_loss: 0.81843  loss:0.80001,stance loss: 0.70056 
Train step: 1600 acc:0.78324 total_loss: 0.82511  loss:0.72889,stance loss: 0.46206 
Train step: 1610 acc:0.78289 total_loss: 0.83403  loss:0.98071,stance loss: 0.8981 
Train step: 1620 acc:0.77705 total_loss: 0.84189  loss:0.7251,stance loss: 0.58502 
Train step: 1630 acc:0.77922 total_loss: 0.84322  loss:0.75987,stance loss: 0.61783 
Train step: 1640 acc:0.78017 total_loss: 0.85935  loss:1.3969,stance loss: 1.157 
Train step: 1650 acc:0.78093 total_loss: 0.85969  loss:1.3525,stance loss: 1.5719 
Train step: 1660 acc:0.78505 total_loss: 0.85159  loss:0.66267,stance loss: 0.56824 
Train step: 1670 acc:0.78152 total_loss: 0.8708  loss:0.75358,stance loss: 0.59798 
Train step: 1680 acc:0.78346 total_loss: 0.86945  loss:0.78793,stance loss: 0.66473 
Train step: 1690 acc:0.7833 total_loss: 0.8585  loss:0.82439,stance loss: 0.64251 
Train step: 1700 acc:0.78444 total_loss: 0.86014  loss:0.97939,stance loss: 0.68736 
Train step: 1710 acc:0.78344 total_loss: 0.86558  loss:0.95436,stance loss: 1.2328 
Train step: 1720 acc:0.78593 total_loss: 0.85947  loss:0.35292,stance loss: 0.20371 
Train step: 1730 acc:0.78849 total_loss: 0.85  loss:0.69275,stance loss: 0.60439 
Train step: 1740 acc:0.79078 total_loss: 0.84613  loss:0.85663,stance loss: 0.7642 
Train step: 1750 acc:0.78839 total_loss: 0.85201  loss:0.69966,stance loss: 0.50898 
Train step: 1760 acc:0.78925 total_loss: 0.84855  loss:0.84048,stance loss: 0.70633 
Train step: 1770 acc:0.78831 total_loss: 0.84897  loss:0.81647,stance loss: 0.52173 
Train step: 1780 acc:0.78744 total_loss: 0.85149  loss:0.79,stance loss: 0.63605 
Train step: 1790 acc:0.79035 total_loss: 0.84443  loss:0.61922,stance loss: 0.52325 
Train step: 1800 acc:0.78922 total_loss: 0.84443  loss:0.7201,stance loss: 0.59858 
Train step: 1810 acc:0.78988 total_loss: 0.84478  loss:1.3226,stance loss: 1.5552 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.75 total_loss: 0.87534  loss:1.2894,stance loss: 1.4328 
Train step: 1830 acc:0.81597 total_loss: 0.77866  loss:0.40941,stance loss: 0.24132 
Train step: 1840 acc:0.82812 total_loss: 0.78718  loss:0.65674,stance loss: 0.53966 
Train step: 1850 acc:0.8273 total_loss: 0.78576  loss:0.81604,stance loss: 0.67596 
Train step: 1860 acc:0.81901 total_loss: 0.78643  loss:1.0296,stance loss: 0.86595 
Train step: 1870 acc:0.80496 total_loss: 0.80372  loss:0.66405,stance loss: 0.49876 
Train step: 1880 acc:0.80515 total_loss: 0.79129  loss:0.63597,stance loss: 0.51545 
Train step: 1890 acc:0.80449 total_loss: 0.79368  loss:1.2949,stance loss: 1.1115 
Train step: 1900 acc:0.81179 total_loss: 0.77115  loss:0.62598,stance loss: 0.51377 
Train step: 1910 acc:0.81314 total_loss: 0.76424  loss:0.69062,stance loss: 0.56491 
Train step: 1920 acc:0.81019 total_loss: 0.76771  loss:0.80511,stance loss: 0.74022 
Train step: 1930 acc:0.80985 total_loss: 0.76264  loss:0.52586,stance loss: 0.41071 
Train step: 1940 acc:0.8125 total_loss: 0.75481  loss:0.50255,stance loss: 0.43609 
Train step: 1950 acc:0.8125 total_loss: 0.74937  loss:0.94503,stance loss: 0.92343 
Train step: 1960 acc:0.81039 total_loss: 0.75627  loss:1.0201,stance loss: 0.99383 
Train step: 1970 acc:0.81131 total_loss: 0.75333  loss:0.41043,stance loss: 0.29096 
Train step: 1980 acc:0.81027 total_loss: 0.74936  loss:0.75698,stance loss: 0.59198 
Train step: 1990 acc:0.8132 total_loss: 0.74453  loss:0.65385,stance loss: 0.55598 
Train step: 2000 acc:0.8125 total_loss: 0.7445  loss:0.29411,stance loss: 0.13867 
Train step: 2010 acc:0.81345 total_loss: 0.73658  loss:0.29169,stance loss: 0.17653 
Train step: 2020 acc:0.8128 total_loss: 0.73951  loss:0.71631,stance loss: 0.57213 
Train step: 2030 acc:0.8125 total_loss: 0.74496  loss:0.86259,stance loss: 0.66295 
Train step: 2040 acc:0.81305 total_loss: 0.74166  loss:0.61902,stance loss: 0.52168 
Train step: 2050 acc:0.81408 total_loss: 0.74077  loss:0.64998,stance loss: 0.58644 
Train step: 2060 acc:0.8125 total_loss: 0.74407  loss:1.0181,stance loss: 1.3748 
Train step: 2070 acc:0.81202 total_loss: 0.74398  loss:0.79435,stance loss: 0.66394 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.86806 total_loss: 0.67954  loss:0.3621,stance loss: 0.29365 
Train step: 2090 acc:0.82895 total_loss: 0.71907  loss:0.65874,stance loss: 0.53841 
Train step: 2100 acc:0.84698 total_loss: 0.68298  loss:0.64121,stance loss: 0.5195 
Train step: 2110 acc:0.84615 total_loss: 0.6708  loss:0.36062,stance loss: 0.31406 
Train step: 2120 acc:0.84184 total_loss: 0.67482  loss:0.67406,stance loss: 0.5631 
Train step: 2130 acc:0.84428 total_loss: 0.68208  loss:0.93168,stance loss: 1.1896 
Train step: 2140 acc:0.83877 total_loss: 0.68229  loss:0.47932,stance loss: 0.37718 
Train step: 2150 acc:0.83703 total_loss: 0.68831  loss:0.48386,stance loss: 0.33204 
Train step: 2160 acc:0.83778 total_loss: 0.68984  loss:0.24252,stance loss: 0.039519 
Train step: 2170 acc:0.84028 total_loss: 0.68248  loss:0.89523,stance loss: 0.79227 
Train step: 2180 acc:0.84002 total_loss: 0.67472  loss:0.72407,stance loss: 0.78669 
Train step: 2190 acc:0.83876 total_loss: 0.68323  loss:0.49194,stance loss: 0.41995 
Train step: 2200 acc:0.83866 total_loss: 0.6799  loss:0.48066,stance loss: 0.36913 
Train step: 2210 acc:0.83903 total_loss: 0.67188  loss:0.68992,stance loss: 0.53154 
Train step: 2220 acc:0.84228 total_loss: 0.66281  loss:0.91725,stance loss: 0.77331 
Train step: 2230 acc:0.84473 total_loss: 0.65944  loss:0.98071,stance loss: 0.62448 
Train step: 2240 acc:0.8432 total_loss: 0.66279  loss:1.3331,stance loss: 0.90617 
Train step: 2250 acc:0.84113 total_loss: 0.66637  loss:0.81464,stance loss: 0.84257 
Train step: 2260 acc:0.84259 total_loss: 0.66431  loss:1.0766,stance loss: 0.92577 
Train step: 2270 acc:0.84296 total_loss: 0.66249  loss:0.53886,stance loss: 0.45256 
Train step: 2280 acc:0.8433 total_loss: 0.66329  loss:0.35264,stance loss: 0.27348 
Train step: 2290 acc:0.84304 total_loss: 0.66196  loss:0.75006,stance loss: 0.6771 
Train step: 2300 acc:0.84416 total_loss: 0.66123  loss:0.54807,stance loss: 0.49829 
Train step: 2310 acc:0.84467 total_loss: 0.66328  loss:0.68709,stance loss: 0.77601 
Train step: 2320 acc:0.84337 total_loss: 0.6643  loss:0.67669,stance loss: 0.56053 
Train step: 2330 acc:0.84482 total_loss: 0.6574  loss:0.17727,stance loss: 0.085025 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.89375 total_loss: 0.59295  loss:0.86441,stance loss: 0.63617 
Train step: 2350 acc:0.87187 total_loss: 0.63829  loss:1.0224,stance loss: 0.94552 
Train step: 2360 acc:0.88333 total_loss: 0.56292  loss:0.52451,stance loss: 0.42115 
Train step: 2370 acc:0.87813 total_loss: 0.56821  loss:0.88811,stance loss: 1.0881 
Train step: 2380 acc:0.875 total_loss: 0.55119  loss:0.48616,stance loss: 0.017835 
Train step: 2390 acc:0.87292 total_loss: 0.55607  loss:0.093818,stance loss: 0.017423 
Train step: 2400 acc:0.87589 total_loss: 0.56406  loss:0.85669,stance loss: 1.2913 
Train step: 2410 acc:0.87656 total_loss: 0.5542  loss:0.44951,stance loss: 0.34587 
Train step: 2420 acc:0.87083 total_loss: 0.57103  loss:0.60824,stance loss: 0.5287 
Train step: 2430 acc:0.86938 total_loss: 0.56473  loss:0.40105,stance loss: 0.19251 
Train step: 2440 acc:0.86705 total_loss: 0.56905  loss:1.1569,stance loss: 1.2969 
Train step: 2450 acc:0.87083 total_loss: 0.55821  loss:0.38094,stance loss: 0.3013 
Train step: 2460 acc:0.87115 total_loss: 0.55251  loss:0.56823,stance loss: 0.43579 
Train step: 2470 acc:0.87098 total_loss: 0.54874  loss:0.17335,stance loss: 0.11417 
Train step: 2480 acc:0.86875 total_loss: 0.55275  loss:0.87432,stance loss: 0.8566 
Train step: 2490 acc:0.86797 total_loss: 0.55136  loss:0.40959,stance loss: 0.1506 
Train step: 2500 acc:0.87096 total_loss: 0.54395  loss:0.42796,stance loss: 0.29965 
Train step: 2510 acc:0.86875 total_loss: 0.54923  loss:0.70785,stance loss: 0.61764 
Train step: 2520 acc:0.86711 total_loss: 0.55196  loss:0.33817,stance loss: 0.24933 
Train step: 2530 acc:0.86844 total_loss: 0.55055  loss:0.52949,stance loss: 0.42344 
Train step: 2540 acc:0.86905 total_loss: 0.54891  loss:0.37172,stance loss: 0.19416 
Train step: 2550 acc:0.87187 total_loss: 0.5479  loss:0.86323,stance loss: 1.3585 
Train step: 2560 acc:0.87011 total_loss: 0.55328  loss:0.54983,stance loss: 0.50828 
Train step: 2570 acc:0.87214 total_loss: 0.55218  loss:0.27889,stance loss: 0.18256 
Train step: 2580 acc:0.8715 total_loss: 0.55256  loss:1.524,stance loss: 1.5494 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.9375 total_loss: 0.2876  loss:0.2876,stance loss: 0.20233 
Train step: 2600 acc:0.86364 total_loss: 0.55439  loss:0.48347,stance loss: 0.44113 
Train step: 2610 acc:0.86012 total_loss: 0.5508  loss:0.55293,stance loss: 0.41632 
Train step: 2620 acc:0.86895 total_loss: 0.50906  loss:0.40744,stance loss: 0.30769 
Train step: 2630 acc:0.87805 total_loss: 0.52034  loss:0.30344,stance loss: 0.1957 
Train step: 2640 acc:0.88235 total_loss: 0.519  loss:0.50482,stance loss: 0.37675 
Train step: 2650 acc:0.88217 total_loss: 0.51503  loss:0.61983,stance loss: 0.47253 
Train step: 2660 acc:0.89085 total_loss: 0.49804  loss:0.23193,stance loss: 0.11579 
Train step: 2670 acc:0.89506 total_loss: 0.4818  loss:0.25559,stance loss: 0.15119 
Train step: 2680 acc:0.89286 total_loss: 0.48824  loss:0.71493,stance loss: 1.0458 
Train step: 2690 acc:0.89418 total_loss: 0.48714  loss:0.56974,stance loss: 0.40992 
Train step: 2700 acc:0.89527 total_loss: 0.49001  loss:0.56779,stance loss: 0.53201 
Train step: 2710 acc:0.8936 total_loss: 0.49261  loss:0.80338,stance loss: 1.0609 
Train step: 2720 acc:0.89552 total_loss: 0.4854  loss:0.37106,stance loss: 0.3333 
Train step: 2730 acc:0.8945 total_loss: 0.48597  loss:1.242,stance loss: 1.5118 
Train step: 2740 acc:0.89487 total_loss: 0.47901  loss:0.23098,stance loss: 0.16396 
Train step: 2750 acc:0.89169 total_loss: 0.49269  loss:1.1693,stance loss: 0.62067 
Train step: 2760 acc:0.89291 total_loss: 0.49239  loss:0.9545,stance loss: 1.3442 
Train step: 2770 acc:0.89261 total_loss: 0.4954  loss:0.4699,stance loss: 0.38738 
Train step: 2780 acc:0.89071 total_loss: 0.50381  loss:0.81335,stance loss: 0.59216 
Train step: 2790 acc:0.89241 total_loss: 0.49494  loss:0.3534,stance loss: 0.33605 
Train step: 2800 acc:0.89366 total_loss: 0.48852  loss:0.51156,stance loss: 0.33337 
Train step: 2810 acc:0.8931 total_loss: 0.48717  loss:0.88458,stance loss: 0.58346 
Train step: 2820 acc:0.89448 total_loss: 0.48058  loss:0.51446,stance loss: 0.42468 
Train step: 2830 acc:0.89367 total_loss: 0.48567  loss:0.41068,stance loss: 0.37903 
Train step: 2840 acc:0.89392 total_loss: 0.48809  loss:0.31235,stance loss: 0.21016 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:1.0 total_loss: 0.22935  loss:0.14518,stance loss: 0.087716 
Train step: 2860 acc:0.93229 total_loss: 0.29794  loss:0.12102,stance loss: 0.03735 
Train step: 2870 acc:0.91761 total_loss: 0.39736  loss:0.30483,stance loss: 0.26583 
Train step: 2880 acc:0.92188 total_loss: 0.38633  loss:0.58566,stance loss: 1.0164 
Train step: 2890 acc:0.91667 total_loss: 0.39775  loss:0.49783,stance loss: 0.51221 
Train step: 2900 acc:0.91707 total_loss: 0.39647  loss:0.44812,stance loss: 0.43685 
Train step: 2910 acc:0.91734 total_loss: 0.39897  loss:0.69077,stance loss: 0.51339 
Train step: 2920 acc:0.91753 total_loss: 0.40445  loss:0.41258,stance loss: 0.33895 
Train step: 2930 acc:0.91463 total_loss: 0.41002  loss:0.84483,stance loss: 1.0593 
Train step: 2940 acc:0.91508 total_loss: 0.41391  loss:0.16833,stance loss: 0.14044 
Train step: 2950 acc:0.91544 total_loss: 0.40534  loss:0.13886,stance loss: 0.10532 
Train step: 2960 acc:0.91295 total_loss: 0.41512  loss:0.95415,stance loss: 0.72804 
Train step: 2970 acc:0.91547 total_loss: 0.408  loss:0.76537,stance loss: 0.31779 
Train step: 2980 acc:0.91572 total_loss: 0.40799  loss:0.47188,stance loss: 0.43629 
Train step: 2990 acc:0.91549 total_loss: 0.41111  loss:0.15612,stance loss: 0.1209 
Train step: 3000 acc:0.91406 total_loss: 0.41325  loss:0.38339,stance loss: 0.25831 
Train step: 3010 acc:0.91358 total_loss: 0.4144  loss:0.20101,stance loss: 0.12672 
Train step: 3020 acc:0.91388 total_loss: 0.41566  loss:0.16507,stance loss: 0.041625 
Train step: 3030 acc:0.91415 total_loss: 0.41375  loss:0.35965,stance loss: 0.2596 
Train step: 3040 acc:0.91243 total_loss: 0.41699  loss:0.88452,stance loss: 0.78514 
Train step: 3050 acc:0.91275 total_loss: 0.41989  loss:0.41923,stance loss: 0.35592 
Train step: 3060 acc:0.91038 total_loss: 0.42312  loss:1.1803,stance loss: 1.4746 
Train step: 3070 acc:0.91047 total_loss: 0.42166  loss:0.3441,stance loss: 0.32661 
Train step: 3080 acc:0.90975 total_loss: 0.42032  loss:0.26667,stance loss: 0.27221 
Train step: 3090 acc:0.9109 total_loss: 0.41554  loss:0.33253,stance loss: 0.34024 
Train step: 3100 acc:0.9122 total_loss: 0.41207  loss:0.22213,stance loss: 0.14984 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.95833 total_loss: 0.25441  loss:0.20336,stance loss: 0.131 
Train step: 3120 acc:0.94231 total_loss: 0.33651  loss:0.11709,stance loss: 0.030607 
Train step: 3130 acc:0.93478 total_loss: 0.34619  loss:0.21853,stance loss: 0.1555 
Train step: 3140 acc:0.9375 total_loss: 0.31721  loss:0.067901,stance loss: 0.015618 
Train step: 3150 acc:0.92733 total_loss: 0.35572  loss:0.59838,stance loss: 0.56089 
Train step: 3160 acc:0.92925 total_loss: 0.34428  loss:0.39798,stance loss: 0.31892 
Train step: 3170 acc:0.93254 total_loss: 0.33318  loss:0.16462,stance loss: 0.15526 
Train step: 3180 acc:0.93151 total_loss: 0.34076  loss:0.62881,stance loss: 0.47487 
Train step: 3190 acc:0.93148 total_loss: 0.35138  loss:0.23391,stance loss: 0.17308 
Train step: 3200 acc:0.9328 total_loss: 0.35529  loss:0.80092,stance loss: 1.235 
Train step: 3210 acc:0.93022 total_loss: 0.36278  loss:0.44971,stance loss: 0.32245 
Train step: 3220 acc:0.92976 total_loss: 0.35936  loss:0.22751,stance loss: 0.17141 
Train step: 3230 acc:0.92886 total_loss: 0.36031  loss:0.34115,stance loss: 0.29081 
Train step: 3240 acc:0.92716 total_loss: 0.36723  loss:0.30279,stance loss: 0.2417 
Train step: 3250 acc:0.92439 total_loss: 0.37089  loss:0.86905,stance loss: 1.2085 
Train step: 3260 acc:0.9232 total_loss: 0.37482  loss:0.39803,stance loss: 0.34991 
Train step: 3270 acc:0.92255 total_loss: 0.37546  loss:0.50614,stance loss: 0.44198 
Train step: 3280 acc:0.92197 total_loss: 0.37273  loss:0.48132,stance loss: 0.41832 
Train step: 3290 acc:0.92145 total_loss: 0.37117  loss:0.20596,stance loss: 0.17722 
Train step: 3300 acc:0.92358 total_loss: 0.36352  loss:0.13146,stance loss: 0.042368 
Train step: 3310 acc:0.92334 total_loss: 0.36219  loss:0.09362,stance loss: 0.038459 
Train step: 3320 acc:0.92342 total_loss: 0.36394  loss:0.059127,stance loss: 0.011066 
Train step: 3330 acc:0.92349 total_loss: 0.36614  loss:0.32979,stance loss: 0.27491 
Train step: 3340 acc:0.92328 total_loss: 0.36965  loss:0.36752,stance loss: 0.30416 
Train step: 3350 acc:0.92413 total_loss: 0.36697  loss:0.70648,stance loss: 1.1078 
Train step: 3360 acc:0.9254 total_loss: 0.36604  loss:0.029935,stance loss: 0.0052811 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.92188 total_loss: 0.31138  loss:0.2975,stance loss: 0.16363 
Train step: 3380 acc:0.93304 total_loss: 0.38835  loss:0.39812,stance loss: 0.35007 
Train step: 3390 acc:0.94531 total_loss: 0.35156  loss:0.39526,stance loss: 0.36816 
Train step: 3400 acc:0.95221 total_loss: 0.34373  loss:0.41692,stance loss: 0.2728 
Train step: 3410 acc:0.95455 total_loss: 0.34862  loss:0.21267,stance loss: 0.15149 
Train step: 3420 acc:0.94907 total_loss: 0.34276  loss:0.094704,stance loss: 0.039793 
Train step: 3430 acc:0.9502 total_loss: 0.34418  loss:0.53917,stance loss: 1.0097 
Train step: 3440 acc:0.95186 total_loss: 0.33303  loss:0.081615,stance loss: 0.045196 
Train step: 3450 acc:0.95164 total_loss: 0.32722  loss:0.67783,stance loss: 0.59921 
Train step: 3460 acc:0.94947 total_loss: 0.33569  loss:0.23305,stance loss: 0.23258 
Train step: 3470 acc:0.94952 total_loss: 0.33827  loss:0.13663,stance loss: 0.10689 
Train step: 3480 acc:0.95066 total_loss: 0.32379  loss:0.1397,stance loss: 0.069719 
Train step: 3490 acc:0.95161 total_loss: 0.32917  loss:0.5658,stance loss: 1.0107 
Train step: 3500 acc:0.95289 total_loss: 0.32238  loss:0.17834,stance loss: 0.088902 
Train step: 3510 acc:0.95139 total_loss: 0.32084  loss:0.1974,stance loss: 0.15198 
Train step: 3520 acc:0.94805 total_loss: 0.32904  loss:0.38585,stance loss: 0.29845 
Train step: 3530 acc:0.94741 total_loss: 0.32575  loss:0.17147,stance loss: 0.13248 
Train step: 3540 acc:0.94612 total_loss: 0.32812  loss:0.12585,stance loss: 0.085994 
Train step: 3550 acc:0.94327 total_loss: 0.33494  loss:0.99571,stance loss: 1.4085 
Train step: 3560 acc:0.94201 total_loss: 0.33901  loss:0.9178,stance loss: 1.3225 
Train step: 3570 acc:0.93995 total_loss: 0.35019  loss:0.16448,stance loss: 0.094665 
Train step: 3580 acc:0.93867 total_loss: 0.34828  loss:0.19405,stance loss: 0.12391 
Train step: 3590 acc:0.93666 total_loss: 0.35009  loss:0.29018,stance loss: 0.27992 
Train step: 3600 acc:0.9375 total_loss: 0.35002  loss:0.12627,stance loss: 0.064861 
Train step: 3610 acc:0.93648 total_loss: 0.34867  loss:0.24529,stance loss: 0.070905 
Train step: 3620 acc:0.93725 total_loss: 0.34535  loss:0.065834,stance loss: 0.016881 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9625 total_loss: 0.35521  loss:0.28458,stance loss: 0.27066 
Train step: 3640 acc:0.94583 total_loss: 0.3407  loss:0.11782,stance loss: 0.058695 
Train step: 3650 acc:0.9525 total_loss: 0.27791  loss:0.049169,stance loss: 0.0076373 
Train step: 3660 acc:0.95179 total_loss: 0.2508  loss:0.27656,stance loss: 0.1941 
Train step: 3670 acc:0.95278 total_loss: 0.24816  loss:0.13171,stance loss: 0.08575 
Train step: 3680 acc:0.95795 total_loss: 0.23706  loss:0.56711,stance loss: 1.018 
Train step: 3690 acc:0.95673 total_loss: 0.25052  loss:0.76605,stance loss: 1.1555 
Train step: 3700 acc:0.95583 total_loss: 0.25528  loss:0.23863,stance loss: 0.22367 
Train step: 3710 acc:0.95368 total_loss: 0.26885  loss:0.1432,stance loss: 0.11076 
Train step: 3720 acc:0.95526 total_loss: 0.26727  loss:0.18653,stance loss: 0.11594 
Train step: 3730 acc:0.95179 total_loss: 0.28068  loss:0.16124,stance loss: 0.11372 
Train step: 3740 acc:0.94728 total_loss: 0.29433  loss:0.30243,stance loss: 0.18702 
Train step: 3750 acc:0.9465 total_loss: 0.29439  loss:0.58985,stance loss: 0.47441 
Train step: 3760 acc:0.94583 total_loss: 0.29489  loss:0.70406,stance loss: 0.28806 
Train step: 3770 acc:0.94569 total_loss: 0.29761  loss:0.23836,stance loss: 0.14722 
Train step: 3780 acc:0.94597 total_loss: 0.30034  loss:0.80724,stance loss: 0.79501 
Train step: 3790 acc:0.94621 total_loss: 0.29898  loss:0.21481,stance loss: 0.10236 
Train step: 3800 acc:0.94643 total_loss: 0.2971  loss:0.20845,stance loss: 0.15796 
Train step: 3810 acc:0.94696 total_loss: 0.29572  loss:0.17679,stance loss: 0.16538 
Train step: 3820 acc:0.94872 total_loss: 0.29197  loss:0.16719,stance loss: 0.13124 
Train step: 3830 acc:0.94817 total_loss: 0.29252  loss:0.49354,stance loss: 0.40652 
Train step: 3840 acc:0.94767 total_loss: 0.28907  loss:0.32676,stance loss: 0.16443 
Train step: 3850 acc:0.94833 total_loss: 0.28888  loss:0.086615,stance loss: 0.04721 
Train step: 3860 acc:0.94814 total_loss: 0.28827  loss:0.18638,stance loss: 0.16833 
Train step: 3870 acc:0.94872 total_loss: 0.28842  loss:0.093097,stance loss: 0.042659 
Train step: 3880 acc:0.94853 total_loss: 0.29016  loss:0.64421,stance loss: 1.0452 
Training finished.


Reload the best model with best f1 0.5471050708507975 from path test_outputs/bert-cross-topic/a/2023-08-14 14-00-23/state_dict


              precision    recall  f1-score   support

           0   0.743210  0.648707  0.692750       464
           1   0.539326  0.662069  0.594427       145
           2   0.366667  0.443548  0.401460       124

    accuracy                       0.616644       733
   macro avg   0.549734  0.584775  0.562879       733
weighted avg   0.639179  0.616644  0.624023       733

Test Acc: 0.616643929058663 F1_ma:0.5471050708507975
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5471050708507975
acc: 0.616643929058663, f1 :0.5628791287612128
classification report: 
              precision    recall  f1-score   support

         Con     0.7432    0.6487    0.6928       464
        None     0.5393    0.6621    0.5944       145
         Pro     0.3667    0.4435    0.4015       124

    accuracy                         0.6166       733
   macro avg     0.5497    0.5848    0.5629       733
weighted avg     0.6392    0.6166    0.6240       733

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 14-20-23', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 14-20-23
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.5093  loss:1.5093,stance loss: 0.60292 
Train step: 10 acc:0.19318 total_loss: 1.767  loss:1.7042,stance loss: 1.1078 
Better F1! Saving model!
Saving model of best f1: 0.09105084105084106
              precision    recall  f1-score   support

           0   0.647059  0.023707  0.045738       464
           1   0.013393  0.020690  0.016260       145
           2   0.085366  0.338710  0.136364       124

    accuracy                       0.076398       733
   macro avg   0.248606  0.127702  0.066121       733
weighted avg   0.426688  0.076398  0.055238       733

Test Acc: 0.07639836289222374 F1_ma:0.09105084105084106
Train step: 20 acc:0.22917 total_loss: 1.7267  loss:1.6418,stance loss: 1.101 
Better F1! Saving model!
Saving model of best f1: 0.23032746823069403
              precision    recall  f1-score   support

           0   0.637615  0.299569  0.407625       464
           1   0.045333  0.117241  0.065385       145
           2   0.050000  0.056452  0.053030       124

    accuracy                       0.222374       733
   macro avg   0.244316  0.157754  0.175347       733
weighted avg   0.421046  0.222374  0.279938       733

Test Acc: 0.22237380627557982 F1_ma:0.23032746823069403
Train step: 30 acc:0.27621 total_loss: 1.7147  loss:1.6135,stance loss: 1.0677 
Better F1! Saving model!
Saving model of best f1: 0.3791018998272885
              precision    recall  f1-score   support

           0   0.632565  0.946121  0.758204       464
           1   0.055556  0.013793  0.022099       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.601637       733
   macro avg   0.229373  0.319971  0.260101       733
weighted avg   0.411413  0.601637  0.484326       733

Test Acc: 0.6016371077762619 F1_ma:0.3791018998272885
Train step: 40 acc:0.30183 total_loss: 1.7033  loss:1.7312,stance loss: 1.1523 
Better F1! Saving model!
Saving model of best f1: 0.38763575605680867
              precision    recall  f1-score   support

           0   0.633015  1.000000  0.775272       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211005  0.333333  0.258424       733
weighted avg   0.400708  0.633015  0.490759       733

Test Acc: 0.6330150068212824 F1_ma:0.38763575605680867
Train step: 50 acc:0.33456 total_loss: 1.6954  loss:1.8026,stance loss: 1.7564 
Train step: 60 acc:0.36066 total_loss: 1.6861  loss:1.499,stance loss: 1.0195 
Train step: 70 acc:0.375 total_loss: 1.6702  loss:1.3301,stance loss: 0.84712 
Train step: 80 acc:0.39429 total_loss: 1.6675  loss:1.8666,stance loss: 1.7861 
Train step: 90 acc:0.40591 total_loss: 1.6498  loss:1.3609,stance loss: 0.71008 
Train step: 100 acc:0.40718 total_loss: 1.6471  loss:1.6955,stance loss: 1.2153 
Train step: 110 acc:0.41441 total_loss: 1.6392  loss:1.4366,stance loss: 0.9178 
Train step: 120 acc:0.41839 total_loss: 1.6365  loss:1.7042,stance loss: 1.5384 
Train step: 130 acc:0.42366 total_loss: 1.6248  loss:1.4212,stance loss: 0.75479 
Train step: 140 acc:0.4273 total_loss: 1.62  loss:1.3027,stance loss: 0.9187 
Train step: 150 acc:0.42674 total_loss: 1.6171  loss:1.4432,stance loss: 1.0929 
Train step: 160 acc:0.43168 total_loss: 1.6128  loss:1.5574,stance loss: 1.1771 
Train step: 170 acc:0.44115 total_loss: 1.6038  loss:1.8388,stance loss: 1.3318 
Train step: 180 acc:0.4451 total_loss: 1.5994  loss:1.6338,stance loss: 1.2951 
Train step: 190 acc:0.44699 total_loss: 1.5988  loss:1.6136,stance loss: 1.0073 
Train step: 200 acc:0.45211 total_loss: 1.5932  loss:1.2155,stance loss: 0.82355 
Train step: 210 acc:0.45586 total_loss: 1.591  loss:1.6826,stance loss: 1.3122 
Better F1! Saving model!
Saving model of best f1: 0.38773747841105355
              precision    recall  f1-score   support

           0   0.646974  0.967672  0.775475       464
           1   0.589744  0.158621  0.250000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.643929       733
   macro avg   0.412239  0.375431  0.341825       733
weighted avg   0.526206  0.643929  0.540342       733

Test Acc: 0.6439290586630286 F1_ma:0.38773747841105355
Train step: 220 acc:0.45956 total_loss: 1.5871  loss:1.5853,stance loss: 1.1924 
Train step: 230 acc:0.4651 total_loss: 1.5815  loss:1.392,stance loss: 1.032 
Train step: 240 acc:0.46966 total_loss: 1.5757  loss:1.4232,stance loss: 1.169 
Train step: 250 acc:0.47211 total_loss: 1.5742  loss:1.6667,stance loss: 1.2059 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5625 total_loss: 1.5799  loss:1.5245,stance loss: 1.2326 
Train step: 270 acc:0.54688 total_loss: 1.4991  loss:1.3922,stance loss: 1.0986 
Train step: 280 acc:0.5483 total_loss: 1.4711  loss:1.4601,stance loss: 1.0564 
Train step: 290 acc:0.57031 total_loss: 1.427  loss:1.1182,stance loss: 0.74294 
Train step: 300 acc:0.56101 total_loss: 1.4337  loss:1.4613,stance loss: 1.0749 
Train step: 310 acc:0.57212 total_loss: 1.4502  loss:1.4827,stance loss: 1.1288 
Train step: 320 acc:0.57863 total_loss: 1.4521  loss:1.4271,stance loss: 1.1309 
Train step: 330 acc:0.58594 total_loss: 1.438  loss:1.2214,stance loss: 0.85019 
Train step: 340 acc:0.58841 total_loss: 1.4381  loss:1.4507,stance loss: 1.2312 
Train step: 350 acc:0.59035 total_loss: 1.4276  loss:1.4406,stance loss: 1.1145 
Train step: 360 acc:0.59926 total_loss: 1.4137  loss:1.0462,stance loss: 0.80911 
Train step: 370 acc:0.59821 total_loss: 1.4129  loss:1.6344,stance loss: 1.273 
Train step: 380 acc:0.60348 total_loss: 1.4139  loss:1.6139,stance loss: 1.6278 
Train step: 390 acc:0.60369 total_loss: 1.4013  loss:1.3194,stance loss: 0.9283 
Train step: 400 acc:0.60739 total_loss: 1.3974  loss:1.6301,stance loss: 1.7587 
Train step: 410 acc:0.61266 total_loss: 1.3886  loss:1.395,stance loss: 0.96171 
Train step: 420 acc:0.61574 total_loss: 1.3815  loss:1.28,stance loss: 0.95983 
Train step: 430 acc:0.61483 total_loss: 1.3802  loss:1.2945,stance loss: 1.0775 
Train step: 440 acc:0.61298 total_loss: 1.3798  loss:1.3985,stance loss: 1.0932 
Train step: 450 acc:0.6123 total_loss: 1.3789  loss:1.3446,stance loss: 1.0101 
Train step: 460 acc:0.60829 total_loss: 1.3781  loss:1.4469,stance loss: 1.01 
Train step: 470 acc:0.61262 total_loss: 1.3727  loss:1.342,stance loss: 1.4322 
Train step: 480 acc:0.61149 total_loss: 1.3709  loss:1.2566,stance loss: 0.97531 
Train step: 490 acc:0.61395 total_loss: 1.3669  loss:1.0245,stance loss: 0.65259 
Train step: 500 acc:0.61674 total_loss: 1.364  loss:1.1228,stance loss: 0.85186 
Train step: 510 acc:0.6188 total_loss: 1.3595  loss:1.5521,stance loss: 1.0112 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.60417 total_loss: 1.2618  loss:1.3504,stance loss: 0.98267 
Train step: 530 acc:0.67308 total_loss: 1.2726  loss:1.4258,stance loss: 1.0882 
Train step: 540 acc:0.65761 total_loss: 1.2709  loss:1.3937,stance loss: 1.1313 
Train step: 550 acc:0.68939 total_loss: 1.2336  loss:1.0126,stance loss: 0.66976 
Train step: 560 acc:0.68459 total_loss: 1.2498  loss:1.2241,stance loss: 0.8722 
Train step: 570 acc:0.67453 total_loss: 1.2517  loss:1.023,stance loss: 0.7619 
Train step: 580 acc:0.66964 total_loss: 1.2608  loss:1.2973,stance loss: 1.141 
Train step: 590 acc:0.66438 total_loss: 1.2543  loss:0.95649,stance loss: 0.66666 
Train step: 600 acc:0.66265 total_loss: 1.2549  loss:1.237,stance loss: 0.92694 
Train step: 610 acc:0.66129 total_loss: 1.2551  loss:1.4269,stance loss: 1.115 
Train step: 620 acc:0.66019 total_loss: 1.2582  loss:1.164,stance loss: 0.84983 
Train step: 630 acc:0.65985 total_loss: 1.2515  loss:1.1545,stance loss: 1.069 
Train step: 640 acc:0.65955 total_loss: 1.2469  loss:1.318,stance loss: 1.0193 
Train step: 650 acc:0.664 total_loss: 1.2384  loss:1.087,stance loss: 0.83521 
Train step: 660 acc:0.66696 total_loss: 1.2276  loss:1.4585,stance loss: 1.324 
Train step: 670 acc:0.66381 total_loss: 1.2323  loss:1.6427,stance loss: 1.6901 
Better F1! Saving model!
Saving model of best f1: 0.45522327469553453
              precision    recall  f1-score   support

           0   0.712727  0.422414  0.530447       464
           1   0.404255  0.786207  0.533958       145
           2   0.323864  0.459677  0.380000       124

    accuracy                       0.500682       733
   macro avg   0.480282  0.556099  0.481468       733
weighted avg   0.585923  0.500682  0.505690       733

Test Acc: 0.5006821282401092 F1_ma:0.45522327469553453
Train step: 680 acc:0.66488 total_loss: 1.2332  loss:1.254,stance loss: 1.0142 
Train step: 690 acc:0.66366 total_loss: 1.2283  loss:1.0538,stance loss: 0.79946 
Train step: 700 acc:0.66086 total_loss: 1.2269  loss:1.3861,stance loss: 1.0207 
Train step: 710 acc:0.6603 total_loss: 1.2272  loss:1.035,stance loss: 0.77844 
Train step: 720 acc:0.66102 total_loss: 1.2274  loss:1.5685,stance loss: 1.1781 
Train step: 730 acc:0.66256 total_loss: 1.2258  loss:1.2384,stance loss: 1.0321 
Train step: 740 acc:0.66143 total_loss: 1.2232  loss:1.4216,stance loss: 1.1753 
Train step: 750 acc:0.65933 total_loss: 1.2262  loss:1.444,stance loss: 1.292 
Train step: 760 acc:0.66075 total_loss: 1.2219  loss:1.1748,stance loss: 0.85764 
Train step: 770 acc:0.66033 total_loss: 1.2255  loss:1.54,stance loss: 1.2094 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.6875 total_loss: 1.0933  loss:0.63224,stance loss: 0.3797 
Train step: 790 acc:0.69643 total_loss: 1.189  loss:0.83828,stance loss: 0.67232 
Train step: 800 acc:0.71875 total_loss: 1.1447  loss:1.541,stance loss: 1.7284 
Train step: 810 acc:0.7114 total_loss: 1.1362  loss:1.0616,stance loss: 0.88313 
Train step: 820 acc:0.70739 total_loss: 1.1073  loss:1.0268,stance loss: 0.73028 
Train step: 830 acc:0.69444 total_loss: 1.1341  loss:1.4268,stance loss: 1.5355 
Train step: 840 acc:0.69824 total_loss: 1.1397  loss:1.1939,stance loss: 0.79409 
Train step: 850 acc:0.69172 total_loss: 1.1388  loss:1.2881,stance loss: 1.0449 
Train step: 860 acc:0.6875 total_loss: 1.1522  loss:1.3284,stance loss: 1.158 
Train step: 870 acc:0.69814 total_loss: 1.1269  loss:0.79037,stance loss: 0.51574 
Train step: 880 acc:0.69471 total_loss: 1.1351  loss:1.1873,stance loss: 0.93573 
Train step: 890 acc:0.69134 total_loss: 1.1317  loss:1.0945,stance loss: 0.80939 
Train step: 900 acc:0.69556 total_loss: 1.1341  loss:1.0405,stance loss: 0.84289 
Train step: 910 acc:0.6917 total_loss: 1.1367  loss:1.01,stance loss: 0.67824 
Train step: 920 acc:0.69097 total_loss: 1.1344  loss:0.82197,stance loss: 0.62475 
Train step: 930 acc:0.69237 total_loss: 1.1372  loss:1.1168,stance loss: 0.93007 
Train step: 940 acc:0.69512 total_loss: 1.1351  loss:0.80764,stance loss: 0.61258 
Train step: 950 acc:0.69361 total_loss: 1.1308  loss:1.0656,stance loss: 0.72441 
Train step: 960 acc:0.69293 total_loss: 1.1335  loss:0.89688,stance loss: 0.63358 
Train step: 970 acc:0.6962 total_loss: 1.1241  loss:0.89877,stance loss: 0.62659 
Train step: 980 acc:0.69455 total_loss: 1.1304  loss:1.4653,stance loss: 1.6116 
Train step: 990 acc:0.69422 total_loss: 1.1251  loss:0.97255,stance loss: 0.78275 
Train step: 1000 acc:0.69727 total_loss: 1.1213  loss:0.64463,stance loss: 0.30751 
Train step: 1010 acc:0.69818 total_loss: 1.1168  loss:0.89674,stance loss: 0.65909 
Train step: 1020 acc:0.69621 total_loss: 1.122  loss:1.3418,stance loss: 1.0525 
Train step: 1030 acc:0.69439 total_loss: 1.129  loss:1.3608,stance loss: 1.2298 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.675 total_loss: 1.0333  loss:1.1926,stance loss: 0.89443 
Train step: 1050 acc:0.65417 total_loss: 1.0797  loss:0.9215,stance loss: 0.70865 
Train step: 1060 acc:0.7125 total_loss: 1.0286  loss:0.88162,stance loss: 0.6158 
Train step: 1070 acc:0.73036 total_loss: 1.0484  loss:1.3455,stance loss: 1.3243 
Train step: 1080 acc:0.72222 total_loss: 1.0685  loss:1.4288,stance loss: 1.4985 
Train step: 1090 acc:0.72386 total_loss: 1.0533  loss:1.1498,stance loss: 0.92571 
Train step: 1100 acc:0.72981 total_loss: 1.039  loss:1.0252,stance loss: 0.75883 
Train step: 1110 acc:0.72333 total_loss: 1.0484  loss:0.71813,stance loss: 0.55901 
Train step: 1120 acc:0.71765 total_loss: 1.0601  loss:1.4444,stance loss: 0.92049 
Train step: 1130 acc:0.71776 total_loss: 1.0549  loss:1.5361,stance loss: 1.0498 
Train step: 1140 acc:0.72024 total_loss: 1.0498  loss:0.57656,stance loss: 0.37993 
Train step: 1150 acc:0.71793 total_loss: 1.0541  loss:0.91195,stance loss: 0.67569 
Train step: 1160 acc:0.7225 total_loss: 1.045  loss:1.0615,stance loss: 0.82774 
Train step: 1170 acc:0.72037 total_loss: 1.0454  loss:0.9289,stance loss: 0.72541 
Train step: 1180 acc:0.72241 total_loss: 1.0405  loss:0.91602,stance loss: 0.68851 
Train step: 1190 acc:0.72419 total_loss: 1.0394  loss:1.0658,stance loss: 1.0368 
Train step: 1200 acc:0.72273 total_loss: 1.0473  loss:1.0418,stance loss: 0.74281 
Train step: 1210 acc:0.7225 total_loss: 1.0434  loss:0.77506,stance loss: 0.48588 
Train step: 1220 acc:0.72196 total_loss: 1.0394  loss:0.8138,stance loss: 0.67715 
Train step: 1230 acc:0.72468 total_loss: 1.0338  loss:0.94075,stance loss: 0.65689 
Train step: 1240 acc:0.72378 total_loss: 1.0368  loss:1.378,stance loss: 1.3473 
Train step: 1250 acc:0.72645 total_loss: 1.0327  loss:1.2391,stance loss: 0.88796 
Train step: 1260 acc:0.72667 total_loss: 1.0348  loss:0.97424,stance loss: 0.76819 
Train step: 1270 acc:0.7242 total_loss: 1.0415  loss:1.5718,stance loss: 1.2857 
Train step: 1280 acc:0.72245 total_loss: 1.0411  loss:1.055,stance loss: 0.83216 
Train step: 1290 acc:0.72157 total_loss: 1.0416  loss:0.77772,stance loss: 0.61139 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.78125 total_loss: 0.8509  loss:0.96783,stance loss: 0.73106 
Train step: 1310 acc:0.79688 total_loss: 0.87056  loss:0.86767,stance loss: 0.65166 
Train step: 1320 acc:0.79567 total_loss: 0.86388  loss:0.69315,stance loss: 0.50784 
Train step: 1330 acc:0.77083 total_loss: 0.90931  loss:1.2169,stance loss: 0.86664 
Train step: 1340 acc:0.77446 total_loss: 0.90184  loss:1.1543,stance loss: 0.82674 
Train step: 1350 acc:0.77232 total_loss: 0.91652  loss:1.3093,stance loss: 1.6105 
Train step: 1360 acc:0.7661 total_loss: 0.94458  loss:1.2989,stance loss: 1.0421 
Train step: 1370 acc:0.76398 total_loss: 0.96361  loss:1.0197,stance loss: 0.79096 
Train step: 1380 acc:0.76381 total_loss: 0.96442  loss:1.2047,stance loss: 1.4066 
Train step: 1390 acc:0.76042 total_loss: 0.96478  loss:0.7358,stance loss: 0.59135 
Train step: 1400 acc:0.75825 total_loss: 0.97301  loss:1.1114,stance loss: 0.83897 
Train step: 1410 acc:0.76239 total_loss: 0.97117  loss:0.84314,stance loss: 0.59373 
Train step: 1420 acc:0.7629 total_loss: 0.97658  loss:0.90974,stance loss: 0.69993 
Train step: 1430 acc:0.76379 total_loss: 0.96987  loss:1.4248,stance loss: 1.5949 
Train step: 1440 acc:0.76284 total_loss: 0.96464  loss:0.82326,stance loss: 0.68546 
Train step: 1450 acc:0.76442 total_loss: 0.95449  loss:0.85423,stance loss: 0.70716 
Train step: 1460 acc:0.7628 total_loss: 0.95922  loss:0.92225,stance loss: 0.7428 
Train step: 1470 acc:0.76243 total_loss: 0.96608  loss:1.2124,stance loss: 1.5604 
Train step: 1480 acc:0.76378 total_loss: 0.96076  loss:0.7379,stance loss: 0.53453 
Train step: 1490 acc:0.76371 total_loss: 0.96068  loss:0.93342,stance loss: 0.87871 
Train step: 1500 acc:0.76244 total_loss: 0.95662  loss:1.2141,stance loss: 1.0517 
Train step: 1510 acc:0.76128 total_loss: 0.9545  loss:0.51436,stance loss: 0.33477 
Train step: 1520 acc:0.76051 total_loss: 0.95457  loss:1.281,stance loss: 1.5777 
Train step: 1530 acc:0.76165 total_loss: 0.95211  loss:0.67617,stance loss: 0.54713 
Train step: 1540 acc:0.75915 total_loss: 0.95485  loss:0.97239,stance loss: 0.80625 
Train step: 1550 acc:0.75977 total_loss: 0.95169  loss:1.1762,stance loss: 1.4466 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.79464 total_loss: 0.98303  loss:1.503,stance loss: 1.1112 
Train step: 1570 acc:0.79044 total_loss: 0.85171  loss:0.97411,stance loss: 0.78354 
Train step: 1580 acc:0.78935 total_loss: 0.86373  loss:0.88939,stance loss: 0.75388 
Train step: 1590 acc:0.79899 total_loss: 0.83624  loss:0.6011,stance loss: 0.43418 
Train step: 1600 acc:0.79388 total_loss: 0.84803  loss:0.97338,stance loss: 0.82818 
Train step: 1610 acc:0.79276 total_loss: 0.83255  loss:0.85592,stance loss: 0.67226 
Train step: 1620 acc:0.80504 total_loss: 0.80713  loss:0.73796,stance loss: 0.47382 
Train step: 1630 acc:0.80357 total_loss: 0.8052  loss:0.79871,stance loss: 0.69045 
Train step: 1640 acc:0.80603 total_loss: 0.80803  loss:0.83483,stance loss: 0.71921 
Train step: 1650 acc:0.80155 total_loss: 0.81535  loss:0.85974,stance loss: 0.7715 
Train step: 1660 acc:0.80315 total_loss: 0.82154  loss:1.0924,stance loss: 0.84048 
Train step: 1670 acc:0.80449 total_loss: 0.81983  loss:0.8961,stance loss: 0.58577 
Train step: 1680 acc:0.80561 total_loss: 0.81335  loss:0.75402,stance loss: 0.56241 
Train step: 1690 acc:0.80155 total_loss: 0.824  loss:0.54333,stance loss: 0.30115 
Train step: 1700 acc:0.80357 total_loss: 0.81407  loss:1.4248,stance loss: 1.546 
Train step: 1710 acc:0.80175 total_loss: 0.81987  loss:1.0477,stance loss: 0.7788 
Train step: 1720 acc:0.79753 total_loss: 0.83246  loss:1.3102,stance loss: 1.1237 
Train step: 1730 acc:0.79626 total_loss: 0.83325  loss:1.0745,stance loss: 1.0027 
Train step: 1740 acc:0.79779 total_loss: 0.83083  loss:1.1003,stance loss: 0.84793 
Train step: 1750 acc:0.79632 total_loss: 0.83449  loss:0.7891,stance loss: 0.79568 
Train step: 1760 acc:0.7965 total_loss: 0.83406  loss:0.86588,stance loss: 0.77856 
Train step: 1770 acc:0.79752 total_loss: 0.83399  loss:0.62149,stance loss: 0.47442 
Train step: 1780 acc:0.79708 total_loss: 0.83304  loss:0.77778,stance loss: 0.5299 
Train step: 1790 acc:0.79641 total_loss: 0.83869  loss:0.98919,stance loss: 0.83749 
Train step: 1800 acc:0.79631 total_loss: 0.83987  loss:0.68328,stance loss: 0.56878 
Train step: 1810 acc:0.79864 total_loss: 0.83566  loss:1.1206,stance loss: 1.0505 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.83594 total_loss: 0.71732  loss:1.5738,stance loss: 1.6373 
Train step: 1830 acc:0.8125 total_loss: 0.76533  loss:0.42357,stance loss: 0.30607 
Train step: 1840 acc:0.82589 total_loss: 0.75384  loss:0.61115,stance loss: 0.50883 
Train step: 1850 acc:0.82401 total_loss: 0.78484  loss:1.0029,stance loss: 1.2301 
Train step: 1860 acc:0.82292 total_loss: 0.77318  loss:1.139,stance loss: 1.1556 
Train step: 1870 acc:0.82974 total_loss: 0.73324  loss:0.59688,stance loss: 0.51654 
Train step: 1880 acc:0.82996 total_loss: 0.73446  loss:0.63043,stance loss: 0.50234 
Train step: 1890 acc:0.83413 total_loss: 0.71943  loss:0.87986,stance loss: 0.62653 
Train step: 1900 acc:0.8402 total_loss: 0.7056  loss:1.0335,stance loss: 1.3141 
Train step: 1910 acc:0.83865 total_loss: 0.69681  loss:0.76188,stance loss: 0.64719 
Train step: 1920 acc:0.84201 total_loss: 0.6975  loss:0.33193,stance loss: 0.18588 
Train step: 1930 acc:0.8411 total_loss: 0.69958  loss:0.84137,stance loss: 0.59197 
Train step: 1940 acc:0.84033 total_loss: 0.697  loss:0.79948,stance loss: 0.6488 
Train step: 1950 acc:0.83922 total_loss: 0.69584  loss:0.48798,stance loss: 0.27868 
Train step: 1960 acc:0.83995 total_loss: 0.69331  loss:0.47153,stance loss: 0.32 
Train step: 1970 acc:0.83861 total_loss: 0.69777  loss:1.5565,stance loss: 1.3069 
Train step: 1980 acc:0.83891 total_loss: 0.69819  loss:0.6304,stance loss: 0.51402 
Train step: 1990 acc:0.83813 total_loss: 0.70596  loss:0.59232,stance loss: 0.43679 
Train step: 2000 acc:0.8391 total_loss: 0.70521  loss:0.58995,stance loss: 0.40309 
Train step: 2010 acc:0.84122 total_loss: 0.70457  loss:0.68264,stance loss: 0.52499 
Train step: 2020 acc:0.84225 total_loss: 0.69719  loss:0.4614,stance loss: 0.33239 
Train step: 2030 acc:0.84232 total_loss: 0.69604  loss:0.35396,stance loss: 0.23069 
Train step: 2040 acc:0.84073 total_loss: 0.69626  loss:0.9418,stance loss: 0.81228 
Train step: 2050 acc:0.84139 total_loss: 0.69664  loss:0.76887,stance loss: 0.58969 
Train step: 2060 acc:0.83972 total_loss: 0.70397  loss:1.5251,stance loss: 1.6596 
Train step: 2070 acc:0.84036 total_loss: 0.70276  loss:0.43709,stance loss: 0.42716 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.88194 total_loss: 0.64861  loss:0.96762,stance loss: 1.2759 
Train step: 2090 acc:0.88158 total_loss: 0.58095  loss:0.27208,stance loss: 0.14275 
Train step: 2100 acc:0.86853 total_loss: 0.5795  loss:0.37311,stance loss: 0.20129 
Train step: 2110 acc:0.85256 total_loss: 0.6481  loss:0.65624,stance loss: 0.57309 
Train step: 2120 acc:0.85332 total_loss: 0.63734  loss:0.73051,stance loss: 0.56527 
Train step: 2130 acc:0.85169 total_loss: 0.63662  loss:0.58795,stance loss: 0.4336 
Train step: 2140 acc:0.85417 total_loss: 0.64072  loss:1.0095,stance loss: 1.1654 
Train step: 2150 acc:0.86155 total_loss: 0.64494  loss:0.64468,stance loss: 0.57884 
Train step: 2160 acc:0.86657 total_loss: 0.63215  loss:0.66302,stance loss: 0.485 
Train step: 2170 acc:0.86364 total_loss: 0.63067  loss:0.48486,stance loss: 0.3162 
Train step: 2180 acc:0.86697 total_loss: 0.62205  loss:1.1882,stance loss: 1.1491 
Train step: 2190 acc:0.86607 total_loss: 0.6278  loss:1.0498,stance loss: 1.4785 
Train step: 2200 acc:0.86628 total_loss: 0.61959  loss:0.43211,stance loss: 0.36002 
Train step: 2210 acc:0.86826 total_loss: 0.60946  loss:0.44718,stance loss: 0.31027 
Train step: 2220 acc:0.86535 total_loss: 0.61391  loss:0.81469,stance loss: 0.70786 
Train step: 2230 acc:0.8636 total_loss: 0.6101  loss:0.70034,stance loss: 0.54882 
Train step: 2240 acc:0.86464 total_loss: 0.60195  loss:0.50805,stance loss: 0.44267 
Train step: 2250 acc:0.86592 total_loss: 0.60202  loss:0.42755,stance loss: 0.42647 
Train step: 2260 acc:0.86541 total_loss: 0.60337  loss:0.96812,stance loss: 0.79767 
Train step: 2270 acc:0.86558 total_loss: 0.60553  loss:0.38719,stance loss: 0.31878 
Train step: 2280 acc:0.86483 total_loss: 0.6113  loss:0.84968,stance loss: 0.61462 
Train step: 2290 acc:0.86473 total_loss: 0.61647  loss:0.8984,stance loss: 0.73606 
Train step: 2300 acc:0.86463 total_loss: 0.62196  loss:0.59155,stance loss: 0.43614 
Train step: 2310 acc:0.8648 total_loss: 0.62336  loss:1.0567,stance loss: 1.3898 
Train step: 2320 acc:0.86521 total_loss: 0.62282  loss:1.0432,stance loss: 1.4294 
Train step: 2330 acc:0.86415 total_loss: 0.62547  loss:1.7052,stance loss: 2.5602 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.86875 total_loss: 0.57685  loss:1.2278,stance loss: 1.2348 
Train step: 2350 acc:0.9 total_loss: 0.50934  loss:0.17081,stance loss: 0.073382 
Train step: 2360 acc:0.8875 total_loss: 0.53854  loss:0.63462,stance loss: 0.45388 
Train step: 2370 acc:0.89219 total_loss: 0.50764  loss:0.55998,stance loss: 0.45059 
Train step: 2380 acc:0.89125 total_loss: 0.5079  loss:0.36308,stance loss: 0.21585 
Train step: 2390 acc:0.89375 total_loss: 0.50383  loss:0.54723,stance loss: 0.45127 
Train step: 2400 acc:0.89196 total_loss: 0.51334  loss:0.52425,stance loss: 0.42444 
Train step: 2410 acc:0.88906 total_loss: 0.50244  loss:0.81643,stance loss: 0.51214 
Train step: 2420 acc:0.88611 total_loss: 0.5093  loss:0.83119,stance loss: 0.80818 
Train step: 2430 acc:0.88625 total_loss: 0.49966  loss:0.43725,stance loss: 0.30591 
Train step: 2440 acc:0.88523 total_loss: 0.51324  loss:0.35142,stance loss: 0.31995 
Train step: 2450 acc:0.88542 total_loss: 0.51482  loss:0.38465,stance loss: 0.31648 
Train step: 2460 acc:0.8875 total_loss: 0.51088  loss:0.62381,stance loss: 0.55225 
Train step: 2470 acc:0.88884 total_loss: 0.51692  loss:0.63513,stance loss: 0.69836 
Train step: 2480 acc:0.88875 total_loss: 0.51776  loss:0.21872,stance loss: 0.14461 
Train step: 2490 acc:0.88789 total_loss: 0.52395  loss:0.43342,stance loss: 0.43727 
Train step: 2500 acc:0.88787 total_loss: 0.52342  loss:0.63573,stance loss: 1.0654 
Train step: 2510 acc:0.88993 total_loss: 0.51247  loss:0.21944,stance loss: 0.087475 
Train step: 2520 acc:0.88914 total_loss: 0.51447  loss:0.50944,stance loss: 0.39562 
Train step: 2530 acc:0.88844 total_loss: 0.51499  loss:0.32862,stance loss: 0.2827 
Train step: 2540 acc:0.8875 total_loss: 0.5194  loss:0.41522,stance loss: 0.35393 
Train step: 2550 acc:0.88807 total_loss: 0.52444  loss:0.92073,stance loss: 0.93958 
Train step: 2560 acc:0.88859 total_loss: 0.52546  loss:0.7189,stance loss: 1.142 
Train step: 2570 acc:0.88984 total_loss: 0.51704  loss:0.30347,stance loss: 0.16863 
Train step: 2580 acc:0.8915 total_loss: 0.51458  loss:0.78502,stance loss: 0.6046 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.9375 total_loss: 0.20683  loss:0.20683,stance loss: 0.0029355 
Train step: 2600 acc:0.90909 total_loss: 0.49502  loss:0.88811,stance loss: 1.1619 
Train step: 2610 acc:0.91071 total_loss: 0.45156  loss:0.37519,stance loss: 0.32063 
Train step: 2620 acc:0.90524 total_loss: 0.45711  loss:0.49348,stance loss: 0.36601 
Train step: 2630 acc:0.90854 total_loss: 0.47407  loss:0.31715,stance loss: 0.19777 
Train step: 2640 acc:0.91054 total_loss: 0.46857  loss:0.56427,stance loss: 0.49889 
Train step: 2650 acc:0.91496 total_loss: 0.46632  loss:0.58918,stance loss: 0.35004 
Train step: 2660 acc:0.91109 total_loss: 0.47033  loss:0.31134,stance loss: 0.21694 
Train step: 2670 acc:0.91435 total_loss: 0.47327  loss:0.93208,stance loss: 1.194 
Train step: 2680 acc:0.91209 total_loss: 0.4735  loss:0.31868,stance loss: 0.22148 
Train step: 2690 acc:0.9146 total_loss: 0.45633  loss:0.1298,stance loss: 0.036874 
Train step: 2700 acc:0.91273 total_loss: 0.46076  loss:0.47448,stance loss: 0.27779 
Train step: 2710 acc:0.91219 total_loss: 0.45551  loss:0.32637,stance loss: 0.25706 
Train step: 2720 acc:0.91078 total_loss: 0.45919  loss:0.78523,stance loss: 0.5034 
Train step: 2730 acc:0.9109 total_loss: 0.45599  loss:0.58259,stance loss: 0.42896 
Train step: 2740 acc:0.91018 total_loss: 0.45788  loss:0.93577,stance loss: 0.6363 
Train step: 2750 acc:0.9111 total_loss: 0.46071  loss:0.6082,stance loss: 0.57803 
Train step: 2760 acc:0.91338 total_loss: 0.45347  loss:0.21129,stance loss: 0.1403 
Train step: 2770 acc:0.91229 total_loss: 0.45355  loss:0.66773,stance loss: 0.65828 
Train step: 2780 acc:0.91198 total_loss: 0.45041  loss:0.2493,stance loss: 0.16374 
Train step: 2790 acc:0.912 total_loss: 0.4464  loss:0.19962,stance loss: 0.064157 
Train step: 2800 acc:0.91291 total_loss: 0.44252  loss:0.51555,stance loss: 0.4451 
Train step: 2810 acc:0.91346 total_loss: 0.44148  loss:0.63137,stance loss: 1.0389 
Train step: 2820 acc:0.91423 total_loss: 0.43775  loss:0.72723,stance loss: 0.57767 
Train step: 2830 acc:0.91572 total_loss: 0.43375  loss:0.33356,stance loss: 0.28881 
Train step: 2840 acc:0.91584 total_loss: 0.43238  loss:0.6168,stance loss: 1.0338 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.9375 total_loss: 0.47326  loss:0.28079,stance loss: 0.24244 
Train step: 2860 acc:0.93229 total_loss: 0.38125  loss:0.09308,stance loss: 0.030731 
Train step: 2870 acc:0.92614 total_loss: 0.37698  loss:0.49748,stance loss: 0.37793 
Train step: 2880 acc:0.93359 total_loss: 0.36554  loss:0.32427,stance loss: 0.21289 
Train step: 2890 acc:0.93601 total_loss: 0.36  loss:0.14946,stance loss: 0.094431 
Train step: 2900 acc:0.94111 total_loss: 0.33414  loss:0.14331,stance loss: 0.068169 
Train step: 2910 acc:0.94153 total_loss: 0.33877  loss:0.76,stance loss: 1.0733 
Train step: 2920 acc:0.94358 total_loss: 0.35722  loss:0.20733,stance loss: 0.16071 
Train step: 2930 acc:0.94055 total_loss: 0.36266  loss:0.49561,stance loss: 0.48606 
Train step: 2940 acc:0.94497 total_loss: 0.34807  loss:0.18073,stance loss: 0.14796 
Train step: 2950 acc:0.9473 total_loss: 0.35112  loss:0.11363,stance loss: 0.07251 
Train step: 2960 acc:0.94475 total_loss: 0.36319  loss:0.51189,stance loss: 0.38261 
Train step: 2970 acc:0.94262 total_loss: 0.36387  loss:0.51227,stance loss: 0.47917 
Train step: 2980 acc:0.94366 total_loss: 0.35642  loss:0.32087,stance loss: 0.25711 
Train step: 2990 acc:0.94454 total_loss: 0.34647  loss:0.11807,stance loss: 0.059227 
Train step: 3000 acc:0.94408 total_loss: 0.35033  loss:0.74208,stance loss: 0.78636 
Train step: 3010 acc:0.94329 total_loss: 0.35724  loss:0.35384,stance loss: 0.22264 
Train step: 3020 acc:0.94113 total_loss: 0.36631  loss:0.11936,stance loss: 0.06814 
Train step: 3030 acc:0.94128 total_loss: 0.35922  loss:0.14555,stance loss: 0.090773 
Train step: 3040 acc:0.94043 total_loss: 0.35796  loss:0.18086,stance loss: 0.10268 
Train step: 3050 acc:0.93936 total_loss: 0.35938  loss:0.54361,stance loss: 0.45186 
Train step: 3060 acc:0.94045 total_loss: 0.35517  loss:0.26773,stance loss: 0.25987 
Train step: 3070 acc:0.93975 total_loss: 0.35557  loss:0.58155,stance loss: 1.0154 
Train step: 3080 acc:0.94019 total_loss: 0.3513  loss:0.17904,stance loss: 0.11206 
Train step: 3090 acc:0.93905 total_loss: 0.35606  loss:0.68869,stance loss: 1.1504 
Train step: 3100 acc:0.93874 total_loss: 0.35596  loss:0.43257,stance loss: 0.42136 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.9375 total_loss: 0.31991  loss:0.15606,stance loss: 0.081582 
Train step: 3120 acc:0.91346 total_loss: 0.39244  loss:0.82759,stance loss: 1.1456 
Train step: 3130 acc:0.9375 total_loss: 0.29629  loss:0.45423,stance loss: 0.35069 
Train step: 3140 acc:0.94318 total_loss: 0.26744  loss:0.10601,stance loss: 0.024287 
Train step: 3150 acc:0.94186 total_loss: 0.27955  loss:0.10562,stance loss: 0.015787 
Train step: 3160 acc:0.93868 total_loss: 0.27699  loss:0.34771,stance loss: 0.3331 
Train step: 3170 acc:0.93552 total_loss: 0.31453  loss:0.59682,stance loss: 0.5791 
Train step: 3180 acc:0.94007 total_loss: 0.30687  loss:0.42725,stance loss: 0.2897 
Train step: 3190 acc:0.94428 total_loss: 0.29895  loss:0.21587,stance loss: 0.22261 
Train step: 3200 acc:0.94624 total_loss: 0.28906  loss:0.28021,stance loss: 0.16949 
Train step: 3210 acc:0.94782 total_loss: 0.28547  loss:0.31377,stance loss: 0.33994 
Train step: 3220 acc:0.94801 total_loss: 0.27811  loss:0.10589,stance loss: 0.013529 
Train step: 3230 acc:0.94715 total_loss: 0.28369  loss:0.63984,stance loss: 0.5157 
Train step: 3240 acc:0.94784 total_loss: 0.28936  loss:0.65306,stance loss: 1.0681 
Train step: 3250 acc:0.94799 total_loss: 0.28809  loss:0.16008,stance loss: 0.12052 
Train step: 3260 acc:0.9473 total_loss: 0.29337  loss:0.88066,stance loss: 1.0914 
Train step: 3270 acc:0.94862 total_loss: 0.28649  loss:0.11622,stance loss: 0.068761 
Train step: 3280 acc:0.9487 total_loss: 0.28301  loss:0.43982,stance loss: 0.37656 
Train step: 3290 acc:0.9474 total_loss: 0.28943  loss:0.40353,stance loss: 0.41826 
Train step: 3300 acc:0.94819 total_loss: 0.28676  loss:0.37424,stance loss: 0.33542 
Train step: 3310 acc:0.94643 total_loss: 0.29561  loss:0.10553,stance loss: 0.026736 
Train step: 3320 acc:0.94572 total_loss: 0.29416  loss:0.24924,stance loss: 0.1221 
Train step: 3330 acc:0.94675 total_loss: 0.29012  loss:0.098402,stance loss: 0.055814 
Train step: 3340 acc:0.94635 total_loss: 0.29373  loss:0.86913,stance loss: 1.3581 
Train step: 3350 acc:0.94727 total_loss: 0.28873  loss:0.040216,stance loss: 0.0077419 
Train step: 3360 acc:0.94837 total_loss: 0.28641  loss:0.10334,stance loss: 0.046618 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.95312 total_loss: 0.29733  loss:0.4314,stance loss: 0.35267 
Train step: 3380 acc:0.94196 total_loss: 0.36306  loss:0.73845,stance loss: 1.1568 
Train step: 3390 acc:0.95312 total_loss: 0.30921  loss:0.19502,stance loss: 0.19071 
Train step: 3400 acc:0.95037 total_loss: 0.30068  loss:0.34123,stance loss: 0.36782 
Train step: 3410 acc:0.94744 total_loss: 0.30729  loss:0.076892,stance loss: 0.016654 
Train step: 3420 acc:0.94907 total_loss: 0.30602  loss:0.62964,stance loss: 0.66902 
Train step: 3430 acc:0.95117 total_loss: 0.29556  loss:0.10638,stance loss: 0.064105 
Train step: 3440 acc:0.95524 total_loss: 0.27683  loss:0.056981,stance loss: 0.017736 
Train step: 3450 acc:0.95982 total_loss: 0.25638  loss:0.12261,stance loss: 0.041973 
Train step: 3460 acc:0.96077 total_loss: 0.25822  loss:0.046818,stance loss: 0.0046172 
Train step: 3470 acc:0.96154 total_loss: 0.25063  loss:0.038437,stance loss: 0.0052299 
Train step: 3480 acc:0.96217 total_loss: 0.24056  loss:0.12645,stance loss: 0.1119 
Train step: 3490 acc:0.95817 total_loss: 0.25089  loss:0.45409,stance loss: 0.45002 
Train step: 3500 acc:0.95942 total_loss: 0.24884  loss:0.071302,stance loss: 0.0168 
Train step: 3510 acc:0.95877 total_loss: 0.2505  loss:0.18755,stance loss: 0.13716 
Train step: 3520 acc:0.95901 total_loss: 0.25034  loss:0.33078,stance loss: 0.32627 
Train step: 3530 acc:0.9577 total_loss: 0.25383  loss:0.2695,stance loss: 0.31636 
Train step: 3540 acc:0.9569 total_loss: 0.25714  loss:0.054068,stance loss: 0.016947 
Train step: 3550 acc:0.95686 total_loss: 0.25702  loss:0.11814,stance loss: 0.062906 
Train step: 3560 acc:0.95812 total_loss: 0.25662  loss:0.68431,stance loss: 0.65797 
Train step: 3570 acc:0.95741 total_loss: 0.26239  loss:0.073889,stance loss: 0.024237 
Train step: 3580 acc:0.95707 total_loss: 0.25932  loss:0.12314,stance loss: 0.041465 
Train step: 3590 acc:0.95815 total_loss: 0.25832  loss:0.082641,stance loss: 0.029607 
Train step: 3600 acc:0.95726 total_loss: 0.26073  loss:0.068403,stance loss: 0.010853 
Train step: 3610 acc:0.95697 total_loss: 0.2636  loss:0.65729,stance loss: 0.59501 
Train step: 3620 acc:0.95719 total_loss: 0.26139  loss:0.31903,stance loss: 0.30462 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9875 total_loss: 0.087052  loss:0.0535,stance loss: 0.0075427 
Train step: 3640 acc:0.96667 total_loss: 0.20393  loss:0.065622,stance loss: 0.03213 
Train step: 3650 acc:0.975 total_loss: 0.16887  loss:0.033258,stance loss: 0.0066731 
Train step: 3660 acc:0.97143 total_loss: 0.20661  loss:0.078202,stance loss: 0.050215 
Train step: 3670 acc:0.96944 total_loss: 0.21325  loss:0.29815,stance loss: 0.22356 
Train step: 3680 acc:0.96932 total_loss: 0.21863  loss:0.13433,stance loss: 0.015061 
Train step: 3690 acc:0.96731 total_loss: 0.221  loss:0.067139,stance loss: 0.019014 
Train step: 3700 acc:0.9675 total_loss: 0.23022  loss:0.04928,stance loss: 0.0115 
Train step: 3710 acc:0.96912 total_loss: 0.22011  loss:0.3986,stance loss: 0.48944 
Train step: 3720 acc:0.96842 total_loss: 0.22344  loss:0.20485,stance loss: 0.070576 
Train step: 3730 acc:0.97024 total_loss: 0.21483  loss:0.77781,stance loss: 1.2089 
Train step: 3740 acc:0.97174 total_loss: 0.22195  loss:0.58261,stance loss: 1.0252 
Train step: 3750 acc:0.9705 total_loss: 0.22548  loss:0.035769,stance loss: 0.0075245 
Train step: 3760 acc:0.96944 total_loss: 0.22934  loss:0.25002,stance loss: 0.18504 
Train step: 3770 acc:0.97026 total_loss: 0.22311  loss:0.033889,stance loss: 0.0024304 
Train step: 3780 acc:0.96976 total_loss: 0.2203  loss:0.030266,stance loss: 0.0042243 
Train step: 3790 acc:0.96818 total_loss: 0.21958  loss:0.1119,stance loss: 0.069952 
Train step: 3800 acc:0.96821 total_loss: 0.22151  loss:0.24377,stance loss: 0.21 
Train step: 3810 acc:0.96892 total_loss: 0.22333  loss:0.10185,stance loss: 0.041991 
Train step: 3820 acc:0.96891 total_loss: 0.22334  loss:0.097019,stance loss: 0.063538 
Train step: 3830 acc:0.9689 total_loss: 0.21933  loss:0.046866,stance loss: 0.016068 
Train step: 3840 acc:0.96977 total_loss: 0.21913  loss:0.53333,stance loss: 1.0111 
Train step: 3850 acc:0.96972 total_loss: 0.21805  loss:0.033571,stance loss: 0.0031586 
Train step: 3860 acc:0.96835 total_loss: 0.222  loss:0.44632,stance loss: 0.32934 
Train step: 3870 acc:0.96837 total_loss: 0.22002  loss:0.43547,stance loss: 0.36153 
Train step: 3880 acc:0.96887 total_loss: 0.21707  loss:0.30486,stance loss: 0.21119 
Training finished.


Reload the best model with best f1 0.45522327469553453 from path test_outputs/bert-cross-topic/a/2023-08-14 14-20-23/state_dict


              precision    recall  f1-score   support

           0   0.712727  0.422414  0.530447       464
           1   0.404255  0.786207  0.533958       145
           2   0.323864  0.459677  0.380000       124

    accuracy                       0.500682       733
   macro avg   0.480282  0.556099  0.481468       733
weighted avg   0.585923  0.500682  0.505690       733

Test Acc: 0.5006821282401092 F1_ma:0.45522327469553453
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.45522327469553453
acc: 0.5006821282401092, f1 :0.48146813160810814
classification report: 
              precision    recall  f1-score   support

         Con     0.7127    0.4224    0.5304       464
        None     0.4043    0.7862    0.5340       145
         Pro     0.3239    0.4597    0.3800       124

    accuracy                         0.5007       733
   macro avg     0.4803    0.5561    0.4815       733
weighted avg     0.5859    0.5007    0.5057       733

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 14-40-07', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 14-40-07
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.6506  loss:1.6506,stance loss: 1.1945 
Train step: 10 acc:0.46591 total_loss: 1.8053  loss:1.7225,stance loss: 1.3765 
Better F1! Saving model!
Saving model of best f1: 0.38341013824884795
              precision    recall  f1-score   support

           0   0.669887  0.896552  0.766820       464
           1   0.531532  0.406897  0.460938       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.648022       733
   macro avg   0.400473  0.434483  0.409253       733
weighted avg   0.529195  0.648022  0.576590       733

Test Acc: 0.6480218281036835 F1_ma:0.38341013824884795
Train step: 20 acc:0.50298 total_loss: 1.6912  loss:1.3734,stance loss: 0.99006 
Better F1! Saving model!
Saving model of best f1: 0.38735529830810334
              precision    recall  f1-score   support

           0   0.660091  0.937500  0.774711       464
           1   0.540541  0.275862  0.365297       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.648022       733
   macro avg   0.400211  0.404454  0.380002       733
weighted avg   0.524776  0.648022  0.562665       733

Test Acc: 0.6480218281036835 F1_ma:0.38735529830810334
Train step: 30 acc:0.51815 total_loss: 1.6429  loss:1.1266,stance loss: 0.47795 
Train step: 40 acc:0.5061 total_loss: 1.628  loss:1.4647,stance loss: 1.0171 
Train step: 50 acc:0.5049 total_loss: 1.6068  loss:1.443,stance loss: 1.028 
Train step: 60 acc:0.49795 total_loss: 1.6151  loss:1.9235,stance loss: 1.7117 
Train step: 70 acc:0.50264 total_loss: 1.6117  loss:1.2234,stance loss: 0.71554 
Train step: 80 acc:0.50309 total_loss: 1.6038  loss:1.5717,stance loss: 1.1106 
Better F1! Saving model!
Saving model of best f1: 0.3874788494077835
              precision    recall  f1-score   support

           0   0.637883  0.987069  0.774958       464
           1   0.533333  0.055172  0.100000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.635744       733
   macro avg   0.390405  0.347414  0.291653       733
weighted avg   0.509292  0.635744  0.510342       733

Test Acc: 0.635743519781719 F1_ma:0.3874788494077835
Train step: 90 acc:0.5 total_loss: 1.599  loss:1.6845,stance loss: 1.4379 
Train step: 100 acc:0.50681 total_loss: 1.5877  loss:1.3701,stance loss: 0.98617 
Better F1! Saving model!
Saving model of best f1: 0.3887489504617968
              precision    recall  f1-score   support

           0   0.636864  0.997845  0.777498       464
           1   0.833333  0.034483  0.066225       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.638472       733
   macro avg   0.490066  0.344109  0.281241       733
weighted avg   0.567992  0.638472  0.505268       733

Test Acc: 0.6384720327421555 F1_ma:0.3887489504617968
Train step: 110 acc:0.5045 total_loss: 1.5834  loss:1.5557,stance loss: 1.0505 
Train step: 120 acc:0.50517 total_loss: 1.5708  loss:1.4966,stance loss: 0.98911 
Train step: 130 acc:0.50954 total_loss: 1.5664  loss:1.1671,stance loss: 0.74818 
Train step: 140 acc:0.51197 total_loss: 1.5612  loss:1.5355,stance loss: 1.1983 
Train step: 150 acc:0.51076 total_loss: 1.559  loss:1.4449,stance loss: 1.0696 
Train step: 160 acc:0.51165 total_loss: 1.5558  loss:1.5157,stance loss: 1.0007 
Train step: 170 acc:0.51425 total_loss: 1.5517  loss:1.2504,stance loss: 0.89435 
Train step: 180 acc:0.51796 total_loss: 1.5533  loss:1.3522,stance loss: 0.89863 
Train step: 190 acc:0.52094 total_loss: 1.5442  loss:1.5883,stance loss: 1.0548 
Train step: 200 acc:0.5255 total_loss: 1.5356  loss:1.6215,stance loss: 1.3641 
Train step: 210 acc:0.52725 total_loss: 1.5328  loss:1.5558,stance loss: 1.5032 
Train step: 220 acc:0.52969 total_loss: 1.5263  loss:1.39,stance loss: 1.0631 
Train step: 230 acc:0.53057 total_loss: 1.5241  loss:1.6725,stance loss: 1.2624 
Train step: 240 acc:0.5306 total_loss: 1.5222  loss:1.617,stance loss: 1.3907 
Train step: 250 acc:0.53436 total_loss: 1.5146  loss:1.308,stance loss: 0.87931 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.75 total_loss: 1.1738  loss:1.1754,stance loss: 0.8349 
Train step: 270 acc:0.61458 total_loss: 1.3916  loss:1.9019,stance loss: 1.4178 
Train step: 280 acc:0.61932 total_loss: 1.3918  loss:1.4105,stance loss: 1.0889 
Train step: 290 acc:0.60156 total_loss: 1.4066  loss:1.243,stance loss: 0.74139 
Train step: 300 acc:0.59375 total_loss: 1.4089  loss:1.3813,stance loss: 0.96831 
Train step: 310 acc:0.59615 total_loss: 1.4156  loss:1.8562,stance loss: 1.8452 
Train step: 320 acc:0.58468 total_loss: 1.4124  loss:1.3162,stance loss: 0.88124 
Train step: 330 acc:0.58507 total_loss: 1.4135  loss:1.3614,stance loss: 0.8447 
Train step: 340 acc:0.58841 total_loss: 1.4117  loss:1.1186,stance loss: 0.61283 
Train step: 350 acc:0.58832 total_loss: 1.4103  loss:1.2621,stance loss: 0.89036 
Train step: 360 acc:0.59191 total_loss: 1.3954  loss:1.4756,stance loss: 1.1337 
Train step: 370 acc:0.59598 total_loss: 1.3844  loss:0.9994,stance loss: 0.51676 
Train step: 380 acc:0.59887 total_loss: 1.3804  loss:1.3359,stance loss: 0.9774 
Train step: 390 acc:0.60227 total_loss: 1.3778  loss:1.139,stance loss: 0.87709 
Train step: 400 acc:0.60695 total_loss: 1.3703  loss:1.2418,stance loss: 0.90459 
Train step: 410 acc:0.61143 total_loss: 1.3638  loss:1.0772,stance loss: 0.76797 
Train step: 420 acc:0.61883 total_loss: 1.3594  loss:1.9553,stance loss: 1.5405 
Train step: 430 acc:0.61846 total_loss: 1.3523  loss:1.0494,stance loss: 0.84829 
Train step: 440 acc:0.62054 total_loss: 1.3476  loss:1.1694,stance loss: 0.89543 
Train step: 450 acc:0.6224 total_loss: 1.3476  loss:1.162,stance loss: 0.84361 
Train step: 460 acc:0.625 total_loss: 1.3479  loss:1.3652,stance loss: 1.1469 
Train step: 470 acc:0.62647 total_loss: 1.3461  loss:1.1449,stance loss: 0.94595 
Train step: 480 acc:0.62838 total_loss: 1.3451  loss:1.24,stance loss: 1.0249 
Train step: 490 acc:0.62931 total_loss: 1.3468  loss:1.4519,stance loss: 1.6034 
Train step: 500 acc:0.62939 total_loss: 1.3457  loss:1.6067,stance loss: 1.2613 
Train step: 510 acc:0.6317 total_loss: 1.3393  loss:0.9966,stance loss: 0.69021 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.75 total_loss: 1.1106  loss:0.97327,stance loss: 0.57489 
Train step: 530 acc:0.66827 total_loss: 1.2234  loss:1.4383,stance loss: 1.0788 
Train step: 540 acc:0.6875 total_loss: 1.2275  loss:1.1416,stance loss: 0.81144 
Train step: 550 acc:0.68561 total_loss: 1.2027  loss:1.0833,stance loss: 0.82263 
Train step: 560 acc:0.67297 total_loss: 1.2087  loss:1.4944,stance loss: 1.045 
Train step: 570 acc:0.66863 total_loss: 1.2124  loss:1.6853,stance loss: 1.2346 
Train step: 580 acc:0.67063 total_loss: 1.2179  loss:1.1962,stance loss: 0.85466 
Train step: 590 acc:0.66438 total_loss: 1.2199  loss:1.0434,stance loss: 0.71898 
Train step: 600 acc:0.66114 total_loss: 1.2165  loss:1.4315,stance loss: 1.1819 
Train step: 610 acc:0.66532 total_loss: 1.2088  loss:1.3931,stance loss: 1.5431 
Train step: 620 acc:0.65959 total_loss: 1.2149  loss:1.2596,stance loss: 0.85449 
Train step: 630 acc:0.66704 total_loss: 1.2056  loss:1.2669,stance loss: 0.99482 
Train step: 640 acc:0.66972 total_loss: 1.2035  loss:0.98267,stance loss: 0.64688 
Train step: 650 acc:0.67199 total_loss: 1.2101  loss:1.0966,stance loss: 0.87888 
Train step: 660 acc:0.67133 total_loss: 1.2094  loss:0.9411,stance loss: 0.70135 
Train step: 670 acc:0.67075 total_loss: 1.2135  loss:0.88192,stance loss: 0.58562 
Train step: 680 acc:0.6691 total_loss: 1.2174  loss:1.047,stance loss: 0.76586 
Train step: 690 acc:0.6698 total_loss: 1.2144  loss:0.8624,stance loss: 0.6524 
Train step: 700 acc:0.6735 total_loss: 1.2115  loss:0.90888,stance loss: 0.64748 
Train step: 710 acc:0.66969 total_loss: 1.2175  loss:1.5592,stance loss: 1.2578 
Train step: 720 acc:0.66718 total_loss: 1.2232  loss:1.0771,stance loss: 0.8925 
Train step: 730 acc:0.66491 total_loss: 1.2264  loss:1.184,stance loss: 0.89787 
Train step: 740 acc:0.662 total_loss: 1.2292  loss:1.1939,stance loss: 0.8477 
Better F1! Saving model!
Saving model of best f1: 0.43466377440347076
              precision    recall  f1-score   support

           0   0.713974  0.704741  0.709328       464
           1   0.473214  0.731034  0.574526       145
           2   0.274510  0.112903  0.160000       124

    accuracy                       0.609823       733
   macro avg   0.487233  0.516226  0.481284       733
weighted avg   0.592004  0.609823  0.589733       733

Test Acc: 0.6098226466575716 F1_ma:0.43466377440347076
Train step: 750 acc:0.6647 total_loss: 1.2276  loss:1.0041,stance loss: 0.85592 
Train step: 760 acc:0.66178 total_loss: 1.2276  loss:1.3116,stance loss: 0.96688 
Train step: 770 acc:0.66329 total_loss: 1.2217  loss:1.0756,stance loss: 0.90257 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.71875 total_loss: 1.0395  loss:0.92808,stance loss: 0.6123 
Train step: 790 acc:0.70982 total_loss: 1.1102  loss:1.0015,stance loss: 0.75938 
Train step: 800 acc:0.6901 total_loss: 1.1725  loss:1.351,stance loss: 1.4851 
Train step: 810 acc:0.69669 total_loss: 1.1506  loss:1.1042,stance loss: 0.87122 
Train step: 820 acc:0.69602 total_loss: 1.1437  loss:1.102,stance loss: 0.97251 
Train step: 830 acc:0.68981 total_loss: 1.1533  loss:0.92276,stance loss: 0.80549 
Train step: 840 acc:0.6875 total_loss: 1.1396  loss:1.2785,stance loss: 1.0582 
Train step: 850 acc:0.68581 total_loss: 1.1475  loss:0.93417,stance loss: 0.72093 
Train step: 860 acc:0.68973 total_loss: 1.148  loss:0.97721,stance loss: 0.71068 
Train step: 870 acc:0.68883 total_loss: 1.1357  loss:1.3706,stance loss: 1.2058 
Train step: 880 acc:0.6893 total_loss: 1.137  loss:1.0335,stance loss: 0.74447 
Train step: 890 acc:0.68969 total_loss: 1.137  loss:1.1918,stance loss: 0.85376 
Train step: 900 acc:0.68851 total_loss: 1.1314  loss:0.96857,stance loss: 0.6658 
Train step: 910 acc:0.68983 total_loss: 1.1308  loss:1.4428,stance loss: 0.99178 
Train step: 920 acc:0.68924 total_loss: 1.1358  loss:1.1765,stance loss: 0.95747 
Train step: 930 acc:0.68872 total_loss: 1.1311  loss:1.059,stance loss: 0.68911 
Train step: 940 acc:0.69245 total_loss: 1.1283  loss:1.0584,stance loss: 0.90281 
Train step: 950 acc:0.69432 total_loss: 1.1291  loss:1.2621,stance loss: 1.4162 
Train step: 960 acc:0.69361 total_loss: 1.1338  loss:1.0531,stance loss: 0.91649 
Train step: 970 acc:0.69845 total_loss: 1.1336  loss:0.92659,stance loss: 0.82936 
Train step: 980 acc:0.70006 total_loss: 1.1318  loss:1.5563,stance loss: 1.7745 
Train step: 990 acc:0.6986 total_loss: 1.1435  loss:1.062,stance loss: 0.86176 
Train step: 1000 acc:0.69838 total_loss: 1.1426  loss:1.4201,stance loss: 1.6934 
Train step: 1010 acc:0.69685 total_loss: 1.1437  loss:1.1386,stance loss: 0.8663 
Train step: 1020 acc:0.69493 total_loss: 1.1435  loss:1.1499,stance loss: 0.78899 
Train step: 1030 acc:0.69439 total_loss: 1.144  loss:0.86743,stance loss: 0.76545 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.6875 total_loss: 1.2219  loss:1.163,stance loss: 0.87885 
Train step: 1050 acc:0.69583 total_loss: 1.1273  loss:0.99964,stance loss: 0.81457 
Train step: 1060 acc:0.72 total_loss: 1.0903  loss:0.82928,stance loss: 0.70462 
Train step: 1070 acc:0.71429 total_loss: 1.0865  loss:0.89847,stance loss: 0.6837 
Train step: 1080 acc:0.72083 total_loss: 1.097  loss:1.2278,stance loss: 1.4481 
Train step: 1090 acc:0.72955 total_loss: 1.0834  loss:1.1359,stance loss: 0.92944 
Train step: 1100 acc:0.71827 total_loss: 1.0935  loss:1.2525,stance loss: 0.91647 
Train step: 1110 acc:0.715 total_loss: 1.1023  loss:1.2616,stance loss: 0.91948 
Train step: 1120 acc:0.72353 total_loss: 1.083  loss:0.99032,stance loss: 0.77067 
Train step: 1130 acc:0.71645 total_loss: 1.1001  loss:1.005,stance loss: 0.79315 
Train step: 1140 acc:0.71369 total_loss: 1.1018  loss:1.506,stance loss: 1.7131 
Train step: 1150 acc:0.70978 total_loss: 1.1068  loss:1.8729,stance loss: 1.9157 
Train step: 1160 acc:0.7095 total_loss: 1.0981  loss:0.68141,stance loss: 0.47669 
Train step: 1170 acc:0.71157 total_loss: 1.09  loss:0.84979,stance loss: 0.7529 
Train step: 1180 acc:0.71121 total_loss: 1.082  loss:1.422,stance loss: 1.1282 
Train step: 1190 acc:0.7121 total_loss: 1.0808  loss:0.7483,stance loss: 0.574 
Train step: 1200 acc:0.71098 total_loss: 1.0775  loss:0.91858,stance loss: 0.6691 
Train step: 1210 acc:0.70929 total_loss: 1.0846  loss:1.1618,stance loss: 0.89839 
Train step: 1220 acc:0.71216 total_loss: 1.084  loss:0.99613,stance loss: 0.67091 
Train step: 1230 acc:0.71282 total_loss: 1.08  loss:0.89915,stance loss: 0.80669 
Train step: 1240 acc:0.7128 total_loss: 1.0779  loss:1.2072,stance loss: 0.87257 
Train step: 1250 acc:0.71395 total_loss: 1.0755  loss:1.0454,stance loss: 0.8703 
Train step: 1260 acc:0.71028 total_loss: 1.0804  loss:1.3174,stance loss: 1.0271 
Train step: 1270 acc:0.71064 total_loss: 1.0824  loss:1.0898,stance loss: 0.78401 
Train step: 1280 acc:0.71071 total_loss: 1.0819  loss:0.91564,stance loss: 0.80117 
Train step: 1290 acc:0.7098 total_loss: 1.0795  loss:0.63492,stance loss: 0.31013 
Better F1! Saving model!
Saving model of best f1: 0.4437148217636022
              precision    recall  f1-score   support

           0   0.728571  0.659483  0.692308       464
           1   0.432234  0.813793  0.564593       145
           2   0.400000  0.129032  0.195122       124

    accuracy                       0.600273       733
   macro avg   0.520269  0.534103  0.484008       733
weighted avg   0.614367  0.600273  0.582936       733

Test Acc: 0.6002728512960437 F1_ma:0.4437148217636022
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.65625 total_loss: 1.2646  loss:0.96429,stance loss: 0.81545 
Better F1! Saving model!
Saving model of best f1: 0.4794553272814142
              precision    recall  f1-score   support

           0   0.711155  0.769397  0.739130       464
           1   0.502890  0.600000  0.547170       145
           2   0.344828  0.161290  0.219780       124

    accuracy                       0.633015       733
   macro avg   0.519624  0.510229  0.502027       733
weighted avg   0.607986  0.633015  0.613300       733

Test Acc: 0.6330150068212824 F1_ma:0.4794553272814142
Train step: 1310 acc:0.67188 total_loss: 1.1906  loss:1.2006,stance loss: 1.4462 
Train step: 1320 acc:0.69952 total_loss: 1.0731  loss:1.1707,stance loss: 1.0489 
Train step: 1330 acc:0.71354 total_loss: 1.0336  loss:0.73435,stance loss: 0.38443 
Train step: 1340 acc:0.71603 total_loss: 1.0323  loss:1.0493,stance loss: 0.87321 
Train step: 1350 acc:0.72545 total_loss: 1.0175  loss:0.84056,stance loss: 0.61128 
Train step: 1360 acc:0.72538 total_loss: 1.0241  loss:0.95791,stance loss: 0.85982 
Train step: 1370 acc:0.73109 total_loss: 1.013  loss:1.2874,stance loss: 1.1636 
Train step: 1380 acc:0.73183 total_loss: 1.0263  loss:1.1083,stance loss: 0.86271 
Train step: 1390 acc:0.73242 total_loss: 1.0145  loss:0.98769,stance loss: 0.86723 
Train step: 1400 acc:0.73644 total_loss: 1.0106  loss:0.8685,stance loss: 0.72956 
Train step: 1410 acc:0.74084 total_loss: 0.99699  loss:0.78985,stance loss: 0.52226 
Train step: 1420 acc:0.7376 total_loss: 1.0018  loss:1.0168,stance loss: 0.68764 
Train step: 1430 acc:0.74173 total_loss: 0.99661  loss:1.1908,stance loss: 1.458 
Train step: 1440 acc:0.74187 total_loss: 0.99418  loss:0.59151,stance loss: 0.45834 
Train step: 1450 acc:0.74239 total_loss: 1.0043  loss:1.2314,stance loss: 0.90136 
Train step: 1460 acc:0.73795 total_loss: 1.0049  loss:1.1217,stance loss: 0.87669 
Train step: 1470 acc:0.73544 total_loss: 1.0045  loss:0.95068,stance loss: 0.794 
Better F1! Saving model!
Saving model of best f1: 0.5034022622834924
              precision    recall  f1-score   support

           0   0.705769  0.790948  0.745935       464
           1   0.553846  0.496552  0.523636       145
           2   0.325301  0.217742  0.260870       124

    accuracy                       0.635744       733
   macro avg   0.528306  0.501747  0.510147       733
weighted avg   0.611353  0.635744  0.619903       733

Test Acc: 0.635743519781719 F1_ma:0.5034022622834924
Train step: 1480 acc:0.73555 total_loss: 1.003  loss:0.72842,stance loss: 0.60038 
Train step: 1490 acc:0.73469 total_loss: 1.0037  loss:0.97134,stance loss: 0.8245 
Train step: 1500 acc:0.73453 total_loss: 1.0024  loss:0.77084,stance loss: 0.68009 
Train step: 1510 acc:0.73698 total_loss: 0.99793  loss:0.94922,stance loss: 0.65451 
Train step: 1520 acc:0.73783 total_loss: 0.99842  loss:0.68624,stance loss: 0.59493 
Train step: 1530 acc:0.73755 total_loss: 0.99738  loss:0.87772,stance loss: 0.56274 
Train step: 1540 acc:0.73679 total_loss: 0.99829  loss:0.90037,stance loss: 0.56851 
Train step: 1550 acc:0.73438 total_loss: 0.99751  loss:0.83494,stance loss: 0.63442 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.74107 total_loss: 0.92662  loss:1.0265,stance loss: 0.58071 
Train step: 1570 acc:0.77574 total_loss: 0.88639  loss:0.36182,stance loss: 0.21751 
Train step: 1580 acc:0.77546 total_loss: 0.87632  loss:1.0331,stance loss: 0.88226 
Train step: 1590 acc:0.77196 total_loss: 0.88556  loss:0.83208,stance loss: 0.64143 
Train step: 1600 acc:0.78457 total_loss: 0.88966  loss:0.53094,stance loss: 0.4418 
Train step: 1610 acc:0.78399 total_loss: 0.88057  loss:0.9098,stance loss: 1.1623 
Train step: 1620 acc:0.78172 total_loss: 0.90235  loss:1.3267,stance loss: 1.5156 
Train step: 1630 acc:0.77841 total_loss: 0.9118  loss:1.4477,stance loss: 1.6592 
Train step: 1640 acc:0.77155 total_loss: 0.91633  loss:0.74782,stance loss: 0.61341 
Train step: 1650 acc:0.77062 total_loss: 0.92084  loss:0.87588,stance loss: 0.57072 
Train step: 1660 acc:0.76811 total_loss: 0.92343  loss:0.83611,stance loss: 0.71049 
Train step: 1670 acc:0.76976 total_loss: 0.91699  loss:1.066,stance loss: 0.87036 
Train step: 1680 acc:0.76624 total_loss: 0.92891  loss:1.0677,stance loss: 0.93129 
Train step: 1690 acc:0.76597 total_loss: 0.9265  loss:0.85961,stance loss: 0.68612 
Train step: 1700 acc:0.76531 total_loss: 0.93274  loss:0.75812,stance loss: 0.61701 
Train step: 1710 acc:0.76433 total_loss: 0.92879  loss:0.99892,stance loss: 0.82967 
Train step: 1720 acc:0.76272 total_loss: 0.93233  loss:0.77277,stance loss: 0.60183 
Train step: 1730 acc:0.76342 total_loss: 0.93345  loss:0.67249,stance loss: 0.53873 
Train step: 1740 acc:0.7637 total_loss: 0.9306  loss:0.47931,stance loss: 0.33599 
Train step: 1750 acc:0.76206 total_loss: 0.92991  loss:0.63364,stance loss: 0.43247 
Train step: 1760 acc:0.76359 total_loss: 0.92278  loss:0.71843,stance loss: 0.51097 
Train step: 1770 acc:0.76296 total_loss: 0.9215  loss:0.9438,stance loss: 0.85788 
Train step: 1780 acc:0.76377 total_loss: 0.91629  loss:0.38256,stance loss: 0.22578 
Train step: 1790 acc:0.76398 total_loss: 0.92107  loss:0.68815,stance loss: 0.5741 
Train step: 1800 acc:0.76518 total_loss: 0.9197  loss:1.3702,stance loss: 1.1054 
Train step: 1810 acc:0.76435 total_loss: 0.92212  loss:0.61408,stance loss: 0.56036 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.77344 total_loss: 0.9331  loss:1.0007,stance loss: 0.75609 
Train step: 1830 acc:0.79861 total_loss: 0.876  loss:0.79184,stance loss: 0.64412 
Train step: 1840 acc:0.78795 total_loss: 0.87188  loss:1.0329,stance loss: 0.77253 
Train step: 1850 acc:0.79112 total_loss: 0.83767  loss:0.77143,stance loss: 1.0971 
Train step: 1860 acc:0.80078 total_loss: 0.82387  loss:0.67033,stance loss: 0.50624 
Train step: 1870 acc:0.79957 total_loss: 0.81343  loss:0.63689,stance loss: 0.43902 
Train step: 1880 acc:0.81066 total_loss: 0.78632  loss:0.49303,stance loss: 0.38035 
Train step: 1890 acc:0.80609 total_loss: 0.77722  loss:0.63487,stance loss: 0.55269 
Train step: 1900 acc:0.79901 total_loss: 0.7924  loss:1.2903,stance loss: 0.95315 
Train step: 1910 acc:0.79974 total_loss: 0.79684  loss:0.74064,stance loss: 0.5472 
Train step: 1920 acc:0.78993 total_loss: 0.81018  loss:1.0834,stance loss: 0.9597 
Train step: 1930 acc:0.78919 total_loss: 0.81806  loss:0.75577,stance loss: 0.62125 
Train step: 1940 acc:0.7876 total_loss: 0.81318  loss:0.72262,stance loss: 0.55122 
Train step: 1950 acc:0.79121 total_loss: 0.80483  loss:0.56128,stance loss: 0.3747 
Train step: 1960 acc:0.78547 total_loss: 0.80276  loss:1.0119,stance loss: 0.83821 
Train step: 1970 acc:0.78956 total_loss: 0.79531  loss:0.25466,stance loss: 0.15209 
Train step: 1980 acc:0.78943 total_loss: 0.80185  loss:0.63533,stance loss: 0.58167 
Train step: 1990 acc:0.78933 total_loss: 0.80294  loss:1.3565,stance loss: 1.0938 
Train step: 2000 acc:0.7889 total_loss: 0.8015  loss:0.49376,stance loss: 0.39293 
Train step: 2010 acc:0.78788 total_loss: 0.80288  loss:0.94822,stance loss: 0.79467 
Train step: 2020 acc:0.78756 total_loss: 0.80633  loss:0.7096,stance loss: 0.64453 
Train step: 2030 acc:0.78928 total_loss: 0.80583  loss:0.94405,stance loss: 0.79512 
Train step: 2040 acc:0.79084 total_loss: 0.80323  loss:0.61868,stance loss: 0.4632 
Train step: 2050 acc:0.78782 total_loss: 0.81367  loss:0.84841,stance loss: 0.77132 
Train step: 2060 acc:0.79057 total_loss: 0.81051  loss:0.59023,stance loss: 0.43397 
Train step: 2070 acc:0.79167 total_loss: 0.80966  loss:0.61862,stance loss: 0.53081 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.85417 total_loss: 0.67826  loss:0.76745,stance loss: 0.65434 
Train step: 2090 acc:0.82566 total_loss: 0.72394  loss:0.46987,stance loss: 0.37021 
Train step: 2100 acc:0.83836 total_loss: 0.69601  loss:0.25034,stance loss: 0.1321 
Train step: 2110 acc:0.84936 total_loss: 0.67086  loss:0.57908,stance loss: 0.44339 
Train step: 2120 acc:0.84184 total_loss: 0.68825  loss:1.1619,stance loss: 1.4447 
Train step: 2130 acc:0.83581 total_loss: 0.70318  loss:0.51786,stance loss: 0.42094 
Train step: 2140 acc:0.83152 total_loss: 0.6997  loss:0.56732,stance loss: 0.40626 
Train step: 2150 acc:0.83307 total_loss: 0.70246  loss:0.52627,stance loss: 0.41676 
Train step: 2160 acc:0.83287 total_loss: 0.70069  loss:0.55239,stance loss: 0.42927 
Train step: 2170 acc:0.82828 total_loss: 0.71215  loss:0.65534,stance loss: 0.55415 
Train step: 2180 acc:0.82683 total_loss: 0.72345  loss:1.607,stance loss: 1.8242 
Train step: 2190 acc:0.8209 total_loss: 0.7336  loss:1.2397,stance loss: 1.5317 
Train step: 2200 acc:0.8251 total_loss: 0.72755  loss:0.38168,stance loss: 0.30649 
Train step: 2210 acc:0.82419 total_loss: 0.73378  loss:0.54223,stance loss: 0.49062 
Train step: 2220 acc:0.82215 total_loss: 0.73771  loss:0.83245,stance loss: 0.70797 
Train step: 2230 acc:0.82233 total_loss: 0.73832  loss:1.2704,stance loss: 0.95106 
Train step: 2240 acc:0.82101 total_loss: 0.74144  loss:0.64187,stance loss: 0.59731 
Train step: 2250 acc:0.82263 total_loss: 0.74308  loss:0.59986,stance loss: 0.49807 
Train step: 2260 acc:0.82077 total_loss: 0.74245  loss:0.87687,stance loss: 0.69365 
Train step: 2270 acc:0.82129 total_loss: 0.74334  loss:0.448,stance loss: 0.3347 
Train step: 2280 acc:0.81968 total_loss: 0.75001  loss:0.7587,stance loss: 0.74195 
Train step: 2290 acc:0.81906 total_loss: 0.75074  loss:1.2972,stance loss: 1.067 
Train step: 2300 acc:0.81878 total_loss: 0.74854  loss:0.58257,stance loss: 0.40073 
Train step: 2310 acc:0.81956 total_loss: 0.7478  loss:0.75975,stance loss: 0.65772 
Train step: 2320 acc:0.81928 total_loss: 0.744  loss:0.93861,stance loss: 0.5457 
Train step: 2330 acc:0.81895 total_loss: 0.7415  loss:0.54726,stance loss: 0.52505 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.78125 total_loss: 0.70095  loss:0.58812,stance loss: 0.43401 
Train step: 2350 acc:0.825 total_loss: 0.64127  loss:0.49821,stance loss: 0.39258 
Train step: 2360 acc:0.81875 total_loss: 0.68421  loss:0.8032,stance loss: 0.5855 
Train step: 2370 acc:0.82344 total_loss: 0.66532  loss:0.21933,stance loss: 0.14672 
Train step: 2380 acc:0.8275 total_loss: 0.68067  loss:1.1037,stance loss: 1.2764 
Train step: 2390 acc:0.83646 total_loss: 0.64825  loss:0.49744,stance loss: 0.41804 
Train step: 2400 acc:0.82946 total_loss: 0.66622  loss:1.1187,stance loss: 1.461 
Train step: 2410 acc:0.83125 total_loss: 0.67597  loss:0.45968,stance loss: 0.3372 
Train step: 2420 acc:0.82917 total_loss: 0.67503  loss:0.86345,stance loss: 0.71464 
Train step: 2430 acc:0.82937 total_loss: 0.67879  loss:1.4134,stance loss: 1.5582 
Train step: 2440 acc:0.83068 total_loss: 0.68442  loss:0.84014,stance loss: 0.63806 
Train step: 2450 acc:0.83646 total_loss: 0.67148  loss:0.37405,stance loss: 0.28469 
Train step: 2460 acc:0.83654 total_loss: 0.67445  loss:0.44302,stance loss: 0.35948 
Train step: 2470 acc:0.83884 total_loss: 0.68131  loss:0.47688,stance loss: 0.38433 
Train step: 2480 acc:0.83542 total_loss: 0.68173  loss:0.83087,stance loss: 0.70449 
Train step: 2490 acc:0.83398 total_loss: 0.68288  loss:1.0941,stance loss: 1.3833 
Train step: 2500 acc:0.83529 total_loss: 0.67921  loss:0.32018,stance loss: 0.22473 
Train step: 2510 acc:0.83681 total_loss: 0.67651  loss:0.75855,stance loss: 1.1786 
Train step: 2520 acc:0.83914 total_loss: 0.67274  loss:1.2129,stance loss: 1.1355 
Train step: 2530 acc:0.84062 total_loss: 0.66808  loss:0.6055,stance loss: 0.55964 
Train step: 2540 acc:0.84315 total_loss: 0.66217  loss:0.6637,stance loss: 0.5499 
Train step: 2550 acc:0.84489 total_loss: 0.65683  loss:0.40922,stance loss: 0.32744 
Train step: 2560 acc:0.84511 total_loss: 0.65143  loss:0.60629,stance loss: 0.51159 
Train step: 2570 acc:0.84661 total_loss: 0.64679  loss:0.83762,stance loss: 0.68353 
Train step: 2580 acc:0.84525 total_loss: 0.64838  loss:1.2022,stance loss: 0.9305 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:1.0 total_loss: 0.27964  loss:0.27964,stance loss: 0.22902 
Train step: 2600 acc:0.92614 total_loss: 0.48712  loss:0.29755,stance loss: 0.16341 
Train step: 2610 acc:0.91369 total_loss: 0.51109  loss:0.63714,stance loss: 1.065 
Train step: 2620 acc:0.90524 total_loss: 0.52805  loss:0.69734,stance loss: 0.40997 
Train step: 2630 acc:0.89787 total_loss: 0.52018  loss:0.19392,stance loss: 0.13032 
Train step: 2640 acc:0.89338 total_loss: 0.53037  loss:0.175,stance loss: 0.15113 
Train step: 2650 acc:0.89652 total_loss: 0.50757  loss:0.36715,stance loss: 0.28593 
Train step: 2660 acc:0.89085 total_loss: 0.52123  loss:0.48665,stance loss: 0.39651 
Train step: 2670 acc:0.88735 total_loss: 0.53616  loss:0.34976,stance loss: 0.24227 
Train step: 2680 acc:0.8853 total_loss: 0.5429  loss:0.52363,stance loss: 0.4864 
Train step: 2690 acc:0.88428 total_loss: 0.53738  loss:0.58306,stance loss: 0.45564 
Train step: 2700 acc:0.88457 total_loss: 0.53297  loss:0.60195,stance loss: 0.53198 
Train step: 2710 acc:0.88791 total_loss: 0.53101  loss:0.16904,stance loss: 0.10994 
Train step: 2720 acc:0.88884 total_loss: 0.53089  loss:0.8223,stance loss: 0.71502 
Train step: 2730 acc:0.88564 total_loss: 0.53277  loss:0.49101,stance loss: 0.38109 
Train step: 2740 acc:0.88493 total_loss: 0.54292  loss:0.44009,stance loss: 0.33044 
Train step: 2750 acc:0.88509 total_loss: 0.54668  loss:1.5083,stance loss: 1.2069 
Train step: 2760 acc:0.88487 total_loss: 0.54356  loss:0.40083,stance loss: 0.30661 
Train step: 2770 acc:0.88294 total_loss: 0.5443  loss:0.8941,stance loss: 0.64783 
Train step: 2780 acc:0.88187 total_loss: 0.56028  loss:0.84489,stance loss: 0.68621 
Train step: 2790 acc:0.88184 total_loss: 0.55944  loss:0.23051,stance loss: 0.16625 
Train step: 2800 acc:0.88152 total_loss: 0.55814  loss:0.39197,stance loss: 0.31915 
Train step: 2810 acc:0.88207 total_loss: 0.55319  loss:0.28394,stance loss: 0.16374 
Train step: 2820 acc:0.88203 total_loss: 0.55274  loss:0.90294,stance loss: 0.72534 
Train step: 2830 acc:0.882 total_loss: 0.55452  loss:0.40626,stance loss: 0.32598 
Train step: 2840 acc:0.88197 total_loss: 0.55707  loss:0.73774,stance loss: 1.1046 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.90625 total_loss: 0.39771  loss:0.58416,stance loss: 0.47195 
Train step: 2860 acc:0.86979 total_loss: 0.51516  loss:0.14757,stance loss: 0.079852 
Train step: 2870 acc:0.88068 total_loss: 0.46086  loss:0.70579,stance loss: 0.72826 
Train step: 2880 acc:0.88086 total_loss: 0.46714  loss:0.17063,stance loss: 0.13214 
Train step: 2890 acc:0.88839 total_loss: 0.45648  loss:0.49553,stance loss: 0.45371 
Train step: 2900 acc:0.89183 total_loss: 0.47327  loss:0.2566,stance loss: 0.12614 
Train step: 2910 acc:0.88911 total_loss: 0.49495  loss:0.30172,stance loss: 0.29325 
Train step: 2920 acc:0.88802 total_loss: 0.49513  loss:0.17089,stance loss: 0.081944 
Train step: 2930 acc:0.88034 total_loss: 0.53224  loss:1.2952,stance loss: 2.0232 
Train step: 2940 acc:0.88723 total_loss: 0.50438  loss:0.68576,stance loss: 0.50702 
Train step: 2950 acc:0.88787 total_loss: 0.50143  loss:0.67948,stance loss: 0.48518 
Train step: 2960 acc:0.8856 total_loss: 0.51068  loss:0.70027,stance loss: 0.61214 
Train step: 2970 acc:0.88525 total_loss: 0.515  loss:1.4518,stance loss: 1.8367 
Train step: 2980 acc:0.88305 total_loss: 0.5142  loss:0.48914,stance loss: 0.38669 
Train step: 2990 acc:0.8838 total_loss: 0.50868  loss:0.73665,stance loss: 0.54525 
Train step: 3000 acc:0.88405 total_loss: 0.50397  loss:0.18715,stance loss: 0.14773 
Train step: 3010 acc:0.88387 total_loss: 0.50404  loss:0.17256,stance loss: 0.15611 
Train step: 3020 acc:0.88554 total_loss: 0.50032  loss:0.56683,stance loss: 0.46561 
Train step: 3030 acc:0.88565 total_loss: 0.49328  loss:0.66452,stance loss: 0.52334 
Train step: 3040 acc:0.88574 total_loss: 0.4929  loss:0.25493,stance loss: 0.22126 
Train step: 3050 acc:0.88707 total_loss: 0.4958  loss:0.34691,stance loss: 0.32565 
Train step: 3060 acc:0.88709 total_loss: 0.49567  loss:0.53177,stance loss: 0.42116 
Train step: 3070 acc:0.88682 total_loss: 0.49628  loss:0.46303,stance loss: 0.38187 
Train step: 3080 acc:0.88605 total_loss: 0.49979  loss:0.52446,stance loss: 0.487 
Train step: 3090 acc:0.88559 total_loss: 0.49909  loss:0.45188,stance loss: 0.42025 
Train step: 3100 acc:0.8869 total_loss: 0.49669  loss:0.051809,stance loss: 0.016531 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.91667 total_loss: 0.53698  loss:0.51094,stance loss: 0.41742 
Train step: 3120 acc:0.91346 total_loss: 0.50368  loss:1.0829,stance loss: 1.4457 
Train step: 3130 acc:0.91848 total_loss: 0.43717  loss:0.44062,stance loss: 0.34766 
Train step: 3140 acc:0.91477 total_loss: 0.4817  loss:0.2144,stance loss: 0.19023 
Train step: 3150 acc:0.90843 total_loss: 0.46726  loss:0.81908,stance loss: 0.69242 
Train step: 3160 acc:0.90566 total_loss: 0.45923  loss:0.3376,stance loss: 0.25875 
Train step: 3170 acc:0.90476 total_loss: 0.44993  loss:0.638,stance loss: 0.71218 
Train step: 3180 acc:0.90325 total_loss: 0.44698  loss:0.5548,stance loss: 0.37017 
Train step: 3190 acc:0.89985 total_loss: 0.45342  loss:0.25029,stance loss: 0.16723 
Train step: 3200 acc:0.90054 total_loss: 0.45963  loss:0.40314,stance loss: 0.35812 
Train step: 3210 acc:0.90413 total_loss: 0.44781  loss:0.13414,stance loss: 0.059503 
Train step: 3220 acc:0.90653 total_loss: 0.44846  loss:0.13593,stance loss: 0.069088 
Train step: 3230 acc:0.90752 total_loss: 0.44342  loss:0.26327,stance loss: 0.18464 
Train step: 3240 acc:0.90883 total_loss: 0.43501  loss:0.46555,stance loss: 0.41293 
Train step: 3250 acc:0.9104 total_loss: 0.43496  loss:0.94047,stance loss: 0.72019 
Train step: 3260 acc:0.91299 total_loss: 0.42592  loss:0.42636,stance loss: 0.34739 
Train step: 3270 acc:0.91373 total_loss: 0.42454  loss:0.23553,stance loss: 0.19657 
Train step: 3280 acc:0.91402 total_loss: 0.42236  loss:0.4711,stance loss: 0.38017 
Train step: 3290 acc:0.91325 total_loss: 0.4219  loss:0.46925,stance loss: 0.2216 
Train step: 3300 acc:0.91256 total_loss: 0.41967  loss:0.089939,stance loss: 0.043436 
Train step: 3310 acc:0.91225 total_loss: 0.41784  loss:0.81279,stance loss: 1.2744 
Train step: 3320 acc:0.91403 total_loss: 0.41272  loss:0.68425,stance loss: 0.55394 
Train step: 3330 acc:0.91564 total_loss: 0.40602  loss:0.083986,stance loss: 0.045808 
Train step: 3340 acc:0.91389 total_loss: 0.41246  loss:0.44436,stance loss: 0.4054 
Train step: 3350 acc:0.91487 total_loss: 0.40911  loss:0.61843,stance loss: 0.37212 
Train step: 3360 acc:0.91502 total_loss: 0.40627  loss:0.55498,stance loss: 0.39326 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.95312 total_loss: 0.22283  loss:0.29122,stance loss: 0.24623 
Train step: 3380 acc:0.9375 total_loss: 0.26536  loss:0.28119,stance loss: 0.2132 
Train step: 3390 acc:0.94792 total_loss: 0.25945  loss:0.084881,stance loss: 0.046996 
Train step: 3400 acc:0.94301 total_loss: 0.28581  loss:0.52537,stance loss: 0.51434 
Train step: 3410 acc:0.94318 total_loss: 0.29038  loss:0.52229,stance loss: 0.37124 
Train step: 3420 acc:0.94444 total_loss: 0.28748  loss:0.11254,stance loss: 0.053344 
Train step: 3430 acc:0.94043 total_loss: 0.3142  loss:0.26147,stance loss: 0.16673 
Train step: 3440 acc:0.93919 total_loss: 0.31553  loss:0.10087,stance loss: 0.017226 
Train step: 3450 acc:0.93676 total_loss: 0.33228  loss:0.20438,stance loss: 0.17899 
Train step: 3460 acc:0.93484 total_loss: 0.34518  loss:0.28607,stance loss: 0.14661 
Train step: 3470 acc:0.9357 total_loss: 0.34634  loss:0.22655,stance loss: 0.15356 
Train step: 3480 acc:0.93257 total_loss: 0.3464  loss:0.4077,stance loss: 0.27738 
Train step: 3490 acc:0.93246 total_loss: 0.34796  loss:0.1347,stance loss: 0.089088 
Train step: 3500 acc:0.93097 total_loss: 0.34632  loss:0.21333,stance loss: 0.13793 
Train step: 3510 acc:0.93012 total_loss: 0.34561  loss:0.047367,stance loss: 0.015847 
Train step: 3520 acc:0.93141 total_loss: 0.35066  loss:0.49541,stance loss: 0.47602 
Train step: 3530 acc:0.93216 total_loss: 0.3475  loss:0.22525,stance loss: 0.065809 
Train step: 3540 acc:0.93283 total_loss: 0.35179  loss:0.64362,stance loss: 1.0917 
Train step: 3550 acc:0.93173 total_loss: 0.35735  loss:0.39752,stance loss: 0.3923 
Train step: 3560 acc:0.93202 total_loss: 0.35841  loss:0.86773,stance loss: 1.1952 
Train step: 3570 acc:0.93352 total_loss: 0.35164  loss:0.16926,stance loss: 0.12862 
Train step: 3580 acc:0.9337 total_loss: 0.3517  loss:0.18908,stance loss: 0.13391 
Train step: 3590 acc:0.93499 total_loss: 0.34722  loss:0.35204,stance loss: 0.21577 
Train step: 3600 acc:0.93456 total_loss: 0.3501  loss:0.11043,stance loss: 0.071795 
Train step: 3610 acc:0.93443 total_loss: 0.34822  loss:0.23572,stance loss: 0.17477 
Train step: 3620 acc:0.93504 total_loss: 0.34852  loss:0.11611,stance loss: 0.09299 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.925 total_loss: 0.34909  loss:0.73509,stance loss: 0.54945 
Train step: 3640 acc:0.925 total_loss: 0.32393  loss:0.53165,stance loss: 0.33706 
Train step: 3650 acc:0.94 total_loss: 0.30684  loss:0.10704,stance loss: 0.05899 
Train step: 3660 acc:0.94464 total_loss: 0.3086  loss:0.11585,stance loss: 0.076092 
Train step: 3670 acc:0.94306 total_loss: 0.3323  loss:0.44117,stance loss: 0.4244 
Train step: 3680 acc:0.94773 total_loss: 0.3081  loss:0.45729,stance loss: 0.34996 
Train step: 3690 acc:0.94615 total_loss: 0.3161  loss:0.038666,stance loss: 0.0058674 
Train step: 3700 acc:0.94167 total_loss: 0.3249  loss:0.55246,stance loss: 0.49795 
Train step: 3710 acc:0.94265 total_loss: 0.31488  loss:0.14467,stance loss: 0.066097 
Train step: 3720 acc:0.94211 total_loss: 0.31751  loss:0.22516,stance loss: 0.17515 
Train step: 3730 acc:0.94167 total_loss: 0.32031  loss:0.077911,stance loss: 0.030447 
Train step: 3740 acc:0.94293 total_loss: 0.31232  loss:0.20846,stance loss: 0.18475 
Train step: 3750 acc:0.9435 total_loss: 0.30409  loss:0.079285,stance loss: 0.068355 
Train step: 3760 acc:0.94398 total_loss: 0.30168  loss:0.16539,stance loss: 0.14317 
Train step: 3770 acc:0.9444 total_loss: 0.29659  loss:0.18712,stance loss: 0.13368 
Train step: 3780 acc:0.94516 total_loss: 0.29274  loss:0.30261,stance loss: 0.19687 
Train step: 3790 acc:0.9447 total_loss: 0.293  loss:0.38896,stance loss: 0.34383 
Train step: 3800 acc:0.94607 total_loss: 0.28745  loss:0.077245,stance loss: 0.046841 
Train step: 3810 acc:0.9473 total_loss: 0.28008  loss:0.17322,stance loss: 0.15336 
Train step: 3820 acc:0.94551 total_loss: 0.28821  loss:0.39339,stance loss: 0.34285 
Train step: 3830 acc:0.94482 total_loss: 0.29188  loss:0.06244,stance loss: 0.0091342 
Train step: 3840 acc:0.94535 total_loss: 0.28689  loss:0.16726,stance loss: 0.16669 
Train step: 3850 acc:0.94583 total_loss: 0.28415  loss:0.039029,stance loss: 0.0072536 
Train step: 3860 acc:0.94601 total_loss: 0.28263  loss:0.54133,stance loss: 1.0105 
Train step: 3870 acc:0.94592 total_loss: 0.28416  loss:0.074937,stance loss: 0.031436 
Train step: 3880 acc:0.94632 total_loss: 0.28041  loss:0.15382,stance loss: 0.00034052 
Training finished.


Reload the best model with best f1 0.5034022622834924 from path test_outputs/bert-cross-topic/a/2023-08-14 14-40-07/state_dict


              precision    recall  f1-score   support

           0   0.705769  0.790948  0.745935       464
           1   0.553846  0.496552  0.523636       145
           2   0.325301  0.217742  0.260870       124

    accuracy                       0.635744       733
   macro avg   0.528306  0.501747  0.510147       733
weighted avg   0.611353  0.635744  0.619903       733

Test Acc: 0.635743519781719 F1_ma:0.5034022622834924
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5034022622834924
acc: 0.635743519781719, f1 :0.5101469627344495
classification report: 
              precision    recall  f1-score   support

         Con     0.7058    0.7909    0.7459       464
        None     0.5538    0.4966    0.5236       145
         Pro     0.3253    0.2177    0.2609       124

    accuracy                         0.6357       733
   macro avg     0.5283    0.5017    0.5101       733
weighted avg     0.6114    0.6357    0.6199       733

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 15-00-03', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 15-00-03
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.6162  loss:1.6162,stance loss: 1.1045 
Train step: 10 acc:0.39773 total_loss: 1.8139  loss:2.2976,stance loss: 2.4422 
Better F1! Saving model!
Saving model of best f1: 0.38763575605680867
              precision    recall  f1-score   support

           0   0.633015  1.000000  0.775272       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211005  0.333333  0.258424       733
weighted avg   0.400708  0.633015  0.490759       733

Test Acc: 0.6330150068212824 F1_ma:0.38763575605680867
Train step: 20 acc:0.45238 total_loss: 1.7262  loss:1.5256,stance loss: 1.1302 
Train step: 30 acc:0.45161 total_loss: 1.7153  loss:1.6276,stance loss: 1.1377 
Train step: 40 acc:0.45579 total_loss: 1.7073  loss:1.7389,stance loss: 1.2362 
Train step: 50 acc:0.46446 total_loss: 1.697  loss:1.5173,stance loss: 1.075 
Train step: 60 acc:0.46414 total_loss: 1.6905  loss:1.6681,stance loss: 1.1905 
Train step: 70 acc:0.47183 total_loss: 1.6785  loss:1.483,stance loss: 1.0918 
Train step: 80 acc:0.46914 total_loss: 1.6762  loss:1.7539,stance loss: 1.1155 
Train step: 90 acc:0.47321 total_loss: 1.6677  loss:1.7562,stance loss: 1.1656 
Train step: 100 acc:0.47339 total_loss: 1.6643  loss:1.6678,stance loss: 1.1302 
Train step: 110 acc:0.47748 total_loss: 1.656  loss:1.658,stance loss: 1.2117 
Train step: 120 acc:0.47624 total_loss: 1.6535  loss:1.5634,stance loss: 1.1981 
Train step: 130 acc:0.48139 total_loss: 1.6489  loss:1.4579,stance loss: 1.0924 
Train step: 140 acc:0.48005 total_loss: 1.6452  loss:1.6457,stance loss: 1.113 
Train step: 150 acc:0.48593 total_loss: 1.6376  loss:1.6921,stance loss: 1.3171 
Train step: 160 acc:0.48991 total_loss: 1.6282  loss:1.5564,stance loss: 1.1705 
Train step: 170 acc:0.4905 total_loss: 1.6212  loss:1.6588,stance loss: 1.3695 
Train step: 180 acc:0.49275 total_loss: 1.6178  loss:1.8854,stance loss: 1.8212 
Train step: 190 acc:0.49247 total_loss: 1.6161  loss:1.7633,stance loss: 1.5534 
Train step: 200 acc:0.49782 total_loss: 1.6139  loss:1.5706,stance loss: 1.1067 
Train step: 210 acc:0.5 total_loss: 1.6071  loss:1.5089,stance loss: 0.92934 
Train step: 220 acc:0.50085 total_loss: 1.6036  loss:1.2443,stance loss: 0.61884 
Train step: 230 acc:0.50135 total_loss: 1.6026  loss:1.6016,stance loss: 1.314 
Train step: 240 acc:0.50648 total_loss: 1.5967  loss:1.6735,stance loss: 1.6421 
Train step: 250 acc:0.51145 total_loss: 1.5941  loss:1.6714,stance loss: 1.744 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.4375 total_loss: 1.5407  loss:1.5194,stance loss: 1.0536 
Train step: 270 acc:0.55208 total_loss: 1.5231  loss:1.5233,stance loss: 1.098 
Train step: 280 acc:0.5483 total_loss: 1.4764  loss:1.5261,stance loss: 0.97304 
Train step: 290 acc:0.56055 total_loss: 1.463  loss:1.4578,stance loss: 1.2312 
Train step: 300 acc:0.57292 total_loss: 1.4665  loss:1.673,stance loss: 1.7339 
Train step: 310 acc:0.58774 total_loss: 1.449  loss:1.6349,stance loss: 1.1136 
Train step: 320 acc:0.58165 total_loss: 1.4528  loss:1.6285,stance loss: 1.271 
Train step: 330 acc:0.57378 total_loss: 1.4604  loss:1.4264,stance loss: 1.0607 
Train step: 340 acc:0.58079 total_loss: 1.4514  loss:1.6435,stance loss: 1.4492 
Train step: 350 acc:0.58424 total_loss: 1.4438  loss:1.5982,stance loss: 1.681 
Train step: 360 acc:0.58517 total_loss: 1.4416  loss:1.6954,stance loss: 1.2696 
Train step: 370 acc:0.58371 total_loss: 1.4374  loss:1.621,stance loss: 1.2323 
Train step: 380 acc:0.58299 total_loss: 1.4373  loss:1.7544,stance loss: 1.2802 
Train step: 390 acc:0.59233 total_loss: 1.4234  loss:1.3857,stance loss: 1.0769 
Train step: 400 acc:0.59243 total_loss: 1.4221  loss:1.722,stance loss: 1.7502 
Train step: 410 acc:0.59211 total_loss: 1.414  loss:1.3898,stance loss: 1.0646 
Train step: 420 acc:0.59877 total_loss: 1.4085  loss:1.1261,stance loss: 0.83101 
Train step: 430 acc:0.60429 total_loss: 1.403  loss:1.2292,stance loss: 0.8004 
Train step: 440 acc:0.6068 total_loss: 1.3959  loss:1.3036,stance loss: 1.2167 
Train step: 450 acc:0.60742 total_loss: 1.3944  loss:1.2043,stance loss: 1.0008 
Train step: 460 acc:0.60551 total_loss: 1.3948  loss:1.4174,stance loss: 1.2539 
Train step: 470 acc:0.60731 total_loss: 1.3893  loss:1.4361,stance loss: 1.0868 
Train step: 480 acc:0.61008 total_loss: 1.3847  loss:1.3037,stance loss: 0.98672 
Train step: 490 acc:0.61288 total_loss: 1.3832  loss:1.5992,stance loss: 1.4194 
Train step: 500 acc:0.61054 total_loss: 1.3834  loss:1.3694,stance loss: 0.9383 
Train step: 510 acc:0.60987 total_loss: 1.3848  loss:1.4014,stance loss: 1.0464 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.6875 total_loss: 1.1454  loss:1.2213,stance loss: 0.9768 
Train step: 530 acc:0.66827 total_loss: 1.2634  loss:1.2203,stance loss: 1.0639 
Train step: 540 acc:0.69022 total_loss: 1.1939  loss:1.3232,stance loss: 0.89304 
Train step: 550 acc:0.67045 total_loss: 1.2133  loss:1.184,stance loss: 0.85315 
Train step: 560 acc:0.68169 total_loss: 1.1899  loss:1.0308,stance loss: 0.57596 
Train step: 570 acc:0.66392 total_loss: 1.2304  loss:1.3372,stance loss: 0.93718 
Train step: 580 acc:0.6498 total_loss: 1.2428  loss:1.208,stance loss: 0.68756 
Train step: 590 acc:0.67038 total_loss: 1.2361  loss:0.81404,stance loss: 0.56968 
Train step: 600 acc:0.67018 total_loss: 1.243  loss:1.0616,stance loss: 0.7856 
Train step: 610 acc:0.67406 total_loss: 1.2323  loss:1.2254,stance loss: 0.92373 
Train step: 620 acc:0.68204 total_loss: 1.2161  loss:0.68948,stance loss: 0.45322 
Train step: 630 acc:0.67865 total_loss: 1.214  loss:1.1013,stance loss: 0.80825 
Train step: 640 acc:0.67734 total_loss: 1.2154  loss:1.3197,stance loss: 0.94581 
Better F1! Saving model!
Saving model of best f1: 0.43090770926760347
              precision    recall  f1-score   support

           0   0.686391  0.500000  0.578554       464
           1   0.398601  0.786207  0.529002       145
           2   0.302752  0.266129  0.283262       124

    accuracy                       0.517053       733
   macro avg   0.462581  0.517445  0.463606       733
weighted avg   0.564562  0.517053  0.518798       733

Test Acc: 0.5170532060027285 F1_ma:0.43090770926760347
Train step: 650 acc:0.67716 total_loss: 1.2147  loss:1.4173,stance loss: 1.2417 
Train step: 660 acc:0.6792 total_loss: 1.2108  loss:1.6099,stance loss: 1.7272 
Train step: 670 acc:0.67647 total_loss: 1.2113  loss:0.98549,stance loss: 0.7141 
Train step: 680 acc:0.67331 total_loss: 1.2191  loss:1.1796,stance loss: 0.98875 
Train step: 690 acc:0.67775 total_loss: 1.2157  loss:1.13,stance loss: 0.85557 
Train step: 700 acc:0.67999 total_loss: 1.211  loss:1.1511,stance loss: 0.9963 
Train step: 710 acc:0.67876 total_loss: 1.2102  loss:1.27,stance loss: 0.82014 
Train step: 720 acc:0.67703 total_loss: 1.21  loss:0.84242,stance loss: 0.6365 
Train step: 730 acc:0.67459 total_loss: 1.2161  loss:1.3221,stance loss: 1.0042 
Train step: 740 acc:0.67293 total_loss: 1.2188  loss:1.5213,stance loss: 1.3285 
Train step: 750 acc:0.67114 total_loss: 1.2204  loss:1.1294,stance loss: 0.84462 
Train step: 760 acc:0.67052 total_loss: 1.2205  loss:0.97335,stance loss: 0.7773 
Train step: 770 acc:0.66798 total_loss: 1.2231  loss:1.4796,stance loss: 1.2366 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.60938 total_loss: 1.1016  loss:0.96884,stance loss: 0.75603 
Train step: 790 acc:0.6875 total_loss: 1.0457  loss:1.1556,stance loss: 0.95696 
Train step: 800 acc:0.70312 total_loss: 1.0627  loss:1.1105,stance loss: 0.84588 
Train step: 810 acc:0.69118 total_loss: 1.1148  loss:1.4447,stance loss: 1.164 
Train step: 820 acc:0.67756 total_loss: 1.1378  loss:0.91744,stance loss: 0.67838 
Train step: 830 acc:0.67361 total_loss: 1.1491  loss:0.93612,stance loss: 0.69006 
Train step: 840 acc:0.67578 total_loss: 1.1415  loss:1.4463,stance loss: 1.5576 
Train step: 850 acc:0.67821 total_loss: 1.1346  loss:1.159,stance loss: 0.78607 
Train step: 860 acc:0.68229 total_loss: 1.1209  loss:1.043,stance loss: 0.8479 
Train step: 870 acc:0.68617 total_loss: 1.1181  loss:0.96022,stance loss: 0.75516 
Train step: 880 acc:0.6893 total_loss: 1.1117  loss:1.3535,stance loss: 1.0114 
Train step: 890 acc:0.69408 total_loss: 1.1074  loss:0.56784,stance loss: 0.37003 
Train step: 900 acc:0.68901 total_loss: 1.1212  loss:1.5321,stance loss: 1.7555 
Better F1! Saving model!
Saving model of best f1: 0.4874576271186441
              precision    recall  f1-score   support

           0   0.683333  0.706897  0.694915       464
           1   0.457627  0.558621  0.503106       145
           2   0.368421  0.225806  0.280000       124

    accuracy                       0.596180       733
   macro avg   0.503127  0.497108  0.492674       733
weighted avg   0.585412  0.596180  0.586782       733

Test Acc: 0.5961800818553888 F1_ma:0.4874576271186441
Train step: 910 acc:0.68843 total_loss: 1.1279  loss:1.4436,stance loss: 1.1622 
Train step: 920 acc:0.68707 total_loss: 1.1306  loss:1.2155,stance loss: 0.97395 
Train step: 930 acc:0.68831 total_loss: 1.1295  loss:1.1764,stance loss: 1.342 
Train step: 940 acc:0.68902 total_loss: 1.1314  loss:1.4021,stance loss: 1.1244 
Train step: 950 acc:0.68678 total_loss: 1.1306  loss:0.87312,stance loss: 0.68586 
Train step: 960 acc:0.68852 total_loss: 1.1307  loss:0.94668,stance loss: 0.80733 
Train step: 970 acc:0.69008 total_loss: 1.1292  loss:0.73036,stance loss: 0.61787 
Train step: 980 acc:0.69271 total_loss: 1.1213  loss:0.85288,stance loss: 0.68436 
Train step: 990 acc:0.69217 total_loss: 1.1231  loss:1.0892,stance loss: 0.95726 
Train step: 1000 acc:0.69308 total_loss: 1.1229  loss:1.1387,stance loss: 0.84532 
Train step: 1010 acc:0.69151 total_loss: 1.1249  loss:0.86242,stance loss: 0.53277 
Train step: 1020 acc:0.69006 total_loss: 1.1283  loss:1.223,stance loss: 0.79618 
Train step: 1030 acc:0.68873 total_loss: 1.1294  loss:1.4108,stance loss: 1.0139 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.6375 total_loss: 1.0732  loss:1.0768,stance loss: 0.65478 
Train step: 1050 acc:0.70833 total_loss: 1.04  loss:1.1842,stance loss: 0.97274 
Train step: 1060 acc:0.69 total_loss: 1.085  loss:0.91237,stance loss: 0.69382 
Train step: 1070 acc:0.71071 total_loss: 1.0881  loss:0.72307,stance loss: 0.578 
Train step: 1080 acc:0.71667 total_loss: 1.0612  loss:0.62548,stance loss: 0.47037 
Train step: 1090 acc:0.71705 total_loss: 1.0518  loss:0.95443,stance loss: 0.72896 
Train step: 1100 acc:0.70385 total_loss: 1.0803  loss:0.96957,stance loss: 0.73993 
Train step: 1110 acc:0.71167 total_loss: 1.0832  loss:0.76706,stance loss: 0.64556 
Train step: 1120 acc:0.71691 total_loss: 1.0671  loss:0.91557,stance loss: 0.61697 
Train step: 1130 acc:0.71184 total_loss: 1.067  loss:1.1153,stance loss: 0.83558 
Train step: 1140 acc:0.7125 total_loss: 1.0636  loss:1.5195,stance loss: 1.6293 
Train step: 1150 acc:0.71196 total_loss: 1.0677  loss:1.6636,stance loss: 1.7498 
Train step: 1160 acc:0.7135 total_loss: 1.0607  loss:0.64531,stance loss: 0.38985 
Train step: 1170 acc:0.71204 total_loss: 1.0621  loss:1.3827,stance loss: 1.5771 
Train step: 1180 acc:0.71379 total_loss: 1.0611  loss:1.1215,stance loss: 1.0145 
Train step: 1190 acc:0.71452 total_loss: 1.0617  loss:0.83499,stance loss: 0.6164 
Train step: 1200 acc:0.71667 total_loss: 1.0567  loss:0.69319,stance loss: 0.51814 
Train step: 1210 acc:0.71857 total_loss: 1.0516  loss:0.99602,stance loss: 0.75985 
Train step: 1220 acc:0.71791 total_loss: 1.0576  loss:1.2807,stance loss: 0.91056 
Train step: 1230 acc:0.71699 total_loss: 1.0534  loss:1.4693,stance loss: 1.0139 
Train step: 1240 acc:0.71616 total_loss: 1.0548  loss:0.90596,stance loss: 0.71846 
Train step: 1250 acc:0.71599 total_loss: 1.0585  loss:1.2048,stance loss: 0.91873 
Train step: 1260 acc:0.71833 total_loss: 1.0525  loss:0.77403,stance loss: 0.57355 
Train step: 1270 acc:0.71915 total_loss: 1.0485  loss:0.62817,stance loss: 0.58166 
Train step: 1280 acc:0.71913 total_loss: 1.0501  loss:0.61755,stance loss: 0.39511 
Train step: 1290 acc:0.71789 total_loss: 1.0503  loss:1.5784,stance loss: 1.3248 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.6875 total_loss: 1.1422  loss:1.7233,stance loss: 1.3295 
Train step: 1310 acc:0.71875 total_loss: 1.0983  loss:0.80167,stance loss: 0.62311 
Better F1! Saving model!
Saving model of best f1: 0.5053634085213032
              precision    recall  f1-score   support

           0   0.679181  0.857759  0.758095       464
           1   0.604938  0.337931  0.433628       145
           2   0.363636  0.193548  0.252632       124

    accuracy                       0.642565       733
   macro avg   0.549252  0.463079  0.481452       733
weighted avg   0.611114  0.642565  0.608402       733

Test Acc: 0.6425648021828103 F1_ma:0.5053634085213032
Train step: 1320 acc:0.70433 total_loss: 1.0542  loss:1.1087,stance loss: 0.69038 
Train step: 1330 acc:0.71875 total_loss: 1.0184  loss:0.63913,stance loss: 0.44459 
Train step: 1340 acc:0.7337 total_loss: 0.98522  loss:0.85218,stance loss: 0.72934 
Train step: 1350 acc:0.73549 total_loss: 0.9731  loss:0.62505,stance loss: 0.44829 
Train step: 1360 acc:0.73958 total_loss: 0.96927  loss:0.41788,stance loss: 0.26667 
Train step: 1370 acc:0.73602 total_loss: 0.97461  loss:1.4405,stance loss: 1.6451 
Train step: 1380 acc:0.7391 total_loss: 0.98239  loss:0.7656,stance loss: 0.61245 
Train step: 1390 acc:0.74154 total_loss: 0.9795  loss:0.81366,stance loss: 0.61436 
Train step: 1400 acc:0.74469 total_loss: 0.97482  loss:0.71388,stance loss: 0.50862 
Train step: 1410 acc:0.74407 total_loss: 0.96939  loss:0.85867,stance loss: 0.55101 
Train step: 1420 acc:0.74306 total_loss: 0.97371  loss:1.3495,stance loss: 1.5681 
Train step: 1430 acc:0.74724 total_loss: 0.97003  loss:0.82135,stance loss: 0.6405 
Train step: 1440 acc:0.75171 total_loss: 0.9696  loss:0.64928,stance loss: 0.5272 
Train step: 1450 acc:0.75481 total_loss: 0.96202  loss:0.8359,stance loss: 0.72757 
Train step: 1460 acc:0.75377 total_loss: 0.96048  loss:1.2209,stance loss: 0.837 
Train step: 1470 acc:0.7532 total_loss: 0.9539  loss:0.93519,stance loss: 0.80148 
Train step: 1480 acc:0.74966 total_loss: 0.95927  loss:1.4103,stance loss: 1.6595 
Train step: 1490 acc:0.75032 total_loss: 0.95591  loss:1.1534,stance loss: 0.93718 
Train step: 1500 acc:0.75 total_loss: 0.9608  loss:1.0164,stance loss: 0.93425 
Train step: 1510 acc:0.75087 total_loss: 0.95643  loss:1.2207,stance loss: 0.85164 
Train step: 1520 acc:0.75111 total_loss: 0.96275  loss:1.3998,stance loss: 1.6057 
Train step: 1530 acc:0.75238 total_loss: 0.9559  loss:0.55841,stance loss: 0.36155 
Train step: 1540 acc:0.75102 total_loss: 0.95645  loss:1.2451,stance loss: 0.94406 
Train step: 1550 acc:0.75244 total_loss: 0.95509  loss:0.8846,stance loss: 0.77267 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.82143 total_loss: 0.77535  loss:0.82025,stance loss: 0.67771 
Train step: 1570 acc:0.84191 total_loss: 0.7034  loss:0.38993,stance loss: 0.28286 
Train step: 1580 acc:0.81944 total_loss: 0.79185  loss:1.1365,stance loss: 1.4401 
Train step: 1590 acc:0.81757 total_loss: 0.79286  loss:0.71831,stance loss: 0.46047 
Train step: 1600 acc:0.81649 total_loss: 0.79596  loss:0.53897,stance loss: 0.42491 
Train step: 1610 acc:0.8114 total_loss: 0.80596  loss:1.1837,stance loss: 0.84571 
Train step: 1620 acc:0.80131 total_loss: 0.82745  loss:1.154,stance loss: 0.90785 
Train step: 1630 acc:0.78977 total_loss: 0.84234  loss:0.94271,stance loss: 0.74183 
Train step: 1640 acc:0.79167 total_loss: 0.83179  loss:0.6193,stance loss: 0.26608 
Train step: 1650 acc:0.7893 total_loss: 0.83698  loss:0.61445,stance loss: 0.56427 
Train step: 1660 acc:0.79089 total_loss: 0.83622  loss:0.85719,stance loss: 0.67885 
Train step: 1670 acc:0.79006 total_loss: 0.83818  loss:0.66077,stance loss: 0.5351 
Train step: 1680 acc:0.79183 total_loss: 0.8425  loss:0.69539,stance loss: 0.51081 
Better F1! Saving model!
Saving model of best f1: 0.5133635860146857
              precision    recall  f1-score   support

           0   0.696262  0.642241  0.668161       464
           1   0.438202  0.537931  0.482972       145
           2   0.354331  0.362903  0.358566       124

    accuracy                       0.574352       733
   macro avg   0.496265  0.514359  0.503233       733
weighted avg   0.587369  0.574352  0.579154       733

Test Acc: 0.5743519781718963 F1_ma:0.5133635860146857
Train step: 1690 acc:0.79151 total_loss: 0.83826  loss:0.46923,stance loss: 0.36752 
Train step: 1700 acc:0.79082 total_loss: 0.84527  loss:0.90758,stance loss: 1.2562 
Train step: 1710 acc:0.7918 total_loss: 0.84146  loss:0.64848,stance loss: 0.47384 
Train step: 1720 acc:0.79192 total_loss: 0.83852  loss:0.84878,stance loss: 0.67431 
Train step: 1730 acc:0.79308 total_loss: 0.83436  loss:0.77567,stance loss: 0.61698 
Train step: 1740 acc:0.79412 total_loss: 0.83433  loss:0.79825,stance loss: 0.66474 
Train step: 1750 acc:0.79251 total_loss: 0.83991  loss:0.84242,stance loss: 0.6427 
Train step: 1760 acc:0.79318 total_loss: 0.83829  loss:1.2267,stance loss: 0.94462 
Train step: 1770 acc:0.7932 total_loss: 0.83696  loss:0.77653,stance loss: 0.73193 
Better F1! Saving model!
Saving model of best f1: 0.5222376406319986
              precision    recall  f1-score   support

           0   0.696017  0.715517  0.705632       464
           1   0.514493  0.489655  0.501767       145
           2   0.347458  0.330645  0.338843       124

    accuracy                       0.605730       733
   macro avg   0.519322  0.511939  0.515414       733
weighted avg   0.601143  0.605730  0.603255       733

Test Acc: 0.6057298772169167 F1_ma:0.5222376406319986
Train step: 1780 acc:0.7924 total_loss: 0.83936  loss:1.1404,stance loss: 0.78945 
Train step: 1790 acc:0.79219 total_loss: 0.8407  loss:1.3815,stance loss: 1.4956 
Train step: 1800 acc:0.79023 total_loss: 0.84702  loss:1.3301,stance loss: 1.04 
Train step: 1810 acc:0.79183 total_loss: 0.84548  loss:1.5365,stance loss: 1.3473 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.90625 total_loss: 0.64395  loss:0.52736,stance loss: 0.44391 
Train step: 1830 acc:0.85764 total_loss: 0.65143  loss:0.55668,stance loss: 0.39715 
Train step: 1840 acc:0.86384 total_loss: 0.64866  loss:1.1131,stance loss: 1.406 
Train step: 1850 acc:0.85197 total_loss: 0.69593  loss:1.1237,stance loss: 1.0326 
Train step: 1860 acc:0.84766 total_loss: 0.68896  loss:0.39101,stance loss: 0.2875 
Train step: 1870 acc:0.83513 total_loss: 0.70875  loss:0.61937,stance loss: 0.51297 
Train step: 1880 acc:0.83824 total_loss: 0.70807  loss:0.91556,stance loss: 0.84748 
Train step: 1890 acc:0.83814 total_loss: 0.69997  loss:0.56117,stance loss: 0.34304 
Train step: 1900 acc:0.83878 total_loss: 0.69207  loss:0.53575,stance loss: 0.39641 
Train step: 1910 acc:0.83992 total_loss: 0.70051  loss:0.54342,stance loss: 0.38685 
Train step: 1920 acc:0.84144 total_loss: 0.7022  loss:0.62002,stance loss: 0.36087 
Train step: 1930 acc:0.84163 total_loss: 0.69827  loss:0.74379,stance loss: 0.61833 
Train step: 1940 acc:0.83936 total_loss: 0.70111  loss:0.76001,stance loss: 0.72532 
Train step: 1950 acc:0.83605 total_loss: 0.71617  loss:0.82938,stance loss: 0.55163 
Train step: 1960 acc:0.83108 total_loss: 0.72251  loss:0.76151,stance loss: 0.55878 
Train step: 1970 acc:0.82832 total_loss: 0.73247  loss:1.0956,stance loss: 1.3956 
Train step: 1980 acc:0.82999 total_loss: 0.72784  loss:0.90639,stance loss: 0.72158 
Train step: 1990 acc:0.83216 total_loss: 0.73218  loss:0.90491,stance loss: 1.2348 
Train step: 2000 acc:0.83544 total_loss: 0.72969  loss:0.68578,stance loss: 0.53224 
Train step: 2010 acc:0.83144 total_loss: 0.73236  loss:1.0167,stance loss: 0.72885 
Train step: 2020 acc:0.83323 total_loss: 0.72867  loss:0.87061,stance loss: 0.59053 
Train step: 2030 acc:0.83343 total_loss: 0.72938  loss:0.43973,stance loss: 0.34001 
Train step: 2040 acc:0.83498 total_loss: 0.72522  loss:0.46801,stance loss: 0.33273 
Train step: 2050 acc:0.83561 total_loss: 0.7217  loss:0.52015,stance loss: 0.47621 
Train step: 2060 acc:0.83619 total_loss: 0.71466  loss:0.64592,stance loss: 0.29894 
Train step: 2070 acc:0.83576 total_loss: 0.71482  loss:0.41646,stance loss: 0.3219 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.84722 total_loss: 0.60562  loss:0.55098,stance loss: 0.53371 
Train step: 2090 acc:0.83882 total_loss: 0.61375  loss:0.46754,stance loss: 0.33885 
Train step: 2100 acc:0.84267 total_loss: 0.67737  loss:0.98196,stance loss: 1.0588 
Train step: 2110 acc:0.84135 total_loss: 0.70523  loss:0.47442,stance loss: 0.2912 
Train step: 2120 acc:0.84949 total_loss: 0.66341  loss:0.93643,stance loss: 0.98882 
Train step: 2130 acc:0.85487 total_loss: 0.63833  loss:0.23388,stance loss: 0.15672 
Train step: 2140 acc:0.85326 total_loss: 0.6384  loss:0.68275,stance loss: 0.55628 
Train step: 2150 acc:0.85839 total_loss: 0.6348  loss:0.49923,stance loss: 0.47996 
Train step: 2160 acc:0.86096 total_loss: 0.63559  loss:0.48484,stance loss: 0.41645 
Train step: 2170 acc:0.86237 total_loss: 0.62166  loss:0.54214,stance loss: 0.48074 
Train step: 2180 acc:0.86583 total_loss: 0.61008  loss:0.48264,stance loss: 0.41054 
Train step: 2190 acc:0.86345 total_loss: 0.61926  loss:0.96152,stance loss: 0.6487 
Train step: 2200 acc:0.86047 total_loss: 0.62521  loss:0.55988,stance loss: 0.41421 
Train step: 2210 acc:0.86286 total_loss: 0.61936  loss:0.32779,stance loss: 0.23182 
Train step: 2220 acc:0.86493 total_loss: 0.62013  loss:0.23105,stance loss: 0.12546 
Train step: 2230 acc:0.86321 total_loss: 0.62671  loss:0.79924,stance loss: 0.54965 
Train step: 2240 acc:0.86317 total_loss: 0.62007  loss:0.34328,stance loss: 0.15603 
Train step: 2250 acc:0.86243 total_loss: 0.6211  loss:0.6179,stance loss: 0.39099 
Train step: 2260 acc:0.86442 total_loss: 0.61513  loss:0.33311,stance loss: 0.25988 
Train step: 2270 acc:0.86526 total_loss: 0.61065  loss:0.58849,stance loss: 0.47691 
Train step: 2280 acc:0.86603 total_loss: 0.61301  loss:0.5354,stance loss: 0.53182 
Train step: 2290 acc:0.86587 total_loss: 0.61657  loss:0.71005,stance loss: 1.0643 
Train step: 2300 acc:0.86545 total_loss: 0.62217  loss:0.66616,stance loss: 0.45486 
Train step: 2310 acc:0.86532 total_loss: 0.6196  loss:0.50634,stance loss: 0.45279 
Train step: 2320 acc:0.86496 total_loss: 0.62097  loss:0.55997,stance loss: 0.53866 
Train step: 2330 acc:0.86246 total_loss: 0.6288  loss:0.58534,stance loss: 0.42076 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.93125 total_loss: 0.44106  loss:0.54674,stance loss: 0.41425 
Train step: 2350 acc:0.91875 total_loss: 0.43247  loss:0.54068,stance loss: 0.48873 
Train step: 2360 acc:0.92083 total_loss: 0.42213  loss:0.27973,stance loss: 0.15546 
Train step: 2370 acc:0.90625 total_loss: 0.48795  loss:0.44882,stance loss: 0.32877 
Train step: 2380 acc:0.90625 total_loss: 0.4753  loss:0.33191,stance loss: 0.28972 
Train step: 2390 acc:0.90521 total_loss: 0.47266  loss:0.6227,stance loss: 0.50346 
Train step: 2400 acc:0.90893 total_loss: 0.47124  loss:0.44523,stance loss: 0.35239 
Train step: 2410 acc:0.90625 total_loss: 0.47052  loss:0.14053,stance loss: 0.041846 
Train step: 2420 acc:0.91042 total_loss: 0.46689  loss:0.21796,stance loss: 0.15985 
Train step: 2430 acc:0.90812 total_loss: 0.46851  loss:0.64534,stance loss: 0.47567 
Train step: 2440 acc:0.90398 total_loss: 0.48617  loss:1.3716,stance loss: 1.7443 
Train step: 2450 acc:0.90156 total_loss: 0.48432  loss:0.53677,stance loss: 0.35975 
Train step: 2460 acc:0.90192 total_loss: 0.48223  loss:0.87141,stance loss: 0.81188 
Train step: 2470 acc:0.90268 total_loss: 0.47944  loss:0.58988,stance loss: 0.44996 
Train step: 2480 acc:0.90042 total_loss: 0.47847  loss:0.23304,stance loss: 0.20088 
Train step: 2490 acc:0.90195 total_loss: 0.47818  loss:0.2753,stance loss: 0.23338 
Train step: 2500 acc:0.90184 total_loss: 0.4796  loss:0.23467,stance loss: 0.16702 
Train step: 2510 acc:0.90139 total_loss: 0.48149  loss:0.31981,stance loss: 0.28354 
Train step: 2520 acc:0.89934 total_loss: 0.49289  loss:1.1538,stance loss: 1.3767 
Train step: 2530 acc:0.89844 total_loss: 0.49853  loss:0.85769,stance loss: 0.64682 
Train step: 2540 acc:0.89821 total_loss: 0.49923  loss:0.88226,stance loss: 0.79897 
Train step: 2550 acc:0.9 total_loss: 0.492  loss:0.30896,stance loss: 0.22177 
Train step: 2560 acc:0.90054 total_loss: 0.49568  loss:0.64533,stance loss: 0.49082 
Train step: 2570 acc:0.8987 total_loss: 0.49945  loss:0.56728,stance loss: 0.43589 
Train step: 2580 acc:0.8965 total_loss: 0.50299  loss:0.44281,stance loss: 0.39105 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:1.0 total_loss: 0.61295  loss:0.61295,stance loss: 1.0177 
Train step: 2600 acc:0.91477 total_loss: 0.45754  loss:0.70663,stance loss: 1.0834 
Train step: 2610 acc:0.91964 total_loss: 0.47644  loss:0.11238,stance loss: 0.032938 
Train step: 2620 acc:0.93347 total_loss: 0.44578  loss:0.37799,stance loss: 0.30495 
Train step: 2630 acc:0.92988 total_loss: 0.42993  loss:0.62951,stance loss: 1.0583 
Train step: 2640 acc:0.92525 total_loss: 0.41806  loss:0.11487,stance loss: 0.050503 
Better F1! Saving model!
Saving model of best f1: 0.5266209776145506
              precision    recall  f1-score   support

           0   0.711656  0.750000  0.730325       464
           1   0.477273  0.579310  0.523364       145
           2   0.455882  0.250000  0.322917       124

    accuracy                       0.631651       733
   macro avg   0.548271  0.526437  0.525535       733
weighted avg   0.622023  0.631651  0.620464       733

Test Acc: 0.6316507503410641 F1_ma:0.5266209776145506
Train step: 2650 acc:0.92418 total_loss: 0.41455  loss:0.30315,stance loss: 0.21462 
Train step: 2660 acc:0.91637 total_loss: 0.43809  loss:0.37944,stance loss: 0.31524 
Train step: 2670 acc:0.91435 total_loss: 0.45516  loss:0.5537,stance loss: 0.46067 
Better F1! Saving model!
Saving model of best f1: 0.5310436689747035
              precision    recall  f1-score   support

           0   0.711359  0.823276  0.763237       464
           1   0.520548  0.524138  0.522337       145
           2   0.520000  0.209677  0.298851       124

    accuracy                       0.660300       733
   macro avg   0.583969  0.519030  0.528141       733
weighted avg   0.641242  0.660300  0.637023       733

Test Acc: 0.660300136425648 F1_ma:0.5310436689747035
Train step: 2680 acc:0.91277 total_loss: 0.4601  loss:0.61792,stance loss: 0.55752 
Train step: 2690 acc:0.91522 total_loss: 0.45648  loss:0.17273,stance loss: 0.12116 
Train step: 2700 acc:0.91554 total_loss: 0.45211  loss:0.24023,stance loss: 0.17234 
Train step: 2710 acc:0.91684 total_loss: 0.44361  loss:0.15167,stance loss: 0.10771 
Train step: 2720 acc:0.91651 total_loss: 0.44075  loss:0.33164,stance loss: 0.30578 
Train step: 2730 acc:0.91933 total_loss: 0.43392  loss:0.57479,stance loss: 1.0271 
Train step: 2740 acc:0.9197 total_loss: 0.42384  loss:0.15747,stance loss: 0.066444 
Train step: 2750 acc:0.92003 total_loss: 0.4168  loss:0.17524,stance loss: 0.13394 
Train step: 2760 acc:0.91996 total_loss: 0.42337  loss:0.72833,stance loss: 1.032 
Train step: 2770 acc:0.92023 total_loss: 0.43229  loss:0.46783,stance loss: 0.47631 
Train step: 2780 acc:0.92016 total_loss: 0.43488  loss:0.81968,stance loss: 0.77003 
Train step: 2790 acc:0.9204 total_loss: 0.43278  loss:0.090605,stance loss: 0.050853 
Train step: 2800 acc:0.9215 total_loss: 0.4308  loss:0.27654,stance loss: 0.068199 
Train step: 2810 acc:0.92308 total_loss: 0.42276  loss:0.16846,stance loss: 0.079191 
Train step: 2820 acc:0.92262 total_loss: 0.42177  loss:0.31377,stance loss: 0.28003 
Train step: 2830 acc:0.92142 total_loss: 0.42002  loss:0.069627,stance loss: 0.040377 
Train step: 2840 acc:0.92181 total_loss: 0.41847  loss:0.26515,stance loss: 0.28538 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.96875 total_loss: 0.58613  loss:1.1096,stance loss: 1.5186 
Train step: 2860 acc:0.94792 total_loss: 0.39062  loss:0.20676,stance loss: 0.15688 
Train step: 2870 acc:0.9517 total_loss: 0.34385  loss:0.31256,stance loss: 0.29964 
Train step: 2880 acc:0.94727 total_loss: 0.35553  loss:0.2535,stance loss: 0.22967 
Train step: 2890 acc:0.94345 total_loss: 0.36258  loss:0.21829,stance loss: 0.073185 
Train step: 2900 acc:0.94471 total_loss: 0.33882  loss:0.24901,stance loss: 0.25855 
Train step: 2910 acc:0.94355 total_loss: 0.34719  loss:0.090908,stance loss: 0.05348 
Train step: 2920 acc:0.94444 total_loss: 0.35315  loss:0.42635,stance loss: 0.29087 
Train step: 2930 acc:0.94284 total_loss: 0.36323  loss:0.11684,stance loss: 0.07622 
Train step: 2940 acc:0.94293 total_loss: 0.35963  loss:0.2944,stance loss: 0.36126 
Train step: 2950 acc:0.94424 total_loss: 0.36289  loss:0.60014,stance loss: 1.0304 
Train step: 2960 acc:0.94252 total_loss: 0.36333  loss:0.50943,stance loss: 0.39174 
Train step: 2970 acc:0.94211 total_loss: 0.36432  loss:0.74696,stance loss: 1.1617 
Train step: 2980 acc:0.93892 total_loss: 0.37753  loss:0.54768,stance loss: 0.48558 
Train step: 2990 acc:0.93706 total_loss: 0.38118  loss:0.29191,stance loss: 0.21898 
Train step: 3000 acc:0.9375 total_loss: 0.37967  loss:0.17494,stance loss: 0.13703 
Train step: 3010 acc:0.9375 total_loss: 0.37901  loss:0.27735,stance loss: 0.15501 
Train step: 3020 acc:0.93895 total_loss: 0.37094  loss:0.17292,stance loss: 0.092338 
Train step: 3030 acc:0.93922 total_loss: 0.36517  loss:0.50568,stance loss: 0.32184 
Train step: 3040 acc:0.93815 total_loss: 0.36765  loss:0.3615,stance loss: 0.42035 
Train step: 3050 acc:0.93781 total_loss: 0.36446  loss:0.4898,stance loss: 0.331 
Train step: 3060 acc:0.93691 total_loss: 0.368  loss:0.2351,stance loss: 0.092728 
Train step: 3070 acc:0.93666 total_loss: 0.36784  loss:0.49052,stance loss: 0.35815 
Train step: 3080 acc:0.93696 total_loss: 0.3627  loss:0.41476,stance loss: 0.25843 
Train step: 3090 acc:0.93724 total_loss: 0.36158  loss:0.20842,stance loss: 0.20387 
Train step: 3100 acc:0.93849 total_loss: 0.35779  loss:0.28778,stance loss: 0.2329 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.97917 total_loss: 0.27833  loss:0.026746,stance loss: 0.0018623 
Train step: 3120 acc:0.96635 total_loss: 0.2472  loss:0.6484,stance loss: 1.0879 
Train step: 3130 acc:0.97011 total_loss: 0.21394  loss:0.047322,stance loss: 0.012892 
Train step: 3140 acc:0.9697 total_loss: 0.20466  loss:0.18315,stance loss: 0.077256 
Train step: 3150 acc:0.96948 total_loss: 0.20465  loss:0.15714,stance loss: 0.12656 
Train step: 3160 acc:0.96816 total_loss: 0.20457  loss:0.061973,stance loss: 0.010253 
Train step: 3170 acc:0.96329 total_loss: 0.23131  loss:0.10306,stance loss: 0.077279 
Train step: 3180 acc:0.96318 total_loss: 0.22299  loss:0.14289,stance loss: 0.033471 
Train step: 3190 acc:0.9616 total_loss: 0.22945  loss:0.099041,stance loss: 0.046943 
Train step: 3200 acc:0.96102 total_loss: 0.23557  loss:0.2438,stance loss: 0.23669 
Train step: 3210 acc:0.95813 total_loss: 0.24638  loss:0.42485,stance loss: 0.38112 
Train step: 3220 acc:0.95907 total_loss: 0.24741  loss:0.10107,stance loss: 0.07305 
Train step: 3230 acc:0.9563 total_loss: 0.25786  loss:0.14358,stance loss: 0.04891 
Train step: 3240 acc:0.9563 total_loss: 0.25353  loss:0.17927,stance loss: 0.12837 
Train step: 3250 acc:0.95717 total_loss: 0.24846  loss:0.28772,stance loss: 0.20304 
Train step: 3260 acc:0.9567 total_loss: 0.25544  loss:0.98817,stance loss: 1.3362 
Train step: 3270 acc:0.95629 total_loss: 0.25779  loss:0.43339,stance loss: 0.3244 
Train step: 3280 acc:0.95592 total_loss: 0.26875  loss:0.98722,stance loss: 1.2711 
Train step: 3290 acc:0.95492 total_loss: 0.2702  loss:0.62352,stance loss: 0.45779 
Train step: 3300 acc:0.95369 total_loss: 0.26971  loss:0.23105,stance loss: 0.1172 
Train step: 3310 acc:0.95228 total_loss: 0.27297  loss:0.60945,stance loss: 0.54586 
Train step: 3320 acc:0.95217 total_loss: 0.27575  loss:0.59647,stance loss: 0.57903 
Train step: 3330 acc:0.95123 total_loss: 0.28293  loss:0.11205,stance loss: 0.069681 
Train step: 3340 acc:0.95118 total_loss: 0.28465  loss:0.22268,stance loss: 0.20413 
Train step: 3350 acc:0.9501 total_loss: 0.2834  loss:0.34939,stance loss: 0.32587 
Train step: 3360 acc:0.95109 total_loss: 0.28036  loss:0.077314,stance loss: 0.0391 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.95312 total_loss: 0.36705  loss:0.30555,stance loss: 0.24155 
Train step: 3380 acc:0.96875 total_loss: 0.26098  loss:0.10927,stance loss: 0.051152 
Train step: 3390 acc:0.96875 total_loss: 0.2471  loss:0.044855,stance loss: 0.016324 
Train step: 3400 acc:0.97059 total_loss: 0.21916  loss:0.058582,stance loss: 0.017173 
Train step: 3410 acc:0.97017 total_loss: 0.22008  loss:0.28766,stance loss: 0.22591 
Train step: 3420 acc:0.97338 total_loss: 0.22078  loss:0.53604,stance loss: 1.013 
Train step: 3430 acc:0.96875 total_loss: 0.22738  loss:0.030326,stance loss: 0.0027803 
Train step: 3440 acc:0.96959 total_loss: 0.23853  loss:0.033959,stance loss: 0.0060385 
Train step: 3450 acc:0.96726 total_loss: 0.23989  loss:0.28174,stance loss: 0.23265 
Train step: 3460 acc:0.96676 total_loss: 0.23977  loss:0.056092,stance loss: 0.01658 
Train step: 3470 acc:0.96575 total_loss: 0.23635  loss:0.037449,stance loss: 0.011523 
Train step: 3480 acc:0.96601 total_loss: 0.22864  loss:0.15554,stance loss: 0.064828 
Train step: 3490 acc:0.96673 total_loss: 0.22747  loss:0.031517,stance loss: 0.0085614 
Train step: 3500 acc:0.96455 total_loss: 0.2311  loss:0.16197,stance loss: 0.072903 
Train step: 3510 acc:0.96398 total_loss: 0.23156  loss:0.096061,stance loss: 0.039036 
Train step: 3520 acc:0.96591 total_loss: 0.22734  loss:0.12805,stance loss: 0.063833 
Train step: 3530 acc:0.96646 total_loss: 0.22207  loss:0.41362,stance loss: 0.37859 
Train step: 3540 acc:0.96588 total_loss: 0.22218  loss:0.054818,stance loss: 0.0049812 
Train step: 3550 acc:0.96637 total_loss: 0.21737  loss:0.055257,stance loss: 0.035826 
Train step: 3560 acc:0.96617 total_loss: 0.21693  loss:0.077644,stance loss: 0.067169 
Train step: 3570 acc:0.96538 total_loss: 0.21918  loss:0.096014,stance loss: 0.072099 
Train step: 3580 acc:0.96641 total_loss: 0.21712  loss:0.052693,stance loss: 0.0089053 
Train step: 3590 acc:0.9668 total_loss: 0.21665  loss:0.36711,stance loss: 0.30989 
Train step: 3600 acc:0.96715 total_loss: 0.21529  loss:0.1038,stance loss: 0.06621 
Train step: 3610 acc:0.96798 total_loss: 0.21312  loss:0.096016,stance loss: 0.053358 
Train step: 3620 acc:0.96727 total_loss: 0.21661  loss:0.3625,stance loss: 0.090891 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9875 total_loss: 0.15802  loss:0.48529,stance loss: 0.36691 
Train step: 3640 acc:0.95 total_loss: 0.24281  loss:0.023686,stance loss: 0.0028827 
Train step: 3650 acc:0.9625 total_loss: 0.21018  loss:0.032041,stance loss: 0.0060095 
Train step: 3660 acc:0.95893 total_loss: 0.21373  loss:0.86091,stance loss: 1.1401 
Train step: 3670 acc:0.9625 total_loss: 0.20522  loss:0.03843,stance loss: 0.0078903 
Train step: 3680 acc:0.96136 total_loss: 0.20505  loss:0.077328,stance loss: 0.014416 
Train step: 3690 acc:0.96346 total_loss: 0.21162  loss:0.02215,stance loss: 0.0045053 
Train step: 3700 acc:0.96 total_loss: 0.21193  loss:0.075021,stance loss: 0.01784 
Train step: 3710 acc:0.95882 total_loss: 0.20793  loss:0.16185,stance loss: 0.069187 
Train step: 3720 acc:0.96053 total_loss: 0.20646  loss:0.047499,stance loss: 0.0037942 
Train step: 3730 acc:0.96131 total_loss: 0.20169  loss:0.080783,stance loss: 0.020306 
Train step: 3740 acc:0.9625 total_loss: 0.1943  loss:0.021117,stance loss: 0.0030087 
Train step: 3750 acc:0.9635 total_loss: 0.19271  loss:0.031108,stance loss: 0.0069977 
Train step: 3760 acc:0.96389 total_loss: 0.19228  loss:0.59454,stance loss: 1.0421 
Train step: 3770 acc:0.96379 total_loss: 0.19336  loss:0.048277,stance loss: 0.0057618 
Train step: 3780 acc:0.96492 total_loss: 0.19114  loss:0.091348,stance loss: 0.041932 
Train step: 3790 acc:0.96477 total_loss: 0.19385  loss:0.070457,stance loss: 0.014601 
Train step: 3800 acc:0.96607 total_loss: 0.19217  loss:0.25247,stance loss: 0.19517 
Train step: 3810 acc:0.96419 total_loss: 0.1971  loss:0.11533,stance loss: 0.062978 
Train step: 3820 acc:0.9641 total_loss: 0.19882  loss:0.074971,stance loss: 0.049482 
Train step: 3830 acc:0.96555 total_loss: 0.19694  loss:0.085699,stance loss: 0.069494 
Train step: 3840 acc:0.96453 total_loss: 0.1984  loss:0.038271,stance loss: 0.02381 
Train step: 3850 acc:0.96472 total_loss: 0.19626  loss:0.026747,stance loss: 0.0046236 
Train step: 3860 acc:0.96463 total_loss: 0.19347  loss:0.20716,stance loss: 0.12016 
Train step: 3870 acc:0.96531 total_loss: 0.19323  loss:0.26693,stance loss: 0.24301 
Train step: 3880 acc:0.96544 total_loss: 0.19382  loss:0.064701,stance loss: 0.011213 
Training finished.


Reload the best model with best f1 0.5310436689747035 from path test_outputs/bert-cross-topic/a/2023-08-14 15-00-03/state_dict


              precision    recall  f1-score   support

           0   0.711359  0.823276  0.763237       464
           1   0.520548  0.524138  0.522337       145
           2   0.520000  0.209677  0.298851       124

    accuracy                       0.660300       733
   macro avg   0.583969  0.519030  0.528141       733
weighted avg   0.641242  0.660300  0.637023       733

Test Acc: 0.660300136425648 F1_ma:0.5310436689747035
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5310436689747035
acc: 0.660300136425648, f1 :0.5281413692362857
classification report: 
              precision    recall  f1-score   support

         Con     0.7114    0.8233    0.7632       464
        None     0.5205    0.5241    0.5223       145
         Pro     0.5200    0.2097    0.2989       124

    accuracy                         0.6603       733
   macro avg     0.5840    0.5190    0.5281       733
weighted avg     0.6412    0.6603    0.6370       733

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 15-19-57', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 15-19-57
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.6664  loss:1.6664,stance loss: 1.0588 
Train step: 10 acc:0.38068 total_loss: 1.6835  loss:1.7719,stance loss: 1.2943 
Better F1! Saving model!
Saving model of best f1: 0.3819139596136963
              precision    recall  f1-score   support

           0   0.644444  0.937500  0.763828       464
           1   0.413793  0.165517  0.236453       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.626194       733
   macro avg   0.352746  0.367672  0.333427       733
weighted avg   0.489798  0.626194  0.530289       733

Test Acc: 0.626193724420191 F1_ma:0.3819139596136963
Train step: 20 acc:0.42857 total_loss: 1.6729  loss:1.5114,stance loss: 1.1119 
Better F1! Saving model!
Saving model of best f1: 0.38494809688581316
              precision    recall  f1-score   support

           0   0.643064  0.959052  0.769896       464
           1   0.487805  0.137931  0.215054       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.634379       733
   macro avg   0.376956  0.365661  0.328317       733
weighted avg   0.503565  0.634379  0.529897       733

Test Acc: 0.6343792633015006 F1_ma:0.38494809688581316
Train step: 30 acc:0.4496 total_loss: 1.6572  loss:1.5443,stance loss: 1.1099 
Train step: 40 acc:0.46189 total_loss: 1.6418  loss:1.5509,stance loss: 1.1001 
Train step: 50 acc:0.47672 total_loss: 1.6292  loss:1.5344,stance loss: 0.96902 
Better F1! Saving model!
Saving model of best f1: 0.38538812785388127
              precision    recall  f1-score   support

           0   0.668780  0.909483  0.770776       464
           1   0.549020  0.386207  0.453441       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.652115       733
   macro avg   0.405933  0.431897  0.408073       733
weighted avg   0.531953  0.652115  0.577611       733

Test Acc: 0.6521145975443383 F1_ma:0.38538812785388127
Train step: 60 acc:0.48053 total_loss: 1.642  loss:1.6067,stance loss: 1.0872 
Train step: 70 acc:0.48415 total_loss: 1.6307  loss:1.4697,stance loss: 0.94636 
Train step: 80 acc:0.48997 total_loss: 1.6199  loss:1.6193,stance loss: 1.137 
Train step: 90 acc:0.49794 total_loss: 1.6171  loss:1.6044,stance loss: 1.0892 
Train step: 100 acc:0.50248 total_loss: 1.6059  loss:1.5986,stance loss: 1.132 
Train step: 110 acc:0.50676 total_loss: 1.5964  loss:1.2591,stance loss: 0.75635 
Train step: 120 acc:0.5124 total_loss: 1.5831  loss:1.4726,stance loss: 1.0526 
Train step: 130 acc:0.51479 total_loss: 1.5833  loss:1.6614,stance loss: 1.5447 
Train step: 140 acc:0.51241 total_loss: 1.5864  loss:1.5936,stance loss: 1.588 
Better F1! Saving model!
Saving model of best f1: 0.38744769874476986
              precision    recall  f1-score   support

           0   0.633379  0.997845  0.774895       464
           1   0.500000  0.006897  0.013605       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.377793  0.334914  0.262834       733
weighted avg   0.499847  0.633015  0.493212       733

Test Acc: 0.6330150068212824 F1_ma:0.38744769874476986
Train step: 150 acc:0.51656 total_loss: 1.5806  loss:1.5396,stance loss: 1.1426 
Train step: 160 acc:0.52174 total_loss: 1.5739  loss:1.3731,stance loss: 0.93071 
Train step: 170 acc:0.52339 total_loss: 1.571  loss:1.7138,stance loss: 1.3799 
Train step: 180 acc:0.52762 total_loss: 1.5662  loss:1.3096,stance loss: 0.80243 
Train step: 190 acc:0.52716 total_loss: 1.567  loss:1.9176,stance loss: 1.848 
Train step: 200 acc:0.52923 total_loss: 1.5619  loss:1.2225,stance loss: 0.83862 
Train step: 210 acc:0.52962 total_loss: 1.5558  loss:1.379,stance loss: 0.96782 
Train step: 220 acc:0.52913 total_loss: 1.5524  loss:1.6946,stance loss: 1.1257 
Train step: 230 acc:0.5303 total_loss: 1.5486  loss:1.6775,stance loss: 1.3536 
Train step: 240 acc:0.5319 total_loss: 1.5455  loss:1.497,stance loss: 1.1669 
Train step: 250 acc:0.53212 total_loss: 1.5431  loss:1.6376,stance loss: 1.159 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5 total_loss: 1.4964  loss:1.2196,stance loss: 0.82444 
Train step: 270 acc:0.52083 total_loss: 1.5163  loss:1.3759,stance loss: 0.85408 
Train step: 280 acc:0.55398 total_loss: 1.4773  loss:1.4673,stance loss: 1.2683 
Train step: 290 acc:0.56641 total_loss: 1.4508  loss:1.3532,stance loss: 0.87097 
Train step: 300 acc:0.57738 total_loss: 1.4404  loss:1.4418,stance loss: 1.1001 
Train step: 310 acc:0.58173 total_loss: 1.4372  loss:1.4179,stance loss: 1.0475 
Train step: 320 acc:0.58669 total_loss: 1.4446  loss:1.3612,stance loss: 1.3737 
Train step: 330 acc:0.59809 total_loss: 1.4283  loss:1.3656,stance loss: 0.89953 
Train step: 340 acc:0.59604 total_loss: 1.4343  loss:1.377,stance loss: 0.90626 
Train step: 350 acc:0.60122 total_loss: 1.4187  loss:1.2776,stance loss: 0.82153 
Train step: 360 acc:0.60478 total_loss: 1.4138  loss:1.6306,stance loss: 1.7113 
Train step: 370 acc:0.60714 total_loss: 1.4147  loss:1.7614,stance loss: 1.3243 
Train step: 380 acc:0.60861 total_loss: 1.4085  loss:1.1877,stance loss: 0.87342 
Train step: 390 acc:0.60795 total_loss: 1.4022  loss:1.3677,stance loss: 1.1105 
Train step: 400 acc:0.6096 total_loss: 1.3916  loss:0.8464,stance loss: 0.45275 
Train step: 410 acc:0.61061 total_loss: 1.39  loss:1.2781,stance loss: 0.90187 
Train step: 420 acc:0.61767 total_loss: 1.3758  loss:1.1083,stance loss: 0.80023 
Train step: 430 acc:0.6181 total_loss: 1.3743  loss:1.3445,stance loss: 1.3951 
Train step: 440 acc:0.62157 total_loss: 1.3698  loss:0.99747,stance loss: 0.77958 
Train step: 450 acc:0.625 total_loss: 1.3665  loss:1.1823,stance loss: 0.96495 
Train step: 460 acc:0.62438 total_loss: 1.3645  loss:1.2611,stance loss: 0.95039 
Train step: 470 acc:0.62441 total_loss: 1.3609  loss:1.248,stance loss: 1.0017 
Train step: 480 acc:0.62416 total_loss: 1.3606  loss:0.83546,stance loss: 0.3952 
Train step: 490 acc:0.62419 total_loss: 1.3572  loss:1.0064,stance loss: 0.6565 
Train step: 500 acc:0.62526 total_loss: 1.356  loss:1.1568,stance loss: 0.81997 
Train step: 510 acc:0.62649 total_loss: 1.354  loss:1.4358,stance loss: 1.2611 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.72917 total_loss: 1.2048  loss:1.1949,stance loss: 0.91967 
Train step: 530 acc:0.70673 total_loss: 1.1977  loss:1.3758,stance loss: 1.087 
Train step: 540 acc:0.7038 total_loss: 1.1891  loss:0.74131,stance loss: 0.47708 
Train step: 550 acc:0.69318 total_loss: 1.1844  loss:1.1901,stance loss: 1.0329 
Train step: 560 acc:0.68169 total_loss: 1.2115  loss:1.2817,stance loss: 0.99716 
Train step: 570 acc:0.67571 total_loss: 1.2343  loss:1.1411,stance loss: 0.88441 
Train step: 580 acc:0.67956 total_loss: 1.2184  loss:1.3426,stance loss: 1.0781 
Train step: 590 acc:0.67295 total_loss: 1.2285  loss:1.4248,stance loss: 1.0597 
Train step: 600 acc:0.66867 total_loss: 1.2352  loss:1.6077,stance loss: 1.5013 
Train step: 610 acc:0.66801 total_loss: 1.236  loss:1.2193,stance loss: 0.80838 
Train step: 620 acc:0.67051 total_loss: 1.2414  loss:1.3203,stance loss: 1.4593 
Train step: 630 acc:0.6698 total_loss: 1.2427  loss:1.0568,stance loss: 0.73882 
Train step: 640 acc:0.66921 total_loss: 1.2402  loss:1.6357,stance loss: 1.3589 
Train step: 650 acc:0.67246 total_loss: 1.2386  loss:1.0124,stance loss: 0.75058 
Train step: 660 acc:0.67002 total_loss: 1.2376  loss:1.4253,stance loss: 1.1161 
Train step: 670 acc:0.6732 total_loss: 1.233  loss:1.0952,stance loss: 0.88204 
Train step: 680 acc:0.67025 total_loss: 1.2397  loss:1.4109,stance loss: 1.6527 
Train step: 690 acc:0.67197 total_loss: 1.2356  loss:1.4424,stance loss: 1.2407 
Train step: 700 acc:0.6735 total_loss: 1.2365  loss:1.2531,stance loss: 1.0207 
Train step: 710 acc:0.67746 total_loss: 1.2293  loss:0.60197,stance loss: 0.35685 
Train step: 720 acc:0.67888 total_loss: 1.2292  loss:1.2176,stance loss: 0.94082 
Train step: 730 acc:0.67958 total_loss: 1.2272  loss:1.1697,stance loss: 0.90696 
Train step: 740 acc:0.68105 total_loss: 1.2238  loss:0.85284,stance loss: 0.61235 
Train step: 750 acc:0.68294 total_loss: 1.2195  loss:0.97473,stance loss: 0.56665 
Train step: 760 acc:0.68081 total_loss: 1.2228  loss:0.93774,stance loss: 0.66213 
Train step: 770 acc:0.67885 total_loss: 1.226  loss:1.1199,stance loss: 0.77294 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.76562 total_loss: 0.93636  loss:0.98437,stance loss: 0.8296 
Train step: 790 acc:0.72321 total_loss: 1.1233  loss:1.034,stance loss: 0.874 
Train step: 800 acc:0.73177 total_loss: 1.1123  loss:1.1957,stance loss: 0.97214 
Train step: 810 acc:0.71507 total_loss: 1.1242  loss:1.4916,stance loss: 1.2668 
Train step: 820 acc:0.70028 total_loss: 1.1563  loss:1.0618,stance loss: 0.85935 
Train step: 830 acc:0.69444 total_loss: 1.156  loss:1.0986,stance loss: 0.91663 
Train step: 840 acc:0.69336 total_loss: 1.1538  loss:1.0185,stance loss: 0.78083 
Train step: 850 acc:0.69257 total_loss: 1.1595  loss:1.2702,stance loss: 0.85635 
Train step: 860 acc:0.69048 total_loss: 1.1728  loss:1.2558,stance loss: 1.1408 
Train step: 870 acc:0.69215 total_loss: 1.1699  loss:0.75134,stance loss: 0.44115 
Train step: 880 acc:0.6845 total_loss: 1.1775  loss:1.5983,stance loss: 1.07 
Train step: 890 acc:0.68476 total_loss: 1.1698  loss:0.96469,stance loss: 0.56877 
Train step: 900 acc:0.68548 total_loss: 1.1621  loss:0.81499,stance loss: 0.55474 
Train step: 910 acc:0.6861 total_loss: 1.1589  loss:0.77275,stance loss: 0.5077 
Train step: 920 acc:0.68576 total_loss: 1.1597  loss:1.5345,stance loss: 1.6474 
Train step: 930 acc:0.68466 total_loss: 1.1635  loss:1.3005,stance loss: 1.0591 
Train step: 940 acc:0.68521 total_loss: 1.1556  loss:1.2029,stance loss: 0.94222 
Train step: 950 acc:0.68714 total_loss: 1.156  loss:0.82695,stance loss: 0.66345 
Train step: 960 acc:0.68173 total_loss: 1.1617  loss:1.1864,stance loss: 0.9379 
Train step: 970 acc:0.68492 total_loss: 1.1614  loss:1.1397,stance loss: 0.97411 
Train step: 980 acc:0.68689 total_loss: 1.1581  loss:1.1744,stance loss: 0.85844 
Train step: 990 acc:0.68838 total_loss: 1.1593  loss:1.3315,stance loss: 1.2407 
Train step: 1000 acc:0.68834 total_loss: 1.1647  loss:0.94546,stance loss: 0.63355 
Train step: 1010 acc:0.68697 total_loss: 1.1639  loss:1.3128,stance loss: 1.0042 
Train step: 1020 acc:0.68622 total_loss: 1.1679  loss:1.1288,stance loss: 0.8447 
Train step: 1030 acc:0.68676 total_loss: 1.1649  loss:1.1007,stance loss: 0.8283 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.75 total_loss: 0.9153  loss:0.9373,stance loss: 0.69234 
Train step: 1050 acc:0.725 total_loss: 0.98798  loss:0.88892,stance loss: 0.68114 
Train step: 1060 acc:0.745 total_loss: 0.98706  loss:0.65091,stance loss: 0.47257 
Train step: 1070 acc:0.73393 total_loss: 1.0289  loss:0.66693,stance loss: 0.41601 
Train step: 1080 acc:0.73056 total_loss: 1.0465  loss:1.0536,stance loss: 0.95433 
Train step: 1090 acc:0.72386 total_loss: 1.0783  loss:0.90773,stance loss: 0.68662 
Train step: 1100 acc:0.725 total_loss: 1.0883  loss:0.85183,stance loss: 0.6541 
Train step: 1110 acc:0.715 total_loss: 1.0949  loss:1.3153,stance loss: 0.92767 
Train step: 1120 acc:0.71691 total_loss: 1.0947  loss:1.1243,stance loss: 0.86854 
Train step: 1130 acc:0.71447 total_loss: 1.0887  loss:1.0062,stance loss: 0.46104 
Train step: 1140 acc:0.71131 total_loss: 1.0939  loss:0.9371,stance loss: 0.72223 
Train step: 1150 acc:0.71304 total_loss: 1.0842  loss:0.74887,stance loss: 0.60462 
Train step: 1160 acc:0.7145 total_loss: 1.0758  loss:0.84027,stance loss: 0.69685 
Train step: 1170 acc:0.71528 total_loss: 1.0739  loss:0.68503,stance loss: 0.50422 
Train step: 1180 acc:0.72026 total_loss: 1.071  loss:0.70041,stance loss: 0.5839 
Train step: 1190 acc:0.72137 total_loss: 1.0691  loss:1.0422,stance loss: 0.7563 
Train step: 1200 acc:0.72008 total_loss: 1.071  loss:1.618,stance loss: 1.2868 
Train step: 1210 acc:0.71679 total_loss: 1.073  loss:0.94869,stance loss: 0.77111 
Train step: 1220 acc:0.71419 total_loss: 1.0741  loss:1.0134,stance loss: 0.82826 
Train step: 1230 acc:0.71635 total_loss: 1.0766  loss:1.042,stance loss: 0.80532 
Train step: 1240 acc:0.71402 total_loss: 1.081  loss:1.4964,stance loss: 1.6689 
Train step: 1250 acc:0.71512 total_loss: 1.0815  loss:1.3637,stance loss: 1.5973 
Train step: 1260 acc:0.71722 total_loss: 1.0802  loss:0.92436,stance loss: 0.66807 
Train step: 1270 acc:0.71543 total_loss: 1.083  loss:0.95456,stance loss: 0.70608 
Train step: 1280 acc:0.71327 total_loss: 1.0848  loss:1.1656,stance loss: 0.85974 
Train step: 1290 acc:0.71373 total_loss: 1.0823  loss:1.0009,stance loss: 0.85739 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.76042 total_loss: 0.87446  loss:0.93357,stance loss: 0.78982 
Train step: 1310 acc:0.72656 total_loss: 0.96172  loss:1.2006,stance loss: 1.0063 
Train step: 1320 acc:0.72356 total_loss: 0.97871  loss:0.6432,stance loss: 0.43721 
Train step: 1330 acc:0.73264 total_loss: 0.96511  loss:0.6673,stance loss: 0.52739 
Train step: 1340 acc:0.73234 total_loss: 0.95978  loss:1.3629,stance loss: 1.0859 
Train step: 1350 acc:0.72768 total_loss: 0.97799  loss:1.4158,stance loss: 1.5558 
Train step: 1360 acc:0.72348 total_loss: 1.0004  loss:1.3798,stance loss: 1.4594 
Train step: 1370 acc:0.72286 total_loss: 0.99936  loss:1.0543,stance loss: 0.80387 
Train step: 1380 acc:0.72456 total_loss: 0.99719  loss:0.68154,stance loss: 0.58428 
Train step: 1390 acc:0.72786 total_loss: 0.9885  loss:0.82062,stance loss: 0.63066 
Train step: 1400 acc:0.72465 total_loss: 0.98977  loss:0.83586,stance loss: 0.58821 
Train step: 1410 acc:0.73006 total_loss: 0.98269  loss:0.85313,stance loss: 0.68402 
Train step: 1420 acc:0.72768 total_loss: 0.99047  loss:1.3265,stance loss: 0.98893 
Train step: 1430 acc:0.72656 total_loss: 0.99158  loss:1.1824,stance loss: 0.87169 
Train step: 1440 acc:0.72817 total_loss: 0.98822  loss:0.84764,stance loss: 0.7013 
Train step: 1450 acc:0.72997 total_loss: 0.98314  loss:0.82301,stance loss: 0.58208 
Train step: 1460 acc:0.72967 total_loss: 0.98217  loss:1.1361,stance loss: 0.9225 
Train step: 1470 acc:0.72976 total_loss: 0.97924  loss:0.51797,stance loss: 0.28782 
Train step: 1480 acc:0.7295 total_loss: 0.97829  loss:0.78208,stance loss: 0.63417 
Train step: 1490 acc:0.73151 total_loss: 0.9739  loss:0.76727,stance loss: 0.63883 
Train step: 1500 acc:0.72937 total_loss: 0.98171  loss:0.82799,stance loss: 0.67084 
Train step: 1510 acc:0.7338 total_loss: 0.97609  loss:1.0004,stance loss: 0.87111 
Train step: 1520 acc:0.73258 total_loss: 0.97579  loss:0.72476,stance loss: 0.57469 
Train step: 1530 acc:0.7357 total_loss: 0.97589  loss:0.72166,stance loss: 0.44751 
Train step: 1540 acc:0.73704 total_loss: 0.97689  loss:1.076,stance loss: 1.08 
Train step: 1550 acc:0.73486 total_loss: 0.97905  loss:1.1369,stance loss: 0.86086 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.75 total_loss: 1.0134  loss:0.9306,stance loss: 0.80419 
Train step: 1570 acc:0.70956 total_loss: 1.0615  loss:0.96447,stance loss: 0.68096 
Train step: 1580 acc:0.74306 total_loss: 0.99012  loss:1.1563,stance loss: 1.0339 
Train step: 1590 acc:0.74831 total_loss: 0.95472  loss:0.81006,stance loss: 0.7004 
Train step: 1600 acc:0.74867 total_loss: 0.95317  loss:0.81406,stance loss: 0.57604 
Train step: 1610 acc:0.75548 total_loss: 0.94054  loss:0.74905,stance loss: 0.60639 
Train step: 1620 acc:0.7528 total_loss: 0.95045  loss:1.2582,stance loss: 1.1156 
Train step: 1630 acc:0.75325 total_loss: 0.93361  loss:0.82957,stance loss: 0.55034 
Train step: 1640 acc:0.75718 total_loss: 0.92139  loss:0.52656,stance loss: 0.33721 
Train step: 1650 acc:0.76289 total_loss: 0.91355  loss:1.3459,stance loss: 1.0227 
Train step: 1660 acc:0.76694 total_loss: 0.90535  loss:0.56768,stance loss: 0.4556 
Train step: 1670 acc:0.7687 total_loss: 0.90572  loss:0.75773,stance loss: 0.57205 
Train step: 1680 acc:0.77067 total_loss: 0.89441  loss:0.99264,stance loss: 0.73412 
Train step: 1690 acc:0.76825 total_loss: 0.90186  loss:0.83573,stance loss: 0.65817 
Train step: 1700 acc:0.76573 total_loss: 0.9137  loss:1.099,stance loss: 1.2091 
Train step: 1710 acc:0.76513 total_loss: 0.91322  loss:0.97159,stance loss: 0.95185 
Train step: 1720 acc:0.76198 total_loss: 0.91734  loss:0.79433,stance loss: 0.56055 
Train step: 1730 acc:0.75989 total_loss: 0.91927  loss:1.1247,stance loss: 0.91134 
Train step: 1740 acc:0.75902 total_loss: 0.92486  loss:0.86635,stance loss: 0.66806 
Train step: 1750 acc:0.7592 total_loss: 0.92297  loss:0.66707,stance loss: 0.53434 
Train step: 1760 acc:0.75845 total_loss: 0.92439  loss:0.80722,stance loss: 0.63875 
Train step: 1770 acc:0.76008 total_loss: 0.92271  loss:0.38024,stance loss: 0.24285 
Train step: 1780 acc:0.76156 total_loss: 0.92003  loss:0.74897,stance loss: 0.64696 
Train step: 1790 acc:0.75949 total_loss: 0.9212  loss:0.95472,stance loss: 0.53648 
Train step: 1800 acc:0.75936 total_loss: 0.91603  loss:0.79372,stance loss: 0.56978 
Train step: 1810 acc:0.76216 total_loss: 0.9141  loss:0.92506,stance loss: 0.78671 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.78906 total_loss: 0.91427  loss:1.1938,stance loss: 0.97599 
Train step: 1830 acc:0.76042 total_loss: 0.87513  loss:0.66289,stance loss: 0.54645 
Train step: 1840 acc:0.77679 total_loss: 0.84086  loss:1.1456,stance loss: 0.87668 
Train step: 1850 acc:0.77632 total_loss: 0.82788  loss:1.0069,stance loss: 0.72217 
Train step: 1860 acc:0.78385 total_loss: 0.81476  loss:0.76595,stance loss: 0.60625 
Train step: 1870 acc:0.78556 total_loss: 0.81545  loss:0.52986,stance loss: 0.39048 
Train step: 1880 acc:0.7886 total_loss: 0.80903  loss:0.72477,stance loss: 0.46858 
Train step: 1890 acc:0.78205 total_loss: 0.81984  loss:0.74649,stance loss: 0.51655 
Train step: 1900 acc:0.78054 total_loss: 0.82278  loss:0.77019,stance loss: 0.56078 
Train step: 1910 acc:0.77679 total_loss: 0.83407  loss:1.3525,stance loss: 1.5527 
Train step: 1920 acc:0.77431 total_loss: 0.83138  loss:0.73723,stance loss: 0.55412 
Train step: 1930 acc:0.77701 total_loss: 0.82646  loss:0.92405,stance loss: 0.71743 
Train step: 1940 acc:0.77588 total_loss: 0.83349  loss:0.53313,stance loss: 0.39581 
Train step: 1950 acc:0.77627 total_loss: 0.83087  loss:0.43832,stance loss: 0.24848 
Train step: 1960 acc:0.77703 total_loss: 0.83078  loss:0.98297,stance loss: 1.1025 
Train step: 1970 acc:0.77769 total_loss: 0.83171  loss:0.78191,stance loss: 0.65914 
Train step: 1980 acc:0.77753 total_loss: 0.83829  loss:0.85488,stance loss: 1.0568 
Train step: 1990 acc:0.7809 total_loss: 0.83326  loss:0.90401,stance loss: 0.6113 
Train step: 2000 acc:0.78025 total_loss: 0.83547  loss:0.85081,stance loss: 0.76848 
Train step: 2010 acc:0.77683 total_loss: 0.83803  loss:0.92691,stance loss: 0.73121 
Train step: 2020 acc:0.77644 total_loss: 0.84527  loss:1.3115,stance loss: 1.136 
Train step: 2030 acc:0.78068 total_loss: 0.8396  loss:1.0766,stance loss: 1.3687 
Train step: 2040 acc:0.7807 total_loss: 0.83918  loss:0.98122,stance loss: 0.79451 
Train step: 2050 acc:0.78178 total_loss: 0.83906  loss:0.75475,stance loss: 0.51116 
Train step: 2060 acc:0.781 total_loss: 0.8375  loss:1.0206,stance loss: 0.92315 
Train step: 2070 acc:0.78101 total_loss: 0.83794  loss:1.4175,stance loss: 1.4105 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.82639 total_loss: 0.72883  loss:1.1174,stance loss: 1.3748 
Train step: 2090 acc:0.82566 total_loss: 0.73112  loss:1.006,stance loss: 0.72909 
Train step: 2100 acc:0.82112 total_loss: 0.76267  loss:0.63583,stance loss: 0.52465 
Train step: 2110 acc:0.8125 total_loss: 0.77129  loss:0.57981,stance loss: 0.43315 
Train step: 2120 acc:0.80485 total_loss: 0.78131  loss:1.3902,stance loss: 1.6575 
Train step: 2130 acc:0.80614 total_loss: 0.77183  loss:0.64604,stance loss: 0.57402 
Train step: 2140 acc:0.81431 total_loss: 0.7572  loss:0.58713,stance loss: 0.44538 
Train step: 2150 acc:0.81487 total_loss: 0.75276  loss:0.6556,stance loss: 0.58115 
Train step: 2160 acc:0.82584 total_loss: 0.73643  loss:0.32042,stance loss: 0.17226 
Train step: 2170 acc:0.82386 total_loss: 0.7388  loss:0.53518,stance loss: 0.5139 
Train step: 2180 acc:0.82626 total_loss: 0.72769  loss:0.6812,stance loss: 0.52011 
Train step: 2190 acc:0.82563 total_loss: 0.72935  loss:0.66781,stance loss: 0.70464 
Train step: 2200 acc:0.82074 total_loss: 0.73831  loss:0.84855,stance loss: 0.61514 
Train step: 2210 acc:0.81924 total_loss: 0.74321  loss:1.8207,stance loss: 1.537 
Train step: 2220 acc:0.81669 total_loss: 0.74862  loss:1.0394,stance loss: 1.2082 
Train step: 2230 acc:0.81879 total_loss: 0.74473  loss:1.117,stance loss: 1.3897 
Train step: 2240 acc:0.81916 total_loss: 0.73983  loss:0.91581,stance loss: 0.75834 
Train step: 2250 acc:0.81983 total_loss: 0.73204  loss:0.74,stance loss: 0.47917 
Train step: 2260 acc:0.81845 total_loss: 0.73742  loss:0.56002,stance loss: 0.43882 
Train step: 2270 acc:0.81972 total_loss: 0.73293  loss:0.5737,stance loss: 0.4532 
Train step: 2280 acc:0.81818 total_loss: 0.73498  loss:1.0527,stance loss: 0.82849 
Train step: 2290 acc:0.81792 total_loss: 0.73488  loss:0.67176,stance loss: 0.5081 
Train step: 2300 acc:0.82069 total_loss: 0.72803  loss:0.47461,stance loss: 0.37715 
Train step: 2310 acc:0.82035 total_loss: 0.73211  loss:1.4902,stance loss: 1.2186 
Train step: 2320 acc:0.82078 total_loss: 0.73033  loss:0.65823,stance loss: 0.5742 
Train step: 2330 acc:0.82088 total_loss: 0.73031  loss:1.7336,stance loss: 2.2038 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.86875 total_loss: 0.59346  loss:0.33094,stance loss: 0.17792 
Train step: 2350 acc:0.83437 total_loss: 0.7138  loss:0.90138,stance loss: 0.67917 
Train step: 2360 acc:0.82292 total_loss: 0.71827  loss:0.67261,stance loss: 0.51493 
Train step: 2370 acc:0.8375 total_loss: 0.66567  loss:0.50765,stance loss: 0.41135 
Train step: 2380 acc:0.8375 total_loss: 0.66624  loss:0.50257,stance loss: 0.4328 
Train step: 2390 acc:0.83542 total_loss: 0.67695  loss:0.51005,stance loss: 0.35732 
Train step: 2400 acc:0.84107 total_loss: 0.67217  loss:0.95157,stance loss: 1.0984 
Train step: 2410 acc:0.83828 total_loss: 0.68122  loss:1.5687,stance loss: 1.8454 
Train step: 2420 acc:0.83542 total_loss: 0.69569  loss:0.52007,stance loss: 0.32317 
Train step: 2430 acc:0.83688 total_loss: 0.67861  loss:0.5678,stance loss: 0.40491 
Train step: 2440 acc:0.8392 total_loss: 0.67688  loss:0.56178,stance loss: 0.39402 
Train step: 2450 acc:0.8375 total_loss: 0.67786  loss:1.1079,stance loss: 1.3756 
Train step: 2460 acc:0.84038 total_loss: 0.67088  loss:0.48078,stance loss: 0.35714 
Train step: 2470 acc:0.84375 total_loss: 0.66229  loss:0.30435,stance loss: 0.16257 
Train step: 2480 acc:0.845 total_loss: 0.65638  loss:0.4,stance loss: 0.32541 
Train step: 2490 acc:0.8418 total_loss: 0.66297  loss:0.50684,stance loss: 0.40045 
Train step: 2500 acc:0.84191 total_loss: 0.66378  loss:0.59692,stance loss: 0.42381 
Train step: 2510 acc:0.84132 total_loss: 0.66776  loss:0.61896,stance loss: 0.47052 
Train step: 2520 acc:0.84375 total_loss: 0.6627  loss:0.42057,stance loss: 0.26229 
Train step: 2530 acc:0.84375 total_loss: 0.661  loss:0.48689,stance loss: 0.3352 
Train step: 2540 acc:0.84494 total_loss: 0.654  loss:0.49398,stance loss: 0.40878 
Train step: 2550 acc:0.84489 total_loss: 0.65614  loss:0.59999,stance loss: 0.51162 
Train step: 2560 acc:0.84348 total_loss: 0.65838  loss:0.42433,stance loss: 0.31165 
Train step: 2570 acc:0.84557 total_loss: 0.65187  loss:0.61347,stance loss: 0.5501 
Train step: 2580 acc:0.847 total_loss: 0.64868  loss:0.75915,stance loss: 0.53616 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:1.0 total_loss: 0.19597  loss:0.19597,stance loss: 0.082663 
Train step: 2600 acc:0.88068 total_loss: 0.54077  loss:0.38483,stance loss: 0.31993 
Train step: 2610 acc:0.87798 total_loss: 0.52823  loss:0.51067,stance loss: 0.37906 
Train step: 2620 acc:0.875 total_loss: 0.54704  loss:0.19085,stance loss: 0.087474 
Train step: 2630 acc:0.86738 total_loss: 0.56208  loss:0.53719,stance loss: 0.33274 
Train step: 2640 acc:0.86642 total_loss: 0.56298  loss:0.49202,stance loss: 0.39703 
Train step: 2650 acc:0.8709 total_loss: 0.5631  loss:0.43475,stance loss: 0.38954 
Train step: 2660 acc:0.87236 total_loss: 0.55228  loss:0.87409,stance loss: 0.65505 
Train step: 2670 acc:0.86883 total_loss: 0.56049  loss:0.65603,stance loss: 0.552 
Train step: 2680 acc:0.86745 total_loss: 0.56959  loss:0.15458,stance loss: 0.054593 
Train step: 2690 acc:0.86696 total_loss: 0.57028  loss:0.58147,stance loss: 0.43827 
Train step: 2700 acc:0.86993 total_loss: 0.56641  loss:0.3442,stance loss: 0.29273 
Train step: 2710 acc:0.87138 total_loss: 0.55774  loss:0.25408,stance loss: 0.20602 
Train step: 2720 acc:0.87118 total_loss: 0.55646  loss:0.26729,stance loss: 0.098556 
Train step: 2730 acc:0.8719 total_loss: 0.55611  loss:0.30945,stance loss: 0.27873 
Train step: 2740 acc:0.87045 total_loss: 0.55279  loss:0.45912,stance loss: 0.36354 
Train step: 2750 acc:0.86918 total_loss: 0.55871  loss:0.87596,stance loss: 0.60626 
Train step: 2760 acc:0.86769 total_loss: 0.56336  loss:1.1454,stance loss: 1.4931 
Train step: 2770 acc:0.86809 total_loss: 0.55936  loss:0.67805,stance loss: 0.52796 
Train step: 2780 acc:0.86846 total_loss: 0.56338  loss:0.49129,stance loss: 0.38914 
Train step: 2790 acc:0.86629 total_loss: 0.5757  loss:1.5648,stance loss: 1.7928 
Train step: 2800 acc:0.86937 total_loss: 0.57146  loss:0.28387,stance loss: 0.17947 
Train step: 2810 acc:0.86906 total_loss: 0.57369  loss:0.78915,stance loss: 0.42877 
Train step: 2820 acc:0.86742 total_loss: 0.57692  loss:0.40421,stance loss: 0.30792 
Train step: 2830 acc:0.86748 total_loss: 0.57993  loss:0.3961,stance loss: 0.34782 
Train step: 2840 acc:0.86803 total_loss: 0.58179  loss:0.57493,stance loss: 0.44249 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.8125 total_loss: 0.88012  loss:1.4103,stance loss: 1.6245 
Train step: 2860 acc:0.85417 total_loss: 0.53932  loss:0.48518,stance loss: 0.37747 
Train step: 2870 acc:0.86364 total_loss: 0.57269  loss:0.36656,stance loss: 0.28956 
Train step: 2880 acc:0.87695 total_loss: 0.55085  loss:0.43134,stance loss: 0.34147 
Train step: 2890 acc:0.88244 total_loss: 0.52053  loss:0.61696,stance loss: 0.47925 
Train step: 2900 acc:0.88221 total_loss: 0.54473  loss:0.6793,stance loss: 0.38961 
Train step: 2910 acc:0.8881 total_loss: 0.52536  loss:0.31862,stance loss: 0.21454 
Train step: 2920 acc:0.88802 total_loss: 0.50991  loss:0.19381,stance loss: 0.12239 
Train step: 2930 acc:0.89177 total_loss: 0.48835  loss:0.10451,stance loss: 0.029678 
Train step: 2940 acc:0.89062 total_loss: 0.48241  loss:0.60946,stance loss: 0.45308 
Train step: 2950 acc:0.89093 total_loss: 0.48083  loss:0.7396,stance loss: 0.53792 
Train step: 2960 acc:0.89453 total_loss: 0.47166  loss:0.15655,stance loss: 0.056206 
Train step: 2970 acc:0.89498 total_loss: 0.47185  loss:0.40255,stance loss: 0.31364 
Train step: 2980 acc:0.89347 total_loss: 0.47582  loss:0.75134,stance loss: 0.56659 
Train step: 2990 acc:0.89437 total_loss: 0.47744  loss:0.62529,stance loss: 0.62281 
Train step: 3000 acc:0.89638 total_loss: 0.47513  loss:0.075693,stance loss: 0.017669 
Train step: 3010 acc:0.89468 total_loss: 0.47621  loss:0.32336,stance loss: 0.26314 
Train step: 3020 acc:0.89426 total_loss: 0.47793  loss:0.4706,stance loss: 0.23931 
Train step: 3030 acc:0.89251 total_loss: 0.48821  loss:0.6689,stance loss: 0.74852 
Train step: 3040 acc:0.88965 total_loss: 0.48971  loss:0.74614,stance loss: 0.56505 
Train step: 3050 acc:0.88954 total_loss: 0.4928  loss:0.44937,stance loss: 0.39293 
Train step: 3060 acc:0.88915 total_loss: 0.49853  loss:1.1702,stance loss: 1.5122 
Train step: 3070 acc:0.88767 total_loss: 0.50304  loss:0.6678,stance loss: 0.52068 
Train step: 3080 acc:0.88874 total_loss: 0.50543  loss:0.50698,stance loss: 0.55417 
Train step: 3090 acc:0.88843 total_loss: 0.50813  loss:0.44113,stance loss: 0.29284 
Train step: 3100 acc:0.88864 total_loss: 0.50776  loss:0.70046,stance loss: 0.58599 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.95833 total_loss: 0.27797  loss:0.38787,stance loss: 0.303 
Train step: 3120 acc:0.9375 total_loss: 0.44735  loss:0.59544,stance loss: 0.47283 
Train step: 3130 acc:0.9375 total_loss: 0.40468  loss:0.31093,stance loss: 0.23956 
Train step: 3140 acc:0.92235 total_loss: 0.39931  loss:0.11265,stance loss: 0.032223 
Train step: 3150 acc:0.91715 total_loss: 0.41078  loss:0.26461,stance loss: 0.17397 
Train step: 3160 acc:0.91392 total_loss: 0.43553  loss:0.99067,stance loss: 0.68935 
Train step: 3170 acc:0.91567 total_loss: 0.42803  loss:0.37562,stance loss: 0.31882 
Train step: 3180 acc:0.91695 total_loss: 0.4171  loss:0.29596,stance loss: 0.36621 
Train step: 3190 acc:0.91416 total_loss: 0.42053  loss:0.21552,stance loss: 0.12196 
Train step: 3200 acc:0.91734 total_loss: 0.41465  loss:0.29819,stance loss: 0.16832 
Train step: 3210 acc:0.91444 total_loss: 0.41613  loss:0.31514,stance loss: 0.1902 
Train step: 3220 acc:0.91538 total_loss: 0.41368  loss:0.22724,stance loss: 0.19472 
Train step: 3230 acc:0.91514 total_loss: 0.41371  loss:0.55443,stance loss: 0.35407 
Train step: 3240 acc:0.91447 total_loss: 0.4123  loss:0.55027,stance loss: 0.52696 
Train step: 3250 acc:0.91302 total_loss: 0.41854  loss:0.48558,stance loss: 0.43559 
Train step: 3260 acc:0.91422 total_loss: 0.4178  loss:0.034379,stance loss: 0.0021465 
Train step: 3270 acc:0.91488 total_loss: 0.41494  loss:0.24907,stance loss: 0.14987 
Train step: 3280 acc:0.91618 total_loss: 0.41446  loss:0.66157,stance loss: 1.0841 
Train step: 3290 acc:0.91428 total_loss: 0.42044  loss:0.50146,stance loss: 0.33473 
Train step: 3300 acc:0.91548 total_loss: 0.41582  loss:0.17014,stance loss: 0.1018 
Train step: 3310 acc:0.91502 total_loss: 0.41803  loss:0.59175,stance loss: 0.47958 
Train step: 3320 acc:0.9152 total_loss: 0.41971  loss:0.6192,stance loss: 0.44473 
Train step: 3330 acc:0.91536 total_loss: 0.4239  loss:0.2228,stance loss: 0.1722 
Train step: 3340 acc:0.91658 total_loss: 0.42368  loss:0.13193,stance loss: 0.083635 
Train step: 3350 acc:0.91564 total_loss: 0.42789  loss:0.43954,stance loss: 0.37554 
Train step: 3360 acc:0.91576 total_loss: 0.42869  loss:0.42695,stance loss: 0.32078 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.92188 total_loss: 0.44714  loss:0.38508,stance loss: 0.31271 
Train step: 3380 acc:0.91518 total_loss: 0.34663  loss:0.30324,stance loss: 0.19597 
Train step: 3390 acc:0.92708 total_loss: 0.34215  loss:0.11819,stance loss: 0.061737 
Train step: 3400 acc:0.93566 total_loss: 0.33371  loss:0.3572,stance loss: 0.30667 
Train step: 3410 acc:0.93892 total_loss: 0.32195  loss:0.31331,stance loss: 0.27981 
Train step: 3420 acc:0.93519 total_loss: 0.35213  loss:0.14847,stance loss: 0.12344 
Train step: 3430 acc:0.93555 total_loss: 0.36622  loss:0.35829,stance loss: 0.30327 
Train step: 3440 acc:0.93919 total_loss: 0.35564  loss:0.66284,stance loss: 1.0921 
Train step: 3450 acc:0.9375 total_loss: 0.35327  loss:0.25156,stance loss: 0.11089 
Train step: 3460 acc:0.93816 total_loss: 0.34841  loss:0.21915,stance loss: 0.2284 
Train step: 3470 acc:0.9369 total_loss: 0.3592  loss:1.1306,stance loss: 1.5759 
Train step: 3480 acc:0.93586 total_loss: 0.36541  loss:1.0383,stance loss: 1.3365 
Train step: 3490 acc:0.93397 total_loss: 0.36699  loss:0.63704,stance loss: 0.36624 
Train step: 3500 acc:0.93377 total_loss: 0.36539  loss:0.41561,stance loss: 0.21205 
Train step: 3510 acc:0.93186 total_loss: 0.36293  loss:0.30314,stance loss: 0.27563 
Train step: 3520 acc:0.93222 total_loss: 0.35556  loss:0.39432,stance loss: 0.26402 
Train step: 3530 acc:0.93369 total_loss: 0.35442  loss:0.61937,stance loss: 1.0379 
Train step: 3540 acc:0.93355 total_loss: 0.35553  loss:0.31363,stance loss: 0.16957 
Train step: 3550 acc:0.93342 total_loss: 0.35571  loss:0.25172,stance loss: 0.22675 
Train step: 3560 acc:0.93492 total_loss: 0.35109  loss:0.16104,stance loss: 0.11879 
Train step: 3570 acc:0.93536 total_loss: 0.34721  loss:0.76146,stance loss: 0.58283 
Train step: 3580 acc:0.93487 total_loss: 0.3432  loss:0.39915,stance loss: 0.35202 
Train step: 3590 acc:0.93471 total_loss: 0.34162  loss:0.32953,stance loss: 0.26545 
Train step: 3600 acc:0.93349 total_loss: 0.34533  loss:0.93089,stance loss: 0.73944 
Train step: 3610 acc:0.93315 total_loss: 0.34709  loss:0.12214,stance loss: 0.072159 
Train step: 3620 acc:0.93209 total_loss: 0.34911  loss:0.76863,stance loss: 1.0426 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9625 total_loss: 0.26128  loss:0.049918,stance loss: 0.022896 
Train step: 3640 acc:0.95833 total_loss: 0.265  loss:0.15534,stance loss: 0.10736 
Train step: 3650 acc:0.955 total_loss: 0.28356  loss:0.49532,stance loss: 0.51296 
Train step: 3660 acc:0.95357 total_loss: 0.26734  loss:0.41436,stance loss: 0.31399 
Train step: 3670 acc:0.95278 total_loss: 0.2735  loss:0.076568,stance loss: 0.015839 
Train step: 3680 acc:0.95682 total_loss: 0.26858  loss:0.11882,stance loss: 0.0037727 
Train step: 3690 acc:0.96154 total_loss: 0.25933  loss:0.37743,stance loss: 0.29735 
Train step: 3700 acc:0.95583 total_loss: 0.25592  loss:0.36543,stance loss: 0.22067 
Train step: 3710 acc:0.95368 total_loss: 0.26249  loss:0.054065,stance loss: 0.0063851 
Train step: 3720 acc:0.95461 total_loss: 0.25875  loss:0.35353,stance loss: 0.33144 
Train step: 3730 acc:0.95476 total_loss: 0.25384  loss:0.26818,stance loss: 0.15061 
Train step: 3740 acc:0.95435 total_loss: 0.26268  loss:0.026645,stance loss: 0.0050952 
Train step: 3750 acc:0.9565 total_loss: 0.25517  loss:0.39592,stance loss: 0.38382 
Train step: 3760 acc:0.95556 total_loss: 0.25446  loss:0.035576,stance loss: 0.0038628 
Train step: 3770 acc:0.95647 total_loss: 0.25331  loss:0.13565,stance loss: 0.13299 
Train step: 3780 acc:0.95645 total_loss: 0.25854  loss:0.62473,stance loss: 0.49854 
Train step: 3790 acc:0.95568 total_loss: 0.25937  loss:0.22474,stance loss: 0.24151 
Train step: 3800 acc:0.955 total_loss: 0.2682  loss:0.91386,stance loss: 1.3423 
Train step: 3810 acc:0.95236 total_loss: 0.27264  loss:0.51252,stance loss: 0.53679 
Train step: 3820 acc:0.9516 total_loss: 0.27383  loss:0.58942,stance loss: 1.0103 
Train step: 3830 acc:0.95152 total_loss: 0.27884  loss:0.16551,stance loss: 0.14545 
Train step: 3840 acc:0.95087 total_loss: 0.27974  loss:0.30664,stance loss: 0.31715 
Train step: 3850 acc:0.94944 total_loss: 0.2831  loss:0.46691,stance loss: 0.43795 
Train step: 3860 acc:0.94973 total_loss: 0.28104  loss:0.51919,stance loss: 0.41416 
Train step: 3870 acc:0.95 total_loss: 0.2805  loss:0.48008,stance loss: 0.45205 
Train step: 3880 acc:0.94828 total_loss: 0.28784  loss:0.070424,stance loss: 0.020287 
Training finished.


Reload the best model with best f1 0.38744769874476986 from path test_outputs/bert-cross-topic/a/2023-08-14 15-19-57/state_dict


              precision    recall  f1-score   support

           0   0.633379  0.997845  0.774895       464
           1   0.500000  0.006897  0.013605       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.377793  0.334914  0.262834       733
weighted avg   0.499847  0.633015  0.493212       733

Test Acc: 0.6330150068212824 F1_ma:0.38744769874476986
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.38744769874476986
acc: 0.6330150068212824, f1 :0.26283361322213683
classification report: 
              precision    recall  f1-score   support

         Con     0.6334    0.9978    0.7749       464
        None     0.5000    0.0069    0.0136       145
         Pro     0.0000    0.0000    0.0000       124

    accuracy                         0.6330       733
   macro avg     0.3778    0.3349    0.2628       733
weighted avg     0.4998    0.6330    0.4932       733

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 15-39-45', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 15-39-45
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5 total_loss: 1.9633  loss:1.9633,stance loss: 1.7421 
Train step: 10 acc:0.40341 total_loss: 1.6973  loss:1.7771,stance loss: 1.2143 
Better F1! Saving model!
Saving model of best f1: 0.38763575605680867
              precision    recall  f1-score   support

           0   0.633015  1.000000  0.775272       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211005  0.333333  0.258424       733
weighted avg   0.400708  0.633015  0.490759       733

Test Acc: 0.6330150068212824 F1_ma:0.38763575605680867
Train step: 20 acc:0.40476 total_loss: 1.6825  loss:1.5967,stance loss: 1.0816 
Train step: 30 acc:0.41532 total_loss: 1.6981  loss:1.9038,stance loss: 1.7741 
Train step: 40 acc:0.42378 total_loss: 1.6829  loss:1.6323,stance loss: 1.1531 
Train step: 50 acc:0.43873 total_loss: 1.6846  loss:1.6108,stance loss: 1.2022 
Train step: 60 acc:0.44262 total_loss: 1.6762  loss:1.7418,stance loss: 1.2415 
Train step: 70 acc:0.44102 total_loss: 1.6811  loss:1.8435,stance loss: 1.7222 
Train step: 80 acc:0.4429 total_loss: 1.6759  loss:1.8163,stance loss: 1.2918 
Train step: 90 acc:0.44505 total_loss: 1.6705  loss:1.6515,stance loss: 1.1758 
Train step: 100 acc:0.44307 total_loss: 1.665  loss:1.6249,stance loss: 1.0742 
Train step: 110 acc:0.45101 total_loss: 1.654  loss:1.6377,stance loss: 1.2669 
Train step: 120 acc:0.45455 total_loss: 1.6444  loss:1.4148,stance loss: 0.95713 
Train step: 130 acc:0.45468 total_loss: 1.6384  loss:1.5311,stance loss: 1.0475 
Train step: 140 acc:0.457 total_loss: 1.6312  loss:1.4656,stance loss: 1.0465 
Train step: 150 acc:0.45778 total_loss: 1.625  loss:1.3777,stance loss: 0.89123 
Train step: 160 acc:0.46545 total_loss: 1.6179  loss:1.7173,stance loss: 1.2298 
Train step: 170 acc:0.46199 total_loss: 1.6122  loss:1.4028,stance loss: 0.90319 
Train step: 180 acc:0.4634 total_loss: 1.6055  loss:1.301,stance loss: 0.87064 
Train step: 190 acc:0.46924 total_loss: 1.6018  loss:1.6101,stance loss: 1.062 
Train step: 200 acc:0.47233 total_loss: 1.5984  loss:1.7747,stance loss: 1.2557 
Train step: 210 acc:0.47068 total_loss: 1.5958  loss:1.792,stance loss: 1.2087 
Train step: 220 acc:0.47483 total_loss: 1.5894  loss:1.3933,stance loss: 0.97959 
Train step: 230 acc:0.48214 total_loss: 1.5804  loss:1.5746,stance loss: 1.3934 
Train step: 240 acc:0.486 total_loss: 1.5724  loss:1.4935,stance loss: 1.1098 
Train step: 250 acc:0.48979 total_loss: 1.568  loss:1.5676,stance loss: 1.1934 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5625 total_loss: 1.4993  loss:1.554,stance loss: 1.2063 
Train step: 270 acc:0.64583 total_loss: 1.3059  loss:1.2641,stance loss: 0.82054 
Train step: 280 acc:0.625 total_loss: 1.3911  loss:1.2435,stance loss: 0.93213 
Train step: 290 acc:0.59766 total_loss: 1.408  loss:1.1921,stance loss: 0.77728 
Train step: 300 acc:0.59821 total_loss: 1.3871  loss:1.472,stance loss: 0.92748 
Train step: 310 acc:0.58293 total_loss: 1.4074  loss:1.2474,stance loss: 0.92017 
Train step: 320 acc:0.58367 total_loss: 1.4116  loss:1.4077,stance loss: 1.0702 
Train step: 330 acc:0.58333 total_loss: 1.4184  loss:1.4787,stance loss: 1.1969 
Train step: 340 acc:0.58841 total_loss: 1.4179  loss:1.146,stance loss: 0.87162 
Train step: 350 acc:0.58696 total_loss: 1.42  loss:1.4337,stance loss: 1.1305 
Train step: 360 acc:0.59375 total_loss: 1.4142  loss:1.0533,stance loss: 0.72101 
Train step: 370 acc:0.59487 total_loss: 1.4087  loss:1.0809,stance loss: 0.70008 
Train step: 380 acc:0.59426 total_loss: 1.4089  loss:1.1559,stance loss: 0.79261 
Train step: 390 acc:0.59375 total_loss: 1.4091  loss:0.97502,stance loss: 0.59925 
Train step: 400 acc:0.59727 total_loss: 1.3996  loss:1.3176,stance loss: 1.034 
Train step: 410 acc:0.59992 total_loss: 1.3968  loss:1.3394,stance loss: 1.0055 
Train step: 420 acc:0.60378 total_loss: 1.3917  loss:1.3585,stance loss: 1.0026 
Train step: 430 acc:0.60574 total_loss: 1.3873  loss:0.9423,stance loss: 0.60353 
Train step: 440 acc:0.60508 total_loss: 1.3915  loss:1.3718,stance loss: 0.9749 
Train step: 450 acc:0.60417 total_loss: 1.391  loss:1.2487,stance loss: 1.0096 
Train step: 460 acc:0.60891 total_loss: 1.3866  loss:1.5095,stance loss: 1.013 
Train step: 470 acc:0.61114 total_loss: 1.3846  loss:1.6525,stance loss: 1.2851 
Train step: 480 acc:0.61289 total_loss: 1.378  loss:0.88827,stance loss: 0.55014 
Train step: 490 acc:0.61395 total_loss: 1.3744  loss:1.1899,stance loss: 0.92094 
Train step: 500 acc:0.61389 total_loss: 1.3705  loss:1.1884,stance loss: 0.7386 
Train step: 510 acc:0.61508 total_loss: 1.3675  loss:1.1758,stance loss: 0.85811 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.6875 total_loss: 1.4702  loss:1.438,stance loss: 1.6394 
Train step: 530 acc:0.64423 total_loss: 1.3407  loss:1.6048,stance loss: 1.6487 
Train step: 540 acc:0.67663 total_loss: 1.2732  loss:1.3576,stance loss: 1.5351 
Train step: 550 acc:0.64962 total_loss: 1.2926  loss:1.4861,stance loss: 1.0976 
Train step: 560 acc:0.65407 total_loss: 1.2962  loss:1.2645,stance loss: 0.94724 
Train step: 570 acc:0.65448 total_loss: 1.3009  loss:1.4626,stance loss: 1.1095 
Train step: 580 acc:0.64187 total_loss: 1.3083  loss:1.5785,stance loss: 1.1083 
Train step: 590 acc:0.64812 total_loss: 1.2982  loss:1.5848,stance loss: 1.7385 
Train step: 600 acc:0.64383 total_loss: 1.3208  loss:1.7938,stance loss: 1.204 
Train step: 610 acc:0.64785 total_loss: 1.3056  loss:1.2338,stance loss: 0.94123 
Train step: 620 acc:0.64624 total_loss: 1.3016  loss:1.362,stance loss: 1.0605 
Train step: 630 acc:0.64823 total_loss: 1.2943  loss:1.3749,stance loss: 1.1079 
Train step: 640 acc:0.64939 total_loss: 1.2858  loss:0.94874,stance loss: 0.61162 
Train step: 650 acc:0.64803 total_loss: 1.2949  loss:1.423,stance loss: 1.1639 
Better F1! Saving model!
Saving model of best f1: 0.3938814685765905
              precision    recall  f1-score   support

           0   0.625000  0.538793  0.578704       464
           1   0.417647  0.489655  0.450794       145
           2   0.184049  0.241935  0.209059       124

    accuracy                       0.478854       733
   macro avg   0.408899  0.423461  0.412852       733
weighted avg   0.509387  0.478854  0.490869       733

Test Acc: 0.47885402455661663 F1_ma:0.3938814685765905
Train step: 660 acc:0.65385 total_loss: 1.2875  loss:0.93609,stance loss: 0.61967 
Train step: 670 acc:0.65972 total_loss: 1.2693  loss:1.1495,stance loss: 1.008 
Train step: 680 acc:0.66334 total_loss: 1.2627  loss:0.84524,stance loss: 0.65337 
Train step: 690 acc:0.66727 total_loss: 1.2579  loss:1.0435,stance loss: 1.1282 
Train step: 700 acc:0.66462 total_loss: 1.2569  loss:1.4073,stance loss: 1.0287 
Train step: 710 acc:0.66516 total_loss: 1.2533  loss:1.0105,stance loss: 0.77909 
Train step: 720 acc:0.66749 total_loss: 1.2464  loss:1.0808,stance loss: 0.74458 
Train step: 730 acc:0.66667 total_loss: 1.2468  loss:1.2177,stance loss: 0.85108 
Train step: 740 acc:0.6648 total_loss: 1.2519  loss:1.1483,stance loss: 0.91549 
Train step: 750 acc:0.6647 total_loss: 1.2507  loss:0.95999,stance loss: 0.65659 
Train step: 760 acc:0.66718 total_loss: 1.2516  loss:1.2969,stance loss: 1.0729 
Better F1! Saving model!
Saving model of best f1: 0.4178258145363408
              precision    recall  f1-score   support

           0   0.659847  0.556034  0.603509       464
           1   0.396694  0.662069  0.496124       145
           2   0.260000  0.209677  0.232143       124

    accuracy                       0.518417       733
   macro avg   0.438847  0.475927  0.443925       733
weighted avg   0.540149  0.518417  0.519443       733

Test Acc: 0.5184174624829468 F1_ma:0.4178258145363408
Train step: 770 acc:0.66798 total_loss: 1.2503  loss:1.354,stance loss: 1.1608 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.64062 total_loss: 1.1653  loss:1.303,stance loss: 1.0015 
Train step: 790 acc:0.65625 total_loss: 1.1269  loss:0.732,stance loss: 0.44127 
Train step: 800 acc:0.65625 total_loss: 1.1534  loss:1.2367,stance loss: 0.91444 
Train step: 810 acc:0.66728 total_loss: 1.1732  loss:1.1819,stance loss: 0.82028 
Train step: 820 acc:0.6875 total_loss: 1.1486  loss:1.2915,stance loss: 0.88177 
Train step: 830 acc:0.67824 total_loss: 1.1646  loss:1.4271,stance loss: 1.2892 
Train step: 840 acc:0.67969 total_loss: 1.1629  loss:1.2111,stance loss: 1.0699 
Train step: 850 acc:0.69003 total_loss: 1.1586  loss:1.0114,stance loss: 0.83561 
Train step: 860 acc:0.68601 total_loss: 1.1686  loss:1.1289,stance loss: 0.91534 
Train step: 870 acc:0.68218 total_loss: 1.1814  loss:1.633,stance loss: 1.3284 
Train step: 880 acc:0.68089 total_loss: 1.1699  loss:1.11,stance loss: 0.74434 
Train step: 890 acc:0.68257 total_loss: 1.1693  loss:0.7826,stance loss: 0.51383 
Train step: 900 acc:0.68196 total_loss: 1.1662  loss:1.5959,stance loss: 1.7499 
Train step: 910 acc:0.6791 total_loss: 1.174  loss:0.85878,stance loss: 0.68751 
Train step: 920 acc:0.67752 total_loss: 1.1779  loss:1.3538,stance loss: 1.5513 
Train step: 930 acc:0.67898 total_loss: 1.1716  loss:1.2465,stance loss: 1.3667 
Train step: 940 acc:0.68255 total_loss: 1.163  loss:0.85766,stance loss: 0.71386 
Train step: 950 acc:0.68175 total_loss: 1.1683  loss:1.2518,stance loss: 1.0583 
Train step: 960 acc:0.6824 total_loss: 1.1686  loss:1.7127,stance loss: 1.6789 
Train step: 970 acc:0.68009 total_loss: 1.1709  loss:1.3011,stance loss: 1.0931 
Train step: 980 acc:0.67862 total_loss: 1.1694  loss:1.3566,stance loss: 1.0294 
Train step: 990 acc:0.68107 total_loss: 1.1647  loss:0.87434,stance loss: 0.56954 
Train step: 1000 acc:0.68108 total_loss: 1.1583  loss:1.2727,stance loss: 0.95301 
Train step: 1010 acc:0.68029 total_loss: 1.1575  loss:1.0287,stance loss: 0.83388 
Train step: 1020 acc:0.68033 total_loss: 1.1571  loss:1.2382,stance loss: 0.95248 
Train step: 1030 acc:0.68086 total_loss: 1.1576  loss:0.84881,stance loss: 0.69132 
Better F1! Saving model!
Saving model of best f1: 0.4619229581596418
              precision    recall  f1-score   support

           0   0.687500  0.521552  0.593137       464
           1   0.398406  0.689655  0.505051       145
           2   0.323077  0.338710  0.330709       124

    accuracy                       0.523874       733
   macro avg   0.469661  0.516639  0.476299       733
weighted avg   0.568664  0.523874  0.531318       733

Test Acc: 0.5238744884038199 F1_ma:0.4619229581596418
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.75 total_loss: 0.98335  loss:1.4011,stance loss: 1.1172 
Train step: 1050 acc:0.74583 total_loss: 0.98336  loss:0.81603,stance loss: 0.60224 
Train step: 1060 acc:0.73 total_loss: 1.0103  loss:1.0206,stance loss: 0.72744 
Train step: 1070 acc:0.72321 total_loss: 1.0287  loss:0.96329,stance loss: 0.85804 
Train step: 1080 acc:0.72083 total_loss: 1.0428  loss:0.84659,stance loss: 0.68479 
Train step: 1090 acc:0.71591 total_loss: 1.0616  loss:1.1319,stance loss: 0.78919 
Train step: 1100 acc:0.70577 total_loss: 1.0816  loss:1.1461,stance loss: 0.83715 
Train step: 1110 acc:0.70833 total_loss: 1.0814  loss:0.98544,stance loss: 0.74022 
Train step: 1120 acc:0.70588 total_loss: 1.0911  loss:1.2464,stance loss: 0.99457 
Train step: 1130 acc:0.70724 total_loss: 1.0967  loss:1.2024,stance loss: 0.86388 
Train step: 1140 acc:0.70298 total_loss: 1.1037  loss:0.99055,stance loss: 0.81053 
Train step: 1150 acc:0.69891 total_loss: 1.1056  loss:0.92872,stance loss: 0.73669 
Train step: 1160 acc:0.701 total_loss: 1.1023  loss:1.4044,stance loss: 1.0934 
Train step: 1170 acc:0.6963 total_loss: 1.114  loss:1.4424,stance loss: 1.0663 
Train step: 1180 acc:0.69828 total_loss: 1.1086  loss:0.99114,stance loss: 0.87176 
Train step: 1190 acc:0.69718 total_loss: 1.1117  loss:1.4863,stance loss: 1.2945 
Train step: 1200 acc:0.69621 total_loss: 1.109  loss:1.3514,stance loss: 0.99844 
Train step: 1210 acc:0.69536 total_loss: 1.1137  loss:1.4106,stance loss: 0.95638 
Train step: 1220 acc:0.69628 total_loss: 1.1096  loss:0.96665,stance loss: 0.63596 
Train step: 1230 acc:0.69808 total_loss: 1.1095  loss:1.2669,stance loss: 1.0276 
Train step: 1240 acc:0.7003 total_loss: 1.1061  loss:1.0505,stance loss: 0.82222 
Train step: 1250 acc:0.69884 total_loss: 1.1047  loss:1.4608,stance loss: 1.1742 
Train step: 1260 acc:0.70028 total_loss: 1.0988  loss:0.70884,stance loss: 0.52942 
Train step: 1270 acc:0.69894 total_loss: 1.1006  loss:1.1842,stance loss: 0.86608 
Train step: 1280 acc:0.70102 total_loss: 1.0953  loss:0.87958,stance loss: 0.78711 
Better F1! Saving model!
Saving model of best f1: 0.47802967161193527
              precision    recall  f1-score   support

           0   0.699746  0.592672  0.641774       464
           1   0.405512  0.710345  0.516291       145
           2   0.383721  0.266129  0.314286       124

    accuracy                       0.560709       733
   macro avg   0.496326  0.523049  0.490783       733
weighted avg   0.588080  0.560709  0.561551       733

Test Acc: 0.5607094133697135 F1_ma:0.47802967161193527
Train step: 1290 acc:0.70441 total_loss: 1.0903  loss:0.96169,stance loss: 0.7922 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.73958 total_loss: 1.0449  loss:0.79205,stance loss: 0.57454 
Train step: 1310 acc:0.72266 total_loss: 1.0045  loss:0.8116,stance loss: 0.4971 
Train step: 1320 acc:0.71875 total_loss: 1.0277  loss:0.9693,stance loss: 0.78011 
Train step: 1330 acc:0.71354 total_loss: 1.023  loss:1.059,stance loss: 0.80935 
Train step: 1340 acc:0.70516 total_loss: 1.0542  loss:1.4615,stance loss: 1.0805 
Train step: 1350 acc:0.70647 total_loss: 1.0531  loss:0.76831,stance loss: 0.59914 
Train step: 1360 acc:0.71307 total_loss: 1.0419  loss:0.82293,stance loss: 0.54073 
Train step: 1370 acc:0.71793 total_loss: 1.0276  loss:1.1685,stance loss: 1.1374 
Train step: 1380 acc:0.71948 total_loss: 1.017  loss:0.79984,stance loss: 0.5942 
Train step: 1390 acc:0.7207 total_loss: 1.0066  loss:0.82278,stance loss: 0.58666 
Train step: 1400 acc:0.72288 total_loss: 1.004  loss:0.42713,stance loss: 0.27767 
Train step: 1410 acc:0.72144 total_loss: 1.0009  loss:0.89118,stance loss: 0.69625 
Train step: 1420 acc:0.72371 total_loss: 0.99993  loss:0.99546,stance loss: 0.89342 
Train step: 1430 acc:0.72564 total_loss: 0.99923  loss:0.89069,stance loss: 0.61575 
Train step: 1440 acc:0.72731 total_loss: 0.99433  loss:1.0345,stance loss: 0.79694 
Train step: 1450 acc:0.72516 total_loss: 1.0033  loss:1.4804,stance loss: 1.617 
Train step: 1460 acc:0.72402 total_loss: 1.0012  loss:1.0035,stance loss: 1.0184 
Train step: 1470 acc:0.72301 total_loss: 1.0073  loss:0.91073,stance loss: 0.89765 
Train step: 1480 acc:0.72278 total_loss: 1.0099  loss:0.77343,stance loss: 0.60963 
Train step: 1490 acc:0.71971 total_loss: 1.0154  loss:1.3912,stance loss: 1.6454 
Train step: 1500 acc:0.723 total_loss: 1.0183  loss:1.5603,stance loss: 2.0879 
Train step: 1510 acc:0.72367 total_loss: 1.0171  loss:1.0512,stance loss: 0.67137 
Train step: 1520 acc:0.72622 total_loss: 1.0113  loss:0.40808,stance loss: 0.20488 
Train step: 1530 acc:0.72458 total_loss: 1.0171  loss:1.2642,stance loss: 0.89355 
Train step: 1540 acc:0.72459 total_loss: 1.0134  loss:1.399,stance loss: 1.1305 
Train step: 1550 acc:0.72339 total_loss: 1.0139  loss:1.0261,stance loss: 0.65512 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.75 total_loss: 0.89625  loss:1.3091,stance loss: 1.1204 
Train step: 1570 acc:0.75368 total_loss: 0.93494  loss:0.63163,stance loss: 0.39567 
Train step: 1580 acc:0.72222 total_loss: 0.94614  loss:0.84192,stance loss: 0.77274 
Train step: 1590 acc:0.72973 total_loss: 0.93053  loss:1.1312,stance loss: 0.98172 
Train step: 1600 acc:0.74335 total_loss: 0.91451  loss:0.65482,stance loss: 0.50993 
Train step: 1610 acc:0.74561 total_loss: 0.92093  loss:0.97417,stance loss: 0.71102 
Train step: 1620 acc:0.74254 total_loss: 0.93167  loss:1.2778,stance loss: 1.0858 
Better F1! Saving model!
Saving model of best f1: 0.49220359866590185
              precision    recall  f1-score   support

           0   0.700000  0.633621  0.665158       464
           1   0.406250  0.627586  0.493225       145
           2   0.382022  0.274194  0.319249       124

    accuracy                       0.571623       733
   macro avg   0.496091  0.511800  0.492544       733
weighted avg   0.588100  0.571623  0.572630       733

Test Acc: 0.5716234652114598 F1_ma:0.49220359866590185
Train step: 1630 acc:0.74513 total_loss: 0.93802  loss:0.89308,stance loss: 0.63618 
Train step: 1640 acc:0.75 total_loss: 0.9408  loss:1.0643,stance loss: 0.95883 
Train step: 1650 acc:0.74871 total_loss: 0.94646  loss:1.0517,stance loss: 0.95083 
Train step: 1660 acc:0.75058 total_loss: 0.94715  loss:1.0096,stance loss: 0.88515 
Train step: 1670 acc:0.75748 total_loss: 0.93091  loss:0.45868,stance loss: 0.32932 
Train step: 1680 acc:0.75689 total_loss: 0.92674  loss:0.66558,stance loss: 0.57154 
Train step: 1690 acc:0.75912 total_loss: 0.91525  loss:0.6656,stance loss: 0.48731 
Train step: 1700 acc:0.75935 total_loss: 0.91323  loss:0.80299,stance loss: 0.556 
Train step: 1710 acc:0.75717 total_loss: 0.91267  loss:0.82373,stance loss: 0.54439 
Train step: 1720 acc:0.75749 total_loss: 0.91574  loss:1.0057,stance loss: 0.73154 
Train step: 1730 acc:0.756 total_loss: 0.92341  loss:1.2114,stance loss: 1.5558 
Train step: 1740 acc:0.75635 total_loss: 0.9167  loss:0.91359,stance loss: 0.67208 
Train step: 1750 acc:0.75666 total_loss: 0.91515  loss:0.7923,stance loss: 0.70124 
Train step: 1760 acc:0.75483 total_loss: 0.91632  loss:0.75783,stance loss: 0.586 
Train step: 1770 acc:0.75346 total_loss: 0.9157  loss:0.68566,stance loss: 0.52643 
Train step: 1780 acc:0.75441 total_loss: 0.91558  loss:0.91094,stance loss: 0.75292 
Train step: 1790 acc:0.75712 total_loss: 0.91053  loss:0.45537,stance loss: 0.33764 
Train step: 1800 acc:0.7586 total_loss: 0.91616  loss:1.395,stance loss: 1.6365 
Train step: 1810 acc:0.75875 total_loss: 0.91392  loss:0.53923,stance loss: 0.41715 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.8125 total_loss: 0.88177  loss:1.0852,stance loss: 1.3912 
Train step: 1830 acc:0.77778 total_loss: 0.86378  loss:1.2175,stance loss: 0.89775 
Train step: 1840 acc:0.77009 total_loss: 0.85811  loss:1.014,stance loss: 0.546 
Train step: 1850 acc:0.77796 total_loss: 0.83512  loss:0.81821,stance loss: 0.61647 
Train step: 1860 acc:0.76823 total_loss: 0.84375  loss:0.93349,stance loss: 0.73206 
Train step: 1870 acc:0.76832 total_loss: 0.84037  loss:0.56887,stance loss: 0.44841 
Train step: 1880 acc:0.77114 total_loss: 0.84423  loss:0.79849,stance loss: 0.66904 
Train step: 1890 acc:0.76603 total_loss: 0.85753  loss:1.1767,stance loss: 0.89566 
Train step: 1900 acc:0.76989 total_loss: 0.84955  loss:1.0236,stance loss: 0.91598 
Train step: 1910 acc:0.77487 total_loss: 0.85018  loss:0.70682,stance loss: 0.58564 
Train step: 1920 acc:0.78009 total_loss: 0.83507  loss:0.30918,stance loss: 0.010477 
Train step: 1930 acc:0.78602 total_loss: 0.81189  loss:0.53489,stance loss: 0.40742 
Train step: 1940 acc:0.79053 total_loss: 0.8131  loss:0.57676,stance loss: 0.50769 
Train step: 1950 acc:0.78986 total_loss: 0.81358  loss:0.49306,stance loss: 0.40248 
Train step: 1960 acc:0.78801 total_loss: 0.8186  loss:0.76476,stance loss: 0.6511 
Train step: 1970 acc:0.786 total_loss: 0.81977  loss:1.1813,stance loss: 0.91275 
Train step: 1980 acc:0.78646 total_loss: 0.81762  loss:0.92433,stance loss: 0.73543 
Train step: 1990 acc:0.78897 total_loss: 0.81618  loss:1.0069,stance loss: 0.79581 
Train step: 2000 acc:0.7889 total_loss: 0.81718  loss:0.95406,stance loss: 0.73731 
Train step: 2010 acc:0.79135 total_loss: 0.81729  loss:0.4154,stance loss: 0.3433 
Train step: 2020 acc:0.79056 total_loss: 0.8263  loss:1.0543,stance loss: 0.82153 
Train step: 2030 acc:0.79214 total_loss: 0.8255  loss:0.81336,stance loss: 0.56939 
Train step: 2040 acc:0.79331 total_loss: 0.82197  loss:0.72385,stance loss: 0.6498 
Train step: 2050 acc:0.79464 total_loss: 0.81955  loss:0.9079,stance loss: 0.69972 
Train step: 2060 acc:0.79284 total_loss: 0.82069  loss:0.97752,stance loss: 0.88845 
Train step: 2070 acc:0.79457 total_loss: 0.82039  loss:0.58954,stance loss: 0.5017 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.83333 total_loss: 0.66443  loss:0.65153,stance loss: 0.50172 
Train step: 2090 acc:0.82566 total_loss: 0.72617  loss:0.73156,stance loss: 0.56092 
Train step: 2100 acc:0.82543 total_loss: 0.7044  loss:1.0472,stance loss: 1.2322 
Train step: 2110 acc:0.81891 total_loss: 0.72363  loss:0.77558,stance loss: 0.56146 
Train step: 2120 acc:0.81633 total_loss: 0.71703  loss:0.67306,stance loss: 0.43475 
Train step: 2130 acc:0.81886 total_loss: 0.70039  loss:0.74879,stance loss: 0.46633 
Train step: 2140 acc:0.81884 total_loss: 0.70687  loss:0.342,stance loss: 0.2805 
Train step: 2150 acc:0.82199 total_loss: 0.72055  loss:1.0322,stance loss: 0.82552 
Train step: 2160 acc:0.8139 total_loss: 0.73667  loss:0.7828,stance loss: 0.61863 
Train step: 2170 acc:0.81376 total_loss: 0.73643  loss:0.68398,stance loss: 0.52191 
Train step: 2180 acc:0.81651 total_loss: 0.73847  loss:0.484,stance loss: 0.42081 
Train step: 2190 acc:0.81723 total_loss: 0.73222  loss:0.51477,stance loss: 0.29197 
Train step: 2200 acc:0.82074 total_loss: 0.71999  loss:0.41638,stance loss: 0.35448 
Train step: 2210 acc:0.82104 total_loss: 0.71774  loss:0.49947,stance loss: 0.38803 
Train step: 2220 acc:0.82215 total_loss: 0.70862  loss:0.6186,stance loss: 0.44842 
Train step: 2230 acc:0.82233 total_loss: 0.70117  loss:0.78461,stance loss: 0.64167 
Train step: 2240 acc:0.82396 total_loss: 0.69158  loss:0.35577,stance loss: 0.27622 
Train step: 2250 acc:0.82297 total_loss: 0.69074  loss:0.50823,stance loss: 0.38106 
Train step: 2260 acc:0.82209 total_loss: 0.69595  loss:0.94764,stance loss: 0.91353 
Train step: 2270 acc:0.82443 total_loss: 0.69425  loss:1.102,stance loss: 0.82563 
Train step: 2280 acc:0.82536 total_loss: 0.69914  loss:0.35863,stance loss: 0.25404 
Train step: 2290 acc:0.82705 total_loss: 0.69822  loss:0.62357,stance loss: 0.48569 
Train step: 2300 acc:0.82833 total_loss: 0.69312  loss:0.34933,stance loss: 0.14507 
Train step: 2310 acc:0.82741 total_loss: 0.70034  loss:0.88515,stance loss: 0.76448 
Train step: 2320 acc:0.82781 total_loss: 0.70152  loss:0.92964,stance loss: 0.71319 
Train step: 2330 acc:0.82862 total_loss: 0.6991  loss:1.2809,stance loss: 1.9738 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.8625 total_loss: 0.58098  loss:0.35143,stance loss: 0.15297 
Train step: 2350 acc:0.86875 total_loss: 0.57186  loss:0.73026,stance loss: 0.6413 
Train step: 2360 acc:0.86458 total_loss: 0.5801  loss:0.91964,stance loss: 0.8209 
Train step: 2370 acc:0.87344 total_loss: 0.59226  loss:0.54841,stance loss: 0.52904 
Train step: 2380 acc:0.87125 total_loss: 0.58853  loss:0.67438,stance loss: 0.48004 
Train step: 2390 acc:0.87083 total_loss: 0.58994  loss:0.51257,stance loss: 0.41806 
Train step: 2400 acc:0.86696 total_loss: 0.59149  loss:0.81335,stance loss: 0.76208 
Train step: 2410 acc:0.86562 total_loss: 0.60399  loss:0.37028,stance loss: 0.23862 
Train step: 2420 acc:0.86736 total_loss: 0.60386  loss:0.40473,stance loss: 0.34198 
Train step: 2430 acc:0.86938 total_loss: 0.59984  loss:0.28454,stance loss: 0.23028 
Train step: 2440 acc:0.86875 total_loss: 0.60302  loss:0.38904,stance loss: 0.31894 
Train step: 2450 acc:0.87135 total_loss: 0.60103  loss:0.84722,stance loss: 0.57404 
Train step: 2460 acc:0.87163 total_loss: 0.61472  loss:0.43715,stance loss: 0.38049 
Train step: 2470 acc:0.87277 total_loss: 0.61649  loss:0.74279,stance loss: 0.51577 
Train step: 2480 acc:0.86625 total_loss: 0.62985  loss:0.98019,stance loss: 0.7505 
Train step: 2490 acc:0.86523 total_loss: 0.63069  loss:0.47393,stance loss: 0.40086 
Train step: 2500 acc:0.86434 total_loss: 0.63551  loss:0.57464,stance loss: 0.59045 
Train step: 2510 acc:0.8625 total_loss: 0.63807  loss:0.47957,stance loss: 0.36866 
Train step: 2520 acc:0.86151 total_loss: 0.63547  loss:0.6093,stance loss: 0.53522 
Train step: 2530 acc:0.86094 total_loss: 0.64311  loss:0.48578,stance loss: 0.41954 
Train step: 2540 acc:0.8628 total_loss: 0.63969  loss:0.25929,stance loss: 0.12375 
Train step: 2550 acc:0.8608 total_loss: 0.6461  loss:0.31191,stance loss: 0.1785 
Train step: 2560 acc:0.86196 total_loss: 0.64403  loss:0.40223,stance loss: 0.201 
Train step: 2570 acc:0.86432 total_loss: 0.63562  loss:0.55682,stance loss: 0.40846 
Train step: 2580 acc:0.86475 total_loss: 0.6345  loss:0.83238,stance loss: 0.78796 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.9375 total_loss: 0.34891  loss:0.34891,stance loss: 0.29031 
Train step: 2600 acc:0.86364 total_loss: 0.66057  loss:0.50853,stance loss: 0.33438 
Train step: 2610 acc:0.86607 total_loss: 0.59974  loss:0.36522,stance loss: 0.30376 
Train step: 2620 acc:0.87097 total_loss: 0.57008  loss:0.73675,stance loss: 1.1457 
Train step: 2630 acc:0.88415 total_loss: 0.53141  loss:0.7619,stance loss: 0.60886 
Train step: 2640 acc:0.88113 total_loss: 0.53449  loss:0.47953,stance loss: 0.33487 
Train step: 2650 acc:0.88115 total_loss: 0.5206  loss:0.76845,stance loss: 0.54172 
Train step: 2660 acc:0.87764 total_loss: 0.52389  loss:0.29357,stance loss: 0.15476 
Train step: 2670 acc:0.87963 total_loss: 0.52324  loss:0.95904,stance loss: 0.73307 
Train step: 2680 acc:0.87843 total_loss: 0.5223  loss:0.60054,stance loss: 0.43013 
Train step: 2690 acc:0.88057 total_loss: 0.51364  loss:0.3333,stance loss: 0.19266 
Train step: 2700 acc:0.88119 total_loss: 0.52223  loss:0.47902,stance loss: 0.40011 
Train step: 2710 acc:0.88275 total_loss: 0.51745  loss:0.3153,stance loss: 0.23933 
Train step: 2720 acc:0.88359 total_loss: 0.51714  loss:0.9693,stance loss: 1.3574 
Train step: 2730 acc:0.88918 total_loss: 0.50344  loss:0.54259,stance loss: 0.47824 
Train step: 2740 acc:0.89031 total_loss: 0.50306  loss:1.3526,stance loss: 1.375 
Train step: 2750 acc:0.88665 total_loss: 0.50804  loss:0.4159,stance loss: 0.28259 
Train step: 2760 acc:0.88743 total_loss: 0.50952  loss:0.52043,stance loss: 0.46712 
Train step: 2770 acc:0.8857 total_loss: 0.51455  loss:0.62765,stance loss: 1.078 
Train step: 2780 acc:0.88416 total_loss: 0.51759  loss:0.76132,stance loss: 0.49253 
Train step: 2790 acc:0.88402 total_loss: 0.52111  loss:0.33294,stance loss: 0.078375 
Train step: 2800 acc:0.88152 total_loss: 0.52663  loss:0.49499,stance loss: 0.36928 
Train step: 2810 acc:0.8832 total_loss: 0.52576  loss:1.0507,stance loss: 1.4294 
Train step: 2820 acc:0.88366 total_loss: 0.52386  loss:0.65096,stance loss: 0.45381 
Train step: 2830 acc:0.8846 total_loss: 0.52382  loss:0.81523,stance loss: 0.64589 
Train step: 2840 acc:0.88521 total_loss: 0.52269  loss:0.17914,stance loss: 0.1006 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.90625 total_loss: 0.31441  loss:0.22399,stance loss: 0.11051 
Train step: 2860 acc:0.91146 total_loss: 0.38783  loss:0.18656,stance loss: 0.040198 
Train step: 2870 acc:0.92614 total_loss: 0.35674  loss:0.47807,stance loss: 0.48069 
Train step: 2880 acc:0.91797 total_loss: 0.40938  loss:0.74582,stance loss: 0.62897 
Train step: 2890 acc:0.90625 total_loss: 0.44534  loss:0.48008,stance loss: 0.42402 
Train step: 2900 acc:0.90745 total_loss: 0.47086  loss:0.68279,stance loss: 0.59333 
Train step: 2910 acc:0.90423 total_loss: 0.47912  loss:0.27839,stance loss: 0.16095 
Train step: 2920 acc:0.90799 total_loss: 0.46609  loss:0.34071,stance loss: 0.30517 
Train step: 2930 acc:0.90473 total_loss: 0.47678  loss:0.59287,stance loss: 0.63139 
Train step: 2940 acc:0.90489 total_loss: 0.48253  loss:0.19991,stance loss: 0.1372 
Train step: 2950 acc:0.90686 total_loss: 0.47777  loss:0.18252,stance loss: 0.1448 
Train step: 2960 acc:0.91016 total_loss: 0.47005  loss:0.51077,stance loss: 0.43657 
Train step: 2970 acc:0.90984 total_loss: 0.46916  loss:0.36612,stance loss: 0.33526 
Train step: 2980 acc:0.9072 total_loss: 0.47718  loss:0.47652,stance loss: 0.51784 
Train step: 2990 acc:0.90889 total_loss: 0.47578  loss:0.42338,stance loss: 0.17607 
Train step: 3000 acc:0.90995 total_loss: 0.47011  loss:0.13409,stance loss: 0.080637 
Train step: 3010 acc:0.91088 total_loss: 0.4665  loss:0.19976,stance loss: 0.11123 
Train step: 3020 acc:0.90952 total_loss: 0.46787  loss:0.53109,stance loss: 0.46166 
Train step: 3030 acc:0.90831 total_loss: 0.46669  loss:0.64245,stance loss: 0.45871 
Train step: 3040 acc:0.90918 total_loss: 0.45858  loss:0.24395,stance loss: 0.20273 
Train step: 3050 acc:0.90996 total_loss: 0.45319  loss:0.44021,stance loss: 0.36803 
Train step: 3060 acc:0.91038 total_loss: 0.4488  loss:0.33733,stance loss: 0.24576 
Train step: 3070 acc:0.91047 total_loss: 0.4476  loss:0.51393,stance loss: 0.36246 
Train step: 3080 acc:0.91083 total_loss: 0.44551  loss:0.14945,stance loss: 0.11757 
Train step: 3090 acc:0.90987 total_loss: 0.44848  loss:0.10059,stance loss: 0.035158 
Train step: 3100 acc:0.90997 total_loss: 0.44622  loss:0.81273,stance loss: 0.59066 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.89583 total_loss: 0.62147  loss:0.31469,stance loss: 0.25274 
Train step: 3120 acc:0.93269 total_loss: 0.42149  loss:0.15032,stance loss: 0.070001 
Train step: 3130 acc:0.91848 total_loss: 0.47891  loss:0.32123,stance loss: 0.18999 
Train step: 3140 acc:0.91856 total_loss: 0.46786  loss:0.19878,stance loss: 0.19184 
Train step: 3150 acc:0.9157 total_loss: 0.46253  loss:0.52839,stance loss: 0.41162 
Train step: 3160 acc:0.91627 total_loss: 0.43797  loss:0.27575,stance loss: 0.21569 
Train step: 3170 acc:0.92063 total_loss: 0.42482  loss:0.075788,stance loss: 0.018532 
Train step: 3180 acc:0.92295 total_loss: 0.41328  loss:0.61885,stance loss: 0.41944 
Train step: 3190 acc:0.9247 total_loss: 0.39844  loss:0.4234,stance loss: 0.38339 
Train step: 3200 acc:0.92339 total_loss: 0.39944  loss:0.21923,stance loss: 0.13254 
Train step: 3210 acc:0.92415 total_loss: 0.3971  loss:0.67518,stance loss: 0.64028 
Train step: 3220 acc:0.92478 total_loss: 0.39826  loss:0.40505,stance loss: 0.32566 
Train step: 3230 acc:0.92276 total_loss: 0.40533  loss:0.59208,stance loss: 0.48482 
Train step: 3240 acc:0.92293 total_loss: 0.40078  loss:0.16166,stance loss: 0.092705 
Train step: 3250 acc:0.92395 total_loss: 0.40049  loss:0.24592,stance loss: 0.28578 
Train step: 3260 acc:0.92565 total_loss: 0.39423  loss:0.80394,stance loss: 1.1638 
Train step: 3270 acc:0.92523 total_loss: 0.39602  loss:0.18101,stance loss: 0.14483 
Train step: 3280 acc:0.92413 total_loss: 0.39808  loss:0.33681,stance loss: 0.15777 
Train step: 3290 acc:0.92452 total_loss: 0.39363  loss:0.37709,stance loss: 0.30089 
Train step: 3300 acc:0.92681 total_loss: 0.39185  loss:0.69796,stance loss: 1.1496 
Train step: 3310 acc:0.9258 total_loss: 0.39654  loss:0.26222,stance loss: 0.2414 
Train step: 3320 acc:0.92459 total_loss: 0.39815  loss:0.32321,stance loss: 0.2214 
Train step: 3330 acc:0.92433 total_loss: 0.39745  loss:0.609,stance loss: 0.62551 
Train step: 3340 acc:0.92543 total_loss: 0.39134  loss:0.29674,stance loss: 0.22203 
Train step: 3350 acc:0.92464 total_loss: 0.39308  loss:0.14759,stance loss: 0.057576 
Train step: 3360 acc:0.92614 total_loss: 0.38838  loss:0.9532,stance loss: 1.1857 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.9375 total_loss: 0.2691  loss:0.47718,stance loss: 0.3021 
Train step: 3380 acc:0.92411 total_loss: 0.45139  loss:1.2518,stance loss: 1.4321 
Train step: 3390 acc:0.93229 total_loss: 0.39125  loss:0.23059,stance loss: 0.1505 
Train step: 3400 acc:0.93566 total_loss: 0.37191  loss:0.48296,stance loss: 0.36996 
Train step: 3410 acc:0.93892 total_loss: 0.36724  loss:0.053411,stance loss: 0.01458 
Train step: 3420 acc:0.93981 total_loss: 0.34283  loss:0.37464,stance loss: 0.31986 
Train step: 3430 acc:0.94336 total_loss: 0.34223  loss:0.091118,stance loss: 0.010936 
Train step: 3440 acc:0.94341 total_loss: 0.3488  loss:0.13343,stance loss: 0.042612 
Train step: 3450 acc:0.93973 total_loss: 0.3492  loss:0.13563,stance loss: 0.035274 
Train step: 3460 acc:0.94016 total_loss: 0.3435  loss:0.12878,stance loss: 0.068164 
Train step: 3470 acc:0.94171 total_loss: 0.33009  loss:0.085772,stance loss: 0.034339 
Train step: 3480 acc:0.94024 total_loss: 0.32614  loss:0.64175,stance loss: 0.74652 
Train step: 3490 acc:0.94052 total_loss: 0.32816  loss:0.29011,stance loss: 0.21585 
Train step: 3500 acc:0.93937 total_loss: 0.32601  loss:0.20127,stance loss: 0.13792 
Train step: 3510 acc:0.9362 total_loss: 0.3331  loss:0.79016,stance loss: 0.82898 
Train step: 3520 acc:0.93628 total_loss: 0.33778  loss:0.65773,stance loss: 1.1044 
Train step: 3530 acc:0.93712 total_loss: 0.33567  loss:0.54382,stance loss: 1.0096 
Train step: 3540 acc:0.93714 total_loss: 0.33173  loss:0.68627,stance loss: 1.1384 
Train step: 3550 acc:0.93784 total_loss: 0.33486  loss:0.15051,stance loss: 0.095101 
Train step: 3560 acc:0.93911 total_loss: 0.3288  loss:0.11052,stance loss: 0.078103 
Train step: 3570 acc:0.93811 total_loss: 0.32945  loss:0.32871,stance loss: 0.29894 
Train step: 3580 acc:0.93896 total_loss: 0.32609  loss:0.053904,stance loss: 0.024322 
Train step: 3590 acc:0.93862 total_loss: 0.32597  loss:0.45666,stance loss: 0.39267 
Train step: 3600 acc:0.93937 total_loss: 0.32254  loss:0.13611,stance loss: 0.10771 
Train step: 3610 acc:0.94057 total_loss: 0.31667  loss:0.26876,stance loss: 0.21412 
Train step: 3620 acc:0.94119 total_loss: 0.31509  loss:0.060545,stance loss: 0.020577 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:1.0 total_loss: 0.26474  loss:0.13355,stance loss: 0.056618 
Train step: 3640 acc:0.97917 total_loss: 0.2157  loss:0.08254,stance loss: 0.02016 
Train step: 3650 acc:0.9775 total_loss: 0.27463  loss:0.20248,stance loss: 0.14525 
Train step: 3660 acc:0.96964 total_loss: 0.2925  loss:0.35471,stance loss: 0.25721 
Train step: 3670 acc:0.9625 total_loss: 0.28599  loss:0.23816,stance loss: 0.1747 
Train step: 3680 acc:0.95455 total_loss: 0.29801  loss:0.040693,stance loss: 0.010759 
Train step: 3690 acc:0.95673 total_loss: 0.28094  loss:0.14302,stance loss: 0.056971 
Train step: 3700 acc:0.955 total_loss: 0.27615  loss:0.15289,stance loss: 0.095783 
Train step: 3710 acc:0.95294 total_loss: 0.29025  loss:0.02063,stance loss: 0.0031632 
Train step: 3720 acc:0.95329 total_loss: 0.29375  loss:0.63735,stance loss: 1.09 
Train step: 3730 acc:0.95417 total_loss: 0.29685  loss:0.025294,stance loss: 0.0025349 
Train step: 3740 acc:0.95543 total_loss: 0.29507  loss:0.098123,stance loss: 0.038254 
Train step: 3750 acc:0.953 total_loss: 0.29849  loss:0.048856,stance loss: 0.017718 
Train step: 3760 acc:0.95324 total_loss: 0.29173  loss:0.24979,stance loss: 0.17043 
Train step: 3770 acc:0.95431 total_loss: 0.28083  loss:0.11957,stance loss: 0.083403 
Train step: 3780 acc:0.95605 total_loss: 0.27281  loss:0.15118,stance loss: 0.11561 
Train step: 3790 acc:0.95795 total_loss: 0.26334  loss:0.074179,stance loss: 0.019174 
Train step: 3800 acc:0.95679 total_loss: 0.27052  loss:0.27659,stance loss: 0.23548 
Train step: 3810 acc:0.95676 total_loss: 0.26894  loss:0.32504,stance loss: 0.28895 
Train step: 3820 acc:0.95673 total_loss: 0.26669  loss:0.71622,stance loss: 0.59317 
Train step: 3830 acc:0.95518 total_loss: 0.26712  loss:0.21156,stance loss: 0.14415 
Train step: 3840 acc:0.9564 total_loss: 0.26499  loss:0.11837,stance loss: 0.066421 
Train step: 3850 acc:0.95694 total_loss: 0.26724  loss:0.27071,stance loss: 0.20083 
Train step: 3860 acc:0.95851 total_loss: 0.26378  loss:0.02774,stance loss: 0.0044225 
Train step: 3870 acc:0.95791 total_loss: 0.26273  loss:0.17599,stance loss: 0.12751 
Train step: 3880 acc:0.9576 total_loss: 0.26138  loss:0.47012,stance loss: 0.31214 
Training finished.


Reload the best model with best f1 0.49220359866590185 from path test_outputs/bert-cross-topic/a/2023-08-14 15-39-45/state_dict


              precision    recall  f1-score   support

           0   0.700000  0.633621  0.665158       464
           1   0.406250  0.627586  0.493225       145
           2   0.382022  0.274194  0.319249       124

    accuracy                       0.571623       733
   macro avg   0.496091  0.511800  0.492544       733
weighted avg   0.588100  0.571623  0.572630       733

Test Acc: 0.5716234652114598 F1_ma:0.49220359866590185
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.49220359866590185
acc: 0.5716234652114598, f1 :0.4925440431937087
classification report: 
              precision    recall  f1-score   support

         Con     0.7000    0.6336    0.6652       464
        None     0.4062    0.6276    0.4932       145
         Pro     0.3820    0.2742    0.3192       124

    accuracy                         0.5716       733
   macro avg     0.4961    0.5118    0.4925       733
weighted avg     0.5881    0.5716    0.5726       733

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 15-59-23', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 15-59-23
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.6892  loss:1.6892,stance loss: 1.032 
Train step: 10 acc:0.34659 total_loss: 1.7192  loss:1.6916,stance loss: 1.2581 
Better F1! Saving model!
Saving model of best f1: 0.41098624297616737
              precision    recall  f1-score   support

           0   0.635488  0.995690  0.775819       464
           1   0.000000  0.000000  0.000000       145
           2   0.500000  0.024194  0.046154       124

    accuracy                       0.634379       733
   macro avg   0.378496  0.339961  0.273991       733
weighted avg   0.486858  0.634379  0.498913       733

Test Acc: 0.6343792633015006 F1_ma:0.41098624297616737
Train step: 20 acc:0.41964 total_loss: 1.6945  loss:1.5952,stance loss: 1.2009 
Train step: 30 acc:0.45161 total_loss: 1.6648  loss:1.5367,stance loss: 1.1157 
Train step: 40 acc:0.45579 total_loss: 1.6716  loss:1.9371,stance loss: 1.8334 
Train step: 50 acc:0.46324 total_loss: 1.6644  loss:1.7114,stance loss: 1.0765 
Train step: 60 acc:0.46619 total_loss: 1.6551  loss:1.6059,stance loss: 0.89126 
Train step: 70 acc:0.46391 total_loss: 1.6412  loss:1.5938,stance loss: 1.1852 
Train step: 80 acc:0.46836 total_loss: 1.642  loss:1.7105,stance loss: 1.2894 
Train step: 90 acc:0.46429 total_loss: 1.6548  loss:1.6687,stance loss: 1.1887 
Train step: 100 acc:0.46411 total_loss: 1.6475  loss:1.5063,stance loss: 1.035 
Train step: 110 acc:0.46847 total_loss: 1.6456  loss:1.7647,stance loss: 1.2357 
Train step: 120 acc:0.46591 total_loss: 1.6363  loss:1.4912,stance loss: 0.73154 
Train step: 130 acc:0.46422 total_loss: 1.6321  loss:1.3717,stance loss: 0.90754 
Train step: 140 acc:0.46853 total_loss: 1.6207  loss:1.4312,stance loss: 0.85417 
Train step: 150 acc:0.46689 total_loss: 1.6145  loss:1.4752,stance loss: 0.87195 
Train step: 160 acc:0.47283 total_loss: 1.6108  loss:1.5562,stance loss: 1.3363 
Train step: 170 acc:0.47113 total_loss: 1.6105  loss:1.5604,stance loss: 1.1745 
Train step: 180 acc:0.47341 total_loss: 1.6048  loss:1.6211,stance loss: 1.2299 
Train step: 190 acc:0.47546 total_loss: 1.6049  loss:1.5161,stance loss: 1.2749 
Train step: 200 acc:0.47761 total_loss: 1.5984  loss:1.4544,stance loss: 1.0041 
Train step: 210 acc:0.4769 total_loss: 1.5923  loss:1.6195,stance loss: 1.1159 
Train step: 220 acc:0.47879 total_loss: 1.5867  loss:1.4782,stance loss: 1.0681 
Train step: 230 acc:0.48187 total_loss: 1.5823  loss:1.4684,stance loss: 0.96928 
Train step: 240 acc:0.48366 total_loss: 1.5814  loss:1.8549,stance loss: 1.8114 
Train step: 250 acc:0.48606 total_loss: 1.5757  loss:1.3319,stance loss: 0.87152 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5 total_loss: 1.4466  loss:1.4165,stance loss: 1.0273 
Train step: 270 acc:0.57292 total_loss: 1.3784  loss:1.4323,stance loss: 1.0536 
Train step: 280 acc:0.59943 total_loss: 1.3812  loss:1.3605,stance loss: 1.1909 
Train step: 290 acc:0.60547 total_loss: 1.372  loss:1.454,stance loss: 1.1307 
Train step: 300 acc:0.59077 total_loss: 1.3967  loss:1.1511,stance loss: 0.88753 
Train step: 310 acc:0.57812 total_loss: 1.4034  loss:1.8433,stance loss: 1.6475 
Train step: 320 acc:0.58669 total_loss: 1.3895  loss:1.5141,stance loss: 1.065 
Train step: 330 acc:0.59549 total_loss: 1.3815  loss:1.3261,stance loss: 0.83656 
Train step: 340 acc:0.59299 total_loss: 1.3789  loss:1.0966,stance loss: 0.78152 
Train step: 350 acc:0.59783 total_loss: 1.3798  loss:1.7722,stance loss: 1.4348 
Train step: 360 acc:0.60784 total_loss: 1.3689  loss:1.3242,stance loss: 1.0739 
Train step: 370 acc:0.60379 total_loss: 1.3766  loss:1.8855,stance loss: 1.4615 
Train step: 380 acc:0.60809 total_loss: 1.3712  loss:1.2687,stance loss: 0.85771 
Train step: 390 acc:0.60985 total_loss: 1.3726  loss:0.90136,stance loss: 0.36204 
Train step: 400 acc:0.614 total_loss: 1.371  loss:1.4768,stance loss: 1.1968 
Train step: 410 acc:0.61102 total_loss: 1.3707  loss:1.3914,stance loss: 0.99966 
Train step: 420 acc:0.61343 total_loss: 1.368  loss:1.2512,stance loss: 0.78924 
Train step: 430 acc:0.6141 total_loss: 1.3643  loss:1.1477,stance loss: 0.70987 
Train step: 440 acc:0.6147 total_loss: 1.3652  loss:1.3679,stance loss: 0.926 
Train step: 450 acc:0.61686 total_loss: 1.3649  loss:1.164,stance loss: 0.90223 
Train step: 460 acc:0.61881 total_loss: 1.3629  loss:1.4572,stance loss: 1.0756 
Train step: 470 acc:0.62205 total_loss: 1.3591  loss:1.2275,stance loss: 1.0039 
Train step: 480 acc:0.62416 total_loss: 1.3518  loss:1.1261,stance loss: 0.85226 
Train step: 490 acc:0.62473 total_loss: 1.346  loss:1.1726,stance loss: 0.88499 
Train step: 500 acc:0.62397 total_loss: 1.3498  loss:1.5037,stance loss: 1.2083 
Train step: 510 acc:0.62277 total_loss: 1.3481  loss:1.4262,stance loss: 1.1985 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.58333 total_loss: 1.3075  loss:1.4936,stance loss: 1.1416 
Train step: 530 acc:0.64904 total_loss: 1.243  loss:1.1893,stance loss: 0.95424 
Train step: 540 acc:0.66033 total_loss: 1.2237  loss:1.2041,stance loss: 0.90001 
Train step: 550 acc:0.67045 total_loss: 1.2435  loss:1.2633,stance loss: 1.0201 
Train step: 560 acc:0.67442 total_loss: 1.2495  loss:1.4364,stance loss: 1.1952 
Train step: 570 acc:0.66863 total_loss: 1.2581  loss:1.2618,stance loss: 0.91397 
Train step: 580 acc:0.66766 total_loss: 1.2546  loss:1.1573,stance loss: 0.87667 
Train step: 590 acc:0.6661 total_loss: 1.2519  loss:1.2987,stance loss: 0.73738 
Train step: 600 acc:0.66642 total_loss: 1.2521  loss:1.2034,stance loss: 0.94478 
Train step: 610 acc:0.67137 total_loss: 1.2395  loss:0.86883,stance loss: 0.64644 
Train step: 620 acc:0.67233 total_loss: 1.2334  loss:1.1807,stance loss: 1.0399 
Train step: 630 acc:0.67146 total_loss: 1.2402  loss:1.0683,stance loss: 0.79194 
Train step: 640 acc:0.66768 total_loss: 1.2398  loss:1.3417,stance loss: 1.1049 
Train step: 650 acc:0.66823 total_loss: 1.2348  loss:1.1652,stance loss: 0.79131 
Train step: 660 acc:0.67045 total_loss: 1.2369  loss:1.3227,stance loss: 1.1195 
Train step: 670 acc:0.67157 total_loss: 1.2315  loss:1.015,stance loss: 0.77196 
Train step: 680 acc:0.66794 total_loss: 1.2345  loss:1.0909,stance loss: 0.89694 
Train step: 690 acc:0.66944 total_loss: 1.2289  loss:1.076,stance loss: 0.79497 
Train step: 700 acc:0.66974 total_loss: 1.2264  loss:1.0484,stance loss: 0.65853 
Train step: 710 acc:0.67098 total_loss: 1.2301  loss:0.97148,stance loss: 0.50429 
Train step: 720 acc:0.67057 total_loss: 1.2278  loss:1.0448,stance loss: 0.74489 
Train step: 730 acc:0.67224 total_loss: 1.2207  loss:0.96058,stance loss: 0.78189 
Train step: 740 acc:0.66872 total_loss: 1.2184  loss:1.3733,stance loss: 1.0477 
Train step: 750 acc:0.67033 total_loss: 1.2153  loss:1.0745,stance loss: 0.83503 
Train step: 760 acc:0.67001 total_loss: 1.2165  loss:1.205,stance loss: 1.0291 
Train step: 770 acc:0.66996 total_loss: 1.2174  loss:1.0977,stance loss: 0.78165 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.71875 total_loss: 1.1005  loss:0.89176,stance loss: 0.73061 
Train step: 790 acc:0.70089 total_loss: 1.1985  loss:1.1732,stance loss: 0.95518 
Train step: 800 acc:0.69792 total_loss: 1.1665  loss:1.5603,stance loss: 1.5165 
Train step: 810 acc:0.69118 total_loss: 1.1562  loss:0.92135,stance loss: 0.56108 
Train step: 820 acc:0.69176 total_loss: 1.1443  loss:1.0255,stance loss: 0.90498 
Train step: 830 acc:0.69676 total_loss: 1.1631  loss:0.96508,stance loss: 0.52826 
Train step: 840 acc:0.69336 total_loss: 1.1716  loss:0.90127,stance loss: 0.74588 
Train step: 850 acc:0.69003 total_loss: 1.1742  loss:1.0129,stance loss: 0.73736 
Train step: 860 acc:0.68899 total_loss: 1.1672  loss:0.73677,stance loss: 0.5706 
Train step: 870 acc:0.69481 total_loss: 1.1561  loss:0.8312,stance loss: 0.63428 
Train step: 880 acc:0.69531 total_loss: 1.1454  loss:1.1517,stance loss: 0.56184 
Train step: 890 acc:0.70066 total_loss: 1.138  loss:0.83604,stance loss: 0.64496 
Train step: 900 acc:0.70665 total_loss: 1.1128  loss:0.66881,stance loss: 0.44518 
Train step: 910 acc:0.70616 total_loss: 1.112  loss:0.99176,stance loss: 0.85663 
Train step: 920 acc:0.70443 total_loss: 1.1169  loss:1.0662,stance loss: 0.93201 
Train step: 930 acc:0.69886 total_loss: 1.1252  loss:0.88713,stance loss: 0.66622 
Train step: 940 acc:0.70122 total_loss: 1.1208  loss:1.0748,stance loss: 0.7314 
Train step: 950 acc:0.70115 total_loss: 1.1226  loss:1.1207,stance loss: 0.74245 
Train step: 960 acc:0.69905 total_loss: 1.126  loss:1.584,stance loss: 1.6926 
Train step: 970 acc:0.702 total_loss: 1.1223  loss:1.3733,stance loss: 1.5839 
Train step: 980 acc:0.70098 total_loss: 1.123  loss:0.84214,stance loss: 0.52521 
Train step: 990 acc:0.69918 total_loss: 1.1218  loss:1.1043,stance loss: 0.84354 
Train step: 1000 acc:0.70006 total_loss: 1.1203  loss:1.0046,stance loss: 0.74356 
Train step: 1010 acc:0.69925 total_loss: 1.1207  loss:1.1541,stance loss: 1.0291 
Train step: 1020 acc:0.70133 total_loss: 1.1195  loss:1.2778,stance loss: 1.4753 
Train step: 1030 acc:0.70153 total_loss: 1.1181  loss:1.0072,stance loss: 0.83317 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.725 total_loss: 0.90879  loss:1.3945,stance loss: 0.96852 
Train step: 1050 acc:0.75833 total_loss: 0.96558  loss:1.431,stance loss: 1.6592 
Train step: 1060 acc:0.7475 total_loss: 1.0184  loss:0.78999,stance loss: 0.56878 
Train step: 1070 acc:0.74464 total_loss: 1.0104  loss:0.97544,stance loss: 0.74259 
Train step: 1080 acc:0.74861 total_loss: 0.99199  loss:0.61859,stance loss: 0.43394 
Train step: 1090 acc:0.73636 total_loss: 1.0016  loss:0.66655,stance loss: 0.53501 
Train step: 1100 acc:0.73654 total_loss: 1.0026  loss:0.70037,stance loss: 0.49105 
Train step: 1110 acc:0.73833 total_loss: 1.001  loss:0.69419,stance loss: 0.46992 
Train step: 1120 acc:0.73603 total_loss: 1.0089  loss:0.84147,stance loss: 0.72769 
Better F1! Saving model!
Saving model of best f1: 0.4149040501345871
              precision    recall  f1-score   support

           0   0.674230  0.896552  0.769658       464
           1   0.551402  0.406897  0.468254       145
           2   0.444444  0.032258  0.060150       124

    accuracy                       0.653479       733
   macro avg   0.556692  0.445235  0.432687       733
weighted avg   0.611060  0.653479  0.590009       733

Test Acc: 0.6534788540245566 F1_ma:0.4149040501345871
Train step: 1130 acc:0.73553 total_loss: 1.008  loss:1.1475,stance loss: 0.86365 
Train step: 1140 acc:0.73333 total_loss: 1.0059  loss:1.5865,stance loss: 1.0735 
Train step: 1150 acc:0.73478 total_loss: 1.0026  loss:0.88816,stance loss: 0.63047 
Train step: 1160 acc:0.7335 total_loss: 1.0121  loss:0.82252,stance loss: 0.59585 
Train step: 1170 acc:0.73565 total_loss: 1.0094  loss:1.1809,stance loss: 0.97738 
Train step: 1180 acc:0.73879 total_loss: 1.0018  loss:1.1824,stance loss: 0.78562 
Train step: 1190 acc:0.73669 total_loss: 0.99945  loss:0.87492,stance loss: 0.60434 
Train step: 1200 acc:0.73561 total_loss: 1.0003  loss:1.1081,stance loss: 0.98421 
Train step: 1210 acc:0.73393 total_loss: 1.0068  loss:1.0513,stance loss: 1.1116 
Train step: 1220 acc:0.73446 total_loss: 1.0095  loss:1.1725,stance loss: 0.99882 
Train step: 1230 acc:0.73365 total_loss: 1.0134  loss:1.1735,stance loss: 0.87449 
Train step: 1240 acc:0.73293 total_loss: 1.0199  loss:0.9468,stance loss: 0.82996 
Train step: 1250 acc:0.73081 total_loss: 1.0227  loss:1.2425,stance loss: 0.98778 
Train step: 1260 acc:0.73028 total_loss: 1.0231  loss:0.72612,stance loss: 0.49222 
Train step: 1270 acc:0.73271 total_loss: 1.0214  loss:0.77778,stance loss: 0.58361 
Train step: 1280 acc:0.73036 total_loss: 1.0246  loss:0.58043,stance loss: 0.44989 
Train step: 1290 acc:0.7299 total_loss: 1.0286  loss:1.4521,stance loss: 1.4476 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.71875 total_loss: 1.0092  loss:0.95787,stance loss: 0.66861 
Train step: 1310 acc:0.75781 total_loss: 0.94095  loss:1.2699,stance loss: 1.5588 
Train step: 1320 acc:0.7524 total_loss: 0.95641  loss:1.115,stance loss: 1.1742 
Train step: 1330 acc:0.76389 total_loss: 0.94857  loss:0.95897,stance loss: 0.8026 
Train step: 1340 acc:0.75951 total_loss: 0.96462  loss:0.67012,stance loss: 0.41708 
Train step: 1350 acc:0.76116 total_loss: 0.95349  loss:0.82784,stance loss: 0.57137 
Train step: 1360 acc:0.7642 total_loss: 0.94588  loss:0.60988,stance loss: 0.455 
Train step: 1370 acc:0.76234 total_loss: 0.94815  loss:1.0415,stance loss: 0.78592 
Train step: 1380 acc:0.76308 total_loss: 0.93663  loss:0.93663,stance loss: 0.6732 
Train step: 1390 acc:0.76628 total_loss: 0.93869  loss:0.92873,stance loss: 0.72422 
Train step: 1400 acc:0.76533 total_loss: 0.93798  loss:1.024,stance loss: 0.68439 
Train step: 1410 acc:0.7694 total_loss: 0.92886  loss:0.97515,stance loss: 0.86447 
Train step: 1420 acc:0.76687 total_loss: 0.93115  loss:0.82664,stance loss: 0.75456 
Train step: 1430 acc:0.76471 total_loss: 0.93053  loss:0.94785,stance loss: 0.67603 
Train step: 1440 acc:0.76241 total_loss: 0.93802  loss:1.0091,stance loss: 0.87842 
Better F1! Saving model!
Saving model of best f1: 0.41743782533256224
              precision    recall  f1-score   support

           0   0.673567  0.911638  0.774725       464
           1   0.572917  0.379310  0.456432       145
           2   0.444444  0.032258  0.060150       124

    accuracy                       0.657572       733
   macro avg   0.563643  0.441069  0.430436       733
weighted avg   0.614896  0.657572  0.590878       733

Test Acc: 0.6575716234652115 F1_ma:0.41743782533256224
Train step: 1450 acc:0.76082 total_loss: 0.93432  loss:0.99111,stance loss: 0.97383 
Train step: 1460 acc:0.75979 total_loss: 0.93233  loss:1.4035,stance loss: 1.1752 
Train step: 1470 acc:0.7571 total_loss: 0.93482  loss:0.80263,stance loss: 0.61703 
Train step: 1480 acc:0.7584 total_loss: 0.92685  loss:0.54407,stance loss: 0.3808 
Train step: 1490 acc:0.75925 total_loss: 0.92879  loss:1.2677,stance loss: 1.4342 
Train step: 1500 acc:0.75819 total_loss: 0.9317  loss:1.202,stance loss: 1.0234 
Train step: 1510 acc:0.75637 total_loss: 0.93312  loss:1.1804,stance loss: 0.82895 
Train step: 1520 acc:0.75857 total_loss: 0.93198  loss:0.60253,stance loss: 0.46355 
Train step: 1530 acc:0.75636 total_loss: 0.94325  loss:1.6104,stance loss: 1.2113 
Train step: 1540 acc:0.75711 total_loss: 0.94433  loss:0.79454,stance loss: 0.76461 
Train step: 1550 acc:0.7583 total_loss: 0.94246  loss:0.78001,stance loss: 0.63705 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.82143 total_loss: 0.74416  loss:0.93908,stance loss: 0.84295 
Train step: 1570 acc:0.76838 total_loss: 0.92424  loss:1.0354,stance loss: 1.1828 
Train step: 1580 acc:0.76157 total_loss: 0.94056  loss:0.9356,stance loss: 0.60508 
Train step: 1590 acc:0.76689 total_loss: 0.91155  loss:1.0968,stance loss: 0.86103 
Train step: 1600 acc:0.77261 total_loss: 0.87975  loss:0.74827,stance loss: 0.56235 
Train step: 1610 acc:0.77522 total_loss: 0.87946  loss:0.60863,stance loss: 0.47094 
Train step: 1620 acc:0.78358 total_loss: 0.84728  loss:0.87457,stance loss: 0.62231 
Train step: 1630 acc:0.78247 total_loss: 0.85737  loss:0.74481,stance loss: 0.56098 
Train step: 1640 acc:0.78233 total_loss: 0.84949  loss:0.95497,stance loss: 0.75489 
Train step: 1650 acc:0.78157 total_loss: 0.83835  loss:0.3039,stance loss: 0.13671 
Train step: 1660 acc:0.78154 total_loss: 0.8371  loss:0.74897,stance loss: 0.62363 
Train step: 1670 acc:0.78259 total_loss: 0.83851  loss:0.70869,stance loss: 0.59322 
Train step: 1680 acc:0.78691 total_loss: 0.8369  loss:0.78207,stance loss: 0.67983 
Train step: 1690 acc:0.7865 total_loss: 0.83209  loss:0.93797,stance loss: 0.65381 
Train step: 1700 acc:0.78571 total_loss: 0.83657  loss:0.99248,stance loss: 0.86925 
Train step: 1710 acc:0.78941 total_loss: 0.83759  loss:1.1969,stance loss: 0.9995 
Train step: 1720 acc:0.79042 total_loss: 0.82983  loss:0.6485,stance loss: 0.51023 
Train step: 1730 acc:0.79237 total_loss: 0.82783  loss:0.84322,stance loss: 0.76143 
Train step: 1740 acc:0.79245 total_loss: 0.82458  loss:1.126,stance loss: 1.1046 
Train step: 1750 acc:0.79251 total_loss: 0.82597  loss:0.55351,stance loss: 0.44154 
Train step: 1760 acc:0.78925 total_loss: 0.82842  loss:1.0415,stance loss: 0.80676 
Train step: 1770 acc:0.79003 total_loss: 0.82791  loss:0.51189,stance loss: 0.40548 
Train step: 1780 acc:0.78965 total_loss: 0.833  loss:0.69693,stance loss: 0.63769 
Train step: 1790 acc:0.79167 total_loss: 0.8263  loss:0.49402,stance loss: 0.39144 
Train step: 1800 acc:0.79124 total_loss: 0.8257  loss:0.50422,stance loss: 0.37002 
Train step: 1810 acc:0.79329 total_loss: 0.82472  loss:0.56643,stance loss: 0.42292 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.80469 total_loss: 0.61654  loss:0.70899,stance loss: 0.59222 
Train step: 1830 acc:0.80208 total_loss: 0.67235  loss:0.54239,stance loss: 0.42394 
Train step: 1840 acc:0.8058 total_loss: 0.69297  loss:0.66158,stance loss: 0.53148 
Better F1! Saving model!
Saving model of best f1: 0.42026702160892065
              precision    recall  f1-score   support

           0   0.684119  0.844828  0.756027       464
           1   0.528169  0.517241  0.522648       145
           2   0.333333  0.048387  0.084507       124

    accuracy                       0.645293       733
   macro avg   0.515207  0.470152  0.454394       733
weighted avg   0.593928  0.645293  0.596261       733

Test Acc: 0.645293315143247 F1_ma:0.42026702160892065
Train step: 1850 acc:0.79112 total_loss: 0.7473  loss:0.87158,stance loss: 0.71765 
Train step: 1860 acc:0.79818 total_loss: 0.75206  loss:0.83796,stance loss: 0.58185 
Train step: 1870 acc:0.80711 total_loss: 0.73894  loss:0.59525,stance loss: 0.41544 
Train step: 1880 acc:0.81526 total_loss: 0.71696  loss:0.66265,stance loss: 0.61486 
Train step: 1890 acc:0.81571 total_loss: 0.71659  loss:0.99387,stance loss: 0.906 
Train step: 1900 acc:0.81818 total_loss: 0.71694  loss:0.90084,stance loss: 0.76202 
Train step: 1910 acc:0.81952 total_loss: 0.71271  loss:0.80325,stance loss: 0.59497 
Train step: 1920 acc:0.81655 total_loss: 0.71701  loss:1.1276,stance loss: 0.96545 
Train step: 1930 acc:0.81568 total_loss: 0.72362  loss:0.95666,stance loss: 0.76563 
Train step: 1940 acc:0.8125 total_loss: 0.73362  loss:1.0572,stance loss: 0.73527 
Train step: 1950 acc:0.8125 total_loss: 0.72952  loss:1.0274,stance loss: 1.0188 
Train step: 1960 acc:0.80997 total_loss: 0.74448  loss:0.81487,stance loss: 0.64982 
Train step: 1970 acc:0.81013 total_loss: 0.74737  loss:0.67346,stance loss: 0.46266 
Train step: 1980 acc:0.8099 total_loss: 0.74737  loss:0.60639,stance loss: 0.45145 
Train step: 1990 acc:0.81039 total_loss: 0.74263  loss:0.94025,stance loss: 0.66616 
Train step: 2000 acc:0.81084 total_loss: 0.74828  loss:0.70538,stance loss: 0.54514 
Train step: 2010 acc:0.81218 total_loss: 0.75217  loss:1.1144,stance loss: 1.2205 
Train step: 2020 acc:0.8152 total_loss: 0.74506  loss:0.3864,stance loss: 0.25301 
Train step: 2030 acc:0.81336 total_loss: 0.75137  loss:1.2857,stance loss: 1.1018 
Train step: 2040 acc:0.81223 total_loss: 0.74946  loss:1.1708,stance loss: 0.89397 
Train step: 2050 acc:0.81303 total_loss: 0.74457  loss:0.67042,stance loss: 0.5195 
Train step: 2060 acc:0.81326 total_loss: 0.74411  loss:0.57119,stance loss: 0.44076 
Train step: 2070 acc:0.81516 total_loss: 0.74298  loss:1.1416,stance loss: 1.3716 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.89583 total_loss: 0.70909  loss:0.4819,stance loss: 0.26493 
Train step: 2090 acc:0.86184 total_loss: 0.71592  loss:0.98536,stance loss: 0.70686 
Train step: 2100 acc:0.85776 total_loss: 0.68468  loss:0.33346,stance loss: 0.25653 
Train step: 2110 acc:0.84936 total_loss: 0.68148  loss:0.34455,stance loss: 0.23975 
Train step: 2120 acc:0.84566 total_loss: 0.70085  loss:0.43982,stance loss: 0.38479 
Train step: 2130 acc:0.85169 total_loss: 0.67228  loss:0.32507,stance loss: 0.20982 
Train step: 2140 acc:0.85054 total_loss: 0.65633  loss:0.60344,stance loss: 0.50817 
Train step: 2150 acc:0.85127 total_loss: 0.66709  loss:0.82473,stance loss: 0.58959 
Train step: 2160 acc:0.85463 total_loss: 0.6509  loss:0.17162,stance loss: 0.02972 
Train step: 2170 acc:0.85417 total_loss: 0.6486  loss:0.69001,stance loss: 0.737 
Train step: 2180 acc:0.85493 total_loss: 0.65101  loss:0.30851,stance loss: 0.21984 
Train step: 2190 acc:0.85609 total_loss: 0.64629  loss:0.78047,stance loss: 0.58566 
Train step: 2200 acc:0.85804 total_loss: 0.63458  loss:0.57872,stance loss: 0.42866 
Train step: 2210 acc:0.85567 total_loss: 0.6345  loss:0.5453,stance loss: 0.43766 
Train step: 2220 acc:0.85529 total_loss: 0.63016  loss:0.44022,stance loss: 0.27957 
Train step: 2230 acc:0.85377 total_loss: 0.63563  loss:0.29287,stance loss: 0.23904 
Train step: 2240 acc:0.85207 total_loss: 0.63046  loss:0.49942,stance loss: 0.39194 
Train step: 2250 acc:0.85091 total_loss: 0.63624  loss:0.60039,stance loss: 0.31237 
Train step: 2260 acc:0.84888 total_loss: 0.64081  loss:0.61249,stance loss: 0.48706 
Train step: 2270 acc:0.85019 total_loss: 0.63838  loss:0.48125,stance loss: 0.37675 
Train step: 2280 acc:0.85167 total_loss: 0.63284  loss:0.45856,stance loss: 0.36065 
Train step: 2290 acc:0.85245 total_loss: 0.62919  loss:0.52377,stance loss: 0.39351 
Train step: 2300 acc:0.85235 total_loss: 0.63452  loss:0.88649,stance loss: 0.68122 
Better F1! Saving model!
Saving model of best f1: 0.42221909321317935
              precision    recall  f1-score   support

           0   0.684564  0.879310  0.769811       464
           1   0.543307  0.475862  0.507353       145
           2   0.500000  0.040323  0.074627       124

    accuracy                       0.657572       733
   macro avg   0.575957  0.465165  0.450597       733
weighted avg   0.625399  0.657572  0.600290       733

Test Acc: 0.6575716234652115 F1_ma:0.42221909321317935
Train step: 2310 acc:0.85225 total_loss: 0.63063  loss:0.46363,stance loss: 0.33295 
Train step: 2320 acc:0.8504 total_loss: 0.63323  loss:0.73518,stance loss: 0.68885 
Train step: 2330 acc:0.85037 total_loss: 0.63423  loss:0.377,stance loss: 0.29611 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.89375 total_loss: 0.47143  loss:0.35333,stance loss: 0.27502 
Train step: 2350 acc:0.87813 total_loss: 0.52657  loss:0.39527,stance loss: 0.30721 
Train step: 2360 acc:0.8875 total_loss: 0.5228  loss:0.26928,stance loss: 0.15998 
Train step: 2370 acc:0.88281 total_loss: 0.52708  loss:0.5806,stance loss: 0.4518 
Train step: 2380 acc:0.88 total_loss: 0.54691  loss:0.71572,stance loss: 0.68542 
Train step: 2390 acc:0.88229 total_loss: 0.55993  loss:0.7422,stance loss: 1.0994 
Train step: 2400 acc:0.88125 total_loss: 0.57706  loss:0.33045,stance loss: 0.21444 
Train step: 2410 acc:0.87891 total_loss: 0.58605  loss:0.41518,stance loss: 0.2973 
Train step: 2420 acc:0.88403 total_loss: 0.57577  loss:0.26693,stance loss: 0.1692 
Train step: 2430 acc:0.88062 total_loss: 0.58342  loss:0.41313,stance loss: 0.32223 
Train step: 2440 acc:0.88466 total_loss: 0.57485  loss:0.52056,stance loss: 0.43853 
Train step: 2450 acc:0.88646 total_loss: 0.56671  loss:0.55277,stance loss: 0.36338 
Train step: 2460 acc:0.88942 total_loss: 0.5636  loss:0.48637,stance loss: 0.39391 
Train step: 2470 acc:0.88929 total_loss: 0.56251  loss:0.3779,stance loss: 0.31888 
Train step: 2480 acc:0.88833 total_loss: 0.56223  loss:0.37261,stance loss: 0.30645 
Train step: 2490 acc:0.88906 total_loss: 0.55923  loss:0.59979,stance loss: 0.46437 
Train step: 2500 acc:0.8875 total_loss: 0.55804  loss:0.64595,stance loss: 0.55071 
Train step: 2510 acc:0.88715 total_loss: 0.55812  loss:0.6571,stance loss: 0.4845 
Train step: 2520 acc:0.88586 total_loss: 0.55629  loss:0.48806,stance loss: 0.4063 
Train step: 2530 acc:0.88375 total_loss: 0.56013  loss:0.45255,stance loss: 0.39861 
Train step: 2540 acc:0.88214 total_loss: 0.56541  loss:0.67951,stance loss: 0.6477 
Train step: 2550 acc:0.88097 total_loss: 0.56542  loss:0.63838,stance loss: 0.4948 
Train step: 2560 acc:0.88261 total_loss: 0.5595  loss:0.751,stance loss: 1.1348 
Train step: 2570 acc:0.87995 total_loss: 0.56466  loss:0.80648,stance loss: 0.65221 
Train step: 2580 acc:0.87925 total_loss: 0.56561  loss:0.50413,stance loss: 0.36688 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.8125 total_loss: 0.91199  loss:0.91199,stance loss: 0.69841 
Train step: 2600 acc:0.90909 total_loss: 0.49354  loss:0.50057,stance loss: 0.4224 
Train step: 2610 acc:0.90179 total_loss: 0.50999  loss:0.16247,stance loss: 0.10242 
Train step: 2620 acc:0.89919 total_loss: 0.47863  loss:0.40072,stance loss: 0.19442 
Train step: 2630 acc:0.90244 total_loss: 0.47551  loss:0.44972,stance loss: 0.40701 
Train step: 2640 acc:0.90931 total_loss: 0.44593  loss:0.45426,stance loss: 0.31861 
Train step: 2650 acc:0.90574 total_loss: 0.44095  loss:0.7224,stance loss: 0.6866 
Train step: 2660 acc:0.90669 total_loss: 0.45268  loss:0.41703,stance loss: 0.34606 
Train step: 2670 acc:0.90355 total_loss: 0.45429  loss:0.19804,stance loss: 0.080505 
Train step: 2680 acc:0.90247 total_loss: 0.46611  loss:0.20268,stance loss: 0.069227 
Train step: 2690 acc:0.90594 total_loss: 0.46129  loss:0.24254,stance loss: 0.17978 
Train step: 2700 acc:0.90597 total_loss: 0.45935  loss:0.15084,stance loss: 0.085382 
Train step: 2710 acc:0.90341 total_loss: 0.46154  loss:0.4254,stance loss: 0.24513 
Train step: 2720 acc:0.90315 total_loss: 0.45657  loss:0.43346,stance loss: 0.33407 
Train step: 2730 acc:0.90514 total_loss: 0.44725  loss:0.57912,stance loss: 0.42787 
Train step: 2740 acc:0.90563 total_loss: 0.45389  loss:0.64499,stance loss: 0.56765 
Train step: 2750 acc:0.90722 total_loss: 0.45231  loss:0.36241,stance loss: 0.30997 
Train step: 2760 acc:0.90607 total_loss: 0.45291  loss:0.30228,stance loss: 0.2481 
Train step: 2770 acc:0.90746 total_loss: 0.45326  loss:0.51231,stance loss: 0.4813 
Train step: 2780 acc:0.90707 total_loss: 0.45241  loss:0.30308,stance loss: 0.26691 
Train step: 2790 acc:0.90734 total_loss: 0.44749  loss:0.4794,stance loss: 0.43572 
Train step: 2800 acc:0.90936 total_loss: 0.44549  loss:0.14179,stance loss: 0.10925 
Train step: 2810 acc:0.91007 total_loss: 0.4416  loss:0.26096,stance loss: 0.16562 
Train step: 2820 acc:0.90909 total_loss: 0.44102  loss:0.20244,stance loss: 0.18788 
Train step: 2830 acc:0.91001 total_loss: 0.44099  loss:0.48718,stance loss: 0.43183 
Train step: 2840 acc:0.91011 total_loss: 0.44137  loss:0.53022,stance loss: 0.42523 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.96875 total_loss: 0.3204  loss:0.19651,stance loss: 0.17522 
Train step: 2860 acc:0.97396 total_loss: 0.37791  loss:0.32647,stance loss: 0.3888 
Train step: 2870 acc:0.94034 total_loss: 0.37334  loss:0.54655,stance loss: 0.56462 
Train step: 2880 acc:0.93945 total_loss: 0.36961  loss:0.56174,stance loss: 0.35238 
Train step: 2890 acc:0.92411 total_loss: 0.39728  loss:0.20512,stance loss: 0.10651 
Train step: 2900 acc:0.92668 total_loss: 0.38529  loss:0.19761,stance loss: 0.13792 
Train step: 2910 acc:0.92238 total_loss: 0.3771  loss:0.13437,stance loss: 0.079058 
Train step: 2920 acc:0.92188 total_loss: 0.38157  loss:0.40208,stance loss: 0.35015 
Train step: 2930 acc:0.9253 total_loss: 0.37905  loss:0.28994,stance loss: 0.25406 
Train step: 2940 acc:0.92459 total_loss: 0.38831  loss:0.2105,stance loss: 0.090508 
Train step: 2950 acc:0.92096 total_loss: 0.39094  loss:0.34115,stance loss: 0.32823 
Train step: 2960 acc:0.92188 total_loss: 0.38669  loss:0.4399,stance loss: 0.28996 
Train step: 2970 acc:0.92316 total_loss: 0.37768  loss:0.13892,stance loss: 0.061127 
Train step: 2980 acc:0.92708 total_loss: 0.36323  loss:0.10642,stance loss: 0.023755 
Train step: 2990 acc:0.92606 total_loss: 0.36492  loss:0.97939,stance loss: 1.3437 
Train step: 3000 acc:0.92681 total_loss: 0.37216  loss:0.51022,stance loss: 0.38524 
Train step: 3010 acc:0.92515 total_loss: 0.38064  loss:0.55937,stance loss: 1.0197 
Train step: 3020 acc:0.9266 total_loss: 0.37909  loss:0.13646,stance loss: 0.041407 
Train step: 3030 acc:0.9272 total_loss: 0.37468  loss:0.42221,stance loss: 0.40026 
Train step: 3040 acc:0.92448 total_loss: 0.38092  loss:0.12989,stance loss: 0.053682 
Train step: 3050 acc:0.9245 total_loss: 0.37793  loss:0.20898,stance loss: 0.15543 
Train step: 3060 acc:0.92099 total_loss: 0.38431  loss:0.64804,stance loss: 0.569 
Train step: 3070 acc:0.92089 total_loss: 0.38211  loss:0.19221,stance loss: 0.092156 
Train step: 3080 acc:0.92161 total_loss: 0.38035  loss:0.59211,stance loss: 0.38504 
Train step: 3090 acc:0.92226 total_loss: 0.37845  loss:0.62368,stance loss: 0.62873 
Train step: 3100 acc:0.92336 total_loss: 0.37586  loss:0.43717,stance loss: 0.38245 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.89583 total_loss: 0.38386  loss:0.49913,stance loss: 0.3862 
Train step: 3120 acc:0.92788 total_loss: 0.28414  loss:0.056979,stance loss: 0.014239 
Train step: 3130 acc:0.9212 total_loss: 0.29723  loss:0.30185,stance loss: 0.30994 
Train step: 3140 acc:0.92614 total_loss: 0.29154  loss:0.34265,stance loss: 0.28911 
Train step: 3150 acc:0.93605 total_loss: 0.27354  loss:0.39861,stance loss: 0.34673 
Train step: 3160 acc:0.93632 total_loss: 0.26855  loss:0.41391,stance loss: 0.27245 
Train step: 3170 acc:0.93254 total_loss: 0.30337  loss:0.18915,stance loss: 0.18637 
Train step: 3180 acc:0.92894 total_loss: 0.31936  loss:0.17278,stance loss: 0.10952 
Train step: 3190 acc:0.92771 total_loss: 0.32001  loss:0.66677,stance loss: 0.45731 
Train step: 3200 acc:0.93145 total_loss: 0.31609  loss:0.26866,stance loss: 0.18672 
Train step: 3210 acc:0.93204 total_loss: 0.32086  loss:0.69186,stance loss: 1.0969 
Train step: 3220 acc:0.93308 total_loss: 0.31756  loss:0.62465,stance loss: 0.37325 
Train step: 3230 acc:0.93496 total_loss: 0.31569  loss:0.25098,stance loss: 0.15807 
Train step: 3240 acc:0.93703 total_loss: 0.30915  loss:0.06385,stance loss: 0.012511 
Train step: 3250 acc:0.93925 total_loss: 0.29831  loss:0.069044,stance loss: 0.038574 
Train step: 3260 acc:0.94077 total_loss: 0.29731  loss:0.064861,stance loss: 0.016057 
Train step: 3270 acc:0.94095 total_loss: 0.29697  loss:0.15634,stance loss: 0.068324 
Train step: 3280 acc:0.94111 total_loss: 0.29425  loss:0.33844,stance loss: 0.40383 
Train step: 3290 acc:0.94057 total_loss: 0.29576  loss:0.22754,stance loss: 0.21546 
Train step: 3300 acc:0.94074 total_loss: 0.29192  loss:0.1137,stance loss: 0.060612 
Train step: 3310 acc:0.9415 total_loss: 0.29061  loss:0.35848,stance loss: 0.36175 
Train step: 3320 acc:0.94014 total_loss: 0.29548  loss:0.0873,stance loss: 0.0479 
Train step: 3330 acc:0.94002 total_loss: 0.29535  loss:0.16006,stance loss: 0.10369 
Train step: 3340 acc:0.9383 total_loss: 0.30221  loss:0.51609,stance loss: 0.56429 
Train step: 3350 acc:0.93801 total_loss: 0.30606  loss:0.3877,stance loss: 0.28572 
Train step: 3360 acc:0.93898 total_loss: 0.30301  loss:0.13109,stance loss: 0.071882 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.98438 total_loss: 0.12956  loss:0.19573,stance loss: 0.17999 
Train step: 3380 acc:0.99107 total_loss: 0.14017  loss:0.076551,stance loss: 0.01905 
Train step: 3390 acc:0.96875 total_loss: 0.24941  loss:0.13108,stance loss: 0.12889 
Train step: 3400 acc:0.97243 total_loss: 0.21246  loss:0.078519,stance loss: 0.027649 
Train step: 3410 acc:0.97017 total_loss: 0.20231  loss:0.29906,stance loss: 0.24629 
Train step: 3420 acc:0.96875 total_loss: 0.19572  loss:0.32043,stance loss: 0.2625 
Train step: 3430 acc:0.9707 total_loss: 0.20401  loss:0.072267,stance loss: 0.02715 
Train step: 3440 acc:0.96959 total_loss: 0.20097  loss:0.19156,stance loss: 0.18937 
Train step: 3450 acc:0.96949 total_loss: 0.19631  loss:0.10208,stance loss: 0.041517 
Train step: 3460 acc:0.96609 total_loss: 0.20606  loss:0.17399,stance loss: 0.12838 
Train step: 3470 acc:0.96394 total_loss: 0.21007  loss:0.060244,stance loss: 0.0071523 
Train step: 3480 acc:0.96217 total_loss: 0.21178  loss:0.039152,stance loss: 0.0012086 
Train step: 3490 acc:0.95917 total_loss: 0.22036  loss:0.12529,stance loss: 0.15064 
Train step: 3500 acc:0.95989 total_loss: 0.22595  loss:0.022802,stance loss: 0.0013689 
Train step: 3510 acc:0.9592 total_loss: 0.22584  loss:0.28042,stance loss: 0.232 
Train step: 3520 acc:0.96063 total_loss: 0.22819  loss:0.67959,stance loss: 1.0464 
Train step: 3530 acc:0.96037 total_loss: 0.22682  loss:0.084214,stance loss: 0.030588 
Train step: 3540 acc:0.96013 total_loss: 0.23455  loss:0.067574,stance loss: 0.014736 
Train step: 3550 acc:0.9606 total_loss: 0.23494  loss:0.073494,stance loss: 0.054257 
Train step: 3560 acc:0.96134 total_loss: 0.23181  loss:0.04433,stance loss: 0.0091486 
Train step: 3570 acc:0.96109 total_loss: 0.24019  loss:0.05188,stance loss: 0.016059 
Train step: 3580 acc:0.9594 total_loss: 0.24224  loss:0.61474,stance loss: 0.49063 
Train step: 3590 acc:0.95843 total_loss: 0.2499  loss:0.44337,stance loss: 0.35878 
Train step: 3600 acc:0.95887 total_loss: 0.2497  loss:0.064987,stance loss: 0.029069 
Train step: 3610 acc:0.95876 total_loss: 0.2489  loss:0.66,stance loss: 1.0377 
Train step: 3620 acc:0.95842 total_loss: 0.24996  loss:0.050081,stance loss: 0.031798 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.975 total_loss: 0.26465  loss:0.65865,stance loss: 1.1111 
Train step: 3640 acc:0.98333 total_loss: 0.18485  loss:0.071382,stance loss: 0.004688 
Train step: 3650 acc:0.9725 total_loss: 0.21847  loss:0.40386,stance loss: 0.48409 
Train step: 3660 acc:0.96607 total_loss: 0.22657  loss:0.35274,stance loss: 0.25968 
Train step: 3670 acc:0.9625 total_loss: 0.24844  loss:0.36757,stance loss: 0.31816 
Train step: 3680 acc:0.96023 total_loss: 0.24192  loss:0.23311,stance loss: 0.12133 
Train step: 3690 acc:0.96058 total_loss: 0.2335  loss:0.17345,stance loss: 0.023167 
Train step: 3700 acc:0.95833 total_loss: 0.23857  loss:0.39731,stance loss: 0.47497 
Train step: 3710 acc:0.95882 total_loss: 0.2296  loss:0.039925,stance loss: 0.0071903 
Train step: 3720 acc:0.95921 total_loss: 0.2339  loss:0.34273,stance loss: 0.34684 
Train step: 3730 acc:0.95893 total_loss: 0.23307  loss:0.095221,stance loss: 0.061058 
Train step: 3740 acc:0.95978 total_loss: 0.22892  loss:0.15998,stance loss: 0.072085 
Train step: 3750 acc:0.959 total_loss: 0.23153  loss:0.10335,stance loss: 0.084922 
Train step: 3760 acc:0.95833 total_loss: 0.23547  loss:0.1302,stance loss: 0.033047 
Train step: 3770 acc:0.95862 total_loss: 0.23429  loss:0.10309,stance loss: 0.010192 
Train step: 3780 acc:0.95645 total_loss: 0.24186  loss:0.54208,stance loss: 0.58108 
Train step: 3790 acc:0.95644 total_loss: 0.24163  loss:0.021793,stance loss: 0.0023567 
Train step: 3800 acc:0.95607 total_loss: 0.24165  loss:0.051456,stance loss: 0.014155 
Train step: 3810 acc:0.95676 total_loss: 0.24856  loss:0.11818,stance loss: 0.11969 
Train step: 3820 acc:0.95865 total_loss: 0.24194  loss:0.084937,stance loss: 0.074422 
Train step: 3830 acc:0.95884 total_loss: 0.24337  loss:0.07321,stance loss: 0.0087555 
Train step: 3840 acc:0.9593 total_loss: 0.24435  loss:0.5415,stance loss: 1.0144 
Train step: 3850 acc:0.95806 total_loss: 0.24977  loss:0.34843,stance loss: 0.3886 
Train step: 3860 acc:0.95878 total_loss: 0.24726  loss:0.043751,stance loss: 0.018628 
Train step: 3870 acc:0.95867 total_loss: 0.25242  loss:0.63941,stance loss: 1.0795 
Train step: 3880 acc:0.95956 total_loss: 0.25462  loss:0.29688,stance loss: 0.38618 
Training finished.


Reload the best model with best f1 0.42221909321317935 from path test_outputs/bert-cross-topic/a/2023-08-14 15-59-23/state_dict


              precision    recall  f1-score   support

           0   0.684564  0.879310  0.769811       464
           1   0.543307  0.475862  0.507353       145
           2   0.500000  0.040323  0.074627       124

    accuracy                       0.657572       733
   macro avg   0.575957  0.465165  0.450597       733
weighted avg   0.625399  0.657572  0.600290       733

Test Acc: 0.6575716234652115 F1_ma:0.42221909321317935
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.42221909321317935
acc: 0.6575716234652115, f1 :0.45059704253427646
classification report: 
              precision    recall  f1-score   support

         Con     0.6846    0.8793    0.7698       464
        None     0.5433    0.4759    0.5074       145
         Pro     0.5000    0.0403    0.0746       124

    accuracy                         0.6576       733
   macro avg     0.5760    0.4652    0.4506       733
weighted avg     0.6254    0.6576    0.6003       733

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 16-19-04', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 16-19-04
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.9129  loss:1.9129,stance loss: 1.2269 
Train step: 10 acc:0.28977 total_loss: 1.7936  loss:1.7634,stance loss: 1.282 
Better F1! Saving model!
Saving model of best f1: 0.38763575605680867
              precision    recall  f1-score   support

           0   0.633015  1.000000  0.775272       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211005  0.333333  0.258424       733
weighted avg   0.400708  0.633015  0.490759       733

Test Acc: 0.6330150068212824 F1_ma:0.38763575605680867
Train step: 20 acc:0.3869 total_loss: 1.7221  loss:1.6362,stance loss: 1.0822 
Train step: 30 acc:0.41734 total_loss: 1.6971  loss:1.6741,stance loss: 1.2498 
Train step: 40 acc:0.43598 total_loss: 1.6955  loss:1.5683,stance loss: 1.3894 
Train step: 50 acc:0.45221 total_loss: 1.6811  loss:1.544,stance loss: 1.1576 
Train step: 60 acc:0.46107 total_loss: 1.6663  loss:1.2816,stance loss: 0.90598 
Train step: 70 acc:0.46127 total_loss: 1.6661  loss:1.6917,stance loss: 1.1963 
Train step: 80 acc:0.47222 total_loss: 1.6567  loss:1.5093,stance loss: 1.1441 
Train step: 90 acc:0.47115 total_loss: 1.6575  loss:1.6012,stance loss: 1.1184 
Train step: 100 acc:0.47401 total_loss: 1.658  loss:1.6488,stance loss: 1.2096 
Train step: 110 acc:0.48029 total_loss: 1.6486  loss:1.5989,stance loss: 1.1309 
Train step: 120 acc:0.48244 total_loss: 1.644  loss:1.6003,stance loss: 1.1304 
Train step: 130 acc:0.48712 total_loss: 1.6339  loss:1.6999,stance loss: 1.1306 
Train step: 140 acc:0.48892 total_loss: 1.625  loss:1.5941,stance loss: 1.6012 
Train step: 150 acc:0.49379 total_loss: 1.616  loss:1.6636,stance loss: 1.399 
Train step: 160 acc:0.49534 total_loss: 1.6095  loss:1.2723,stance loss: 0.69972 
Train step: 170 acc:0.49598 total_loss: 1.6022  loss:1.432,stance loss: 0.72069 
Train step: 180 acc:0.50173 total_loss: 1.5945  loss:1.598,stance loss: 1.5964 
Train step: 190 acc:0.50622 total_loss: 1.5873  loss:1.3048,stance loss: 0.9485 
Train step: 200 acc:0.50777 total_loss: 1.5848  loss:1.2409,stance loss: 0.88686 
Train step: 210 acc:0.51185 total_loss: 1.5793  loss:1.4947,stance loss: 1.2682 
Train step: 220 acc:0.51131 total_loss: 1.578  loss:1.8206,stance loss: 1.6948 
Train step: 230 acc:0.51218 total_loss: 1.573  loss:1.5455,stance loss: 1.269 
Better F1! Saving model!
Saving model of best f1: 0.3879598662207358
              precision    recall  f1-score   support

           0   0.633880  1.000000  0.775920       464
           1   1.000000  0.006897  0.013699       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.634379       733
   macro avg   0.544627  0.335632  0.263206       733
weighted avg   0.599073  0.634379  0.493879       733

Test Acc: 0.6343792633015006 F1_ma:0.3879598662207358
Train step: 240 acc:0.51738 total_loss: 1.5672  loss:1.8053,stance loss: 1.7798 
Train step: 250 acc:0.51868 total_loss: 1.5621  loss:1.5319,stance loss: 1.3646 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.5 total_loss: 1.5784  loss:1.3039,stance loss: 0.98028 
Train step: 270 acc:0.57812 total_loss: 1.4351  loss:1.4334,stance loss: 1.1221 
Train step: 280 acc:0.58807 total_loss: 1.4229  loss:1.6734,stance loss: 1.4404 
Train step: 290 acc:0.59961 total_loss: 1.4224  loss:1.4376,stance loss: 1.1287 
Train step: 300 acc:0.60565 total_loss: 1.4342  loss:1.2192,stance loss: 0.87269 
Train step: 310 acc:0.59255 total_loss: 1.4362  loss:1.3744,stance loss: 0.97967 
Train step: 320 acc:0.57964 total_loss: 1.4495  loss:1.2347,stance loss: 0.86714 
Train step: 330 acc:0.57552 total_loss: 1.4433  loss:1.5979,stance loss: 1.2632 
Train step: 340 acc:0.57698 total_loss: 1.4432  loss:1.5503,stance loss: 1.0941 
Train step: 350 acc:0.57609 total_loss: 1.4392  loss:1.6117,stance loss: 1.1531 
Train step: 360 acc:0.57537 total_loss: 1.442  loss:1.5868,stance loss: 1.1182 
Train step: 370 acc:0.57143 total_loss: 1.4364  loss:1.4215,stance loss: 1.0403 
Train step: 380 acc:0.57684 total_loss: 1.427  loss:1.5478,stance loss: 1.1659 
Train step: 390 acc:0.57765 total_loss: 1.4247  loss:1.2889,stance loss: 1.0011 
Train step: 400 acc:0.58099 total_loss: 1.4184  loss:1.1772,stance loss: 0.88358 
Train step: 410 acc:0.58388 total_loss: 1.412  loss:1.6897,stance loss: 1.3238 
Train step: 420 acc:0.58603 total_loss: 1.4083  loss:1.3622,stance loss: 1.0813 
Train step: 430 acc:0.58285 total_loss: 1.4094  loss:1.2047,stance loss: 0.76169 
Train step: 440 acc:0.5831 total_loss: 1.4092  loss:1.2992,stance loss: 0.97569 
Train step: 450 acc:0.58594 total_loss: 1.4053  loss:1.1124,stance loss: 0.84542 
Train step: 460 acc:0.58787 total_loss: 1.4042  loss:1.3007,stance loss: 1.0635 
Train step: 470 acc:0.58756 total_loss: 1.405  loss:1.5621,stance loss: 1.2855 
Train step: 480 acc:0.58953 total_loss: 1.4011  loss:1.3775,stance loss: 1.0206 
Train step: 490 acc:0.58917 total_loss: 1.3997  loss:1.2534,stance loss: 0.99904 
Train step: 500 acc:0.5891 total_loss: 1.3971  loss:1.345,stance loss: 0.94967 
Train step: 510 acc:0.59053 total_loss: 1.396  loss:1.5067,stance loss: 1.1351 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.60417 total_loss: 1.54  loss:1.8033,stance loss: 1.7517 
Train step: 530 acc:0.62981 total_loss: 1.4137  loss:1.2942,stance loss: 1.089 
Train step: 540 acc:0.64674 total_loss: 1.3899  loss:1.256,stance loss: 0.96883 
Train step: 550 acc:0.64394 total_loss: 1.3725  loss:1.3267,stance loss: 0.9489 
Train step: 560 acc:0.64244 total_loss: 1.3574  loss:1.1783,stance loss: 0.85778 
Train step: 570 acc:0.65684 total_loss: 1.3366  loss:1.4728,stance loss: 1.2042 
Train step: 580 acc:0.6498 total_loss: 1.3358  loss:1.3909,stance loss: 1.5492 
Train step: 590 acc:0.6464 total_loss: 1.3431  loss:1.746,stance loss: 1.7759 
Train step: 600 acc:0.6506 total_loss: 1.3342  loss:1.3731,stance loss: 1.1064 
Train step: 610 acc:0.64449 total_loss: 1.3318  loss:1.0736,stance loss: 0.83089 
Train step: 620 acc:0.64442 total_loss: 1.3224  loss:1.1057,stance loss: 0.76978 
Train step: 630 acc:0.64491 total_loss: 1.3288  loss:1.3401,stance loss: 0.92716 
Train step: 640 acc:0.64177 total_loss: 1.3284  loss:1.542,stance loss: 1.1448 
Train step: 650 acc:0.6391 total_loss: 1.3312  loss:1.3812,stance loss: 1.0865 
Train step: 660 acc:0.64336 total_loss: 1.3252  loss:1.4073,stance loss: 0.97262 
Train step: 670 acc:0.64175 total_loss: 1.328  loss:1.4116,stance loss: 1.0864 
Train step: 680 acc:0.6411 total_loss: 1.3298  loss:1.5157,stance loss: 1.2345 
Train step: 690 acc:0.64053 total_loss: 1.3307  loss:1.2081,stance loss: 0.86337 
Train step: 700 acc:0.639 total_loss: 1.327  loss:1.2625,stance loss: 1.0576 
Train step: 710 acc:0.63698 total_loss: 1.326  loss:1.1602,stance loss: 0.84203 
Train step: 720 acc:0.63762 total_loss: 1.3268  loss:1.3873,stance loss: 1.532 
Train step: 730 acc:0.64026 total_loss: 1.3219  loss:1.6965,stance loss: 1.5738 
Train step: 740 acc:0.63957 total_loss: 1.3193  loss:1.509,stance loss: 1.6778 
Train step: 750 acc:0.64217 total_loss: 1.3114  loss:1.2972,stance loss: 0.96711 
Train step: 760 acc:0.64172 total_loss: 1.3084  loss:0.91982,stance loss: 0.74764 
Train step: 770 acc:0.64303 total_loss: 1.3048  loss:1.0921,stance loss: 0.68494 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.78125 total_loss: 0.93921  loss:0.96347,stance loss: 0.75572 
Train step: 790 acc:0.65179 total_loss: 1.2141  loss:1.2999,stance loss: 1.4559 
Train step: 800 acc:0.6276 total_loss: 1.2129  loss:1.7995,stance loss: 1.3234 
Train step: 810 acc:0.62316 total_loss: 1.233  loss:1.3055,stance loss: 1.0828 
Train step: 820 acc:0.62358 total_loss: 1.2405  loss:1.5106,stance loss: 1.6888 
Train step: 830 acc:0.63773 total_loss: 1.2152  loss:1.3304,stance loss: 0.96179 
Train step: 840 acc:0.64453 total_loss: 1.2137  loss:0.81202,stance loss: 0.59509 
Train step: 850 acc:0.64865 total_loss: 1.2109  loss:1.0976,stance loss: 0.89764 
Train step: 860 acc:0.65476 total_loss: 1.2091  loss:1.2794,stance loss: 1.0881 
Train step: 870 acc:0.6516 total_loss: 1.2172  loss:1.6597,stance loss: 1.2992 
Train step: 880 acc:0.65445 total_loss: 1.2108  loss:1.4034,stance loss: 1.1103 
Train step: 890 acc:0.6568 total_loss: 1.2036  loss:1.3104,stance loss: 1.4727 
Train step: 900 acc:0.65827 total_loss: 1.2063  loss:1.1955,stance loss: 0.95611 
Train step: 910 acc:0.66185 total_loss: 1.204  loss:0.81298,stance loss: 0.51577 
Train step: 920 acc:0.6658 total_loss: 1.1901  loss:1.1635,stance loss: 1.02 
Train step: 930 acc:0.66843 total_loss: 1.1817  loss:0.78351,stance loss: 0.57814 
Train step: 940 acc:0.66463 total_loss: 1.1931  loss:1.5469,stance loss: 1.3932 
Train step: 950 acc:0.66595 total_loss: 1.1923  loss:1.2367,stance loss: 1.0859 
Train step: 960 acc:0.66474 total_loss: 1.1932  loss:0.87219,stance loss: 0.63935 
Train step: 970 acc:0.66624 total_loss: 1.192  loss:1.0217,stance loss: 0.74673 
Train step: 980 acc:0.66513 total_loss: 1.1928  loss:1.0526,stance loss: 0.70158 
Train step: 990 acc:0.66881 total_loss: 1.1914  loss:0.89181,stance loss: 0.66453 
Train step: 1000 acc:0.66769 total_loss: 1.1922  loss:0.95956,stance loss: 0.80712 
Train step: 1010 acc:0.66346 total_loss: 1.1999  loss:1.2786,stance loss: 1.0541 
Train step: 1020 acc:0.66445 total_loss: 1.1994  loss:1.3785,stance loss: 1.1093 
Train step: 1030 acc:0.66585 total_loss: 1.1959  loss:0.66242,stance loss: 0.39053 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.725 total_loss: 1.0688  loss:1.1639,stance loss: 1.3088 
Train step: 1050 acc:0.70417 total_loss: 1.0663  loss:1.3579,stance loss: 1.1331 
Train step: 1060 acc:0.7025 total_loss: 1.0619  loss:0.68607,stance loss: 0.45722 
Train step: 1070 acc:0.7 total_loss: 1.0587  loss:0.90871,stance loss: 0.82901 
Train step: 1080 acc:0.70833 total_loss: 1.0674  loss:1.2747,stance loss: 0.8554 
Train step: 1090 acc:0.70341 total_loss: 1.0731  loss:1.1343,stance loss: 0.84756 
Train step: 1100 acc:0.70769 total_loss: 1.0648  loss:1.1107,stance loss: 0.9363 
Train step: 1110 acc:0.70583 total_loss: 1.0695  loss:1.2236,stance loss: 0.94297 
Train step: 1120 acc:0.70368 total_loss: 1.0783  loss:1.1702,stance loss: 1.3413 
Train step: 1130 acc:0.70263 total_loss: 1.0905  loss:0.78536,stance loss: 0.651 
Train step: 1140 acc:0.7006 total_loss: 1.0956  loss:1.028,stance loss: 0.83821 
Train step: 1150 acc:0.70217 total_loss: 1.1  loss:0.8946,stance loss: 0.75338 
Train step: 1160 acc:0.704 total_loss: 1.0981  loss:1.1872,stance loss: 0.87074 
Train step: 1170 acc:0.70602 total_loss: 1.0914  loss:0.84666,stance loss: 0.63502 
Train step: 1180 acc:0.70431 total_loss: 1.1008  loss:1.2977,stance loss: 1.4867 
Train step: 1190 acc:0.70363 total_loss: 1.0979  loss:1.0658,stance loss: 0.90083 
Train step: 1200 acc:0.70227 total_loss: 1.098  loss:1.1799,stance loss: 0.854 
Train step: 1210 acc:0.70286 total_loss: 1.1026  loss:1.6925,stance loss: 1.2856 
Train step: 1220 acc:0.70135 total_loss: 1.107  loss:1.4162,stance loss: 1.5915 
Train step: 1230 acc:0.70224 total_loss: 1.1043  loss:0.69335,stance loss: 0.34578 
Train step: 1240 acc:0.7061 total_loss: 1.0954  loss:1.0011,stance loss: 0.77749 
Train step: 1250 acc:0.70785 total_loss: 1.0934  loss:1.2163,stance loss: 0.89795 
Train step: 1260 acc:0.70611 total_loss: 1.0914  loss:0.8966,stance loss: 0.75954 
Train step: 1270 acc:0.70426 total_loss: 1.092  loss:0.87361,stance loss: 0.45642 
Train step: 1280 acc:0.70408 total_loss: 1.0982  loss:0.97348,stance loss: 0.64637 
Train step: 1290 acc:0.70686 total_loss: 1.096  loss:1.1404,stance loss: 1.4317 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.71875 total_loss: 1.2325  loss:1.3259,stance loss: 0.9965 
Train step: 1310 acc:0.76953 total_loss: 1.058  loss:0.9606,stance loss: 0.78124 
Train step: 1320 acc:0.75481 total_loss: 1.0532  loss:0.80969,stance loss: 0.55369 
Train step: 1330 acc:0.77257 total_loss: 0.98358  loss:1.1469,stance loss: 0.90142 
Train step: 1340 acc:0.75951 total_loss: 1.039  loss:0.9901,stance loss: 0.67676 
Train step: 1350 acc:0.75781 total_loss: 1.0503  loss:0.89034,stance loss: 0.62642 
Train step: 1360 acc:0.75189 total_loss: 1.0602  loss:1.4502,stance loss: 1.2226 
Train step: 1370 acc:0.75411 total_loss: 1.0354  loss:0.62846,stance loss: 0.54538 
Train step: 1380 acc:0.75436 total_loss: 1.0381  loss:1.2572,stance loss: 1.0276 
Train step: 1390 acc:0.75716 total_loss: 1.0443  loss:1.102,stance loss: 1.2779 
Train step: 1400 acc:0.76002 total_loss: 1.034  loss:0.8872,stance loss: 0.7324 
Train step: 1410 acc:0.76293 total_loss: 1.0273  loss:0.83148,stance loss: 0.74958 
Train step: 1420 acc:0.76339 total_loss: 1.0136  loss:1.1078,stance loss: 0.71944 
Train step: 1430 acc:0.76608 total_loss: 0.99909  loss:0.95279,stance loss: 0.62252 
Train step: 1440 acc:0.76798 total_loss: 1.0002  loss:0.89923,stance loss: 0.77555 
Train step: 1450 acc:0.76603 total_loss: 1.0021  loss:1.2893,stance loss: 1.0548 
Train step: 1460 acc:0.76431 total_loss: 0.99948  loss:0.93654,stance loss: 0.66538 
Train step: 1470 acc:0.76349 total_loss: 1.0046  loss:0.37503,stance loss: 0.23365 
Train step: 1480 acc:0.75806 total_loss: 1.0116  loss:1.4154,stance loss: 1.0082 
Train step: 1490 acc:0.75829 total_loss: 1.009  loss:1.109,stance loss: 0.85723 
Train step: 1500 acc:0.75667 total_loss: 1.0042  loss:0.83633,stance loss: 0.55066 
Train step: 1510 acc:0.75492 total_loss: 1.0024  loss:0.82302,stance loss: 0.6163 
Train step: 1520 acc:0.75332 total_loss: 1.0064  loss:0.80256,stance loss: 0.60624 
Train step: 1530 acc:0.75132 total_loss: 1.0044  loss:0.70457,stance loss: 0.35984 
Train step: 1540 acc:0.75102 total_loss: 0.999  loss:0.73976,stance loss: 0.63917 
Train step: 1550 acc:0.75024 total_loss: 0.99966  loss:0.43734,stance loss: 0.27256 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.74107 total_loss: 0.91685  loss:0.18627,stance loss: 0.041195 
Train step: 1570 acc:0.80147 total_loss: 0.86372  loss:0.49559,stance loss: 0.33471 
Train step: 1580 acc:0.79167 total_loss: 0.87758  loss:0.6421,stance loss: 0.41869 
Train step: 1590 acc:0.81081 total_loss: 0.82316  loss:0.6965,stance loss: 0.64047 
Train step: 1600 acc:0.7992 total_loss: 0.82656  loss:1.3657,stance loss: 1.0591 
Train step: 1610 acc:0.79276 total_loss: 0.86283  loss:0.83461,stance loss: 0.68239 
Train step: 1620 acc:0.78451 total_loss: 0.8835  loss:1.1652,stance loss: 0.86778 
Train step: 1630 acc:0.7914 total_loss: 0.87074  loss:0.63244,stance loss: 0.52886 
Train step: 1640 acc:0.78592 total_loss: 0.88459  loss:0.90087,stance loss: 0.76081 
Train step: 1650 acc:0.7893 total_loss: 0.88687  loss:1.1656,stance loss: 1.0296 
Train step: 1660 acc:0.7868 total_loss: 0.89578  loss:1.2078,stance loss: 1.1198 
Train step: 1670 acc:0.78632 total_loss: 0.9025  loss:0.55913,stance loss: 0.44535 
Train step: 1680 acc:0.78937 total_loss: 0.89891  loss:0.80776,stance loss: 0.63669 
Train step: 1690 acc:0.7906 total_loss: 0.89689  loss:0.88186,stance loss: 0.67255 
Train step: 1700 acc:0.79082 total_loss: 0.89617  loss:0.81471,stance loss: 0.70635 
Train step: 1710 acc:0.78782 total_loss: 0.89171  loss:0.48775,stance loss: 0.36058 
Train step: 1720 acc:0.7878 total_loss: 0.89164  loss:1.4806,stance loss: 0.96648 
Train step: 1730 acc:0.78778 total_loss: 0.88675  loss:0.92753,stance loss: 0.68713 
Train step: 1740 acc:0.7871 total_loss: 0.89267  loss:0.97561,stance loss: 0.71271 
Train step: 1750 acc:0.7849 total_loss: 0.8962  loss:1.2906,stance loss: 0.88202 
Train step: 1760 acc:0.78684 total_loss: 0.88856  loss:0.48081,stance loss: 0.32301 
Train step: 1770 acc:0.78427 total_loss: 0.89576  loss:0.86799,stance loss: 0.76292 
Train step: 1780 acc:0.78442 total_loss: 0.89302  loss:0.28437,stance loss: 0.07625 
Train step: 1790 acc:0.78323 total_loss: 0.89635  loss:0.69091,stance loss: 0.54398 
Train step: 1800 acc:0.7834 total_loss: 0.89387  loss:1.1232,stance loss: 1.4228 
Train step: 1810 acc:0.78453 total_loss: 0.89314  loss:1.2226,stance loss: 1.5594 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.79688 total_loss: 0.87553  loss:0.80668,stance loss: 0.69508 
Train step: 1830 acc:0.8125 total_loss: 0.85058  loss:0.51159,stance loss: 0.28921 
Train step: 1840 acc:0.82366 total_loss: 0.8048  loss:0.68987,stance loss: 0.20097 
Train step: 1850 acc:0.83224 total_loss: 0.78221  loss:1.1107,stance loss: 0.90535 
Train step: 1860 acc:0.82682 total_loss: 0.78762  loss:0.74002,stance loss: 0.64534 
Train step: 1870 acc:0.82651 total_loss: 0.79127  loss:0.58287,stance loss: 0.50191 
Train step: 1880 acc:0.82629 total_loss: 0.79035  loss:1.265,stance loss: 1.0212 
Train step: 1890 acc:0.82131 total_loss: 0.7906  loss:0.41115,stance loss: 0.28357 
Train step: 1900 acc:0.82315 total_loss: 0.79355  loss:0.82617,stance loss: 0.69312 
Train step: 1910 acc:0.82143 total_loss: 0.78445  loss:0.96931,stance loss: 0.82406 
Train step: 1920 acc:0.82118 total_loss: 0.77228  loss:0.42306,stance loss: 0.25846 
Train step: 1930 acc:0.81992 total_loss: 0.78293  loss:1.45,stance loss: 1.3426 
Train step: 1940 acc:0.81689 total_loss: 0.78627  loss:1.0368,stance loss: 0.83971 
Train step: 1950 acc:0.81929 total_loss: 0.78144  loss:0.78484,stance loss: 0.6294 
Train step: 1960 acc:0.8201 total_loss: 0.78201  loss:1.1351,stance loss: 1.3974 
Train step: 1970 acc:0.82002 total_loss: 0.77686  loss:0.5684,stance loss: 0.34612 
Train step: 1980 acc:0.81734 total_loss: 0.77882  loss:0.9191,stance loss: 0.64815 
Train step: 1990 acc:0.81777 total_loss: 0.77934  loss:0.71084,stance loss: 0.6742 
Train step: 2000 acc:0.81616 total_loss: 0.77945  loss:0.65161,stance loss: 0.52654 
Train step: 2010 acc:0.81723 total_loss: 0.78118  loss:0.77933,stance loss: 0.63522 
Train step: 2020 acc:0.81791 total_loss: 0.78258  loss:1.3669,stance loss: 1.6586 
Train step: 2030 acc:0.82053 total_loss: 0.77741  loss:0.92207,stance loss: 1.2122 
Train step: 2040 acc:0.82155 total_loss: 0.77286  loss:0.76968,stance loss: 0.68551 
Train step: 2050 acc:0.82327 total_loss: 0.76794  loss:0.70329,stance loss: 0.55437 
Train step: 2060 acc:0.82258 total_loss: 0.7667  loss:1.1108,stance loss: 0.78978 
Train step: 2070 acc:0.82364 total_loss: 0.75727  loss:0.55344,stance loss: 0.49657 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.86806 total_loss: 0.6436  loss:0.50557,stance loss: 0.42498 
Train step: 2090 acc:0.87829 total_loss: 0.61391  loss:0.097564,stance loss: 0.014352 
Train step: 2100 acc:0.875 total_loss: 0.6205  loss:0.43628,stance loss: 0.34792 
Train step: 2110 acc:0.87821 total_loss: 0.61285  loss:0.6233,stance loss: 0.53006 
Train step: 2120 acc:0.8801 total_loss: 0.60177  loss:0.41739,stance loss: 0.33044 
Train step: 2130 acc:0.87924 total_loss: 0.59136  loss:0.81638,stance loss: 0.48151 
Train step: 2140 acc:0.87409 total_loss: 0.61245  loss:0.70355,stance loss: 0.53572 
Train step: 2150 acc:0.86946 total_loss: 0.62699  loss:1.2034,stance loss: 1.1177 
Train step: 2160 acc:0.8736 total_loss: 0.61732  loss:0.48537,stance loss: 0.40144 
Train step: 2170 acc:0.86869 total_loss: 0.61528  loss:0.70085,stance loss: 0.28056 
Train step: 2180 acc:0.86812 total_loss: 0.61726  loss:0.62239,stance loss: 0.52345 
Train step: 2190 acc:0.86975 total_loss: 0.61018  loss:0.32294,stance loss: 0.22331 
Train step: 2200 acc:0.86579 total_loss: 0.62144  loss:0.69888,stance loss: 0.642 
Train step: 2210 acc:0.86601 total_loss: 0.62851  loss:1.2858,stance loss: 1.437 
Train step: 2220 acc:0.86661 total_loss: 0.62333  loss:0.55231,stance loss: 0.43896 
Train step: 2230 acc:0.86439 total_loss: 0.62951  loss:0.37268,stance loss: 0.24806 
Train step: 2240 acc:0.86095 total_loss: 0.63783  loss:0.3927,stance loss: 0.26008 
Train step: 2250 acc:0.86034 total_loss: 0.63426  loss:0.57577,stance loss: 0.44211 
Train step: 2260 acc:0.8621 total_loss: 0.62406  loss:0.29583,stance loss: 0.16043 
Train step: 2270 acc:0.86401 total_loss: 0.62492  loss:0.6614,stance loss: 0.55574 
Train step: 2280 acc:0.86423 total_loss: 0.62064  loss:0.59663,stance loss: 0.52302 
Train step: 2290 acc:0.86216 total_loss: 0.62738  loss:0.90259,stance loss: 0.70355 
Train step: 2300 acc:0.86217 total_loss: 0.63019  loss:0.20623,stance loss: 0.039619 
Train step: 2310 acc:0.86062 total_loss: 0.63712  loss:0.51945,stance loss: 0.39442 
Train step: 2320 acc:0.86069 total_loss: 0.63782  loss:0.44656,stance loss: 0.23929 
Train step: 2330 acc:0.86029 total_loss: 0.64326  loss:1.6625,stance loss: 2.4577 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.8625 total_loss: 0.71146  loss:0.97718,stance loss: 1.3737 
Train step: 2350 acc:0.89062 total_loss: 0.58395  loss:0.51251,stance loss: 0.40487 
Train step: 2360 acc:0.90833 total_loss: 0.52214  loss:0.22395,stance loss: 0.1841 
Train step: 2370 acc:0.91563 total_loss: 0.48463  loss:0.16999,stance loss: 0.11431 
Train step: 2380 acc:0.90375 total_loss: 0.50749  loss:0.19948,stance loss: 0.087369 
Train step: 2390 acc:0.90625 total_loss: 0.49942  loss:0.36126,stance loss: 0.27756 
Train step: 2400 acc:0.90357 total_loss: 0.52128  loss:0.12012,stance loss: 0.052492 
Train step: 2410 acc:0.89766 total_loss: 0.53273  loss:0.78537,stance loss: 0.4258 
Train step: 2420 acc:0.89861 total_loss: 0.52245  loss:1.0577,stance loss: 0.85457 
Train step: 2430 acc:0.895 total_loss: 0.51893  loss:0.40487,stance loss: 0.19063 
Train step: 2440 acc:0.89773 total_loss: 0.5054  loss:0.30951,stance loss: 0.27515 
Train step: 2450 acc:0.8974 total_loss: 0.5043  loss:0.20691,stance loss: 0.18534 
Train step: 2460 acc:0.89808 total_loss: 0.50799  loss:0.47617,stance loss: 0.42635 
Train step: 2470 acc:0.89911 total_loss: 0.50445  loss:0.30277,stance loss: 0.2621 
Train step: 2480 acc:0.89875 total_loss: 0.50737  loss:0.14035,stance loss: 0.032165 
Train step: 2490 acc:0.89805 total_loss: 0.50786  loss:0.58225,stance loss: 0.54935 
Train step: 2500 acc:0.89816 total_loss: 0.50788  loss:0.84205,stance loss: 0.50089 
Train step: 2510 acc:0.89722 total_loss: 0.51058  loss:0.58228,stance loss: 0.49024 
Train step: 2520 acc:0.89539 total_loss: 0.51445  loss:0.10491,stance loss: 0.034023 
Train step: 2530 acc:0.89531 total_loss: 0.51451  loss:0.54996,stance loss: 0.39148 
Train step: 2540 acc:0.89613 total_loss: 0.50947  loss:0.40861,stance loss: 0.25965 
Train step: 2550 acc:0.89716 total_loss: 0.50222  loss:0.1519,stance loss: 0.075573 
Train step: 2560 acc:0.89647 total_loss: 0.50771  loss:0.80955,stance loss: 1.2766 
Train step: 2570 acc:0.89661 total_loss: 0.50647  loss:0.74492,stance loss: 0.62875 
Train step: 2580 acc:0.8965 total_loss: 0.50892  loss:0.10402,stance loss: 0.040445 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:1.0 total_loss: 0.10734  loss:0.10734,stance loss: 0.048375 
Train step: 2600 acc:0.93182 total_loss: 0.44727  loss:0.85522,stance loss: 1.1256 
Train step: 2610 acc:0.92857 total_loss: 0.44341  loss:0.26676,stance loss: 0.13826 
Train step: 2620 acc:0.9254 total_loss: 0.42575  loss:0.52775,stance loss: 0.33098 
Train step: 2630 acc:0.91463 total_loss: 0.45505  loss:0.46919,stance loss: 0.39912 
Train step: 2640 acc:0.91544 total_loss: 0.43541  loss:0.38965,stance loss: 0.39089 
Train step: 2650 acc:0.91906 total_loss: 0.43536  loss:0.22322,stance loss: 0.10618 
Train step: 2660 acc:0.92606 total_loss: 0.42051  loss:0.098843,stance loss: 0.028678 
Train step: 2670 acc:0.92515 total_loss: 0.41846  loss:0.26321,stance loss: 0.060833 
Train step: 2680 acc:0.92445 total_loss: 0.41465  loss:0.20658,stance loss: 0.19151 
Train step: 2690 acc:0.92698 total_loss: 0.40209  loss:0.16399,stance loss: 0.053715 
Train step: 2700 acc:0.92568 total_loss: 0.40741  loss:0.067789,stance loss: 0.0096871 
Train step: 2710 acc:0.92769 total_loss: 0.41484  loss:1.0418,stance loss: 1.0553 
Train step: 2720 acc:0.92844 total_loss: 0.41144  loss:0.94223,stance loss: 0.95748 
Train step: 2730 acc:0.92863 total_loss: 0.40731  loss:0.088433,stance loss: 0.051196 
Train step: 2740 acc:0.92715 total_loss: 0.41481  loss:0.89007,stance loss: 1.3658 
Train step: 2750 acc:0.92663 total_loss: 0.41151  loss:0.38558,stance loss: 0.29022 
Train step: 2760 acc:0.92654 total_loss: 0.41586  loss:0.47013,stance loss: 0.4072 
Train step: 2770 acc:0.92541 total_loss: 0.41512  loss:0.19454,stance loss: 0.15524 
Train step: 2780 acc:0.92605 total_loss: 0.41845  loss:0.58284,stance loss: 0.5238 
Train step: 2790 acc:0.92568 total_loss: 0.4204  loss:0.061388,stance loss: 0.017363 
Train step: 2800 acc:0.92387 total_loss: 0.42375  loss:0.57666,stance loss: 0.43451 
Train step: 2810 acc:0.92477 total_loss: 0.41847  loss:0.084763,stance loss: 0.038839 
Train step: 2820 acc:0.92235 total_loss: 0.4236  loss:0.41436,stance loss: 0.20837 
Train step: 2830 acc:0.92246 total_loss: 0.42346  loss:0.21349,stance loss: 0.12802 
Train step: 2840 acc:0.92256 total_loss: 0.42005  loss:0.8804,stance loss: 1.1905 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.96875 total_loss: 0.21763  loss:0.32375,stance loss: 0.26609 
Train step: 2860 acc:0.9375 total_loss: 0.36814  loss:0.40078,stance loss: 0.37067 
Train step: 2870 acc:0.93466 total_loss: 0.43204  loss:0.46935,stance loss: 0.46607 
Train step: 2880 acc:0.9375 total_loss: 0.40388  loss:0.17507,stance loss: 0.083107 
Train step: 2890 acc:0.94048 total_loss: 0.40286  loss:0.52591,stance loss: 0.3661 
Train step: 2900 acc:0.9375 total_loss: 0.37563  loss:0.10411,stance loss: 0.044481 
Train step: 2910 acc:0.93952 total_loss: 0.37522  loss:0.67242,stance loss: 0.54557 
Train step: 2920 acc:0.9349 total_loss: 0.39616  loss:1.1471,stance loss: 1.3685 
Train step: 2930 acc:0.93826 total_loss: 0.38123  loss:0.67589,stance loss: 0.53778 
Train step: 2940 acc:0.9341 total_loss: 0.38957  loss:0.55879,stance loss: 0.38825 
Train step: 2950 acc:0.93321 total_loss: 0.38861  loss:0.66223,stance loss: 0.51664 
Train step: 2960 acc:0.93248 total_loss: 0.38563  loss:0.48713,stance loss: 0.27577 
Train step: 2970 acc:0.9293 total_loss: 0.38736  loss:0.19327,stance loss: 0.13182 
Train step: 2980 acc:0.92898 total_loss: 0.38189  loss:0.11307,stance loss: 0.06091 
Better F1! Saving model!
Saving model of best f1: 0.3935474860335195
              precision    recall  f1-score   support

           0   0.703016  0.653017  0.677095       464
           1   0.358407  0.558621  0.436658       145
           2   0.144737  0.088710  0.110000       124

    accuracy                       0.538881       733
   macro avg   0.402053  0.433449  0.407918       733
weighted avg   0.540404  0.538881  0.533598       733

Test Acc: 0.538881309686221 F1_ma:0.3935474860335195
Train step: 2990 acc:0.93046 total_loss: 0.37507  loss:0.097566,stance loss: 0.057664 
Train step: 3000 acc:0.93133 total_loss: 0.37114  loss:0.25995,stance loss: 0.011047 
Train step: 3010 acc:0.93056 total_loss: 0.37744  loss:0.46737,stance loss: 0.3771 
Train step: 3020 acc:0.93205 total_loss: 0.37146  loss:0.033466,stance loss: 0.0037946 
Train step: 3030 acc:0.93338 total_loss: 0.36787  loss:0.26371,stance loss: 0.16931 
Train step: 3040 acc:0.93392 total_loss: 0.35951  loss:0.095589,stance loss: 0.044168 
Train step: 3050 acc:0.9341 total_loss: 0.35701  loss:0.5234,stance loss: 0.40901 
Train step: 3060 acc:0.93337 total_loss: 0.35749  loss:0.18712,stance loss: 0.091367 
Train step: 3070 acc:0.93412 total_loss: 0.35263  loss:0.50535,stance loss: 0.38838 
Train step: 3080 acc:0.93508 total_loss: 0.35027  loss:0.14246,stance loss: 0.14648 
Train step: 3090 acc:0.93621 total_loss: 0.34752  loss:0.11389,stance loss: 0.080386 
Train step: 3100 acc:0.93676 total_loss: 0.34424  loss:0.5385,stance loss: 0.57385 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.9375 total_loss: 0.37183  loss:0.31905,stance loss: 0.14678 
Train step: 3120 acc:0.9375 total_loss: 0.32325  loss:0.36803,stance loss: 0.20862 
Train step: 3130 acc:0.9538 total_loss: 0.24582  loss:0.043844,stance loss: 0.011666 
Train step: 3140 acc:0.95644 total_loss: 0.26028  loss:0.19454,stance loss: 0.20703 
Train step: 3150 acc:0.95494 total_loss: 0.2769  loss:0.85623,stance loss: 1.1861 
Train step: 3160 acc:0.95401 total_loss: 0.29671  loss:0.70843,stance loss: 0.66276 
Train step: 3170 acc:0.95238 total_loss: 0.30961  loss:0.064363,stance loss: 0.028935 
Train step: 3180 acc:0.95291 total_loss: 0.29381  loss:0.45881,stance loss: 0.35247 
Train step: 3190 acc:0.95181 total_loss: 0.29086  loss:0.19609,stance loss: 0.11731 
Train step: 3200 acc:0.95228 total_loss: 0.28454  loss:0.0448,stance loss: 0.0091105 
Train step: 3210 acc:0.95085 total_loss: 0.28938  loss:0.14382,stance loss: 0.11103 
Train step: 3220 acc:0.95022 total_loss: 0.29984  loss:0.028466,stance loss: 0.0061376 
Train step: 3230 acc:0.94868 total_loss: 0.29996  loss:0.053713,stance loss: 0.0026245 
Train step: 3240 acc:0.94878 total_loss: 0.30703  loss:0.09533,stance loss: 0.007246 
Train step: 3250 acc:0.9493 total_loss: 0.30824  loss:0.052653,stance loss: 0.024374 
Train step: 3260 acc:0.94935 total_loss: 0.30434  loss:0.18954,stance loss: 0.15098 
Train step: 3270 acc:0.94939 total_loss: 0.3045  loss:0.04268,stance loss: 0.0048123 
Train step: 3280 acc:0.94978 total_loss: 0.30141  loss:0.059394,stance loss: 0.020347 
Train step: 3290 acc:0.95014 total_loss: 0.2989  loss:0.081951,stance loss: 0.031696 
Train step: 3300 acc:0.95045 total_loss: 0.29342  loss:0.75322,stance loss: 0.74947 
Train step: 3310 acc:0.95135 total_loss: 0.28842  loss:0.2406,stance loss: 0.22737 
Train step: 3320 acc:0.95129 total_loss: 0.28282  loss:0.028883,stance loss: 0.0018701 
Train step: 3330 acc:0.95095 total_loss: 0.28194  loss:0.10059,stance loss: 0.027182 
Train step: 3340 acc:0.94984 total_loss: 0.2832  loss:0.25034,stance loss: 0.20768 
Train step: 3350 acc:0.95036 total_loss: 0.28015  loss:0.13405,stance loss: 0.10213 
Train step: 3360 acc:0.9496 total_loss: 0.28544  loss:0.35724,stance loss: 0.37041 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.96875 total_loss: 0.31194  loss:0.25946,stance loss: 0.28623 
Train step: 3380 acc:0.95089 total_loss: 0.27017  loss:0.11262,stance loss: 0.055022 
Train step: 3390 acc:0.95052 total_loss: 0.28793  loss:1.023,stance loss: 0.98824 
Train step: 3400 acc:0.9614 total_loss: 0.24386  loss:0.50218,stance loss: 0.54621 
Train step: 3410 acc:0.96449 total_loss: 0.24391  loss:0.44198,stance loss: 0.29361 
Train step: 3420 acc:0.96644 total_loss: 0.25541  loss:0.55891,stance loss: 1.0146 
Train step: 3430 acc:0.96289 total_loss: 0.25294  loss:0.43368,stance loss: 0.44953 
Train step: 3440 acc:0.96537 total_loss: 0.24872  loss:0.044912,stance loss: 0.029737 
Train step: 3450 acc:0.96354 total_loss: 0.24493  loss:0.092486,stance loss: 0.044696 
Train step: 3460 acc:0.96011 total_loss: 0.24298  loss:0.036462,stance loss: 0.0033571 
Train step: 3470 acc:0.95853 total_loss: 0.24072  loss:0.19239,stance loss: 0.18549 
Train step: 3480 acc:0.95669 total_loss: 0.25061  loss:0.054627,stance loss: 0.025942 
Train step: 3490 acc:0.95766 total_loss: 0.24598  loss:0.38082,stance loss: 0.25365 
Train step: 3500 acc:0.95662 total_loss: 0.24973  loss:0.060004,stance loss: 0.011183 
Train step: 3510 acc:0.95747 total_loss: 0.25295  loss:0.56024,stance loss: 1.0167 
Train step: 3520 acc:0.95698 total_loss: 0.25384  loss:0.026186,stance loss: 0.0039221 
Train step: 3530 acc:0.95732 total_loss: 0.25542  loss:0.15013,stance loss: 0.086565 
Train step: 3540 acc:0.95833 total_loss: 0.25063  loss:0.038753,stance loss: 0.009375 
Train step: 3550 acc:0.95686 total_loss: 0.26012  loss:0.39457,stance loss: 0.30215 
Train step: 3560 acc:0.95715 total_loss: 0.26026  loss:0.10414,stance loss: 0.06805 
Train step: 3570 acc:0.95772 total_loss: 0.25526  loss:0.027645,stance loss: 0.0062661 
Train step: 3580 acc:0.95736 total_loss: 0.25364  loss:0.27155,stance loss: 0.22621 
Train step: 3590 acc:0.95731 total_loss: 0.25115  loss:0.03684,stance loss: 0.010547 
Train step: 3600 acc:0.95833 total_loss: 0.24888  loss:0.031477,stance loss: 0.007314 
Train step: 3610 acc:0.95902 total_loss: 0.24424  loss:0.047123,stance loss: 0.020599 
Train step: 3620 acc:0.95965 total_loss: 0.24286  loss:0.05462,stance loss: 0.024089 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9375 total_loss: 0.37749  loss:0.56303,stance loss: 0.35751 
Train step: 3640 acc:0.96667 total_loss: 0.22507  loss:0.022782,stance loss: 0.003044 
Train step: 3650 acc:0.9725 total_loss: 0.17305  loss:0.048678,stance loss: 0.012553 
Train step: 3660 acc:0.975 total_loss: 0.17463  loss:0.61431,stance loss: 0.61198 
Train step: 3670 acc:0.97083 total_loss: 0.17854  loss:0.17445,stance loss: 0.050411 
Train step: 3680 acc:0.97386 total_loss: 0.1771  loss:0.024416,stance loss: 0.0025953 
Train step: 3690 acc:0.975 total_loss: 0.17457  loss:0.22437,stance loss: 0.13735 
Train step: 3700 acc:0.975 total_loss: 0.17203  loss:0.11587,stance loss: 0.02219 
Train step: 3710 acc:0.97206 total_loss: 0.18264  loss:0.037072,stance loss: 0.0073672 
Train step: 3720 acc:0.97237 total_loss: 0.1745  loss:0.038277,stance loss: 0.0099256 
Train step: 3730 acc:0.97262 total_loss: 0.17703  loss:0.085825,stance loss: 0.065752 
Train step: 3740 acc:0.96902 total_loss: 0.18329  loss:0.52084,stance loss: 1.0078 
Train step: 3750 acc:0.97 total_loss: 0.17957  loss:0.30128,stance loss: 0.18043 
Train step: 3760 acc:0.9713 total_loss: 0.17987  loss:0.53497,stance loss: 1.0165 
Train step: 3770 acc:0.96983 total_loss: 0.18945  loss:0.2395,stance loss: 0.23134 
Train step: 3780 acc:0.97016 total_loss: 0.19129  loss:0.061966,stance loss: 0.035785 
Train step: 3790 acc:0.97045 total_loss: 0.18863  loss:0.12082,stance loss: 0.056636 
Train step: 3800 acc:0.97107 total_loss: 0.18732  loss:0.03314,stance loss: 0.011518 
Train step: 3810 acc:0.97128 total_loss: 0.18394  loss:0.020059,stance loss: 0.0031906 
Better F1! Saving model!
Saving model of best f1: 0.4023836029705881
              precision    recall  f1-score   support

           0   0.692695  0.592672  0.638792       464
           1   0.337900  0.510345  0.406593       145
           2   0.170940  0.161290  0.165975       124

    accuracy                       0.503411       733
   macro avg   0.400512  0.421436  0.403787       733
weighted avg   0.534246  0.503411  0.512874       733

Test Acc: 0.5034106412005457 F1_ma:0.4023836029705881
Train step: 3820 acc:0.97179 total_loss: 0.18156  loss:0.014566,stance loss: 0.0021291 
Train step: 3830 acc:0.97165 total_loss: 0.1801  loss:0.033431,stance loss: 0.0067126 
Train step: 3840 acc:0.9718 total_loss: 0.17818  loss:0.12631,stance loss: 0.061301 
Train step: 3850 acc:0.97111 total_loss: 0.17987  loss:0.050438,stance loss: 0.030474 
Train step: 3860 acc:0.97048 total_loss: 0.1809  loss:0.22693,stance loss: 0.24545 
Train step: 3870 acc:0.97117 total_loss: 0.17635  loss:0.032059,stance loss: 0.023581 
Train step: 3880 acc:0.97108 total_loss: 0.17605  loss:0.12962,stance loss: 0.071064 
Training finished.


Reload the best model with best f1 0.4023836029705881 from path test_outputs/bert-cross-topic/a/2023-08-14 16-19-04/state_dict


              precision    recall  f1-score   support

           0   0.692695  0.592672  0.638792       464
           1   0.337900  0.510345  0.406593       145
           2   0.170940  0.161290  0.165975       124

    accuracy                       0.503411       733
   macro avg   0.400512  0.421436  0.403787       733
weighted avg   0.534246  0.503411  0.512874       733

Test Acc: 0.5034106412005457 F1_ma:0.4023836029705881
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4023836029705881
acc: 0.5034106412005457, f1 :0.4037868708448609
classification report: 
              precision    recall  f1-score   support

         Con     0.6927    0.5927    0.6388       464
        None     0.3379    0.5103    0.4066       145
         Pro     0.1709    0.1613    0.1660       124

    accuracy                         0.5034       733
   macro avg     0.4005    0.4214    0.4038       733
weighted avg     0.5342    0.5034    0.5129       733

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 16-38-46', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 16-38-46
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 2.0241  loss:2.0241,stance loss: 1.3 
Train step: 10 acc:0.30114 total_loss: 1.7357  loss:1.6605,stance loss: 1.0844 
Better F1! Saving model!
Saving model of best f1: 0.02663934426229508
              precision    recall  f1-score   support

           0   0.541667  0.028017  0.053279       464
           1   0.190409  0.931034  0.316159       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.201910       733
   macro avg   0.244025  0.319684  0.123146       733
weighted avg   0.380549  0.201910  0.096268       733

Test Acc: 0.2019099590723056 F1_ma:0.02663934426229508
Train step: 20 acc:0.34226 total_loss: 1.6979  loss:1.6943,stance loss: 1.1232 
Better F1! Saving model!
Saving model of best f1: 0.3877721943048576
              precision    recall  f1-score   support

           0   0.634247  0.997845  0.775544       464
           1   0.333333  0.006897  0.013514       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.322527  0.334914  0.263019       733
weighted avg   0.467427  0.633015  0.493604       733

Test Acc: 0.6330150068212824 F1_ma:0.3877721943048576
Train step: 30 acc:0.36895 total_loss: 1.6962  loss:1.614,stance loss: 1.2391 
Train step: 40 acc:0.39177 total_loss: 1.6855  loss:1.6368,stance loss: 1.1105 
Train step: 50 acc:0.41299 total_loss: 1.6807  loss:1.8331,stance loss: 1.7019 
Train step: 60 acc:0.41393 total_loss: 1.6868  loss:1.682,stance loss: 1.2063 
Train step: 70 acc:0.42518 total_loss: 1.6763  loss:1.5209,stance loss: 1.0432 
Train step: 80 acc:0.43441 total_loss: 1.6678  loss:1.623,stance loss: 1.5443 
Train step: 90 acc:0.43956 total_loss: 1.6594  loss:1.6553,stance loss: 1.1819 
Train step: 100 acc:0.44678 total_loss: 1.6541  loss:1.356,stance loss: 0.88051 
Train step: 110 acc:0.45101 total_loss: 1.6582  loss:1.727,stance loss: 1.1789 
Train step: 120 acc:0.45816 total_loss: 1.6534  loss:1.375,stance loss: 0.89061 
Train step: 130 acc:0.46469 total_loss: 1.6468  loss:1.658,stance loss: 1.1644 
Train step: 140 acc:0.47207 total_loss: 1.6394  loss:1.4333,stance loss: 0.67768 
Train step: 150 acc:0.47517 total_loss: 1.634  loss:1.6301,stance loss: 1.2982 
Train step: 160 acc:0.4736 total_loss: 1.6303  loss:1.7436,stance loss: 0.94848 
Train step: 170 acc:0.47844 total_loss: 1.6251  loss:1.6436,stance loss: 1.1071 
Train step: 180 acc:0.47825 total_loss: 1.6221  loss:1.5917,stance loss: 0.88444 
Train step: 190 acc:0.48233 total_loss: 1.62  loss:1.8512,stance loss: 1.2503 
Train step: 200 acc:0.48352 total_loss: 1.6191  loss:1.693,stance loss: 1.1282 
Train step: 210 acc:0.484 total_loss: 1.617  loss:1.7161,stance loss: 0.96398 
Train step: 220 acc:0.48643 total_loss: 1.6139  loss:1.5165,stance loss: 1.1122 
Train step: 230 acc:0.48864 total_loss: 1.6115  loss:1.8046,stance loss: 1.7328 
Train step: 240 acc:0.48989 total_loss: 1.6093  loss:1.436,stance loss: 1.022 
Train step: 250 acc:0.49353 total_loss: 1.6029  loss:1.4405,stance loss: 0.86985 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.625 total_loss: 1.6856  loss:1.5259,stance loss: 1.5558 
Train step: 270 acc:0.58333 total_loss: 1.538  loss:1.4992,stance loss: 1.1355 
Train step: 280 acc:0.57102 total_loss: 1.5334  loss:1.51,stance loss: 0.95327 
Train step: 290 acc:0.58008 total_loss: 1.4948  loss:1.3467,stance loss: 0.92871 
Train step: 300 acc:0.5744 total_loss: 1.4756  loss:1.31,stance loss: 0.92768 
Train step: 310 acc:0.59375 total_loss: 1.4496  loss:1.1957,stance loss: 0.77579 
Train step: 320 acc:0.59879 total_loss: 1.4233  loss:1.1607,stance loss: 0.80947 
Train step: 330 acc:0.59722 total_loss: 1.4158  loss:1.1799,stance loss: 0.52217 
Train step: 340 acc:0.59604 total_loss: 1.4099  loss:1.8323,stance loss: 1.2599 
Train step: 350 acc:0.59579 total_loss: 1.4031  loss:1.361,stance loss: 1.0414 
Train step: 360 acc:0.59498 total_loss: 1.4082  loss:1.3438,stance loss: 1.0901 
Train step: 370 acc:0.59542 total_loss: 1.4012  loss:1.0909,stance loss: 0.72145 
Better F1! Saving model!
Saving model of best f1: 0.388374052232519
              precision    recall  f1-score   support

           0   0.637621  0.993534  0.776748       464
           1   0.700000  0.048276  0.090323       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.638472       733
   macro avg   0.445874  0.347270  0.289024       733
weighted avg   0.542096  0.638472  0.509561       733

Test Acc: 0.6384720327421555 F1_ma:0.388374052232519
Train step: 380 acc:0.5999 total_loss: 1.3873  loss:1.3424,stance loss: 0.83067 
Train step: 390 acc:0.60417 total_loss: 1.3878  loss:1.2664,stance loss: 0.70682 
Train step: 400 acc:0.60475 total_loss: 1.3781  loss:1.2601,stance loss: 0.87534 
Train step: 410 acc:0.60855 total_loss: 1.3776  loss:1.2094,stance loss: 0.79402 
Train step: 420 acc:0.60687 total_loss: 1.3728  loss:1.1454,stance loss: 0.69275 
Train step: 430 acc:0.60901 total_loss: 1.3671  loss:1.2397,stance loss: 0.85747 
Train step: 440 acc:0.61092 total_loss: 1.3665  loss:1.2192,stance loss: 1.1149 
Better F1! Saving model!
Saving model of best f1: 0.4120893195640878
              precision    recall  f1-score   support

           0   0.673575  0.840517  0.747843       464
           1   0.489796  0.496552  0.493151       145
           2   0.714286  0.040323  0.076336       124

    accuracy                       0.637108       733
   macro avg   0.625886  0.459131  0.439110       733
weighted avg   0.644107  0.637108  0.583863       733

Test Acc: 0.6371077762619373 F1_ma:0.4120893195640878
Train step: 450 acc:0.61068 total_loss: 1.3654  loss:1.1083,stance loss: 0.81106 
Better F1! Saving model!
Saving model of best f1: 0.5914995990376904
              precision    recall  f1-score   support

           0   0.707469  0.734914  0.720930       464
           1   0.600000  0.351724  0.443478       145
           2   0.403614  0.540323  0.462069       124

    accuracy                       0.626194       733
   macro avg   0.570361  0.542320  0.542159       733
weighted avg   0.634807  0.626194  0.622254       733

Test Acc: 0.626193724420191 F1_ma:0.5914995990376904
Train step: 460 acc:0.61015 total_loss: 1.3643  loss:1.2085,stance loss: 0.84485 
Train step: 470 acc:0.6138 total_loss: 1.3599  loss:1.3569,stance loss: 0.99188 
Train step: 480 acc:0.61177 total_loss: 1.3578  loss:1.2644,stance loss: 0.94688 
Train step: 490 acc:0.61369 total_loss: 1.3561  loss:1.492,stance loss: 1.2783 
Train step: 500 acc:0.61183 total_loss: 1.3588  loss:1.2774,stance loss: 0.97433 
Train step: 510 acc:0.6126 total_loss: 1.3567  loss:1.4313,stance loss: 1.1858 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.64583 total_loss: 1.256  loss:1.1946,stance loss: 0.73526 
Train step: 530 acc:0.64904 total_loss: 1.3339  loss:1.3432,stance loss: 0.92524 
Train step: 540 acc:0.67391 total_loss: 1.2811  loss:1.1233,stance loss: 0.79646 
Train step: 550 acc:0.66856 total_loss: 1.262  loss:1.4651,stance loss: 1.2957 
Train step: 560 acc:0.66279 total_loss: 1.2562  loss:0.96313,stance loss: 0.65464 
Train step: 570 acc:0.67335 total_loss: 1.2419  loss:1.2628,stance loss: 1.033 
Train step: 580 acc:0.67163 total_loss: 1.2506  loss:1.2097,stance loss: 0.89656 
Train step: 590 acc:0.67466 total_loss: 1.2481  loss:1.3238,stance loss: 0.97711 
Train step: 600 acc:0.6747 total_loss: 1.2407  loss:1.0959,stance loss: 0.83442 
Train step: 610 acc:0.67406 total_loss: 1.2315  loss:1.3528,stance loss: 1.0809 
Train step: 620 acc:0.67354 total_loss: 1.2304  loss:0.90596,stance loss: 0.7001 
Train step: 630 acc:0.6698 total_loss: 1.234  loss:1.3445,stance loss: 1.1976 
Train step: 640 acc:0.67073 total_loss: 1.2382  loss:1.2475,stance loss: 0.8446 
Train step: 650 acc:0.66917 total_loss: 1.2453  loss:1.6812,stance loss: 1.7643 
Train step: 660 acc:0.66783 total_loss: 1.2445  loss:1.6011,stance loss: 1.6379 
Train step: 670 acc:0.66544 total_loss: 1.2461  loss:0.78792,stance loss: 0.45544 
Train step: 680 acc:0.66449 total_loss: 1.2437  loss:1.1025,stance loss: 0.85385 
Train step: 690 acc:0.66474 total_loss: 1.2426  loss:1.4496,stance loss: 1.1113 
Train step: 700 acc:0.66598 total_loss: 1.2404  loss:1.0571,stance loss: 0.75217 
Train step: 710 acc:0.6671 total_loss: 1.2398  loss:1.2053,stance loss: 0.5891 
Train step: 720 acc:0.66903 total_loss: 1.2343  loss:0.65608,stance loss: 0.4751 
Train step: 730 acc:0.66843 total_loss: 1.2346  loss:0.91666,stance loss: 0.6479 
Train step: 740 acc:0.66788 total_loss: 1.2342  loss:1.2098,stance loss: 0.91185 
Train step: 750 acc:0.66738 total_loss: 1.2313  loss:1.4696,stance loss: 1.593 
Train step: 760 acc:0.66461 total_loss: 1.2336  loss:1.3262,stance loss: 1.0188 
Train step: 770 acc:0.66477 total_loss: 1.2295  loss:1.4589,stance loss: 1.1529 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.6875 total_loss: 1.0749  loss:0.91632,stance loss: 0.5813 
Train step: 790 acc:0.70536 total_loss: 1.053  loss:1.1493,stance loss: 0.85552 
Train step: 800 acc:0.72396 total_loss: 1.02  loss:0.85737,stance loss: 0.50193 
Train step: 810 acc:0.71324 total_loss: 1.0371  loss:1.4581,stance loss: 1.1511 
Train step: 820 acc:0.70455 total_loss: 1.0939  loss:1.277,stance loss: 1.095 
Train step: 830 acc:0.6956 total_loss: 1.1128  loss:1.1339,stance loss: 0.88236 
Train step: 840 acc:0.69531 total_loss: 1.1109  loss:0.99805,stance loss: 0.61221 
Train step: 850 acc:0.69932 total_loss: 1.1082  loss:0.98053,stance loss: 0.58277 
Train step: 860 acc:0.69866 total_loss: 1.1063  loss:1.2063,stance loss: 1.0352 
Train step: 870 acc:0.69947 total_loss: 1.1123  loss:1.1889,stance loss: 0.86122 
Train step: 880 acc:0.70132 total_loss: 1.1113  loss:1.3527,stance loss: 1.0886 
Train step: 890 acc:0.69956 total_loss: 1.1003  loss:1.2605,stance loss: 0.92319 
Train step: 900 acc:0.69859 total_loss: 1.1024  loss:0.97431,stance loss: 0.73284 
Train step: 910 acc:0.70149 total_loss: 1.1027  loss:1.4267,stance loss: 1.2281 
Train step: 920 acc:0.70226 total_loss: 1.1022  loss:0.98696,stance loss: 0.73303 
Train step: 930 acc:0.7013 total_loss: 1.1006  loss:1.2736,stance loss: 0.83686 
Train step: 940 acc:0.70122 total_loss: 1.0975  loss:1.0079,stance loss: 0.86965 
Train step: 950 acc:0.69935 total_loss: 1.103  loss:1.6176,stance loss: 1.3923 
Train step: 960 acc:0.69939 total_loss: 1.1059  loss:1.4575,stance loss: 1.1307 
Train step: 970 acc:0.69716 total_loss: 1.1032  loss:0.98723,stance loss: 0.82991 
Train step: 980 acc:0.69516 total_loss: 1.1059  loss:1.134,stance loss: 0.87811 
Train step: 990 acc:0.69655 total_loss: 1.1107  loss:1.4768,stance loss: 1.5732 
Train step: 1000 acc:0.69866 total_loss: 1.104  loss:0.99842,stance loss: 0.77644 
Train step: 1010 acc:0.69925 total_loss: 1.1042  loss:0.99512,stance loss: 0.91342 
Train step: 1020 acc:0.69749 total_loss: 1.1033  loss:0.64694,stance loss: 0.32107 
Train step: 1030 acc:0.69685 total_loss: 1.1042  loss:0.92046,stance loss: 0.75438 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.65 total_loss: 1.0823  loss:0.7285,stance loss: 0.43976 
Train step: 1050 acc:0.69167 total_loss: 1.0476  loss:0.79722,stance loss: 0.53096 
Train step: 1060 acc:0.7325 total_loss: 1.0154  loss:1.1533,stance loss: 1.4592 
Train step: 1070 acc:0.73214 total_loss: 1.0272  loss:1.2865,stance loss: 1.0981 
Train step: 1080 acc:0.73333 total_loss: 1.0292  loss:0.84104,stance loss: 0.68578 
Train step: 1090 acc:0.7375 total_loss: 1.0275  loss:0.93621,stance loss: 0.73268 
Train step: 1100 acc:0.74519 total_loss: 1.0017  loss:1.0903,stance loss: 0.77939 
Train step: 1110 acc:0.7475 total_loss: 0.99683  loss:0.94482,stance loss: 0.62327 
Train step: 1120 acc:0.74412 total_loss: 0.9959  loss:0.88257,stance loss: 0.78261 
Train step: 1130 acc:0.74013 total_loss: 1.0196  loss:1.5063,stance loss: 1.7759 
Train step: 1140 acc:0.73869 total_loss: 1.0149  loss:1.0029,stance loss: 0.68821 
Train step: 1150 acc:0.7375 total_loss: 1.0189  loss:1.3799,stance loss: 1.0629 
Train step: 1160 acc:0.734 total_loss: 1.0161  loss:1.2317,stance loss: 1.0275 
Train step: 1170 acc:0.73426 total_loss: 1.0264  loss:1.0061,stance loss: 0.71095 
Train step: 1180 acc:0.73233 total_loss: 1.033  loss:1.1189,stance loss: 0.89282 
Train step: 1190 acc:0.73105 total_loss: 1.0337  loss:1.0565,stance loss: 0.84107 
Train step: 1200 acc:0.73333 total_loss: 1.0237  loss:0.69154,stance loss: 0.44071 
Train step: 1210 acc:0.73821 total_loss: 1.0177  loss:1.0567,stance loss: 1.0206 
Train step: 1220 acc:0.73919 total_loss: 1.0195  loss:1.2787,stance loss: 1.5274 
Train step: 1230 acc:0.7391 total_loss: 1.0227  loss:1.3764,stance loss: 1.2262 
Train step: 1240 acc:0.73902 total_loss: 1.0235  loss:0.67405,stance loss: 0.43023 
Train step: 1250 acc:0.73721 total_loss: 1.0281  loss:1.1807,stance loss: 1.4127 
Train step: 1260 acc:0.73667 total_loss: 1.0253  loss:1.5128,stance loss: 1.1814 
Train step: 1270 acc:0.73537 total_loss: 1.0263  loss:1.2771,stance loss: 1.0491 
Train step: 1280 acc:0.73393 total_loss: 1.028  loss:0.83964,stance loss: 0.7169 
Train step: 1290 acc:0.73431 total_loss: 1.0219  loss:0.78665,stance loss: 0.57893 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.77083 total_loss: 0.97715  loss:1.3323,stance loss: 1.222 
Train step: 1310 acc:0.76172 total_loss: 0.99028  loss:1.1957,stance loss: 0.96909 
Train step: 1320 acc:0.77163 total_loss: 0.95404  loss:0.77261,stance loss: 0.54325 
Train step: 1330 acc:0.75347 total_loss: 0.9573  loss:0.86424,stance loss: 0.61772 
Train step: 1340 acc:0.77038 total_loss: 0.94223  loss:1.2748,stance loss: 1.0112 
Train step: 1350 acc:0.75781 total_loss: 0.9558  loss:0.88982,stance loss: 0.72703 
Train step: 1360 acc:0.75758 total_loss: 0.96584  loss:0.67431,stance loss: 0.63778 
Train step: 1370 acc:0.75822 total_loss: 0.9597  loss:0.53677,stance loss: 0.36384 
Train step: 1380 acc:0.76599 total_loss: 0.94692  loss:1.1591,stance loss: 0.97618 
Train step: 1390 acc:0.76497 total_loss: 0.95745  loss:0.73867,stance loss: 0.55313 
Train step: 1400 acc:0.76297 total_loss: 0.94749  loss:1.1997,stance loss: 0.75415 
Train step: 1410 acc:0.75862 total_loss: 0.94958  loss:1.0536,stance loss: 0.84762 
Train step: 1420 acc:0.76141 total_loss: 0.94665  loss:1.0537,stance loss: 0.97075 
Train step: 1430 acc:0.75735 total_loss: 0.94493  loss:0.74211,stance loss: 0.62837 
Train step: 1440 acc:0.76113 total_loss: 0.93691  loss:0.67732,stance loss: 0.49668 
Train step: 1450 acc:0.76202 total_loss: 0.93776  loss:0.77841,stance loss: 0.55437 
Train step: 1460 acc:0.7628 total_loss: 0.93326  loss:1.3127,stance loss: 0.89744 
Train step: 1470 acc:0.76562 total_loss: 0.92641  loss:0.80435,stance loss: 0.79467 
Train step: 1480 acc:0.76647 total_loss: 0.91783  loss:1.0235,stance loss: 0.79725 
Train step: 1490 acc:0.76148 total_loss: 0.92025  loss:0.76643,stance loss: 0.66172 
Train step: 1500 acc:0.76365 total_loss: 0.91514  loss:0.78132,stance loss: 0.61192 
Train step: 1510 acc:0.7636 total_loss: 0.91719  loss:0.86799,stance loss: 0.61613 
Train step: 1520 acc:0.76466 total_loss: 0.91896  loss:1.2094,stance loss: 1.0237 
Train step: 1530 acc:0.76324 total_loss: 0.91959  loss:0.86688,stance loss: 0.68282 
Train step: 1540 acc:0.76194 total_loss: 0.92168  loss:1.4651,stance loss: 1.3188 
Train step: 1550 acc:0.76196 total_loss: 0.92411  loss:1.0631,stance loss: 0.65364 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.82143 total_loss: 0.82526  loss:0.78927,stance loss: 0.67043 
Train step: 1570 acc:0.83824 total_loss: 0.72546  loss:0.78802,stance loss: 0.637 
Train step: 1580 acc:0.8287 total_loss: 0.72989  loss:0.75515,stance loss: 0.5637 
Train step: 1590 acc:0.82432 total_loss: 0.72686  loss:0.62201,stance loss: 0.51167 
Train step: 1600 acc:0.81516 total_loss: 0.74213  loss:1.1131,stance loss: 0.95765 
Train step: 1610 acc:0.81798 total_loss: 0.74684  loss:0.5384,stance loss: 0.40952 
Train step: 1620 acc:0.8153 total_loss: 0.74698  loss:0.51123,stance loss: 0.36785 
Train step: 1630 acc:0.82143 total_loss: 0.72777  loss:0.34327,stance loss: 0.22961 
Train step: 1640 acc:0.81968 total_loss: 0.73588  loss:0.71994,stance loss: 0.45788 
Train step: 1650 acc:0.81765 total_loss: 0.75417  loss:0.55334,stance loss: 0.33799 
Train step: 1660 acc:0.81075 total_loss: 0.77045  loss:0.53062,stance loss: 0.41219 
Train step: 1670 acc:0.81036 total_loss: 0.76751  loss:0.39889,stance loss: 0.25656 
Train step: 1680 acc:0.80758 total_loss: 0.77933  loss:0.97412,stance loss: 0.82278 
Train step: 1690 acc:0.80703 total_loss: 0.78255  loss:1.0476,stance loss: 0.87786 
Train step: 1700 acc:0.80825 total_loss: 0.78964  loss:0.57937,stance loss: 0.46138 
Train step: 1710 acc:0.80693 total_loss: 0.79032  loss:1.0523,stance loss: 0.805 
Train step: 1720 acc:0.81175 total_loss: 0.77887  loss:0.67851,stance loss: 0.63457 
Train step: 1730 acc:0.81003 total_loss: 0.79438  loss:0.55874,stance loss: 0.429 
Train step: 1740 acc:0.80882 total_loss: 0.79306  loss:0.72291,stance loss: 0.46911 
Train step: 1750 acc:0.81091 total_loss: 0.78513  loss:1.1929,stance loss: 0.78564 
Train step: 1760 acc:0.8119 total_loss: 0.78176  loss:0.61865,stance loss: 0.52502 
Train step: 1770 acc:0.80933 total_loss: 0.78773  loss:0.85979,stance loss: 0.62348 
Train step: 1780 acc:0.81002 total_loss: 0.78742  loss:0.88589,stance loss: 0.85344 
Train step: 1790 acc:0.80775 total_loss: 0.78936  loss:0.60039,stance loss: 0.53982 
Train step: 1800 acc:0.80921 total_loss: 0.78456  loss:0.60736,stance loss: 0.48466 
Train step: 1810 acc:0.80934 total_loss: 0.78612  loss:0.40532,stance loss: 0.24967 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.91406 total_loss: 0.63504  loss:0.68298,stance loss: 0.5796 
Train step: 1830 acc:0.86111 total_loss: 0.74774  loss:0.8812,stance loss: 0.68938 
Train step: 1840 acc:0.85045 total_loss: 0.69804  loss:0.76393,stance loss: 0.65355 
Train step: 1850 acc:0.84375 total_loss: 0.69259  loss:0.86181,stance loss: 0.82402 
Train step: 1860 acc:0.84375 total_loss: 0.6758  loss:0.4717,stance loss: 0.39038 
Train step: 1870 acc:0.84375 total_loss: 0.68107  loss:0.31625,stance loss: 0.18032 
Train step: 1880 acc:0.84743 total_loss: 0.68658  loss:0.22777,stance loss: 0.10355 
Train step: 1890 acc:0.84455 total_loss: 0.69967  loss:1.0176,stance loss: 0.78503 
Train step: 1900 acc:0.84446 total_loss: 0.68735  loss:0.63591,stance loss: 0.5004 
Train step: 1910 acc:0.84439 total_loss: 0.68948  loss:0.87601,stance loss: 0.64441 
Train step: 1920 acc:0.8478 total_loss: 0.68165  loss:0.78935,stance loss: 0.62773 
Train step: 1930 acc:0.84693 total_loss: 0.68842  loss:0.48413,stance loss: 0.41353 
Train step: 1940 acc:0.84668 total_loss: 0.68647  loss:0.48237,stance loss: 0.45772 
Train step: 1950 acc:0.84601 total_loss: 0.69142  loss:0.85752,stance loss: 0.56626 
Train step: 1960 acc:0.84671 total_loss: 0.69504  loss:0.54864,stance loss: 0.50608 
Train step: 1970 acc:0.84771 total_loss: 0.69936  loss:1.1513,stance loss: 1.4229 
Train step: 1980 acc:0.84859 total_loss: 0.69429  loss:0.92782,stance loss: 0.78179 
Train step: 1990 acc:0.84831 total_loss: 0.68923  loss:0.35571,stance loss: 0.34663 
Train step: 2000 acc:0.84475 total_loss: 0.69166  loss:0.79547,stance loss: 0.70976 
Train step: 2010 acc:0.84312 total_loss: 0.69378  loss:0.60652,stance loss: 0.33698 
Train step: 2020 acc:0.84615 total_loss: 0.68408  loss:0.67905,stance loss: 0.37197 
Train step: 2030 acc:0.84518 total_loss: 0.68562  loss:0.83306,stance loss: 0.72515 
Train step: 2040 acc:0.84539 total_loss: 0.68443  loss:1.0148,stance loss: 1.3472 
Train step: 2050 acc:0.84454 total_loss: 0.68578  loss:0.69741,stance loss: 0.54761 
Train step: 2060 acc:0.84451 total_loss: 0.68202  loss:0.77429,stance loss: 0.61523 
Train step: 2070 acc:0.84375 total_loss: 0.68276  loss:0.62801,stance loss: 0.47847 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.84722 total_loss: 0.63557  loss:0.75317,stance loss: 0.55454 
Train step: 2090 acc:0.84211 total_loss: 0.63383  loss:0.24983,stance loss: 0.14712 
Train step: 2100 acc:0.86422 total_loss: 0.58726  loss:0.31456,stance loss: 0.19953 
Train step: 2110 acc:0.85737 total_loss: 0.58525  loss:0.26325,stance loss: 0.13884 
Train step: 2120 acc:0.86224 total_loss: 0.60682  loss:1.1694,stance loss: 1.5265 
Train step: 2130 acc:0.85805 total_loss: 0.61039  loss:0.68228,stance loss: 0.4964 
Train step: 2140 acc:0.85507 total_loss: 0.61904  loss:0.44454,stance loss: 0.29292 
Train step: 2150 acc:0.85759 total_loss: 0.62106  loss:0.59216,stance loss: 0.54208 
Train step: 2160 acc:0.85955 total_loss: 0.61516  loss:0.46809,stance loss: 0.46284 
Train step: 2170 acc:0.86048 total_loss: 0.61606  loss:0.83847,stance loss: 1.1019 
Train step: 2180 acc:0.86067 total_loss: 0.61531  loss:0.53467,stance loss: 0.4328 
Train step: 2190 acc:0.85977 total_loss: 0.62194  loss:1.19,stance loss: 1.4711 
Train step: 2200 acc:0.86095 total_loss: 0.64182  loss:1.5747,stance loss: 1.7263 
Train step: 2210 acc:0.85656 total_loss: 0.65007  loss:0.84633,stance loss: 0.81428 
Train step: 2220 acc:0.85529 total_loss: 0.65631  loss:0.69051,stance loss: 0.57693 
Train step: 2230 acc:0.8577 total_loss: 0.64487  loss:0.64659,stance loss: 0.57398 
Train step: 2240 acc:0.8591 total_loss: 0.64542  loss:0.37787,stance loss: 0.31754 
Train step: 2250 acc:0.85789 total_loss: 0.65463  loss:1.1889,stance loss: 0.71483 
Train step: 2260 acc:0.85847 total_loss: 0.64883  loss:0.56482,stance loss: 0.42033 
Train step: 2270 acc:0.8571 total_loss: 0.64675  loss:0.55032,stance loss: 0.41004 
Train step: 2280 acc:0.85795 total_loss: 0.64542  loss:0.59942,stance loss: 0.52671 
Train step: 2290 acc:0.85987 total_loss: 0.64132  loss:0.83779,stance loss: 0.80894 
Train step: 2300 acc:0.85999 total_loss: 0.64692  loss:1.0756,stance loss: 1.4934 
Train step: 2310 acc:0.86009 total_loss: 0.64285  loss:0.62374,stance loss: 0.594 
Train step: 2320 acc:0.85944 total_loss: 0.6441  loss:1.2826,stance loss: 0.95896 
Train step: 2330 acc:0.85956 total_loss: 0.64446  loss:2.0748,stance loss: 3.6453 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.86875 total_loss: 0.54196  loss:0.30815,stance loss: 0.20618 
Train step: 2350 acc:0.875 total_loss: 0.49405  loss:0.62413,stance loss: 0.55393 
Train step: 2360 acc:0.85417 total_loss: 0.5619  loss:1.5549,stance loss: 1.7126 
Train step: 2370 acc:0.85938 total_loss: 0.52687  loss:0.20611,stance loss: 0.11345 
Train step: 2380 acc:0.87 total_loss: 0.50812  loss:0.44858,stance loss: 0.38214 
Train step: 2390 acc:0.87604 total_loss: 0.51643  loss:0.47635,stance loss: 0.39124 
Train step: 2400 acc:0.87857 total_loss: 0.50813  loss:0.42724,stance loss: 0.33353 
Train step: 2410 acc:0.87813 total_loss: 0.50268  loss:0.41739,stance loss: 0.28335 
Train step: 2420 acc:0.88194 total_loss: 0.50504  loss:0.6068,stance loss: 1.0153 
Train step: 2430 acc:0.8825 total_loss: 0.51769  loss:0.45617,stance loss: 0.41101 
Train step: 2440 acc:0.88295 total_loss: 0.53006  loss:0.67321,stance loss: 1.0974 
Train step: 2450 acc:0.88125 total_loss: 0.5303  loss:0.47595,stance loss: 0.38531 
Train step: 2460 acc:0.87981 total_loss: 0.52746  loss:0.41478,stance loss: 0.0039606 
Train step: 2470 acc:0.87813 total_loss: 0.53838  loss:0.53995,stance loss: 0.4498 
Train step: 2480 acc:0.88125 total_loss: 0.5286  loss:0.48878,stance loss: 0.3924 
Train step: 2490 acc:0.88242 total_loss: 0.52334  loss:0.24699,stance loss: 0.12751 
Train step: 2500 acc:0.88199 total_loss: 0.52334  loss:0.91537,stance loss: 0.67499 
Train step: 2510 acc:0.88021 total_loss: 0.52693  loss:0.34918,stance loss: 0.23172 
Train step: 2520 acc:0.88257 total_loss: 0.52617  loss:0.62448,stance loss: 1.0339 
Train step: 2530 acc:0.88406 total_loss: 0.52452  loss:0.24146,stance loss: 0.10913 
Train step: 2540 acc:0.88393 total_loss: 0.52454  loss:0.80209,stance loss: 0.54882 
Train step: 2550 acc:0.88438 total_loss: 0.52158  loss:0.095536,stance loss: 0.027829 
Train step: 2560 acc:0.88641 total_loss: 0.51783  loss:0.32395,stance loss: 0.13971 
Train step: 2570 acc:0.88568 total_loss: 0.51948  loss:0.29516,stance loss: 0.23987 
Train step: 2580 acc:0.88625 total_loss: 0.51721  loss:0.64209,stance loss: 0.61673 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:1.0 total_loss: 0.10129  loss:0.10129,stance loss: 0.025641 
Train step: 2600 acc:0.94318 total_loss: 0.36831  loss:0.39488,stance loss: 0.34058 
Train step: 2610 acc:0.9256 total_loss: 0.39705  loss:1.1221,stance loss: 1.1118 
Train step: 2620 acc:0.93347 total_loss: 0.38365  loss:0.27347,stance loss: 0.15442 
Train step: 2630 acc:0.93445 total_loss: 0.37426  loss:0.44535,stance loss: 0.3656 
Train step: 2640 acc:0.93382 total_loss: 0.36877  loss:0.36147,stance loss: 0.28236 
Train step: 2650 acc:0.9293 total_loss: 0.38925  loss:0.46152,stance loss: 0.55844 
Train step: 2660 acc:0.92694 total_loss: 0.40116  loss:1.2602,stance loss: 1.5154 
Train step: 2670 acc:0.92438 total_loss: 0.39931  loss:0.27316,stance loss: 0.20888 
Train step: 2680 acc:0.92102 total_loss: 0.40781  loss:0.40901,stance loss: 0.29561 
Train step: 2690 acc:0.92203 total_loss: 0.41465  loss:0.58973,stance loss: 0.5081 
Train step: 2700 acc:0.92568 total_loss: 0.398  loss:0.22471,stance loss: 0.16888 
Train step: 2710 acc:0.92665 total_loss: 0.39473  loss:0.34331,stance loss: 0.33269 
Train step: 2720 acc:0.9251 total_loss: 0.39535  loss:0.87711,stance loss: 0.94651 
Train step: 2730 acc:0.92332 total_loss: 0.40011  loss:0.16633,stance loss: 0.062304 
Train step: 2740 acc:0.92301 total_loss: 0.4016  loss:0.43329,stance loss: 0.38958 
Train step: 2750 acc:0.92275 total_loss: 0.40756  loss:0.31822,stance loss: 0.25517 
Train step: 2760 acc:0.92251 total_loss: 0.4116  loss:0.50187,stance loss: 0.33199 
Train step: 2770 acc:0.92334 total_loss: 0.40895  loss:0.62198,stance loss: 0.51407 
Train step: 2780 acc:0.92147 total_loss: 0.41632  loss:0.78241,stance loss: 0.65035 
Train step: 2790 acc:0.92102 total_loss: 0.42007  loss:0.3846,stance loss: 0.25664 
Train step: 2800 acc:0.91973 total_loss: 0.41837  loss:0.1147,stance loss: 0.080862 
Train step: 2810 acc:0.91742 total_loss: 0.42326  loss:0.62297,stance loss: 0.24855 
Train step: 2820 acc:0.91721 total_loss: 0.4218  loss:0.35621,stance loss: 0.23797 
Train step: 2830 acc:0.91598 total_loss: 0.42354  loss:0.36838,stance loss: 0.18488 
Train step: 2840 acc:0.91459 total_loss: 0.42417  loss:0.46995,stance loss: 0.32601 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.8125 total_loss: 0.53357  loss:0.70219,stance loss: 0.58656 
Train step: 2860 acc:0.88542 total_loss: 0.36375  loss:0.10896,stance loss: 0.039319 
Train step: 2870 acc:0.91193 total_loss: 0.32747  loss:0.1305,stance loss: 0.071597 
Train step: 2880 acc:0.92188 total_loss: 0.34732  loss:0.70582,stance loss: 1.1363 
Train step: 2890 acc:0.92411 total_loss: 0.32595  loss:0.4547,stance loss: 0.5882 
Train step: 2900 acc:0.92788 total_loss: 0.32299  loss:0.29386,stance loss: 0.24235 
Train step: 2910 acc:0.9254 total_loss: 0.34067  loss:0.56704,stance loss: 1.0173 
Train step: 2920 acc:0.92274 total_loss: 0.34586  loss:0.50714,stance loss: 0.40884 
Train step: 2930 acc:0.9253 total_loss: 0.33434  loss:0.51049,stance loss: 0.49822 
Train step: 2940 acc:0.92663 total_loss: 0.33228  loss:0.1447,stance loss: 0.1067 
Train step: 2950 acc:0.92892 total_loss: 0.32404  loss:0.47803,stance loss: 0.39106 
Train step: 2960 acc:0.92467 total_loss: 0.33279  loss:0.22759,stance loss: 0.20776 
Train step: 2970 acc:0.92367 total_loss: 0.34248  loss:0.57156,stance loss: 0.52408 
Train step: 2980 acc:0.92566 total_loss: 0.34089  loss:0.5094,stance loss: 0.42226 
Train step: 2990 acc:0.92694 total_loss: 0.3368  loss:0.38685,stance loss: 0.39751 
Train step: 3000 acc:0.9264 total_loss: 0.33726  loss:0.6205,stance loss: 0.30822 
Train step: 3010 acc:0.92708 total_loss: 0.3373  loss:0.32264,stance loss: 0.30964 
Train step: 3020 acc:0.92624 total_loss: 0.34921  loss:1.1256,stance loss: 1.1251 
Train step: 3030 acc:0.92651 total_loss: 0.35194  loss:0.15863,stance loss: 0.079398 
Train step: 3040 acc:0.92611 total_loss: 0.35135  loss:0.3617,stance loss: 0.36175 
Train step: 3050 acc:0.92698 total_loss: 0.34736  loss:0.22524,stance loss: 0.18551 
Train step: 3060 acc:0.92718 total_loss: 0.3464  loss:0.73402,stance loss: 1.1322 
Train step: 3070 acc:0.92849 total_loss: 0.34304  loss:0.23149,stance loss: 0.23335 
Train step: 3080 acc:0.9278 total_loss: 0.34445  loss:0.29047,stance loss: 0.21511 
Train step: 3090 acc:0.92717 total_loss: 0.34428  loss:0.95627,stance loss: 0.93123 
Train step: 3100 acc:0.92634 total_loss: 0.3466  loss:0.44983,stance loss: 0.3509 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.95833 total_loss: 0.36259  loss:0.37426,stance loss: 0.31984 
Train step: 3120 acc:0.94231 total_loss: 0.30534  loss:0.17375,stance loss: 0.10158 
Train step: 3130 acc:0.95109 total_loss: 0.28005  loss:0.2594,stance loss: 0.22211 
Train step: 3140 acc:0.96023 total_loss: 0.27618  loss:0.11736,stance loss: 0.016363 
Train step: 3150 acc:0.95785 total_loss: 0.27834  loss:0.61154,stance loss: 1.0171 
Train step: 3160 acc:0.95637 total_loss: 0.27506  loss:0.53475,stance loss: 0.44774 
Train step: 3170 acc:0.95536 total_loss: 0.27526  loss:0.65928,stance loss: 1.1251 
Train step: 3180 acc:0.95377 total_loss: 0.27541  loss:0.54414,stance loss: 1.008 
Train step: 3190 acc:0.95105 total_loss: 0.28832  loss:0.53371,stance loss: 1.008 
Train step: 3200 acc:0.9496 total_loss: 0.28982  loss:0.27238,stance loss: 0.20588 
Train step: 3210 acc:0.94964 total_loss: 0.29538  loss:0.23138,stance loss: 0.20161 
Train step: 3220 acc:0.94801 total_loss: 0.29826  loss:0.48163,stance loss: 0.30602 
Train step: 3230 acc:0.9497 total_loss: 0.28946  loss:0.08062,stance loss: 0.017104 
Train step: 3240 acc:0.94737 total_loss: 0.29227  loss:0.46844,stance loss: 0.39243 
Train step: 3250 acc:0.9493 total_loss: 0.28615  loss:0.16567,stance loss: 0.15159 
Train step: 3260 acc:0.95098 total_loss: 0.28091  loss:0.61483,stance loss: 0.61932 
Train step: 3270 acc:0.95092 total_loss: 0.28199  loss:0.14422,stance loss: 0.12343 
Train step: 3280 acc:0.94942 total_loss: 0.28548  loss:0.2723,stance loss: 0.244 
Train step: 3290 acc:0.95014 total_loss: 0.28377  loss:0.24811,stance loss: 0.12654 
Train step: 3300 acc:0.94883 total_loss: 0.28394  loss:0.22127,stance loss: 0.095825 
Train step: 3310 acc:0.94766 total_loss: 0.28699  loss:0.036506,stance loss: 0.0047357 
Train step: 3320 acc:0.94748 total_loss: 0.2854  loss:0.030512,stance loss: 0.0025739 
Train step: 3330 acc:0.94787 total_loss: 0.28356  loss:0.050873,stance loss: 0.013228 
Train step: 3340 acc:0.94823 total_loss: 0.28225  loss:0.061044,stance loss: 0.010752 
Train step: 3350 acc:0.94907 total_loss: 0.27825  loss:0.23595,stance loss: 0.20505 
Train step: 3360 acc:0.94837 total_loss: 0.27889  loss:0.077831,stance loss: 0.022874 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.96875 total_loss: 0.17706  loss:0.17286,stance loss: 0.12316 
Train step: 3380 acc:0.95982 total_loss: 0.23611  loss:0.035709,stance loss: 0.011178 
Train step: 3390 acc:0.95833 total_loss: 0.24912  loss:0.4157,stance loss: 0.45337 
Train step: 3400 acc:0.95772 total_loss: 0.22612  loss:0.36456,stance loss: 0.33277 
Train step: 3410 acc:0.95739 total_loss: 0.24702  loss:0.17854,stance loss: 0.15826 
Train step: 3420 acc:0.95949 total_loss: 0.24884  loss:0.2739,stance loss: 0.2351 
Train step: 3430 acc:0.96191 total_loss: 0.24501  loss:0.073428,stance loss: 0.019213 
Train step: 3440 acc:0.96706 total_loss: 0.22196  loss:0.10711,stance loss: 0.079226 
Train step: 3450 acc:0.96503 total_loss: 0.23011  loss:0.6431,stance loss: 1.0388 
Train step: 3460 acc:0.96676 total_loss: 0.21885  loss:0.070581,stance loss: 0.016631 
Train step: 3470 acc:0.96635 total_loss: 0.21544  loss:0.28495,stance loss: 0.23443 
Train step: 3480 acc:0.96765 total_loss: 0.20765  loss:0.28679,stance loss: 0.28285 
Train step: 3490 acc:0.96623 total_loss: 0.21362  loss:0.23432,stance loss: 0.22592 
Train step: 3500 acc:0.96502 total_loss: 0.22048  loss:0.083855,stance loss: 0.059445 
Train step: 3510 acc:0.96484 total_loss: 0.23162  loss:0.039664,stance loss: 0.0071293 
Train step: 3520 acc:0.96226 total_loss: 0.23734  loss:0.1238,stance loss: 0.088032 
Train step: 3530 acc:0.96075 total_loss: 0.2385  loss:0.22275,stance loss: 0.20281 
Train step: 3540 acc:0.96264 total_loss: 0.23349  loss:0.050793,stance loss: 0.010579 
Train step: 3550 acc:0.9606 total_loss: 0.23735  loss:0.087883,stance loss: 0.033336 
Train step: 3560 acc:0.96005 total_loss: 0.23693  loss:0.065326,stance loss: 0.033704 
Train step: 3570 acc:0.95803 total_loss: 0.24423  loss:0.22329,stance loss: 0.15983 
Train step: 3580 acc:0.95794 total_loss: 0.24626  loss:0.05754,stance loss: 0.027508 
Train step: 3590 acc:0.95815 total_loss: 0.24298  loss:0.049048,stance loss: 0.01139 
Train step: 3600 acc:0.9586 total_loss: 0.242  loss:0.14163,stance loss: 0.12257 
Train step: 3610 acc:0.95902 total_loss: 0.24037  loss:0.060809,stance loss: 0.026188 
Train step: 3620 acc:0.9594 total_loss: 0.24235  loss:0.26247,stance loss: 0.19103 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.9625 total_loss: 0.23831  loss:0.23962,stance loss: 0.22968 
Train step: 3640 acc:0.975 total_loss: 0.14864  loss:0.41242,stance loss: 0.34575 
Train step: 3650 acc:0.965 total_loss: 0.20018  loss:0.083894,stance loss: 0.043356 
Train step: 3660 acc:0.96429 total_loss: 0.20512  loss:0.20816,stance loss: 0.16653 
Train step: 3670 acc:0.96528 total_loss: 0.1974  loss:0.027094,stance loss: 0.0034551 
Train step: 3680 acc:0.96477 total_loss: 0.19556  loss:0.16908,stance loss: 0.12916 
Train step: 3690 acc:0.96442 total_loss: 0.19283  loss:0.036178,stance loss: 0.003526 
Train step: 3700 acc:0.96667 total_loss: 0.17983  loss:0.10723,stance loss: 0.051403 
Train step: 3710 acc:0.96618 total_loss: 0.18051  loss:0.066388,stance loss: 0.02832 
Train step: 3720 acc:0.96908 total_loss: 0.16864  loss:0.23188,stance loss: 0.22865 
Train step: 3730 acc:0.97024 total_loss: 0.16167  loss:0.13113,stance loss: 0.10187 
Train step: 3740 acc:0.96739 total_loss: 0.17753  loss:0.030049,stance loss: 0.0024322 
Train step: 3750 acc:0.967 total_loss: 0.17414  loss:0.065189,stance loss: 0.024506 
Train step: 3760 acc:0.96759 total_loss: 0.17085  loss:0.21674,stance loss: 0.14736 
Train step: 3770 acc:0.96853 total_loss: 0.16514  loss:0.050773,stance loss: 0.010438 
Train step: 3780 acc:0.96734 total_loss: 0.17214  loss:0.22776,stance loss: 0.19276 
Train step: 3790 acc:0.96667 total_loss: 0.17309  loss:0.024513,stance loss: 0.0033037 
Train step: 3800 acc:0.96464 total_loss: 0.18935  loss:0.25346,stance loss: 0.19198 
Train step: 3810 acc:0.96351 total_loss: 0.19559  loss:0.078706,stance loss: 0.015981 
Train step: 3820 acc:0.96282 total_loss: 0.19657  loss:0.12458,stance loss: 0.085679 
Train step: 3830 acc:0.9628 total_loss: 0.19874  loss:0.56584,stance loss: 1.0176 
Train step: 3840 acc:0.96424 total_loss: 0.19368  loss:0.013397,stance loss: 0.00028824 
Train step: 3850 acc:0.96389 total_loss: 0.19845  loss:0.086758,stance loss: 0.059717 
Train step: 3860 acc:0.96463 total_loss: 0.19889  loss:0.028601,stance loss: 0.0038694 
Train step: 3870 acc:0.9648 total_loss: 0.19899  loss:0.049509,stance loss: 0.026159 
Train step: 3880 acc:0.96446 total_loss: 0.20774  loss:0.1509,stance loss: 0.038898 
Training finished.


Reload the best model with best f1 0.5914995990376904 from path test_outputs/bert-cross-topic/a/2023-08-14 16-38-46/state_dict


              precision    recall  f1-score   support

           0   0.707469  0.734914  0.720930       464
           1   0.600000  0.351724  0.443478       145
           2   0.403614  0.540323  0.462069       124

    accuracy                       0.626194       733
   macro avg   0.570361  0.542320  0.542159       733
weighted avg   0.634807  0.626194  0.622254       733

Test Acc: 0.626193724420191 F1_ma:0.5914995990376904
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5914995990376904
acc: 0.626193724420191, f1 :0.5421591529816487
classification report: 
              precision    recall  f1-score   support

         Con     0.7075    0.7349    0.7209       464
        None     0.6000    0.3517    0.4435       145
         Pro     0.4036    0.5403    0.4621       124

    accuracy                         0.6262       733
   macro avg     0.5704    0.5423    0.5422       733
weighted avg     0.6348    0.6262    0.6223       733

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='a', dataset_files={'train': './datasets/o_a', 'test': './datasets/a'}, dev_dir='./datasets/a', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/a/2023-08-14 16-58-20', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/a', train_dir='./datasets/o_a', type=0)
using model:  bert-cross-topic
running dataset:  a
output_dir:  test_outputs/bert-cross-topic/a/2023-08-14 16-58-20
Train loader length: 259
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5 total_loss: 1.5847  loss:1.5847,stance loss: 1.0309 
Train step: 10 acc:0.4375 total_loss: 1.6607  loss:1.8831,stance loss: 1.7581 
Better F1! Saving model!
Saving model of best f1: 0.38763575605680867
              precision    recall  f1-score   support

           0   0.633015  1.000000  0.775272       464
           1   0.000000  0.000000  0.000000       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.633015       733
   macro avg   0.211005  0.333333  0.258424       733
weighted avg   0.400708  0.633015  0.490759       733

Test Acc: 0.6330150068212824 F1_ma:0.38763575605680867
Train step: 20 acc:0.44345 total_loss: 1.6332  loss:1.5172,stance loss: 0.97942 
Train step: 30 acc:0.43952 total_loss: 1.6349  loss:1.7217,stance loss: 1.3793 
Train step: 40 acc:0.4436 total_loss: 1.6367  loss:1.7069,stance loss: 1.2627 
Train step: 50 acc:0.43015 total_loss: 1.6339  loss:1.7001,stance loss: 1.1936 
Train step: 60 acc:0.43135 total_loss: 1.6235  loss:1.6941,stance loss: 1.2975 
Train step: 70 acc:0.42782 total_loss: 1.6131  loss:1.4604,stance loss: 0.93926 
Train step: 80 acc:0.42978 total_loss: 1.6063  loss:1.6182,stance loss: 1.27 
Train step: 90 acc:0.43681 total_loss: 1.5995  loss:1.4292,stance loss: 0.84448 
Train step: 100 acc:0.43812 total_loss: 1.5922  loss:1.4484,stance loss: 1.0421 
Train step: 110 acc:0.44088 total_loss: 1.5887  loss:1.678,stance loss: 1.0949 
Train step: 120 acc:0.44267 total_loss: 1.5854  loss:1.4199,stance loss: 0.81881 
Train step: 130 acc:0.44132 total_loss: 1.5836  loss:1.5288,stance loss: 1.1241 
Train step: 140 acc:0.4477 total_loss: 1.5717  loss:1.3217,stance loss: 0.83557 
Train step: 150 acc:0.45323 total_loss: 1.5718  loss:1.5334,stance loss: 1.1438 
Train step: 160 acc:0.45924 total_loss: 1.5731  loss:1.3956,stance loss: 0.93202 
Better F1! Saving model!
Saving model of best f1: 0.3882042253521127
              precision    recall  f1-score   support

           0   0.656250  0.950431  0.776408       464
           1   0.590164  0.248276  0.349515       145
           2   0.000000  0.000000  0.000000       124

    accuracy                       0.650750       733
   macro avg   0.415471  0.399569  0.375308       733
weighted avg   0.532161  0.650750  0.560618       733

Test Acc: 0.6507503410641201 F1_ma:0.3882042253521127
Train step: 170 acc:0.45833 total_loss: 1.5713  loss:1.3278,stance loss: 0.88592 
Train step: 180 acc:0.45994 total_loss: 1.5707  loss:1.2872,stance loss: 0.836 
Train step: 190 acc:0.46793 total_loss: 1.5627  loss:1.473,stance loss: 0.95222 
Train step: 200 acc:0.47575 total_loss: 1.5555  loss:1.2419,stance loss: 0.88927 
Train step: 210 acc:0.47986 total_loss: 1.5582  loss:1.2875,stance loss: 0.90168 
Train step: 220 acc:0.48218 total_loss: 1.556  loss:2.0079,stance loss: 1.7224 
Train step: 230 acc:0.48593 total_loss: 1.5508  loss:1.5463,stance loss: 1.1498 
Train step: 240 acc:0.48781 total_loss: 1.5437  loss:1.2928,stance loss: 0.94624 
Train step: 250 acc:0.49377 total_loss: 1.5368  loss:1.0712,stance loss: 0.70518 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 260 acc:0.59375 total_loss: 1.3307  loss:1.0682,stance loss: 0.61592 
Train step: 270 acc:0.57292 total_loss: 1.3405  loss:1.415,stance loss: 1.0766 
Train step: 280 acc:0.5625 total_loss: 1.3436  loss:1.2971,stance loss: 0.86444 
Train step: 290 acc:0.56445 total_loss: 1.3483  loss:1.3223,stance loss: 0.90294 
Train step: 300 acc:0.57589 total_loss: 1.3452  loss:1.1576,stance loss: 0.78553 
Train step: 310 acc:0.58534 total_loss: 1.3457  loss:1.4072,stance loss: 1.0249 
Train step: 320 acc:0.59778 total_loss: 1.3466  loss:1.1067,stance loss: 0.75014 
Train step: 330 acc:0.60069 total_loss: 1.3611  loss:1.1909,stance loss: 0.808 
Train step: 340 acc:0.60899 total_loss: 1.3449  loss:1.0862,stance loss: 0.7558 
Train step: 350 acc:0.61889 total_loss: 1.3369  loss:1.3033,stance loss: 1.1376 
Train step: 360 acc:0.61949 total_loss: 1.3394  loss:1.3439,stance loss: 1.0379 
Train step: 370 acc:0.6144 total_loss: 1.3412  loss:1.4489,stance loss: 1.0941 
Train step: 380 acc:0.61373 total_loss: 1.3438  loss:1.4997,stance loss: 1.1824 
Train step: 390 acc:0.61506 total_loss: 1.349  loss:1.725,stance loss: 1.7278 
Train step: 400 acc:0.62104 total_loss: 1.3384  loss:1.1118,stance loss: 0.7449 
Train step: 410 acc:0.6213 total_loss: 1.3358  loss:1.3253,stance loss: 1.1877 
Train step: 420 acc:0.62114 total_loss: 1.3344  loss:1.3243,stance loss: 1.032 
Train step: 430 acc:0.62173 total_loss: 1.3373  loss:1.4766,stance loss: 1.2241 
Train step: 440 acc:0.625 total_loss: 1.3349  loss:1.6393,stance loss: 1.419 
Train step: 450 acc:0.62142 total_loss: 1.3422  loss:1.4688,stance loss: 1.0933 
Train step: 460 acc:0.62376 total_loss: 1.3356  loss:1.1753,stance loss: 0.80271 
Train step: 470 acc:0.62706 total_loss: 1.3314  loss:1.2863,stance loss: 0.98416 
Train step: 480 acc:0.62979 total_loss: 1.3317  loss:1.6403,stance loss: 1.6498 
Train step: 490 acc:0.63227 total_loss: 1.3255  loss:1.2975,stance loss: 1.0087 
Train step: 500 acc:0.63378 total_loss: 1.3233  loss:1.4468,stance loss: 1.1595 
Train step: 510 acc:0.63393 total_loss: 1.32  loss:1.3339,stance loss: 1.0184 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 520 acc:0.70833 total_loss: 1.2316  loss:1.1167,stance loss: 0.81651 
Train step: 530 acc:0.69712 total_loss: 1.2797  loss:1.2451,stance loss: 0.99239 
Train step: 540 acc:0.69022 total_loss: 1.2383  loss:1.158,stance loss: 0.85635 
Train step: 550 acc:0.67045 total_loss: 1.2533  loss:0.89344,stance loss: 0.73587 
Train step: 560 acc:0.66715 total_loss: 1.244  loss:1.7015,stance loss: 1.14 
Train step: 570 acc:0.66392 total_loss: 1.2416  loss:1.279,stance loss: 0.94649 
Train step: 580 acc:0.66468 total_loss: 1.2344  loss:1.4866,stance loss: 1.2119 
Train step: 590 acc:0.67038 total_loss: 1.2293  loss:1.3823,stance loss: 1.4604 
Train step: 600 acc:0.67395 total_loss: 1.2235  loss:1.5923,stance loss: 1.7089 
Train step: 610 acc:0.67272 total_loss: 1.222  loss:1.1078,stance loss: 0.98657 
Train step: 620 acc:0.67597 total_loss: 1.2084  loss:0.89694,stance loss: 0.65204 
Train step: 630 acc:0.67865 total_loss: 1.2072  loss:1.1266,stance loss: 0.88718 
Train step: 640 acc:0.67429 total_loss: 1.2142  loss:1.0637,stance loss: 0.83462 
Train step: 650 acc:0.67246 total_loss: 1.2135  loss:1.1385,stance loss: 0.88734 
Train step: 660 acc:0.67657 total_loss: 1.213  loss:1.0881,stance loss: 0.94143 
Train step: 670 acc:0.67565 total_loss: 1.217  loss:1.2413,stance loss: 0.85956 
Train step: 680 acc:0.67561 total_loss: 1.2132  loss:1.2175,stance loss: 0.90543 
Train step: 690 acc:0.67558 total_loss: 1.2155  loss:1.1585,stance loss: 0.91896 
Train step: 700 acc:0.67452 total_loss: 1.2157  loss:1.1605,stance loss: 0.93038 
Train step: 710 acc:0.67325 total_loss: 1.2145  loss:1.482,stance loss: 1.2322 
Train step: 720 acc:0.67272 total_loss: 1.2138  loss:1.3365,stance loss: 0.91487 
Train step: 730 acc:0.67136 total_loss: 1.2138  loss:1.0287,stance loss: 0.72178 
Better F1! Saving model!
Saving model of best f1: 0.395859302242281
              precision    recall  f1-score   support

           0   0.691228  0.849138  0.762089       464
           1   0.546053  0.572414  0.558923       145
           2   0.181818  0.016129  0.029630       124

    accuracy                       0.653479       733
   macro avg   0.473033  0.479227  0.450214       733
weighted avg   0.576334  0.653479  0.597991       733

Test Acc: 0.6534788540245566 F1_ma:0.395859302242281
Train step: 740 acc:0.67517 total_loss: 1.2088  loss:1.0037,stance loss: 0.71939 
Train step: 750 acc:0.67677 total_loss: 1.2064  loss:1.6472,stance loss: 1.653 
Train step: 760 acc:0.6767 total_loss: 1.2078  loss:0.89733,stance loss: 0.69703 
Train step: 770 acc:0.67762 total_loss: 1.2058  loss:1.0169,stance loss: 0.85702 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 780 acc:0.67188 total_loss: 1.1851  loss:1.4289,stance loss: 1.1306 
Train step: 790 acc:0.69196 total_loss: 1.1997  loss:1.1226,stance loss: 0.87443 
Train step: 800 acc:0.70052 total_loss: 1.1837  loss:1.2958,stance loss: 1.0428 
Train step: 810 acc:0.70037 total_loss: 1.1558  loss:1.1898,stance loss: 0.85988 
Train step: 820 acc:0.70597 total_loss: 1.139  loss:1.1347,stance loss: 1.344 
Train step: 830 acc:0.71296 total_loss: 1.12  loss:0.80208,stance loss: 0.4776 
Train step: 840 acc:0.70312 total_loss: 1.1167  loss:1.4681,stance loss: 1.1377 
Better F1! Saving model!
Saving model of best f1: 0.431274387101524
              precision    recall  f1-score   support

           0   0.698507  0.504310  0.585732       464
           1   0.442060  0.710345  0.544974       145
           2   0.242424  0.322581  0.276817       124

    accuracy                       0.514325       733
   macro avg   0.460997  0.512412  0.469174       733
weighted avg   0.570623  0.514325  0.525411       733

Test Acc: 0.514324693042292 F1_ma:0.431274387101524
Train step: 850 acc:0.70946 total_loss: 1.0914  loss:0.78296,stance loss: 0.59892 
Train step: 860 acc:0.71131 total_loss: 1.0835  loss:0.83417,stance loss: 0.6281 
Train step: 870 acc:0.70944 total_loss: 1.0814  loss:0.88935,stance loss: 0.65819 
Train step: 880 acc:0.70553 total_loss: 1.0845  loss:0.69974,stance loss: 0.50188 
Train step: 890 acc:0.7045 total_loss: 1.0893  loss:0.89252,stance loss: 0.60373 
Train step: 900 acc:0.7006 total_loss: 1.1033  loss:1.2603,stance loss: 0.95051 
Train step: 910 acc:0.69729 total_loss: 1.1062  loss:1.2027,stance loss: 1.4775 
Better F1! Saving model!
Saving model of best f1: 0.45045088696869356
              precision    recall  f1-score   support

           0   0.694013  0.674569  0.684153       464
           1   0.453202  0.634483  0.528736       145
           2   0.278481  0.177419  0.216749       124

    accuracy                       0.582538       733
   macro avg   0.475232  0.495490  0.476546       733
weighted avg   0.576082  0.582538  0.574339       733

Test Acc: 0.582537517053206 F1_ma:0.45045088696869356
Train step: 920 acc:0.6901 total_loss: 1.1148  loss:1.4032,stance loss: 1.0908 
Better F1! Saving model!
Saving model of best f1: 0.4571991653141665
              precision    recall  f1-score   support

           0   0.698198  0.668103  0.682819       464
           1   0.448430  0.689655  0.543478       145
           2   0.333333  0.177419  0.231579       124

    accuracy                       0.589359       733
   macro avg   0.493321  0.511726  0.485959       733
weighted avg   0.587066  0.589359  0.578920       733

Test Acc: 0.5893587994542974 F1_ma:0.4571991653141665
Train step: 930 acc:0.68912 total_loss: 1.1153  loss:1.0891,stance loss: 0.8783 
Train step: 940 acc:0.68979 total_loss: 1.1134  loss:1.2015,stance loss: 0.97973 
Train step: 950 acc:0.69253 total_loss: 1.1075  loss:1.2791,stance loss: 0.97438 
Train step: 960 acc:0.69565 total_loss: 1.1102  loss:1.0825,stance loss: 0.95577 
Train step: 970 acc:0.69362 total_loss: 1.1108  loss:1.2831,stance loss: 0.9785 
Train step: 980 acc:0.69148 total_loss: 1.1103  loss:1.4682,stance loss: 1.1156 
Train step: 990 acc:0.69217 total_loss: 1.1131  loss:1.0635,stance loss: 0.833 
Train step: 1000 acc:0.69308 total_loss: 1.1178  loss:1.3202,stance loss: 1.4741 
Train step: 1010 acc:0.69444 total_loss: 1.117  loss:1.1878,stance loss: 0.86696 
Train step: 1020 acc:0.69621 total_loss: 1.1195  loss:0.84607,stance loss: 0.52637 
Train step: 1030 acc:0.69414 total_loss: 1.1235  loss:1.4633,stance loss: 1.1991 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1040 acc:0.6875 total_loss: 1.1569  loss:1.1983,stance loss: 1.3283 
Train step: 1050 acc:0.69167 total_loss: 1.0126  loss:0.8584,stance loss: 0.59124 
Train step: 1060 acc:0.72 total_loss: 0.98912  loss:1.0382,stance loss: 0.78967 
Train step: 1070 acc:0.72143 total_loss: 1.0057  loss:1.2007,stance loss: 1.182 
Train step: 1080 acc:0.72778 total_loss: 0.99937  loss:1.0043,stance loss: 0.71558 
Train step: 1090 acc:0.73182 total_loss: 0.99284  loss:1.1676,stance loss: 0.97518 
Train step: 1100 acc:0.73462 total_loss: 0.99999  loss:1.0644,stance loss: 0.81216 
Train step: 1110 acc:0.73917 total_loss: 0.99825  loss:1.0543,stance loss: 1.2882 
Train step: 1120 acc:0.73309 total_loss: 0.99984  loss:0.91078,stance loss: 0.58536 
Train step: 1130 acc:0.73158 total_loss: 1.0093  loss:1.0065,stance loss: 0.79635 
Train step: 1140 acc:0.73036 total_loss: 1.0105  loss:1.6319,stance loss: 1.2859 
Train step: 1150 acc:0.72989 total_loss: 1.0195  loss:1.0711,stance loss: 0.82545 
Train step: 1160 acc:0.7305 total_loss: 1.018  loss:0.9014,stance loss: 0.61801 
Train step: 1170 acc:0.72407 total_loss: 1.0348  loss:1.6865,stance loss: 1.6736 
Train step: 1180 acc:0.72241 total_loss: 1.0404  loss:1.6733,stance loss: 1.7594 
Train step: 1190 acc:0.71935 total_loss: 1.0422  loss:1.1159,stance loss: 0.84035 
Train step: 1200 acc:0.71932 total_loss: 1.0396  loss:1.1304,stance loss: 0.74593 
Train step: 1210 acc:0.72036 total_loss: 1.0454  loss:0.63708,stance loss: 0.47853 
Train step: 1220 acc:0.71926 total_loss: 1.0537  loss:0.74957,stance loss: 0.62805 
Train step: 1230 acc:0.72051 total_loss: 1.048  loss:0.89666,stance loss: 0.68598 
Train step: 1240 acc:0.7186 total_loss: 1.0491  loss:1.0164,stance loss: 1.2901 
Train step: 1250 acc:0.7189 total_loss: 1.0448  loss:1.1514,stance loss: 0.81462 
Train step: 1260 acc:0.72 total_loss: 1.046  loss:1.9233,stance loss: 1.8744 
Train step: 1270 acc:0.72287 total_loss: 1.0451  loss:0.96809,stance loss: 0.70847 
Train step: 1280 acc:0.72245 total_loss: 1.0469  loss:1.2993,stance loss: 1.5298 
Train step: 1290 acc:0.72157 total_loss: 1.0436  loss:1.1314,stance loss: 0.85137 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1300 acc:0.76042 total_loss: 0.92068  loss:0.89288,stance loss: 0.71762 
Train step: 1310 acc:0.76172 total_loss: 0.9933  loss:1.1914,stance loss: 1.1334 
Train step: 1320 acc:0.75481 total_loss: 0.98219  loss:0.68957,stance loss: 0.49041 
Train step: 1330 acc:0.75694 total_loss: 0.96674  loss:1.1338,stance loss: 0.9398 
Train step: 1340 acc:0.75679 total_loss: 0.95756  loss:1.536,stance loss: 1.7265 
Train step: 1350 acc:0.76562 total_loss: 0.96377  loss:1.1788,stance loss: 0.98359 
Train step: 1360 acc:0.76894 total_loss: 0.95675  loss:0.86607,stance loss: 0.79754 
Train step: 1370 acc:0.7722 total_loss: 0.95072  loss:0.78029,stance loss: 0.64219 
Train step: 1380 acc:0.76453 total_loss: 0.96824  loss:1.0037,stance loss: 0.72465 
Train step: 1390 acc:0.76367 total_loss: 0.95694  loss:0.97911,stance loss: 0.72178 
Train step: 1400 acc:0.76297 total_loss: 0.95431  loss:1.0861,stance loss: 0.84982 
Train step: 1410 acc:0.76562 total_loss: 0.94914  loss:0.7694,stance loss: 0.63399 
Train step: 1420 acc:0.76984 total_loss: 0.94019  loss:1.0616,stance loss: 0.73155 
Train step: 1430 acc:0.7693 total_loss: 0.93892  loss:0.85428,stance loss: 0.68762 
Train step: 1440 acc:0.76969 total_loss: 0.93087  loss:1.4351,stance loss: 1.2847 
Train step: 1450 acc:0.77163 total_loss: 0.92573  loss:0.67012,stance loss: 0.49914 
Train step: 1460 acc:0.77334 total_loss: 0.92395  loss:0.72011,stance loss: 0.60649 
Train step: 1470 acc:0.77131 total_loss: 0.93011  loss:0.82981,stance loss: 0.60328 
Train step: 1480 acc:0.77083 total_loss: 0.93211  loss:1.2838,stance loss: 1.3131 
Train step: 1490 acc:0.76818 total_loss: 0.92971  loss:0.6774,stance loss: 0.47751 
Train step: 1500 acc:0.7682 total_loss: 0.92926  loss:1.3744,stance loss: 1.1375 
Train step: 1510 acc:0.76476 total_loss: 0.93268  loss:0.74295,stance loss: 0.62153 
Train step: 1520 acc:0.76493 total_loss: 0.93292  loss:0.65275,stance loss: 0.58098 
Train step: 1530 acc:0.76271 total_loss: 0.9355  loss:0.92027,stance loss: 0.59194 
Train step: 1540 acc:0.76347 total_loss: 0.93381  loss:0.84316,stance loss: 0.63067 
Train step: 1550 acc:0.76294 total_loss: 0.9334  loss:0.60027,stance loss: 0.40141 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1560 acc:0.79464 total_loss: 0.77072  loss:0.72977,stance loss: 0.5667 
Train step: 1570 acc:0.76471 total_loss: 0.83803  loss:1.1193,stance loss: 0.93118 
Train step: 1580 acc:0.77778 total_loss: 0.83938  loss:0.6668,stance loss: 0.46084 
Train step: 1590 acc:0.77703 total_loss: 0.83235  loss:0.63381,stance loss: 0.50748 
Train step: 1600 acc:0.7859 total_loss: 0.82284  loss:1.2933,stance loss: 1.232 
Train step: 1610 acc:0.78728 total_loss: 0.82571  loss:1.0032,stance loss: 1.2849 
Train step: 1620 acc:0.78545 total_loss: 0.83604  loss:0.89531,stance loss: 0.60572 
Train step: 1630 acc:0.78977 total_loss: 0.82481  loss:1.0741,stance loss: 0.78397 
Train step: 1640 acc:0.78951 total_loss: 0.82735  loss:0.93201,stance loss: 0.68247 
Train step: 1650 acc:0.79059 total_loss: 0.828  loss:1.2949,stance loss: 1.3239 
Train step: 1660 acc:0.78621 total_loss: 0.83974  loss:0.53774,stance loss: 0.45177 
Train step: 1670 acc:0.78793 total_loss: 0.83441  loss:0.36117,stance loss: 0.2085 
Train step: 1680 acc:0.78396 total_loss: 0.83644  loss:0.90588,stance loss: 0.7875 
Train step: 1690 acc:0.78467 total_loss: 0.83601  loss:0.83506,stance loss: 0.65497 
Train step: 1700 acc:0.78699 total_loss: 0.8279  loss:0.92435,stance loss: 0.77945 
Train step: 1710 acc:0.79021 total_loss: 0.82579  loss:0.76658,stance loss: 1.0816 
Train step: 1720 acc:0.78743 total_loss: 0.83629  loss:1.0207,stance loss: 1.0281 
Train step: 1730 acc:0.78708 total_loss: 0.83971  loss:0.84296,stance loss: 1.1633 
Train step: 1740 acc:0.78576 total_loss: 0.83955  loss:0.95386,stance loss: 0.78856 
Train step: 1750 acc:0.7868 total_loss: 0.83985  loss:1.3457,stance loss: 1.2331 
Train step: 1760 acc:0.78502 total_loss: 0.83781  loss:0.88978,stance loss: 0.57942 
Train step: 1770 acc:0.78399 total_loss: 0.83941  loss:0.69736,stance loss: 0.54532 
Train step: 1780 acc:0.78387 total_loss: 0.83834  loss:0.76676,stance loss: 0.48911 
Train step: 1790 acc:0.78402 total_loss: 0.83475  loss:0.51645,stance loss: 0.40113 
Train step: 1800 acc:0.78669 total_loss: 0.83255  loss:0.89196,stance loss: 0.71326 
Train step: 1810 acc:0.78745 total_loss: 0.83143  loss:0.7266,stance loss: 0.5413 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1820 acc:0.77344 total_loss: 0.72588  loss:0.86925,stance loss: 0.61746 
Train step: 1830 acc:0.82292 total_loss: 0.6551  loss:0.4072,stance loss: 0.30264 
Train step: 1840 acc:0.8058 total_loss: 0.70945  loss:1.3056,stance loss: 1.0956 
Train step: 1850 acc:0.82237 total_loss: 0.69651  loss:0.67315,stance loss: 0.56815 
Train step: 1860 acc:0.82812 total_loss: 0.67564  loss:0.59835,stance loss: 0.3414 
Train step: 1870 acc:0.83405 total_loss: 0.68068  loss:0.75586,stance loss: 0.7986 
Train step: 1880 acc:0.83088 total_loss: 0.68502  loss:0.62726,stance loss: 0.53861 
Train step: 1890 acc:0.83173 total_loss: 0.69762  loss:0.66787,stance loss: 0.5123 
Train step: 1900 acc:0.83665 total_loss: 0.68709  loss:0.84955,stance loss: 0.72292 
Train step: 1910 acc:0.83163 total_loss: 0.69693  loss:1.0198,stance loss: 1.1456 
Train step: 1920 acc:0.82986 total_loss: 0.6998  loss:1.214,stance loss: 1.5017 
Train step: 1930 acc:0.82892 total_loss: 0.7025  loss:1.028,stance loss: 1.3988 
Train step: 1940 acc:0.82959 total_loss: 0.70135  loss:1.0541,stance loss: 0.85863 
Train step: 1950 acc:0.83016 total_loss: 0.70376  loss:1.0506,stance loss: 0.9462 
Train step: 1960 acc:0.83108 total_loss: 0.70021  loss:0.78826,stance loss: 0.6063 
Train step: 1970 acc:0.83307 total_loss: 0.69573  loss:0.77459,stance loss: 0.60733 
Train step: 1980 acc:0.83482 total_loss: 0.70106  loss:0.4917,stance loss: 0.23166 
Train step: 1990 acc:0.83708 total_loss: 0.69992  loss:0.602,stance loss: 0.3746 
Train step: 2000 acc:0.8361 total_loss: 0.70388  loss:0.82937,stance loss: 0.67499 
Train step: 2010 acc:0.83712 total_loss: 0.70926  loss:0.99846,stance loss: 1.3089 
Train step: 2020 acc:0.83624 total_loss: 0.71645  loss:0.37122,stance loss: 0.25351 
Train step: 2030 acc:0.83572 total_loss: 0.71735  loss:0.50177,stance loss: 0.52531 
Train step: 2040 acc:0.83525 total_loss: 0.71803  loss:0.32649,stance loss: 0.15361 
Train step: 2050 acc:0.83482 total_loss: 0.71766  loss:0.55325,stance loss: 0.35603 
Train step: 2060 acc:0.83317 total_loss: 0.7178  loss:0.43682,stance loss: 0.3152 
Train step: 2070 acc:0.8314 total_loss: 0.72311  loss:1.1739,stance loss: 1.5127 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2080 acc:0.86111 total_loss: 0.63146  loss:0.85444,stance loss: 0.61854 
Train step: 2090 acc:0.87171 total_loss: 0.57061  loss:0.38652,stance loss: 0.31819 
Train step: 2100 acc:0.85991 total_loss: 0.60788  loss:0.95482,stance loss: 1.0663 
Train step: 2110 acc:0.86218 total_loss: 0.6152  loss:0.73067,stance loss: 0.3952 
Train step: 2120 acc:0.86352 total_loss: 0.61525  loss:0.29089,stance loss: 0.11452 
Train step: 2130 acc:0.85911 total_loss: 0.61862  loss:0.67142,stance loss: 0.5651 
Train step: 2140 acc:0.86232 total_loss: 0.63428  loss:0.55816,stance loss: 0.45018 
Train step: 2150 acc:0.85522 total_loss: 0.6483  loss:0.75052,stance loss: 0.58772 
Train step: 2160 acc:0.85183 total_loss: 0.64954  loss:0.51689,stance loss: 0.37905 
Train step: 2170 acc:0.85543 total_loss: 0.63883  loss:0.63214,stance loss: 0.59787 
Train step: 2180 acc:0.85436 total_loss: 0.64098  loss:0.62766,stance loss: 0.51502 
Train step: 2190 acc:0.85504 total_loss: 0.6368  loss:0.4649,stance loss: 0.2909 
Train step: 2200 acc:0.85514 total_loss: 0.64437  loss:0.7237,stance loss: 1.0889 
Train step: 2210 acc:0.85567 total_loss: 0.63351  loss:0.65825,stance loss: 0.4798 
Train step: 2220 acc:0.8578 total_loss: 0.62669  loss:0.48715,stance loss: 0.37937 
Train step: 2230 acc:0.8577 total_loss: 0.62601  loss:0.49677,stance loss: 0.44345 
Train step: 2240 acc:0.85947 total_loss: 0.62447  loss:0.83137,stance loss: 0.79064 
Train step: 2250 acc:0.85859 total_loss: 0.62469  loss:1.3109,stance loss: 1.6114 
Train step: 2260 acc:0.85979 total_loss: 0.62539  loss:1.1881,stance loss: 1.1449 
Train step: 2270 acc:0.86024 total_loss: 0.62142  loss:1.0706,stance loss: 0.96538 
Train step: 2280 acc:0.86005 total_loss: 0.62525  loss:1.08,stance loss: 0.95662 
Train step: 2290 acc:0.86273 total_loss: 0.61948  loss:0.19213,stance loss: 0.097875 
Train step: 2300 acc:0.86163 total_loss: 0.62227  loss:1.0664,stance loss: 0.82295 
Train step: 2310 acc:0.86062 total_loss: 0.62715  loss:1.2732,stance loss: 1.5234 
Train step: 2320 acc:0.85944 total_loss: 0.62787  loss:0.5988,stance loss: 0.49308 
Train step: 2330 acc:0.85956 total_loss: 0.62972  loss:1.2064,stance loss: 1.9936 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2340 acc:0.89375 total_loss: 0.6103  loss:0.38866,stance loss: 0.32012 
Train step: 2350 acc:0.89687 total_loss: 0.53966  loss:0.53546,stance loss: 0.52624 
Train step: 2360 acc:0.89583 total_loss: 0.54994  loss:0.69086,stance loss: 0.6223 
Train step: 2370 acc:0.89687 total_loss: 0.526  loss:0.48762,stance loss: 0.2153 
Train step: 2380 acc:0.8875 total_loss: 0.57293  loss:0.32115,stance loss: 0.23479 
Train step: 2390 acc:0.89375 total_loss: 0.54311  loss:0.17914,stance loss: 0.12705 
Train step: 2400 acc:0.89196 total_loss: 0.54681  loss:0.66581,stance loss: 0.56807 
Train step: 2410 acc:0.89219 total_loss: 0.54447  loss:0.59751,stance loss: 0.3815 
Train step: 2420 acc:0.89583 total_loss: 0.53044  loss:0.36873,stance loss: 0.25045 
Train step: 2430 acc:0.89438 total_loss: 0.53233  loss:0.43196,stance loss: 0.38616 
Train step: 2440 acc:0.89205 total_loss: 0.53596  loss:0.83806,stance loss: 0.64279 
Train step: 2450 acc:0.88802 total_loss: 0.53509  loss:0.38322,stance loss: 0.28311 
Train step: 2460 acc:0.88798 total_loss: 0.53353  loss:0.6999,stance loss: 0.44494 
Train step: 2470 acc:0.88839 total_loss: 0.52971  loss:0.37108,stance loss: 0.13009 
Train step: 2480 acc:0.8875 total_loss: 0.53816  loss:0.88294,stance loss: 0.70775 
Train step: 2490 acc:0.88711 total_loss: 0.53976  loss:0.31424,stance loss: 0.23076 
Train step: 2500 acc:0.88456 total_loss: 0.5423  loss:0.48165,stance loss: 0.38568 
Train step: 2510 acc:0.88576 total_loss: 0.53328  loss:0.45921,stance loss: 0.35158 
Train step: 2520 acc:0.8852 total_loss: 0.53425  loss:0.53819,stance loss: 0.38432 
Train step: 2530 acc:0.88469 total_loss: 0.53705  loss:0.60343,stance loss: 0.48848 
Train step: 2540 acc:0.88601 total_loss: 0.52954  loss:0.80308,stance loss: 0.71959 
Train step: 2550 acc:0.88409 total_loss: 0.52986  loss:0.73012,stance loss: 0.73007 
Train step: 2560 acc:0.88505 total_loss: 0.52703  loss:0.36426,stance loss: 0.30209 
Train step: 2570 acc:0.88672 total_loss: 0.5218  loss:0.27522,stance loss: 0.20927 
Train step: 2580 acc:0.88725 total_loss: 0.51985  loss:0.32854,stance loss: 0.2742 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2590 acc:0.875 total_loss: 0.37297  loss:0.37297,stance loss: 0.26777 
Train step: 2600 acc:0.88068 total_loss: 0.41699  loss:0.18909,stance loss: 0.10493 
Train step: 2610 acc:0.88095 total_loss: 0.42246  loss:0.49238,stance loss: 0.40425 
Train step: 2620 acc:0.87702 total_loss: 0.47482  loss:0.30645,stance loss: 0.15181 
Train step: 2630 acc:0.89329 total_loss: 0.44258  loss:0.48484,stance loss: 0.42115 
Train step: 2640 acc:0.89706 total_loss: 0.43062  loss:0.67763,stance loss: 0.5578 
Train step: 2650 acc:0.89857 total_loss: 0.43797  loss:0.11716,stance loss: 0.05659 
Train step: 2660 acc:0.90141 total_loss: 0.44515  loss:0.18067,stance loss: 0.11419 
Train step: 2670 acc:0.90586 total_loss: 0.45068  loss:0.55316,stance loss: 0.65812 
Train step: 2680 acc:0.90316 total_loss: 0.46923  loss:0.81027,stance loss: 1.1654 
Train step: 2690 acc:0.90347 total_loss: 0.46724  loss:0.30389,stance loss: 0.18797 
Train step: 2700 acc:0.90597 total_loss: 0.4605  loss:0.24867,stance loss: 0.11911 
Train step: 2710 acc:0.90909 total_loss: 0.45449  loss:0.93041,stance loss: 1.2458 
Train step: 2720 acc:0.9084 total_loss: 0.45821  loss:0.525,stance loss: 0.41119 
Train step: 2730 acc:0.9109 total_loss: 0.44734  loss:0.28372,stance loss: 0.13917 
Train step: 2740 acc:0.91142 total_loss: 0.44836  loss:0.67664,stance loss: 0.50702 
Train step: 2750 acc:0.91266 total_loss: 0.44334  loss:0.33523,stance loss: 0.26448 
Train step: 2760 acc:0.91228 total_loss: 0.44797  loss:0.14222,stance loss: 0.12815 
Train step: 2770 acc:0.91229 total_loss: 0.45445  loss:0.15181,stance loss: 0.044513 
Train step: 2780 acc:0.91394 total_loss: 0.44815  loss:0.34181,stance loss: 0.32865 
Train step: 2790 acc:0.91387 total_loss: 0.4451  loss:0.37307,stance loss: 0.39011 
Train step: 2800 acc:0.9138 total_loss: 0.44352  loss:0.423,stance loss: 0.47041 
Train step: 2810 acc:0.91233 total_loss: 0.44315  loss:0.50953,stance loss: 0.37656 
Train step: 2820 acc:0.9099 total_loss: 0.44948  loss:1.1517,stance loss: 0.96828 
Train step: 2830 acc:0.90949 total_loss: 0.4495  loss:0.6436,stance loss: 0.47973 
Train step: 2840 acc:0.90862 total_loss: 0.45127  loss:0.57555,stance loss: 0.4291 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2850 acc:0.84375 total_loss: 0.67676  loss:0.54004,stance loss: 0.41899 
Train step: 2860 acc:0.90625 total_loss: 0.50699  loss:0.32817,stance loss: 0.28407 
Train step: 2870 acc:0.91477 total_loss: 0.46567  loss:0.23814,stance loss: 0.12295 
Train step: 2880 acc:0.91016 total_loss: 0.46079  loss:0.23979,stance loss: 0.13032 
Train step: 2890 acc:0.91518 total_loss: 0.41206  loss:0.085495,stance loss: 0.014439 
Train step: 2900 acc:0.92308 total_loss: 0.39836  loss:0.13602,stance loss: 0.078785 
Train step: 2910 acc:0.93044 total_loss: 0.37701  loss:0.13945,stance loss: 0.068362 
Train step: 2920 acc:0.93316 total_loss: 0.36126  loss:0.21298,stance loss: 0.13817 
Train step: 2930 acc:0.93369 total_loss: 0.35447  loss:0.28305,stance loss: 0.030711 
Train step: 2940 acc:0.93818 total_loss: 0.35341  loss:0.16775,stance loss: 0.058284 
Train step: 2950 acc:0.93321 total_loss: 0.36572  loss:0.19103,stance loss: 0.071558 
Train step: 2960 acc:0.93415 total_loss: 0.36325  loss:0.37164,stance loss: 0.28933 
Train step: 2970 acc:0.93596 total_loss: 0.35728  loss:0.33573,stance loss: 0.27024 
Train step: 2980 acc:0.93513 total_loss: 0.36087  loss:0.39578,stance loss: 0.30698 
Train step: 2990 acc:0.93618 total_loss: 0.35497  loss:0.28518,stance loss: 0.22945 
Train step: 3000 acc:0.93627 total_loss: 0.35336  loss:0.23505,stance loss: 0.19214 
Train step: 3010 acc:0.93596 total_loss: 0.35254  loss:0.72624,stance loss: 0.74431 
Train step: 3020 acc:0.93387 total_loss: 0.35501  loss:0.11298,stance loss: 0.049984 
Train step: 3030 acc:0.93304 total_loss: 0.3608  loss:0.26141,stance loss: 0.26313 
Train step: 3040 acc:0.93262 total_loss: 0.36471  loss:0.64209,stance loss: 0.57896 
Train step: 3050 acc:0.93348 total_loss: 0.36506  loss:0.56978,stance loss: 1.0188 
Train step: 3060 acc:0.93396 total_loss: 0.36272  loss:0.16899,stance loss: 0.088191 
Train step: 3070 acc:0.93356 total_loss: 0.36268  loss:0.35738,stance loss: 0.17968 
Train step: 3080 acc:0.93265 total_loss: 0.36232  loss:0.17222,stance loss: 0.072286 
Train step: 3090 acc:0.93079 total_loss: 0.36713  loss:1.0345,stance loss: 1.4611 
Train step: 3100 acc:0.93031 total_loss: 0.36793  loss:0.2852,stance loss: 0.1592 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3110 acc:0.95833 total_loss: 0.24756  loss:0.30788,stance loss: 0.30542 
Train step: 3120 acc:0.94231 total_loss: 0.34323  loss:0.10357,stance loss: 0.04765 
Train step: 3130 acc:0.94293 total_loss: 0.31843  loss:0.11958,stance loss: 0.053745 
Train step: 3140 acc:0.94318 total_loss: 0.32078  loss:0.098165,stance loss: 0.048688 
Train step: 3150 acc:0.94913 total_loss: 0.29277  loss:0.086695,stance loss: 0.031748 
Train step: 3160 acc:0.95047 total_loss: 0.29681  loss:0.074856,stance loss: 0.0096198 
Train step: 3170 acc:0.95139 total_loss: 0.28367  loss:0.057952,stance loss: 0.0072753 
Train step: 3180 acc:0.95205 total_loss: 0.28207  loss:0.05925,stance loss: 0.010583 
Train step: 3190 acc:0.95181 total_loss: 0.28704  loss:0.11115,stance loss: 0.014369 
Train step: 3200 acc:0.95161 total_loss: 0.28427  loss:0.19171,stance loss: 0.10207 
Train step: 3210 acc:0.95267 total_loss: 0.27854  loss:0.51194,stance loss: 0.42675 
Train step: 3220 acc:0.95409 total_loss: 0.27646  loss:0.12788,stance loss: 0.038821 
Train step: 3230 acc:0.95376 total_loss: 0.28023  loss:0.1059,stance loss: 0.06759 
Train step: 3240 acc:0.95442 total_loss: 0.2733  loss:0.066414,stance loss: 0.018376 
Train step: 3250 acc:0.95586 total_loss: 0.27566  loss:0.67213,stance loss: 1.0976 
Train step: 3260 acc:0.95711 total_loss: 0.27612  loss:0.082175,stance loss: 0.020204 
Train step: 3270 acc:0.95629 total_loss: 0.27618  loss:0.38795,stance loss: 0.45303 
Train step: 3280 acc:0.9552 total_loss: 0.2825  loss:0.41906,stance loss: 0.3926 
Train step: 3290 acc:0.95287 total_loss: 0.29064  loss:0.23298,stance loss: 0.1568 
Train step: 3300 acc:0.95304 total_loss: 0.2878  loss:0.15906,stance loss: 0.12254 
Train step: 3310 acc:0.95351 total_loss: 0.28685  loss:0.8575,stance loss: 0.87711 
Train step: 3320 acc:0.95217 total_loss: 0.29052  loss:0.48191,stance loss: 0.46917 
Train step: 3330 acc:0.95207 total_loss: 0.28809  loss:0.33384,stance loss: 0.19097 
Train step: 3340 acc:0.95172 total_loss: 0.28844  loss:0.12833,stance loss: 0.091054 
Train step: 3350 acc:0.95216 total_loss: 0.28887  loss:0.35873,stance loss: 0.3017 
Train step: 3360 acc:0.95109 total_loss: 0.29409  loss:0.23776,stance loss: 0.10426 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3370 acc:0.9375 total_loss: 0.3327  loss:0.26441,stance loss: 0.19052 
Train step: 3380 acc:0.96429 total_loss: 0.24569  loss:0.045221,stance loss: 0.0059415 
Train step: 3390 acc:0.96354 total_loss: 0.22087  loss:0.068304,stance loss: 0.019305 
Train step: 3400 acc:0.96691 total_loss: 0.20262  loss:0.15397,stance loss: 0.12498 
Train step: 3410 acc:0.96591 total_loss: 0.21418  loss:0.565,stance loss: 0.52139 
Train step: 3420 acc:0.96759 total_loss: 0.21164  loss:0.1946,stance loss: 0.096396 
Train step: 3430 acc:0.96973 total_loss: 0.21492  loss:0.065133,stance loss: 0.010083 
Train step: 3440 acc:0.96875 total_loss: 0.23142  loss:0.033385,stance loss: 0.002764 
Train step: 3450 acc:0.96949 total_loss: 0.21899  loss:0.24912,stance loss: 0.18441 
Train step: 3460 acc:0.96941 total_loss: 0.21704  loss:0.36486,stance loss: 0.30938 
Train step: 3470 acc:0.96635 total_loss: 0.22025  loss:0.28414,stance loss: 0.23268 
Train step: 3480 acc:0.96546 total_loss: 0.22584  loss:0.092089,stance loss: 0.059231 
Train step: 3490 acc:0.96421 total_loss: 0.23372  loss:0.040925,stance loss: 0.0096807 
Train step: 3500 acc:0.96595 total_loss: 0.22848  loss:0.1456,stance loss: 0.047613 
Train step: 3510 acc:0.96658 total_loss: 0.22857  loss:0.26409,stance loss: 0.22431 
Train step: 3520 acc:0.96591 total_loss: 0.22614  loss:0.45982,stance loss: 0.4378 
Train step: 3530 acc:0.96418 total_loss: 0.23292  loss:0.067932,stance loss: 0.014211 
Train step: 3540 acc:0.96193 total_loss: 0.24142  loss:1.0422,stance loss: 1.0969 
Train step: 3550 acc:0.96196 total_loss: 0.24362  loss:0.31315,stance loss: 0.20175 
Train step: 3560 acc:0.9607 total_loss: 0.24463  loss:0.043689,stance loss: 0.011081 
Train step: 3570 acc:0.96201 total_loss: 0.24242  loss:0.57726,stance loss: 0.58981 
Train step: 3580 acc:0.96232 total_loss: 0.24426  loss:0.45259,stance loss: 0.43335 
Train step: 3590 acc:0.96289 total_loss: 0.24213  loss:0.71512,stance loss: 1.0537 
Train step: 3600 acc:0.96287 total_loss: 0.24318  loss:0.57292,stance loss: 1.0176 
Train step: 3610 acc:0.96235 total_loss: 0.2464  loss:0.053746,stance loss: 0.0069941 
Train step: 3620 acc:0.96161 total_loss: 0.24512  loss:0.053659,stance loss: 0.003772 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3630 acc:0.95 total_loss: 0.17948  loss:0.22422,stance loss: 0.15221 
Train step: 3640 acc:0.95 total_loss: 0.23768  loss:0.47209,stance loss: 0.54386 
Train step: 3650 acc:0.955 total_loss: 0.24128  loss:0.66975,stance loss: 1.007 
Train step: 3660 acc:0.95893 total_loss: 0.21143  loss:0.060359,stance loss: 0.014615 
Train step: 3670 acc:0.9625 total_loss: 0.21182  loss:0.22249,stance loss: 0.19418 
Train step: 3680 acc:0.96364 total_loss: 0.20181  loss:0.072894,stance loss: 0.016552 
Train step: 3690 acc:0.96346 total_loss: 0.20899  loss:0.60839,stance loss: 0.58986 
Train step: 3700 acc:0.9625 total_loss: 0.21077  loss:0.5241,stance loss: 0.4836 
Train step: 3710 acc:0.96324 total_loss: 0.21508  loss:0.11582,stance loss: 0.092253 
Train step: 3720 acc:0.96513 total_loss: 0.20725  loss:0.056714,stance loss: 0.0038451 
Train step: 3730 acc:0.96726 total_loss: 0.20111  loss:0.063566,stance loss: 0.021706 
Train step: 3740 acc:0.96793 total_loss: 0.1997  loss:0.047389,stance loss: 0.010729 
Train step: 3750 acc:0.969 total_loss: 0.19737  loss:0.085576,stance loss: 0.041035 
Train step: 3760 acc:0.96759 total_loss: 0.20391  loss:0.50543,stance loss: 0.41782 
Train step: 3770 acc:0.96724 total_loss: 0.20203  loss:0.54586,stance loss: 0.27172 
Train step: 3780 acc:0.96613 total_loss: 0.21932  loss:0.82828,stance loss: 1.1177 
Train step: 3790 acc:0.96553 total_loss: 0.21777  loss:0.05755,stance loss: 0.018183 
Train step: 3800 acc:0.96643 total_loss: 0.2162  loss:0.079253,stance loss: 0.029987 
Train step: 3810 acc:0.96588 total_loss: 0.22343  loss:0.093241,stance loss: 0.054358 
Train step: 3820 acc:0.96667 total_loss: 0.21873  loss:0.075746,stance loss: 0.053274 
Train step: 3830 acc:0.96646 total_loss: 0.21845  loss:0.40993,stance loss: 0.37445 
Train step: 3840 acc:0.96541 total_loss: 0.22188  loss:0.042462,stance loss: 0.014733 
Train step: 3850 acc:0.96583 total_loss: 0.22102  loss:0.039111,stance loss: 0.012351 
Train step: 3860 acc:0.96649 total_loss: 0.21613  loss:0.10298,stance loss: 0.015802 
Train step: 3870 acc:0.96684 total_loss: 0.21489  loss:0.06787,stance loss: 0.041195 
Train step: 3880 acc:0.96667 total_loss: 0.21639  loss:0.18538,stance loss: 0.094705 
Training finished.


Reload the best model with best f1 0.4571991653141665 from path test_outputs/bert-cross-topic/a/2023-08-14 16-58-20/state_dict


              precision    recall  f1-score   support

           0   0.698198  0.668103  0.682819       464
           1   0.448430  0.689655  0.543478       145
           2   0.333333  0.177419  0.231579       124

    accuracy                       0.589359       733
   macro avg   0.493321  0.511726  0.485959       733
weighted avg   0.587066  0.589359  0.578920       733

Test Acc: 0.5893587994542974 F1_ma:0.4571991653141665
Test dataset: a
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4571991653141665
acc: 0.5893587994542974, f1 :0.4859588638326327
classification report: 
              precision    recall  f1-score   support

         Con     0.6982    0.6681    0.6828       464
        None     0.4484    0.6897    0.5435       145
         Pro     0.3333    0.1774    0.2316       124

    accuracy                         0.5894       733
   macro avg     0.4933    0.5117    0.4860       733
weighted avg     0.5871    0.5894    0.5789       733

