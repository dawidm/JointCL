run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 13-50-41', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 13-50-41
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.8793  loss:1.8793,stance loss: 1.1483 
Train step: 10 acc:0.25 total_loss: 1.8605  loss:1.8431,stance loss: 1.2487 
Better F1! Saving model!
Saving model of best f1: 0.07838563542541702
              precision    recall  f1-score   support

           0   0.422680  0.075368  0.127925       544
           1   0.179874  0.644144  0.281219       222
           2   0.073171  0.017964  0.028846       167

    accuracy                       0.200429       933
   macro avg   0.225242  0.245825  0.145997       933
weighted avg   0.302347  0.200429  0.146666       933

Test Acc: 0.20042872454448016 F1_ma:0.07838563542541702
Train step: 20 acc:0.23214 total_loss: 1.7928  loss:1.522,stance loss: 0.9219 
Better F1! Saving model!
Saving model of best f1: 0.24869552182010018
              precision    recall  f1-score   support

           0   0.551020  0.148897  0.234443       544
           1   0.035000  0.031532  0.033175       222
           2   0.168942  0.592814  0.262948       167

    accuracy                       0.200429       933
   macro avg   0.251654  0.257748  0.176855       933
weighted avg   0.359848  0.200429  0.191655       933

Test Acc: 0.20042872454448016 F1_ma:0.24869552182010018
Train step: 30 acc:0.26815 total_loss: 1.771  loss:1.6736,stance loss: 1.1554 
Better F1! Saving model!
Saving model of best f1: 0.34767025089605735
              precision    recall  f1-score   support

           0   0.569918  0.891544  0.695341       544
           1   0.036585  0.013514  0.019737       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.523044       933
   macro avg   0.202168  0.301686  0.238359       933
weighted avg   0.341005  0.523044  0.410125       933

Test Acc: 0.5230439442658092 F1_ma:0.34767025089605735
Train step: 40 acc:0.31098 total_loss: 1.7385  loss:1.7354,stance loss: 1.2491 
Better F1! Saving model!
Saving model of best f1: 0.3611302549965541
              precision    recall  f1-score   support

           0   0.577729  0.963235  0.722261       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.561629       933
   macro avg   0.192576  0.321078  0.240754       933
weighted avg   0.336854  0.561629  0.421125       933

Test Acc: 0.5616291532690246 F1_ma:0.3611302549965541
Train step: 50 acc:0.34436 total_loss: 1.7279  loss:1.6573,stance loss: 1.1868 
Better F1! Saving model!
Saving model of best f1: 0.36831415030467163
              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Train step: 60 acc:0.36783 total_loss: 1.7073  loss:1.906,stance loss: 1.2129 
Train step: 70 acc:0.37852 total_loss: 1.7004  loss:1.756,stance loss: 1.1794 
Train step: 80 acc:0.3858 total_loss: 1.7031  loss:1.4722,stance loss: 1.0887 
Train step: 90 acc:0.39629 total_loss: 1.6987  loss:1.5831,stance loss: 1.1408 
Train step: 100 acc:0.40161 total_loss: 1.6931  loss:1.632,stance loss: 1.1805 
Train step: 110 acc:0.40597 total_loss: 1.6868  loss:1.599,stance loss: 1.1417 
Train step: 120 acc:0.41529 total_loss: 1.6789  loss:1.7179,stance loss: 1.6799 
Train step: 130 acc:0.41985 total_loss: 1.6737  loss:1.667,stance loss: 1.1542 
Train step: 140 acc:0.42553 total_loss: 1.6659  loss:1.4483,stance loss: 1.0535 
Train step: 150 acc:0.43005 total_loss: 1.6606  loss:1.7251,stance loss: 1.7582 
Train step: 160 acc:0.43478 total_loss: 1.6505  loss:1.3949,stance loss: 0.979 
Train step: 170 acc:0.43787 total_loss: 1.6399  loss:1.6126,stance loss: 1.1566 
Train step: 180 acc:0.44268 total_loss: 1.6316  loss:1.5277,stance loss: 1.1139 
Train step: 190 acc:0.44666 total_loss: 1.6274  loss:1.5529,stance loss: 1.0573 
Train step: 200 acc:0.45616 total_loss: 1.6164  loss:1.6116,stance loss: 1.2317 
Train step: 210 acc:0.45972 total_loss: 1.6119  loss:1.4356,stance loss: 1.1062 
Train step: 220 acc:0.46295 total_loss: 1.6093  loss:1.7118,stance loss: 1.3025 
Train step: 230 acc:0.46889 total_loss: 1.602  loss:1.2897,stance loss: 0.74933 
Train step: 240 acc:0.47147 total_loss: 1.5978  loss:1.4028,stance loss: 0.96492 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.6625 total_loss: 1.4075  loss:1.449,stance loss: 1.5519 
Train step: 260 acc:0.65 total_loss: 1.413  loss:1.4411,stance loss: 1.1935 
Train step: 270 acc:0.6075 total_loss: 1.417  loss:1.429,stance loss: 1.0712 
Train step: 280 acc:0.61607 total_loss: 1.4151  loss:1.2625,stance loss: 0.97982 
Train step: 290 acc:0.60278 total_loss: 1.4231  loss:1.3179,stance loss: 1.1637 
Train step: 300 acc:0.59773 total_loss: 1.4396  loss:1.4138,stance loss: 1.1725 
Train step: 310 acc:0.59327 total_loss: 1.4311  loss:1.4699,stance loss: 1.1247 
Train step: 320 acc:0.58333 total_loss: 1.4439  loss:1.4183,stance loss: 1.0939 
Train step: 330 acc:0.58382 total_loss: 1.4374  loss:1.2624,stance loss: 0.99661 
Train step: 340 acc:0.5875 total_loss: 1.4245  loss:1.3371,stance loss: 0.96944 
Train step: 350 acc:0.59048 total_loss: 1.4303  loss:1.8001,stance loss: 1.3773 
Train step: 360 acc:0.59185 total_loss: 1.4311  loss:1.3861,stance loss: 1.0951 
Train step: 370 acc:0.5885 total_loss: 1.4339  loss:1.4049,stance loss: 1.0175 
Train step: 380 acc:0.58565 total_loss: 1.4302  loss:1.5287,stance loss: 1.1728 
Train step: 390 acc:0.59009 total_loss: 1.4238  loss:1.182,stance loss: 0.83961 
Train step: 400 acc:0.59315 total_loss: 1.4149  loss:1.1438,stance loss: 0.7977 
Train step: 410 acc:0.59583 total_loss: 1.4134  loss:1.2969,stance loss: 0.97617 
Train step: 420 acc:0.59607 total_loss: 1.411  loss:1.6619,stance loss: 1.1841 
Train step: 430 acc:0.59865 total_loss: 1.4039  loss:1.2967,stance loss: 0.98384 
Train step: 440 acc:0.5984 total_loss: 1.4028  loss:1.4213,stance loss: 1.0698 
Train step: 450 acc:0.59787 total_loss: 1.4026  loss:1.0483,stance loss: 0.70336 
Train step: 460 acc:0.59738 total_loss: 1.396  loss:1.1629,stance loss: 0.88731 
Train step: 470 acc:0.59889 total_loss: 1.3937  loss:1.4709,stance loss: 1.2915 
Train step: 480 acc:0.60027 total_loss: 1.3875  loss:1.6626,stance loss: 1.4358 
Train step: 490 acc:0.60051 total_loss: 1.3831  loss:1.2624,stance loss: 0.93775 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.61806 total_loss: 1.3645  loss:1.2795,stance loss: 1.4348 
Train step: 510 acc:0.63487 total_loss: 1.3356  loss:0.72251,stance loss: 0.48195 
Train step: 520 acc:0.62931 total_loss: 1.3237  loss:0.90875,stance loss: 0.73685 
Train step: 530 acc:0.6266 total_loss: 1.306  loss:1.0553,stance loss: 0.72408 
Train step: 540 acc:0.63138 total_loss: 1.2924  loss:1.3064,stance loss: 1.1068 
Train step: 550 acc:0.63559 total_loss: 1.2887  loss:1.4563,stance loss: 1.1537 
Train step: 560 acc:0.63134 total_loss: 1.2939  loss:1.2478,stance loss: 0.7006 
Train step: 570 acc:0.63608 total_loss: 1.3001  loss:1.501,stance loss: 1.265 
Train step: 580 acc:0.63343 total_loss: 1.313  loss:1.4562,stance loss: 1.1622 
Train step: 590 acc:0.63321 total_loss: 1.315  loss:1.1672,stance loss: 0.92665 
Train step: 600 acc:0.63532 total_loss: 1.3114  loss:1.1565,stance loss: 0.84092 
Train step: 610 acc:0.6355 total_loss: 1.304  loss:1.512,stance loss: 1.4532 
Train step: 620 acc:0.64244 total_loss: 1.2928  loss:1.2775,stance loss: 1.3729 
Train step: 630 acc:0.64793 total_loss: 1.2912  loss:1.1601,stance loss: 0.9946 
Train step: 640 acc:0.64975 total_loss: 1.2947  loss:1.4717,stance loss: 1.3201 
Train step: 650 acc:0.65016 total_loss: 1.2908  loss:1.2896,stance loss: 1.064 
Train step: 660 acc:0.64978 total_loss: 1.2896  loss:1.4621,stance loss: 0.9509 
Train step: 670 acc:0.65258 total_loss: 1.287  loss:0.84839,stance loss: 0.70434 
Train step: 680 acc:0.65146 total_loss: 1.2839  loss:1.064,stance loss: 0.84472 
Train step: 690 acc:0.65389 total_loss: 1.2794  loss:0.96265,stance loss: 0.59732 
Train step: 700 acc:0.65401 total_loss: 1.2744  loss:1.8508,stance loss: 1.3985 
Train step: 710 acc:0.6524 total_loss: 1.2769  loss:1.3605,stance loss: 0.96556 
Train step: 720 acc:0.64874 total_loss: 1.2754  loss:1.2706,stance loss: 0.9675 
Train step: 730 acc:0.6488 total_loss: 1.2756  loss:1.29,stance loss: 1.0538 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.77083 total_loss: 0.98688  loss:0.63554,stance loss: 0.33094 
Train step: 750 acc:0.65865 total_loss: 1.1232  loss:0.80061,stance loss: 0.61962 
Train step: 760 acc:0.66304 total_loss: 1.1285  loss:0.97799,stance loss: 0.78042 
Train step: 770 acc:0.66667 total_loss: 1.1847  loss:1.3135,stance loss: 1.0821 
Train step: 780 acc:0.66134 total_loss: 1.203  loss:1.3961,stance loss: 1.014 
Train step: 790 acc:0.65802 total_loss: 1.207  loss:1.0691,stance loss: 0.90118 
Train step: 800 acc:0.65278 total_loss: 1.2112  loss:1.3893,stance loss: 1.1562 
Train step: 810 acc:0.65582 total_loss: 1.1986  loss:1.0928,stance loss: 0.90913 
Train step: 820 acc:0.66416 total_loss: 1.1912  loss:1.3363,stance loss: 1.4842 
Train step: 830 acc:0.66532 total_loss: 1.185  loss:1.4792,stance loss: 1.3797 
Train step: 840 acc:0.66808 total_loss: 1.1895  loss:1.2432,stance loss: 1.045 
Train step: 850 acc:0.66925 total_loss: 1.1867  loss:1.3564,stance loss: 0.99071 
Train step: 860 acc:0.66819 total_loss: 1.1869  loss:1.2702,stance loss: 0.95333 
Train step: 870 acc:0.66353 total_loss: 1.1923  loss:0.85852,stance loss: 0.74998 
Train step: 880 acc:0.66302 total_loss: 1.1942  loss:1.172,stance loss: 0.96 
Train step: 890 acc:0.6585 total_loss: 1.1977  loss:1.0882,stance loss: 0.84805 
Train step: 900 acc:0.65798 total_loss: 1.1953  loss:1.0173,stance loss: 0.82718 
Train step: 910 acc:0.6604 total_loss: 1.1905  loss:1.2218,stance loss: 0.87125 
Train step: 920 acc:0.65949 total_loss: 1.1945  loss:1.0576,stance loss: 0.80858 
Train step: 930 acc:0.66127 total_loss: 1.1953  loss:1.3221,stance loss: 1.0066 
Train step: 940 acc:0.66379 total_loss: 1.1906  loss:0.52323,stance loss: 0.14434 
Train step: 950 acc:0.66315 total_loss: 1.1887  loss:1.1427,stance loss: 0.89414 
Train step: 960 acc:0.66284 total_loss: 1.1882  loss:1.3052,stance loss: 1.4542 
Train step: 970 acc:0.6647 total_loss: 1.1808  loss:1.1114,stance loss: 0.92839 
Train step: 980 acc:0.66744 total_loss: 1.173  loss:0.71463,stance loss: 0.60114 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.73214 total_loss: 1.0536  loss:1.35,stance loss: 1.1507 
Train step: 1000 acc:0.72426 total_loss: 1.0518  loss:0.91758,stance loss: 0.73931 
Train step: 1010 acc:0.72685 total_loss: 1.0329  loss:0.8644,stance loss: 0.74876 
Train step: 1020 acc:0.70101 total_loss: 1.0921  loss:1.159,stance loss: 0.95826 
Train step: 1030 acc:0.71676 total_loss: 1.0659  loss:0.8318,stance loss: 0.56803 
Train step: 1040 acc:0.71053 total_loss: 1.0801  loss:1.4632,stance loss: 1.1877 
Train step: 1050 acc:0.70802 total_loss: 1.1123  loss:1.1615,stance loss: 0.80828 
Train step: 1060 acc:0.70455 total_loss: 1.1237  loss:1.9065,stance loss: 1.4218 
Train step: 1070 acc:0.70115 total_loss: 1.1164  loss:0.93495,stance loss: 0.70405 
Train step: 1080 acc:0.70168 total_loss: 1.1123  loss:0.9464,stance loss: 0.73717 
Train step: 1090 acc:0.7021 total_loss: 1.1047  loss:1.1639,stance loss: 0.88197 
Train step: 1100 acc:0.70513 total_loss: 1.0861  loss:0.70987,stance loss: 0.63325 
Train step: 1110 acc:0.70374 total_loss: 1.0795  loss:0.83933,stance loss: 0.71109 
Train step: 1120 acc:0.7062 total_loss: 1.0711  loss:0.98874,stance loss: 0.80963 
Train step: 1130 acc:0.69898 total_loss: 1.0815  loss:0.92056,stance loss: 0.78499 
Train step: 1140 acc:0.69865 total_loss: 1.0859  loss:0.8854,stance loss: 0.75705 
Train step: 1150 acc:0.69835 total_loss: 1.0861  loss:1.3167,stance loss: 1.367 
Train step: 1160 acc:0.69633 total_loss: 1.0881  loss:1.1545,stance loss: 0.96028 
Train step: 1170 acc:0.69586 total_loss: 1.0919  loss:1.3703,stance loss: 1.5469 
Train step: 1180 acc:0.6967 total_loss: 1.0864  loss:0.78239,stance loss: 0.62136 
Train step: 1190 acc:0.69777 total_loss: 1.0858  loss:1.1795,stance loss: 0.84537 
Train step: 1200 acc:0.69758 total_loss: 1.0838  loss:1.1106,stance loss: 0.93258 
Train step: 1210 acc:0.69796 total_loss: 1.0847  loss:1.5784,stance loss: 1.3244 
Train step: 1220 acc:0.69673 total_loss: 1.0858  loss:1.0077,stance loss: 0.84135 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.6875 total_loss: 1.4125  loss:1.4125,stance loss: 1.1578 
Train step: 1240 acc:0.73295 total_loss: 1.0679  loss:0.67282,stance loss: 0.59279 
Train step: 1250 acc:0.70833 total_loss: 1.0486  loss:1.0143,stance loss: 0.89738 
Train step: 1260 acc:0.72379 total_loss: 1.0227  loss:1.3008,stance loss: 0.96098 
Train step: 1270 acc:0.72409 total_loss: 1.0265  loss:1.2034,stance loss: 0.99813 
Train step: 1280 acc:0.72672 total_loss: 1.0401  loss:1.32,stance loss: 1.1339 
Train step: 1290 acc:0.72643 total_loss: 1.0433  loss:0.68362,stance loss: 0.52888 
Train step: 1300 acc:0.72799 total_loss: 1.0338  loss:1.3964,stance loss: 1.1534 
Train step: 1310 acc:0.72531 total_loss: 1.0326  loss:0.89457,stance loss: 0.90018 
Train step: 1320 acc:0.72871 total_loss: 1.0182  loss:0.9245,stance loss: 0.761 
Train step: 1330 acc:0.73453 total_loss: 1.0107  loss:0.78939,stance loss: 0.71181 
Train step: 1340 acc:0.73649 total_loss: 1.0082  loss:0.87511,stance loss: 0.71765 
Train step: 1350 acc:0.73347 total_loss: 1.0065  loss:0.5441,stance loss: 0.44268 
Train step: 1360 acc:0.73616 total_loss: 1.0017  loss:0.6979,stance loss: 0.23187 
Train step: 1370 acc:0.73449 total_loss: 1.0169  loss:1.0969,stance loss: 1.0445 
Train step: 1380 acc:0.7322 total_loss: 1.0229  loss:0.84388,stance loss: 0.70044 
Train step: 1390 acc:0.72826 total_loss: 1.0346  loss:0.87518,stance loss: 0.71923 
Train step: 1400 acc:0.72844 total_loss: 1.0336  loss:0.81034,stance loss: 0.74711 
Train step: 1410 acc:0.72721 total_loss: 1.0307  loss:0.60894,stance loss: 0.47358 
Train step: 1420 acc:0.73069 total_loss: 1.0222  loss:0.9544,stance loss: 0.75619 
Train step: 1430 acc:0.73197 total_loss: 1.0208  loss:1.6938,stance loss: 1.8253 
Train step: 1440 acc:0.73341 total_loss: 1.0154  loss:0.78881,stance loss: 0.68219 
Train step: 1450 acc:0.73501 total_loss: 1.0108  loss:0.63217,stance loss: 0.48909 
Train step: 1460 acc:0.7362 total_loss: 1.0087  loss:0.94074,stance loss: 0.69922 
Train step: 1470 acc:0.736 total_loss: 1.0135  loss:0.92622,stance loss: 0.79197 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.725 total_loss: 0.99999  loss:0.83785,stance loss: 0.68406 
Train step: 1490 acc:0.79583 total_loss: 0.94158  loss:1.1797,stance loss: 1.5858 
Train step: 1500 acc:0.77 total_loss: 0.95585  loss:1.0421,stance loss: 0.91843 
Train step: 1510 acc:0.76607 total_loss: 0.95694  loss:0.63961,stance loss: 0.49096 
Train step: 1520 acc:0.76389 total_loss: 0.96001  loss:0.75965,stance loss: 0.59713 
Train step: 1530 acc:0.76364 total_loss: 0.94557  loss:1.072,stance loss: 0.85072 
Train step: 1540 acc:0.75865 total_loss: 0.96122  loss:1.2791,stance loss: 0.88677 
Train step: 1550 acc:0.77083 total_loss: 0.93892  loss:0.82045,stance loss: 0.70549 
Train step: 1560 acc:0.76912 total_loss: 0.93825  loss:1.6229,stance loss: 1.1259 
Train step: 1570 acc:0.76711 total_loss: 0.93036  loss:0.67895,stance loss: 0.61425 
Train step: 1580 acc:0.77202 total_loss: 0.92722  loss:0.91378,stance loss: 0.77264 
Train step: 1590 acc:0.76902 total_loss: 0.93076  loss:1.7128,stance loss: 1.1987 
Train step: 1600 acc:0.7705 total_loss: 0.92266  loss:0.93491,stance loss: 0.69174 
Train step: 1610 acc:0.77222 total_loss: 0.91631  loss:1.1439,stance loss: 0.86099 
Train step: 1620 acc:0.77155 total_loss: 0.9213  loss:1.1788,stance loss: 1.4358 
Train step: 1630 acc:0.77097 total_loss: 0.92557  loss:0.7952,stance loss: 0.55032 
Train step: 1640 acc:0.76894 total_loss: 0.93031  loss:0.86085,stance loss: 0.6289 
Train step: 1650 acc:0.76964 total_loss: 0.93023  loss:1.1368,stance loss: 0.94604 
Train step: 1660 acc:0.77095 total_loss: 0.92269  loss:0.91041,stance loss: 0.63131 
Train step: 1670 acc:0.77115 total_loss: 0.92001  loss:0.81085,stance loss: 0.60282 
Train step: 1680 acc:0.77165 total_loss: 0.921  loss:0.70615,stance loss: 0.55386 
Train step: 1690 acc:0.77006 total_loss: 0.9236  loss:0.78736,stance loss: 0.56944 
Train step: 1700 acc:0.76889 total_loss: 0.91907  loss:0.73183,stance loss: 0.59072 
Train step: 1710 acc:0.76729 total_loss: 0.92045  loss:1.5468,stance loss: 1.1355 
Train step: 1720 acc:0.76658 total_loss: 0.92081  loss:0.61128,stance loss: 0.49045 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.83333 total_loss: 0.76244  loss:1.2375,stance loss: 0.97937 
Train step: 1740 acc:0.82895 total_loss: 0.81362  loss:0.72593,stance loss: 0.68859 
Train step: 1750 acc:0.81897 total_loss: 0.83937  loss:0.85816,stance loss: 0.77573 
Train step: 1760 acc:0.82372 total_loss: 0.81775  loss:0.56573,stance loss: 0.35404 
Train step: 1770 acc:0.81633 total_loss: 0.83309  loss:0.65371,stance loss: 0.53645 
Train step: 1780 acc:0.81886 total_loss: 0.81247  loss:0.94376,stance loss: 0.86317 
Train step: 1790 acc:0.81612 total_loss: 0.81787  loss:0.53596,stance loss: 0.37812 
Train step: 1800 acc:0.81883 total_loss: 0.81272  loss:1.152,stance loss: 0.96453 
Train step: 1810 acc:0.81742 total_loss: 0.80062  loss:0.82154,stance loss: 0.59979 
Train step: 1820 acc:0.81881 total_loss: 0.80916  loss:1.3542,stance loss: 1.512 
Train step: 1830 acc:0.81881 total_loss: 0.8142  loss:1.3681,stance loss: 2.0723 
Train step: 1840 acc:0.81775 total_loss: 0.81043  loss:0.54215,stance loss: 0.51444 
Train step: 1850 acc:0.82025 total_loss: 0.80734  loss:0.55902,stance loss: 0.44892 
Train step: 1860 acc:0.82014 total_loss: 0.8072  loss:0.68683,stance loss: 0.54085 
Train step: 1870 acc:0.81795 total_loss: 0.80773  loss:1.1647,stance loss: 1.0151 
Train step: 1880 acc:0.81682 total_loss: 0.81431  loss:1.1589,stance loss: 0.89841 
Train step: 1890 acc:0.81435 total_loss: 0.82313  loss:1.0187,stance loss: 0.85523 
Train step: 1900 acc:0.8118 total_loss: 0.82326  loss:0.79199,stance loss: 0.64362 
Train step: 1910 acc:0.81349 total_loss: 0.81459  loss:0.64439,stance loss: 0.50214 
Train step: 1920 acc:0.81187 total_loss: 0.82089  loss:0.44924,stance loss: 0.37563 
Train step: 1930 acc:0.8116 total_loss: 0.82191  loss:0.19271,stance loss: 0.1256 
Train step: 1940 acc:0.81221 total_loss: 0.82222  loss:0.99465,stance loss: 0.81334 
Train step: 1950 acc:0.81332 total_loss: 0.81624  loss:1.4037,stance loss: 1.2597 
Train step: 1960 acc:0.81328 total_loss: 0.81654  loss:0.50347,stance loss: 0.35673 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.85417 total_loss: 0.64232  loss:0.93631,stance loss: 0.68347 
Train step: 1980 acc:0.85096 total_loss: 0.64404  loss:0.60141,stance loss: 0.4653 
Train step: 1990 acc:0.83967 total_loss: 0.67514  loss:0.49745,stance loss: 0.45504 
Train step: 2000 acc:0.83333 total_loss: 0.70309  loss:0.47671,stance loss: 0.37265 
Train step: 2010 acc:0.82703 total_loss: 0.71988  loss:0.55841,stance loss: 0.43289 
Train step: 2020 acc:0.82901 total_loss: 0.73408  loss:1.1764,stance loss: 1.4484 
Train step: 2030 acc:0.83036 total_loss: 0.7401  loss:0.34847,stance loss: 0.17118 
Train step: 2040 acc:0.83305 total_loss: 0.74165  loss:0.85503,stance loss: 0.74179 
Train step: 2050 acc:0.82982 total_loss: 0.7547  loss:0.93032,stance loss: 0.76845 
Train step: 2060 acc:0.83199 total_loss: 0.7483  loss:0.78779,stance loss: 0.6522 
Train step: 2070 acc:0.83738 total_loss: 0.72411  loss:0.29724,stance loss: 0.21478 
Train step: 2080 acc:0.83905 total_loss: 0.71699  loss:0.61136,stance loss: 0.52107 
Train step: 2090 acc:0.83994 total_loss: 0.71611  loss:0.67632,stance loss: 0.51048 
Train step: 2100 acc:0.83976 total_loss: 0.71279  loss:0.65433,stance loss: 0.28998 
Train step: 2110 acc:0.84047 total_loss: 0.70792  loss:0.74331,stance loss: 0.62104 
Train step: 2120 acc:0.84069 total_loss: 0.70501  loss:0.83219,stance loss: 0.73302 
Train step: 2130 acc:0.84049 total_loss: 0.70775  loss:0.47351,stance loss: 0.35985 
Train step: 2140 acc:0.83815 total_loss: 0.70718  loss:0.66748,stance loss: 0.55773 
Train step: 2150 acc:0.83811 total_loss: 0.70355  loss:0.79394,stance loss: 0.66144 
Train step: 2160 acc:0.83614 total_loss: 0.71124  loss:1.3921,stance loss: 1.5717 
Train step: 2170 acc:0.83559 total_loss: 0.71025  loss:0.40836,stance loss: 0.34162 
Train step: 2180 acc:0.83509 total_loss: 0.71001  loss:0.91772,stance loss: 0.76956 
Train step: 2190 acc:0.8352 total_loss: 0.71094  loss:0.50418,stance loss: 0.39431 
Train step: 2200 acc:0.83637 total_loss: 0.7091  loss:0.6158,stance loss: 0.41016 
Train step: 2210 acc:0.83796 total_loss: 0.71018  loss:0.83712,stance loss: 0.71371 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.83929 total_loss: 0.77615  loss:0.4219,stance loss: 0.29536 
Train step: 2230 acc:0.83456 total_loss: 0.73513  loss:0.66308,stance loss: 0.54844 
Train step: 2240 acc:0.84954 total_loss: 0.70144  loss:0.95463,stance loss: 0.82467 
Train step: 2250 acc:0.86149 total_loss: 0.65832  loss:0.41867,stance loss: 0.26524 
Train step: 2260 acc:0.87101 total_loss: 0.61513  loss:0.14892,stance loss: 0.064018 
Train step: 2270 acc:0.86732 total_loss: 0.61692  loss:0.52567,stance loss: 0.35003 
Train step: 2280 acc:0.86754 total_loss: 0.60806  loss:0.5192,stance loss: 0.48463 
Train step: 2290 acc:0.86607 total_loss: 0.59879  loss:0.54601,stance loss: 0.32594 
Train step: 2300 acc:0.86782 total_loss: 0.59524  loss:0.11286,stance loss: 0.028699 
Train step: 2310 acc:0.86662 total_loss: 0.59231  loss:0.95691,stance loss: 0.71705 
Train step: 2320 acc:0.86273 total_loss: 0.60701  loss:0.8407,stance loss: 0.63409 
Train step: 2330 acc:0.86912 total_loss: 0.59307  loss:0.17688,stance loss: 0.10222 
Train step: 2340 acc:0.86909 total_loss: 0.60377  loss:0.49332,stance loss: 0.44719 
Train step: 2350 acc:0.86998 total_loss: 0.60477  loss:0.93737,stance loss: 0.68154 
Train step: 2360 acc:0.86905 total_loss: 0.60626  loss:0.9717,stance loss: 0.87069 
Train step: 2370 acc:0.86783 total_loss: 0.62464  loss:0.87082,stance loss: 0.7098 
Train step: 2380 acc:0.86864 total_loss: 0.61888  loss:0.27154,stance loss: 0.23846 
Train step: 2390 acc:0.86547 total_loss: 0.62904  loss:0.46981,stance loss: 0.3568 
Train step: 2400 acc:0.86832 total_loss: 0.6217  loss:0.39184,stance loss: 0.23442 
Train step: 2410 acc:0.86929 total_loss: 0.61571  loss:0.34457,stance loss: 0.32318 
Train step: 2420 acc:0.87138 total_loss: 0.60707  loss:0.71061,stance loss: 0.50794 
Train step: 2430 acc:0.87154 total_loss: 0.61171  loss:0.46456,stance loss: 0.4126 
Train step: 2440 acc:0.8717 total_loss: 0.61302  loss:0.64273,stance loss: 0.49112 
Train step: 2450 acc:0.87131 total_loss: 0.61612  loss:1.3577,stance loss: 1.1736 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.875 total_loss: 0.63765  loss:0.63765,stance loss: 0.2803 
Train step: 2470 acc:0.91477 total_loss: 0.44422  loss:0.41835,stance loss: 0.36496 
Train step: 2480 acc:0.90179 total_loss: 0.51948  loss:0.50466,stance loss: 0.39633 
Train step: 2490 acc:0.90524 total_loss: 0.53077  loss:0.13875,stance loss: 0.0715 
Train step: 2500 acc:0.90854 total_loss: 0.50932  loss:1.1858,stance loss: 1.2271 
Train step: 2510 acc:0.90686 total_loss: 0.52263  loss:0.95644,stance loss: 1.3064 
Train step: 2520 acc:0.90266 total_loss: 0.50072  loss:0.1487,stance loss: 0.088187 
Train step: 2530 acc:0.90229 total_loss: 0.48939  loss:0.33151,stance loss: 0.25672 
Train step: 2540 acc:0.89815 total_loss: 0.499  loss:0.39048,stance loss: 0.27929 
Train step: 2550 acc:0.89835 total_loss: 0.49518  loss:0.55687,stance loss: 1.0118 
Train step: 2560 acc:0.89913 total_loss: 0.48562  loss:1.2638,stance loss: 1.0292 
Train step: 2570 acc:0.90034 total_loss: 0.47685  loss:0.43982,stance loss: 0.24685 
Train step: 2580 acc:0.90083 total_loss: 0.47319  loss:0.33395,stance loss: 0.28309 
Train step: 2590 acc:0.90219 total_loss: 0.47235  loss:0.10725,stance loss: 0.04885 
Train step: 2600 acc:0.89894 total_loss: 0.47706  loss:0.45759,stance loss: 0.31093 
Train step: 2610 acc:0.89487 total_loss: 0.48467  loss:0.32889,stance loss: 0.21427 
Train step: 2620 acc:0.8948 total_loss: 0.48196  loss:0.39841,stance loss: 0.34343 
Train step: 2630 acc:0.89145 total_loss: 0.49428  loss:0.26169,stance loss: 0.19674 
Train step: 2640 acc:0.89227 total_loss: 0.49873  loss:0.28925,stance loss: 0.21981 
Train step: 2650 acc:0.893 total_loss: 0.49339  loss:0.10815,stance loss: 0.02469 
Train step: 2660 acc:0.89428 total_loss: 0.49376  loss:0.43864,stance loss: 0.44506 
Train step: 2670 acc:0.89485 total_loss: 0.4906  loss:0.11925,stance loss: 0.063765 
Train step: 2680 acc:0.89395 total_loss: 0.49303  loss:0.1176,stance loss: 0.05801 
Train step: 2690 acc:0.89502 total_loss: 0.48736  loss:0.36291,stance loss: 0.29447 
Train step: 2700 acc:0.89575 total_loss: 0.49115  loss:0.40288,stance loss: 0.30941 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9375 total_loss: 0.249  loss:0.061096,stance loss: 0.016076 
Train step: 2720 acc:0.9125 total_loss: 0.45195  loss:0.95878,stance loss: 0.92999 
Train step: 2730 acc:0.925 total_loss: 0.42454  loss:0.70884,stance loss: 0.59818 
Train step: 2740 acc:0.92679 total_loss: 0.42908  loss:1.0114,stance loss: 1.2492 
Train step: 2750 acc:0.93056 total_loss: 0.39413  loss:0.30461,stance loss: 0.28337 
Train step: 2760 acc:0.92273 total_loss: 0.41764  loss:0.55112,stance loss: 0.50102 
Train step: 2770 acc:0.92019 total_loss: 0.4275  loss:0.64165,stance loss: 0.50448 
Train step: 2780 acc:0.91917 total_loss: 0.44082  loss:0.15409,stance loss: 0.079839 
Train step: 2790 acc:0.92132 total_loss: 0.43533  loss:0.48275,stance loss: 0.33124 
Train step: 2800 acc:0.92039 total_loss: 0.44304  loss:0.47239,stance loss: 0.42239 
Train step: 2810 acc:0.92083 total_loss: 0.43675  loss:0.16069,stance loss: 0.065017 
Train step: 2820 acc:0.9212 total_loss: 0.42641  loss:0.56612,stance loss: 0.49465 
Train step: 2830 acc:0.919 total_loss: 0.42727  loss:0.40185,stance loss: 0.36001 
Train step: 2840 acc:0.91898 total_loss: 0.4304  loss:0.72457,stance loss: 1.1223 
Train step: 2850 acc:0.9194 total_loss: 0.42694  loss:0.36361,stance loss: 0.36002 
Train step: 2860 acc:0.91895 total_loss: 0.42428  loss:0.338,stance loss: 0.29482 
Train step: 2870 acc:0.92083 total_loss: 0.42315  loss:0.87921,stance loss: 0.78194 
Train step: 2880 acc:0.92179 total_loss: 0.42059  loss:0.1861,stance loss: 0.053456 
Train step: 2890 acc:0.92128 total_loss: 0.42573  loss:0.58448,stance loss: 0.51711 
Train step: 2900 acc:0.92115 total_loss: 0.42246  loss:0.32609,stance loss: 0.17175 
Train step: 2910 acc:0.92195 total_loss: 0.4241  loss:0.31244,stance loss: 0.28768 
Train step: 2920 acc:0.92297 total_loss: 0.42202  loss:0.25042,stance loss: 0.22784 
Train step: 2930 acc:0.92417 total_loss: 0.41298  loss:0.14974,stance loss: 0.088053 
Train step: 2940 acc:0.92527 total_loss: 0.41547  loss:0.76241,stance loss: 0.64437 
Train step: 2950 acc:0.92551 total_loss: 0.41785  loss:0.80616,stance loss: 0.80642 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.95139 total_loss: 0.35458  loss:0.17981,stance loss: 0.094867 
Train step: 2970 acc:0.96382 total_loss: 0.26056  loss:0.14324,stance loss: 0.10222 
Train step: 2980 acc:0.95259 total_loss: 0.28187  loss:0.063846,stance loss: 0.020832 
Train step: 2990 acc:0.94231 total_loss: 0.30002  loss:0.058669,stance loss: 0.0093547 
Train step: 3000 acc:0.95026 total_loss: 0.28354  loss:0.074229,stance loss: 0.033861 
Train step: 3010 acc:0.95233 total_loss: 0.27962  loss:0.2435,stance loss: 0.18339 
Train step: 3020 acc:0.95199 total_loss: 0.29429  loss:0.24947,stance loss: 0.22553 
Train step: 3030 acc:0.94778 total_loss: 0.31627  loss:0.81867,stance loss: 1.1393 
Train step: 3040 acc:0.94803 total_loss: 0.31179  loss:0.1573,stance loss: 0.12719 
Train step: 3050 acc:0.94823 total_loss: 0.31603  loss:0.4211,stance loss: 0.30263 
Train step: 3060 acc:0.94897 total_loss: 0.31284  loss:0.10451,stance loss: 0.078649 
Train step: 3070 acc:0.95011 total_loss: 0.31132  loss:0.10398,stance loss: 0.06166 
Train step: 3080 acc:0.95155 total_loss: 0.30235  loss:0.18158,stance loss: 0.12724 
Train step: 3090 acc:0.95144 total_loss: 0.30546  loss:0.079093,stance loss: 0.049743 
Train step: 3100 acc:0.95008 total_loss: 0.30156  loss:0.26149,stance loss: 0.22155 
Train step: 3110 acc:0.94851 total_loss: 0.31272  loss:0.26965,stance loss: 0.22324 
Train step: 3120 acc:0.94712 total_loss: 0.31749  loss:0.3199,stance loss: 0.22929 
Train step: 3130 acc:0.94483 total_loss: 0.32396  loss:0.50657,stance loss: 0.42377 
Train step: 3140 acc:0.94279 total_loss: 0.33152  loss:1.5745,stance loss: 1.3013 
Train step: 3150 acc:0.94315 total_loss: 0.33037  loss:0.18475,stance loss: 0.14517 
Train step: 3160 acc:0.94228 total_loss: 0.33054  loss:0.75326,stance loss: 0.64503 
Train step: 3170 acc:0.94292 total_loss: 0.3295  loss:0.99864,stance loss: 0.84956 
Train step: 3180 acc:0.94296 total_loss: 0.33288  loss:0.24308,stance loss: 0.23379 
Train step: 3190 acc:0.94299 total_loss: 0.33227  loss:0.45612,stance loss: 0.43346 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.91667 total_loss: 0.26841  loss:0.23056,stance loss: 0.12925 
Train step: 3210 acc:0.95192 total_loss: 0.22595  loss:0.039373,stance loss: 0.0078241 
Train step: 3220 acc:0.94837 total_loss: 0.26109  loss:0.070163,stance loss: 0.02039 
Train step: 3230 acc:0.94508 total_loss: 0.27243  loss:0.73134,stance loss: 0.61568 
Train step: 3240 acc:0.94477 total_loss: 0.27569  loss:0.37559,stance loss: 0.2423 
Train step: 3250 acc:0.94458 total_loss: 0.29053  loss:0.092151,stance loss: 0.057613 
Train step: 3260 acc:0.94841 total_loss: 0.27888  loss:0.20614,stance loss: 0.15294 
Train step: 3270 acc:0.94777 total_loss: 0.266  loss:0.35626,stance loss: 0.16578 
Train step: 3280 acc:0.95181 total_loss: 0.2571  loss:0.13043,stance loss: 0.11635 
Train step: 3290 acc:0.95296 total_loss: 0.25179  loss:0.20952,stance loss: 0.12026 
Train step: 3300 acc:0.95085 total_loss: 0.25712  loss:0.51178,stance loss: 0.5507 
Train step: 3310 acc:0.94801 total_loss: 0.27226  loss:0.44305,stance loss: 0.24227 
Train step: 3320 acc:0.94868 total_loss: 0.26583  loss:0.19997,stance loss: 0.14048 
Train step: 3330 acc:0.95066 total_loss: 0.25844  loss:0.27822,stance loss: 0.18515 
Train step: 3340 acc:0.94974 total_loss: 0.26607  loss:0.26294,stance loss: 0.25211 
Train step: 3350 acc:0.94935 total_loss: 0.27104  loss:0.10335,stance loss: 0.074112 
Train step: 3360 acc:0.94747 total_loss: 0.27886  loss:0.71099,stance loss: 0.56817 
Train step: 3370 acc:0.9487 total_loss: 0.27647  loss:0.060189,stance loss: 0.019695 
Train step: 3380 acc:0.9474 total_loss: 0.28289  loss:0.80114,stance loss: 0.67539 
Train step: 3390 acc:0.94819 total_loss: 0.27874  loss:0.032103,stance loss: 0.0069457 
Train step: 3400 acc:0.94951 total_loss: 0.27549  loss:0.066237,stance loss: 0.0346 
Train step: 3410 acc:0.94982 total_loss: 0.27527  loss:0.099702,stance loss: 0.046856 
Train step: 3420 acc:0.94983 total_loss: 0.28109  loss:0.03852,stance loss: 0.010174 
Train step: 3430 acc:0.94957 total_loss: 0.28388  loss:0.3915,stance loss: 0.34797 
Train step: 3440 acc:0.95036 total_loss: 0.27978  loss:0.039837,stance loss: 0.013678 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.96429 total_loss: 0.15456  loss:0.30658,stance loss: 0.22158 
Train step: 3460 acc:0.95588 total_loss: 0.18903  loss:0.15479,stance loss: 0.14591 
Train step: 3470 acc:0.94907 total_loss: 0.22989  loss:0.08895,stance loss: 0.064197 
Train step: 3480 acc:0.95608 total_loss: 0.20936  loss:0.051369,stance loss: 0.019655 
Train step: 3490 acc:0.95346 total_loss: 0.21568  loss:0.062446,stance loss: 0.033841 
Train step: 3500 acc:0.95614 total_loss: 0.21221  loss:0.8982,stance loss: 0.51618 
Train step: 3510 acc:0.95429 total_loss: 0.21697  loss:0.063816,stance loss: 0.019297 
Train step: 3520 acc:0.95373 total_loss: 0.22597  loss:0.022092,stance loss: 0.0014144 
Train step: 3530 acc:0.95618 total_loss: 0.22481  loss:0.11986,stance loss: 0.10812 
Train step: 3540 acc:0.95747 total_loss: 0.2305  loss:0.29293,stance loss: 0.25146 
Train step: 3550 acc:0.95619 total_loss: 0.24604  loss:0.30489,stance loss: 0.23197 
Train step: 3560 acc:0.95726 total_loss: 0.24353  loss:0.11185,stance loss: 0.071245 
Train step: 3570 acc:0.95866 total_loss: 0.24342  loss:0.53889,stance loss: 1.0145 
Train step: 3580 acc:0.95757 total_loss: 0.25412  loss:0.17763,stance loss: 0.14671 
Train step: 3590 acc:0.95706 total_loss: 0.25662  loss:0.47504,stance loss: 0.50447 
Train step: 3600 acc:0.95661 total_loss: 0.25481  loss:0.072488,stance loss: 0.057984 
Train step: 3610 acc:0.95771 total_loss: 0.24927  loss:0.034429,stance loss: 0.011074 
Train step: 3620 acc:0.95833 total_loss: 0.24684  loss:0.024688,stance loss: 0.0034321 
Train step: 3630 acc:0.95789 total_loss: 0.24879  loss:0.28387,stance loss: 0.17527 
Train step: 3640 acc:0.95812 total_loss: 0.24989  loss:0.57569,stance loss: 0.63182 
Train step: 3650 acc:0.95924 total_loss: 0.24627  loss:0.13674,stance loss: 0.026289 
Train step: 3660 acc:0.95737 total_loss: 0.25463  loss:0.22598,stance loss: 0.14431 
Train step: 3670 acc:0.95705 total_loss: 0.25557  loss:0.1605,stance loss: 0.061669 
Train step: 3680 acc:0.95728 total_loss: 0.25704  loss:0.39066,stance loss: 0.30976 
Training finished.


Reload the best model with best f1 0.36831415030467163 from path test_outputs/bert-cross-topic/la/2023-08-14 13-50-41/state_dict


              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.36831415030467163
acc: 0.5830653804930332, f1 :0.24554276686978108
classification report: 
              precision    recall  f1-score   support

         Con     0.5831    1.0000    0.7366       544
        None     0.0000    0.0000    0.0000       222
         Pro     0.0000    0.0000    0.0000       167

    accuracy                         0.5831       933
   macro avg     0.1944    0.3333    0.2455       933
weighted avg     0.3400    0.5831    0.4295       933

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 14-28-11', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 14-28-11
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 2.0627  loss:2.0627,stance loss: 1.7868 
Train step: 10 acc:0.31818 total_loss: 1.7577  loss:1.7214,stance loss: 1.178 
Better F1! Saving model!
Saving model of best f1: 0.14573459715639808
              precision    recall  f1-score   support

           0   0.410000  0.226103  0.291469       544
           1   0.120063  0.342342  0.177778       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.213290       933
   macro avg   0.176688  0.189482  0.156416       933
weighted avg   0.267625  0.213290  0.212246       933

Test Acc: 0.2132904608788853 F1_ma:0.14573459715639808
Train step: 20 acc:0.32143 total_loss: 1.7371  loss:1.8394,stance loss: 1.1851 
Better F1! Saving model!
Saving model of best f1: 0.28787878787878785
              precision    recall  f1-score   support

           0   0.531056  0.628676  0.575758       544
           1   0.048443  0.063063  0.054795       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.381565       933
   macro avg   0.193166  0.230580  0.210184       933
weighted avg   0.321167  0.381565  0.348742       933

Test Acc: 0.3815648445873526 F1_ma:0.28787878787878785
Train step: 30 acc:0.35081 total_loss: 1.7273  loss:1.5358,stance loss: 1.0428 
Better F1! Saving model!
Saving model of best f1: 0.36831415030467163
              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Train step: 40 acc:0.39482 total_loss: 1.6977  loss:1.8022,stance loss: 1.2178 
Train step: 50 acc:0.40196 total_loss: 1.6966  loss:1.7533,stance loss: 1.1771 
Train step: 60 acc:0.42008 total_loss: 1.6813  loss:1.8017,stance loss: 1.7284 
Train step: 70 acc:0.42694 total_loss: 1.6839  loss:1.8623,stance loss: 1.7418 
Train step: 80 acc:0.43441 total_loss: 1.6745  loss:1.6677,stance loss: 1.2081 
Train step: 90 acc:0.43613 total_loss: 1.6752  loss:1.7011,stance loss: 1.2077 
Train step: 100 acc:0.43874 total_loss: 1.6719  loss:1.8532,stance loss: 1.2142 
Train step: 110 acc:0.43975 total_loss: 1.6721  loss:1.6495,stance loss: 1.2122 
Train step: 120 acc:0.43957 total_loss: 1.6735  loss:1.6955,stance loss: 1.1576 
Train step: 130 acc:0.44323 total_loss: 1.6701  loss:1.7934,stance loss: 1.2716 
Train step: 140 acc:0.44637 total_loss: 1.664  loss:1.2523,stance loss: 0.76748 
Train step: 150 acc:0.45447 total_loss: 1.6546  loss:1.5326,stance loss: 1.1871 
Train step: 160 acc:0.45575 total_loss: 1.6527  loss:1.5188,stance loss: 1.1167 
Train step: 170 acc:0.46053 total_loss: 1.6495  loss:1.4471,stance loss: 1.0645 
Train step: 180 acc:0.46236 total_loss: 1.646  loss:1.6069,stance loss: 1.2166 
Train step: 190 acc:0.46499 total_loss: 1.6458  loss:1.5859,stance loss: 1.0112 
Train step: 200 acc:0.46828 total_loss: 1.6444  loss:1.6506,stance loss: 1.2183 
Train step: 210 acc:0.46979 total_loss: 1.6397  loss:1.549,stance loss: 1.1974 
Train step: 220 acc:0.47031 total_loss: 1.6409  loss:1.667,stance loss: 1.1482 
Train step: 230 acc:0.47321 total_loss: 1.6382  loss:1.6069,stance loss: 1.2135 
Train step: 240 acc:0.47536 total_loss: 1.6378  loss:1.5085,stance loss: 1.1036 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.475 total_loss: 1.5868  loss:1.6039,stance loss: 1.2156 
Train step: 260 acc:0.525 total_loss: 1.5581  loss:1.5123,stance loss: 1.1618 
Train step: 270 acc:0.53 total_loss: 1.5444  loss:1.6893,stance loss: 1.2935 
Train step: 280 acc:0.51786 total_loss: 1.5538  loss:1.6148,stance loss: 1.1603 
Train step: 290 acc:0.50833 total_loss: 1.5705  loss:1.5292,stance loss: 1.1082 
Train step: 300 acc:0.51705 total_loss: 1.5698  loss:1.6873,stance loss: 1.7417 
Train step: 310 acc:0.52212 total_loss: 1.5547  loss:1.6777,stance loss: 1.2498 
Train step: 320 acc:0.53167 total_loss: 1.5428  loss:1.5468,stance loss: 1.1032 
Train step: 330 acc:0.53235 total_loss: 1.537  loss:1.4753,stance loss: 1.1068 
Train step: 340 acc:0.53355 total_loss: 1.5318  loss:1.4853,stance loss: 1.2189 
Better F1! Saving model!
Saving model of best f1: 0.40888781920736605
              precision    recall  f1-score   support

           0   0.564039  0.841912  0.675516       544
           1   0.163265  0.036036  0.059041       222
           2   0.236111  0.101796  0.142259       167

    accuracy                       0.517685       933
   macro avg   0.321139  0.326581  0.292272       933
weighted avg   0.409982  0.517685  0.433382       933

Test Acc: 0.5176848874598071 F1_ma:0.40888781920736605
Train step: 350 acc:0.53929 total_loss: 1.5269  loss:1.504,stance loss: 1.0326 
Train step: 360 acc:0.54185 total_loss: 1.5297  loss:1.4154,stance loss: 1.1222 
Train step: 370 acc:0.544 total_loss: 1.5275  loss:1.3,stance loss: 0.91031 
Train step: 380 acc:0.54954 total_loss: 1.5244  loss:1.228,stance loss: 0.86267 
Train step: 390 acc:0.54957 total_loss: 1.5212  loss:1.3612,stance loss: 0.96421 
Train step: 400 acc:0.54879 total_loss: 1.5215  loss:1.6423,stance loss: 1.2668 
Train step: 410 acc:0.54583 total_loss: 1.5209  loss:1.5831,stance loss: 1.1664 
Better F1! Saving model!
Saving model of best f1: 0.4426264375674156
              precision    recall  f1-score   support

           0   0.551402  0.650735  0.596965       544
           1   0.285714  0.018018  0.033898       222
           2   0.231047  0.383234  0.288288       167

    accuracy                       0.452304       933
   macro avg   0.356054  0.350662  0.306384       933
weighted avg   0.430842  0.452304  0.407737       933

Test Acc: 0.45230439442658094 F1_ma:0.4426264375674156
Train step: 420 acc:0.54464 total_loss: 1.5199  loss:1.2784,stance loss: 0.952 
Train step: 430 acc:0.54932 total_loss: 1.5141  loss:1.4068,stance loss: 1.0642 
Train step: 440 acc:0.55 total_loss: 1.5133  loss:1.6972,stance loss: 1.5344 
Train step: 450 acc:0.55244 total_loss: 1.5095  loss:1.4799,stance loss: 1.105 
Train step: 460 acc:0.55203 total_loss: 1.5085  loss:1.3869,stance loss: 0.97083 
Train step: 470 acc:0.55417 total_loss: 1.5063  loss:1.6456,stance loss: 1.1632 
Train step: 480 acc:0.55691 total_loss: 1.5026  loss:1.3126,stance loss: 1.0264 
Train step: 490 acc:0.55765 total_loss: 1.4997  loss:1.4502,stance loss: 1.5518 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.63889 total_loss: 1.2961  loss:1.3852,stance loss: 0.89503 
Train step: 510 acc:0.60855 total_loss: 1.3837  loss:1.3454,stance loss: 1.0726 
Train step: 520 acc:0.6056 total_loss: 1.3962  loss:1.4215,stance loss: 1.113 
Train step: 530 acc:0.60417 total_loss: 1.3891  loss:1.3776,stance loss: 1.1214 
Train step: 540 acc:0.60969 total_loss: 1.3871  loss:1.5944,stance loss: 1.1492 
Train step: 550 acc:0.61547 total_loss: 1.381  loss:1.3622,stance loss: 1.0527 
Train step: 560 acc:0.61322 total_loss: 1.38  loss:1.1079,stance loss: 0.77182 
Train step: 570 acc:0.61155 total_loss: 1.3805  loss:1.4546,stance loss: 1.1454 
Train step: 580 acc:0.60393 total_loss: 1.3856  loss:1.5237,stance loss: 1.1649 
Train step: 590 acc:0.60985 total_loss: 1.3732  loss:1.2639,stance loss: 0.98633 
Train step: 600 acc:0.60837 total_loss: 1.3733  loss:1.6239,stance loss: 1.2981 
Train step: 610 acc:0.60347 total_loss: 1.3859  loss:1.2181,stance loss: 0.93837 
Train step: 620 acc:0.60804 total_loss: 1.3776  loss:1.0824,stance loss: 0.90831 
Train step: 630 acc:0.61241 total_loss: 1.3751  loss:1.4191,stance loss: 1.0807 
Train step: 640 acc:0.61284 total_loss: 1.3759  loss:1.0477,stance loss: 0.80834 
Train step: 650 acc:0.61046 total_loss: 1.3768  loss:1.2345,stance loss: 0.89983 
Train step: 660 acc:0.6128 total_loss: 1.3721  loss:1.5191,stance loss: 1.6796 
Train step: 670 acc:0.61383 total_loss: 1.3709  loss:1.046,stance loss: 0.79349 
Train step: 680 acc:0.61706 total_loss: 1.3693  loss:1.342,stance loss: 1.1066 
Train step: 690 acc:0.61495 total_loss: 1.3673  loss:1.5934,stance loss: 1.2354 
Train step: 700 acc:0.61364 total_loss: 1.3686  loss:1.476,stance loss: 1.1837 
Train step: 710 acc:0.61473 total_loss: 1.3666  loss:1.2884,stance loss: 0.99591 
Train step: 720 acc:0.61572 total_loss: 1.3639  loss:1.3292,stance loss: 1.0657 
Train step: 730 acc:0.61794 total_loss: 1.3582  loss:1.4361,stance loss: 1.0313 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.64583 total_loss: 1.3002  loss:1.3348,stance loss: 1.1021 
Train step: 750 acc:0.66346 total_loss: 1.2632  loss:1.1242,stance loss: 0.79628 
Train step: 760 acc:0.66848 total_loss: 1.2736  loss:1.2411,stance loss: 0.97843 
Train step: 770 acc:0.66477 total_loss: 1.2422  loss:1.4481,stance loss: 0.93141 
Train step: 780 acc:0.65843 total_loss: 1.2381  loss:1.2588,stance loss: 1.0352 
Train step: 790 acc:0.6592 total_loss: 1.2473  loss:1.1745,stance loss: 0.89984 
Train step: 800 acc:0.66369 total_loss: 1.2358  loss:1.318,stance loss: 1.0769 
Train step: 810 acc:0.65839 total_loss: 1.2388  loss:1.3014,stance loss: 1.1577 
Train step: 820 acc:0.66566 total_loss: 1.2282  loss:1.114,stance loss: 0.90292 
Train step: 830 acc:0.67003 total_loss: 1.2239  loss:1.2255,stance loss: 1.0545 
Train step: 840 acc:0.67172 total_loss: 1.2246  loss:1.248,stance loss: 0.8777 
Train step: 850 acc:0.66925 total_loss: 1.2289  loss:1.2242,stance loss: 1.0053 
Train step: 860 acc:0.66819 total_loss: 1.2244  loss:1.3755,stance loss: 1.0653 
Train step: 870 acc:0.66588 total_loss: 1.2275  loss:1.2431,stance loss: 0.84972 
Train step: 880 acc:0.66084 total_loss: 1.2295  loss:1.0682,stance loss: 0.80198 
Train step: 890 acc:0.66422 total_loss: 1.226  loss:0.98364,stance loss: 0.79918 
Train step: 900 acc:0.66564 total_loss: 1.2255  loss:1.2994,stance loss: 0.88833 
Train step: 910 acc:0.6651 total_loss: 1.2299  loss:1.2832,stance loss: 0.94717 
Train step: 920 acc:0.66598 total_loss: 1.2293  loss:1.6144,stance loss: 1.3565 
Train step: 930 acc:0.67066 total_loss: 1.2181  loss:0.85493,stance loss: 0.6833 
Train step: 940 acc:0.67149 total_loss: 1.2147  loss:1.1284,stance loss: 0.93454 
Train step: 950 acc:0.67224 total_loss: 1.2112  loss:1.3204,stance loss: 1.1086 
Train step: 960 acc:0.67068 total_loss: 1.2142  loss:1.5768,stance loss: 1.1107 
Train step: 970 acc:0.67141 total_loss: 1.214  loss:1.4654,stance loss: 1.222 
Train step: 980 acc:0.67181 total_loss: 1.2083  loss:1.3938,stance loss: 1.0407 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.67857 total_loss: 1.153  loss:0.83525,stance loss: 0.64144 
Train step: 1000 acc:0.68382 total_loss: 1.094  loss:0.79486,stance loss: 0.6113 
Train step: 1010 acc:0.66667 total_loss: 1.1487  loss:1.2227,stance loss: 0.93314 
Train step: 1020 acc:0.68074 total_loss: 1.1572  loss:1.1871,stance loss: 0.98627 
Train step: 1030 acc:0.69016 total_loss: 1.1327  loss:0.87446,stance loss: 0.71093 
Train step: 1040 acc:0.69408 total_loss: 1.1182  loss:1.0893,stance loss: 0.95031 
Train step: 1050 acc:0.6847 total_loss: 1.1305  loss:1.2005,stance loss: 0.96868 
Train step: 1060 acc:0.69156 total_loss: 1.1217  loss:0.78954,stance loss: 0.63415 
Train step: 1070 acc:0.69971 total_loss: 1.1055  loss:0.94009,stance loss: 0.68363 
Train step: 1080 acc:0.70361 total_loss: 1.0877  loss:0.80331,stance loss: 0.66171 
Train step: 1090 acc:0.71262 total_loss: 1.0671  loss:0.44537,stance loss: 0.1932 
Train step: 1100 acc:0.71368 total_loss: 1.0712  loss:0.55015,stance loss: 0.28154 
Train step: 1110 acc:0.71014 total_loss: 1.0741  loss:1.479,stance loss: 1.5968 
Train step: 1120 acc:0.70985 total_loss: 1.0757  loss:0.87494,stance loss: 0.52247 
Train step: 1130 acc:0.71131 total_loss: 1.0755  loss:0.86981,stance loss: 0.72353 
Train step: 1140 acc:0.71099 total_loss: 1.0837  loss:1.2489,stance loss: 0.93605 
Train step: 1150 acc:0.71108 total_loss: 1.0819  loss:1.2322,stance loss: 0.89642 
Train step: 1160 acc:0.71363 total_loss: 1.0756  loss:1.169,stance loss: 0.91034 
Train step: 1170 acc:0.71791 total_loss: 1.0721  loss:0.61738,stance loss: 0.48316 
Train step: 1180 acc:0.71732 total_loss: 1.0744  loss:1.661,stance loss: 1.3334 
Train step: 1190 acc:0.7183 total_loss: 1.0733  loss:0.94363,stance loss: 0.60941 
Train step: 1200 acc:0.7163 total_loss: 1.0814  loss:1.3094,stance loss: 1.1035 
Train step: 1210 acc:0.71503 total_loss: 1.0838  loss:1.1927,stance loss: 0.96518 
Train step: 1220 acc:0.71414 total_loss: 1.0819  loss:1.2153,stance loss: 1.3443 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 0.77198  loss:0.77198,stance loss: 0.60528 
Train step: 1240 acc:0.69886 total_loss: 1.1211  loss:1.0291,stance loss: 0.94732 
Train step: 1250 acc:0.71726 total_loss: 1.0357  loss:0.97883,stance loss: 0.76955 
Train step: 1260 acc:0.72782 total_loss: 1.0483  loss:1.0343,stance loss: 0.4222 
Train step: 1270 acc:0.74543 total_loss: 1.0187  loss:0.90299,stance loss: 0.73135 
Train step: 1280 acc:0.74755 total_loss: 1.0191  loss:0.83038,stance loss: 0.58907 
Train step: 1290 acc:0.74488 total_loss: 1.0237  loss:1.1573,stance loss: 0.73468 
Train step: 1300 acc:0.75176 total_loss: 1.0198  loss:0.70254,stance loss: 0.60629 
Train step: 1310 acc:0.75154 total_loss: 1.0094  loss:1.2132,stance loss: 1.5102 
Train step: 1320 acc:0.74038 total_loss: 1.0224  loss:1.0632,stance loss: 0.86628 
Train step: 1330 acc:0.73886 total_loss: 1.0161  loss:0.98689,stance loss: 0.80777 
Train step: 1340 acc:0.7393 total_loss: 1.016  loss:0.91697,stance loss: 0.82425 
Train step: 1350 acc:0.73605 total_loss: 1.0232  loss:1.5326,stance loss: 1.0637 
Train step: 1360 acc:0.73473 total_loss: 1.0214  loss:1.0853,stance loss: 0.94484 
Train step: 1370 acc:0.73537 total_loss: 1.0167  loss:1.0717,stance loss: 0.74214 
Train step: 1380 acc:0.73551 total_loss: 1.0103  loss:1.0875,stance loss: 0.72241 
Train step: 1390 acc:0.73913 total_loss: 1.007  loss:1.0463,stance loss: 1.4042 
Train step: 1400 acc:0.74561 total_loss: 0.99525  loss:0.47723,stance loss: 0.27755 
Train step: 1410 acc:0.74793 total_loss: 0.98916  loss:0.96134,stance loss: 0.76723 
Train step: 1420 acc:0.74771 total_loss: 0.98654  loss:0.76696,stance loss: 0.69544 
Train step: 1430 acc:0.75 total_loss: 0.9787  loss:0.54263,stance loss: 0.37342 
Train step: 1440 acc:0.75178 total_loss: 0.97691  loss:0.79962,stance loss: 0.69709 
Train step: 1450 acc:0.75255 total_loss: 0.97762  loss:0.96461,stance loss: 0.80353 
Train step: 1460 acc:0.75298 total_loss: 0.9802  loss:0.83242,stance loss: 0.6358 
Train step: 1470 acc:0.75389 total_loss: 0.97623  loss:0.59891,stance loss: 0.4177 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.7375 total_loss: 1.089  loss:1.0705,stance loss: 0.95413 
Train step: 1490 acc:0.76667 total_loss: 0.96985  loss:0.5409,stance loss: 0.39182 
Train step: 1500 acc:0.7925 total_loss: 0.87898  loss:0.63303,stance loss: 0.50126 
Train step: 1510 acc:0.79107 total_loss: 0.89122  loss:0.58234,stance loss: 0.4521 
Train step: 1520 acc:0.78472 total_loss: 0.88989  loss:1.1884,stance loss: 0.90144 
Train step: 1530 acc:0.78523 total_loss: 0.87249  loss:0.65994,stance loss: 0.54237 
Train step: 1540 acc:0.78942 total_loss: 0.87071  loss:0.9532,stance loss: 0.65748 
Train step: 1550 acc:0.79333 total_loss: 0.8905  loss:0.98101,stance loss: 0.67531 
Train step: 1560 acc:0.79485 total_loss: 0.87644  loss:1.3826,stance loss: 1.0083 
Train step: 1570 acc:0.79079 total_loss: 0.89391  loss:0.89753,stance loss: 0.71948 
Train step: 1580 acc:0.78631 total_loss: 0.89891  loss:0.94737,stance loss: 0.67575 
Train step: 1590 acc:0.7875 total_loss: 0.89927  loss:0.8784,stance loss: 0.89691 
Train step: 1600 acc:0.7835 total_loss: 0.89974  loss:0.99877,stance loss: 0.79079 
Train step: 1610 acc:0.7838 total_loss: 0.90838  loss:1.2722,stance loss: 2.0264 
Train step: 1620 acc:0.78707 total_loss: 0.89966  loss:1.0065,stance loss: 0.81589 
Train step: 1630 acc:0.78548 total_loss: 0.8942  loss:1.0137,stance loss: 0.69898 
Train step: 1640 acc:0.7875 total_loss: 0.88737  loss:0.50664,stance loss: 0.46286 
Train step: 1650 acc:0.78607 total_loss: 0.88491  loss:1.0081,stance loss: 0.91027 
Train step: 1660 acc:0.78682 total_loss: 0.8809  loss:0.6722,stance loss: 0.55151 
Train step: 1670 acc:0.78782 total_loss: 0.87878  loss:1.0484,stance loss: 0.8513 
Train step: 1680 acc:0.78994 total_loss: 0.87391  loss:0.99163,stance loss: 0.85725 
Train step: 1690 acc:0.79041 total_loss: 0.8784  loss:1.6113,stance loss: 1.7165 
Train step: 1700 acc:0.78778 total_loss: 0.8845  loss:0.84922,stance loss: 0.64235 
Train step: 1710 acc:0.78883 total_loss: 0.88513  loss:0.97277,stance loss: 1.3829 
Train step: 1720 acc:0.78776 total_loss: 0.88792  loss:1.1518,stance loss: 0.85989 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.84028 total_loss: 0.68739  loss:0.31558,stance loss: 0.22683 
Train step: 1740 acc:0.86513 total_loss: 0.6321  loss:0.42605,stance loss: 0.38991 
Train step: 1750 acc:0.8556 total_loss: 0.6672  loss:0.71863,stance loss: 0.67188 
Train step: 1760 acc:0.85897 total_loss: 0.66489  loss:0.65616,stance loss: 0.48615 
Train step: 1770 acc:0.85204 total_loss: 0.68316  loss:0.74445,stance loss: 0.57199 
Train step: 1780 acc:0.85169 total_loss: 0.6992  loss:0.44382,stance loss: 0.32447 
Train step: 1790 acc:0.84692 total_loss: 0.71762  loss:0.76698,stance loss: 0.50246 
Train step: 1800 acc:0.84494 total_loss: 0.72336  loss:1.4505,stance loss: 1.7987 
Train step: 1810 acc:0.84691 total_loss: 0.72929  loss:0.66454,stance loss: 1.0668 
Train step: 1820 acc:0.84091 total_loss: 0.7432  loss:1.2803,stance loss: 1.0561 
Train step: 1830 acc:0.83601 total_loss: 0.74925  loss:0.87104,stance loss: 0.78295 
Train step: 1840 acc:0.83351 total_loss: 0.74742  loss:0.73546,stance loss: 0.51241 
Train step: 1850 acc:0.8314 total_loss: 0.75462  loss:0.78985,stance loss: 0.57559 
Train step: 1860 acc:0.82554 total_loss: 0.77085  loss:0.78241,stance loss: 0.54751 
Train step: 1870 acc:0.82257 total_loss: 0.77714  loss:0.77367,stance loss: 0.70258 
Train step: 1880 acc:0.82429 total_loss: 0.77252  loss:0.77237,stance loss: 0.5333 
Train step: 1890 acc:0.8284 total_loss: 0.75624  loss:0.48797,stance loss: 0.44584 
Train step: 1900 acc:0.82577 total_loss: 0.76135  loss:0.81432,stance loss: 0.7301 
Train step: 1910 acc:0.82771 total_loss: 0.75417  loss:0.77716,stance loss: 0.65176 
Train step: 1920 acc:0.82758 total_loss: 0.75583  loss:0.57878,stance loss: 0.31475 
Train step: 1930 acc:0.82775 total_loss: 0.75609  loss:0.75299,stance loss: 1.1362 
Train step: 1940 acc:0.82677 total_loss: 0.75801  loss:0.54657,stance loss: 0.51921 
Train step: 1950 acc:0.82751 total_loss: 0.75347  loss:0.80651,stance loss: 0.52935 
Train step: 1960 acc:0.82531 total_loss: 0.75508  loss:0.96288,stance loss: 0.69349 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.83333 total_loss: 0.55963  loss:0.2978,stance loss: 0.14654 
Train step: 1980 acc:0.87981 total_loss: 0.49623  loss:0.4074,stance loss: 0.31626 
Train step: 1990 acc:0.88043 total_loss: 0.54414  loss:0.28699,stance loss: 0.16797 
Train step: 2000 acc:0.86364 total_loss: 0.61451  loss:1.1439,stance loss: 1.018 
Train step: 2010 acc:0.86337 total_loss: 0.63567  loss:1.3441,stance loss: 1.2821 
Train step: 2020 acc:0.8691 total_loss: 0.61314  loss:0.7094,stance loss: 0.8122 
Train step: 2030 acc:0.86409 total_loss: 0.62686  loss:0.16394,stance loss: 0.063874 
Train step: 2040 acc:0.8613 total_loss: 0.64279  loss:0.43712,stance loss: 0.28008 
Train step: 2050 acc:0.85994 total_loss: 0.64413  loss:0.66829,stance loss: 0.52197 
Train step: 2060 acc:0.86425 total_loss: 0.62944  loss:0.22935,stance loss: 0.14302 
Train step: 2070 acc:0.86347 total_loss: 0.63735  loss:0.87628,stance loss: 0.75722 
Train step: 2080 acc:0.86394 total_loss: 0.63361  loss:0.52681,stance loss: 0.18809 
Train step: 2090 acc:0.86382 total_loss: 0.63141  loss:0.91382,stance loss: 0.72012 
Train step: 2100 acc:0.86795 total_loss: 0.62003  loss:0.43871,stance loss: 0.155 
Train step: 2110 acc:0.86626 total_loss: 0.6292  loss:1.0458,stance loss: 0.73604 
Train step: 2120 acc:0.86275 total_loss: 0.63566  loss:0.77858,stance loss: 0.58064 
Train step: 2130 acc:0.86196 total_loss: 0.63911  loss:0.58783,stance loss: 0.42345 
Train step: 2140 acc:0.85838 total_loss: 0.64961  loss:0.95467,stance loss: 0.86296 
Train step: 2150 acc:0.85792 total_loss: 0.65073  loss:0.51812,stance loss: 0.43605 
Train step: 2160 acc:0.85589 total_loss: 0.65887  loss:0.93114,stance loss: 0.80199 
Train step: 2170 acc:0.85591 total_loss: 0.65404  loss:0.58742,stance loss: 0.44889 
Train step: 2180 acc:0.85739 total_loss: 0.64891  loss:0.26236,stance loss: 0.15024 
Train step: 2190 acc:0.85846 total_loss: 0.64497  loss:0.309,stance loss: 0.24299 
Train step: 2200 acc:0.85891 total_loss: 0.64259  loss:0.90647,stance loss: 1.2938 
Train step: 2210 acc:0.85957 total_loss: 0.64148  loss:0.91306,stance loss: 0.84454 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.875 total_loss: 0.60124  loss:0.84874,stance loss: 0.66542 
Train step: 2230 acc:0.88603 total_loss: 0.63967  loss:0.51714,stance loss: 0.39964 
Train step: 2240 acc:0.89352 total_loss: 0.57704  loss:0.51439,stance loss: 0.4313 
Train step: 2250 acc:0.88851 total_loss: 0.56801  loss:0.30904,stance loss: 0.29407 
Train step: 2260 acc:0.8883 total_loss: 0.54614  loss:0.3837,stance loss: 0.32863 
Train step: 2270 acc:0.89254 total_loss: 0.53854  loss:0.36231,stance loss: 0.1353 
Train step: 2280 acc:0.89646 total_loss: 0.52414  loss:0.65434,stance loss: 0.59615 
Train step: 2290 acc:0.89205 total_loss: 0.53864  loss:0.25537,stance loss: 0.16982 
Train step: 2300 acc:0.8944 total_loss: 0.54026  loss:0.60806,stance loss: 0.57763 
Train step: 2310 acc:0.89175 total_loss: 0.54908  loss:0.59473,stance loss: 0.51728 
Train step: 2320 acc:0.89252 total_loss: 0.54345  loss:0.46945,stance loss: 0.28995 
Train step: 2330 acc:0.89476 total_loss: 0.53969  loss:0.28626,stance loss: 0.21696 
Train step: 2340 acc:0.89665 total_loss: 0.53418  loss:0.42671,stance loss: 0.5534 
Train step: 2350 acc:0.8937 total_loss: 0.53764  loss:0.69368,stance loss: 0.71487 
Train step: 2360 acc:0.89243 total_loss: 0.53823  loss:0.5368,stance loss: 0.47098 
Train step: 2370 acc:0.8949 total_loss: 0.5306  loss:0.48942,stance loss: 0.41019 
Train step: 2380 acc:0.89147 total_loss: 0.54067  loss:0.7178,stance loss: 0.53132 
Train step: 2390 acc:0.8923 total_loss: 0.53561  loss:0.47166,stance loss: 0.3912 
Train step: 2400 acc:0.89405 total_loss: 0.53216  loss:0.50863,stance loss: 0.40562 
Train step: 2410 acc:0.89372 total_loss: 0.53407  loss:0.55769,stance loss: 0.39686 
Train step: 2420 acc:0.89432 total_loss: 0.53561  loss:0.52003,stance loss: 0.43091 
Train step: 2430 acc:0.89315 total_loss: 0.54103  loss:0.63463,stance loss: 0.54886 
Train step: 2440 acc:0.89235 total_loss: 0.54433  loss:0.92343,stance loss: 0.79961 
Train step: 2450 acc:0.89161 total_loss: 0.54212  loss:0.66198,stance loss: 0.57957 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.32055  loss:0.32055,stance loss: 0.23862 
Train step: 2470 acc:0.92045 total_loss: 0.41659  loss:0.60164,stance loss: 1.0204 
Train step: 2480 acc:0.91369 total_loss: 0.44114  loss:0.37702,stance loss: 0.24343 
Train step: 2490 acc:0.92339 total_loss: 0.40141  loss:0.70841,stance loss: 1.114 
Train step: 2500 acc:0.92226 total_loss: 0.43295  loss:0.17592,stance loss: 0.075659 
Train step: 2510 acc:0.92279 total_loss: 0.41754  loss:0.6411,stance loss: 0.55282 
Train step: 2520 acc:0.92828 total_loss: 0.38818  loss:0.12316,stance loss: 0.024707 
Train step: 2530 acc:0.92342 total_loss: 0.4178  loss:0.6076,stance loss: 0.49897 
Train step: 2540 acc:0.92901 total_loss: 0.40165  loss:0.45087,stance loss: 0.64421 
Train step: 2550 acc:0.9272 total_loss: 0.40957  loss:0.21764,stance loss: 0.17734 
Train step: 2560 acc:0.92698 total_loss: 0.41265  loss:0.35604,stance loss: 0.29147 
Train step: 2570 acc:0.92624 total_loss: 0.40838  loss:0.30377,stance loss: 0.24442 
Train step: 2580 acc:0.9251 total_loss: 0.40384  loss:0.42097,stance loss: 0.28401 
Train step: 2590 acc:0.91937 total_loss: 0.4223  loss:0.94365,stance loss: 0.78608 
Train step: 2600 acc:0.91977 total_loss: 0.42319  loss:0.8861,stance loss: 0.84866 
Train step: 2610 acc:0.92094 total_loss: 0.41471  loss:0.29137,stance loss: 0.21656 
Train step: 2620 acc:0.92003 total_loss: 0.42424  loss:0.38882,stance loss: 0.32102 
Train step: 2630 acc:0.92105 total_loss: 0.42475  loss:0.53497,stance loss: 0.41592 
Train step: 2640 acc:0.91816 total_loss: 0.43755  loss:0.37939,stance loss: 0.2425 
Train step: 2650 acc:0.91754 total_loss: 0.43981  loss:0.2697,stance loss: 0.22498 
Train step: 2660 acc:0.9176 total_loss: 0.43642  loss:0.15014,stance loss: 0.12725 
Train step: 2670 acc:0.91765 total_loss: 0.43642  loss:0.45433,stance loss: 0.41595 
Train step: 2680 acc:0.91572 total_loss: 0.44188  loss:0.43446,stance loss: 0.31285 
Train step: 2690 acc:0.91667 total_loss: 0.43959  loss:0.42494,stance loss: 0.37819 
Train step: 2700 acc:0.91805 total_loss: 0.43466  loss:0.080819,stance loss: 0.022262 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9 total_loss: 0.31595  loss:0.40876,stance loss: 0.24347 
Train step: 2720 acc:0.94167 total_loss: 0.2784  loss:0.40665,stance loss: 0.38671 
Train step: 2730 acc:0.95 total_loss: 0.28345  loss:0.45263,stance loss: 0.37215 
Train step: 2740 acc:0.94643 total_loss: 0.30155  loss:0.13072,stance loss: 0.064596 
Train step: 2750 acc:0.93889 total_loss: 0.31055  loss:0.59639,stance loss: 0.63045 
Train step: 2760 acc:0.9375 total_loss: 0.33325  loss:0.34417,stance loss: 0.22012 
Train step: 2770 acc:0.94038 total_loss: 0.31745  loss:0.22448,stance loss: 0.10391 
Train step: 2780 acc:0.94167 total_loss: 0.31001  loss:0.23865,stance loss: 0.20256 
Train step: 2790 acc:0.93603 total_loss: 0.32497  loss:0.45885,stance loss: 0.37439 
Train step: 2800 acc:0.9375 total_loss: 0.33147  loss:0.62756,stance loss: 0.6491 
Train step: 2810 acc:0.94048 total_loss: 0.33463  loss:0.09061,stance loss: 0.038099 
Train step: 2820 acc:0.94239 total_loss: 0.32413  loss:0.11284,stance loss: 0.062158 
Train step: 2830 acc:0.9445 total_loss: 0.31623  loss:0.15427,stance loss: 0.13601 
Train step: 2840 acc:0.94583 total_loss: 0.30663  loss:0.45672,stance loss: 0.40825 
Train step: 2850 acc:0.94483 total_loss: 0.31016  loss:0.56885,stance loss: 0.51855 
Train step: 2860 acc:0.94556 total_loss: 0.31298  loss:0.33358,stance loss: 0.33988 
Train step: 2870 acc:0.9447 total_loss: 0.31465  loss:0.063802,stance loss: 0.018733 
Train step: 2880 acc:0.945 total_loss: 0.31637  loss:0.4607,stance loss: 0.3366 
Train step: 2890 acc:0.94426 total_loss: 0.32003  loss:0.60369,stance loss: 0.33811 
Train step: 2900 acc:0.94359 total_loss: 0.31718  loss:0.27098,stance loss: 0.13623 
Train step: 2910 acc:0.94421 total_loss: 0.31464  loss:0.1457,stance loss: 0.069267 
Train step: 2920 acc:0.94506 total_loss: 0.31312  loss:0.14951,stance loss: 0.10381 
Train step: 2930 acc:0.94361 total_loss: 0.31445  loss:0.50415,stance loss: 0.56222 
Train step: 2940 acc:0.94415 total_loss: 0.31179  loss:0.067089,stance loss: 0.0044556 
Train step: 2950 acc:0.94388 total_loss: 0.31444  loss:0.14892,stance loss: 0.14069 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.94444 total_loss: 0.3254  loss:0.52321,stance loss: 0.41906 
Train step: 2970 acc:0.96053 total_loss: 0.23427  loss:0.25599,stance loss: 0.26072 
Train step: 2980 acc:0.95474 total_loss: 0.24025  loss:0.3225,stance loss: 0.21504 
Train step: 2990 acc:0.95673 total_loss: 0.22071  loss:0.23298,stance loss: 0.22229 
Train step: 3000 acc:0.95026 total_loss: 0.23064  loss:0.19739,stance loss: 0.10074 
Train step: 3010 acc:0.95233 total_loss: 0.24138  loss:0.023011,stance loss: 0.0012655 
Train step: 3020 acc:0.95018 total_loss: 0.24696  loss:0.49839,stance loss: 0.51096 
Train step: 3030 acc:0.95491 total_loss: 0.23323  loss:0.050205,stance loss: 0.023321 
Train step: 3040 acc:0.95927 total_loss: 0.21735  loss:0.042676,stance loss: 0.0057636 
Train step: 3050 acc:0.95833 total_loss: 0.21623  loss:0.24317,stance loss: 0.18129 
Train step: 3060 acc:0.96044 total_loss: 0.21602  loss:0.099405,stance loss: 0.073305 
Train step: 3070 acc:0.95956 total_loss: 0.21639  loss:0.11436,stance loss: 0.07365 
Train step: 3080 acc:0.96027 total_loss: 0.21696  loss:0.099581,stance loss: 0.062289 
Train step: 3090 acc:0.96088 total_loss: 0.21273  loss:0.18464,stance loss: 0.11345 
Train step: 3100 acc:0.96057 total_loss: 0.21009  loss:0.084429,stance loss: 0.036302 
Train step: 3110 acc:0.95991 total_loss: 0.21731  loss:0.69529,stance loss: 1.146 
Train step: 3120 acc:0.95747 total_loss: 0.23408  loss:0.30773,stance loss: 0.30718 
Train step: 3130 acc:0.9574 total_loss: 0.23607  loss:0.15138,stance loss: 0.12132 
Train step: 3140 acc:0.95767 total_loss: 0.237  loss:0.043073,stance loss: 0.0062461 
Train step: 3150 acc:0.95823 total_loss: 0.23839  loss:0.10051,stance loss: 0.052407 
Train step: 3160 acc:0.95873 total_loss: 0.23377  loss:0.085362,stance loss: 0.012058 
Train step: 3170 acc:0.95776 total_loss: 0.23471  loss:0.052972,stance loss: 0.024126 
Train step: 3180 acc:0.95742 total_loss: 0.24182  loss:0.57065,stance loss: 0.49014 
Train step: 3190 acc:0.95737 total_loss: 0.23984  loss:0.052803,stance loss: 0.029148 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.91667 total_loss: 0.38982  loss:0.5305,stance loss: 0.38982 
Train step: 3210 acc:0.95673 total_loss: 0.2608  loss:0.25777,stance loss: 0.10474 
Train step: 3220 acc:0.95924 total_loss: 0.27202  loss:0.20199,stance loss: 0.17599 
Train step: 3230 acc:0.96402 total_loss: 0.25308  loss:0.030744,stance loss: 0.0081509 
Train step: 3240 acc:0.96366 total_loss: 0.23844  loss:0.21415,stance loss: 0.15966 
Train step: 3250 acc:0.96344 total_loss: 0.2515  loss:0.9754,stance loss: 1.7205 
Train step: 3260 acc:0.96627 total_loss: 0.23046  loss:0.043029,stance loss: 0.030287 
Train step: 3270 acc:0.96918 total_loss: 0.21006  loss:0.080779,stance loss: 0.065127 
Train step: 3280 acc:0.97063 total_loss: 0.19921  loss:0.14244,stance loss: 0.06682 
Train step: 3290 acc:0.96707 total_loss: 0.20214  loss:0.23014,stance loss: 0.12416 
Train step: 3300 acc:0.96845 total_loss: 0.20097  loss:0.17159,stance loss: 0.17357 
Train step: 3310 acc:0.96903 total_loss: 0.20445  loss:0.23873,stance loss: 0.20561 
Train step: 3320 acc:0.969 total_loss: 0.19963  loss:0.050413,stance loss: 0.0087685 
Train step: 3330 acc:0.96898 total_loss: 0.19845  loss:0.047536,stance loss: 0.010239 
Train step: 3340 acc:0.96941 total_loss: 0.20134  loss:0.31119,stance loss: 0.23706 
Train step: 3350 acc:0.96895 total_loss: 0.19898  loss:0.10233,stance loss: 0.013039 
Train step: 3360 acc:0.97009 total_loss: 0.19871  loss:0.015395,stance loss: 0.0060886 
Train step: 3370 acc:0.97038 total_loss: 0.19776  loss:0.039208,stance loss: 0.0015505 
Train step: 3380 acc:0.96995 total_loss: 0.20244  loss:0.093507,stance loss: 0.055176 
Train step: 3390 acc:0.96826 total_loss: 0.20302  loss:0.63891,stance loss: 1.0182 
Train step: 3400 acc:0.96706 total_loss: 0.21021  loss:0.027121,stance loss: 0.0044073 
Train step: 3410 acc:0.96714 total_loss: 0.20864  loss:0.2795,stance loss: 0.22784 
Train step: 3420 acc:0.96581 total_loss: 0.21151  loss:0.034108,stance loss: 0.0043888 
Train step: 3430 acc:0.9662 total_loss: 0.21055  loss:0.037053,stance loss: 0.024543 
Train step: 3440 acc:0.96656 total_loss: 0.21446  loss:0.033172,stance loss: 0.011989 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.96429 total_loss: 0.24779  loss:0.14225,stance loss: 0.11415 
Train step: 3460 acc:0.97059 total_loss: 0.19126  loss:0.15245,stance loss: 0.13437 
Train step: 3470 acc:0.96528 total_loss: 0.22413  loss:0.52469,stance loss: 1.008 
Train step: 3480 acc:0.96791 total_loss: 0.2127  loss:0.042799,stance loss: 0.016716 
Train step: 3490 acc:0.96941 total_loss: 0.23472  loss:0.073142,stance loss: 0.046734 
Train step: 3500 acc:0.97149 total_loss: 0.22729  loss:0.12116,stance loss: 0.06228 
Train step: 3510 acc:0.97481 total_loss: 0.20437  loss:0.072363,stance loss: 0.039595 
Train step: 3520 acc:0.97565 total_loss: 0.19771  loss:0.0337,stance loss: 0.012063 
Train step: 3530 acc:0.97701 total_loss: 0.20617  loss:0.033935,stance loss: 0.01165 
Train step: 3540 acc:0.97938 total_loss: 0.19166  loss:0.13805,stance loss: 0.08758 
Train step: 3550 acc:0.97897 total_loss: 0.18194  loss:0.1448,stance loss: 0.05798 
Train step: 3560 acc:0.9781 total_loss: 0.18439  loss:0.12583,stance loss: 0.043447 
Train step: 3570 acc:0.97835 total_loss: 0.1854  loss:0.018294,stance loss: 0.0049233 
Train step: 3580 acc:0.9781 total_loss: 0.17964  loss:0.13493,stance loss: 0.11053 
Train step: 3590 acc:0.97789 total_loss: 0.18053  loss:0.51955,stance loss: 1.0074 
Train step: 3600 acc:0.9785 total_loss: 0.17557  loss:0.028783,stance loss: 0.0048734 
Train step: 3610 acc:0.97942 total_loss: 0.17675  loss:0.61546,stance loss: 1.1228 
Train step: 3620 acc:0.97952 total_loss: 0.17718  loss:0.12423,stance loss: 0.12417 
Train step: 3630 acc:0.97861 total_loss: 0.18404  loss:0.017442,stance loss: 0.0041803 
Train step: 3640 acc:0.97779 total_loss: 0.18339  loss:0.1181,stance loss: 0.025193 
Train step: 3650 acc:0.97585 total_loss: 0.18999  loss:0.086666,stance loss: 0.026786 
Train step: 3660 acc:0.97581 total_loss: 0.18962  loss:0.56312,stance loss: 1.0111 
Train step: 3670 acc:0.97494 total_loss: 0.19172  loss:0.5308,stance loss: 0.34781 
Train step: 3680 acc:0.97363 total_loss: 0.19846  loss:0.19426,stance loss: 0.1084 
Training finished.


Reload the best model with best f1 0.4426264375674156 from path test_outputs/bert-cross-topic/la/2023-08-14 14-28-11/state_dict


              precision    recall  f1-score   support

           0   0.551402  0.650735  0.596965       544
           1   0.285714  0.018018  0.033898       222
           2   0.231047  0.383234  0.288288       167

    accuracy                       0.452304       933
   macro avg   0.356054  0.350662  0.306384       933
weighted avg   0.430842  0.452304  0.407737       933

Test Acc: 0.45230439442658094 F1_ma:0.4426264375674156
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4426264375674156
acc: 0.45230439442658094, f1 :0.30638372673985903
classification report: 
              precision    recall  f1-score   support

         Con     0.5514    0.6507    0.5970       544
        None     0.2857    0.0180    0.0339       222
         Pro     0.2310    0.3832    0.2883       167

    accuracy                         0.4523       933
   macro avg     0.3561    0.3507    0.3064       933
weighted avg     0.4308    0.4523    0.4077       933

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 15-05-34', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 15-05-34
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.7334  loss:1.7334,stance loss: 1.0493 
Train step: 10 acc:0.3125 total_loss: 1.7382  loss:1.6853,stance loss: 1.1739 
Better F1! Saving model!
Saving model of best f1: 0.1584148649565062
              precision    recall  f1-score   support

           0   0.593220  0.064338  0.116086       544
           1   0.180915  0.409910  0.251034       222
           2   0.145553  0.323353  0.200743       167

    accuracy                       0.192926       933
   macro avg   0.306562  0.265867  0.189288       933
weighted avg   0.414986  0.192926  0.163349       933

Test Acc: 0.19292604501607716 F1_ma:0.1584148649565062
Train step: 20 acc:0.29762 total_loss: 1.729  loss:1.7092,stance loss: 1.2407 
Better F1! Saving model!
Saving model of best f1: 0.33997050147492625
              precision    recall  f1-score   support

           0   0.567734  0.847426  0.679941       544
           1   0.052174  0.027027  0.035608       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.500536       933
   macro avg   0.206636  0.291484  0.238516       933
weighted avg   0.343440  0.500536  0.404923       933

Test Acc: 0.5005359056806002 F1_ma:0.33997050147492625
Train step: 30 acc:0.33065 total_loss: 1.6988  loss:1.5947,stance loss: 1.0752 
Better F1! Saving model!
Saving model of best f1: 0.3688135593220339
              precision    recall  f1-score   support

           0   0.584318  1.000000  0.737627       544
           1   1.000000  0.009009  0.017857       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.585209       933
   macro avg   0.528106  0.336336  0.251828       933
weighted avg   0.578638  0.585209  0.434334       933

Test Acc: 0.5852090032154341 F1_ma:0.3688135593220339
Train step: 40 acc:0.35213 total_loss: 1.6838  loss:1.5777,stance loss: 1.0935 
Better F1! Saving model!
Saving model of best f1: 0.36906377204884666
              precision    recall  f1-score   support

           0   0.584946  1.000000  0.738128       544
           1   1.000000  0.013514  0.026667       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.586281       933
   macro avg   0.528315  0.337838  0.254931       933
weighted avg   0.579004  0.586281  0.436722       933

Test Acc: 0.5862808145766345 F1_ma:0.36906377204884666
Train step: 50 acc:0.37377 total_loss: 1.6586  loss:1.4999,stance loss: 0.9413 
Better F1! Saving model!
Saving model of best f1: 0.3695652173913043
              precision    recall  f1-score   support

           0   0.586207  1.000000  0.739130       544
           1   1.000000  0.022523  0.044053       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.588424       933
   macro avg   0.528736  0.340841  0.261061       933
weighted avg   0.579739  0.588424  0.441443       933

Test Acc: 0.5884244372990354 F1_ma:0.3695652173913043
Train step: 60 acc:0.3873 total_loss: 1.6612  loss:1.4318,stance loss: 0.90086 
Better F1! Saving model!
Saving model of best f1: 0.37039563437926326
              precision    recall  f1-score   support

           0   0.588937  0.998162  0.740791       544
           1   0.909091  0.045045  0.085837       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.592712       933
   macro avg   0.499343  0.347736  0.275543       933
weighted avg   0.559700  0.592712  0.452354       933

Test Acc: 0.5927116827438371 F1_ma:0.37039563437926326
Train step: 70 acc:0.39877 total_loss: 1.6607  loss:1.8151,stance loss: 1.7639 
Better F1! Saving model!
Saving model of best f1: 0.3711551606288448
              precision    recall  f1-score   support

           0   0.590860  0.998162  0.742310       544
           1   0.928571  0.058559  0.110169       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.595927       933
   macro avg   0.506477  0.352240  0.284160       933
weighted avg   0.565456  0.595927  0.459029       933

Test Acc: 0.5959271168274384 F1_ma:0.3711551606288448
Train step: 80 acc:0.40895 total_loss: 1.6456  loss:1.6428,stance loss: 1.157 
Train step: 90 acc:0.42239 total_loss: 1.6359  loss:1.5733,stance loss: 1.1888 
Train step: 100 acc:0.43255 total_loss: 1.63  loss:1.6142,stance loss: 1.035 
Train step: 110 acc:0.44257 total_loss: 1.6158  loss:1.4089,stance loss: 0.87021 
Better F1! Saving model!
Saving model of best f1: 0.375
              precision    recall  f1-score   support

           0   0.604730  0.987132  0.750000       544
           1   0.844444  0.171171  0.284644       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.616292       933
   macro avg   0.483058  0.386101  0.344881       933
weighted avg   0.553526  0.616292  0.505028       933

Test Acc: 0.6162915326902465 F1_ma:0.375
Train step: 120 acc:0.44783 total_loss: 1.616  loss:1.497,stance loss: 0.99194 
Better F1! Saving model!
Saving model of best f1: 0.37703703703703706
              precision    recall  f1-score   support

           0   0.631514  0.935662  0.754074       544
           1   0.661417  0.378378  0.481375       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.635584       933
   macro avg   0.430977  0.438013  0.411816       933
weighted avg   0.525593  0.635584  0.554214       933

Test Acc: 0.6355841371918542 F1_ma:0.37703703703703706
Train step: 130 acc:0.45849 total_loss: 1.6075  loss:1.6631,stance loss: 1.3592 
Better F1! Saving model!
Saving model of best f1: 0.37799401197604793
              precision    recall  f1-score   support

           0   0.637626  0.928309  0.755988       544
           1   0.659574  0.418919  0.512397       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.640943       933
   macro avg   0.432400  0.449076  0.422795       933
weighted avg   0.528718  0.640943  0.562711       933

Test Acc: 0.6409431939978564 F1_ma:0.37799401197604793
Train step: 140 acc:0.46897 total_loss: 1.5984  loss:1.3955,stance loss: 0.95112 
Train step: 150 acc:0.47848 total_loss: 1.591  loss:1.1892,stance loss: 0.8062 
Train step: 160 acc:0.48292 total_loss: 1.5855  loss:1.6168,stance loss: 1.4672 
Better F1! Saving model!
Saving model of best f1: 0.3786685755189692
              precision    recall  f1-score   support

           0   0.620164  0.972426  0.757337       544
           1   0.800000  0.288288  0.423841       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.635584       933
   macro avg   0.473388  0.420238  0.393726       933
weighted avg   0.551950  0.635584  0.542427       933

Test Acc: 0.6355841371918542 F1_ma:0.3786685755189692
Train step: 170 acc:0.48611 total_loss: 1.5812  loss:1.6501,stance loss: 1.2687 
Train step: 180 acc:0.49206 total_loss: 1.5727  loss:1.4564,stance loss: 0.74292 
Train step: 190 acc:0.4964 total_loss: 1.5672  loss:1.3931,stance loss: 0.94746 
Train step: 200 acc:0.49751 total_loss: 1.5624  loss:1.4604,stance loss: 1.0573 
Better F1! Saving model!
Saving model of best f1: 0.3789398280802292
              precision    recall  f1-score   support

           0   0.620892  0.972426  0.757880       544
           1   0.790123  0.288288  0.422442       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.635584       933
   macro avg   0.470338  0.420238  0.393441       933
weighted avg   0.550024  0.635584  0.542410       933

Test Acc: 0.6355841371918542 F1_ma:0.3789398280802292
Train step: 210 acc:0.50178 total_loss: 1.5556  loss:1.378,stance loss: 1.1283 
Train step: 220 acc:0.50566 total_loss: 1.5556  loss:1.6925,stance loss: 1.759 
Train step: 230 acc:0.50839 total_loss: 1.5544  loss:1.3023,stance loss: 0.80814 
Train step: 240 acc:0.51245 total_loss: 1.5459  loss:1.3609,stance loss: 1.117 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.6625 total_loss: 1.2403  loss:1.2301,stance loss: 0.86988 
Train step: 260 acc:0.6 total_loss: 1.3185  loss:1.6793,stance loss: 1.0673 
Train step: 270 acc:0.5975 total_loss: 1.3775  loss:1.7455,stance loss: 1.7283 
Train step: 280 acc:0.60893 total_loss: 1.3479  loss:1.524,stance loss: 1.0923 
Train step: 290 acc:0.61389 total_loss: 1.3417  loss:1.3184,stance loss: 1.0754 
Train step: 300 acc:0.62841 total_loss: 1.3304  loss:1.8976,stance loss: 1.9454 
Train step: 310 acc:0.63846 total_loss: 1.3224  loss:1.1925,stance loss: 0.77414 
Train step: 320 acc:0.64333 total_loss: 1.3123  loss:1.5825,stance loss: 1.6537 
Train step: 330 acc:0.64706 total_loss: 1.309  loss:1.2798,stance loss: 0.97121 
Train step: 340 acc:0.63487 total_loss: 1.3273  loss:1.3941,stance loss: 0.92044 
Train step: 350 acc:0.63929 total_loss: 1.3201  loss:1.4469,stance loss: 1.1975 
Train step: 360 acc:0.64022 total_loss: 1.3102  loss:1.0157,stance loss: 0.60171 
Train step: 370 acc:0.6395 total_loss: 1.311  loss:1.3928,stance loss: 1.2036 
Better F1! Saving model!
Saving model of best f1: 0.38336962438758837
              precision    recall  f1-score   support

           0   0.627525  0.913603  0.744012       544
           1   0.689394  0.409910  0.514124       222
           2   0.222222  0.011976  0.022727       167

    accuracy                       0.632369       933
   macro avg   0.513047  0.445163  0.426955       933
weighted avg   0.569700  0.632369  0.560207       933

Test Acc: 0.632368703108253 F1_ma:0.38336962438758837
Train step: 380 acc:0.63843 total_loss: 1.308  loss:1.4584,stance loss: 1.1098 
Train step: 390 acc:0.63707 total_loss: 1.3142  loss:1.1601,stance loss: 0.73607 
Train step: 400 acc:0.63548 total_loss: 1.3116  loss:1.2937,stance loss: 0.90232 
Better F1! Saving model!
Saving model of best f1: 0.4665198808444502
              precision    recall  f1-score   support

           0   0.638640  0.656250  0.647325       544
           1   0.604520  0.481982  0.536341       222
           2   0.263959  0.311377  0.285714       167

    accuracy                       0.553055       933
   macro avg   0.502373  0.483203  0.489794       933
weighted avg   0.563457  0.553055  0.556192       933

Test Acc: 0.5530546623794212 F1_ma:0.4665198808444502
Train step: 410 acc:0.63826 total_loss: 1.3007  loss:1.1053,stance loss: 0.66341 
Train step: 420 acc:0.63893 total_loss: 1.2992  loss:1.0452,stance loss: 0.7937 
Train step: 430 acc:0.64155 total_loss: 1.2984  loss:1.247,stance loss: 1.0729 
Train step: 440 acc:0.63974 total_loss: 1.2999  loss:1.2993,stance loss: 0.84145 
Train step: 450 acc:0.63811 total_loss: 1.2993  loss:1.2825,stance loss: 1.0537 
Train step: 460 acc:0.64157 total_loss: 1.2958  loss:1.5021,stance loss: 0.97618 
Train step: 470 acc:0.64472 total_loss: 1.2881  loss:0.96374,stance loss: 0.72773 
Train step: 480 acc:0.64388 total_loss: 1.2927  loss:1.3751,stance loss: 1.1457 
Train step: 490 acc:0.64362 total_loss: 1.2864  loss:1.276,stance loss: 0.97384 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.6875 total_loss: 1.1906  loss:0.81795,stance loss: 0.59095 
Train step: 510 acc:0.69737 total_loss: 1.2137  loss:1.228,stance loss: 0.99829 
Train step: 520 acc:0.68103 total_loss: 1.1931  loss:1.1544,stance loss: 0.7551 
Train step: 530 acc:0.67468 total_loss: 1.1715  loss:0.73276,stance loss: 0.42529 
Train step: 540 acc:0.6773 total_loss: 1.1773  loss:1.4349,stance loss: 1.0757 
Train step: 550 acc:0.67903 total_loss: 1.1693  loss:1.2365,stance loss: 0.94716 
Better F1! Saving model!
Saving model of best f1: 0.468657242038537
              precision    recall  f1-score   support

           0   0.646667  0.713235  0.678322       544
           1   0.558559  0.558559  0.558559       222
           2   0.324324  0.215569  0.258993       167

    accuracy                       0.587353       933
   macro avg   0.509850  0.495788  0.498624       933
weighted avg   0.568005  0.587353  0.574768       933

Test Acc: 0.587352625937835 F1_ma:0.468657242038537
Train step: 560 acc:0.68207 total_loss: 1.1789  loss:0.7727,stance loss: 0.52684 
Train step: 570 acc:0.68196 total_loss: 1.1856  loss:1.4562,stance loss: 0.96596 
Train step: 580 acc:0.68329 total_loss: 1.1818  loss:0.86432,stance loss: 0.41492 
Train step: 590 acc:0.68056 total_loss: 1.1784  loss:1.4715,stance loss: 1.116 
Train step: 600 acc:0.68062 total_loss: 1.1794  loss:1.2366,stance loss: 0.94647 
Train step: 610 acc:0.68382 total_loss: 1.1755  loss:0.74383,stance loss: 0.51539 
Train step: 620 acc:0.68362 total_loss: 1.1788  loss:1.716,stance loss: 1.7679 
Train step: 630 acc:0.68705 total_loss: 1.1723  loss:1.3612,stance loss: 0.94104 
Train step: 640 acc:0.68666 total_loss: 1.1683  loss:1.5051,stance loss: 1.5784 
Train step: 650 acc:0.68278 total_loss: 1.1777  loss:1.8116,stance loss: 1.3493 
Better F1! Saving model!
Saving model of best f1: 0.46961647681950164
              precision    recall  f1-score   support

           0   0.661670  0.568015  0.611276       544
           1   0.563218  0.662162  0.608696       222
           2   0.297561  0.365269  0.327957       167

    accuracy                       0.554126       933
   macro avg   0.507483  0.531815  0.515976       933
weighted avg   0.573072  0.554126  0.559950       933

Test Acc: 0.5541264737406216 F1_ma:0.46961647681950164
Train step: 660 acc:0.68417 total_loss: 1.1739  loss:1.1114,stance loss: 0.79024 
Train step: 670 acc:0.68645 total_loss: 1.1692  loss:1.0994,stance loss: 0.86429 
Train step: 680 acc:0.68684 total_loss: 1.1667  loss:1.262,stance loss: 1.1713 
Better F1! Saving model!
Saving model of best f1: 0.48120967935343073
              precision    recall  f1-score   support

           0   0.661734  0.575368  0.615536       544
           1   0.554264  0.644144  0.595833       222
           2   0.316832  0.383234  0.346883       167

    accuracy                       0.557342       933
   macro avg   0.510943  0.534248  0.519418       933
weighted avg   0.574427  0.557342  0.562761       933

Test Acc: 0.5573419078242229 F1_ma:0.48120967935343073
Train step: 690 acc:0.68153 total_loss: 1.1751  loss:1.1723,stance loss: 0.84185 
Train step: 700 acc:0.68152 total_loss: 1.1737  loss:0.90184,stance loss: 0.71265 
Train step: 710 acc:0.68436 total_loss: 1.1702  loss:1.7506,stance loss: 1.5285 
Train step: 720 acc:0.68395 total_loss: 1.1659  loss:0.96694,stance loss: 0.61619 
Train step: 730 acc:0.68541 total_loss: 1.1618  loss:0.74863,stance loss: 0.46258 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.64583 total_loss: 1.103  loss:0.88812,stance loss: 0.76156 
Train step: 750 acc:0.70673 total_loss: 1.0111  loss:0.8332,stance loss: 0.69483 
Train step: 760 acc:0.70652 total_loss: 1.0691  loss:1.3146,stance loss: 1.1916 
Train step: 770 acc:0.70455 total_loss: 1.0923  loss:0.87625,stance loss: 0.7097 
Train step: 780 acc:0.69622 total_loss: 1.1076  loss:0.6186,stance loss: 0.35203 
Train step: 790 acc:0.69575 total_loss: 1.106  loss:1.0242,stance loss: 0.77768 
Train step: 800 acc:0.70734 total_loss: 1.0882  loss:0.80816,stance loss: 0.6604 
Train step: 810 acc:0.71147 total_loss: 1.0855  loss:0.92789,stance loss: 0.7104 
Train step: 820 acc:0.7116 total_loss: 1.0839  loss:1.0336,stance loss: 0.77437 
Train step: 830 acc:0.71371 total_loss: 1.0745  loss:1.2108,stance loss: 0.99739 
Train step: 840 acc:0.71602 total_loss: 1.0619  loss:1.1344,stance loss: 0.80988 
Train step: 850 acc:0.71405 total_loss: 1.0784  loss:1.2098,stance loss: 1.1044 
Train step: 860 acc:0.71443 total_loss: 1.081  loss:1.1496,stance loss: 0.9787 
Train step: 870 acc:0.71194 total_loss: 1.0873  loss:1.4916,stance loss: 1.6384 
Train step: 880 acc:0.71066 total_loss: 1.0849  loss:0.9012,stance loss: 0.61633 
Train step: 890 acc:0.71078 total_loss: 1.0823  loss:1.2409,stance loss: 1.1113 
Train step: 900 acc:0.71396 total_loss: 1.0813  loss:1.1174,stance loss: 0.86209 
Train step: 910 acc:0.71134 total_loss: 1.0842  loss:1.1427,stance loss: 0.84152 
Train step: 920 acc:0.70833 total_loss: 1.0885  loss:1.6461,stance loss: 1.7895 
Train step: 930 acc:0.71049 total_loss: 1.0831  loss:1.7271,stance loss: 1.7038 
Train step: 940 acc:0.71059 total_loss: 1.0781  loss:0.84509,stance loss: 0.7304 
Train step: 950 acc:0.71185 total_loss: 1.0734  loss:0.99656,stance loss: 0.78709 
Train step: 960 acc:0.713 total_loss: 1.0677  loss:1.4316,stance loss: 1.0451 
Train step: 970 acc:0.71325 total_loss: 1.0707  loss:1.1178,stance loss: 0.87169 
Train step: 980 acc:0.71219 total_loss: 1.0724  loss:1.2656,stance loss: 1.0613 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.73214 total_loss: 0.9175  loss:0.90078,stance loss: 0.7623 
Train step: 1000 acc:0.73162 total_loss: 0.97076  loss:0.77511,stance loss: 0.62127 
Train step: 1010 acc:0.73148 total_loss: 0.94949  loss:1.5454,stance loss: 1.5428 
Train step: 1020 acc:0.75 total_loss: 0.96994  loss:1.0255,stance loss: 0.90946 
Train step: 1030 acc:0.74468 total_loss: 0.99545  loss:1.0775,stance loss: 0.78747 
Train step: 1040 acc:0.74561 total_loss: 0.97962  loss:0.99669,stance loss: 1.2429 
Train step: 1050 acc:0.75373 total_loss: 0.96166  loss:0.68857,stance loss: 0.48199 
Train step: 1060 acc:0.74269 total_loss: 0.97313  loss:1.0529,stance loss: 0.89687 
Train step: 1070 acc:0.74353 total_loss: 0.96191  loss:1.6977,stance loss: 1.5469 
Train step: 1080 acc:0.74356 total_loss: 0.96268  loss:1.138,stance loss: 0.92358 
Train step: 1090 acc:0.74708 total_loss: 0.96792  loss:0.9159,stance loss: 0.74139 
Train step: 1100 acc:0.75267 total_loss: 0.95964  loss:1.1828,stance loss: 1.0996 
Train step: 1110 acc:0.75148 total_loss: 0.96273  loss:1.2079,stance loss: 1.1007 
Train step: 1120 acc:0.75228 total_loss: 0.96288  loss:0.48614,stance loss: 0.29913 
Train step: 1130 acc:0.74745 total_loss: 0.96967  loss:0.69828,stance loss: 0.52531 
Train step: 1140 acc:0.7504 total_loss: 0.96033  loss:0.51903,stance loss: 0.35525 
Train step: 1150 acc:0.74963 total_loss: 0.96142  loss:0.86665,stance loss: 0.7354 
Train step: 1160 acc:0.74823 total_loss: 0.9611  loss:0.65244,stance loss: 0.41119 
Train step: 1170 acc:0.74733 total_loss: 0.96079  loss:0.67879,stance loss: 0.50187 
Train step: 1180 acc:0.74365 total_loss: 0.97334  loss:1.959,stance loss: 1.7341 
Train step: 1190 acc:0.74879 total_loss: 0.96213  loss:0.63966,stance loss: 0.46293 
Train step: 1200 acc:0.74971 total_loss: 0.95917  loss:0.76962,stance loss: 0.6815 
Train step: 1210 acc:0.74917 total_loss: 0.96362  loss:1.185,stance loss: 1.1504 
Train step: 1220 acc:0.75026 total_loss: 0.96078  loss:0.96558,stance loss: 0.87267 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.625 total_loss: 1.2522  loss:1.2522,stance loss: 1.1215 
Train step: 1240 acc:0.76136 total_loss: 0.88933  loss:0.5429,stance loss: 0.37026 
Train step: 1250 acc:0.77083 total_loss: 0.84963  loss:0.87583,stance loss: 0.66422 
Train step: 1260 acc:0.78629 total_loss: 0.85768  loss:1.6357,stance loss: 1.5727 
Train step: 1270 acc:0.78963 total_loss: 0.85051  loss:0.74345,stance loss: 0.64408 
Train step: 1280 acc:0.78799 total_loss: 0.85838  loss:0.89274,stance loss: 0.65797 
Train step: 1290 acc:0.79303 total_loss: 0.83018  loss:0.65694,stance loss: 0.59721 
Train step: 1300 acc:0.78433 total_loss: 0.86149  loss:1.2339,stance loss: 1.5722 
Train step: 1310 acc:0.78627 total_loss: 0.84648  loss:0.4167,stance loss: 0.26519 
Train step: 1320 acc:0.7864 total_loss: 0.84581  loss:0.59846,stance loss: 0.37782 
Train step: 1330 acc:0.79146 total_loss: 0.8397  loss:0.61717,stance loss: 0.49556 
Train step: 1340 acc:0.79392 total_loss: 0.84762  loss:1.075,stance loss: 1.3119 
Train step: 1350 acc:0.79132 total_loss: 0.85442  loss:0.44854,stance loss: 0.27551 
Train step: 1360 acc:0.7896 total_loss: 0.86442  loss:0.99189,stance loss: 0.72672 
Train step: 1370 acc:0.78901 total_loss: 0.87265  loss:0.97563,stance loss: 0.78886 
Train step: 1380 acc:0.78684 total_loss: 0.87157  loss:1.2921,stance loss: 1.1657 
Train step: 1390 acc:0.78416 total_loss: 0.87202  loss:0.79546,stance loss: 0.58592 
Train step: 1400 acc:0.78509 total_loss: 0.87023  loss:1.2099,stance loss: 0.92627 
Train step: 1410 acc:0.78488 total_loss: 0.86963  loss:0.60121,stance loss: 0.50218 
Train step: 1420 acc:0.78469 total_loss: 0.87054  loss:0.73203,stance loss: 0.40307 
Train step: 1430 acc:0.78669 total_loss: 0.86419  loss:1.0048,stance loss: 0.78818 
Train step: 1440 acc:0.78821 total_loss: 0.86068  loss:0.6346,stance loss: 0.5477 
Train step: 1450 acc:0.78846 total_loss: 0.85694  loss:0.54192,stance loss: 0.44183 
Train step: 1460 acc:0.78815 total_loss: 0.8596  loss:1.2104,stance loss: 1.5168 
Train step: 1470 acc:0.79098 total_loss: 0.85268  loss:1.0292,stance loss: 0.6842 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.85 total_loss: 0.60109  loss:0.36214,stance loss: 0.20743 
Train step: 1490 acc:0.85417 total_loss: 0.69651  loss:0.96435,stance loss: 0.83834 
Train step: 1500 acc:0.8225 total_loss: 0.76771  loss:0.79496,stance loss: 0.69096 
Train step: 1510 acc:0.84821 total_loss: 0.69274  loss:0.33604,stance loss: 0.20601 
Train step: 1520 acc:0.84444 total_loss: 0.71314  loss:0.9085,stance loss: 1.2634 
Train step: 1530 acc:0.8375 total_loss: 0.72321  loss:0.56253,stance loss: 0.27681 
Train step: 1540 acc:0.83365 total_loss: 0.72211  loss:0.45247,stance loss: 0.41021 
Train step: 1550 acc:0.82833 total_loss: 0.73441  loss:0.58838,stance loss: 0.47367 
Train step: 1560 acc:0.83015 total_loss: 0.73559  loss:0.96207,stance loss: 0.83702 
Train step: 1570 acc:0.82697 total_loss: 0.7403  loss:0.59414,stance loss: 0.47937 
Train step: 1580 acc:0.82738 total_loss: 0.73552  loss:0.47687,stance loss: 0.33743 
Train step: 1590 acc:0.83207 total_loss: 0.73074  loss:0.60367,stance loss: 0.36061 
Train step: 1600 acc:0.8305 total_loss: 0.7228  loss:0.98264,stance loss: 0.48309 
Train step: 1610 acc:0.83102 total_loss: 0.72463  loss:0.63678,stance loss: 0.43075 
Train step: 1620 acc:0.82759 total_loss: 0.73189  loss:1.1486,stance loss: 0.92091 
Train step: 1630 acc:0.82782 total_loss: 0.73779  loss:0.63978,stance loss: 0.51457 
Train step: 1640 acc:0.82841 total_loss: 0.73527  loss:0.63799,stance loss: 0.48694 
Train step: 1650 acc:0.82464 total_loss: 0.73438  loss:0.74154,stance loss: 0.67863 
Train step: 1660 acc:0.825 total_loss: 0.73861  loss:0.6477,stance loss: 0.42874 
Train step: 1670 acc:0.82404 total_loss: 0.74087  loss:0.86184,stance loss: 0.75572 
Train step: 1680 acc:0.82409 total_loss: 0.74075  loss:0.3025,stance loss: 0.12897 
Train step: 1690 acc:0.82616 total_loss: 0.73816  loss:0.62008,stance loss: 0.43772 
Train step: 1700 acc:0.82639 total_loss: 0.73522  loss:0.93065,stance loss: 1.1947 
Train step: 1710 acc:0.8266 total_loss: 0.73172  loss:0.38008,stance loss: 0.24692 
Train step: 1720 acc:0.82628 total_loss: 0.73121  loss:0.48794,stance loss: 0.41643 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.9375 total_loss: 0.42711  loss:0.30285,stance loss: 0.19232 
Train step: 1740 acc:0.91118 total_loss: 0.47982  loss:0.32846,stance loss: 0.2198 
Train step: 1750 acc:0.88147 total_loss: 0.59772  loss:0.31578,stance loss: 0.13061 
Train step: 1760 acc:0.8766 total_loss: 0.64161  loss:0.44054,stance loss: 0.30044 
Train step: 1770 acc:0.8801 total_loss: 0.62442  loss:0.5453,stance loss: 0.38927 
Train step: 1780 acc:0.875 total_loss: 0.61991  loss:0.84936,stance loss: 0.6973 
Train step: 1790 acc:0.86504 total_loss: 0.63873  loss:0.77993,stance loss: 0.80212 
Train step: 1800 acc:0.86551 total_loss: 0.62541  loss:0.54293,stance loss: 0.42553 
Train step: 1810 acc:0.86657 total_loss: 0.6239  loss:0.16894,stance loss: 0.008905 
Train step: 1820 acc:0.86553 total_loss: 0.61886  loss:0.83805,stance loss: 0.70237 
Train step: 1830 acc:0.86755 total_loss: 0.60906  loss:0.46304,stance loss: 0.27174 
Train step: 1840 acc:0.86712 total_loss: 0.61258  loss:0.48712,stance loss: 0.25837 
Train step: 1850 acc:0.86531 total_loss: 0.61901  loss:0.34756,stance loss: 0.20885 
Train step: 1860 acc:0.86106 total_loss: 0.625  loss:1.2347,stance loss: 1.4939 
Train step: 1870 acc:0.8599 total_loss: 0.63006  loss:1.0147,stance loss: 0.98582 
Train step: 1880 acc:0.8577 total_loss: 0.63511  loss:1.2342,stance loss: 0.80704 
Train step: 1890 acc:0.85392 total_loss: 0.6433  loss:1.0209,stance loss: 1.3353 
Train step: 1900 acc:0.85021 total_loss: 0.64762  loss:0.7939,stance loss: 0.65826 
Train step: 1910 acc:0.85086 total_loss: 0.64337  loss:0.49076,stance loss: 0.39688 
Train step: 1920 acc:0.85333 total_loss: 0.63402  loss:0.55229,stance loss: 0.42114 
Train step: 1930 acc:0.85467 total_loss: 0.63149  loss:0.22521,stance loss: 0.12053 
Train step: 1940 acc:0.85559 total_loss: 0.62903  loss:0.46088,stance loss: 0.2368 
Train step: 1950 acc:0.85644 total_loss: 0.62644  loss:0.59594,stance loss: 0.5416 
Train step: 1960 acc:0.858 total_loss: 0.62117  loss:0.32874,stance loss: 0.19774 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.95833 total_loss: 0.32156  loss:0.36412,stance loss: 0.30345 
Train step: 1980 acc:0.90865 total_loss: 0.41604  loss:0.40778,stance loss: 0.33796 
Train step: 1990 acc:0.89674 total_loss: 0.5208  loss:0.86643,stance loss: 0.93433 
Train step: 2000 acc:0.91098 total_loss: 0.50344  loss:0.84242,stance loss: 0.66477 
Train step: 2010 acc:0.90552 total_loss: 0.48754  loss:0.24894,stance loss: 0.19109 
Train step: 2020 acc:0.90094 total_loss: 0.49101  loss:0.51758,stance loss: 0.36779 
Train step: 2030 acc:0.8998 total_loss: 0.5038  loss:0.24549,stance loss: 0.11422 
Train step: 2040 acc:0.89469 total_loss: 0.51566  loss:0.78501,stance loss: 0.90017 
Train step: 2050 acc:0.89458 total_loss: 0.5157  loss:0.16088,stance loss: 0.054592 
Train step: 2060 acc:0.89382 total_loss: 0.51466  loss:0.4518,stance loss: 0.31585 
Train step: 2070 acc:0.89624 total_loss: 0.50797  loss:0.52627,stance loss: 0.36369 
Train step: 2080 acc:0.89712 total_loss: 0.50848  loss:0.3096,stance loss: 0.27407 
Train step: 2090 acc:0.89837 total_loss: 0.50118  loss:0.53646,stance loss: 0.40339 
Train step: 2100 acc:0.89756 total_loss: 0.51076  loss:0.83925,stance loss: 0.66312 
Train step: 2110 acc:0.89598 total_loss: 0.51502  loss:0.30103,stance loss: 0.17263 
Train step: 2120 acc:0.89379 total_loss: 0.51839  loss:0.40961,stance loss: 0.26305 
Train step: 2130 acc:0.8934 total_loss: 0.51669  loss:0.3788,stance loss: 0.27831 
Train step: 2140 acc:0.89306 total_loss: 0.52376  loss:0.24828,stance loss: 0.13922 
Train step: 2150 acc:0.89208 total_loss: 0.52964  loss:0.85572,stance loss: 1.0598 
Train step: 2160 acc:0.89249 total_loss: 0.52464  loss:0.25247,stance loss: 0.11736 
Train step: 2170 acc:0.89347 total_loss: 0.51712  loss:0.26005,stance loss: 0.18011 
Train step: 2180 acc:0.89319 total_loss: 0.51964  loss:0.54801,stance loss: 0.42636 
Train step: 2190 acc:0.89182 total_loss: 0.52168  loss:0.5889,stance loss: 0.4638 
Train step: 2200 acc:0.89029 total_loss: 0.5282  loss:0.86596,stance loss: 0.72831 
Train step: 2210 acc:0.8912 total_loss: 0.52598  loss:0.43701,stance loss: 0.34963 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.96429 total_loss: 0.32645  loss:0.20816,stance loss: 0.10704 
Train step: 2230 acc:0.91544 total_loss: 0.45907  loss:0.44873,stance loss: 0.37464 
Train step: 2240 acc:0.8912 total_loss: 0.51261  loss:0.75537,stance loss: 0.71845 
Train step: 2250 acc:0.89865 total_loss: 0.48816  loss:0.56443,stance loss: 0.54747 
Train step: 2260 acc:0.90293 total_loss: 0.46317  loss:0.37693,stance loss: 0.32103 
Train step: 2270 acc:0.9068 total_loss: 0.46266  loss:0.19943,stance loss: 0.12861 
Train step: 2280 acc:0.91138 total_loss: 0.45951  loss:0.9044,stance loss: 1.3483 
Train step: 2290 acc:0.91477 total_loss: 0.44327  loss:0.33774,stance loss: 0.27294 
Train step: 2300 acc:0.91379 total_loss: 0.44987  loss:0.79533,stance loss: 0.82437 
Train step: 2310 acc:0.9143 total_loss: 0.44602  loss:0.22417,stance loss: 0.12283 
Train step: 2320 acc:0.91589 total_loss: 0.44525  loss:0.17417,stance loss: 0.099759 
Train step: 2330 acc:0.91506 total_loss: 0.43994  loss:0.10939,stance loss: 0.020842 
Train step: 2340 acc:0.91289 total_loss: 0.4392  loss:0.24681,stance loss: 0.10174 
Train step: 2350 acc:0.90876 total_loss: 0.45061  loss:0.50707,stance loss: 0.37871 
Train step: 2360 acc:0.91284 total_loss: 0.44219  loss:0.25385,stance loss: 0.1762 
Train step: 2370 acc:0.91481 total_loss: 0.43656  loss:0.10153,stance loss: 0.040195 
Train step: 2380 acc:0.91504 total_loss: 0.43724  loss:0.47037,stance loss: 0.29964 
Train step: 2390 acc:0.91208 total_loss: 0.44114  loss:0.29648,stance loss: 0.22658 
Train step: 2400 acc:0.90909 total_loss: 0.45612  loss:0.22977,stance loss: 0.12771 
Train step: 2410 acc:0.90958 total_loss: 0.45456  loss:0.25894,stance loss: 0.22263 
Train step: 2420 acc:0.91033 total_loss: 0.45523  loss:0.73157,stance loss: 1.067 
Train step: 2430 acc:0.91043 total_loss: 0.45413  loss:0.36944,stance loss: 0.24741 
Train step: 2440 acc:0.90914 total_loss: 0.45541  loss:0.61036,stance loss: 0.73606 
Train step: 2450 acc:0.90902 total_loss: 0.45721  loss:0.39596,stance loss: 0.29796 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.29316  loss:0.29316,stance loss: 0.21723 
Train step: 2470 acc:0.94886 total_loss: 0.27591  loss:0.22048,stance loss: 0.075548 
Train step: 2480 acc:0.94643 total_loss: 0.37139  loss:0.2093,stance loss: 0.16824 
Train step: 2490 acc:0.93145 total_loss: 0.3707  loss:0.68727,stance loss: 0.5196 
Train step: 2500 acc:0.92226 total_loss: 0.40524  loss:0.30204,stance loss: 0.18391 
Train step: 2510 acc:0.9277 total_loss: 0.38356  loss:0.082561,stance loss: 0.029665 
Train step: 2520 acc:0.92623 total_loss: 0.38323  loss:0.22769,stance loss: 0.16835 
Train step: 2530 acc:0.92606 total_loss: 0.38837  loss:0.43779,stance loss: 0.38034 
Train step: 2540 acc:0.92593 total_loss: 0.39187  loss:0.55674,stance loss: 0.40876 
Train step: 2550 acc:0.92857 total_loss: 0.39294  loss:0.41218,stance loss: 0.42116 
Train step: 2560 acc:0.92636 total_loss: 0.39538  loss:0.43886,stance loss: 0.38875 
Train step: 2570 acc:0.92793 total_loss: 0.398  loss:0.73379,stance loss: 1.1471 
Train step: 2580 acc:0.93027 total_loss: 0.3882  loss:0.06608,stance loss: 0.012656 
Train step: 2590 acc:0.93034 total_loss: 0.3901  loss:0.37694,stance loss: 0.27887 
Train step: 2600 acc:0.93129 total_loss: 0.38743  loss:0.39766,stance loss: 0.41234 
Train step: 2610 acc:0.93336 total_loss: 0.38339  loss:0.20024,stance loss: 0.12161 
Train step: 2620 acc:0.93517 total_loss: 0.3711  loss:0.24016,stance loss: 0.14136 
Train step: 2630 acc:0.93494 total_loss: 0.37276  loss:0.53284,stance loss: 0.42154 
Train step: 2640 acc:0.93301 total_loss: 0.38071  loss:0.45311,stance loss: 0.32502 
Train step: 2650 acc:0.93521 total_loss: 0.37295  loss:0.12024,stance loss: 0.062337 
Train step: 2660 acc:0.9347 total_loss: 0.37233  loss:0.26178,stance loss: 0.21618 
Train step: 2670 acc:0.93483 total_loss: 0.36672  loss:0.33588,stance loss: 0.20221 
Train step: 2680 acc:0.93354 total_loss: 0.36721  loss:0.29229,stance loss: 0.26882 
Train step: 2690 acc:0.93209 total_loss: 0.3683  loss:0.086439,stance loss: 0.018154 
Train step: 2700 acc:0.93128 total_loss: 0.37009  loss:0.85775,stance loss: 1.2801 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.925 total_loss: 0.42726  loss:0.13995,stance loss: 0.072434 
Train step: 2720 acc:0.92917 total_loss: 0.38435  loss:0.13275,stance loss: 0.054585 
Train step: 2730 acc:0.925 total_loss: 0.41893  loss:0.31015,stance loss: 0.2793 
Train step: 2740 acc:0.93393 total_loss: 0.37104  loss:0.17429,stance loss: 0.083017 
Train step: 2750 acc:0.93194 total_loss: 0.36821  loss:0.22817,stance loss: 0.14786 
Train step: 2760 acc:0.93977 total_loss: 0.35355  loss:0.16448,stance loss: 0.10648 
Train step: 2770 acc:0.93942 total_loss: 0.34801  loss:0.19793,stance loss: 0.12039 
Train step: 2780 acc:0.93917 total_loss: 0.36137  loss:0.24389,stance loss: 0.15202 
Train step: 2790 acc:0.94118 total_loss: 0.34627  loss:0.091221,stance loss: 0.031555 
Train step: 2800 acc:0.94211 total_loss: 0.33647  loss:0.59447,stance loss: 0.39752 
Train step: 2810 acc:0.94643 total_loss: 0.31695  loss:0.18928,stance loss: 0.12153 
Train step: 2820 acc:0.94565 total_loss: 0.3106  loss:0.15467,stance loss: 0.075251 
Train step: 2830 acc:0.944 total_loss: 0.31557  loss:0.73476,stance loss: 1.1903 
Train step: 2840 acc:0.94398 total_loss: 0.31567  loss:0.43823,stance loss: 0.31852 
Train step: 2850 acc:0.94138 total_loss: 0.3264  loss:0.11944,stance loss: 0.052615 
Train step: 2860 acc:0.94274 total_loss: 0.322  loss:0.32752,stance loss: 0.303 
Train step: 2870 acc:0.94167 total_loss: 0.32195  loss:0.32546,stance loss: 0.19879 
Train step: 2880 acc:0.94214 total_loss: 0.31939  loss:0.6833,stance loss: 1.1154 
Train step: 2890 acc:0.94324 total_loss: 0.31686  loss:0.69771,stance loss: 1.133 
Train step: 2900 acc:0.94199 total_loss: 0.31614  loss:0.15597,stance loss: 0.12077 
Train step: 2910 acc:0.94299 total_loss: 0.31207  loss:0.094554,stance loss: 0.023237 
Train step: 2920 acc:0.94302 total_loss: 0.31307  loss:0.057819,stance loss: 0.010098 
Train step: 2930 acc:0.94333 total_loss: 0.3132  loss:0.090766,stance loss: 0.041791 
Train step: 2940 acc:0.94415 total_loss: 0.31156  loss:0.33543,stance loss: 0.30786 
Train step: 2950 acc:0.94541 total_loss: 0.30725  loss:0.30684,stance loss: 0.25064 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.97222 total_loss: 0.2564  loss:0.25421,stance loss: 0.18234 
Train step: 2970 acc:0.94737 total_loss: 0.29808  loss:0.98965,stance loss: 0.85454 
Train step: 2980 acc:0.94828 total_loss: 0.27459  loss:0.36422,stance loss: 0.29544 
Train step: 2990 acc:0.95513 total_loss: 0.24506  loss:0.2534,stance loss: 0.28852 
Train step: 3000 acc:0.95918 total_loss: 0.24538  loss:0.43352,stance loss: 0.36952 
Train step: 3010 acc:0.95657 total_loss: 0.24445  loss:0.092978,stance loss: 0.034818 
Train step: 3020 acc:0.95652 total_loss: 0.23826  loss:0.09879,stance loss: 0.046184 
Train step: 3030 acc:0.95886 total_loss: 0.2424  loss:0.073877,stance loss: 0.018972 
Train step: 3040 acc:0.95927 total_loss: 0.24395  loss:0.25966,stance loss: 0.18776 
Train step: 3050 acc:0.95707 total_loss: 0.24662  loss:0.11776,stance loss: 0.05915 
Train step: 3060 acc:0.957 total_loss: 0.24645  loss:0.24546,stance loss: 0.11466 
Train step: 3070 acc:0.95693 total_loss: 0.2466  loss:0.22323,stance loss: 0.1843 
Train step: 3080 acc:0.95688 total_loss: 0.24328  loss:0.12261,stance loss: 0.055793 
Train step: 3090 acc:0.95728 total_loss: 0.24095  loss:0.17495,stance loss: 0.1222 
Train step: 3100 acc:0.9568 total_loss: 0.25094  loss:0.033109,stance loss: 0.0019081 
Train step: 3110 acc:0.95676 total_loss: 0.26031  loss:0.50729,stance loss: 0.37774 
Train step: 3120 acc:0.95784 total_loss: 0.25441  loss:0.079058,stance loss: 0.026185 
Train step: 3130 acc:0.95705 total_loss: 0.25746  loss:0.11261,stance loss: 0.070303 
Train step: 3140 acc:0.95536 total_loss: 0.25917  loss:0.18415,stance loss: 0.17753 
Train step: 3150 acc:0.95572 total_loss: 0.25947  loss:0.10216,stance loss: 0.027228 
Train step: 3160 acc:0.95544 total_loss: 0.26285  loss:0.28242,stance loss: 0.22986 
Train step: 3170 acc:0.95462 total_loss: 0.26544  loss:0.70458,stance loss: 0.67381 
Train step: 3180 acc:0.95415 total_loss: 0.26804  loss:0.33274,stance loss: 0.29082 
Train step: 3190 acc:0.95424 total_loss: 0.26467  loss:0.065098,stance loss: 0.022116 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.97917 total_loss: 0.12051  loss:0.055435,stance loss: 0.0052889 
Train step: 3210 acc:0.97596 total_loss: 0.1538  loss:0.042621,stance loss: 0.006469 
Train step: 3220 acc:0.98098 total_loss: 0.20137  loss:0.075898,stance loss: 0.015586 
Train step: 3230 acc:0.97538 total_loss: 0.2068  loss:0.36564,stance loss: 0.29698 
Train step: 3240 acc:0.97529 total_loss: 0.22551  loss:0.32083,stance loss: 0.20421 
Train step: 3250 acc:0.9717 total_loss: 0.23789  loss:0.3624,stance loss: 0.24354 
Train step: 3260 acc:0.97321 total_loss: 0.23186  loss:0.54381,stance loss: 1.0138 
Train step: 3270 acc:0.97089 total_loss: 0.23445  loss:0.076604,stance loss: 0.039903 
Train step: 3280 acc:0.97063 total_loss: 0.2389  loss:0.21697,stance loss: 0.12179 
Train step: 3290 acc:0.9711 total_loss: 0.22961  loss:0.079209,stance loss: 0.024557 
Train step: 3300 acc:0.97027 total_loss: 0.23037  loss:0.19465,stance loss: 0.16013 
Train step: 3310 acc:0.96958 total_loss: 0.23516  loss:0.069879,stance loss: 0.033418 
Train step: 3320 acc:0.96697 total_loss: 0.241  loss:0.081648,stance loss: 0.024194 
Train step: 3330 acc:0.96805 total_loss: 0.23945  loss:0.11141,stance loss: 0.079627 
Train step: 3340 acc:0.96766 total_loss: 0.23695  loss:0.090247,stance loss: 0.020254 
Train step: 3350 acc:0.96814 total_loss: 0.23646  loss:0.71147,stance loss: 0.64572 
Train step: 3360 acc:0.96779 total_loss: 0.23881  loss:0.79879,stance loss: 0.84144 
Train step: 3370 acc:0.96893 total_loss: 0.23306  loss:0.027146,stance loss: 0.0061994 
Train step: 3380 acc:0.96858 total_loss: 0.23416  loss:0.086088,stance loss: 0.064508 
Train step: 3390 acc:0.96924 total_loss: 0.22725  loss:0.060158,stance loss: 0.011696 
Train step: 3400 acc:0.96829 total_loss: 0.2285  loss:0.034672,stance loss: 0.0046136 
Train step: 3410 acc:0.9689 total_loss: 0.22801  loss:0.062521,stance loss: 0.033851 
Train step: 3420 acc:0.96833 total_loss: 0.22579  loss:0.29323,stance loss: 0.31142 
Train step: 3430 acc:0.96808 total_loss: 0.22361  loss:0.14976,stance loss: 0.093686 
Train step: 3440 acc:0.96862 total_loss: 0.22169  loss:0.55021,stance loss: 0.45348 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.94643 total_loss: 0.28674  loss:0.087828,stance loss: 0.044548 
Train step: 3460 acc:0.96691 total_loss: 0.1955  loss:0.059475,stance loss: 0.0085916 
Train step: 3470 acc:0.96759 total_loss: 0.22519  loss:0.24636,stance loss: 0.21493 
Train step: 3480 acc:0.97297 total_loss: 0.21785  loss:0.10083,stance loss: 0.048507 
Train step: 3490 acc:0.9734 total_loss: 0.20911  loss:0.076228,stance loss: 0.048465 
Train step: 3500 acc:0.97259 total_loss: 0.20383  loss:0.040994,stance loss: 0.0051103 
Train step: 3510 acc:0.96828 total_loss: 0.22246  loss:0.10172,stance loss: 0.049996 
Train step: 3520 acc:0.96753 total_loss: 0.22271  loss:0.41523,stance loss: 0.31734 
Train step: 3530 acc:0.96983 total_loss: 0.21196  loss:0.034742,stance loss: 0.0031523 
Train step: 3540 acc:0.96843 total_loss: 0.22677  loss:0.13187,stance loss: 0.10339 
Train step: 3550 acc:0.96846 total_loss: 0.23194  loss:0.034857,stance loss: 0.003444 
Train step: 3560 acc:0.96795 total_loss: 0.23865  loss:0.043192,stance loss: 0.0066375 
Train step: 3570 acc:0.96703 total_loss: 0.24221  loss:0.039235,stance loss: 0.0047933 
Train step: 3580 acc:0.96761 total_loss: 0.2393  loss:0.053796,stance loss: 0.010039 
Train step: 3590 acc:0.96896 total_loss: 0.22998  loss:0.16152,stance loss: 0.16486 
Train step: 3600 acc:0.97014 total_loss: 0.22527  loss:0.23782,stance loss: 0.2107 
Train step: 3610 acc:0.97118 total_loss: 0.21972  loss:0.090081,stance loss: 0.063378 
Train step: 3620 acc:0.96963 total_loss: 0.2264  loss:0.10429,stance loss: 0.035579 
Train step: 3630 acc:0.96992 total_loss: 0.22548  loss:0.55493,stance loss: 1.0107 
Train step: 3640 acc:0.96859 total_loss: 0.22634  loss:0.036356,stance loss: 0.0045031 
Train step: 3650 acc:0.96981 total_loss: 0.22019  loss:0.11575,stance loss: 0.05023 
Train step: 3660 acc:0.97033 total_loss: 0.21815  loss:0.027853,stance loss: 0.0016664 
Train step: 3670 acc:0.97081 total_loss: 0.21446  loss:0.07651,stance loss: 0.046711 
Train step: 3680 acc:0.9702 total_loss: 0.21519  loss:0.1524,stance loss: 0.16157 
Training finished.


Reload the best model with best f1 0.48120967935343073 from path test_outputs/bert-cross-topic/la/2023-08-14 15-05-34/state_dict


              precision    recall  f1-score   support

           0   0.661734  0.575368  0.615536       544
           1   0.554264  0.644144  0.595833       222
           2   0.316832  0.383234  0.346883       167

    accuracy                       0.557342       933
   macro avg   0.510943  0.534248  0.519418       933
weighted avg   0.574427  0.557342  0.562761       933

Test Acc: 0.5573419078242229 F1_ma:0.48120967935343073
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.48120967935343073
acc: 0.5573419078242229, f1 :0.5194175640133982
classification report: 
              precision    recall  f1-score   support

         Con     0.6617    0.5754    0.6155       544
        None     0.5543    0.6441    0.5958       222
         Pro     0.3168    0.3832    0.3469       167

    accuracy                         0.5573       933
   macro avg     0.5109    0.5342    0.5194       933
weighted avg     0.5744    0.5573    0.5628       933

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 15-44-15', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 15-44-15
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.625 total_loss: 1.5147  loss:1.5147,stance loss: 1.0599 
Train step: 10 acc:0.51705 total_loss: 1.5512  loss:1.5418,stance loss: 1.0998 
Better F1! Saving model!
Saving model of best f1: 0.3629807692307692
              precision    recall  f1-score   support

           0   0.643466  0.832721  0.725962       544
           1   0.524017  0.540541  0.532151       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.614148       933
   macro avg   0.389161  0.457754  0.419371       933
weighted avg   0.499869  0.614148  0.549904       933

Test Acc: 0.6141479099678456 F1_ma:0.3629807692307692
Train step: 20 acc:0.52381 total_loss: 1.6239  loss:1.8603,stance loss: 1.6246 
Train step: 30 acc:0.50605 total_loss: 1.6268  loss:1.7081,stance loss: 1.0136 
Better F1! Saving model!
Saving model of best f1: 0.37453183520599254
              precision    recall  f1-score   support

           0   0.632111  0.919118  0.749064       544
           1   0.633803  0.405405  0.494505       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.632369       933
   macro avg   0.421971  0.441508  0.414523       933
weighted avg   0.519371  0.632369  0.554417       933

Test Acc: 0.632368703108253 F1_ma:0.37453183520599254
Train step: 40 acc:0.50152 total_loss: 1.6282  loss:1.9205,stance loss: 1.7473 
Train step: 50 acc:0.48652 total_loss: 1.6237  loss:1.6624,stance loss: 1.1962 
Train step: 60 acc:0.48361 total_loss: 1.6202  loss:1.526,stance loss: 1.1218 
Train step: 70 acc:0.47799 total_loss: 1.617  loss:1.9234,stance loss: 1.8127 
Train step: 80 acc:0.48611 total_loss: 1.6101  loss:1.8116,stance loss: 1.7606 
Train step: 90 acc:0.49725 total_loss: 1.5997  loss:1.45,stance loss: 1.1381 
Train step: 100 acc:0.50248 total_loss: 1.592  loss:1.4467,stance loss: 0.9868 
Train step: 110 acc:0.51126 total_loss: 1.5792  loss:1.3952,stance loss: 0.94925 
Train step: 120 acc:0.51808 total_loss: 1.5627  loss:1.3241,stance loss: 0.95064 
Train step: 130 acc:0.52099 total_loss: 1.5593  loss:1.3771,stance loss: 0.90725 
Train step: 140 acc:0.51862 total_loss: 1.5598  loss:1.4845,stance loss: 0.96941 
Train step: 150 acc:0.5178 total_loss: 1.5576  loss:1.4801,stance loss: 1.1256 
Train step: 160 acc:0.52096 total_loss: 1.5549  loss:1.6845,stance loss: 1.6695 
Train step: 170 acc:0.52083 total_loss: 1.55  loss:1.1717,stance loss: 0.54481 
Train step: 180 acc:0.52175 total_loss: 1.5467  loss:1.503,stance loss: 1.0985 
Train step: 190 acc:0.52389 total_loss: 1.5444  loss:1.3642,stance loss: 0.81927 
Train step: 200 acc:0.5283 total_loss: 1.5389  loss:1.3216,stance loss: 0.95774 
Train step: 210 acc:0.53199 total_loss: 1.5362  loss:1.5541,stance loss: 1.2448 
Train step: 220 acc:0.53422 total_loss: 1.5302  loss:1.5718,stance loss: 1.1309 
Train step: 230 acc:0.53571 total_loss: 1.5274  loss:1.4966,stance loss: 1.1386 
Train step: 240 acc:0.53734 total_loss: 1.5206  loss:1.379,stance loss: 0.9874 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.6375 total_loss: 1.2482  loss:1.2249,stance loss: 0.88566 
Train step: 260 acc:0.6625 total_loss: 1.3163  loss:1.1566,stance loss: 0.8133 
Train step: 270 acc:0.6625 total_loss: 1.3341  loss:1.1103,stance loss: 0.75858 
Better F1! Saving model!
Saving model of best f1: 0.38818771589855927
              precision    recall  f1-score   support

           0   0.672897  0.661765  0.667285       544
           1   0.489855  0.761261  0.596120       222
           2   0.226415  0.071856  0.109091       167

    accuracy                       0.579850       933
   macro avg   0.463056  0.498294  0.457498       933
weighted avg   0.549427  0.579850  0.550439       933

Test Acc: 0.579849946409432 F1_ma:0.38818771589855927
Train step: 280 acc:0.67321 total_loss: 1.2977  loss:1.2249,stance loss: 0.92354 
Train step: 290 acc:0.675 total_loss: 1.3029  loss:1.447,stance loss: 1.4481 
Train step: 300 acc:0.67273 total_loss: 1.3316  loss:1.7317,stance loss: 1.6453 
Train step: 310 acc:0.66442 total_loss: 1.3393  loss:1.3744,stance loss: 1.0181 
Train step: 320 acc:0.65917 total_loss: 1.338  loss:1.4349,stance loss: 0.99959 
Train step: 330 acc:0.66103 total_loss: 1.3318  loss:1.1017,stance loss: 0.76165 
Train step: 340 acc:0.66447 total_loss: 1.3313  loss:1.3037,stance loss: 1.1694 
Train step: 350 acc:0.66667 total_loss: 1.3284  loss:1.1794,stance loss: 0.875 
Train step: 360 acc:0.65978 total_loss: 1.3274  loss:1.4411,stance loss: 1.2011 
Train step: 370 acc:0.6635 total_loss: 1.3162  loss:1.1397,stance loss: 0.7618 
Train step: 380 acc:0.66343 total_loss: 1.3148  loss:1.4693,stance loss: 1.0438 
Train step: 390 acc:0.65991 total_loss: 1.3152  loss:1.2045,stance loss: 0.8421 
Train step: 400 acc:0.65685 total_loss: 1.3222  loss:1.3884,stance loss: 1.1542 
Train step: 410 acc:0.65606 total_loss: 1.3126  loss:1.1288,stance loss: 0.82569 
Train step: 420 acc:0.65107 total_loss: 1.3172  loss:1.2934,stance loss: 0.97385 
Train step: 430 acc:0.65135 total_loss: 1.3183  loss:1.2053,stance loss: 0.83922 
Train step: 440 acc:0.65192 total_loss: 1.3134  loss:1.1991,stance loss: 0.87607 
Train step: 450 acc:0.64939 total_loss: 1.3124  loss:1.4719,stance loss: 1.0217 
Train step: 460 acc:0.65058 total_loss: 1.3126  loss:1.4388,stance loss: 1.1339 
Train step: 470 acc:0.6525 total_loss: 1.3115  loss:1.3296,stance loss: 0.92505 
Train step: 480 acc:0.65186 total_loss: 1.3103  loss:1.1277,stance loss: 0.7381 
Train step: 490 acc:0.65077 total_loss: 1.3093  loss:1.396,stance loss: 1.0967 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.625 total_loss: 1.2496  loss:1.1945,stance loss: 0.88014 
Train step: 510 acc:0.66447 total_loss: 1.2106  loss:0.92276,stance loss: 0.53154 
Train step: 520 acc:0.67026 total_loss: 1.1787  loss:1.1657,stance loss: 0.78962 
Train step: 530 acc:0.66827 total_loss: 1.1822  loss:1.0398,stance loss: 0.69537 
Train step: 540 acc:0.66454 total_loss: 1.1974  loss:1.2603,stance loss: 0.9081 
Train step: 550 acc:0.66525 total_loss: 1.1949  loss:1.1613,stance loss: 0.89186 
Train step: 560 acc:0.66304 total_loss: 1.2049  loss:1.6015,stance loss: 1.2355 
Train step: 570 acc:0.67089 total_loss: 1.2058  loss:1.2097,stance loss: 0.87556 
Train step: 580 acc:0.67135 total_loss: 1.2123  loss:1.483,stance loss: 1.5783 
Train step: 590 acc:0.66919 total_loss: 1.2139  loss:1.3784,stance loss: 0.99881 
Train step: 600 acc:0.66686 total_loss: 1.2201  loss:1.4017,stance loss: 1.1722 
Train step: 610 acc:0.66912 total_loss: 1.2146  loss:1.126,stance loss: 0.85278 
Train step: 620 acc:0.67054 total_loss: 1.2136  loss:0.83976,stance loss: 0.43861 
Train step: 630 acc:0.66906 total_loss: 1.2122  loss:1.1786,stance loss: 0.90498 
Train step: 640 acc:0.67156 total_loss: 1.2118  loss:1.3576,stance loss: 1.2246 
Train step: 650 acc:0.67178 total_loss: 1.2124  loss:1.3681,stance loss: 1.1461 
Train step: 660 acc:0.66901 total_loss: 1.216  loss:1.1065,stance loss: 0.76694 
Train step: 670 acc:0.66934 total_loss: 1.2111  loss:1.4586,stance loss: 1.6833 
Train step: 680 acc:0.66601 total_loss: 1.2181  loss:1.285,stance loss: 1.1114 
Train step: 690 acc:0.66457 total_loss: 1.2176  loss:1.0367,stance loss: 0.69975 
Train step: 700 acc:0.66567 total_loss: 1.2162  loss:1.0019,stance loss: 0.85241 
Train step: 710 acc:0.66781 total_loss: 1.2125  loss:1.1261,stance loss: 0.88251 
Train step: 720 acc:0.66812 total_loss: 1.212  loss:1.5309,stance loss: 1.2698 
Train step: 730 acc:0.66893 total_loss: 1.2085  loss:1.2638,stance loss: 1.0667 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.77083 total_loss: 0.99995  loss:1.1094,stance loss: 0.79908 
Train step: 750 acc:0.74519 total_loss: 1.0977  loss:1.0369,stance loss: 0.81343 
Train step: 760 acc:0.69293 total_loss: 1.1598  loss:0.89769,stance loss: 0.66584 
Train step: 770 acc:0.69697 total_loss: 1.1478  loss:0.95864,stance loss: 0.81039 
Train step: 780 acc:0.70494 total_loss: 1.1473  loss:1.1472,stance loss: 1.3192 
Train step: 790 acc:0.70283 total_loss: 1.1665  loss:1.128,stance loss: 0.90582 
Better F1! Saving model!
Saving model of best f1: 0.43101883367370086
              precision    recall  f1-score   support

           0   0.678647  0.590074  0.631268       544
           1   0.513196  0.788288  0.621670       222
           2   0.277311  0.197605  0.230769       167

    accuracy                       0.566988       933
   macro avg   0.489718  0.525322  0.494569       933
weighted avg   0.567443  0.566988  0.557298       933

Test Acc: 0.5669882100750268 F1_ma:0.43101883367370086
Train step: 800 acc:0.70139 total_loss: 1.1596  loss:1.4555,stance loss: 1.0756 
Train step: 810 acc:0.7012 total_loss: 1.1611  loss:1.0241,stance loss: 0.84704 
Train step: 820 acc:0.69804 total_loss: 1.1647  loss:1.2391,stance loss: 0.9364 
Train step: 830 acc:0.69892 total_loss: 1.1575  loss:1.3348,stance loss: 0.85479 
Train step: 840 acc:0.69782 total_loss: 1.1604  loss:0.7738,stance loss: 0.55385 
Train step: 850 acc:0.69414 total_loss: 1.1607  loss:1.6573,stance loss: 1.7088 
Train step: 860 acc:0.69157 total_loss: 1.1592  loss:1.2248,stance loss: 1.0137 
Train step: 870 acc:0.69455 total_loss: 1.1498  loss:0.67755,stance loss: 0.40373 
Train step: 880 acc:0.68794 total_loss: 1.1557  loss:0.90899,stance loss: 0.75047 
Better F1! Saving model!
Saving model of best f1: 0.43166924221611724
              precision    recall  f1-score   support

           0   0.670833  0.591912  0.628906       544
           1   0.501441  0.783784  0.611599       222
           2   0.301887  0.191617  0.234432       167

    accuracy                       0.565916       933
   macro avg   0.491387  0.522437  0.491646       933
weighted avg   0.564489  0.565916  0.554180       933

Test Acc: 0.5659163987138264 F1_ma:0.43166924221611724
Train step: 890 acc:0.68873 total_loss: 1.1552  loss:1.3325,stance loss: 1.2088 
Train step: 900 acc:0.68597 total_loss: 1.1511  loss:0.96633,stance loss: 0.75756 
Train step: 910 acc:0.68714 total_loss: 1.1476  loss:0.67399,stance loss: 0.41787 
Train step: 920 acc:0.68716 total_loss: 1.148  loss:0.85056,stance loss: 0.60874 
Train step: 930 acc:0.68718 total_loss: 1.1463  loss:0.99407,stance loss: 0.77917 
Train step: 940 acc:0.68996 total_loss: 1.1461  loss:0.95484,stance loss: 0.75395 
Train step: 950 acc:0.69161 total_loss: 1.1399  loss:1.1859,stance loss: 0.91284 
Train step: 960 acc:0.69226 total_loss: 1.135  loss:1.1982,stance loss: 0.88294 
Train step: 970 acc:0.69099 total_loss: 1.1346  loss:1.1154,stance loss: 0.7422 
Train step: 980 acc:0.6929 total_loss: 1.1366  loss:2.0145,stance loss: 1.9675 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.69643 total_loss: 1.1051  loss:0.936,stance loss: 0.7781 
Train step: 1000 acc:0.71324 total_loss: 1.1045  loss:1.3858,stance loss: 1.277 
Train step: 1010 acc:0.70833 total_loss: 1.0703  loss:1.0303,stance loss: 0.80345 
Train step: 1020 acc:0.71622 total_loss: 1.0446  loss:0.71123,stance loss: 0.54963 
Train step: 1030 acc:0.72074 total_loss: 1.0478  loss:0.59635,stance loss: 0.38544 
Train step: 1040 acc:0.72588 total_loss: 1.0364  loss:1.3591,stance loss: 1.5386 
Train step: 1050 acc:0.70802 total_loss: 1.0544  loss:1.1649,stance loss: 0.91212 
Better F1! Saving model!
Saving model of best f1: 0.4525840411352511
              precision    recall  f1-score   support

           0   0.672941  0.525735  0.590299       544
           1   0.512048  0.765766  0.613718       222
           2   0.306818  0.323353  0.314869       167

    accuracy                       0.546624       933
   macro avg   0.497269  0.538285  0.506295       933
weighted avg   0.569125  0.546624  0.546572       933

Test Acc: 0.5466237942122186 F1_ma:0.4525840411352511
Train step: 1060 acc:0.71023 total_loss: 1.046  loss:0.86319,stance loss: 0.6664 
Train step: 1070 acc:0.70187 total_loss: 1.0585  loss:1.4814,stance loss: 1.5886 
Train step: 1080 acc:0.69716 total_loss: 1.066  loss:1.2849,stance loss: 1.0914 
Train step: 1090 acc:0.70269 total_loss: 1.0644  loss:0.80012,stance loss: 0.6517 
Train step: 1100 acc:0.70459 total_loss: 1.0529  loss:0.7834,stance loss: 0.63694 
Train step: 1110 acc:0.70571 total_loss: 1.067  loss:1.2316,stance loss: 0.88651 
Train step: 1120 acc:0.70392 total_loss: 1.0697  loss:1.4391,stance loss: 1.1116 
Train step: 1130 acc:0.70281 total_loss: 1.071  loss:0.92427,stance loss: 1.1399 
Train step: 1140 acc:0.70701 total_loss: 1.0679  loss:0.92316,stance loss: 0.61792 
Train step: 1150 acc:0.70322 total_loss: 1.0717  loss:0.9377,stance loss: 0.75222 
Train step: 1160 acc:0.7041 total_loss: 1.0683  loss:0.93434,stance loss: 0.60038 
Train step: 1170 acc:0.70889 total_loss: 1.0577  loss:0.85276,stance loss: 1.0454 
Train step: 1180 acc:0.70876 total_loss: 1.0628  loss:1.7286,stance loss: 1.7789 
Train step: 1190 acc:0.71045 total_loss: 1.0588  loss:1.0837,stance loss: 0.8271 
Train step: 1200 acc:0.71083 total_loss: 1.0598  loss:0.84568,stance loss: 0.64892 
Train step: 1210 acc:0.70843 total_loss: 1.0639  loss:1.5485,stance loss: 1.203 
Train step: 1220 acc:0.70965 total_loss: 1.0642  loss:1.5396,stance loss: 1.6618 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.6875 total_loss: 1.1601  loss:1.1601,stance loss: 1.055 
Train step: 1240 acc:0.76136 total_loss: 0.93706  loss:0.76583,stance loss: 0.62721 
Train step: 1250 acc:0.75298 total_loss: 0.94893  loss:0.83072,stance loss: 0.72566 
Train step: 1260 acc:0.75202 total_loss: 0.94456  loss:0.97964,stance loss: 0.87666 
Train step: 1270 acc:0.74543 total_loss: 0.97032  loss:0.95174,stance loss: 0.73236 
Train step: 1280 acc:0.74877 total_loss: 0.96244  loss:1.3226,stance loss: 1.0116 
Train step: 1290 acc:0.74283 total_loss: 0.98122  loss:1.2113,stance loss: 0.69728 
Train step: 1300 acc:0.7368 total_loss: 0.97959  loss:1.4244,stance loss: 1.0976 
Train step: 1310 acc:0.73611 total_loss: 0.97487  loss:0.78779,stance loss: 0.66776 
Train step: 1320 acc:0.73558 total_loss: 0.96622  loss:0.66058,stance loss: 0.53702 
Train step: 1330 acc:0.74629 total_loss: 0.94941  loss:0.80838,stance loss: 0.82653 
Train step: 1340 acc:0.74437 total_loss: 0.96064  loss:0.80095,stance loss: 0.59446 
Train step: 1350 acc:0.74483 total_loss: 0.95676  loss:0.9522,stance loss: 0.69948 
Train step: 1360 acc:0.74284 total_loss: 0.95665  loss:1.2703,stance loss: 1.0162 
Train step: 1370 acc:0.74379 total_loss: 0.95718  loss:0.60771,stance loss: 0.40307 
Train step: 1380 acc:0.74255 total_loss: 0.95938  loss:0.74768,stance loss: 0.61247 
Train step: 1390 acc:0.74379 total_loss: 0.95416  loss:0.69926,stance loss: 0.53268 
Train step: 1400 acc:0.74306 total_loss: 0.95695  loss:0.62402,stance loss: 0.46411 
Train step: 1410 acc:0.74102 total_loss: 0.96693  loss:1.325,stance loss: 0.97921 
Train step: 1420 acc:0.74084 total_loss: 0.96224  loss:1.1894,stance loss: 0.77327 
Train step: 1430 acc:0.73943 total_loss: 0.96575  loss:1.3852,stance loss: 0.90083 
Train step: 1440 acc:0.73993 total_loss: 0.96557  loss:0.70147,stance loss: 0.49115 
Train step: 1450 acc:0.7418 total_loss: 0.96361  loss:1.2022,stance loss: 0.95193 
Train step: 1460 acc:0.74215 total_loss: 0.96253  loss:1.0253,stance loss: 0.74675 
Train step: 1470 acc:0.74248 total_loss: 0.96039  loss:1.0986,stance loss: 0.70201 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.7125 total_loss: 1.0169  loss:1.01,stance loss: 0.78154 
Train step: 1490 acc:0.7375 total_loss: 1.0066  loss:0.97335,stance loss: 0.69342 
Train step: 1500 acc:0.745 total_loss: 0.93428  loss:0.71799,stance loss: 0.44072 
Train step: 1510 acc:0.74643 total_loss: 0.9097  loss:0.83137,stance loss: 0.69506 
Train step: 1520 acc:0.75833 total_loss: 0.88775  loss:0.76438,stance loss: 0.64287 
Train step: 1530 acc:0.7625 total_loss: 0.86749  loss:0.87728,stance loss: 1.0563 
Train step: 1540 acc:0.76442 total_loss: 0.87829  loss:1.2727,stance loss: 1.5343 
Train step: 1550 acc:0.76167 total_loss: 0.89378  loss:1.1465,stance loss: 0.92587 
Train step: 1560 acc:0.76324 total_loss: 0.89838  loss:0.73846,stance loss: 0.5029 
Train step: 1570 acc:0.76053 total_loss: 0.89732  loss:0.59728,stance loss: 0.36752 
Train step: 1580 acc:0.7619 total_loss: 0.9109  loss:1.1863,stance loss: 1.49 
Train step: 1590 acc:0.76413 total_loss: 0.90657  loss:0.62859,stance loss: 0.52716 
Train step: 1600 acc:0.761 total_loss: 0.91934  loss:0.71885,stance loss: 0.44409 
Train step: 1610 acc:0.76111 total_loss: 0.91433  loss:0.73016,stance loss: 0.43803 
Train step: 1620 acc:0.7625 total_loss: 0.91579  loss:0.54695,stance loss: 0.43023 
Train step: 1630 acc:0.76089 total_loss: 0.91289  loss:1.0952,stance loss: 0.87488 
Train step: 1640 acc:0.75871 total_loss: 0.91208  loss:1.0421,stance loss: 1.265 
Train step: 1650 acc:0.76357 total_loss: 0.90923  loss:0.80272,stance loss: 0.72793 
Train step: 1660 acc:0.76554 total_loss: 0.90418  loss:0.80418,stance loss: 0.59892 
Train step: 1670 acc:0.76571 total_loss: 0.90709  loss:1.1771,stance loss: 1.4689 
Train step: 1680 acc:0.76616 total_loss: 0.90032  loss:0.70461,stance loss: 0.45897 
Train step: 1690 acc:0.76512 total_loss: 0.89975  loss:1.3025,stance loss: 1.3549 
Train step: 1700 acc:0.76694 total_loss: 0.90047  loss:0.8451,stance loss: 0.64736 
Train step: 1710 acc:0.76463 total_loss: 0.89927  loss:1.0303,stance loss: 0.79963 
Train step: 1720 acc:0.76276 total_loss: 0.90249  loss:0.97698,stance loss: 0.7045 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.79861 total_loss: 0.73643  loss:0.46632,stance loss: 0.35126 
Train step: 1740 acc:0.75987 total_loss: 0.91411  loss:0.85284,stance loss: 0.71628 
Train step: 1750 acc:0.77802 total_loss: 0.8734  loss:0.72171,stance loss: 0.60376 
Train step: 1760 acc:0.78846 total_loss: 0.86622  loss:0.55543,stance loss: 0.37247 
Train step: 1770 acc:0.77423 total_loss: 0.87731  loss:1.0544,stance loss: 0.86228 
Train step: 1780 acc:0.78284 total_loss: 0.86629  loss:0.83164,stance loss: 0.71135 
Train step: 1790 acc:0.78714 total_loss: 0.8424  loss:0.62748,stance loss: 0.50602 
Train step: 1800 acc:0.79193 total_loss: 0.82343  loss:0.73975,stance loss: 0.82301 
Train step: 1810 acc:0.79073 total_loss: 0.82522  loss:0.42576,stance loss: 0.34709 
Train step: 1820 acc:0.79104 total_loss: 0.81476  loss:0.59467,stance loss: 0.46953 
Train step: 1830 acc:0.79358 total_loss: 0.82309  loss:1.1935,stance loss: 1.0954 
Train step: 1840 acc:0.79727 total_loss: 0.81352  loss:0.70116,stance loss: 0.59992 
Train step: 1850 acc:0.79748 total_loss: 0.81252  loss:1.1533,stance loss: 1.0592 
Train step: 1860 acc:0.79901 total_loss: 0.81199  loss:0.77786,stance loss: 0.57185 
Train step: 1870 acc:0.79824 total_loss: 0.80759  loss:1.1807,stance loss: 0.80079 
Train step: 1880 acc:0.79835 total_loss: 0.80342  loss:0.99982,stance loss: 0.89281 
Train step: 1890 acc:0.79882 total_loss: 0.8023  loss:0.72713,stance loss: 0.55544 
Train step: 1900 acc:0.79923 total_loss: 0.80829  loss:0.76163,stance loss: 0.56499 
Train step: 1910 acc:0.79795 total_loss: 0.80898  loss:0.72919,stance loss: 0.49236 
Train step: 1920 acc:0.79868 total_loss: 0.81113  loss:1.1701,stance loss: 1.5204 
Train step: 1930 acc:0.80144 total_loss: 0.80649  loss:0.52087,stance loss: 0.31461 
Train step: 1940 acc:0.8028 total_loss: 0.80663  loss:1.457,stance loss: 1.5429 
Train step: 1950 acc:0.80295 total_loss: 0.80469  loss:0.3304,stance loss: 0.19899 
Train step: 1960 acc:0.80309 total_loss: 0.8051  loss:1.4085,stance loss: 1.6766 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.85417 total_loss: 0.79091  loss:0.5905,stance loss: 0.36085 
Train step: 1980 acc:0.84135 total_loss: 0.74798  loss:0.59469,stance loss: 0.50039 
Train step: 1990 acc:0.84511 total_loss: 0.68961  loss:0.67454,stance loss: 0.52997 
Train step: 2000 acc:0.85038 total_loss: 0.6796  loss:0.642,stance loss: 0.50314 
Train step: 2010 acc:0.85174 total_loss: 0.66449  loss:0.88095,stance loss: 0.66913 
Train step: 2020 acc:0.84788 total_loss: 0.67049  loss:0.34883,stance loss: 0.2746 
Train step: 2030 acc:0.84325 total_loss: 0.69892  loss:1.1008,stance loss: 0.91254 
Train step: 2040 acc:0.83562 total_loss: 0.71326  loss:0.68896,stance loss: 0.56346 
Train step: 2050 acc:0.8366 total_loss: 0.70927  loss:0.53494,stance loss: 0.43144 
Train step: 2060 acc:0.83199 total_loss: 0.71962  loss:0.79951,stance loss: 0.6725 
Train step: 2070 acc:0.83192 total_loss: 0.72925  loss:0.66824,stance loss: 0.4733 
Train step: 2080 acc:0.82799 total_loss: 0.7343  loss:0.6495,stance loss: 0.56277 
Train step: 2090 acc:0.8252 total_loss: 0.72845  loss:0.73241,stance loss: 0.52904 
Train step: 2100 acc:0.82378 total_loss: 0.72568  loss:0.42936,stance loss: 0.23218 
Train step: 2110 acc:0.82605 total_loss: 0.71668  loss:0.7896,stance loss: 0.79067 
Train step: 2120 acc:0.82394 total_loss: 0.72582  loss:0.73738,stance loss: 0.51836 
Train step: 2130 acc:0.82132 total_loss: 0.73211  loss:1.106,stance loss: 0.87358 
Train step: 2140 acc:0.82189 total_loss: 0.73746  loss:0.69232,stance loss: 0.51951 
Train step: 2150 acc:0.8224 total_loss: 0.74196  loss:0.34855,stance loss: 0.2341 
Train step: 2160 acc:0.82157 total_loss: 0.74171  loss:0.44188,stance loss: 0.3613 
Train step: 2170 acc:0.82081 total_loss: 0.73801  loss:0.8458,stance loss: 0.57743 
Train step: 2180 acc:0.82042 total_loss: 0.74136  loss:0.71009,stance loss: 0.52697 
Train step: 2190 acc:0.82287 total_loss: 0.74012  loss:0.98152,stance loss: 0.87306 
Train step: 2200 acc:0.82538 total_loss: 0.73412  loss:0.47643,stance loss: 0.34322 
Train step: 2210 acc:0.8269 total_loss: 0.73127  loss:1.4132,stance loss: 1.3612 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.82143 total_loss: 0.8456  loss:1.0967,stance loss: 1.1391 
Train step: 2230 acc:0.85294 total_loss: 0.76834  loss:0.9873,stance loss: 1.3987 
Train step: 2240 acc:0.85648 total_loss: 0.73032  loss:0.77848,stance loss: 1.1066 
Train step: 2250 acc:0.85642 total_loss: 0.76542  loss:0.57482,stance loss: 0.49609 
Train step: 2260 acc:0.86436 total_loss: 0.73658  loss:1.0007,stance loss: 1.4345 
Train step: 2270 acc:0.86513 total_loss: 0.70403  loss:0.8188,stance loss: 0.67785 
Train step: 2280 acc:0.85541 total_loss: 0.70697  loss:0.62184,stance loss: 0.59216 
Train step: 2290 acc:0.85714 total_loss: 0.67834  loss:0.68631,stance loss: 0.8072 
Train step: 2300 acc:0.85417 total_loss: 0.67815  loss:0.66801,stance loss: 0.46386 
Train step: 2310 acc:0.84794 total_loss: 0.68234  loss:0.75215,stance loss: 0.5048 
Train step: 2320 acc:0.84813 total_loss: 0.67718  loss:0.70824,stance loss: 0.59256 
Train step: 2330 acc:0.84936 total_loss: 0.6655  loss:0.4763,stance loss: 0.34551 
Train step: 2340 acc:0.84646 total_loss: 0.6623  loss:0.37051,stance loss: 0.30982 
Train step: 2350 acc:0.8458 total_loss: 0.66291  loss:0.27855,stance loss: 0.16923 
Train step: 2360 acc:0.84524 total_loss: 0.65793  loss:0.56217,stance loss: 0.43866 
Train step: 2370 acc:0.84873 total_loss: 0.64928  loss:0.92488,stance loss: 0.75302 
Train step: 2380 acc:0.84805 total_loss: 0.64604  loss:0.86919,stance loss: 0.58113 
Train step: 2390 acc:0.84746 total_loss: 0.64717  loss:0.81574,stance loss: 0.59902 
Train step: 2400 acc:0.84592 total_loss: 0.64351  loss:0.62236,stance loss: 0.51541 
Train step: 2410 acc:0.84772 total_loss: 0.64271  loss:0.48729,stance loss: 0.3639 
Train step: 2420 acc:0.84813 total_loss: 0.64283  loss:0.41748,stance loss: 0.26419 
Train step: 2430 acc:0.8485 total_loss: 0.63623  loss:0.51047,stance loss: 0.353 
Train step: 2440 acc:0.84994 total_loss: 0.63605  loss:0.38764,stance loss: 0.28499 
Train step: 2450 acc:0.84916 total_loss: 0.63329  loss:0.45926,stance loss: 0.41608 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.875 total_loss: 0.44856  loss:0.44856,stance loss: 0.37801 
Train step: 2470 acc:0.84659 total_loss: 0.56184  loss:0.27315,stance loss: 0.22714 
Train step: 2480 acc:0.86905 total_loss: 0.52551  loss:0.45117,stance loss: 0.35169 
Train step: 2490 acc:0.86694 total_loss: 0.52904  loss:0.7447,stance loss: 0.65809 
Train step: 2500 acc:0.86738 total_loss: 0.54291  loss:0.47392,stance loss: 0.36753 
Train step: 2510 acc:0.86765 total_loss: 0.53678  loss:0.70657,stance loss: 0.57467 
Train step: 2520 acc:0.86475 total_loss: 0.54712  loss:0.14666,stance loss: 0.083418 
Train step: 2530 acc:0.86444 total_loss: 0.56292  loss:0.9681,stance loss: 1.0134 
Train step: 2540 acc:0.86651 total_loss: 0.56292  loss:0.86385,stance loss: 1.0925 
Train step: 2550 acc:0.86676 total_loss: 0.55957  loss:0.5476,stance loss: 0.4721 
Train step: 2560 acc:0.86881 total_loss: 0.55761  loss:0.3429,stance loss: 0.32919 
Train step: 2570 acc:0.86768 total_loss: 0.56367  loss:0.39157,stance loss: 0.3012 
Train step: 2580 acc:0.8719 total_loss: 0.55308  loss:0.44083,stance loss: 0.36794 
Train step: 2590 acc:0.87405 total_loss: 0.55227  loss:0.58018,stance loss: 0.44152 
Train step: 2600 acc:0.8781 total_loss: 0.55023  loss:1.2655,stance loss: 1.3847 
Train step: 2610 acc:0.87831 total_loss: 0.55066  loss:0.46208,stance loss: 0.30184 
Train step: 2620 acc:0.875 total_loss: 0.55561  loss:0.78757,stance loss: 0.56618 
Train step: 2630 acc:0.87646 total_loss: 0.55628  loss:0.28358,stance loss: 0.097958 
Train step: 2640 acc:0.87604 total_loss: 0.55631  loss:0.36487,stance loss: 0.26267 
Train step: 2650 acc:0.87467 total_loss: 0.55245  loss:0.62137,stance loss: 0.50334 
Train step: 2660 acc:0.87624 total_loss: 0.54926  loss:0.36591,stance loss: 0.295 
Train step: 2670 acc:0.87559 total_loss: 0.55687  loss:0.81188,stance loss: 1.1523 
Train step: 2680 acc:0.87613 total_loss: 0.55931  loss:0.83749,stance loss: 0.77047 
Train step: 2690 acc:0.875 total_loss: 0.5594  loss:0.56031,stance loss: 0.56395 
Train step: 2700 acc:0.87604 total_loss: 0.55692  loss:0.13322,stance loss: 0.022465 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.8625 total_loss: 0.49809  loss:0.49579,stance loss: 0.46828 
Train step: 2720 acc:0.91667 total_loss: 0.48437  loss:0.23138,stance loss: 0.20228 
Train step: 2730 acc:0.925 total_loss: 0.45359  loss:0.30817,stance loss: 0.23422 
Train step: 2740 acc:0.91786 total_loss: 0.48266  loss:0.34677,stance loss: 0.2927 
Train step: 2750 acc:0.91667 total_loss: 0.48816  loss:0.18879,stance loss: 0.11204 
Train step: 2760 acc:0.91932 total_loss: 0.46839  loss:0.48861,stance loss: 0.31969 
Train step: 2770 acc:0.91635 total_loss: 0.47396  loss:0.57143,stance loss: 0.44071 
Train step: 2780 acc:0.91833 total_loss: 0.463  loss:0.47123,stance loss: 0.37192 
Train step: 2790 acc:0.91029 total_loss: 0.47483  loss:0.79087,stance loss: 1.2465 
Train step: 2800 acc:0.91053 total_loss: 0.48009  loss:0.82926,stance loss: 1.2426 
Train step: 2810 acc:0.9119 total_loss: 0.46699  loss:0.49204,stance loss: 0.30747 
Train step: 2820 acc:0.91304 total_loss: 0.45384  loss:0.22718,stance loss: 0.18073 
Train step: 2830 acc:0.915 total_loss: 0.44784  loss:0.085768,stance loss: 0.03741 
Train step: 2840 acc:0.91528 total_loss: 0.44711  loss:0.88954,stance loss: 1.1057 
Train step: 2850 acc:0.91422 total_loss: 0.45346  loss:0.35013,stance loss: 0.29883 
Train step: 2860 acc:0.91573 total_loss: 0.45376  loss:0.85911,stance loss: 1.3538 
Train step: 2870 acc:0.9125 total_loss: 0.46452  loss:0.87939,stance loss: 1.2701 
Train step: 2880 acc:0.91107 total_loss: 0.46765  loss:0.53967,stance loss: 0.48277 
Train step: 2890 acc:0.9098 total_loss: 0.46856  loss:0.2417,stance loss: 0.20697 
Train step: 2900 acc:0.90801 total_loss: 0.46696  loss:0.25452,stance loss: 0.21155 
Train step: 2910 acc:0.90701 total_loss: 0.47224  loss:0.5787,stance loss: 0.24552 
Train step: 2920 acc:0.90698 total_loss: 0.47369  loss:0.55535,stance loss: 0.418 
Train step: 2930 acc:0.90611 total_loss: 0.47143  loss:0.28943,stance loss: 0.27538 
Train step: 2940 acc:0.90585 total_loss: 0.475  loss:0.49541,stance loss: 0.40395 
Train step: 2950 acc:0.90536 total_loss: 0.47417  loss:0.55785,stance loss: 0.4541 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.875 total_loss: 0.49856  loss:0.401,stance loss: 0.32056 
Train step: 2970 acc:0.89803 total_loss: 0.45665  loss:0.24479,stance loss: 0.15633 
Train step: 2980 acc:0.90948 total_loss: 0.41752  loss:0.24959,stance loss: 0.16691 
Train step: 2990 acc:0.91346 total_loss: 0.39493  loss:0.18365,stance loss: 0.12157 
Train step: 3000 acc:0.91837 total_loss: 0.38404  loss:0.32868,stance loss: 0.28731 
Train step: 3010 acc:0.92267 total_loss: 0.39207  loss:0.29045,stance loss: 0.27797 
Train step: 3020 acc:0.9221 total_loss: 0.38929  loss:0.2487,stance loss: 0.17494 
Train step: 3030 acc:0.92405 total_loss: 0.39041  loss:0.29234,stance loss: 0.21931 
Train step: 3040 acc:0.92486 total_loss: 0.40123  loss:0.33622,stance loss: 0.29421 
Train step: 3050 acc:0.92424 total_loss: 0.40218  loss:0.45152,stance loss: 0.27773 
Train step: 3060 acc:0.92374 total_loss: 0.39841  loss:0.3094,stance loss: 0.18658 
Train step: 3070 acc:0.92489 total_loss: 0.38952  loss:0.27924,stance loss: 0.1494 
Train step: 3080 acc:0.92442 total_loss: 0.38617  loss:0.35644,stance loss: 0.31863 
Train step: 3090 acc:0.92086 total_loss: 0.39782  loss:0.62116,stance loss: 0.40804 
Train step: 3100 acc:0.92156 total_loss: 0.39387  loss:0.16256,stance loss: 0.10802 
Train step: 3110 acc:0.91824 total_loss: 0.39501  loss:0.51773,stance loss: 0.35141 
Train step: 3120 acc:0.91827 total_loss: 0.39665  loss:1.3266,stance loss: 0.7058 
Train step: 3130 acc:0.91899 total_loss: 0.39197  loss:0.21198,stance loss: 0.17922 
Train step: 3140 acc:0.9203 total_loss: 0.38723  loss:0.3094,stance loss: 0.30341 
Train step: 3150 acc:0.9218 total_loss: 0.38841  loss:0.34605,stance loss: 0.14178 
Train step: 3160 acc:0.92315 total_loss: 0.38394  loss:0.06101,stance loss: 0.014176 
Train step: 3170 acc:0.9218 total_loss: 0.39106  loss:0.08161,stance loss: 0.035917 
Train step: 3180 acc:0.92194 total_loss: 0.39457  loss:0.82581,stance loss: 1.2618 
Train step: 3190 acc:0.92103 total_loss: 0.39486  loss:0.1423,stance loss: 0.056371 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.95833 total_loss: 0.27971  loss:0.38114,stance loss: 0.34348 
Train step: 3210 acc:0.94231 total_loss: 0.28844  loss:0.15702,stance loss: 0.17027 
Train step: 3220 acc:0.9375 total_loss: 0.3129  loss:0.23897,stance loss: 0.20781 
Train step: 3230 acc:0.93371 total_loss: 0.34151  loss:0.19198,stance loss: 0.12862 
Train step: 3240 acc:0.94186 total_loss: 0.31729  loss:0.26854,stance loss: 0.16031 
Train step: 3250 acc:0.93632 total_loss: 0.34439  loss:0.1205,stance loss: 0.066039 
Train step: 3260 acc:0.93155 total_loss: 0.36587  loss:0.43301,stance loss: 0.43565 
Train step: 3270 acc:0.92723 total_loss: 0.36729  loss:0.28636,stance loss: 0.21497 
Train step: 3280 acc:0.92696 total_loss: 0.36716  loss:0.22977,stance loss: 0.24587 
Train step: 3290 acc:0.92944 total_loss: 0.3618  loss:0.048993,stance loss: 0.008662 
Train step: 3300 acc:0.92961 total_loss: 0.37065  loss:0.3153,stance loss: 0.27744 
Better F1! Saving model!
Saving model of best f1: 0.453214735957417
              precision    recall  f1-score   support

           0   0.660000  0.485294  0.559322       544
           1   0.492582  0.747748  0.593918       222
           2   0.321429  0.377246  0.347107       167

    accuracy                       0.528403       933
   macro avg   0.491337  0.536762  0.500116       933
weighted avg   0.559562  0.528403  0.529569       933

Test Acc: 0.5284030010718114 F1_ma:0.453214735957417
Train step: 3310 acc:0.9292 total_loss: 0.37507  loss:1.0443,stance loss: 0.97306 
Better F1! Saving model!
Saving model of best f1: 0.4560217176702862
              precision    recall  f1-score   support

           0   0.660981  0.569853  0.612043       544
           1   0.517685  0.725225  0.604128       222
           2   0.313725  0.287425  0.300000       167

    accuracy                       0.556270       933
   macro avg   0.497464  0.527501  0.505390       933
weighted avg   0.564729  0.556270  0.554306       933

Test Acc: 0.5562700964630225 F1_ma:0.4560217176702862
Train step: 3320 acc:0.92988 total_loss: 0.37647  loss:0.16932,stance loss: 0.086091 
Train step: 3330 acc:0.93186 total_loss: 0.37025  loss:0.2738,stance loss: 0.15292 
Train step: 3340 acc:0.93313 total_loss: 0.36711  loss:0.10437,stance loss: 0.062076 
Train step: 3350 acc:0.93423 total_loss: 0.36273  loss:0.48514,stance loss: 0.35481 
Train step: 3360 acc:0.9352 total_loss: 0.35986  loss:0.10403,stance loss: 0.060504 
Train step: 3370 acc:0.93316 total_loss: 0.36676  loss:0.93754,stance loss: 1.3286 
Train step: 3380 acc:0.93306 total_loss: 0.36937  loss:0.36861,stance loss: 0.31862 
Train step: 3390 acc:0.93459 total_loss: 0.36317  loss:0.28186,stance loss: 0.24532 
Train step: 3400 acc:0.93381 total_loss: 0.36285  loss:0.11221,stance loss: 0.09053 
Train step: 3410 acc:0.93251 total_loss: 0.36716  loss:0.71124,stance loss: 1.0478 
Train step: 3420 acc:0.93414 total_loss: 0.36184  loss:0.27286,stance loss: 0.20386 
Train step: 3430 acc:0.93455 total_loss: 0.35893  loss:0.94789,stance loss: 0.58308 
Train step: 3440 acc:0.9357 total_loss: 0.35795  loss:0.2338,stance loss: 0.24748 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.97321 total_loss: 0.23222  loss:0.15513,stance loss: 0.131 
Train step: 3460 acc:0.97059 total_loss: 0.20564  loss:0.37384,stance loss: 0.31976 
Train step: 3470 acc:0.94444 total_loss: 0.31647  loss:0.27778,stance loss: 0.23888 
Train step: 3480 acc:0.94595 total_loss: 0.35839  loss:0.64584,stance loss: 1.0295 
Train step: 3490 acc:0.94814 total_loss: 0.39922  loss:0.09969,stance loss: 0.057406 
Train step: 3500 acc:0.94627 total_loss: 0.37656  loss:0.46072,stance loss: 0.34374 
Train step: 3510 acc:0.95056 total_loss: 0.36135  loss:0.62206,stance loss: 0.6902 
Train step: 3520 acc:0.95049 total_loss: 0.36021  loss:0.65078,stance loss: 1.0355 
Train step: 3530 acc:0.94899 total_loss: 0.34831  loss:0.34245,stance loss: 0.30746 
Train step: 3540 acc:0.94716 total_loss: 0.33884  loss:0.10534,stance loss: 0.076174 
Train step: 3550 acc:0.94685 total_loss: 0.34264  loss:0.26591,stance loss: 0.031915 
Train step: 3560 acc:0.94765 total_loss: 0.33415  loss:0.34515,stance loss: 0.3242 
Train step: 3570 acc:0.94833 total_loss: 0.32713  loss:0.26161,stance loss: 0.059652 
Train step: 3580 acc:0.94799 total_loss: 0.32539  loss:0.18085,stance loss: 0.15581 
Train step: 3590 acc:0.94728 total_loss: 0.33262  loss:0.37477,stance loss: 0.26109 
Train step: 3600 acc:0.94904 total_loss: 0.32687  loss:0.035667,stance loss: 0.0050497 
Train step: 3610 acc:0.94835 total_loss: 0.32629  loss:0.32695,stance loss: 0.25194 
Train step: 3620 acc:0.9488 total_loss: 0.32329  loss:0.26886,stance loss: 0.25569 
Train step: 3630 acc:0.9492 total_loss: 0.32224  loss:0.12357,stance loss: 0.045284 
Train step: 3640 acc:0.94829 total_loss: 0.32316  loss:0.30362,stance loss: 0.28173 
Train step: 3650 acc:0.94716 total_loss: 0.32248  loss:0.42026,stance loss: 0.33504 
Train step: 3660 acc:0.94787 total_loss: 0.3197  loss:0.47709,stance loss: 0.33735 
Train step: 3670 acc:0.94824 total_loss: 0.3178  loss:0.31599,stance loss: 0.32981 
Train step: 3680 acc:0.94778 total_loss: 0.31584  loss:0.16451,stance loss: 0.033875 
Training finished.


Reload the best model with best f1 0.4560217176702862 from path test_outputs/bert-cross-topic/la/2023-08-14 15-44-15/state_dict


              precision    recall  f1-score   support

           0   0.660981  0.569853  0.612043       544
           1   0.517685  0.725225  0.604128       222
           2   0.313725  0.287425  0.300000       167

    accuracy                       0.556270       933
   macro avg   0.497464  0.527501  0.505390       933
weighted avg   0.564729  0.556270  0.554306       933

Test Acc: 0.5562700964630225 F1_ma:0.4560217176702862
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4560217176702862
acc: 0.5562700964630225, f1 :0.5053903383593028
classification report: 
              precision    recall  f1-score   support

         Con     0.6610    0.5699    0.6120       544
        None     0.5177    0.7252    0.6041       222
         Pro     0.3137    0.2874    0.3000       167

    accuracy                         0.5563       933
   macro avg     0.4975    0.5275    0.5054       933
weighted avg     0.5647    0.5563    0.5543       933

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 16-21-57', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 16-21-57
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.5594  loss:1.5594,stance loss: 1.0214 
Train step: 10 acc:0.40341 total_loss: 1.7082  loss:1.7369,stance loss: 1.2516 
Better F1! Saving model!
Saving model of best f1: 0.37133105802047783
              precision    recall  f1-score   support

           0   0.590662  1.000000  0.742662       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.196887  0.333333  0.247554       933
weighted avg   0.344395  0.583065  0.433021       933

Test Acc: 0.5830653804930332 F1_ma:0.37133105802047783
Train step: 20 acc:0.4375 total_loss: 1.6945  loss:1.8911,stance loss: 1.3855 
Train step: 30 acc:0.43548 total_loss: 1.6724  loss:1.7419,stance loss: 1.1788 
Train step: 40 acc:0.44207 total_loss: 1.6769  loss:1.6805,stance loss: 1.2041 
Train step: 50 acc:0.45956 total_loss: 1.6604  loss:1.5711,stance loss: 1.1145 
Train step: 60 acc:0.46004 total_loss: 1.6587  loss:1.9356,stance loss: 1.7949 
Train step: 70 acc:0.46743 total_loss: 1.649  loss:1.7174,stance loss: 1.1475 
Train step: 80 acc:0.46991 total_loss: 1.6446  loss:1.4441,stance loss: 0.99922 
Train step: 90 acc:0.47527 total_loss: 1.6406  loss:1.4776,stance loss: 0.89751 
Train step: 100 acc:0.48329 total_loss: 1.6362  loss:1.3798,stance loss: 1.0258 
Train step: 110 acc:0.47973 total_loss: 1.6362  loss:1.4008,stance loss: 1.0483 
Train step: 120 acc:0.47521 total_loss: 1.638  loss:1.5259,stance loss: 1.0874 
Train step: 130 acc:0.47805 total_loss: 1.628  loss:1.6717,stance loss: 1.0508 
Train step: 140 acc:0.48626 total_loss: 1.6219  loss:1.4483,stance loss: 0.89429 
Train step: 150 acc:0.48593 total_loss: 1.6204  loss:1.4923,stance loss: 1.0323 
Train step: 160 acc:0.48952 total_loss: 1.6145  loss:1.4211,stance loss: 1.0129 
Train step: 170 acc:0.49086 total_loss: 1.6136  loss:1.4225,stance loss: 1.0866 
Train step: 180 acc:0.49689 total_loss: 1.6075  loss:1.8368,stance loss: 1.6329 
Train step: 190 acc:0.49902 total_loss: 1.6056  loss:1.5129,stance loss: 1.2076 
Train step: 200 acc:0.5028 total_loss: 1.6  loss:1.2686,stance loss: 0.82984 
Train step: 210 acc:0.50504 total_loss: 1.5916  loss:1.6339,stance loss: 1.1381 
Train step: 220 acc:0.50848 total_loss: 1.5834  loss:1.3216,stance loss: 0.99327 
Train step: 230 acc:0.51082 total_loss: 1.5806  loss:1.7947,stance loss: 1.8222 
Train step: 240 acc:0.51011 total_loss: 1.5783  loss:1.4798,stance loss: 1.0791 
Better F1! Saving model!
Saving model of best f1: 0.3715170278637771
              precision    recall  f1-score   support

           0   0.641711  0.882353  0.743034       544
           1   0.606557  0.500000  0.548148       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.633441       933
   macro avg   0.416090  0.460784  0.430394       933
weighted avg   0.518485  0.633441  0.563665       933

Test Acc: 0.6334405144694534 F1_ma:0.3715170278637771
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.55 total_loss: 1.407  loss:1.4139,stance loss: 1.1307 
Better F1! Saving model!
Saving model of best f1: 0.3739653875094055
              precision    recall  f1-score   support

           0   0.633121  0.913603  0.747931       544
           1   0.627586  0.409910  0.495913       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.630225       933
   macro avg   0.420236  0.441171  0.414615       933
weighted avg   0.518480  0.630225  0.554091       933

Test Acc: 0.6302250803858521 F1_ma:0.3739653875094055
Train step: 260 acc:0.55833 total_loss: 1.3705  loss:1.7914,stance loss: 1.5472 
Better F1! Saving model!
Saving model of best f1: 0.3758439609902476
              precision    recall  f1-score   support

           0   0.634981  0.920956  0.751688       544
           1   0.596330  0.292793  0.392749       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.606645       933
   macro avg   0.410437  0.404583  0.381479       933
weighted avg   0.512128  0.606645  0.531735       933

Test Acc: 0.6066452304394426 F1_ma:0.3758439609902476
Train step: 270 acc:0.5675 total_loss: 1.4454  loss:1.6081,stance loss: 1.1017 
Train step: 280 acc:0.58393 total_loss: 1.4311  loss:1.5174,stance loss: 1.3261 
Train step: 290 acc:0.59306 total_loss: 1.4362  loss:1.4692,stance loss: 1.113 
Train step: 300 acc:0.58409 total_loss: 1.4456  loss:1.5699,stance loss: 1.0898 
Train step: 310 acc:0.59038 total_loss: 1.4481  loss:1.3811,stance loss: 1.0725 
Train step: 320 acc:0.60333 total_loss: 1.44  loss:1.3791,stance loss: 1.4923 
Train step: 330 acc:0.59926 total_loss: 1.4331  loss:1.444,stance loss: 1.6626 
Train step: 340 acc:0.59474 total_loss: 1.4193  loss:1.3102,stance loss: 1.0282 
Train step: 350 acc:0.59524 total_loss: 1.4193  loss:1.5647,stance loss: 1.1702 
Train step: 360 acc:0.59946 total_loss: 1.4178  loss:1.3256,stance loss: 1.0141 
Train step: 370 acc:0.599 total_loss: 1.4113  loss:0.86436,stance loss: 0.44779 
Train step: 380 acc:0.60093 total_loss: 1.405  loss:1.5114,stance loss: 1.1304 
Better F1! Saving model!
Saving model of best f1: 0.37692307692307697
              precision    recall  f1-score   support

           0   0.648148  0.900735  0.753846       544
           1   0.661017  0.527027  0.586466       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.650589       933
   macro avg   0.436388  0.475921  0.446771       933
weighted avg   0.535197  0.650589  0.579087       933

Test Acc: 0.6505894962486602 F1_ma:0.37692307692307697
Train step: 390 acc:0.59914 total_loss: 1.4014  loss:1.1637,stance loss: 0.75726 
Train step: 400 acc:0.59556 total_loss: 1.4016  loss:1.3646,stance loss: 1.0066 
Train step: 410 acc:0.5947 total_loss: 1.4019  loss:1.3526,stance loss: 1.073 
Train step: 420 acc:0.595 total_loss: 1.4009  loss:1.4556,stance loss: 1.091 
Train step: 430 acc:0.59527 total_loss: 1.3993  loss:1.5139,stance loss: 1.3567 
Train step: 440 acc:0.59487 total_loss: 1.4006  loss:1.4538,stance loss: 1.1756 
Train step: 450 acc:0.59787 total_loss: 1.4018  loss:1.2779,stance loss: 1.0363 
Train step: 460 acc:0.59884 total_loss: 1.3979  loss:1.3341,stance loss: 0.93929 
Train step: 470 acc:0.59917 total_loss: 1.3958  loss:1.1896,stance loss: 0.83334 
Train step: 480 acc:0.59894 total_loss: 1.3951  loss:1.4751,stance loss: 1.0922 
Train step: 490 acc:0.60051 total_loss: 1.3919  loss:1.2223,stance loss: 0.97565 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.63194 total_loss: 1.3294  loss:1.2177,stance loss: 1.0417 
Train step: 510 acc:0.67105 total_loss: 1.293  loss:1.2101,stance loss: 0.93454 
Train step: 520 acc:0.66379 total_loss: 1.289  loss:1.5927,stance loss: 1.165 
Train step: 530 acc:0.66506 total_loss: 1.2852  loss:1.3414,stance loss: 0.89178 
Train step: 540 acc:0.66071 total_loss: 1.2928  loss:1.1954,stance loss: 0.90649 
Train step: 550 acc:0.64831 total_loss: 1.3073  loss:1.3145,stance loss: 1.045 
Train step: 560 acc:0.64583 total_loss: 1.3028  loss:1.193,stance loss: 0.81257 
Better F1! Saving model!
Saving model of best f1: 0.40244696500775734
              precision    recall  f1-score   support

           0   0.696517  0.514706  0.591966       544
           1   0.429885  0.842342  0.569254       222
           2   0.291667  0.167665  0.212928       167

    accuracy                       0.530547       933
   macro avg   0.472690  0.508238  0.458049       933
weighted avg   0.560609  0.530547  0.518717       933

Test Acc: 0.5305466237942122 F1_ma:0.40244696500775734
Train step: 570 acc:0.64557 total_loss: 1.2992  loss:1.1947,stance loss: 0.94552 
Train step: 580 acc:0.64958 total_loss: 1.292  loss:1.2355,stance loss: 0.96619 
Train step: 590 acc:0.65278 total_loss: 1.2965  loss:1.129,stance loss: 0.70996 
Train step: 600 acc:0.64622 total_loss: 1.3031  loss:1.8593,stance loss: 1.8927 
Train step: 610 acc:0.65284 total_loss: 1.2931  loss:1.0683,stance loss: 0.69267 
Train step: 620 acc:0.65504 total_loss: 1.2859  loss:1.1975,stance loss: 1.0269 
Train step: 630 acc:0.65692 total_loss: 1.2767  loss:1.2708,stance loss: 1.0552 
Train step: 640 acc:0.65898 total_loss: 1.2661  loss:1.4173,stance loss: 1.549 
Train step: 650 acc:0.66313 total_loss: 1.2622  loss:1.2576,stance loss: 0.86903 
Train step: 660 acc:0.66272 total_loss: 1.262  loss:1.4867,stance loss: 1.0692 
Train step: 670 acc:0.66166 total_loss: 1.2583  loss:0.8839,stance loss: 0.40094 
Better F1! Saving model!
Saving model of best f1: 0.4299093437764445
              precision    recall  f1-score   support

           0   0.671210  0.724265  0.696729       544
           1   0.560714  0.707207  0.625498       222
           2   0.287879  0.113772  0.163090       167

    accuracy                       0.610932       933
   macro avg   0.506601  0.515081  0.495106       933
weighted avg   0.576305  0.610932  0.584263       933

Test Acc: 0.6109324758842444 F1_ma:0.4299093437764445
Train step: 680 acc:0.66071 total_loss: 1.2619  loss:1.4792,stance loss: 1.1547 
Train step: 690 acc:0.66175 total_loss: 1.2596  loss:1.3244,stance loss: 1.0498 
Train step: 700 acc:0.6576 total_loss: 1.2602  loss:1.2574,stance loss: 0.98868 
Train step: 710 acc:0.65811 total_loss: 1.2595  loss:1.1361,stance loss: 0.83619 
Train step: 720 acc:0.65939 total_loss: 1.2559  loss:1.3855,stance loss: 0.92736 
Train step: 730 acc:0.66109 total_loss: 1.2533  loss:0.98918,stance loss: 0.60805 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.66667 total_loss: 1.2178  loss:1.0783,stance loss: 0.576 
Train step: 750 acc:0.67308 total_loss: 1.2285  loss:1.4231,stance loss: 1.2599 
Train step: 760 acc:0.67935 total_loss: 1.1636  loss:1.4748,stance loss: 1.1908 
Better F1! Saving model!
Saving model of best f1: 0.4307672101619228
              precision    recall  f1-score   support

           0   0.677758  0.711397  0.694170       544
           1   0.551724  0.720721  0.625000       222
           2   0.277778  0.119760  0.167364       167

    accuracy                       0.607717       933
   macro avg   0.502420  0.517293  0.495511       933
weighted avg   0.576176  0.607717  0.583417       933

Test Acc: 0.6077170418006431 F1_ma:0.4307672101619228
Train step: 770 acc:0.68939 total_loss: 1.1396  loss:1.0206,stance loss: 0.55347 
Train step: 780 acc:0.68169 total_loss: 1.1599  loss:1.2697,stance loss: 1.1905 
Train step: 790 acc:0.67925 total_loss: 1.162  loss:1.3948,stance loss: 1.1387 
Train step: 800 acc:0.6756 total_loss: 1.1699  loss:1.5539,stance loss: 1.0912 
Train step: 810 acc:0.67295 total_loss: 1.1669  loss:0.91748,stance loss: 0.64217 
Train step: 820 acc:0.6747 total_loss: 1.1719  loss:1.2287,stance loss: 1.0328 
Train step: 830 acc:0.67272 total_loss: 1.1684  loss:0.80097,stance loss: 0.61491 
Better F1! Saving model!
Saving model of best f1: 0.465024721593272
              precision    recall  f1-score   support

           0   0.689805  0.584559  0.632836       544
           1   0.525316  0.747748  0.617100       222
           2   0.307692  0.287425  0.297214       167

    accuracy                       0.570204       933
   macro avg   0.507605  0.539911  0.515717       933
weighted avg   0.582271  0.570204  0.569018       933

Test Acc: 0.5702036441586281 F1_ma:0.465024721593272
Train step: 840 acc:0.67051 total_loss: 1.1716  loss:1.4113,stance loss: 1.0211 
Train step: 850 acc:0.67035 total_loss: 1.174  loss:1.0502,stance loss: 0.83178 
Train step: 860 acc:0.67022 total_loss: 1.1699  loss:0.90517,stance loss: 0.57868 
Train step: 870 acc:0.67716 total_loss: 1.1636  loss:0.73001,stance loss: 0.49122 
Train step: 880 acc:0.67788 total_loss: 1.1674  loss:1.4269,stance loss: 1.5895 
Better F1! Saving model!
Saving model of best f1: 0.4655205218809459
              precision    recall  f1-score   support

           0   0.666667  0.720588  0.692580       544
           1   0.579365  0.657658  0.616034       222
           2   0.333333  0.185629  0.238462       167

    accuracy                       0.609861       933
   macro avg   0.526455  0.521292  0.515692       933
weighted avg   0.586230  0.609861  0.593082       933

Test Acc: 0.609860664523044 F1_ma:0.4655205218809459
Train step: 890 acc:0.6732 total_loss: 1.1717  loss:1.4224,stance loss: 1.1398 
Better F1! Saving model!
Saving model of best f1: 0.4778268756195819
              precision    recall  f1-score   support

           0   0.660643  0.604779  0.631478       544
           1   0.592437  0.635135  0.613043       222
           2   0.299492  0.353293  0.324176       167

    accuracy                       0.566988       933
   macro avg   0.517524  0.531069  0.522899       933
weighted avg   0.579770  0.566988  0.572087       933

Test Acc: 0.5669882100750268 F1_ma:0.4778268756195819
Train step: 900 acc:0.67523 total_loss: 1.1597  loss:0.88391,stance loss: 0.65372 
Train step: 910 acc:0.67269 total_loss: 1.1551  loss:0.64675,stance loss: 0.44201 
Train step: 920 acc:0.6752 total_loss: 1.1524  loss:0.81805,stance loss: 0.52906 
Train step: 930 acc:0.67811 total_loss: 1.1515  loss:1.1729,stance loss: 0.77513 
Train step: 940 acc:0.67796 total_loss: 1.1582  loss:1.2095,stance loss: 0.986 
Train step: 950 acc:0.67899 total_loss: 1.1583  loss:0.81285,stance loss: 0.61575 
Train step: 960 acc:0.67853 total_loss: 1.1583  loss:1.0058,stance loss: 0.58932 
Train step: 970 acc:0.67892 total_loss: 1.1564  loss:1.2304,stance loss: 0.96881 
Train step: 980 acc:0.68107 total_loss: 1.1568  loss:1.4156,stance loss: 1.2265 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.77679 total_loss: 1.0039  loss:1.1199,stance loss: 0.85492 
Train step: 1000 acc:0.71324 total_loss: 1.0644  loss:1.1373,stance loss: 0.92489 
Train step: 1010 acc:0.71296 total_loss: 1.082  loss:0.88441,stance loss: 0.70798 
Train step: 1020 acc:0.71453 total_loss: 1.0505  loss:0.97487,stance loss: 0.75466 
Train step: 1030 acc:0.69947 total_loss: 1.074  loss:1.2861,stance loss: 0.94213 
Train step: 1040 acc:0.70285 total_loss: 1.0507  loss:1.2514,stance loss: 1.567 
Train step: 1050 acc:0.70709 total_loss: 1.0568  loss:0.88659,stance loss: 0.69544 
Train step: 1060 acc:0.70373 total_loss: 1.0681  loss:2.3033,stance loss: 2.3147 
Train step: 1070 acc:0.7069 total_loss: 1.0597  loss:1.2688,stance loss: 0.96006 
Train step: 1080 acc:0.70619 total_loss: 1.0686  loss:1.1296,stance loss: 1.0152 
Better F1! Saving model!
Saving model of best f1: 0.4853433366926703
              precision    recall  f1-score   support

           0   0.675045  0.691176  0.683015       544
           1   0.589641  0.666667  0.625793       222
           2   0.336000  0.251497  0.287671       167

    accuracy                       0.606645       933
   macro avg   0.533562  0.536447  0.532160       933
weighted avg   0.594037  0.606645  0.598636       933

Test Acc: 0.6066452304394426 F1_ma:0.4853433366926703
Train step: 1090 acc:0.71203 total_loss: 1.0565  loss:0.89724,stance loss: 0.83766 
Better F1! Saving model!
Saving model of best f1: 0.48583726646433645
              precision    recall  f1-score   support

           0   0.674584  0.522059  0.588601       544
           1   0.600000  0.621622  0.610619       222
           2   0.304965  0.514970  0.383073       167

    accuracy                       0.544480       933
   macro avg   0.526516  0.552884  0.527431       933
weighted avg   0.590678  0.544480  0.557052       933

Test Acc: 0.5444801714898178 F1_ma:0.48583726646433645
Train step: 1100 acc:0.71047 total_loss: 1.0617  loss:1.2983,stance loss: 1.0538 
Train step: 1110 acc:0.71358 total_loss: 1.0565  loss:1.2498,stance loss: 1.0968 
Train step: 1120 acc:0.71168 total_loss: 1.056  loss:1.036,stance loss: 0.70224 
Train step: 1130 acc:0.71259 total_loss: 1.0606  loss:1.0981,stance loss: 0.87064 
Better F1! Saving model!
Saving model of best f1: 0.4920758503754455
              precision    recall  f1-score   support

           0   0.695745  0.601103  0.644970       544
           1   0.552083  0.716216  0.623529       222
           2   0.331429  0.347305  0.339181       167

    accuracy                       0.583065       933
   macro avg   0.526419  0.554875  0.535894       933
weighted avg   0.596352  0.583065  0.585135       933

Test Acc: 0.5830653804930332 F1_ma:0.4920758503754455
Train step: 1140 acc:0.71537 total_loss: 1.0583  loss:0.8895,stance loss: 0.76921 
Better F1! Saving model!
Saving model of best f1: 0.5096477481407284
              precision    recall  f1-score   support

           0   0.660900  0.702206  0.680927       544
           1   0.643979  0.554054  0.595642       222
           2   0.341463  0.335329  0.338369       167

    accuracy                       0.601286       933
   macro avg   0.548781  0.530530  0.538312       933
weighted avg   0.599697  0.601286  0.599319       933

Test Acc: 0.6012861736334405 F1_ma:0.5096477481407284
Train step: 1150 acc:0.71594 total_loss: 1.0612  loss:1.4662,stance loss: 1.2882 
Train step: 1160 acc:0.71222 total_loss: 1.0719  loss:0.98297,stance loss: 0.821 
Train step: 1170 acc:0.7119 total_loss: 1.071  loss:1.5238,stance loss: 0.90852 
Train step: 1180 acc:0.71225 total_loss: 1.0714  loss:1.0988,stance loss: 0.81753 
Train step: 1190 acc:0.71165 total_loss: 1.0752  loss:1.0394,stance loss: 0.77458 
Train step: 1200 acc:0.714 total_loss: 1.0699  loss:1.0664,stance loss: 0.81789 
Train step: 1210 acc:0.71531 total_loss: 1.0677  loss:1.3737,stance loss: 1.5566 
Train step: 1220 acc:0.71704 total_loss: 1.0624  loss:1.0006,stance loss: 0.7034 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.6875 total_loss: 1.1851  loss:1.1851,stance loss: 0.84031 
Train step: 1240 acc:0.8125 total_loss: 0.82714  loss:0.687,stance loss: 0.50155 
Train step: 1250 acc:0.8006 total_loss: 0.84344  loss:0.58376,stance loss: 0.52521 
Train step: 1260 acc:0.79637 total_loss: 0.86369  loss:0.78675,stance loss: 0.57612 
Train step: 1270 acc:0.78354 total_loss: 0.90468  loss:0.71647,stance loss: 0.50636 
Train step: 1280 acc:0.76961 total_loss: 0.92261  loss:0.89713,stance loss: 0.69433 
Train step: 1290 acc:0.76025 total_loss: 0.92428  loss:0.97753,stance loss: 0.85956 
Train step: 1300 acc:0.74912 total_loss: 0.9633  loss:1.5154,stance loss: 1.2385 
Train step: 1310 acc:0.74923 total_loss: 0.96153  loss:0.75625,stance loss: 0.64698 
Train step: 1320 acc:0.74863 total_loss: 0.96911  loss:0.9143,stance loss: 1.2578 
Train step: 1330 acc:0.75309 total_loss: 0.9622  loss:0.69291,stance loss: 0.47127 
Train step: 1340 acc:0.75619 total_loss: 0.96708  loss:1.0474,stance loss: 0.87848 
Train step: 1350 acc:0.75775 total_loss: 0.96029  loss:0.61013,stance loss: 0.46867 
Train step: 1360 acc:0.75668 total_loss: 0.95518  loss:1.0255,stance loss: 0.84068 
Train step: 1370 acc:0.75488 total_loss: 0.96354  loss:1.1785,stance loss: 0.90958 
Train step: 1380 acc:0.75621 total_loss: 0.96113  loss:0.69679,stance loss: 0.57002 
Train step: 1390 acc:0.75699 total_loss: 0.96146  loss:0.9355,stance loss: 0.76578 
Train step: 1400 acc:0.75914 total_loss: 0.95876  loss:0.6219,stance loss: 0.41359 
Train step: 1410 acc:0.75829 total_loss: 0.95324  loss:1.1622,stance loss: 0.99933 
Train step: 1420 acc:0.76014 total_loss: 0.94288  loss:0.58267,stance loss: 0.46701 
Train step: 1430 acc:0.75964 total_loss: 0.94198  loss:1.1754,stance loss: 1.3467 
Train step: 1440 acc:0.7577 total_loss: 0.9475  loss:0.93933,stance loss: 0.76807 
Train step: 1450 acc:0.75764 total_loss: 0.94412  loss:0.80546,stance loss: 0.69981 
Train step: 1460 acc:0.75649 total_loss: 0.94773  loss:0.7304,stance loss: 0.59395 
Better F1! Saving model!
Saving model of best f1: 0.5151689272757256
              precision    recall  f1-score   support

           0   0.693750  0.612132  0.650391       544
           1   0.597510  0.648649  0.622030       222
           2   0.339623  0.431138  0.379947       167

    accuracy                       0.588424       933
   macro avg   0.543628  0.563973  0.550789       933
weighted avg   0.607464  0.588424  0.595235       933

Test Acc: 0.5884244372990354 F1_ma:0.5151689272757256
Train step: 1470 acc:0.75571 total_loss: 0.94785  loss:1.5868,stance loss: 1.2058 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.825 total_loss: 0.86772  loss:0.66541,stance loss: 0.54192 
Train step: 1490 acc:0.76667 total_loss: 0.88052  loss:0.76024,stance loss: 0.67041 
Train step: 1500 acc:0.775 total_loss: 0.8535  loss:1.175,stance loss: 1.0265 
Train step: 1510 acc:0.77321 total_loss: 0.8357  loss:0.64936,stance loss: 0.49394 
Train step: 1520 acc:0.78056 total_loss: 0.82433  loss:0.68018,stance loss: 0.54904 
Train step: 1530 acc:0.78295 total_loss: 0.81933  loss:0.61123,stance loss: 0.40263 
Train step: 1540 acc:0.78942 total_loss: 0.82746  loss:0.94096,stance loss: 0.77672 
Train step: 1550 acc:0.7925 total_loss: 0.83415  loss:1.1279,stance loss: 0.70154 
Train step: 1560 acc:0.79706 total_loss: 0.82068  loss:0.68408,stance loss: 0.59445 
Train step: 1570 acc:0.8 total_loss: 0.81501  loss:0.36499,stance loss: 0.20956 
Train step: 1580 acc:0.80536 total_loss: 0.8097  loss:0.48326,stance loss: 0.33342 
Train step: 1590 acc:0.80543 total_loss: 0.82017  loss:1.1173,stance loss: 0.9033 
Train step: 1600 acc:0.8045 total_loss: 0.82089  loss:0.81677,stance loss: 0.71835 
Train step: 1610 acc:0.80231 total_loss: 0.82833  loss:1.5286,stance loss: 1.3592 
Train step: 1620 acc:0.80302 total_loss: 0.82353  loss:0.91287,stance loss: 0.79787 
Train step: 1630 acc:0.80202 total_loss: 0.8215  loss:0.93459,stance loss: 0.64136 
Train step: 1640 acc:0.80303 total_loss: 0.82339  loss:0.65529,stance loss: 0.52006 
Train step: 1650 acc:0.80107 total_loss: 0.8272  loss:1.1682,stance loss: 1.0468 
Train step: 1660 acc:0.79966 total_loss: 0.83405  loss:0.62793,stance loss: 0.48682 
Train step: 1670 acc:0.7984 total_loss: 0.83834  loss:0.44918,stance loss: 0.24519 
Train step: 1680 acc:0.79695 total_loss: 0.84256  loss:0.6576,stance loss: 0.58995 
Train step: 1690 acc:0.79738 total_loss: 0.84016  loss:0.65328,stance loss: 0.60971 
Train step: 1700 acc:0.79417 total_loss: 0.84626  loss:1.4919,stance loss: 1.6449 
Train step: 1710 acc:0.79468 total_loss: 0.84328  loss:0.50473,stance loss: 0.35999 
Train step: 1720 acc:0.79439 total_loss: 0.84152  loss:0.50434,stance loss: 0.35394 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.85417 total_loss: 0.67459  loss:0.73403,stance loss: 0.64252 
Train step: 1740 acc:0.83882 total_loss: 0.6741  loss:1.3566,stance loss: 1.3371 
Train step: 1750 acc:0.81466 total_loss: 0.75466  loss:1.2215,stance loss: 1.3094 
Train step: 1760 acc:0.82212 total_loss: 0.74014  loss:0.8684,stance loss: 0.7069 
Train step: 1770 acc:0.82015 total_loss: 0.75065  loss:0.97368,stance loss: 1.3083 
Train step: 1780 acc:0.82309 total_loss: 0.75346  loss:0.80711,stance loss: 0.65988 
Train step: 1790 acc:0.81522 total_loss: 0.76563  loss:1.1552,stance loss: 0.94026 
Train step: 1800 acc:0.82199 total_loss: 0.74774  loss:0.83037,stance loss: 1.1169 
Train step: 1810 acc:0.82374 total_loss: 0.73347  loss:0.416,stance loss: 0.35668 
Train step: 1820 acc:0.82513 total_loss: 0.73521  loss:1.0123,stance loss: 1.3724 
Train step: 1830 acc:0.8297 total_loss: 0.72927  loss:1.1077,stance loss: 0.95558 
Train step: 1840 acc:0.82563 total_loss: 0.73592  loss:0.92081,stance loss: 0.73501 
Train step: 1850 acc:0.82316 total_loss: 0.7403  loss:0.63202,stance loss: 0.47758 
Train step: 1860 acc:0.82509 total_loss: 0.73036  loss:0.54438,stance loss: 0.38456 
Train step: 1870 acc:0.82634 total_loss: 0.73024  loss:0.32072,stance loss: 0.151 
Train step: 1880 acc:0.82901 total_loss: 0.72051  loss:0.68313,stance loss: 0.57593 
Train step: 1890 acc:0.82581 total_loss: 0.72743  loss:0.87508,stance loss: 0.58392 
Train step: 1900 acc:0.82647 total_loss: 0.7274  loss:1.0309,stance loss: 0.91021 
Train step: 1910 acc:0.82738 total_loss: 0.72649  loss:0.6518,stance loss: 0.53298 
Train step: 1920 acc:0.82381 total_loss: 0.73947  loss:1.3593,stance loss: 1.6111 
Train step: 1930 acc:0.82386 total_loss: 0.73832  loss:0.88102,stance loss: 0.81102 
Train step: 1940 acc:0.8242 total_loss: 0.74094  loss:1.7193,stance loss: 1.9051 
Train step: 1950 acc:0.82178 total_loss: 0.7479  loss:1.0157,stance loss: 0.95285 
Train step: 1960 acc:0.82113 total_loss: 0.74801  loss:0.64943,stance loss: 0.49063 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.83333 total_loss: 0.53494  loss:0.55889,stance loss: 0.47646 
Train step: 1980 acc:0.86538 total_loss: 0.64045  loss:0.63248,stance loss: 0.37297 
Train step: 1990 acc:0.87228 total_loss: 0.60402  loss:0.59214,stance loss: 0.40741 
Train step: 2000 acc:0.87121 total_loss: 0.6302  loss:0.28273,stance loss: 0.12944 
Train step: 2010 acc:0.86919 total_loss: 0.65252  loss:0.79728,stance loss: 0.61221 
Train step: 2020 acc:0.87618 total_loss: 0.62295  loss:0.59424,stance loss: 0.47338 
Train step: 2030 acc:0.87798 total_loss: 0.60958  loss:1.208,stance loss: 1.0388 
Train step: 2040 acc:0.86815 total_loss: 0.62581  loss:0.55977,stance loss: 0.43867 
Train step: 2050 acc:0.86295 total_loss: 0.62894  loss:0.66585,stance loss: 0.61254 
Train step: 2060 acc:0.86761 total_loss: 0.62415  loss:0.79247,stance loss: 0.71761 
Train step: 2070 acc:0.87015 total_loss: 0.62287  loss:0.93866,stance loss: 1.2448 
Train step: 2080 acc:0.87168 total_loss: 0.6203  loss:0.31838,stance loss: 0.25474 
Train step: 2090 acc:0.87195 total_loss: 0.61641  loss:0.40978,stance loss: 0.34474 
Train step: 2100 acc:0.87265 total_loss: 0.61786  loss:0.43753,stance loss: 0.24677 
Train step: 2110 acc:0.87194 total_loss: 0.61638  loss:0.57294,stance loss: 0.48947 
Train step: 2120 acc:0.87132 total_loss: 0.62242  loss:0.37617,stance loss: 0.31606 
Train step: 2130 acc:0.8681 total_loss: 0.62382  loss:0.61565,stance loss: 0.44255 
Train step: 2140 acc:0.86777 total_loss: 0.62165  loss:0.46849,stance loss: 0.37372 
Train step: 2150 acc:0.86851 total_loss: 0.6181  loss:0.82357,stance loss: 0.61036 
Train step: 2160 acc:0.86528 total_loss: 0.62394  loss:0.59648,stance loss: 0.27655 
Train step: 2170 acc:0.86422 total_loss: 0.6239  loss:0.50961,stance loss: 0.28457 
Train step: 2180 acc:0.86473 total_loss: 0.61721  loss:0.35506,stance loss: 0.21627 
Train step: 2190 acc:0.86519 total_loss: 0.61589  loss:0.47743,stance loss: 0.35815 
Train step: 2200 acc:0.86588 total_loss: 0.61204  loss:0.60432,stance loss: 0.48361 
Train step: 2210 acc:0.86651 total_loss: 0.60897  loss:0.4638,stance loss: 0.48023 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.90179 total_loss: 0.46106  loss:0.30648,stance loss: 0.20496 
Train step: 2230 acc:0.89706 total_loss: 0.48808  loss:0.20062,stance loss: 0.07522 
Train step: 2240 acc:0.88194 total_loss: 0.57003  loss:0.5926,stance loss: 0.42317 
Train step: 2250 acc:0.88345 total_loss: 0.5647  loss:0.54026,stance loss: 0.29417 
Train step: 2260 acc:0.88165 total_loss: 0.54162  loss:0.36846,stance loss: 0.16866 
Train step: 2270 acc:0.88487 total_loss: 0.5216  loss:0.29371,stance loss: 0.21323 
Train step: 2280 acc:0.88899 total_loss: 0.51973  loss:0.7209,stance loss: 0.5611 
Train step: 2290 acc:0.88555 total_loss: 0.52798  loss:0.38951,stance loss: 0.29377 
Train step: 2300 acc:0.88865 total_loss: 0.51746  loss:0.58975,stance loss: 0.45899 
Train step: 2310 acc:0.88853 total_loss: 0.51894  loss:0.65171,stance loss: 0.41259 
Train step: 2320 acc:0.89136 total_loss: 0.50765  loss:0.74775,stance loss: 0.48796 
Train step: 2330 acc:0.88996 total_loss: 0.51496  loss:0.58471,stance loss: 0.43673 
Train step: 2340 acc:0.88681 total_loss: 0.52321  loss:0.83289,stance loss: 0.67178 
Train step: 2350 acc:0.89051 total_loss: 0.514  loss:0.3681,stance loss: 0.32133 
Train step: 2360 acc:0.89031 total_loss: 0.51033  loss:0.30699,stance loss: 0.24521 
Train step: 2370 acc:0.89013 total_loss: 0.5129  loss:0.59328,stance loss: 0.40284 
Train step: 2380 acc:0.8896 total_loss: 0.51233  loss:0.392,stance loss: 0.41335 
Train step: 2390 acc:0.88877 total_loss: 0.5101  loss:0.098004,stance loss: 0.025441 
Train step: 2400 acc:0.89004 total_loss: 0.51402  loss:0.39479,stance loss: 0.30336 
Train step: 2410 acc:0.88928 total_loss: 0.51544  loss:0.52216,stance loss: 0.49556 
Train step: 2420 acc:0.88919 total_loss: 0.51746  loss:1.2786,stance loss: 0.97379 
Train step: 2430 acc:0.88854 total_loss: 0.51868  loss:0.22433,stance loss: 0.11199 
Train step: 2440 acc:0.88767 total_loss: 0.51804  loss:0.59726,stance loss: 0.35997 
Train step: 2450 acc:0.88713 total_loss: 0.52011  loss:0.68258,stance loss: 0.58176 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.36148  loss:0.36148,stance loss: 0.2071 
Train step: 2470 acc:0.88068 total_loss: 0.42718  loss:0.61111,stance loss: 0.27425 
Train step: 2480 acc:0.90476 total_loss: 0.3925  loss:0.46033,stance loss: 0.31372 
Train step: 2490 acc:0.91129 total_loss: 0.41474  loss:0.24146,stance loss: 0.16997 
Train step: 2500 acc:0.91921 total_loss: 0.40092  loss:0.19673,stance loss: 0.11111 
Train step: 2510 acc:0.91299 total_loss: 0.41272  loss:0.42732,stance loss: 0.50208 
Train step: 2520 acc:0.92008 total_loss: 0.39238  loss:0.051704,stance loss: 0.0055037 
Train step: 2530 acc:0.92165 total_loss: 0.37989  loss:0.65926,stance loss: 0.52234 
Train step: 2540 acc:0.92515 total_loss: 0.37273  loss:0.8988,stance loss: 1.3193 
Train step: 2550 acc:0.92514 total_loss: 0.37804  loss:0.25684,stance loss: 0.11433 
Train step: 2560 acc:0.92698 total_loss: 0.37115  loss:0.78262,stance loss: 0.90543 
Train step: 2570 acc:0.92736 total_loss: 0.37535  loss:0.84111,stance loss: 1.136 
Train step: 2580 acc:0.9282 total_loss: 0.37066  loss:0.61713,stance loss: 0.5293 
Train step: 2590 acc:0.92796 total_loss: 0.3796  loss:0.41004,stance loss: 0.38809 
Train step: 2600 acc:0.92509 total_loss: 0.38686  loss:0.4356,stance loss: 0.2619 
Train step: 2610 acc:0.92425 total_loss: 0.38524  loss:0.24223,stance loss: 0.2033 
Train step: 2620 acc:0.92197 total_loss: 0.40298  loss:0.5581,stance loss: 0.4105 
Train step: 2630 acc:0.92142 total_loss: 0.41117  loss:0.51078,stance loss: 0.29765 
Train step: 2640 acc:0.92334 total_loss: 0.40726  loss:0.44223,stance loss: 0.42286 
Train step: 2650 acc:0.92179 total_loss: 0.41388  loss:0.44174,stance loss: 0.38092 
Train step: 2660 acc:0.92351 total_loss: 0.4071  loss:0.44977,stance loss: 0.49848 
Train step: 2670 acc:0.92239 total_loss: 0.40818  loss:0.20326,stance loss: 0.1283 
Train step: 2680 acc:0.9211 total_loss: 0.41092  loss:0.15982,stance loss: 0.1073 
Train step: 2690 acc:0.91883 total_loss: 0.41712  loss:0.37776,stance loss: 0.30084 
Train step: 2700 acc:0.91649 total_loss: 0.4269  loss:0.22259,stance loss: 0.1049 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9375 total_loss: 0.60714  loss:0.75469,stance loss: 1.0678 
Train step: 2720 acc:0.95 total_loss: 0.41458  loss:0.060044,stance loss: 0.023179 
Train step: 2730 acc:0.9425 total_loss: 0.44147  loss:0.28276,stance loss: 0.23216 
Train step: 2740 acc:0.94107 total_loss: 0.40369  loss:0.33679,stance loss: 0.26541 
Train step: 2750 acc:0.94028 total_loss: 0.38264  loss:0.62976,stance loss: 1.0332 
Train step: 2760 acc:0.94091 total_loss: 0.36055  loss:0.36777,stance loss: 0.30872 
Train step: 2770 acc:0.93654 total_loss: 0.37096  loss:0.67107,stance loss: 0.51075 
Train step: 2780 acc:0.9375 total_loss: 0.36411  loss:0.32691,stance loss: 0.17511 
Train step: 2790 acc:0.93603 total_loss: 0.36283  loss:0.8392,stance loss: 0.74637 
Train step: 2800 acc:0.93618 total_loss: 0.35595  loss:0.041665,stance loss: 0.0082861 
Train step: 2810 acc:0.93631 total_loss: 0.35838  loss:0.84169,stance loss: 0.72324 
Train step: 2820 acc:0.93696 total_loss: 0.35691  loss:0.59667,stance loss: 0.30274 
Train step: 2830 acc:0.9375 total_loss: 0.35903  loss:1.0963,stance loss: 1.5779 
Train step: 2840 acc:0.93704 total_loss: 0.36179  loss:0.14144,stance loss: 0.13832 
Train step: 2850 acc:0.93836 total_loss: 0.35926  loss:0.47377,stance loss: 0.31306 
Train step: 2860 acc:0.93911 total_loss: 0.35903  loss:0.47913,stance loss: 0.3873 
Train step: 2870 acc:0.93712 total_loss: 0.36403  loss:0.46109,stance loss: 0.42367 
Train step: 2880 acc:0.93786 total_loss: 0.36173  loss:0.11589,stance loss: 0.063494 
Train step: 2890 acc:0.93851 total_loss: 0.35572  loss:0.10306,stance loss: 0.0533 
Train step: 2900 acc:0.93974 total_loss: 0.34967  loss:0.093166,stance loss: 0.011979 
Train step: 2910 acc:0.94085 total_loss: 0.34263  loss:0.23596,stance loss: 0.2285 
Train step: 2920 acc:0.94157 total_loss: 0.33963  loss:0.33247,stance loss: 0.29973 
Train step: 2930 acc:0.94111 total_loss: 0.34384  loss:0.73445,stance loss: 1.1112 
Train step: 2940 acc:0.94149 total_loss: 0.3426  loss:0.7944,stance loss: 0.72666 
Train step: 2950 acc:0.9426 total_loss: 0.3419  loss:0.31454,stance loss: 0.24792 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.9375 total_loss: 0.33621  loss:0.87304,stance loss: 1.3558 
Train step: 2970 acc:0.95724 total_loss: 0.29245  loss:0.59402,stance loss: 1.0459 
Train step: 2980 acc:0.95905 total_loss: 0.26847  loss:0.14369,stance loss: 0.062127 
Train step: 2990 acc:0.95833 total_loss: 0.28395  loss:0.081582,stance loss: 0.026642 
Train step: 3000 acc:0.95408 total_loss: 0.2788  loss:0.40007,stance loss: 0.24836 
Train step: 3010 acc:0.94915 total_loss: 0.30454  loss:0.056569,stance loss: 0.011358 
Train step: 3020 acc:0.95109 total_loss: 0.29359  loss:0.17775,stance loss: 0.12684 
Train step: 3030 acc:0.94937 total_loss: 0.2912  loss:0.47376,stance loss: 0.33471 
Train step: 3040 acc:0.95084 total_loss: 0.29245  loss:0.099605,stance loss: 0.03611 
Train step: 3050 acc:0.95076 total_loss: 0.291  loss:0.048945,stance loss: 0.011469 
Train step: 3060 acc:0.94954 total_loss: 0.29251  loss:0.95041,stance loss: 1.327 
Train step: 3070 acc:0.94853 total_loss: 0.29667  loss:0.13451,stance loss: 0.022721 
Train step: 3080 acc:0.94864 total_loss: 0.29385  loss:0.086751,stance loss: 0.051228 
Train step: 3090 acc:0.95009 total_loss: 0.29323  loss:0.16229,stance loss: 0.066059 
Train step: 3100 acc:0.95092 total_loss: 0.3012  loss:0.19725,stance loss: 0.14065 
Train step: 3110 acc:0.95283 total_loss: 0.29054  loss:0.27891,stance loss: 0.23132 
Train step: 3120 acc:0.95229 total_loss: 0.29321  loss:0.27419,stance loss: 0.16963 
Train step: 3130 acc:0.95147 total_loss: 0.2916  loss:0.17095,stance loss: 0.12134 
Train step: 3140 acc:0.95139 total_loss: 0.2882  loss:0.081975,stance loss: 0.017129 
Train step: 3150 acc:0.95132 total_loss: 0.28973  loss:0.2434,stance loss: 0.15689 
Train step: 3160 acc:0.95156 total_loss: 0.28653  loss:0.19048,stance loss: 0.078679 
Train step: 3170 acc:0.95063 total_loss: 0.2892  loss:0.63323,stance loss: 1.0934 
Train step: 3180 acc:0.94896 total_loss: 0.29089  loss:0.39362,stance loss: 0.23981 
Train step: 3190 acc:0.94927 total_loss: 0.29077  loss:0.071961,stance loss: 0.02725 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.97917 total_loss: 0.096365  loss:0.13898,stance loss: 0.066907 
Train step: 3210 acc:0.97596 total_loss: 0.32615  loss:0.067647,stance loss: 0.016435 
Train step: 3220 acc:0.97826 total_loss: 0.25424  loss:0.074633,stance loss: 0.021707 
Train step: 3230 acc:0.97348 total_loss: 0.24574  loss:0.29355,stance loss: 0.19687 
Train step: 3240 acc:0.96657 total_loss: 0.24071  loss:0.81684,stance loss: 1.2623 
Train step: 3250 acc:0.9658 total_loss: 0.2414  loss:0.071366,stance loss: 0.050333 
Train step: 3260 acc:0.96131 total_loss: 0.26628  loss:0.096999,stance loss: 0.059464 
Train step: 3270 acc:0.96062 total_loss: 0.25241  loss:0.30583,stance loss: 0.17202 
Train step: 3280 acc:0.96009 total_loss: 0.26236  loss:0.034721,stance loss: 0.009875 
Train step: 3290 acc:0.96102 total_loss: 0.25921  loss:0.1553,stance loss: 0.044709 
Train step: 3300 acc:0.95934 total_loss: 0.2589  loss:0.039129,stance loss: 0.017167 
Train step: 3310 acc:0.96018 total_loss: 0.25575  loss:0.90625,stance loss: 0.98223 
Train step: 3320 acc:0.95935 total_loss: 0.25303  loss:0.039852,stance loss: 0.0047917 
Train step: 3330 acc:0.96006 total_loss: 0.24978  loss:0.059547,stance loss: 0.027204 
Train step: 3340 acc:0.95979 total_loss: 0.24626  loss:0.077196,stance loss: 0.056385 
Train step: 3350 acc:0.95874 total_loss: 0.2472  loss:0.080159,stance loss: 0.038792 
Train step: 3360 acc:0.95859 total_loss: 0.24767  loss:0.16863,stance loss: 0.091131 
Train step: 3370 acc:0.95882 total_loss: 0.24804  loss:0.10825,stance loss: 0.1307 
Train step: 3380 acc:0.95902 total_loss: 0.24669  loss:0.64,stance loss: 1.0839 
Train step: 3390 acc:0.96017 total_loss: 0.24359  loss:0.35524,stance loss: 0.21039 
Train step: 3400 acc:0.95874 total_loss: 0.24867  loss:0.35728,stance loss: 0.30632 
Train step: 3410 acc:0.95892 total_loss: 0.24992  loss:0.47944,stance loss: 0.39653 
Train step: 3420 acc:0.9602 total_loss: 0.25123  loss:0.056804,stance loss: 0.046796 
Train step: 3430 acc:0.96057 total_loss: 0.24787  loss:0.039799,stance loss: 0.011711 
Train step: 3440 acc:0.96039 total_loss: 0.24748  loss:0.35742,stance loss: 0.31402 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.96429 total_loss: 0.24875  loss:0.20716,stance loss: 0.19025 
Train step: 3460 acc:0.97059 total_loss: 0.1976  loss:0.14201,stance loss: 0.075314 
Train step: 3470 acc:0.96991 total_loss: 0.17446  loss:0.039364,stance loss: 0.0062977 
Train step: 3480 acc:0.96959 total_loss: 0.17562  loss:0.061836,stance loss: 0.0074399 
Train step: 3490 acc:0.96676 total_loss: 0.17659  loss:0.3423,stance loss: 0.2414 
Train step: 3500 acc:0.96711 total_loss: 0.19771  loss:0.16326,stance loss: 0.098403 
Train step: 3510 acc:0.96549 total_loss: 0.21294  loss:0.090671,stance loss: 0.095006 
Train step: 3520 acc:0.9651 total_loss: 0.21088  loss:0.034688,stance loss: 0.0098882 
Train step: 3530 acc:0.96767 total_loss: 0.20136  loss:0.080444,stance loss: 0.091538 
Train step: 3540 acc:0.96972 total_loss: 0.1949  loss:0.16413,stance loss: 0.034931 
Train step: 3550 acc:0.96904 total_loss: 0.19099  loss:0.095594,stance loss: 0.070536 
Train step: 3560 acc:0.96848 total_loss: 0.18887  loss:0.086681,stance loss: 0.077221 
Train step: 3570 acc:0.96752 total_loss: 0.19195  loss:0.048133,stance loss: 0.0084543 
Train step: 3580 acc:0.96578 total_loss: 0.19594  loss:0.052675,stance loss: 0.020705 
Train step: 3590 acc:0.96471 total_loss: 0.19813  loss:0.017959,stance loss: 0.00046403 
Train step: 3600 acc:0.96218 total_loss: 0.20694  loss:0.087691,stance loss: 0.0078927 
Train step: 3610 acc:0.96145 total_loss: 0.20347  loss:0.09899,stance loss: 0.047813 
Train step: 3620 acc:0.96186 total_loss: 0.20247  loss:0.073975,stance loss: 0.038628 
Train step: 3630 acc:0.9609 total_loss: 0.20323  loss:0.14897,stance loss: 0.062585 
Train step: 3640 acc:0.96066 total_loss: 0.20754  loss:0.55852,stance loss: 0.56502 
Train step: 3650 acc:0.96105 total_loss: 0.21158  loss:0.039901,stance loss: 0.01572 
Train step: 3660 acc:0.96141 total_loss: 0.21129  loss:0.30209,stance loss: 0.35401 
Train step: 3670 acc:0.96118 total_loss: 0.21736  loss:0.3295,stance loss: 0.17886 
Train step: 3680 acc:0.96203 total_loss: 0.2165  loss:0.065293,stance loss: 0.040728 
Training finished.


Reload the best model with best f1 0.5151689272757256 from path test_outputs/bert-cross-topic/la/2023-08-14 16-21-57/state_dict


              precision    recall  f1-score   support

           0   0.693750  0.612132  0.650391       544
           1   0.597510  0.648649  0.622030       222
           2   0.339623  0.431138  0.379947       167

    accuracy                       0.588424       933
   macro avg   0.543628  0.563973  0.550789       933
weighted avg   0.607464  0.588424  0.595235       933

Test Acc: 0.5884244372990354 F1_ma:0.5151689272757256
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5151689272757256
acc: 0.5884244372990354, f1 :0.5507893640441482
classification report: 
              precision    recall  f1-score   support

         Con     0.6937    0.6121    0.6504       544
        None     0.5975    0.6486    0.6220       222
         Pro     0.3396    0.4311    0.3799       167

    accuracy                         0.5884       933
   macro avg     0.5436    0.5640    0.5508       933
weighted avg     0.6075    0.5884    0.5952       933

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 17-00-27', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 17-00-27
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.8817  loss:1.8817,stance loss: 1.296 
Train step: 10 acc:0.48295 total_loss: 1.7358  loss:1.8443,stance loss: 1.2469 
Better F1! Saving model!
Saving model of best f1: 0.3821047713280563
              precision    recall  f1-score   support

           0   0.662732  0.722426  0.691293       544
           1   0.466667  0.662162  0.547486       222
           2   0.280000  0.041916  0.072917       167

    accuracy                       0.586281       933
   macro avg   0.469800  0.475502  0.437232       933
weighted avg   0.547574  0.586281  0.546390       933

Test Acc: 0.5862808145766345 F1_ma:0.3821047713280563
Train step: 20 acc:0.49702 total_loss: 1.7007  loss:1.6434,stance loss: 1.0496 
Train step: 30 acc:0.48387 total_loss: 1.6918  loss:1.779,stance loss: 1.2234 
Train step: 40 acc:0.49238 total_loss: 1.6665  loss:1.5191,stance loss: 1.0491 
Train step: 50 acc:0.48162 total_loss: 1.6613  loss:2.055,stance loss: 1.8644 
Train step: 60 acc:0.48873 total_loss: 1.6535  loss:1.5981,stance loss: 1.1459 
Train step: 70 acc:0.4912 total_loss: 1.6493  loss:1.5888,stance loss: 1.1062 
Better F1! Saving model!
Saving model of best f1: 0.3835870610064159
              precision    recall  f1-score   support

           0   0.598443  0.988971  0.745669       544
           1   0.800000  0.054054  0.101266       222
           2   0.105263  0.011976  0.021505       167

    accuracy                       0.591640       933
   macro avg   0.501235  0.351667  0.289480       933
weighted avg   0.558126  0.591640  0.462718       933

Test Acc: 0.5916398713826366 F1_ma:0.3835870610064159
Train step: 80 acc:0.48765 total_loss: 1.643  loss:1.709,stance loss: 1.256 
Train step: 90 acc:0.48764 total_loss: 1.6333  loss:1.4474,stance loss: 1.1396 
Train step: 100 acc:0.49876 total_loss: 1.6188  loss:1.4234,stance loss: 0.92743 
Train step: 110 acc:0.50507 total_loss: 1.6068  loss:1.6645,stance loss: 1.3711 
Train step: 120 acc:0.50826 total_loss: 1.6032  loss:1.5795,stance loss: 1.289 
Train step: 130 acc:0.51002 total_loss: 1.6018  loss:1.4768,stance loss: 0.9806 
Train step: 140 acc:0.5102 total_loss: 1.5904  loss:1.3892,stance loss: 1.038 
Train step: 150 acc:0.51407 total_loss: 1.5822  loss:1.1689,stance loss: 0.74973 
Train step: 160 acc:0.51863 total_loss: 1.5734  loss:1.6377,stance loss: 1.2955 
Train step: 170 acc:0.52047 total_loss: 1.5725  loss:1.7749,stance loss: 1.4476 
Train step: 180 acc:0.52417 total_loss: 1.5668  loss:1.4934,stance loss: 0.94062 
Train step: 190 acc:0.53043 total_loss: 1.5593  loss:1.3506,stance loss: 0.97054 
Train step: 200 acc:0.53669 total_loss: 1.5458  loss:1.0469,stance loss: 0.55514 
Train step: 210 acc:0.5388 total_loss: 1.5397  loss:1.4067,stance loss: 1.0583 
Train step: 220 acc:0.53846 total_loss: 1.5349  loss:1.4662,stance loss: 1.1023 
Train step: 230 acc:0.54356 total_loss: 1.525  loss:1.3931,stance loss: 0.86251 
Train step: 240 acc:0.54409 total_loss: 1.5218  loss:1.3853,stance loss: 0.91545 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.6375 total_loss: 1.4361  loss:1.3307,stance loss: 0.91585 
Train step: 260 acc:0.65417 total_loss: 1.3845  loss:1.2764,stance loss: 0.87404 
Train step: 270 acc:0.6325 total_loss: 1.3767  loss:1.2821,stance loss: 0.91913 
Train step: 280 acc:0.64643 total_loss: 1.3612  loss:1.5513,stance loss: 1.5948 
Train step: 290 acc:0.65 total_loss: 1.3404  loss:1.2882,stance loss: 0.9658 
Train step: 300 acc:0.65795 total_loss: 1.3268  loss:1.4507,stance loss: 1.2329 
Train step: 310 acc:0.65 total_loss: 1.345  loss:1.3271,stance loss: 0.88441 
Train step: 320 acc:0.6475 total_loss: 1.3404  loss:1.5658,stance loss: 1.0295 
Train step: 330 acc:0.64485 total_loss: 1.3486  loss:1.4955,stance loss: 1.2738 
Train step: 340 acc:0.63882 total_loss: 1.3431  loss:1.4566,stance loss: 1.0196 
Train step: 350 acc:0.63869 total_loss: 1.3419  loss:1.582,stance loss: 1.6581 
Train step: 360 acc:0.63913 total_loss: 1.34  loss:1.3428,stance loss: 1.0006 
Train step: 370 acc:0.6395 total_loss: 1.3386  loss:1.2093,stance loss: 1.324 
Train step: 380 acc:0.64398 total_loss: 1.3376  loss:1.4235,stance loss: 1.5451 
Train step: 390 acc:0.64397 total_loss: 1.3319  loss:1.2422,stance loss: 1.0932 
Train step: 400 acc:0.64637 total_loss: 1.3246  loss:1.0182,stance loss: 0.79953 
Train step: 410 acc:0.64583 total_loss: 1.3224  loss:1.0319,stance loss: 0.64954 
Train step: 420 acc:0.64714 total_loss: 1.3195  loss:1.3154,stance loss: 1.1859 
Train step: 430 acc:0.64561 total_loss: 1.3167  loss:1.6006,stance loss: 1.4662 
Better F1! Saving model!
Saving model of best f1: 0.39476440678684865
              precision    recall  f1-score   support

           0   0.658499  0.790441  0.718463       544
           1   0.572000  0.644144  0.605932       222
           2   0.233333  0.041916  0.071066       167

    accuracy                       0.621651       933
   macro avg   0.487944  0.492167  0.465154       933
weighted avg   0.561816  0.621651  0.575808       933

Test Acc: 0.6216505894962486 F1_ma:0.39476440678684865
Train step: 440 acc:0.64647 total_loss: 1.3165  loss:1.4375,stance loss: 1.174 
Train step: 450 acc:0.64482 total_loss: 1.3177  loss:1.0492,stance loss: 0.62368 
Train step: 460 acc:0.64738 total_loss: 1.3138  loss:1.1826,stance loss: 0.99463 
Train step: 470 acc:0.64972 total_loss: 1.3093  loss:1.1366,stance loss: 1.0433 
Train step: 480 acc:0.6484 total_loss: 1.3094  loss:1.1725,stance loss: 0.96871 
Train step: 490 acc:0.65026 total_loss: 1.3035  loss:1.1663,stance loss: 1.1216 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.6875 total_loss: 1.1556  loss:1.0722,stance loss: 0.71643 
Train step: 510 acc:0.69079 total_loss: 1.1461  loss:0.96691,stance loss: 0.75165 
Train step: 520 acc:0.68319 total_loss: 1.2053  loss:1.2603,stance loss: 0.91885 
Train step: 530 acc:0.67788 total_loss: 1.2114  loss:1.5977,stance loss: 1.7073 
Train step: 540 acc:0.67602 total_loss: 1.2123  loss:1.5695,stance loss: 1.0161 
Train step: 550 acc:0.67479 total_loss: 1.2135  loss:1.1792,stance loss: 0.75614 
Train step: 560 acc:0.67572 total_loss: 1.2003  loss:1.1376,stance loss: 0.79448 
Train step: 570 acc:0.68354 total_loss: 1.1798  loss:0.87865,stance loss: 0.67258 
Train step: 580 acc:0.69031 total_loss: 1.1765  loss:1.3059,stance loss: 1.0735 
Train step: 590 acc:0.69192 total_loss: 1.171  loss:0.84647,stance loss: 0.66559 
Train step: 600 acc:0.68578 total_loss: 1.1797  loss:1.0497,stance loss: 0.68311 
Train step: 610 acc:0.6812 total_loss: 1.185  loss:1.4573,stance loss: 1.265 
Train step: 620 acc:0.67975 total_loss: 1.1887  loss:1.0583,stance loss: 0.87212 
Train step: 630 acc:0.67941 total_loss: 1.1862  loss:0.89964,stance loss: 0.55495 
Better F1! Saving model!
Saving model of best f1: 0.41373793771591005
              precision    recall  f1-score   support

           0   0.677060  0.558824  0.612286       544
           1   0.513433  0.774775  0.617594       222
           2   0.228188  0.203593  0.215190       167

    accuracy                       0.546624       933
   macro avg   0.472894  0.512397  0.481690       933
weighted avg   0.557782  0.546624  0.542472       933

Test Acc: 0.5466237942122186 F1_ma:0.41373793771591005
Train step: 640 acc:0.67492 total_loss: 1.1885  loss:1.0697,stance loss: 0.83165 
Train step: 650 acc:0.67689 total_loss: 1.1892  loss:1.16,stance loss: 0.96515 
Train step: 660 acc:0.67641 total_loss: 1.1892  loss:0.93731,stance loss: 0.65107 
Train step: 670 acc:0.67737 total_loss: 1.1886  loss:1.2601,stance loss: 1.0922 
Train step: 680 acc:0.6789 total_loss: 1.1824  loss:0.98485,stance loss: 0.74297 
Train step: 690 acc:0.67745 total_loss: 1.1824  loss:0.94765,stance loss: 0.69389 
Train step: 700 acc:0.68062 total_loss: 1.1787  loss:1.1238,stance loss: 0.8752 
Better F1! Saving model!
Saving model of best f1: 0.414629258517034
              precision    recall  f1-score   support

           0   0.691630  0.577206  0.629259       544
           1   0.489071  0.806306  0.608844       222
           2   0.247788  0.167665  0.200000       167

    accuracy                       0.558414       933
   macro avg   0.476163  0.517059  0.479367       933
weighted avg   0.563988  0.558414  0.547567       933

Test Acc: 0.5584137191854234 F1_ma:0.414629258517034
Train step: 710 acc:0.68265 total_loss: 1.1718  loss:1.3111,stance loss: 0.94311 
Train step: 720 acc:0.6804 total_loss: 1.1787  loss:1.276,stance loss: 1.0859 
Train step: 730 acc:0.68044 total_loss: 1.1753  loss:1.2088,stance loss: 1.0536 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.5625 total_loss: 1.3094  loss:0.96825,stance loss: 0.73154 
Train step: 750 acc:0.68269 total_loss: 1.1158  loss:1.1357,stance loss: 0.86157 
Train step: 760 acc:0.69565 total_loss: 1.0815  loss:1.1211,stance loss: 0.64811 
Train step: 770 acc:0.70455 total_loss: 1.0651  loss:1.1944,stance loss: 1.0624 
Train step: 780 acc:0.72093 total_loss: 1.0607  loss:1.0638,stance loss: 0.84391 
Train step: 790 acc:0.71108 total_loss: 1.0619  loss:0.91303,stance loss: 0.47334 
Train step: 800 acc:0.71032 total_loss: 1.0629  loss:0.89519,stance loss: 0.79568 
Train step: 810 acc:0.70634 total_loss: 1.0738  loss:1.0,stance loss: 0.77981 
Train step: 820 acc:0.70482 total_loss: 1.0685  loss:1.0049,stance loss: 0.63323 
Train step: 830 acc:0.70228 total_loss: 1.0797  loss:1.1993,stance loss: 1.0395 
Train step: 840 acc:0.69964 total_loss: 1.0943  loss:1.3367,stance loss: 1.0953 
Better F1! Saving model!
Saving model of best f1: 0.4242135483476881
              precision    recall  f1-score   support

           0   0.713604  0.549632  0.620976       544
           1   0.446009  0.855856  0.586420       222
           2   0.329545  0.173653  0.227451       167

    accuracy                       0.555198       933
   macro avg   0.496386  0.526380  0.478282       933
weighted avg   0.581188  0.555198  0.542316       933

Test Acc: 0.5551982851018221 F1_ma:0.4242135483476881
Train step: 850 acc:0.70133 total_loss: 1.0899  loss:0.9127,stance loss: 0.60949 
Train step: 860 acc:0.70427 total_loss: 1.0957  loss:0.90202,stance loss: 0.73762 
Train step: 870 acc:0.70536 total_loss: 1.0978  loss:1.022,stance loss: 0.79207 
Train step: 880 acc:0.70323 total_loss: 1.0976  loss:1.0327,stance loss: 0.79875 
Train step: 890 acc:0.70139 total_loss: 1.0995  loss:1.0293,stance loss: 0.75664 
Train step: 900 acc:0.69632 total_loss: 1.1083  loss:1.1292,stance loss: 0.71039 
Train step: 910 acc:0.6987 total_loss: 1.1026  loss:0.95777,stance loss: 0.84462 
Train step: 920 acc:0.70014 total_loss: 1.0997  loss:1.0732,stance loss: 0.87378 
Train step: 930 acc:0.70013 total_loss: 1.0978  loss:1.1776,stance loss: 0.9406 
Train step: 940 acc:0.70166 total_loss: 1.0909  loss:1.2009,stance loss: 1.1554 
Train step: 950 acc:0.70188 total_loss: 1.0918  loss:1.2285,stance loss: 0.90797 
Train step: 960 acc:0.7032 total_loss: 1.0914  loss:1.2391,stance loss: 1.4442 
Train step: 970 acc:0.69984 total_loss: 1.0982  loss:1.2634,stance loss: 1.0547 
Train step: 980 acc:0.70345 total_loss: 1.094  loss:0.98065,stance loss: 0.74716 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.72321 total_loss: 1.0575  loss:0.94297,stance loss: 0.71935 
Train step: 1000 acc:0.71691 total_loss: 0.9911  loss:0.98647,stance loss: 0.65827 
Train step: 1010 acc:0.72917 total_loss: 0.97916  loss:1.2483,stance loss: 1.1033 
Train step: 1020 acc:0.72297 total_loss: 0.99404  loss:1.3463,stance loss: 1.5849 
Train step: 1030 acc:0.72739 total_loss: 0.99481  loss:1.0103,stance loss: 0.91571 
Train step: 1040 acc:0.73355 total_loss: 0.98656  loss:1.0416,stance loss: 0.87862 
Train step: 1050 acc:0.73228 total_loss: 0.99496  loss:1.0371,stance loss: 0.58774 
Train step: 1060 acc:0.72321 total_loss: 1.0022  loss:0.74905,stance loss: 0.53217 
Train step: 1070 acc:0.72342 total_loss: 0.99729  loss:0.97078,stance loss: 0.63725 
Better F1! Saving model!
Saving model of best f1: 0.43500634185347564
              precision    recall  f1-score   support

           0   0.673874  0.687500  0.680619       544
           1   0.523132  0.662162  0.584493       222
           2   0.257732  0.149701  0.189394       167

    accuracy                       0.585209       933
   macro avg   0.484913  0.499788  0.484835       933
weighted avg   0.563520  0.585209  0.569821       933

Test Acc: 0.5852090032154341 F1_ma:0.43500634185347564
Train step: 1080 acc:0.72165 total_loss: 1.0033  loss:1.1952,stance loss: 1.0409 
Better F1! Saving model!
Saving model of best f1: 0.43556043378738407
              precision    recall  f1-score   support

           0   0.688488  0.560662  0.618034       544
           1   0.492492  0.738739  0.590991       222
           2   0.261146  0.245509  0.253086       167

    accuracy                       0.546624       933
   macro avg   0.480709  0.514970  0.487371       933
weighted avg   0.565361  0.546624  0.546277       933

Test Acc: 0.5466237942122186 F1_ma:0.43556043378738407
Train step: 1090 acc:0.71904 total_loss: 1.0103  loss:1.2108,stance loss: 0.76799 
Train step: 1100 acc:0.71902 total_loss: 1.015  loss:1.2724,stance loss: 0.98974 
Better F1! Saving model!
Saving model of best f1: 0.4356396456379811
              precision    recall  f1-score   support

           0   0.698482  0.591912  0.640796       544
           1   0.472973  0.788288  0.591216       222
           2   0.303922  0.185629  0.230483       167

    accuracy                       0.565916       933
   macro avg   0.491792  0.521943  0.487499       933
weighted avg   0.574200  0.565916  0.555556       933

Test Acc: 0.5659163987138264 F1_ma:0.4356396456379811
Train step: 1110 acc:0.72096 total_loss: 1.0102  loss:0.85307,stance loss: 0.73411 
Better F1! Saving model!
Saving model of best f1: 0.437726842788324
              precision    recall  f1-score   support

           0   0.695745  0.601103  0.644970       544
           1   0.476454  0.774775  0.590051       222
           2   0.303922  0.185629  0.230483       167

    accuracy                       0.568060       933
   macro avg   0.492040  0.520502  0.488502       933
weighted avg   0.573433  0.568060  0.557713       933

Test Acc: 0.5680600214362272 F1_ma:0.437726842788324
Train step: 1120 acc:0.72172 total_loss: 1.0131  loss:1.0951,stance loss: 1.2758 
Train step: 1130 acc:0.72194 total_loss: 1.0152  loss:1.0046,stance loss: 0.85099 
Train step: 1140 acc:0.72532 total_loss: 1.0126  loss:1.2995,stance loss: 1.5586 
Better F1! Saving model!
Saving model of best f1: 0.44070907285054195
              precision    recall  f1-score   support

           0   0.694690  0.577206  0.630522       544
           1   0.468835  0.779279  0.585448       222
           2   0.312500  0.209581  0.250896       167

    accuracy                       0.559486       933
   macro avg   0.492008  0.522022  0.488956       933
weighted avg   0.572541  0.559486  0.551847       933

Test Acc: 0.5594855305466238 F1_ma:0.44070907285054195
Train step: 1150 acc:0.7268 total_loss: 1.0073  loss:1.0328,stance loss: 0.86993 
Better F1! Saving model!
Saving model of best f1: 0.4418658341236099
              precision    recall  f1-score   support

           0   0.702517  0.564338  0.625892       544
           1   0.470745  0.797297  0.591973       222
           2   0.308333  0.221557  0.257840       167

    accuracy                       0.558414       933
   macro avg   0.493865  0.527731  0.491902       933
weighted avg   0.576813  0.558414  0.551943       933

Test Acc: 0.5584137191854234 F1_ma:0.4418658341236099
Train step: 1160 acc:0.72846 total_loss: 1.0054  loss:1.1791,stance loss: 1.4443 
Train step: 1170 acc:0.73028 total_loss: 0.99923  loss:0.41822,stance loss: 0.22881 
Train step: 1180 acc:0.73065 total_loss: 0.994  loss:1.0618,stance loss: 0.93249 
Train step: 1190 acc:0.73007 total_loss: 0.99762  loss:1.5315,stance loss: 1.09 
Train step: 1200 acc:0.7307 total_loss: 1.0023  loss:1.2448,stance loss: 1.2182 
Train step: 1210 acc:0.73183 total_loss: 1.0029  loss:0.90447,stance loss: 0.69681 
Train step: 1220 acc:0.73391 total_loss: 1.0011  loss:0.76349,stance loss: 0.59933 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.625 total_loss: 1.198  loss:1.198,stance loss: 0.89022 
Train step: 1240 acc:0.75568 total_loss: 0.96087  loss:1.1153,stance loss: 0.93095 
Train step: 1250 acc:0.76488 total_loss: 0.93816  loss:0.88692,stance loss: 0.70136 
Better F1! Saving model!
Saving model of best f1: 0.4493477679038971
              precision    recall  f1-score   support

           0   0.692632  0.604779  0.645731       544
           1   0.459677  0.770270  0.575758       222
           2   0.372093  0.191617  0.252964       167

    accuracy                       0.570204       933
   macro avg   0.508134  0.522222  0.491484       933
weighted avg   0.579828  0.570204  0.558779       933

Test Acc: 0.5702036441586281 F1_ma:0.4493477679038971
Train step: 1260 acc:0.76613 total_loss: 0.92729  loss:1.0664,stance loss: 1.1868 
Train step: 1270 acc:0.74695 total_loss: 0.96041  loss:0.69001,stance loss: 0.49308 
Train step: 1280 acc:0.75123 total_loss: 0.9541  loss:0.92219,stance loss: 0.71024 
Train step: 1290 acc:0.75512 total_loss: 0.94697  loss:0.70067,stance loss: 0.51231 
Train step: 1300 acc:0.76408 total_loss: 0.94256  loss:0.66634,stance loss: 0.60264 
Train step: 1310 acc:0.75772 total_loss: 0.93546  loss:0.7912,stance loss: 0.50015 
Train step: 1320 acc:0.75893 total_loss: 0.93129  loss:0.41877,stance loss: 0.25316 
Train step: 1330 acc:0.75866 total_loss: 0.92584  loss:0.9565,stance loss: 0.77405 
Train step: 1340 acc:0.75394 total_loss: 0.93226  loss:0.7663,stance loss: 0.64336 
Train step: 1350 acc:0.75568 total_loss: 0.92689  loss:0.5778,stance loss: 0.43216 
Train step: 1360 acc:0.75906 total_loss: 0.91256  loss:0.70789,stance loss: 0.59214 
Train step: 1370 acc:0.76064 total_loss: 0.91928  loss:0.84412,stance loss: 0.60076 
Train step: 1380 acc:0.76242 total_loss: 0.91784  loss:0.69666,stance loss: 0.50776 
Train step: 1390 acc:0.76514 total_loss: 0.91321  loss:0.76756,stance loss: 0.63754 
Train step: 1400 acc:0.76279 total_loss: 0.91296  loss:1.4793,stance loss: 1.2308 
Train step: 1410 acc:0.76174 total_loss: 0.91364  loss:1.0478,stance loss: 0.87247 
Train step: 1420 acc:0.75884 total_loss: 0.91824  loss:1.2037,stance loss: 1.4839 
Train step: 1430 acc:0.75622 total_loss: 0.92005  loss:0.79617,stance loss: 0.50251 
Train step: 1440 acc:0.75652 total_loss: 0.92688  loss:1.0038,stance loss: 0.80894 
Train step: 1450 acc:0.75764 total_loss: 0.92276  loss:0.59245,stance loss: 0.44362 
Train step: 1460 acc:0.75812 total_loss: 0.92625  loss:1.8185,stance loss: 1.8112 
Train step: 1470 acc:0.75648 total_loss: 0.92535  loss:0.95593,stance loss: 0.68826 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.775 total_loss: 0.83775  loss:0.81335,stance loss: 0.6893 
Train step: 1490 acc:0.7625 total_loss: 0.81969  loss:1.1165,stance loss: 1.029 
Train step: 1500 acc:0.77 total_loss: 0.83941  loss:0.94615,stance loss: 0.71493 
Train step: 1510 acc:0.77143 total_loss: 0.86234  loss:0.80977,stance loss: 0.49017 
Train step: 1520 acc:0.77639 total_loss: 0.87486  loss:0.67559,stance loss: 0.67127 
Train step: 1530 acc:0.77614 total_loss: 0.86659  loss:1.0449,stance loss: 0.7511 
Train step: 1540 acc:0.77788 total_loss: 0.86446  loss:0.61774,stance loss: 0.49828 
Better F1! Saving model!
Saving model of best f1: 0.45267131242741004
              precision    recall  f1-score   support

           0   0.685345  0.584559  0.630952       544
           1   0.500000  0.693694  0.581132       222
           2   0.279503  0.269461  0.274390       167

    accuracy                       0.554126       933
   macro avg   0.488283  0.515905  0.495492       933
weighted avg   0.568601  0.554126  0.555276       933

Test Acc: 0.5541264737406216 F1_ma:0.45267131242741004
Train step: 1550 acc:0.77667 total_loss: 0.86105  loss:0.99457,stance loss: 0.72026 
Train step: 1560 acc:0.78382 total_loss: 0.84046  loss:0.34104,stance loss: 0.11142 
Train step: 1570 acc:0.78553 total_loss: 0.83449  loss:0.84048,stance loss: 0.58003 
Train step: 1580 acc:0.7869 total_loss: 0.82855  loss:0.96955,stance loss: 1.3471 
Train step: 1590 acc:0.78913 total_loss: 0.84164  loss:1.8265,stance loss: 2.0941 
Train step: 1600 acc:0.786 total_loss: 0.84344  loss:0.67397,stance loss: 0.47367 
Train step: 1610 acc:0.78472 total_loss: 0.83787  loss:0.50654,stance loss: 0.11347 
Train step: 1620 acc:0.78233 total_loss: 0.84857  loss:1.3885,stance loss: 1.626 
Train step: 1630 acc:0.78508 total_loss: 0.84372  loss:0.92751,stance loss: 1.2509 
Train step: 1640 acc:0.78333 total_loss: 0.84153  loss:0.63685,stance loss: 0.50572 
Train step: 1650 acc:0.78107 total_loss: 0.84267  loss:0.69322,stance loss: 0.50417 
Better F1! Saving model!
Saving model of best f1: 0.4565159037235672
              precision    recall  f1-score   support

           0   0.706494  0.500000  0.585576       544
           1   0.484277  0.693694  0.570370       222
           2   0.282609  0.389222  0.327456       167

    accuracy                       0.526259       933
   macro avg   0.491126  0.527638  0.494467       933
weighted avg   0.577747  0.526259  0.535756       933

Test Acc: 0.5262593783494105 F1_ma:0.4565159037235672
Train step: 1660 acc:0.78209 total_loss: 0.84059  loss:0.52793,stance loss: 0.40276 
Train step: 1670 acc:0.78237 total_loss: 0.8416  loss:0.86008,stance loss: 0.66561 
Train step: 1680 acc:0.78323 total_loss: 0.84011  loss:0.99362,stance loss: 1.0948 
Better F1! Saving model!
Saving model of best f1: 0.4582357117500887
              precision    recall  f1-score   support

           0   0.706329  0.512868  0.594249       544
           1   0.472464  0.734234  0.574956       222
           2   0.300518  0.347305  0.322222       167

    accuracy                       0.535906       933
   macro avg   0.493104  0.531469  0.497142       933
weighted avg   0.578046  0.535906  0.540968       933

Test Acc: 0.5359056806002144 F1_ma:0.4582357117500887
Train step: 1690 acc:0.78459 total_loss: 0.83748  loss:0.59393,stance loss: 0.40354 
Train step: 1700 acc:0.785 total_loss: 0.84407  loss:1.5877,stance loss: 1.0414 
Train step: 1710 acc:0.78723 total_loss: 0.83749  loss:0.70403,stance loss: 0.38373 
Train step: 1720 acc:0.78622 total_loss: 0.83456  loss:0.90457,stance loss: 0.72917 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.8125 total_loss: 0.7563  loss:1.0702,stance loss: 0.72083 
Train step: 1740 acc:0.79934 total_loss: 0.79517  loss:0.88667,stance loss: 0.75446 
Train step: 1750 acc:0.80388 total_loss: 0.769  loss:0.83879,stance loss: 0.69647 
Train step: 1760 acc:0.81891 total_loss: 0.72848  loss:0.44078,stance loss: 0.28441 
Train step: 1770 acc:0.8176 total_loss: 0.72096  loss:0.62681,stance loss: 0.4111 
Train step: 1780 acc:0.82309 total_loss: 0.70228  loss:0.5154,stance loss: 0.34223 
Train step: 1790 acc:0.82518 total_loss: 0.70482  loss:0.69976,stance loss: 0.56227 
Train step: 1800 acc:0.82595 total_loss: 0.70106  loss:0.51897,stance loss: 0.40104 
Train step: 1810 acc:0.83146 total_loss: 0.69339  loss:0.58934,stance loss: 0.49979 
Train step: 1820 acc:0.83144 total_loss: 0.69527  loss:0.82137,stance loss: 0.6498 
Train step: 1830 acc:0.82856 total_loss: 0.69276  loss:0.98126,stance loss: 0.82482 
Train step: 1840 acc:0.83141 total_loss: 0.68895  loss:0.62718,stance loss: 0.48644 
Train step: 1850 acc:0.83479 total_loss: 0.69259  loss:0.6867,stance loss: 0.48041 
Train step: 1860 acc:0.83273 total_loss: 0.69881  loss:0.95384,stance loss: 0.75019 
Train step: 1870 acc:0.82928 total_loss: 0.70076  loss:0.84999,stance loss: 0.75267 
Train step: 1880 acc:0.82704 total_loss: 0.70643  loss:0.90935,stance loss: 0.73208 
Train step: 1890 acc:0.82729 total_loss: 0.70957  loss:0.42022,stance loss: 0.40213 
Train step: 1900 acc:0.82542 total_loss: 0.71049  loss:0.69114,stance loss: 0.50404 
Train step: 1910 acc:0.82341 total_loss: 0.71047  loss:0.95569,stance loss: 1.2118 
Train step: 1920 acc:0.82381 total_loss: 0.71667  loss:0.65683,stance loss: 0.53937 
Train step: 1930 acc:0.82207 total_loss: 0.72052  loss:0.84348,stance loss: 0.74656 
Train step: 1940 acc:0.81678 total_loss: 0.73183  loss:0.78815,stance loss: 0.56922 
Train step: 1950 acc:0.81796 total_loss: 0.72992  loss:0.40221,stance loss: 0.27216 
Train step: 1960 acc:0.81616 total_loss: 0.73388  loss:0.75171,stance loss: 0.56707 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.85417 total_loss: 0.65656  loss:0.66579,stance loss: 0.44734 
Train step: 1980 acc:0.80769 total_loss: 0.74351  loss:0.45478,stance loss: 0.38699 
Train step: 1990 acc:0.82337 total_loss: 0.7389  loss:0.85698,stance loss: 0.6373 
Train step: 2000 acc:0.83712 total_loss: 0.72388  loss:0.6799,stance loss: 0.54244 
Train step: 2010 acc:0.83576 total_loss: 0.72598  loss:0.76958,stance loss: 0.56572 
Train step: 2020 acc:0.84198 total_loss: 0.7206  loss:0.77012,stance loss: 0.56919 
Train step: 2030 acc:0.83433 total_loss: 0.73569  loss:0.60002,stance loss: 0.50262 
Train step: 2040 acc:0.84075 total_loss: 0.70231  loss:0.41089,stance loss: 0.32152 
Train step: 2050 acc:0.84337 total_loss: 0.69545  loss:1.2522,stance loss: 1.5002 
Train step: 2060 acc:0.84409 total_loss: 0.69195  loss:0.46723,stance loss: 0.34051 
Train step: 2070 acc:0.84223 total_loss: 0.68613  loss:0.52731,stance loss: 0.35305 
Train step: 2080 acc:0.84126 total_loss: 0.67462  loss:0.5995,stance loss: 0.52296 
Train step: 2090 acc:0.84146 total_loss: 0.67515  loss:0.68176,stance loss: 0.56841 
Train step: 2100 acc:0.84117 total_loss: 0.67896  loss:0.22106,stance loss: 0.12629 
Train step: 2110 acc:0.84178 total_loss: 0.67508  loss:0.89176,stance loss: 0.95354 
Train step: 2120 acc:0.83742 total_loss: 0.68709  loss:0.62411,stance loss: 0.51971 
Train step: 2130 acc:0.83627 total_loss: 0.68529  loss:0.69628,stance loss: 0.67383 
Train step: 2140 acc:0.8349 total_loss: 0.68288  loss:0.81234,stance loss: 0.53428 
Train step: 2150 acc:0.83572 total_loss: 0.68259  loss:0.52937,stance loss: 0.39865 
Train step: 2160 acc:0.83549 total_loss: 0.68395  loss:0.99384,stance loss: 0.74223 
Train step: 2170 acc:0.83559 total_loss: 0.67903  loss:0.60307,stance loss: 0.46414 
Train step: 2180 acc:0.83568 total_loss: 0.67816  loss:0.92692,stance loss: 0.83522 
Train step: 2190 acc:0.83688 total_loss: 0.67207  loss:0.45466,stance loss: 0.40536 
Train step: 2200 acc:0.83718 total_loss: 0.67253  loss:0.5221,stance loss: 0.41482 
Train step: 2210 acc:0.83771 total_loss: 0.6696  loss:0.32738,stance loss: 0.22636 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.91964 total_loss: 0.45974  loss:0.40126,stance loss: 0.31411 
Train step: 2230 acc:0.90441 total_loss: 0.52859  loss:0.36923,stance loss: 0.18656 
Train step: 2240 acc:0.88657 total_loss: 0.55617  loss:0.38743,stance loss: 0.29885 
Train step: 2250 acc:0.88007 total_loss: 0.58174  loss:0.45428,stance loss: 0.33695 
Train step: 2260 acc:0.87367 total_loss: 0.58137  loss:0.34157,stance loss: 0.20321 
Train step: 2270 acc:0.8761 total_loss: 0.57418  loss:0.29367,stance loss: 0.18954 
Train step: 2280 acc:0.87873 total_loss: 0.55994  loss:0.67354,stance loss: 0.50532 
Train step: 2290 acc:0.87662 total_loss: 0.56652  loss:1.0704,stance loss: 1.3273 
Train step: 2300 acc:0.88003 total_loss: 0.56165  loss:0.24081,stance loss: 0.18243 
Train step: 2310 acc:0.87951 total_loss: 0.55734  loss:0.65743,stance loss: 0.52338 
Train step: 2320 acc:0.87266 total_loss: 0.57398  loss:0.81218,stance loss: 0.64951 
Train step: 2330 acc:0.86966 total_loss: 0.57298  loss:0.91257,stance loss: 0.64725 
Train step: 2340 acc:0.86959 total_loss: 0.56788  loss:0.98049,stance loss: 1.3129 
Train step: 2350 acc:0.86816 total_loss: 0.56939  loss:0.66218,stance loss: 0.63661 
Train step: 2360 acc:0.86607 total_loss: 0.57286  loss:0.41709,stance loss: 0.2621 
Train step: 2370 acc:0.86584 total_loss: 0.57527  loss:0.2165,stance loss: 0.13346 
Train step: 2380 acc:0.86602 total_loss: 0.58234  loss:0.58498,stance loss: 0.47923 
Train step: 2390 acc:0.86688 total_loss: 0.58056  loss:0.48219,stance loss: 0.3205 
Train step: 2400 acc:0.86865 total_loss: 0.57712  loss:0.34415,stance loss: 0.26946 
Train step: 2410 acc:0.86834 total_loss: 0.57798  loss:0.36691,stance loss: 0.23966 
Train step: 2420 acc:0.86655 total_loss: 0.57867  loss:0.47523,stance loss: 0.40198 
Train step: 2430 acc:0.8655 total_loss: 0.57836  loss:0.6777,stance loss: 0.54491 
Train step: 2440 acc:0.86509 total_loss: 0.58008  loss:0.6944,stance loss: 0.56898 
Train step: 2450 acc:0.8663 total_loss: 0.57776  loss:0.48887,stance loss: 0.42471 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.75 total_loss: 0.63835  loss:0.63835,stance loss: 0.47712 
Train step: 2470 acc:0.85795 total_loss: 0.49  loss:0.39624,stance loss: 0.29347 
Train step: 2480 acc:0.8631 total_loss: 0.49396  loss:0.67647,stance loss: 0.51284 
Better F1! Saving model!
Saving model of best f1: 0.46102669177775457
              precision    recall  f1-score   support

           0   0.684100  0.601103  0.639922       544
           1   0.475248  0.648649  0.548571       222
           2   0.296053  0.269461  0.282132       167

    accuracy                       0.553055       933
   macro avg   0.485134  0.506404  0.490208       933
weighted avg   0.564948  0.553055  0.554144       933

Test Acc: 0.5530546623794212 F1_ma:0.46102669177775457
Train step: 2490 acc:0.87903 total_loss: 0.4888  loss:0.37852,stance loss: 0.33154 
Better F1! Saving model!
Saving model of best f1: 0.46602564102564104
              precision    recall  f1-score   support

           0   0.681452  0.621324  0.650000       544
           1   0.479452  0.630631  0.544747       222
           2   0.303448  0.263473  0.282051       167

    accuracy                       0.559486       933
   macro avg   0.488117  0.505142  0.492266       933
weighted avg   0.565728  0.559486  0.559096       933

Test Acc: 0.5594855305466238 F1_ma:0.46602564102564104
Train step: 2500 acc:0.8811 total_loss: 0.51803  loss:0.77909,stance loss: 0.80662 
Train step: 2510 acc:0.87868 total_loss: 0.52483  loss:0.35156,stance loss: 0.22692 
Train step: 2520 acc:0.88217 total_loss: 0.52174  loss:0.95731,stance loss: 1.3518 
Train step: 2530 acc:0.88292 total_loss: 0.51154  loss:0.42214,stance loss: 0.28966 
Train step: 2540 acc:0.87963 total_loss: 0.52066  loss:0.81942,stance loss: 0.46858 
Train step: 2550 acc:0.87912 total_loss: 0.52635  loss:0.44461,stance loss: 0.3485 
Train step: 2560 acc:0.87748 total_loss: 0.52563  loss:0.65929,stance loss: 0.68363 
Train step: 2570 acc:0.8795 total_loss: 0.5184  loss:0.30046,stance loss: 0.24089 
Train step: 2580 acc:0.87758 total_loss: 0.51953  loss:0.45998,stance loss: 0.38156 
Train step: 2590 acc:0.87739 total_loss: 0.52597  loss:0.56513,stance loss: 0.49288 
Train step: 2600 acc:0.87456 total_loss: 0.53424  loss:0.67045,stance loss: 0.45294 
Train step: 2610 acc:0.875 total_loss: 0.5338  loss:0.55137,stance loss: 0.48474 
Train step: 2620 acc:0.87733 total_loss: 0.52871  loss:0.35136,stance loss: 0.31442 
Better F1! Saving model!
Saving model of best f1: 0.4863919734156009
              precision    recall  f1-score   support

           0   0.679920  0.628676  0.653295       544
           1   0.478873  0.612613  0.537549       222
           2   0.342466  0.299401  0.319489       167

    accuracy                       0.565916       933
   macro avg   0.500420  0.513563  0.503444       933
weighted avg   0.571681  0.565916  0.566006       933

Test Acc: 0.5659163987138264 F1_ma:0.4863919734156009
Train step: 2630 acc:0.87939 total_loss: 0.52419  loss:0.9052,stance loss: 1.3301 
Train step: 2640 acc:0.88052 total_loss: 0.52257  loss:0.22441,stance loss: 0.1104 
Train step: 2650 acc:0.88122 total_loss: 0.52023  loss:0.27713,stance loss: 0.19057 
Train step: 2660 acc:0.88091 total_loss: 0.52224  loss:0.33357,stance loss: 0.27784 
Train step: 2670 acc:0.88063 total_loss: 0.52237  loss:0.38721,stance loss: 0.16094 
Train step: 2680 acc:0.88207 total_loss: 0.51677  loss:0.22068,stance loss: 0.14417 
Train step: 2690 acc:0.88339 total_loss: 0.51364  loss:0.60922,stance loss: 0.54512 
Train step: 2700 acc:0.88304 total_loss: 0.5191  loss:0.50059,stance loss: 0.306 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.8875 total_loss: 0.41169  loss:0.62219,stance loss: 0.44253 
Train step: 2720 acc:0.9 total_loss: 0.42654  loss:0.34802,stance loss: 0.2059 
Train step: 2730 acc:0.9175 total_loss: 0.40312  loss:0.22252,stance loss: 0.1583 
Train step: 2740 acc:0.91964 total_loss: 0.40469  loss:0.73419,stance loss: 1.0447 
Train step: 2750 acc:0.9125 total_loss: 0.40959  loss:0.29221,stance loss: 0.1293 
Train step: 2760 acc:0.91932 total_loss: 0.40402  loss:0.2094,stance loss: 0.16755 
Train step: 2770 acc:0.91442 total_loss: 0.41333  loss:0.37666,stance loss: 0.28478 
Train step: 2780 acc:0.91167 total_loss: 0.41054  loss:0.85547,stance loss: 0.77614 
Train step: 2790 acc:0.91176 total_loss: 0.41269  loss:0.45997,stance loss: 0.357 
Train step: 2800 acc:0.91316 total_loss: 0.41924  loss:0.56257,stance loss: 0.46958 
Train step: 2810 acc:0.90952 total_loss: 0.42594  loss:0.20827,stance loss: 0.13789 
Train step: 2820 acc:0.90924 total_loss: 0.43309  loss:0.36373,stance loss: 0.26698 
Train step: 2830 acc:0.909 total_loss: 0.43659  loss:0.59221,stance loss: 0.44081 
Train step: 2840 acc:0.90787 total_loss: 0.44255  loss:0.34197,stance loss: 0.26979 
Train step: 2850 acc:0.91121 total_loss: 0.43003  loss:0.25373,stance loss: 0.19936 
Better F1! Saving model!
Saving model of best f1: 0.4905790079341046
              precision    recall  f1-score   support

           0   0.686627  0.632353  0.658373       544
           1   0.487633  0.621622  0.546535       222
           2   0.342282  0.305389  0.322785       167

    accuracy                       0.571275       933
   macro avg   0.505514  0.519788  0.509231       933
weighted avg   0.577642  0.571275  0.571694       933

Test Acc: 0.5712754555198285 F1_ma:0.4905790079341046
Train step: 2860 acc:0.91089 total_loss: 0.43332  loss:1.048,stance loss: 1.426 
Train step: 2870 acc:0.91023 total_loss: 0.43403  loss:0.10076,stance loss: 0.058562 
Train step: 2880 acc:0.90929 total_loss: 0.43276  loss:0.55877,stance loss: 0.4887 
Train step: 2890 acc:0.91115 total_loss: 0.4295  loss:0.31603,stance loss: 0.2504 
Train step: 2900 acc:0.9125 total_loss: 0.42398  loss:0.19873,stance loss: 0.099008 
Train step: 2910 acc:0.91189 total_loss: 0.42986  loss:0.70064,stance loss: 1.0879 
Train step: 2920 acc:0.91192 total_loss: 0.43267  loss:0.46615,stance loss: 0.41881 
Train step: 2930 acc:0.91139 total_loss: 0.43366  loss:0.33271,stance loss: 0.28662 
Train step: 2940 acc:0.91144 total_loss: 0.43562  loss:0.47599,stance loss: 0.4129 
Train step: 2950 acc:0.91122 total_loss: 0.43685  loss:0.48483,stance loss: 0.3219 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.95139 total_loss: 0.31094  loss:0.0784,stance loss: 0.021788 
Train step: 2970 acc:0.94079 total_loss: 0.41441  loss:0.34216,stance loss: 0.23457 
Train step: 2980 acc:0.9375 total_loss: 0.38906  loss:0.70377,stance loss: 0.56704 
Train step: 2990 acc:0.93269 total_loss: 0.36973  loss:0.27785,stance loss: 0.18864 
Train step: 3000 acc:0.93495 total_loss: 0.36559  loss:0.21021,stance loss: 0.19202 
Train step: 3010 acc:0.93538 total_loss: 0.38545  loss:0.18353,stance loss: 0.1048 
Train step: 3020 acc:0.93297 total_loss: 0.38099  loss:0.42142,stance loss: 0.39147 
Train step: 3030 acc:0.93196 total_loss: 0.39603  loss:0.42065,stance loss: 0.39618 
Train step: 3040 acc:0.92837 total_loss: 0.39761  loss:0.63542,stance loss: 0.52257 
Train step: 3050 acc:0.92614 total_loss: 0.38897  loss:0.24657,stance loss: 0.1247 
Train step: 3060 acc:0.93005 total_loss: 0.38233  loss:0.36425,stance loss: 0.32337 
Train step: 3070 acc:0.93067 total_loss: 0.38043  loss:0.13504,stance loss: 0.05553 
Train step: 3080 acc:0.92829 total_loss: 0.39395  loss:0.70801,stance loss: 0.56145 
Train step: 3090 acc:0.92896 total_loss: 0.39385  loss:0.70841,stance loss: 1.0651 
Train step: 3100 acc:0.92869 total_loss: 0.39318  loss:0.3581,stance loss: 0.31123 
Train step: 3110 acc:0.93042 total_loss: 0.38887  loss:0.2924,stance loss: 0.18986 
Train step: 3120 acc:0.92825 total_loss: 0.394  loss:0.74005,stance loss: 0.61488 
Train step: 3130 acc:0.92877 total_loss: 0.39129  loss:0.35874,stance loss: 0.28752 
Train step: 3140 acc:0.92857 total_loss: 0.38892  loss:0.38892,stance loss: 0.30086 
Train step: 3150 acc:0.92871 total_loss: 0.38873  loss:0.43883,stance loss: 0.38921 
Train step: 3160 acc:0.92883 total_loss: 0.38834  loss:0.44595,stance loss: 0.30662 
Train step: 3170 acc:0.92865 total_loss: 0.3877  loss:0.3013,stance loss: 0.26998 
Train step: 3180 acc:0.92877 total_loss: 0.38717  loss:0.23951,stance loss: 0.077295 
Train step: 3190 acc:0.92835 total_loss: 0.38727  loss:0.224,stance loss: 0.19118 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.89583 total_loss: 0.44851  loss:0.46177,stance loss: 0.34015 
Train step: 3210 acc:0.96154 total_loss: 0.35233  loss:0.61633,stance loss: 1.0424 
Train step: 3220 acc:0.95109 total_loss: 0.29862  loss:0.26986,stance loss: 0.21634 
Train step: 3230 acc:0.9375 total_loss: 0.31221  loss:0.43219,stance loss: 0.36981 
Train step: 3240 acc:0.93605 total_loss: 0.32982  loss:0.36704,stance loss: 0.30862 
Train step: 3250 acc:0.9375 total_loss: 0.30776  loss:0.20672,stance loss: 0.15607 
Train step: 3260 acc:0.9375 total_loss: 0.30703  loss:0.17006,stance loss: 0.066024 
Train step: 3270 acc:0.93836 total_loss: 0.30456  loss:0.74971,stance loss: 0.5847 
Train step: 3280 acc:0.9375 total_loss: 0.30453  loss:0.17529,stance loss: 0.10289 
Train step: 3290 acc:0.94019 total_loss: 0.30665  loss:0.43904,stance loss: 0.40456 
Train step: 3300 acc:0.93871 total_loss: 0.31413  loss:0.17096,stance loss: 0.16937 
Train step: 3310 acc:0.93529 total_loss: 0.32192  loss:0.23748,stance loss: 0.22382 
Train step: 3320 acc:0.93852 total_loss: 0.30886  loss:0.12241,stance loss: 0.09974 
Train step: 3330 acc:0.93797 total_loss: 0.30967  loss:0.070294,stance loss: 0.0022143 
Train step: 3340 acc:0.9375 total_loss: 0.30775  loss:0.070545,stance loss: 0.02517 
Train step: 3350 acc:0.93587 total_loss: 0.31867  loss:0.62263,stance loss: 1.0132 
Train step: 3360 acc:0.93443 total_loss: 0.31767  loss:0.47354,stance loss: 0.38947 
Train step: 3370 acc:0.93461 total_loss: 0.31516  loss:0.15813,stance loss: 0.10346 
Train step: 3380 acc:0.93408 total_loss: 0.31873  loss:0.41518,stance loss: 0.35701 
Train step: 3390 acc:0.93459 total_loss: 0.32031  loss:0.61083,stance loss: 1.0109 
Train step: 3400 acc:0.93442 total_loss: 0.3206  loss:0.041901,stance loss: 0.017118 
Train step: 3410 acc:0.93545 total_loss: 0.31824  loss:0.18404,stance loss: 0.15087 
Train step: 3420 acc:0.93498 total_loss: 0.31997  loss:0.36957,stance loss: 0.23904 
Train step: 3430 acc:0.93482 total_loss: 0.31943  loss:0.99696,stance loss: 1.2741 
Train step: 3440 acc:0.93364 total_loss: 0.32259  loss:0.24531,stance loss: 0.18242 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.97321 total_loss: 0.33476  loss:0.71262,stance loss: 1.1228 
Train step: 3460 acc:0.97059 total_loss: 0.24571  loss:0.26666,stance loss: 0.15378 
Train step: 3470 acc:0.96759 total_loss: 0.24768  loss:0.078312,stance loss: 0.036706 
Train step: 3480 acc:0.95777 total_loss: 0.24353  loss:0.19582,stance loss: 0.055863 
Train step: 3490 acc:0.96011 total_loss: 0.23338  loss:0.13293,stance loss: 0.17692 
Train step: 3500 acc:0.95943 total_loss: 0.25366  loss:0.20547,stance loss: 0.068849 
Train step: 3510 acc:0.96082 total_loss: 0.24235  loss:0.21268,stance loss: 0.086325 
Train step: 3520 acc:0.96023 total_loss: 0.24972  loss:0.60274,stance loss: 1.0433 
Train step: 3530 acc:0.95618 total_loss: 0.25264  loss:0.16115,stance loss: 0.1106 
Train step: 3540 acc:0.95619 total_loss: 0.25725  loss:0.54999,stance loss: 0.36833 
Train step: 3550 acc:0.95561 total_loss: 0.25583  loss:0.049561,stance loss: 0.0094183 
Train step: 3560 acc:0.95459 total_loss: 0.26215  loss:0.090034,stance loss: 0.051006 
Train step: 3570 acc:0.95472 total_loss: 0.25974  loss:0.58563,stance loss: 1.0463 
Train step: 3580 acc:0.95529 total_loss: 0.26602  loss:0.55806,stance loss: 0.31491 
Train step: 3590 acc:0.95578 total_loss: 0.26779  loss:0.079282,stance loss: 0.023359 
Train step: 3600 acc:0.95701 total_loss: 0.26786  loss:0.029102,stance loss: 0.0021195 
Train step: 3610 acc:0.95584 total_loss: 0.26791  loss:0.064337,stance loss: 0.040981 
Train step: 3620 acc:0.95516 total_loss: 0.27035  loss:0.69808,stance loss: 1.1796 
Train step: 3630 acc:0.95622 total_loss: 0.2687  loss:0.11561,stance loss: 0.038119 
Train step: 3640 acc:0.95622 total_loss: 0.27171  loss:0.70681,stance loss: 1.1587 
Train step: 3650 acc:0.95622 total_loss: 0.27384  loss:0.08752,stance loss: 0.072056 
Train step: 3660 acc:0.95507 total_loss: 0.27308  loss:0.38754,stance loss: 0.30437 
Train step: 3670 acc:0.9543 total_loss: 0.27466  loss:0.28388,stance loss: 0.2789 
Train step: 3680 acc:0.95385 total_loss: 0.27349  loss:0.1584,stance loss: 0.089249 
Training finished.


Reload the best model with best f1 0.4905790079341046 from path test_outputs/bert-cross-topic/la/2023-08-14 17-00-27/state_dict


              precision    recall  f1-score   support

           0   0.686627  0.632353  0.658373       544
           1   0.487633  0.621622  0.546535       222
           2   0.342282  0.305389  0.322785       167

    accuracy                       0.571275       933
   macro avg   0.505514  0.519788  0.509231       933
weighted avg   0.577642  0.571275  0.571694       933

Test Acc: 0.5712754555198285 F1_ma:0.4905790079341046
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4905790079341046
acc: 0.5712754555198285, f1 :0.5092308897778518
classification report: 
              precision    recall  f1-score   support

         Con     0.6866    0.6324    0.6584       544
        None     0.4876    0.6216    0.5465       222
         Pro     0.3423    0.3054    0.3228       167

    accuracy                         0.5713       933
   macro avg     0.5055    0.5198    0.5092       933
weighted avg     0.5776    0.5713    0.5717       933

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 17-39-12', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 17-39-12
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.6638  loss:1.6638,stance loss: 1.1554 
Train step: 10 acc:0.40341 total_loss: 1.6963  loss:1.6339,stance loss: 1.1649 
Better F1! Saving model!
Saving model of best f1: 0.36831415030467163
              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Train step: 20 acc:0.4256 total_loss: 1.6774  loss:1.7886,stance loss: 1.2816 
Train step: 30 acc:0.45968 total_loss: 1.6618  loss:1.8723,stance loss: 1.7232 
Train step: 40 acc:0.45274 total_loss: 1.6639  loss:1.566,stance loss: 1.1315 
Train step: 50 acc:0.44608 total_loss: 1.6582  loss:1.8039,stance loss: 1.1808 
Train step: 60 acc:0.45902 total_loss: 1.6543  loss:1.4523,stance loss: 0.85264 
Better F1! Saving model!
Saving model of best f1: 0.3685636856368564
              precision    recall  f1-score   support

           0   0.583691  1.000000  0.737127       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194564  0.333333  0.245709       933
weighted avg   0.340330  0.583065  0.429793       933

Test Acc: 0.5830653804930332 F1_ma:0.3685636856368564
Train step: 70 acc:0.45246 total_loss: 1.6498  loss:1.634,stance loss: 1.0772 
Train step: 80 acc:0.45448 total_loss: 1.6474  loss:1.5783,stance loss: 1.3036 
Train step: 90 acc:0.45948 total_loss: 1.6354  loss:1.4045,stance loss: 0.88995 
Train step: 100 acc:0.45978 total_loss: 1.6323  loss:1.517,stance loss: 0.9981 
Train step: 110 acc:0.46284 total_loss: 1.6234  loss:1.3234,stance loss: 0.85441 
Better F1! Saving model!
Saving model of best f1: 0.3688135593220339
              precision    recall  f1-score   support

           0   0.584318  1.000000  0.737627       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194773  0.333333  0.245876       933
weighted avg   0.340696  0.583065  0.430085       933

Test Acc: 0.5830653804930332 F1_ma:0.3688135593220339
Train step: 120 acc:0.46539 total_loss: 1.6181  loss:1.4775,stance loss: 0.9621 
Train step: 130 acc:0.46899 total_loss: 1.6131  loss:1.6234,stance loss: 1.3581 
Better F1! Saving model!
Saving model of best f1: 0.36906377204884666
              precision    recall  f1-score   support

           0   0.584946  1.000000  0.738128       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194982  0.333333  0.246043       933
weighted avg   0.341062  0.583065  0.430377       933

Test Acc: 0.5830653804930332 F1_ma:0.36906377204884666
Train step: 140 acc:0.47207 total_loss: 1.6055  loss:1.375,stance loss: 0.94629 
Better F1! Saving model!
Saving model of best f1: 0.3693877551020408
              precision    recall  f1-score   support

           0   0.586393  0.998162  0.738776       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.581994       933
   macro avg   0.195464  0.332721  0.246259       933
weighted avg   0.341906  0.581994  0.430754       933

Test Acc: 0.5819935691318328 F1_ma:0.3693877551020408
Train step: 150 acc:0.47599 total_loss: 1.6007  loss:1.5073,stance loss: 1.5445 
Train step: 160 acc:0.47943 total_loss: 1.594  loss:1.3395,stance loss: 0.93524 
Better F1! Saving model!
Saving model of best f1: 0.3694614860259032
              precision    recall  f1-score   support

           0   0.587216  0.996324  0.738923       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.580922       933
   macro avg   0.195739  0.332108  0.246308       933
weighted avg   0.342385  0.580922  0.430840       933

Test Acc: 0.5809217577706324 F1_ma:0.3694614860259032
Train step: 170 acc:0.48428 total_loss: 1.5892  loss:1.6665,stance loss: 1.4653 
Better F1! Saving model!
Saving model of best f1: 0.37170596393897365
              precision    recall  f1-score   support

           0   0.596882  0.985294  0.743412       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.574491       933
   macro avg   0.198961  0.328431  0.247804       933
weighted avg   0.348021  0.574491  0.433458       933

Test Acc: 0.5744908896034298 F1_ma:0.37170596393897365
Train step: 180 acc:0.48757 total_loss: 1.5807  loss:1.4922,stance loss: 1.0038 
Train step: 190 acc:0.49182 total_loss: 1.5703  loss:1.4537,stance loss: 1.0197 
Train step: 200 acc:0.5 total_loss: 1.5582  loss:1.2645,stance loss: 0.82006 
Train step: 210 acc:0.49911 total_loss: 1.5595  loss:1.5392,stance loss: 1.0727 
Train step: 220 acc:0.50396 total_loss: 1.5495  loss:1.3335,stance loss: 0.98984 
Train step: 230 acc:0.50595 total_loss: 1.5474  loss:1.5461,stance loss: 1.0152 
Train step: 240 acc:0.50856 total_loss: 1.5408  loss:1.4618,stance loss: 1.0704 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.6375 total_loss: 1.3445  loss:1.4965,stance loss: 1.5196 
Train step: 260 acc:0.6 total_loss: 1.3688  loss:1.3967,stance loss: 1.0747 
Train step: 270 acc:0.5975 total_loss: 1.376  loss:1.7986,stance loss: 1.7458 
Train step: 280 acc:0.59464 total_loss: 1.3751  loss:1.4314,stance loss: 1.0805 
Better F1! Saving model!
Saving model of best f1: 0.4535329533882408
              precision    recall  f1-score   support

           0   0.634318  0.829044  0.718725       544
           1   0.566265  0.423423  0.484536       222
           2   0.375000  0.125749  0.188341       167

    accuracy                       0.606645       933
   macro avg   0.525194  0.459405  0.463867       933
weighted avg   0.571709  0.606645  0.568067       933

Test Acc: 0.6066452304394426 F1_ma:0.4535329533882408
Train step: 290 acc:0.59028 total_loss: 1.3793  loss:1.4444,stance loss: 1.1386 
Better F1! Saving model!
Saving model of best f1: 0.4915364184288487
              precision    recall  f1-score   support

           0   0.658696  0.556985  0.603586       544
           1   0.512000  0.576577  0.542373       222
           2   0.331839  0.443114  0.379487       167

    accuracy                       0.541265       933
   macro avg   0.500845  0.525559  0.508482       933
weighted avg   0.565286  0.541265  0.548909       933

Test Acc: 0.5412647374062165 F1_ma:0.4915364184288487
Train step: 300 acc:0.58409 total_loss: 1.3792  loss:1.4063,stance loss: 1.1526 
Train step: 310 acc:0.57788 total_loss: 1.3694  loss:1.26,stance loss: 0.87905 
Train step: 320 acc:0.57667 total_loss: 1.3772  loss:1.3023,stance loss: 0.91089 
Train step: 330 acc:0.57353 total_loss: 1.3884  loss:1.7409,stance loss: 1.7276 
Train step: 340 acc:0.57961 total_loss: 1.3794  loss:1.6906,stance loss: 1.7769 
Train step: 350 acc:0.58095 total_loss: 1.3825  loss:1.4191,stance loss: 1.4929 
Train step: 360 acc:0.58478 total_loss: 1.3832  loss:1.5493,stance loss: 1.6342 
Train step: 370 acc:0.589 total_loss: 1.3788  loss:1.218,stance loss: 0.93018 
Train step: 380 acc:0.59074 total_loss: 1.3733  loss:1.274,stance loss: 0.84924 
Train step: 390 acc:0.59612 total_loss: 1.3687  loss:1.5829,stance loss: 1.7047 
Train step: 400 acc:0.59839 total_loss: 1.3634  loss:1.1249,stance loss: 0.8138 
Train step: 410 acc:0.59848 total_loss: 1.362  loss:1.1627,stance loss: 0.69909 
Train step: 420 acc:0.60321 total_loss: 1.3547  loss:1.3891,stance loss: 1.1788 
Train step: 430 acc:0.60507 total_loss: 1.3564  loss:1.1891,stance loss: 0.94843 
Train step: 440 acc:0.60769 total_loss: 1.3505  loss:1.0111,stance loss: 0.72373 
Train step: 450 acc:0.61067 total_loss: 1.3435  loss:1.2927,stance loss: 0.83052 
Train step: 460 acc:0.61453 total_loss: 1.335  loss:1.4712,stance loss: 1.6075 
Train step: 470 acc:0.61806 total_loss: 1.3263  loss:1.0006,stance loss: 0.6896 
Train step: 480 acc:0.61915 total_loss: 1.3221  loss:0.98207,stance loss: 0.66666 
Train step: 490 acc:0.6199 total_loss: 1.3188  loss:1.168,stance loss: 0.96007 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.69444 total_loss: 1.1475  loss:1.5367,stance loss: 1.6924 
Train step: 510 acc:0.69408 total_loss: 1.1791  loss:1.0597,stance loss: 0.88897 
Train step: 520 acc:0.68966 total_loss: 1.1826  loss:1.1392,stance loss: 0.89455 
Train step: 530 acc:0.68429 total_loss: 1.1938  loss:1.3528,stance loss: 1.131 
Train step: 540 acc:0.67985 total_loss: 1.1914  loss:1.2777,stance loss: 0.97989 
Train step: 550 acc:0.67055 total_loss: 1.2232  loss:1.6281,stance loss: 1.7442 
Train step: 560 acc:0.66576 total_loss: 1.2244  loss:1.3174,stance loss: 1.0401 
Train step: 570 acc:0.67405 total_loss: 1.2102  loss:1.1335,stance loss: 1.0039 
Train step: 580 acc:0.66713 total_loss: 1.205  loss:1.115,stance loss: 0.87432 
Train step: 590 acc:0.66414 total_loss: 1.2056  loss:1.1834,stance loss: 0.87675 
Train step: 600 acc:0.66686 total_loss: 1.2061  loss:1.2328,stance loss: 0.85444 
Train step: 610 acc:0.66597 total_loss: 1.1961  loss:1.1938,stance loss: 0.80901 
Train step: 620 acc:0.66618 total_loss: 1.1907  loss:1.0186,stance loss: 0.76107 
Train step: 630 acc:0.66951 total_loss: 1.1814  loss:0.71794,stance loss: 0.44288 
Train step: 640 acc:0.67114 total_loss: 1.1718  loss:1.2095,stance loss: 0.99429 
Train step: 650 acc:0.6702 total_loss: 1.1712  loss:1.5607,stance loss: 1.2527 
Train step: 660 acc:0.66864 total_loss: 1.1721  loss:1.0684,stance loss: 0.67868 
Train step: 670 acc:0.66725 total_loss: 1.1771  loss:1.3377,stance loss: 1.0491 
Train step: 680 acc:0.66865 total_loss: 1.1774  loss:1.2101,stance loss: 1.1439 
Train step: 690 acc:0.66928 total_loss: 1.1746  loss:0.89367,stance loss: 0.58489 
Train step: 700 acc:0.66866 total_loss: 1.1793  loss:1.0891,stance loss: 0.89414 
Train step: 710 acc:0.67066 total_loss: 1.1765  loss:0.88583,stance loss: 0.67261 
Train step: 720 acc:0.67194 total_loss: 1.1804  loss:1.6013,stance loss: 1.4086 
Train step: 730 acc:0.67469 total_loss: 1.178  loss:1.3805,stance loss: 1.4518 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.66667 total_loss: 1.2463  loss:0.89554,stance loss: 0.5988 
Train step: 750 acc:0.72115 total_loss: 1.0294  loss:0.86842,stance loss: 0.57213 
Train step: 760 acc:0.70109 total_loss: 1.1006  loss:1.1476,stance loss: 1.0097 
Train step: 770 acc:0.69318 total_loss: 1.1015  loss:1.2665,stance loss: 0.99075 
Train step: 780 acc:0.69041 total_loss: 1.098  loss:1.1603,stance loss: 1.0295 
Train step: 790 acc:0.68514 total_loss: 1.1121  loss:1.2808,stance loss: 1.5135 
Train step: 800 acc:0.67956 total_loss: 1.0965  loss:0.90909,stance loss: 0.64491 
Train step: 810 acc:0.68151 total_loss: 1.0903  loss:1.1643,stance loss: 0.96101 
Train step: 820 acc:0.68675 total_loss: 1.086  loss:1.1861,stance loss: 0.79221 
Train step: 830 acc:0.6828 total_loss: 1.0974  loss:1.3875,stance loss: 1.1712 
Train step: 840 acc:0.68993 total_loss: 1.091  loss:1.2472,stance loss: 0.93473 
Train step: 850 acc:0.69635 total_loss: 1.0811  loss:0.89776,stance loss: 0.70097 
Train step: 860 acc:0.69461 total_loss: 1.0837  loss:1.3178,stance loss: 1.1273 
Train step: 870 acc:0.69596 total_loss: 1.0852  loss:0.997,stance loss: 0.71734 
Train step: 880 acc:0.70017 total_loss: 1.0799  loss:0.79802,stance loss: 0.61051 
Train step: 890 acc:0.70139 total_loss: 1.0745  loss:0.94041,stance loss: 0.71691 
Train step: 900 acc:0.70207 total_loss: 1.0729  loss:0.95642,stance loss: 0.88516 
Train step: 910 acc:0.70303 total_loss: 1.0728  loss:1.1767,stance loss: 1.1484 
Train step: 920 acc:0.70287 total_loss: 1.0755  loss:1.2995,stance loss: 0.97235 
Train step: 930 acc:0.70207 total_loss: 1.0814  loss:1.5546,stance loss: 1.5321 
Train step: 940 acc:0.7032 total_loss: 1.0825  loss:1.7172,stance loss: 1.3173 
Train step: 950 acc:0.70657 total_loss: 1.0745  loss:0.59633,stance loss: 0.45153 
Train step: 960 acc:0.7074 total_loss: 1.0724  loss:0.79751,stance loss: 0.57969 
Train step: 970 acc:0.70896 total_loss: 1.069  loss:0.92731,stance loss: 0.73794 
Train step: 980 acc:0.7091 total_loss: 1.0702  loss:1.0743,stance loss: 1.3574 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.71429 total_loss: 1.0415  loss:1.0855,stance loss: 0.81473 
Train step: 1000 acc:0.74632 total_loss: 0.93295  loss:0.93036,stance loss: 0.70623 
Train step: 1010 acc:0.73611 total_loss: 0.94905  loss:1.2994,stance loss: 1.0391 
Train step: 1020 acc:0.74662 total_loss: 0.95617  loss:1.2838,stance loss: 1.1537 
Train step: 1030 acc:0.7234 total_loss: 0.97912  loss:0.84698,stance loss: 0.66415 
Train step: 1040 acc:0.72149 total_loss: 0.97284  loss:0.75422,stance loss: 0.6612 
Train step: 1050 acc:0.72668 total_loss: 0.99047  loss:0.85387,stance loss: 0.74138 
Train step: 1060 acc:0.72727 total_loss: 0.98168  loss:0.91584,stance loss: 0.73097 
Train step: 1070 acc:0.72989 total_loss: 0.97449  loss:0.44138,stance loss: 0.31151 
Train step: 1080 acc:0.72938 total_loss: 0.98596  loss:0.82942,stance loss: 0.58244 
Train step: 1090 acc:0.72839 total_loss: 0.99089  loss:1.1048,stance loss: 0.75497 
Train step: 1100 acc:0.72863 total_loss: 0.98986  loss:1.007,stance loss: 0.76931 
Train step: 1110 acc:0.73474 total_loss: 0.98364  loss:1.0262,stance loss: 0.83502 
Train step: 1120 acc:0.73495 total_loss: 0.97584  loss:0.95664,stance loss: 0.74333 
Train step: 1130 acc:0.73639 total_loss: 0.97197  loss:0.89521,stance loss: 0.77135 
Train step: 1140 acc:0.73726 total_loss: 0.9721  loss:1.1004,stance loss: 0.95489 
Train step: 1150 acc:0.74027 total_loss: 0.9703  loss:0.73174,stance loss: 0.6092 
Train step: 1160 acc:0.74329 total_loss: 0.9612  loss:0.64285,stance loss: 0.38292 
Train step: 1170 acc:0.74031 total_loss: 0.96927  loss:0.85163,stance loss: 0.57041 
Train step: 1180 acc:0.74143 total_loss: 0.96896  loss:1.1987,stance loss: 1.2642 
Train step: 1190 acc:0.74245 total_loss: 0.96535  loss:0.95489,stance loss: 0.62099 
Train step: 1200 acc:0.74338 total_loss: 0.96473  loss:0.77106,stance loss: 0.48641 
Train step: 1210 acc:0.74615 total_loss: 0.95488  loss:0.94157,stance loss: 0.83085 
Train step: 1220 acc:0.74684 total_loss: 0.94941  loss:0.81936,stance loss: 0.60862 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.625 total_loss: 1.0908  loss:1.0908,stance loss: 0.77552 
Train step: 1240 acc:0.76136 total_loss: 0.96782  loss:0.80524,stance loss: 0.58913 
Train step: 1250 acc:0.78274 total_loss: 0.95301  loss:0.85519,stance loss: 0.67494 
Train step: 1260 acc:0.78226 total_loss: 0.94267  loss:1.2534,stance loss: 1.0314 
Train step: 1270 acc:0.78201 total_loss: 0.89929  loss:0.64905,stance loss: 0.4908 
Train step: 1280 acc:0.78922 total_loss: 0.87934  loss:0.68943,stance loss: 0.5355 
Train step: 1290 acc:0.79508 total_loss: 0.86527  loss:0.60417,stance loss: 0.50946 
Train step: 1300 acc:0.79665 total_loss: 0.85598  loss:0.76624,stance loss: 0.56996 
Train step: 1310 acc:0.7909 total_loss: 0.8658  loss:0.7793,stance loss: 0.67027 
Train step: 1320 acc:0.78984 total_loss: 0.86528  loss:0.91879,stance loss: 0.66409 
Train step: 1330 acc:0.79641 total_loss: 0.8486  loss:0.88956,stance loss: 0.788 
Train step: 1340 acc:0.7973 total_loss: 0.84914  loss:0.98567,stance loss: 0.68631 
Train step: 1350 acc:0.797 total_loss: 0.85093  loss:0.97482,stance loss: 0.79808 
Train step: 1360 acc:0.79294 total_loss: 0.85933  loss:1.1649,stance loss: 1.4146 
Train step: 1370 acc:0.78901 total_loss: 0.86484  loss:1.4354,stance loss: 1.1602 
Train step: 1380 acc:0.79015 total_loss: 0.85848  loss:0.38602,stance loss: 0.23647 
Train step: 1390 acc:0.7927 total_loss: 0.85735  loss:0.51941,stance loss: 0.38601 
Train step: 1400 acc:0.79532 total_loss: 0.8515  loss:1.0386,stance loss: 0.85388 
Train step: 1410 acc:0.79489 total_loss: 0.85079  loss:0.86276,stance loss: 0.72859 
Train step: 1420 acc:0.79777 total_loss: 0.84103  loss:1.0839,stance loss: 0.82631 
Train step: 1430 acc:0.7982 total_loss: 0.84484  loss:1.1775,stance loss: 1.3527 
Train step: 1440 acc:0.79769 total_loss: 0.84825  loss:0.69281,stance loss: 0.55462 
Train step: 1450 acc:0.79921 total_loss: 0.84589  loss:0.5847,stance loss: 0.42581 
Train step: 1460 acc:0.7987 total_loss: 0.84783  loss:0.66467,stance loss: 0.5714 
Train step: 1470 acc:0.7985 total_loss: 0.84861  loss:1.604,stance loss: 1.8271 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.7375 total_loss: 0.95618  loss:0.68551,stance loss: 0.52272 
Train step: 1490 acc:0.79167 total_loss: 0.87839  loss:0.88288,stance loss: 0.79653 
Train step: 1500 acc:0.8125 total_loss: 0.86758  loss:0.64878,stance loss: 0.42086 
Train step: 1510 acc:0.82321 total_loss: 0.82346  loss:0.63102,stance loss: 0.5093 
Train step: 1520 acc:0.82361 total_loss: 0.80854  loss:0.65155,stance loss: 0.56152 
Train step: 1530 acc:0.83182 total_loss: 0.78169  loss:0.46466,stance loss: 0.37204 
Train step: 1540 acc:0.83269 total_loss: 0.76312  loss:0.68963,stance loss: 0.56864 
Train step: 1550 acc:0.83667 total_loss: 0.74516  loss:1.1583,stance loss: 0.75593 
Train step: 1560 acc:0.83456 total_loss: 0.75077  loss:1.1115,stance loss: 0.79213 
Train step: 1570 acc:0.8375 total_loss: 0.75734  loss:0.61554,stance loss: 0.55195 
Train step: 1580 acc:0.83631 total_loss: 0.75462  loss:0.63667,stance loss: 0.5479 
Train step: 1590 acc:0.8337 total_loss: 0.75657  loss:1.0153,stance loss: 0.71444 
Train step: 1600 acc:0.83 total_loss: 0.75215  loss:0.75709,stance loss: 0.59018 
Train step: 1610 acc:0.82824 total_loss: 0.75073  loss:0.35351,stance loss: 0.24662 
Train step: 1620 acc:0.82759 total_loss: 0.75157  loss:0.65948,stance loss: 0.66311 
Train step: 1630 acc:0.82339 total_loss: 0.7544  loss:1.3235,stance loss: 1.2641 
Train step: 1640 acc:0.82159 total_loss: 0.75893  loss:0.52935,stance loss: 0.40546 
Train step: 1650 acc:0.82464 total_loss: 0.7553  loss:0.35043,stance loss: 0.23514 
Train step: 1660 acc:0.82466 total_loss: 0.74481  loss:0.84143,stance loss: 0.71123 
Train step: 1670 acc:0.82628 total_loss: 0.73782  loss:0.58688,stance loss: 0.40322 
Train step: 1680 acc:0.82591 total_loss: 0.7374  loss:0.57664,stance loss: 0.45736 
Train step: 1690 acc:0.82558 total_loss: 0.74274  loss:0.7636,stance loss: 0.51016 
Train step: 1700 acc:0.82889 total_loss: 0.7349  loss:0.45672,stance loss: 0.25969 
Train step: 1710 acc:0.83059 total_loss: 0.73286  loss:0.86057,stance loss: 0.79037 
Train step: 1720 acc:0.82832 total_loss: 0.73871  loss:0.85583,stance loss: 0.80854 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.80556 total_loss: 0.73382  loss:0.29675,stance loss: 0.23899 
Train step: 1740 acc:0.82895 total_loss: 0.69446  loss:0.44855,stance loss: 0.29724 
Train step: 1750 acc:0.84052 total_loss: 0.69792  loss:0.95442,stance loss: 1.394 
Train step: 1760 acc:0.85096 total_loss: 0.66937  loss:0.52175,stance loss: 0.47144 
Train step: 1770 acc:0.85459 total_loss: 0.67075  loss:1.0033,stance loss: 0.88172 
Train step: 1780 acc:0.85381 total_loss: 0.65788  loss:0.44864,stance loss: 0.39509 
Train step: 1790 acc:0.85688 total_loss: 0.64661  loss:0.68969,stance loss: 0.55309 
Train step: 1800 acc:0.86076 total_loss: 0.62583  loss:0.66936,stance loss: 0.61979 
Train step: 1810 acc:0.86166 total_loss: 0.62394  loss:0.58859,stance loss: 0.4174 
Train step: 1820 acc:0.85543 total_loss: 0.65098  loss:0.80184,stance loss: 0.6429 
Train step: 1830 acc:0.85837 total_loss: 0.64471  loss:0.65515,stance loss: 1.0464 
Train step: 1840 acc:0.85819 total_loss: 0.64574  loss:0.14147,stance loss: 0.07181 
Train step: 1850 acc:0.8624 total_loss: 0.63479  loss:0.65274,stance loss: 0.56998 
Train step: 1860 acc:0.86151 total_loss: 0.63911  loss:0.75589,stance loss: 0.55508 
Train step: 1870 acc:0.86116 total_loss: 0.64156  loss:0.60666,stance loss: 0.33452 
Train step: 1880 acc:0.86281 total_loss: 0.63607  loss:0.51934,stance loss: 0.46581 
Train step: 1890 acc:0.85984 total_loss: 0.64801  loss:0.90449,stance loss: 0.55565 
Train step: 1900 acc:0.86138 total_loss: 0.64199  loss:0.12042,stance loss: 0.044977 
Train step: 1910 acc:0.85913 total_loss: 0.64747  loss:1.1204,stance loss: 0.86738 
Train step: 1920 acc:0.86149 total_loss: 0.63715  loss:0.40868,stance loss: 0.28212 
Train step: 1930 acc:0.86094 total_loss: 0.63723  loss:0.70876,stance loss: 0.7211 
Train step: 1940 acc:0.86016 total_loss: 0.64017  loss:0.72737,stance loss: 0.65695 
Train step: 1950 acc:0.85999 total_loss: 0.64036  loss:0.42803,stance loss: 0.32918 
Train step: 1960 acc:0.86036 total_loss: 0.63648  loss:0.49475,stance loss: 0.45227 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.89583 total_loss: 0.57663  loss:0.75531,stance loss: 1.0944 
Train step: 1980 acc:0.87981 total_loss: 0.56404  loss:0.29758,stance loss: 0.17804 
Train step: 1990 acc:0.8913 total_loss: 0.56348  loss:0.47613,stance loss: 0.40188 
Train step: 2000 acc:0.88258 total_loss: 0.53979  loss:0.32012,stance loss: 0.24559 
Train step: 2010 acc:0.8939 total_loss: 0.51202  loss:0.42109,stance loss: 0.44406 
Train step: 2020 acc:0.89741 total_loss: 0.4947  loss:0.31688,stance loss: 0.25406 
Train step: 2030 acc:0.89881 total_loss: 0.50468  loss:0.78679,stance loss: 0.70817 
Train step: 2040 acc:0.89812 total_loss: 0.50341  loss:0.15711,stance loss: 0.083086 
Train step: 2050 acc:0.89383 total_loss: 0.51217  loss:0.85961,stance loss: 0.70417 
Train step: 2060 acc:0.89785 total_loss: 0.49711  loss:0.21398,stance loss: 0.1364 
Train step: 2070 acc:0.89867 total_loss: 0.49909  loss:0.80393,stance loss: 0.71263 
Train step: 2080 acc:0.89657 total_loss: 0.50928  loss:0.59211,stance loss: 0.46964 
Train step: 2090 acc:0.89329 total_loss: 0.50715  loss:0.55343,stance loss: 0.48406 
Train step: 2100 acc:0.89333 total_loss: 0.50701  loss:0.61656,stance loss: 0.5457 
Train step: 2110 acc:0.89423 total_loss: 0.49334  loss:0.21212,stance loss: 0.13086 
Train step: 2120 acc:0.89134 total_loss: 0.50474  loss:0.70466,stance loss: 0.58271 
Train step: 2130 acc:0.88919 total_loss: 0.50707  loss:0.72774,stance loss: 0.67978 
Train step: 2140 acc:0.88728 total_loss: 0.51312  loss:0.46167,stance loss: 0.45436 
Train step: 2150 acc:0.88764 total_loss: 0.51052  loss:0.53455,stance loss: 0.47836 
Train step: 2160 acc:0.88666 total_loss: 0.51896  loss:0.95858,stance loss: 1.3181 
Train step: 2170 acc:0.88639 total_loss: 0.52095  loss:0.38206,stance loss: 0.25991 
Train step: 2180 acc:0.88644 total_loss: 0.52503  loss:0.1435,stance loss: 0.10317 
Train step: 2190 acc:0.88453 total_loss: 0.52929  loss:0.41568,stance loss: 0.35004 
Train step: 2200 acc:0.88573 total_loss: 0.52473  loss:0.26767,stance loss: 0.142 
Train step: 2210 acc:0.88709 total_loss: 0.52391  loss:0.20513,stance loss: 0.081521 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.92857 total_loss: 0.41906  loss:0.74039,stance loss: 1.145 
Train step: 2230 acc:0.89338 total_loss: 0.48378  loss:0.23636,stance loss: 0.17753 
Train step: 2240 acc:0.89583 total_loss: 0.47523  loss:0.31344,stance loss: 0.27678 
Train step: 2250 acc:0.89358 total_loss: 0.47383  loss:0.31616,stance loss: 0.2857 
Train step: 2260 acc:0.89495 total_loss: 0.48327  loss:0.84305,stance loss: 0.98381 
Train step: 2270 acc:0.90132 total_loss: 0.46687  loss:0.35967,stance loss: 0.31811 
Train step: 2280 acc:0.90578 total_loss: 0.44587  loss:0.21683,stance loss: 0.17385 
Train step: 2290 acc:0.90503 total_loss: 0.44985  loss:0.43413,stance loss: 0.39354 
Train step: 2300 acc:0.90445 total_loss: 0.46069  loss:0.54299,stance loss: 0.52874 
Train step: 2310 acc:0.90464 total_loss: 0.44692  loss:0.67492,stance loss: 0.53095 
Train step: 2320 acc:0.90596 total_loss: 0.43839  loss:0.52362,stance loss: 0.47587 
Train step: 2330 acc:0.90545 total_loss: 0.4418  loss:0.82815,stance loss: 1.246 
Train step: 2340 acc:0.906 total_loss: 0.43657  loss:0.14028,stance loss: 0.10287 
Train step: 2350 acc:0.90237 total_loss: 0.44202  loss:0.37705,stance loss: 0.39332 
Train step: 2360 acc:0.90264 total_loss: 0.43517  loss:0.21375,stance loss: 0.1759 
Train step: 2370 acc:0.89968 total_loss: 0.44526  loss:0.82944,stance loss: 0.72256 
Train step: 2380 acc:0.90045 total_loss: 0.44741  loss:0.43239,stance loss: 0.31729 
Train step: 2390 acc:0.90254 total_loss: 0.44718  loss:0.23996,stance loss: 0.16853 
Train step: 2400 acc:0.90107 total_loss: 0.45753  loss:0.55411,stance loss: 0.54795 
Train step: 2410 acc:0.90197 total_loss: 0.45851  loss:0.28799,stance loss: 0.23955 
Train step: 2420 acc:0.90459 total_loss: 0.44976  loss:0.099331,stance loss: 0.023269 
Train step: 2430 acc:0.90323 total_loss: 0.45397  loss:0.15352,stance loss: 0.10818 
Train step: 2440 acc:0.90336 total_loss: 0.45693  loss:0.45345,stance loss: 0.32573 
Train step: 2450 acc:0.90322 total_loss: 0.46135  loss:0.40428,stance loss: 0.28945 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.3114  loss:0.3114,stance loss: 0.29811 
Train step: 2470 acc:0.94886 total_loss: 0.35234  loss:1.1975,stance loss: 1.583 
Train step: 2480 acc:0.93452 total_loss: 0.36773  loss:0.22322,stance loss: 0.196 
Train step: 2490 acc:0.9375 total_loss: 0.35962  loss:0.17824,stance loss: 0.14494 
Train step: 2500 acc:0.93598 total_loss: 0.37313  loss:0.13627,stance loss: 0.10089 
Train step: 2510 acc:0.94118 total_loss: 0.3624  loss:0.24319,stance loss: 0.22062 
Train step: 2520 acc:0.94057 total_loss: 0.36642  loss:0.4103,stance loss: 0.36648 
Train step: 2530 acc:0.93926 total_loss: 0.37518  loss:0.70594,stance loss: 0.53503 
Train step: 2540 acc:0.93981 total_loss: 0.36783  loss:0.11862,stance loss: 0.076827 
Train step: 2550 acc:0.94093 total_loss: 0.36306  loss:0.25585,stance loss: 0.1923 
Train step: 2560 acc:0.94059 total_loss: 0.36329  loss:0.050865,stance loss: 0.0084304 
Train step: 2570 acc:0.942 total_loss: 0.35576  loss:0.06201,stance loss: 0.020828 
Train step: 2580 acc:0.94112 total_loss: 0.36907  loss:0.82718,stance loss: 0.62446 
Train step: 2590 acc:0.9375 total_loss: 0.37167  loss:0.31114,stance loss: 0.23253 
Train step: 2600 acc:0.93661 total_loss: 0.37059  loss:0.4306,stance loss: 0.35214 
Train step: 2610 acc:0.93709 total_loss: 0.36595  loss:0.43176,stance loss: 0.39656 
Train step: 2620 acc:0.93517 total_loss: 0.36992  loss:0.2356,stance loss: 0.17571 
Train step: 2630 acc:0.93494 total_loss: 0.37203  loss:0.37706,stance loss: 0.22531 
Train step: 2640 acc:0.93301 total_loss: 0.37388  loss:0.41434,stance loss: 0.45056 
Train step: 2650 acc:0.93325 total_loss: 0.37804  loss:0.49546,stance loss: 0.43308 
Train step: 2660 acc:0.93377 total_loss: 0.37794  loss:0.63139,stance loss: 0.43441 
Train step: 2670 acc:0.93424 total_loss: 0.37372  loss:0.25296,stance loss: 0.18603 
Train step: 2680 acc:0.93439 total_loss: 0.37256  loss:0.42575,stance loss: 0.33742 
Train step: 2690 acc:0.93236 total_loss: 0.37826  loss:0.50934,stance loss: 0.44962 
Train step: 2700 acc:0.93361 total_loss: 0.37446  loss:0.28189,stance loss: 0.26444 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9125 total_loss: 0.29196  loss:0.32041,stance loss: 0.28108 
Train step: 2720 acc:0.95 total_loss: 0.34179  loss:0.15306,stance loss: 0.10481 
Train step: 2730 acc:0.9525 total_loss: 0.29013  loss:0.1336,stance loss: 0.059161 
Train step: 2740 acc:0.94643 total_loss: 0.28972  loss:0.20238,stance loss: 0.14282 
Train step: 2750 acc:0.94028 total_loss: 0.31334  loss:0.49569,stance loss: 0.41447 
Train step: 2760 acc:0.93864 total_loss: 0.31873  loss:0.54685,stance loss: 1.0086 
Train step: 2770 acc:0.93846 total_loss: 0.32148  loss:0.33922,stance loss: 0.20123 
Train step: 2780 acc:0.93917 total_loss: 0.31412  loss:0.070239,stance loss: 0.015585 
Train step: 2790 acc:0.94044 total_loss: 0.30944  loss:0.40862,stance loss: 0.26357 
Train step: 2800 acc:0.94079 total_loss: 0.31649  loss:0.18029,stance loss: 0.093306 
Train step: 2810 acc:0.94167 total_loss: 0.31642  loss:0.29403,stance loss: 0.1836 
Train step: 2820 acc:0.94076 total_loss: 0.3133  loss:0.50512,stance loss: 0.41015 
Train step: 2830 acc:0.941 total_loss: 0.30941  loss:0.41214,stance loss: 0.36297 
Train step: 2840 acc:0.94306 total_loss: 0.30453  loss:0.048305,stance loss: 0.005777 
Train step: 2850 acc:0.94397 total_loss: 0.30114  loss:0.050894,stance loss: 0.0051467 
Train step: 2860 acc:0.94234 total_loss: 0.30126  loss:0.57839,stance loss: 0.46114 
Train step: 2870 acc:0.94394 total_loss: 0.29744  loss:0.86423,stance loss: 1.1835 
Train step: 2880 acc:0.94536 total_loss: 0.29764  loss:0.085824,stance loss: 0.019772 
Train step: 2890 acc:0.94561 total_loss: 0.29563  loss:0.41701,stance loss: 0.46995 
Train step: 2900 acc:0.94583 total_loss: 0.29695  loss:0.87426,stance loss: 0.73747 
Train step: 2910 acc:0.94665 total_loss: 0.30112  loss:0.84472,stance loss: 1.2513 
Train step: 2920 acc:0.9468 total_loss: 0.30065  loss:0.88476,stance loss: 0.59531 
Train step: 2930 acc:0.94583 total_loss: 0.30726  loss:0.94813,stance loss: 0.73944 
Train step: 2940 acc:0.94548 total_loss: 0.30809  loss:0.27221,stance loss: 0.18652 
Train step: 2950 acc:0.94515 total_loss: 0.3103  loss:0.082068,stance loss: 0.027458 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.96528 total_loss: 0.18272  loss:0.1331,stance loss: 0.088745 
Train step: 2970 acc:0.94737 total_loss: 0.23798  loss:0.20434,stance loss: 0.13967 
Train step: 2980 acc:0.94397 total_loss: 0.24091  loss:0.26167,stance loss: 0.26564 
Train step: 2990 acc:0.94071 total_loss: 0.24988  loss:0.13569,stance loss: 0.080638 
Train step: 3000 acc:0.94643 total_loss: 0.23796  loss:0.079981,stance loss: 0.055415 
Train step: 3010 acc:0.94915 total_loss: 0.23726  loss:0.29793,stance loss: 0.34621 
Train step: 3020 acc:0.94746 total_loss: 0.24235  loss:0.31413,stance loss: 0.34431 
Train step: 3030 acc:0.94937 total_loss: 0.23905  loss:0.50641,stance loss: 0.32551 
Train step: 3040 acc:0.94733 total_loss: 0.24466  loss:0.17153,stance loss: 0.14317 
Train step: 3050 acc:0.94949 total_loss: 0.24751  loss:0.085032,stance loss: 0.021519 
Train step: 3060 acc:0.95126 total_loss: 0.24848  loss:0.038715,stance loss: 0.0048432 
Train step: 3070 acc:0.95273 total_loss: 0.24703  loss:0.16076,stance loss: 0.15481 
Train step: 3080 acc:0.95252 total_loss: 0.25147  loss:0.43406,stance loss: 0.38622 
Train step: 3090 acc:0.95099 total_loss: 0.27041  loss:0.71695,stance loss: 1.0846 
Train step: 3100 acc:0.9526 total_loss: 0.27363  loss:0.091658,stance loss: 0.027333 
Train step: 3110 acc:0.95008 total_loss: 0.27934  loss:0.60956,stance loss: 1.0526 
Train step: 3120 acc:0.95044 total_loss: 0.27639  loss:0.22276,stance loss: 0.16435 
Train step: 3130 acc:0.95042 total_loss: 0.27512  loss:0.65546,stance loss: 0.43597 
Train step: 3140 acc:0.9494 total_loss: 0.27522  loss:0.10585,stance loss: 0.03265 
Train step: 3150 acc:0.94912 total_loss: 0.27624  loss:0.38919,stance loss: 0.4615 
Train step: 3160 acc:0.94886 total_loss: 0.27522  loss:0.13062,stance loss: 0.10428 
Train step: 3170 acc:0.9492 total_loss: 0.27384  loss:0.13489,stance loss: 0.12075 
Train step: 3180 acc:0.94787 total_loss: 0.28081  loss:0.10276,stance loss: 0.090524 
Train step: 3190 acc:0.94927 total_loss: 0.27536  loss:0.2966,stance loss: 0.26495 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:1.0 total_loss: 0.23545  loss:0.12693,stance loss: 0.075942 
Train step: 3210 acc:0.95673 total_loss: 0.21815  loss:0.28764,stance loss: 0.18164 
Train step: 3220 acc:0.9538 total_loss: 0.20918  loss:0.16381,stance loss: 0.050829 
Train step: 3230 acc:0.94886 total_loss: 0.23207  loss:0.33946,stance loss: 0.23253 
Train step: 3240 acc:0.95349 total_loss: 0.24218  loss:0.031539,stance loss: 0.0024319 
Train step: 3250 acc:0.95519 total_loss: 0.23241  loss:0.24967,stance loss: 0.16529 
Train step: 3260 acc:0.95437 total_loss: 0.23631  loss:0.028815,stance loss: 0.00090526 
Train step: 3270 acc:0.95377 total_loss: 0.22957  loss:0.20533,stance loss: 0.23877 
Train step: 3280 acc:0.95256 total_loss: 0.22343  loss:0.14316,stance loss: 0.08125 
Train step: 3290 acc:0.95296 total_loss: 0.22762  loss:0.37364,stance loss: 0.29063 
Train step: 3300 acc:0.95328 total_loss: 0.2298  loss:0.1015,stance loss: 0.037134 
Train step: 3310 acc:0.9552 total_loss: 0.22726  loss:0.21617,stance loss: 0.14599 
Train step: 3320 acc:0.95579 total_loss: 0.22989  loss:0.37902,stance loss: 0.35165 
Train step: 3330 acc:0.95489 total_loss: 0.24124  loss:0.14456,stance loss: 0.084515 
Train step: 3340 acc:0.95673 total_loss: 0.23278  loss:0.053727,stance loss: 0.026852 
Train step: 3350 acc:0.95711 total_loss: 0.23345  loss:0.14515,stance loss: 0.15295 
Train step: 3360 acc:0.95744 total_loss: 0.22824  loss:0.083799,stance loss: 0.062838 
Train step: 3370 acc:0.95845 total_loss: 0.22098  loss:0.075079,stance loss: 0.038357 
Train step: 3380 acc:0.95902 total_loss: 0.21711  loss:0.11278,stance loss: 0.053127 
Train step: 3390 acc:0.95823 total_loss: 0.22175  loss:0.064991,stance loss: 0.031111 
Train step: 3400 acc:0.95967 total_loss: 0.21614  loss:0.061312,stance loss: 0.034745 
Train step: 3410 acc:0.9598 total_loss: 0.21156  loss:0.10998,stance loss: 0.076239 
Train step: 3420 acc:0.96048 total_loss: 0.21175  loss:0.048821,stance loss: 0.017066 
Train step: 3430 acc:0.96003 total_loss: 0.21556  loss:0.55812,stance loss: 1.0154 
Train step: 3440 acc:0.96013 total_loss: 0.2214  loss:0.07508,stance loss: 0.019813 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.97321 total_loss: 0.26399  loss:0.23094,stance loss: 0.26746 
Train step: 3460 acc:0.98529 total_loss: 0.14776  loss:0.062823,stance loss: 0.035665 
Train step: 3470 acc:0.98611 total_loss: 0.12242  loss:0.18279,stance loss: 0.21053 
Train step: 3480 acc:0.98142 total_loss: 0.14878  loss:0.030788,stance loss: 0.001582 
Train step: 3490 acc:0.97606 total_loss: 0.15758  loss:0.012949,stance loss: 0.0005016 
Train step: 3500 acc:0.97149 total_loss: 0.18048  loss:0.096898,stance loss: 0.10035 
Train step: 3510 acc:0.97015 total_loss: 0.17784  loss:0.023384,stance loss: 0.0076095 
Train step: 3520 acc:0.97078 total_loss: 0.1863  loss:0.53897,stance loss: 1.0146 
Train step: 3530 acc:0.97055 total_loss: 0.18571  loss:0.052762,stance loss: 0.014668 
Train step: 3540 acc:0.97229 total_loss: 0.17781  loss:0.044842,stance loss: 0.0073408 
Train step: 3550 acc:0.97079 total_loss: 0.18952  loss:0.038487,stance loss: 0.0042395 
Train step: 3560 acc:0.96955 total_loss: 0.19078  loss:0.055325,stance loss: 0.043431 
Train step: 3570 acc:0.97146 total_loss: 0.18064  loss:0.19117,stance loss: 0.12075 
Train step: 3580 acc:0.97217 total_loss: 0.17589  loss:0.048536,stance loss: 0.028494 
Train step: 3590 acc:0.97109 total_loss: 0.18021  loss:0.12241,stance loss: 0.10769 
Train step: 3600 acc:0.97134 total_loss: 0.18152  loss:0.072812,stance loss: 0.03883 
Train step: 3610 acc:0.97156 total_loss: 0.17739  loss:0.047552,stance loss: 0.0071213 
Train step: 3620 acc:0.9721 total_loss: 0.17581  loss:0.024975,stance loss: 0.0085951 
Train step: 3630 acc:0.97159 total_loss: 0.17637  loss:0.025437,stance loss: 0.0072736 
Train step: 3640 acc:0.97272 total_loss: 0.17597  loss:0.20096,stance loss: 0.20773 
Train step: 3650 acc:0.97313 total_loss: 0.17709  loss:0.063598,stance loss: 0.029972 
Train step: 3660 acc:0.97264 total_loss: 0.18065  loss:0.20853,stance loss: 0.14961 
Train step: 3670 acc:0.97329 total_loss: 0.17828  loss:0.021017,stance loss: 0.0056565 
Train step: 3680 acc:0.97257 total_loss: 0.18267  loss:0.092782,stance loss: 0.026703 
Training finished.


Reload the best model with best f1 0.4915364184288487 from path test_outputs/bert-cross-topic/la/2023-08-14 17-39-12/state_dict


              precision    recall  f1-score   support

           0   0.658696  0.556985  0.603586       544
           1   0.512000  0.576577  0.542373       222
           2   0.331839  0.443114  0.379487       167

    accuracy                       0.541265       933
   macro avg   0.500845  0.525559  0.508482       933
weighted avg   0.565286  0.541265  0.548909       933

Test Acc: 0.5412647374062165 F1_ma:0.4915364184288487
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4915364184288487
acc: 0.5412647374062165, f1 :0.5084819060712099
classification report: 
              precision    recall  f1-score   support

         Con     0.6587    0.5570    0.6036       544
        None     0.5120    0.5766    0.5424       222
         Pro     0.3318    0.4431    0.3795       167

    accuracy                         0.5413       933
   macro avg     0.5008    0.5256    0.5085       933
weighted avg     0.5653    0.5413    0.5489       933

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 18-17-28', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 18-17-28
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.6235  loss:1.6235,stance loss: 0.97061 
Train step: 10 acc:0.35227 total_loss: 1.6349  loss:1.4621,stance loss: 0.71679 
Better F1! Saving model!
Saving model of best f1: 0.40023022381510254
              precision    recall  f1-score   support

           0   0.596491  0.375000  0.460497       544
           1   0.560976  0.518018  0.538642       222
           2   0.243523  0.562874  0.339964       167

    accuracy                       0.442658       933
   macro avg   0.466997  0.485297  0.446367       933
weighted avg   0.524862  0.442658  0.457516       933

Test Acc: 0.44265809217577706 F1_ma:0.40023022381510254
Train step: 20 acc:0.39583 total_loss: 1.6245  loss:1.4725,stance loss: 0.93616 
Better F1! Saving model!
Saving model of best f1: 0.44612794612794604
              precision    recall  f1-score   support

           0   0.566770  0.670956  0.614478       544
           1   0.816667  0.220721  0.347518       222
           2   0.240175  0.329341  0.277778       167

    accuracy                       0.502680       933
   macro avg   0.541204  0.407006  0.413258       933
weighted avg   0.567773  0.502680  0.490690       933

Test Acc: 0.5026795284030011 F1_ma:0.44612794612794604
Train step: 30 acc:0.42742 total_loss: 1.6269  loss:1.8566,stance loss: 1.7304 
Better F1! Saving model!
Saving model of best f1: 0.4478961896654025
              precision    recall  f1-score   support

           0   0.579221  0.819853  0.678843       544
           1   0.828571  0.130631  0.225681       222
           2   0.250000  0.191617  0.216949       167

    accuracy                       0.543408       933
   macro avg   0.552597  0.380700  0.373824       933
weighted avg   0.579624  0.543408  0.488341       933

Test Acc: 0.5434083601286174 F1_ma:0.4478961896654025
Train step: 40 acc:0.4253 total_loss: 1.6336  loss:1.4227,stance loss: 0.9595 
Train step: 50 acc:0.4375 total_loss: 1.627  loss:1.6787,stance loss: 1.2437 
Train step: 60 acc:0.44775 total_loss: 1.6184  loss:1.4979,stance loss: 1.0817 
Train step: 70 acc:0.45158 total_loss: 1.6119  loss:1.4877,stance loss: 0.97094 
Train step: 80 acc:0.45139 total_loss: 1.6058  loss:1.4597,stance loss: 1.0009 
Better F1! Saving model!
Saving model of best f1: 0.4618453441982854
              precision    recall  f1-score   support

           0   0.581930  0.698529  0.634921       544
           1   0.780822  0.256757  0.386441       222
           2   0.260870  0.323353  0.288770       167

    accuracy                       0.526259       933
   macro avg   0.541207  0.426213  0.436710       933
weighted avg   0.571787  0.526259  0.513838       933

Test Acc: 0.5262593783494105 F1_ma:0.4618453441982854
Train step: 90 acc:0.45192 total_loss: 1.6015  loss:1.5552,stance loss: 1.0502 
Train step: 100 acc:0.45545 total_loss: 1.5995  loss:1.536,stance loss: 1.0467 
Train step: 110 acc:0.46227 total_loss: 1.5908  loss:1.3425,stance loss: 0.91771 
Train step: 120 acc:0.46539 total_loss: 1.5822  loss:1.421,stance loss: 1.0011 
Train step: 130 acc:0.46422 total_loss: 1.5807  loss:1.4569,stance loss: 1.0484 
Train step: 140 acc:0.47296 total_loss: 1.576  loss:1.2911,stance loss: 0.86024 
Train step: 150 acc:0.47434 total_loss: 1.5742  loss:1.6695,stance loss: 1.1612 
Train step: 160 acc:0.47477 total_loss: 1.5737  loss:1.6263,stance loss: 1.2031 
Train step: 170 acc:0.47917 total_loss: 1.5708  loss:1.5351,stance loss: 1.1347 
Train step: 180 acc:0.48066 total_loss: 1.5662  loss:1.6419,stance loss: 1.6871 
Train step: 190 acc:0.48757 total_loss: 1.5555  loss:1.7024,stance loss: 1.4764 
Train step: 200 acc:0.49067 total_loss: 1.551  loss:1.4592,stance loss: 1.0864 
Train step: 210 acc:0.49408 total_loss: 1.5456  loss:1.5833,stance loss: 1.1807 
Train step: 220 acc:0.49491 total_loss: 1.5458  loss:1.2559,stance loss: 0.74402 
Train step: 230 acc:0.49811 total_loss: 1.5424  loss:1.6907,stance loss: 1.6852 
Train step: 240 acc:0.5013 total_loss: 1.5369  loss:1.5234,stance loss: 1.1408 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.5125 total_loss: 1.4414  loss:1.3758,stance loss: 0.88335 
Train step: 260 acc:0.59583 total_loss: 1.4381  loss:1.4519,stance loss: 1.1044 
Train step: 270 acc:0.6 total_loss: 1.4457  loss:1.3549,stance loss: 0.93885 
Train step: 280 acc:0.60357 total_loss: 1.4134  loss:1.5009,stance loss: 1.0682 
Train step: 290 acc:0.6 total_loss: 1.3937  loss:1.4056,stance loss: 1.0869 
Train step: 300 acc:0.59545 total_loss: 1.385  loss:1.1568,stance loss: 0.82106 
Train step: 310 acc:0.59423 total_loss: 1.369  loss:1.2035,stance loss: 0.77597 
Train step: 320 acc:0.59833 total_loss: 1.3642  loss:1.2399,stance loss: 0.87823 
Train step: 330 acc:0.60074 total_loss: 1.3582  loss:1.3379,stance loss: 0.9662 
Train step: 340 acc:0.60592 total_loss: 1.3482  loss:1.2243,stance loss: 0.89703 
Train step: 350 acc:0.6119 total_loss: 1.3463  loss:1.6349,stance loss: 1.7205 
Train step: 360 acc:0.6163 total_loss: 1.3457  loss:1.4032,stance loss: 1.0034 
Train step: 370 acc:0.6165 total_loss: 1.341  loss:1.3867,stance loss: 0.87865 
Train step: 380 acc:0.61667 total_loss: 1.3426  loss:1.3434,stance loss: 0.9221 
Train step: 390 acc:0.61897 total_loss: 1.3384  loss:1.1145,stance loss: 0.74622 
Train step: 400 acc:0.62258 total_loss: 1.3344  loss:1.051,stance loss: 0.73685 
Train step: 410 acc:0.625 total_loss: 1.3299  loss:1.4607,stance loss: 1.1777 
Train step: 420 acc:0.62714 total_loss: 1.33  loss:1.386,stance loss: 1.0547 
Train step: 430 acc:0.62703 total_loss: 1.335  loss:1.7337,stance loss: 1.3818 
Train step: 440 acc:0.62949 total_loss: 1.3248  loss:0.94549,stance loss: 0.65175 
Train step: 450 acc:0.63079 total_loss: 1.3233  loss:1.3828,stance loss: 1.1283 
Train step: 460 acc:0.63314 total_loss: 1.3219  loss:1.4522,stance loss: 1.3636 
Train step: 470 acc:0.63556 total_loss: 1.3205  loss:1.7174,stance loss: 1.8957 
Train step: 480 acc:0.63963 total_loss: 1.3172  loss:1.2241,stance loss: 0.94468 
Train step: 490 acc:0.64133 total_loss: 1.3115  loss:1.6693,stance loss: 1.4153 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.75694 total_loss: 1.2292  loss:1.5689,stance loss: 1.7456 
Train step: 510 acc:0.68092 total_loss: 1.1929  loss:1.1676,stance loss: 0.70228 
Train step: 520 acc:0.69181 total_loss: 1.1739  loss:1.2702,stance loss: 1.1207 
Train step: 530 acc:0.69391 total_loss: 1.1852  loss:1.2594,stance loss: 0.89317 
Train step: 540 acc:0.6926 total_loss: 1.1872  loss:1.0635,stance loss: 0.81867 
Train step: 550 acc:0.69492 total_loss: 1.1832  loss:1.2921,stance loss: 1.1665 
Train step: 560 acc:0.67663 total_loss: 1.1972  loss:1.3068,stance loss: 0.8973 
Train step: 570 acc:0.67247 total_loss: 1.2078  loss:1.1455,stance loss: 0.88269 
Train step: 580 acc:0.6861 total_loss: 1.2088  loss:1.7052,stance loss: 1.738 
Train step: 590 acc:0.68561 total_loss: 1.2001  loss:1.5386,stance loss: 1.251 
Train step: 600 acc:0.6789 total_loss: 1.204  loss:1.2386,stance loss: 0.99779 
Train step: 610 acc:0.6812 total_loss: 1.1995  loss:0.93642,stance loss: 0.75547 
Train step: 620 acc:0.68653 total_loss: 1.1982  loss:1.1499,stance loss: 1.0386 
Train step: 630 acc:0.68885 total_loss: 1.1926  loss:1.0716,stance loss: 0.87038 
Train step: 640 acc:0.68834 total_loss: 1.1908  loss:1.3333,stance loss: 1.0942 
Train step: 650 acc:0.68789 total_loss: 1.1929  loss:1.2326,stance loss: 0.77784 
Train step: 660 acc:0.68565 total_loss: 1.1979  loss:1.516,stance loss: 1.6596 
Train step: 670 acc:0.6861 total_loss: 1.1927  loss:1.1496,stance loss: 0.83388 
Train step: 680 acc:0.68651 total_loss: 1.1928  loss:0.82302,stance loss: 0.57545 
Train step: 690 acc:0.68499 total_loss: 1.1924  loss:1.363,stance loss: 1.061 
Train step: 700 acc:0.68242 total_loss: 1.1954  loss:1.0468,stance loss: 0.81453 
Train step: 710 acc:0.68208 total_loss: 1.1966  loss:0.96473,stance loss: 0.73875 
Train step: 720 acc:0.6815 total_loss: 1.1967  loss:1.055,stance loss: 0.85841 
Train step: 730 acc:0.67965 total_loss: 1.1968  loss:1.0674,stance loss: 0.78313 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.70833 total_loss: 1.0895  loss:1.0956,stance loss: 0.92833 
Train step: 750 acc:0.75481 total_loss: 1.1016  loss:0.8366,stance loss: 0.61952 
Train step: 760 acc:0.72554 total_loss: 1.1198  loss:0.96685,stance loss: 0.71665 
Train step: 770 acc:0.72159 total_loss: 1.1026  loss:1.1807,stance loss: 0.86982 
Train step: 780 acc:0.72529 total_loss: 1.097  loss:0.98664,stance loss: 0.81005 
Train step: 790 acc:0.71816 total_loss: 1.1061  loss:1.7023,stance loss: 1.6806 
Train step: 800 acc:0.70933 total_loss: 1.1081  loss:1.0644,stance loss: 0.79444 
Train step: 810 acc:0.71147 total_loss: 1.1117  loss:1.6701,stance loss: 1.8032 
Train step: 820 acc:0.7131 total_loss: 1.1125  loss:1.0042,stance loss: 0.79317 
Train step: 830 acc:0.71371 total_loss: 1.1088  loss:0.56417,stance loss: 0.42009 
Train step: 840 acc:0.7142 total_loss: 1.1078  loss:1.5857,stance loss: 1.4468 
Train step: 850 acc:0.71792 total_loss: 1.0941  loss:1.3271,stance loss: 0.87047 
Train step: 860 acc:0.71951 total_loss: 1.0929  loss:1.1329,stance loss: 1.031 
Train step: 870 acc:0.71852 total_loss: 1.0927  loss:0.63148,stance loss: 0.29274 
Train step: 880 acc:0.71809 total_loss: 1.0891  loss:0.8694,stance loss: 0.74692 
Train step: 890 acc:0.71855 total_loss: 1.0882  loss:1.0723,stance loss: 0.88377 
Train step: 900 acc:0.71779 total_loss: 1.0881  loss:1.3314,stance loss: 1.1118 
Train step: 910 acc:0.71821 total_loss: 1.0877  loss:1.1392,stance loss: 0.83271 
Train step: 920 acc:0.71721 total_loss: 1.0881  loss:0.83316,stance loss: 0.62104 
Train step: 930 acc:0.71729 total_loss: 1.0845  loss:0.94976,stance loss: 0.76816 
Train step: 940 acc:0.71552 total_loss: 1.0931  loss:1.1108,stance loss: 0.85202 
Train step: 950 acc:0.71479 total_loss: 1.0983  loss:1.0463,stance loss: 0.82563 
Train step: 960 acc:0.71272 total_loss: 1.1051  loss:1.1882,stance loss: 1.4248 
Train step: 970 acc:0.7154 total_loss: 1.0969  loss:0.5723,stance loss: 0.41724 
Train step: 980 acc:0.71656 total_loss: 1.0938  loss:1.6364,stance loss: 1.6626 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.69643 total_loss: 1.085  loss:1.0923,stance loss: 0.72983 
Train step: 1000 acc:0.69853 total_loss: 1.0991  loss:1.3653,stance loss: 1.1964 
Train step: 1010 acc:0.72454 total_loss: 1.0049  loss:0.76826,stance loss: 0.4183 
Train step: 1020 acc:0.72635 total_loss: 1.0154  loss:1.0224,stance loss: 0.66572 
Train step: 1030 acc:0.72207 total_loss: 1.0173  loss:1.2016,stance loss: 0.85098 
Train step: 1040 acc:0.71491 total_loss: 1.0103  loss:0.67041,stance loss: 0.47313 
Train step: 1050 acc:0.71922 total_loss: 0.99575  loss:0.87772,stance loss: 0.66737 
Train step: 1060 acc:0.71753 total_loss: 0.99371  loss:1.0063,stance loss: 0.79739 
Train step: 1070 acc:0.71839 total_loss: 1.0146  loss:1.1162,stance loss: 0.9749 
Train step: 1080 acc:0.72294 total_loss: 1.0033  loss:0.81204,stance loss: 0.70687 
Train step: 1090 acc:0.71963 total_loss: 1.0093  loss:0.77732,stance loss: 0.63927 
Train step: 1100 acc:0.72115 total_loss: 1.0043  loss:0.94766,stance loss: 0.72494 
Train step: 1110 acc:0.7249 total_loss: 0.9966  loss:0.56133,stance loss: 0.39737 
Train step: 1120 acc:0.724 total_loss: 0.99185  loss:0.9256,stance loss: 0.67394 
Train step: 1130 acc:0.72321 total_loss: 0.99909  loss:1.0477,stance loss: 0.97286 
Train step: 1140 acc:0.71895 total_loss: 1.0007  loss:0.93165,stance loss: 0.79549 
Train step: 1150 acc:0.72006 total_loss: 1.0027  loss:0.75355,stance loss: 0.55801 
Train step: 1160 acc:0.72246 total_loss: 1.0008  loss:0.56064,stance loss: 0.22119 
Train step: 1170 acc:0.72025 total_loss: 1.0087  loss:1.4497,stance loss: 1.2535 
Train step: 1180 acc:0.72272 total_loss: 1.0074  loss:1.1738,stance loss: 1.1137 
Train step: 1190 acc:0.72283 total_loss: 1.0122  loss:0.64974,stance loss: 0.45552 
Train step: 1200 acc:0.72408 total_loss: 1.0072  loss:0.58316,stance loss: 0.39155 
Train step: 1210 acc:0.72632 total_loss: 1.0049  loss:0.88104,stance loss: 0.73819 
Train step: 1220 acc:0.7289 total_loss: 1.0001  loss:0.3894,stance loss: 0.22677 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 0.78687  loss:0.78687,stance loss: 0.61154 
Train step: 1240 acc:0.72159 total_loss: 1.0117  loss:1.3312,stance loss: 0.85524 
Train step: 1250 acc:0.69048 total_loss: 1.0532  loss:0.94016,stance loss: 0.69714 
Train step: 1260 acc:0.71371 total_loss: 1.0165  loss:0.82019,stance loss: 0.67466 
Train step: 1270 acc:0.72256 total_loss: 0.97368  loss:0.99487,stance loss: 0.90986 
Train step: 1280 acc:0.72794 total_loss: 0.95544  loss:0.78345,stance loss: 0.66526 
Train step: 1290 acc:0.74385 total_loss: 0.93274  loss:1.6189,stance loss: 1.3226 
Train step: 1300 acc:0.75 total_loss: 0.91098  loss:0.92214,stance loss: 0.85973 
Train step: 1310 acc:0.75077 total_loss: 0.90667  loss:1.0269,stance loss: 0.84302 
Train step: 1320 acc:0.75412 total_loss: 0.91715  loss:1.163,stance loss: 1.5351 
Train step: 1330 acc:0.75 total_loss: 0.92333  loss:0.71173,stance loss: 0.49806 
Train step: 1340 acc:0.7545 total_loss: 0.91847  loss:1.0075,stance loss: 0.80667 
Train step: 1350 acc:0.75878 total_loss: 0.91517  loss:1.0241,stance loss: 0.96808 
Train step: 1360 acc:0.75954 total_loss: 0.92099  loss:0.99423,stance loss: 1.2408 
Train step: 1370 acc:0.76108 total_loss: 0.91879  loss:1.0845,stance loss: 0.94256 
Train step: 1380 acc:0.762 total_loss: 0.91587  loss:0.60257,stance loss: 0.41766 
Train step: 1390 acc:0.7632 total_loss: 0.91232  loss:0.84784,stance loss: 0.68424 
Train step: 1400 acc:0.76462 total_loss: 0.91146  loss:0.64545,stance loss: 0.47216 
Train step: 1410 acc:0.76312 total_loss: 0.91785  loss:0.42102,stance loss: 0.29946 
Train step: 1420 acc:0.76342 total_loss: 0.91778  loss:0.77356,stance loss: 0.70111 
Train step: 1430 acc:0.76306 total_loss: 0.92225  loss:0.90426,stance loss: 0.72986 
Train step: 1440 acc:0.76126 total_loss: 0.92601  loss:1.0413,stance loss: 0.69372 
Train step: 1450 acc:0.76018 total_loss: 0.92816  loss:0.91949,stance loss: 0.76631 
Train step: 1460 acc:0.75974 total_loss: 0.92809  loss:0.94696,stance loss: 0.87871 
Train step: 1470 acc:0.76063 total_loss: 0.92463  loss:0.77128,stance loss: 0.62514 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.85 total_loss: 0.78294  loss:0.81352,stance loss: 0.78781 
Train step: 1490 acc:0.81667 total_loss: 0.76748  loss:0.84706,stance loss: 0.74201 
Train step: 1500 acc:0.825 total_loss: 0.74754  loss:0.82334,stance loss: 0.60197 
Train step: 1510 acc:0.81786 total_loss: 0.7892  loss:1.6761,stance loss: 1.3903 
Train step: 1520 acc:0.81389 total_loss: 0.80914  loss:1.006,stance loss: 0.78925 
Train step: 1530 acc:0.81023 total_loss: 0.80674  loss:0.62461,stance loss: 0.46036 
Train step: 1540 acc:0.80385 total_loss: 0.83132  loss:0.68999,stance loss: 0.57197 
Train step: 1550 acc:0.80167 total_loss: 0.83577  loss:0.89902,stance loss: 0.90057 
Train step: 1560 acc:0.80368 total_loss: 0.82838  loss:0.7393,stance loss: 0.62396 
Train step: 1570 acc:0.80263 total_loss: 0.8226  loss:0.55867,stance loss: 0.42134 
Train step: 1580 acc:0.8006 total_loss: 0.8314  loss:0.83286,stance loss: 0.90755 
Train step: 1590 acc:0.80272 total_loss: 0.82882  loss:1.3272,stance loss: 1.1164 
Train step: 1600 acc:0.8025 total_loss: 0.82358  loss:0.8477,stance loss: 0.69702 
Train step: 1610 acc:0.79907 total_loss: 0.82593  loss:0.98543,stance loss: 0.87117 
Train step: 1620 acc:0.80259 total_loss: 0.81833  loss:0.84476,stance loss: 0.77941 
Train step: 1630 acc:0.7996 total_loss: 0.8205  loss:0.4999,stance loss: 0.38787 
Train step: 1640 acc:0.79773 total_loss: 0.81864  loss:1.0753,stance loss: 0.95403 
Train step: 1650 acc:0.7975 total_loss: 0.81853  loss:0.80263,stance loss: 0.74486 
Train step: 1660 acc:0.7973 total_loss: 0.82144  loss:0.74748,stance loss: 0.50803 
Train step: 1670 acc:0.79776 total_loss: 0.81983  loss:0.3344,stance loss: 0.2099 
Train step: 1680 acc:0.79756 total_loss: 0.81867  loss:0.66357,stance loss: 0.49314 
Train step: 1690 acc:0.79767 total_loss: 0.82093  loss:1.0323,stance loss: 1.3457 
Train step: 1700 acc:0.79778 total_loss: 0.81792  loss:0.75764,stance loss: 0.6613 
Train step: 1710 acc:0.79654 total_loss: 0.81838  loss:0.67855,stance loss: 0.49067 
Train step: 1720 acc:0.79719 total_loss: 0.81338  loss:0.42383,stance loss: 0.35295 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.77778 total_loss: 0.94063  loss:1.2403,stance loss: 1.1902 
Train step: 1740 acc:0.78289 total_loss: 0.86115  loss:0.67694,stance loss: 0.51339 
Train step: 1750 acc:0.80819 total_loss: 0.78011  loss:1.0447,stance loss: 1.3784 
Train step: 1760 acc:0.82212 total_loss: 0.72675  loss:0.33034,stance loss: 0.19534 
Train step: 1770 acc:0.83163 total_loss: 0.68578  loss:0.43047,stance loss: 0.20242 
Train step: 1780 acc:0.83263 total_loss: 0.68711  loss:1.1406,stance loss: 0.94732 
Train step: 1790 acc:0.83514 total_loss: 0.68304  loss:0.46824,stance loss: 0.37902 
Train step: 1800 acc:0.8307 total_loss: 0.69796  loss:0.54317,stance loss: 0.42722 
Train step: 1810 acc:0.83076 total_loss: 0.69465  loss:0.54239,stance loss: 0.34007 
Train step: 1820 acc:0.82576 total_loss: 0.70123  loss:1.036,stance loss: 0.83219 
Train step: 1830 acc:0.82454 total_loss: 0.69869  loss:0.80932,stance loss: 0.55503 
Train step: 1840 acc:0.82878 total_loss: 0.69361  loss:0.72446,stance loss: 0.56603 
Train step: 1850 acc:0.82607 total_loss: 0.69962  loss:0.89776,stance loss: 0.6846 
Train step: 1860 acc:0.82599 total_loss: 0.69772  loss:0.59765,stance loss: 0.42948 
Train step: 1870 acc:0.82383 total_loss: 0.69301  loss:0.62674,stance loss: 0.49792 
Train step: 1880 acc:0.82429 total_loss: 0.69594  loss:0.96084,stance loss: 0.82508 
Train step: 1890 acc:0.82396 total_loss: 0.69684  loss:0.37756,stance loss: 0.048652 
Train step: 1900 acc:0.82228 total_loss: 0.70109  loss:0.92262,stance loss: 0.91511 
Train step: 1910 acc:0.82143 total_loss: 0.7052  loss:0.56767,stance loss: 0.37602 
Train step: 1920 acc:0.82192 total_loss: 0.70298  loss:0.25892,stance loss: 0.16622 
Train step: 1930 acc:0.82267 total_loss: 0.70172  loss:0.98711,stance loss: 0.73968 
Train step: 1940 acc:0.82363 total_loss: 0.7066  loss:0.74966,stance loss: 0.57488 
Train step: 1950 acc:0.82314 total_loss: 0.70898  loss:0.81667,stance loss: 0.52313 
Train step: 1960 acc:0.82427 total_loss: 0.71338  loss:0.87317,stance loss: 0.72142 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.89583 total_loss: 0.56032  loss:0.43211,stance loss: 0.30294 
Train step: 1980 acc:0.86538 total_loss: 0.61099  loss:0.74169,stance loss: 0.61113 
Train step: 1990 acc:0.88043 total_loss: 0.57765  loss:0.40341,stance loss: 0.26077 
Train step: 2000 acc:0.86174 total_loss: 0.62291  loss:1.0451,stance loss: 1.2251 
Train step: 2010 acc:0.86483 total_loss: 0.60953  loss:0.44453,stance loss: 0.29254 
Train step: 2020 acc:0.86439 total_loss: 0.60577  loss:0.59039,stance loss: 0.52701 
Train step: 2030 acc:0.86607 total_loss: 0.60462  loss:0.37219,stance loss: 0.26032 
Train step: 2040 acc:0.86644 total_loss: 0.60219  loss:0.53823,stance loss: 0.37273 
Train step: 2050 acc:0.8637 total_loss: 0.60287  loss:0.56055,stance loss: 0.47783 
Train step: 2060 acc:0.8582 total_loss: 0.61393  loss:0.53512,stance loss: 0.42057 
Train step: 2070 acc:0.86044 total_loss: 0.61235  loss:0.35438,stance loss: 0.26011 
Train step: 2080 acc:0.86394 total_loss: 0.60522  loss:0.36631,stance loss: 0.22566 
Train step: 2090 acc:0.86433 total_loss: 0.60556  loss:0.62745,stance loss: 0.49738 
Train step: 2100 acc:0.85949 total_loss: 0.62965  loss:1.2064,stance loss: 1.3923 
Train step: 2110 acc:0.86101 total_loss: 0.62549  loss:0.86032,stance loss: 1.1321 
Train step: 2120 acc:0.86029 total_loss: 0.63526  loss:0.80988,stance loss: 1.2219 
Train step: 2130 acc:0.85698 total_loss: 0.6472  loss:0.18772,stance loss: 0.10373 
Train step: 2140 acc:0.85694 total_loss: 0.643  loss:0.58963,stance loss: 0.44875 
Train step: 2150 acc:0.85895 total_loss: 0.63866  loss:0.56916,stance loss: 0.4577 
Train step: 2160 acc:0.85654 total_loss: 0.64331  loss:0.63467,stance loss: 0.45043 
Train step: 2170 acc:0.85653 total_loss: 0.64541  loss:0.46244,stance loss: 0.38931 
Train step: 2180 acc:0.85446 total_loss: 0.65366  loss:0.95504,stance loss: 0.85201 
Train step: 2190 acc:0.85426 total_loss: 0.65471  loss:0.27166,stance loss: 0.18845 
Train step: 2200 acc:0.85247 total_loss: 0.65387  loss:0.9185,stance loss: 0.77134 
Train step: 2210 acc:0.85391 total_loss: 0.6491  loss:0.53771,stance loss: 0.46114 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.91071 total_loss: 0.37261  loss:0.31568,stance loss: 0.14666 
Train step: 2230 acc:0.90441 total_loss: 0.4061  loss:0.27158,stance loss: 0.17381 
Train step: 2240 acc:0.90972 total_loss: 0.42358  loss:0.78262,stance loss: 0.65347 
Train step: 2250 acc:0.91385 total_loss: 0.41319  loss:0.16828,stance loss: 0.079144 
Train step: 2260 acc:0.90824 total_loss: 0.43398  loss:0.19209,stance loss: 0.11199 
Train step: 2270 acc:0.89583 total_loss: 0.48053  loss:0.5902,stance loss: 0.39898 
Train step: 2280 acc:0.89179 total_loss: 0.50141  loss:0.33871,stance loss: 0.27304 
Train step: 2290 acc:0.88718 total_loss: 0.50544  loss:0.3434,stance loss: 0.25195 
Train step: 2300 acc:0.88721 total_loss: 0.50568  loss:0.6143,stance loss: 0.39297 
Train step: 2310 acc:0.88466 total_loss: 0.50973  loss:1.3718,stance loss: 1.5768 
Train step: 2320 acc:0.8861 total_loss: 0.50982  loss:0.47667,stance loss: 0.4035 
Train step: 2330 acc:0.88835 total_loss: 0.50666  loss:0.23641,stance loss: 0.15198 
Train step: 2340 acc:0.88337 total_loss: 0.5258  loss:0.82293,stance loss: 0.68477 
Train step: 2350 acc:0.88595 total_loss: 0.5231  loss:0.70418,stance loss: 1.0936 
Train step: 2360 acc:0.88435 total_loss: 0.53536  loss:0.91146,stance loss: 0.80974 
Train step: 2370 acc:0.88575 total_loss: 0.53513  loss:0.16062,stance loss: 0.093276 
Train step: 2380 acc:0.88548 total_loss: 0.53124  loss:0.48547,stance loss: 0.28105 
Train step: 2390 acc:0.88524 total_loss: 0.52971  loss:0.49356,stance loss: 0.439 
Train step: 2400 acc:0.88536 total_loss: 0.52567  loss:0.39087,stance loss: 0.3593 
Train step: 2410 acc:0.88484 total_loss: 0.52452  loss:1.0715,stance loss: 1.1595 
Train step: 2420 acc:0.88436 total_loss: 0.52752  loss:0.39969,stance loss: 0.34362 
Train step: 2430 acc:0.88364 total_loss: 0.52681  loss:0.59431,stance loss: 0.34589 
Train step: 2440 acc:0.88546 total_loss: 0.52149  loss:0.16267,stance loss: 0.11609 
Train step: 2450 acc:0.88766 total_loss: 0.51262  loss:0.3834,stance loss: 0.26516 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.29672  loss:0.29672,stance loss: 0.28239 
Train step: 2470 acc:0.88068 total_loss: 0.4703  loss:0.31671,stance loss: 0.23119 
Train step: 2480 acc:0.88988 total_loss: 0.46414  loss:0.30569,stance loss: 0.20769 
Train step: 2490 acc:0.91129 total_loss: 0.46763  loss:0.35488,stance loss: 0.27162 
Train step: 2500 acc:0.90396 total_loss: 0.47914  loss:0.21236,stance loss: 0.16249 
Train step: 2510 acc:0.90441 total_loss: 0.46446  loss:0.21187,stance loss: 0.14638 
Train step: 2520 acc:0.90881 total_loss: 0.46483  loss:0.16817,stance loss: 0.077381 
Train step: 2530 acc:0.90669 total_loss: 0.46336  loss:0.28882,stance loss: 0.26833 
Train step: 2540 acc:0.90741 total_loss: 0.45238  loss:0.79277,stance loss: 0.51713 
Train step: 2550 acc:0.90385 total_loss: 0.45992  loss:0.65612,stance loss: 0.501 
Train step: 2560 acc:0.90532 total_loss: 0.45378  loss:0.20259,stance loss: 0.15644 
Train step: 2570 acc:0.90822 total_loss: 0.44564  loss:0.37143,stance loss: 0.32359 
Train step: 2580 acc:0.91064 total_loss: 0.44646  loss:0.36993,stance loss: 0.29905 
Train step: 2590 acc:0.91174 total_loss: 0.44497  loss:0.45928,stance loss: 0.39678 
Train step: 2600 acc:0.91268 total_loss: 0.4367  loss:0.21155,stance loss: 0.17966 
Train step: 2610 acc:0.91184 total_loss: 0.43722  loss:0.21971,stance loss: 0.16925 
Train step: 2620 acc:0.91033 total_loss: 0.44363  loss:0.92603,stance loss: 0.89163 
Train step: 2630 acc:0.91118 total_loss: 0.44032  loss:0.63352,stance loss: 0.49068 
Train step: 2640 acc:0.90919 total_loss: 0.44514  loss:0.49485,stance loss: 0.34199 
Train step: 2650 acc:0.91001 total_loss: 0.44607  loss:0.89672,stance loss: 0.90577 
Train step: 2660 acc:0.91076 total_loss: 0.4453  loss:0.18522,stance loss: 0.11837 
Train step: 2670 acc:0.91203 total_loss: 0.44358  loss:0.63967,stance loss: 0.60733 
Train step: 2680 acc:0.91148 total_loss: 0.44257  loss:0.44436,stance loss: 0.19201 
Train step: 2690 acc:0.90909 total_loss: 0.45326  loss:0.63676,stance loss: 0.66184 
Train step: 2700 acc:0.90949 total_loss: 0.45248  loss:1.0349,stance loss: 0.96413 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9375 total_loss: 0.39061  loss:0.3618,stance loss: 0.36262 
Train step: 2720 acc:0.92083 total_loss: 0.42018  loss:0.88336,stance loss: 0.713 
Train step: 2730 acc:0.92 total_loss: 0.4316  loss:0.16226,stance loss: 0.042982 
Train step: 2740 acc:0.92143 total_loss: 0.42811  loss:0.24929,stance loss: 0.15552 
Train step: 2750 acc:0.92083 total_loss: 0.41758  loss:0.32529,stance loss: 0.29474 
Train step: 2760 acc:0.92841 total_loss: 0.395  loss:0.19039,stance loss: 0.12369 
Train step: 2770 acc:0.93462 total_loss: 0.37251  loss:0.12416,stance loss: 0.098055 
Train step: 2780 acc:0.93 total_loss: 0.38736  loss:0.83364,stance loss: 1.2561 
Train step: 2790 acc:0.92868 total_loss: 0.3877  loss:0.25631,stance loss: 0.16752 
Train step: 2800 acc:0.92895 total_loss: 0.39553  loss:0.35424,stance loss: 0.29461 
Train step: 2810 acc:0.92381 total_loss: 0.39714  loss:0.77042,stance loss: 0.5169 
Train step: 2820 acc:0.92554 total_loss: 0.39005  loss:0.21758,stance loss: 0.087672 
Train step: 2830 acc:0.928 total_loss: 0.38374  loss:0.73851,stance loss: 0.42794 
Train step: 2840 acc:0.92731 total_loss: 0.37866  loss:0.50037,stance loss: 0.50873 
Train step: 2850 acc:0.92586 total_loss: 0.38926  loss:0.59016,stance loss: 0.407 
Train step: 2860 acc:0.9254 total_loss: 0.39239  loss:0.32477,stance loss: 0.12913 
Train step: 2870 acc:0.92462 total_loss: 0.39342  loss:0.18216,stance loss: 0.12628 
Train step: 2880 acc:0.92429 total_loss: 0.39324  loss:0.30299,stance loss: 0.27379 
Train step: 2890 acc:0.92331 total_loss: 0.39265  loss:0.2449,stance loss: 0.088293 
Train step: 2900 acc:0.92212 total_loss: 0.38931  loss:0.27506,stance loss: 0.20616 
Train step: 2910 acc:0.92256 total_loss: 0.38464  loss:0.32512,stance loss: 0.2596 
Train step: 2920 acc:0.92326 total_loss: 0.38161  loss:0.13686,stance loss: 0.03926 
Train step: 2930 acc:0.92389 total_loss: 0.38452  loss:0.22573,stance loss: 0.14776 
Train step: 2940 acc:0.9234 total_loss: 0.38363  loss:0.43602,stance loss: 0.32147 
Train step: 2950 acc:0.92347 total_loss: 0.38705  loss:0.35469,stance loss: 0.30503 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.9375 total_loss: 0.35894  loss:0.18398,stance loss: 0.16503 
Train step: 2970 acc:0.92434 total_loss: 0.41997  loss:0.49167,stance loss: 0.36099 
Train step: 2980 acc:0.92026 total_loss: 0.41997  loss:0.30392,stance loss: 0.24165 
Train step: 2990 acc:0.92628 total_loss: 0.42551  loss:0.68077,stance loss: 0.57645 
Train step: 3000 acc:0.92474 total_loss: 0.42398  loss:1.016,stance loss: 1.0349 
Train step: 3010 acc:0.92479 total_loss: 0.42459  loss:0.17888,stance loss: 0.13527 
Train step: 3020 acc:0.92663 total_loss: 0.4041  loss:0.077121,stance loss: 0.020592 
Train step: 3030 acc:0.92405 total_loss: 0.41552  loss:0.13907,stance loss: 0.060751 
Train step: 3040 acc:0.92416 total_loss: 0.41158  loss:0.50003,stance loss: 0.37064 
Train step: 3050 acc:0.92803 total_loss: 0.38894  loss:0.12365,stance loss: 0.056841 
Train step: 3060 acc:0.93177 total_loss: 0.37799  loss:0.082954,stance loss: 0.049065 
Train step: 3070 acc:0.93225 total_loss: 0.37953  loss:0.33196,stance loss: 0.28419 
Train step: 3080 acc:0.93217 total_loss: 0.38446  loss:0.16479,stance loss: 0.13009 
Train step: 3090 acc:0.93345 total_loss: 0.38192  loss:0.1688,stance loss: 0.099388 
Train step: 3100 acc:0.93498 total_loss: 0.37568  loss:0.33288,stance loss: 0.30904 
Train step: 3110 acc:0.93396 total_loss: 0.37298  loss:0.068355,stance loss: 0.009049 
Train step: 3120 acc:0.93454 total_loss: 0.36987  loss:0.35005,stance loss: 0.28455 
Train step: 3130 acc:0.9361 total_loss: 0.36455  loss:0.31125,stance loss: 0.29051 
Train step: 3140 acc:0.93552 total_loss: 0.36885  loss:0.93832,stance loss: 1.3811 
Train step: 3150 acc:0.93593 total_loss: 0.36466  loss:0.14819,stance loss: 0.094106 
Train step: 3160 acc:0.9372 total_loss: 0.35713  loss:0.13974,stance loss: 0.081649 
Train step: 3170 acc:0.93664 total_loss: 0.355  loss:0.048569,stance loss: 0.016405 
Train step: 3180 acc:0.93668 total_loss: 0.35117  loss:0.17791,stance loss: 0.038658 
Train step: 3190 acc:0.93672 total_loss: 0.34975  loss:0.37602,stance loss: 0.33552 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.9375 total_loss: 0.266  loss:0.37845,stance loss: 0.35501 
Train step: 3210 acc:0.92308 total_loss: 0.29778  loss:0.21945,stance loss: 0.096214 
Train step: 3220 acc:0.94022 total_loss: 0.30296  loss:0.5571,stance loss: 1.0136 
Train step: 3230 acc:0.93371 total_loss: 0.32781  loss:0.21794,stance loss: 0.15383 
Train step: 3240 acc:0.93314 total_loss: 0.33759  loss:0.12932,stance loss: 0.090752 
Train step: 3250 acc:0.93868 total_loss: 0.33055  loss:0.53901,stance loss: 1.0089 
Train step: 3260 acc:0.9375 total_loss: 0.33631  loss:0.15012,stance loss: 0.088328 
Train step: 3270 acc:0.93664 total_loss: 0.33156  loss:0.33276,stance loss: 0.30035 
Train step: 3280 acc:0.93524 total_loss: 0.33359  loss:0.48565,stance loss: 0.53554 
Train step: 3290 acc:0.93683 total_loss: 0.33137  loss:0.40346,stance loss: 0.4029 
Train step: 3300 acc:0.93932 total_loss: 0.32199  loss:0.31702,stance loss: 0.27961 
Train step: 3310 acc:0.93916 total_loss: 0.32474  loss:0.35372,stance loss: 0.28007 
Train step: 3320 acc:0.94157 total_loss: 0.31164  loss:0.025204,stance loss: 0.0027999 
Train step: 3330 acc:0.94267 total_loss: 0.31081  loss:0.033351,stance loss: 0.0013138 
Train step: 3340 acc:0.94274 total_loss: 0.30544  loss:0.27401,stance loss: 0.19917 
Train step: 3350 acc:0.94281 total_loss: 0.30245  loss:0.11462,stance loss: 0.05553 
Train step: 3360 acc:0.9444 total_loss: 0.30052  loss:0.78188,stance loss: 1.2322 
Train step: 3370 acc:0.94328 total_loss: 0.30318  loss:0.085661,stance loss: 0.020024 
Train step: 3380 acc:0.9416 total_loss: 0.30627  loss:0.58781,stance loss: 0.43538 
Train step: 3390 acc:0.94139 total_loss: 0.30233  loss:0.27429,stance loss: 0.079954 
Train step: 3400 acc:0.94243 total_loss: 0.29959  loss:0.078154,stance loss: 0.029374 
Train step: 3410 acc:0.94278 total_loss: 0.30074  loss:0.066198,stance loss: 0.045294 
Train step: 3420 acc:0.94339 total_loss: 0.30345  loss:0.17438,stance loss: 0.060568 
Train step: 3430 acc:0.9426 total_loss: 0.30845  loss:0.65744,stance loss: 0.47518 
Train step: 3440 acc:0.94342 total_loss: 0.3057  loss:0.17235,stance loss: 0.08695 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.97321 total_loss: 0.16256  loss:0.13196,stance loss: 0.10379 
Train step: 3460 acc:0.96324 total_loss: 0.2395  loss:0.076561,stance loss: 0.011564 
Train step: 3470 acc:0.96759 total_loss: 0.25963  loss:0.069453,stance loss: 0.030153 
Train step: 3480 acc:0.97297 total_loss: 0.22187  loss:0.067286,stance loss: 0.033678 
Train step: 3490 acc:0.96809 total_loss: 0.22078  loss:0.7036,stance loss: 1.1563 
Train step: 3500 acc:0.97149 total_loss: 0.19718  loss:0.05218,stance loss: 0.0097744 
Train step: 3510 acc:0.96828 total_loss: 0.21171  loss:0.30466,stance loss: 0.10924 
Train step: 3520 acc:0.96916 total_loss: 0.21328  loss:0.061717,stance loss: 0.021427 
Train step: 3530 acc:0.96767 total_loss: 0.21887  loss:0.66582,stance loss: 0.54654 
Train step: 3540 acc:0.96585 total_loss: 0.22391  loss:0.30816,stance loss: 0.2814 
Train step: 3550 acc:0.96203 total_loss: 0.22922  loss:0.21163,stance loss: 0.15132 
Train step: 3560 acc:0.96154 total_loss: 0.23552  loss:0.24051,stance loss: 0.19571 
Train step: 3570 acc:0.96309 total_loss: 0.23192  loss:0.14507,stance loss: 0.15136 
Train step: 3580 acc:0.96259 total_loss: 0.23792  loss:0.13646,stance loss: 0.1285 
Train step: 3590 acc:0.96429 total_loss: 0.22841  loss:0.16004,stance loss: 0.073163 
Train step: 3600 acc:0.96338 total_loss: 0.23401  loss:1.4509,stance loss: 1.91 
Train step: 3610 acc:0.96183 total_loss: 0.23377  loss:0.080661,stance loss: 0.037378 
Train step: 3620 acc:0.96186 total_loss: 0.23204  loss:0.3435,stance loss: 0.22498 
Train step: 3630 acc:0.96056 total_loss: 0.23787  loss:0.14282,stance loss: 0.064619 
Train step: 3640 acc:0.95971 total_loss: 0.23798  loss:0.53019,stance loss: 0.39809 
Train step: 3650 acc:0.95924 total_loss: 0.23633  loss:0.19755,stance loss: 0.19269 
Train step: 3660 acc:0.95939 total_loss: 0.23696  loss:0.69912,stance loss: 0.57662 
Train step: 3670 acc:0.95925 total_loss: 0.23748  loss:0.038338,stance loss: 0.01126 
Train step: 3680 acc:0.95728 total_loss: 0.24044  loss:0.35688,stance loss: 0.28947 
Training finished.


Reload the best model with best f1 0.4618453441982854 from path test_outputs/bert-cross-topic/la/2023-08-14 18-17-28/state_dict


              precision    recall  f1-score   support

           0   0.581930  0.698529  0.634921       544
           1   0.780822  0.256757  0.386441       222
           2   0.260870  0.323353  0.288770       167

    accuracy                       0.526259       933
   macro avg   0.541207  0.426213  0.436710       933
weighted avg   0.571787  0.526259  0.513838       933

Test Acc: 0.5262593783494105 F1_ma:0.4618453441982854
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4618453441982854
acc: 0.5262593783494105, f1 :0.4367104554542241
classification report: 
              precision    recall  f1-score   support

         Con     0.5819    0.6985    0.6349       544
        None     0.7808    0.2568    0.3864       222
         Pro     0.2609    0.3234    0.2888       167

    accuracy                         0.5263       933
   macro avg     0.5412    0.4262    0.4367       933
weighted avg     0.5718    0.5263    0.5138       933

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 18-55-24', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 18-55-24
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 2.1341  loss:2.1341,stance loss: 1.5755 
Train step: 10 acc:0.3125 total_loss: 1.8796  loss:1.9569,stance loss: 1.7592 
Better F1! Saving model!
Saving model of best f1: 0.3678861788617886
              precision    recall  f1-score   support

           0   0.582618  0.998162  0.735772       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.581994       933
   macro avg   0.194206  0.332721  0.245257       933
weighted avg   0.339704  0.581994  0.429003       933

Test Acc: 0.5819935691318328 F1_ma:0.3678861788617886
Train step: 20 acc:0.35417 total_loss: 1.786  loss:1.666,stance loss: 1.2086 
Better F1! Saving model!
Saving model of best f1: 0.36831415030467163
              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Train step: 30 acc:0.38508 total_loss: 1.746  loss:1.5418,stance loss: 1.1059 
Train step: 40 acc:0.40091 total_loss: 1.7283  loss:1.6668,stance loss: 1.2131 
Train step: 50 acc:0.41667 total_loss: 1.7143  loss:1.8272,stance loss: 1.6921 
Train step: 60 acc:0.41598 total_loss: 1.7098  loss:1.5778,stance loss: 1.1854 
Train step: 70 acc:0.4287 total_loss: 1.6984  loss:1.6065,stance loss: 1.1869 
Train step: 80 acc:0.4375 total_loss: 1.6947  loss:1.7395,stance loss: 1.3726 
Train step: 90 acc:0.44093 total_loss: 1.6888  loss:1.7851,stance loss: 1.1702 
Train step: 100 acc:0.45359 total_loss: 1.6821  loss:1.6099,stance loss: 1.1387 
Train step: 110 acc:0.45777 total_loss: 1.6753  loss:1.652,stance loss: 1.214 
Train step: 120 acc:0.45661 total_loss: 1.6712  loss:1.6208,stance loss: 1.1719 
Train step: 130 acc:0.46135 total_loss: 1.6699  loss:1.7027,stance loss: 1.1659 
Train step: 140 acc:0.46764 total_loss: 1.6645  loss:2.0142,stance loss: 1.697 
Train step: 150 acc:0.4731 total_loss: 1.6587  loss:1.7291,stance loss: 1.3073 
Train step: 160 acc:0.47438 total_loss: 1.6588  loss:1.7655,stance loss: 1.2824 
Train step: 170 acc:0.47807 total_loss: 1.6599  loss:1.8015,stance loss: 1.1917 
Train step: 180 acc:0.48239 total_loss: 1.6482  loss:1.4103,stance loss: 0.99652 
Train step: 190 acc:0.48495 total_loss: 1.6438  loss:1.4415,stance loss: 1.0947 
Train step: 200 acc:0.49005 total_loss: 1.6387  loss:1.7508,stance loss: 1.2464 
Train step: 210 acc:0.49645 total_loss: 1.6297  loss:1.4839,stance loss: 1.6562 
Train step: 220 acc:0.49915 total_loss: 1.623  loss:1.3913,stance loss: 1.0718 
Train step: 230 acc:0.50027 total_loss: 1.6197  loss:1.5782,stance loss: 1.1205 
Train step: 240 acc:0.50233 total_loss: 1.6167  loss:1.6106,stance loss: 0.94782 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.525 total_loss: 1.5544  loss:1.5268,stance loss: 1.104 
Better F1! Saving model!
Saving model of best f1: 0.37482927313814596
              precision    recall  f1-score   support

           0   0.589404  0.818015  0.685142       544
           1   0.281250  0.162162  0.205714       222
           2   0.140000  0.041916  0.064516       167

    accuracy                       0.523044       933
   macro avg   0.336885  0.340698  0.318458       933
weighted avg   0.435641  0.523044  0.459979       933

Test Acc: 0.5230439442658092 F1_ma:0.37482927313814596
Train step: 260 acc:0.57917 total_loss: 1.4727  loss:1.347,stance loss: 1.0222 
Train step: 270 acc:0.5825 total_loss: 1.4639  loss:1.4067,stance loss: 1.0617 
Train step: 280 acc:0.57679 total_loss: 1.4659  loss:1.4017,stance loss: 1.0195 
Train step: 290 acc:0.56806 total_loss: 1.4841  loss:1.4806,stance loss: 1.1458 
Train step: 300 acc:0.56591 total_loss: 1.4869  loss:1.6137,stance loss: 1.0421 
Train step: 310 acc:0.5625 total_loss: 1.5  loss:1.7019,stance loss: 1.6354 
Train step: 320 acc:0.55833 total_loss: 1.491  loss:1.5569,stance loss: 1.1866 
Train step: 330 acc:0.56103 total_loss: 1.4846  loss:1.413,stance loss: 1.0499 
Train step: 340 acc:0.55855 total_loss: 1.485  loss:1.4541,stance loss: 1.0737 
Train step: 350 acc:0.55952 total_loss: 1.483  loss:1.3492,stance loss: 1.0102 
Train step: 360 acc:0.55978 total_loss: 1.4665  loss:1.3038,stance loss: 0.92251 
Train step: 370 acc:0.563 total_loss: 1.4693  loss:1.7101,stance loss: 1.7023 
Train step: 380 acc:0.55926 total_loss: 1.4746  loss:1.6144,stance loss: 1.0626 
Train step: 390 acc:0.55991 total_loss: 1.4707  loss:1.5166,stance loss: 1.166 
Train step: 400 acc:0.5621 total_loss: 1.4661  loss:1.4955,stance loss: 1.0553 
Train step: 410 acc:0.56136 total_loss: 1.4669  loss:1.3487,stance loss: 1.0743 
Train step: 420 acc:0.55964 total_loss: 1.4649  loss:1.3808,stance loss: 1.0454 
Train step: 430 acc:0.56182 total_loss: 1.4613  loss:1.2919,stance loss: 0.9842 
Train step: 440 acc:0.56026 total_loss: 1.4626  loss:1.8468,stance loss: 1.6839 
Train step: 450 acc:0.56067 total_loss: 1.4605  loss:1.4344,stance loss: 0.96388 
Train step: 460 acc:0.5625 total_loss: 1.4568  loss:1.1896,stance loss: 0.84467 
Train step: 470 acc:0.56389 total_loss: 1.4526  loss:1.4946,stance loss: 1.6017 
Train step: 480 acc:0.56277 total_loss: 1.4546  loss:1.3044,stance loss: 1.0069 
Train step: 490 acc:0.5676 total_loss: 1.448  loss:1.2496,stance loss: 0.89873 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.66667 total_loss: 1.3144  loss:1.2784,stance loss: 1.2601 
Train step: 510 acc:0.625 total_loss: 1.3433  loss:1.3909,stance loss: 1.1875 
Train step: 520 acc:0.60345 total_loss: 1.3984  loss:1.3806,stance loss: 1.1908 
Train step: 530 acc:0.59776 total_loss: 1.3902  loss:1.3184,stance loss: 0.97292 
Train step: 540 acc:0.60332 total_loss: 1.3635  loss:1.0535,stance loss: 0.73889 
Train step: 550 acc:0.60381 total_loss: 1.3739  loss:1.2631,stance loss: 0.97251 
Train step: 560 acc:0.60688 total_loss: 1.3597  loss:1.0643,stance loss: 0.96585 
Train step: 570 acc:0.60601 total_loss: 1.365  loss:1.6469,stance loss: 1.2844 
Train step: 580 acc:0.60393 total_loss: 1.3794  loss:1.5193,stance loss: 1.602 
Train step: 590 acc:0.60669 total_loss: 1.3783  loss:1.2665,stance loss: 1.0114 
Train step: 600 acc:0.60378 total_loss: 1.3768  loss:1.2778,stance loss: 1.0066 
Train step: 610 acc:0.60924 total_loss: 1.3664  loss:1.1034,stance loss: 0.97243 
Train step: 620 acc:0.60901 total_loss: 1.3674  loss:1.1999,stance loss: 0.90841 
Train step: 630 acc:0.61016 total_loss: 1.364  loss:1.172,stance loss: 0.89281 
Train step: 640 acc:0.612 total_loss: 1.3614  loss:1.8277,stance loss: 1.5108 
Train step: 650 acc:0.61203 total_loss: 1.3633  loss:1.2734,stance loss: 0.94331 
Train step: 660 acc:0.61132 total_loss: 1.3583  loss:1.2858,stance loss: 0.97564 
Train step: 670 acc:0.61138 total_loss: 1.3521  loss:1.1676,stance loss: 0.93097 
Train step: 680 acc:0.60615 total_loss: 1.3566  loss:1.4962,stance loss: 1.0889 
Train step: 690 acc:0.60992 total_loss: 1.3586  loss:1.1706,stance loss: 0.98243 
Train step: 700 acc:0.61154 total_loss: 1.3548  loss:1.382,stance loss: 1.0709 
Train step: 710 acc:0.61216 total_loss: 1.3565  loss:0.84553,stance loss: 0.53106 
Train step: 720 acc:0.61408 total_loss: 1.3542  loss:1.5245,stance loss: 1.1367 
Train step: 730 acc:0.6148 total_loss: 1.3513  loss:1.3072,stance loss: 1.0106 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.6875 total_loss: 1.1799  loss:1.4563,stance loss: 1.1606 
Train step: 750 acc:0.65385 total_loss: 1.1841  loss:1.084,stance loss: 0.72921 
Train step: 760 acc:0.68207 total_loss: 1.1801  loss:1.2616,stance loss: 1.4308 
Train step: 770 acc:0.67424 total_loss: 1.189  loss:1.1693,stance loss: 1.0232 
Train step: 780 acc:0.67733 total_loss: 1.2119  loss:1.3414,stance loss: 1.1353 
Train step: 790 acc:0.67335 total_loss: 1.2254  loss:1.258,stance loss: 1.0591 
Train step: 800 acc:0.66964 total_loss: 1.2201  loss:1.0333,stance loss: 0.80429 
Train step: 810 acc:0.67123 total_loss: 1.2187  loss:1.0117,stance loss: 0.84829 
Train step: 820 acc:0.66491 total_loss: 1.2221  loss:0.96395,stance loss: 0.73442 
Train step: 830 acc:0.66935 total_loss: 1.2169  loss:1.2659,stance loss: 1.0245 
Train step: 840 acc:0.66687 total_loss: 1.2166  loss:1.2863,stance loss: 1.0711 
Train step: 850 acc:0.66316 total_loss: 1.2136  loss:1.1236,stance loss: 0.75641 
Train step: 860 acc:0.66006 total_loss: 1.219  loss:1.1092,stance loss: 0.84877 
Train step: 870 acc:0.66212 total_loss: 1.2207  loss:1.1958,stance loss: 0.75689 
Train step: 880 acc:0.66084 total_loss: 1.2165  loss:0.96276,stance loss: 0.75592 
Train step: 890 acc:0.66299 total_loss: 1.2177  loss:1.5169,stance loss: 1.631 
Train step: 900 acc:0.66219 total_loss: 1.217  loss:1.0535,stance loss: 0.9151 
Train step: 910 acc:0.66366 total_loss: 1.2166  loss:1.1628,stance loss: 0.85388 
Train step: 920 acc:0.66291 total_loss: 1.2171  loss:1.1474,stance loss: 1.207 
Train step: 930 acc:0.66321 total_loss: 1.2163  loss:1.1105,stance loss: 0.88424 
Train step: 940 acc:0.66195 total_loss: 1.2177  loss:1.3348,stance loss: 1.0204 
Train step: 950 acc:0.66227 total_loss: 1.2151  loss:0.82164,stance loss: 0.6947 
Train step: 960 acc:0.66003 total_loss: 1.2194  loss:1.0592,stance loss: 0.90756 
Train step: 970 acc:0.66014 total_loss: 1.2229  loss:1.425,stance loss: 1.1266 
Train step: 980 acc:0.65895 total_loss: 1.2253  loss:1.2283,stance loss: 1.0646 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.64286 total_loss: 1.2892  loss:1.4323,stance loss: 1.5714 
Train step: 1000 acc:0.68382 total_loss: 1.1764  loss:1.4045,stance loss: 1.2374 
Train step: 1010 acc:0.69444 total_loss: 1.1764  loss:1.3765,stance loss: 1.1834 
Train step: 1020 acc:0.67905 total_loss: 1.1726  loss:1.0573,stance loss: 0.85179 
Train step: 1030 acc:0.67819 total_loss: 1.1515  loss:0.88447,stance loss: 0.74501 
Train step: 1040 acc:0.67982 total_loss: 1.1456  loss:1.0957,stance loss: 1.0438 
Train step: 1050 acc:0.67631 total_loss: 1.1537  loss:1.2267,stance loss: 0.96074 
Train step: 1060 acc:0.68019 total_loss: 1.1563  loss:0.86156,stance loss: 0.67982 
Better F1! Saving model!
Saving model of best f1: 0.4113604656055883
              precision    recall  f1-score   support

           0   0.594937  0.431985  0.500532       544
           1   0.348404  0.590090  0.438127       222
           2   0.327160  0.317365  0.322188       167

    accuracy                       0.449089       933
   macro avg   0.423500  0.446480  0.420283       933
weighted avg   0.488346  0.449089  0.453761       933

Test Acc: 0.4490889603429796 F1_ma:0.4113604656055883
Train step: 1070 acc:0.68247 total_loss: 1.1595  loss:1.1491,stance loss: 0.79667 
Train step: 1080 acc:0.68041 total_loss: 1.1642  loss:1.0659,stance loss: 0.90783 
Train step: 1090 acc:0.68049 total_loss: 1.1568  loss:0.8261,stance loss: 0.55547 
Train step: 1100 acc:0.68216 total_loss: 1.1493  loss:1.1266,stance loss: 0.93093 
Train step: 1110 acc:0.68258 total_loss: 1.1485  loss:1.1351,stance loss: 0.97107 
Train step: 1120 acc:0.68248 total_loss: 1.151  loss:0.90065,stance loss: 0.69531 
Train step: 1130 acc:0.68367 total_loss: 1.1458  loss:1.1782,stance loss: 0.93042 
Train step: 1140 acc:0.6875 total_loss: 1.1372  loss:1.0673,stance loss: 0.86796 
Train step: 1150 acc:0.6875 total_loss: 1.1369  loss:1.0284,stance loss: 0.80086 
Train step: 1160 acc:0.68573 total_loss: 1.141  loss:1.4111,stance loss: 0.95365 
Train step: 1170 acc:0.68717 total_loss: 1.1411  loss:1.3905,stance loss: 1.3493 
Train step: 1180 acc:0.68528 total_loss: 1.1467  loss:1.0333,stance loss: 0.80371 
Train step: 1190 acc:0.68508 total_loss: 1.1458  loss:1.2705,stance loss: 1.0306 
Train step: 1200 acc:0.68923 total_loss: 1.1378  loss:1.0069,stance loss: 0.68814 
Train step: 1210 acc:0.6897 total_loss: 1.1367  loss:1.3669,stance loss: 1.1439 
Train step: 1220 acc:0.69014 total_loss: 1.1346  loss:1.025,stance loss: 0.8831 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.6875 total_loss: 1.2415  loss:1.2415,stance loss: 1.0409 
Train step: 1240 acc:0.76136 total_loss: 0.9732  loss:1.2285,stance loss: 0.82032 
Train step: 1250 acc:0.75595 total_loss: 0.96904  loss:0.9215,stance loss: 0.78828 
Train step: 1260 acc:0.74194 total_loss: 0.97176  loss:0.92625,stance loss: 0.64208 
Train step: 1270 acc:0.72256 total_loss: 1.013  loss:0.8471,stance loss: 0.68066 
Train step: 1280 acc:0.71691 total_loss: 1.0321  loss:1.3982,stance loss: 1.59 
Train step: 1290 acc:0.71209 total_loss: 1.0523  loss:1.4815,stance loss: 1.1345 
Train step: 1300 acc:0.70951 total_loss: 1.0519  loss:0.89146,stance loss: 0.65325 
Train step: 1310 acc:0.7037 total_loss: 1.074  loss:1.1142,stance loss: 0.87038 
Train step: 1320 acc:0.70879 total_loss: 1.0638  loss:0.95827,stance loss: 0.8239 
Train step: 1330 acc:0.70916 total_loss: 1.0712  loss:1.1084,stance loss: 0.78191 
Train step: 1340 acc:0.71115 total_loss: 1.0636  loss:0.95325,stance loss: 0.77963 
Train step: 1350 acc:0.71074 total_loss: 1.0639  loss:0.79088,stance loss: 0.65529 
Train step: 1360 acc:0.71517 total_loss: 1.0566  loss:0.89017,stance loss: 0.71356 
Train step: 1370 acc:0.71099 total_loss: 1.0702  loss:1.3983,stance loss: 0.94119 
Train step: 1380 acc:0.70902 total_loss: 1.072  loss:1.088,stance loss: 0.78839 
Train step: 1390 acc:0.70807 total_loss: 1.0728  loss:1.1529,stance loss: 0.82665 
Train step: 1400 acc:0.71016 total_loss: 1.0732  loss:1.0787,stance loss: 0.90976 
Train step: 1410 acc:0.71271 total_loss: 1.0683  loss:0.92276,stance loss: 0.7443 
Train step: 1420 acc:0.71106 total_loss: 1.0699  loss:0.91825,stance loss: 0.75606 
Train step: 1430 acc:0.71175 total_loss: 1.0723  loss:0.92299,stance loss: 0.75517 
Train step: 1440 acc:0.71238 total_loss: 1.0716  loss:1.0557,stance loss: 0.95708 
Train step: 1450 acc:0.71324 total_loss: 1.067  loss:0.86492,stance loss: 0.7498 
Train step: 1460 acc:0.71591 total_loss: 1.0604  loss:0.67211,stance loss: 0.48821 
Train step: 1470 acc:0.71706 total_loss: 1.0606  loss:1.591,stance loss: 1.2666 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.725 total_loss: 0.9914  loss:0.69929,stance loss: 0.6365 
Train step: 1490 acc:0.72917 total_loss: 1.0255  loss:1.0419,stance loss: 0.84558 
Train step: 1500 acc:0.725 total_loss: 1.0277  loss:1.0133,stance loss: 0.9054 
Train step: 1510 acc:0.73036 total_loss: 0.99283  loss:0.97592,stance loss: 0.887 
Train step: 1520 acc:0.73333 total_loss: 0.99675  loss:1.6492,stance loss: 1.1791 
Train step: 1530 acc:0.7375 total_loss: 0.97222  loss:0.70648,stance loss: 0.29889 
Train step: 1540 acc:0.73269 total_loss: 0.97939  loss:1.0287,stance loss: 0.91871 
Train step: 1550 acc:0.73417 total_loss: 0.97745  loss:0.82151,stance loss: 0.62734 
Train step: 1560 acc:0.73162 total_loss: 0.98451  loss:1.3109,stance loss: 0.87263 
Train step: 1570 acc:0.73224 total_loss: 0.98754  loss:0.84383,stance loss: 0.71385 
Train step: 1580 acc:0.73452 total_loss: 0.98389  loss:1.2428,stance loss: 0.84959 
Train step: 1590 acc:0.7375 total_loss: 0.97092  loss:0.56281,stance loss: 0.42169 
Train step: 1600 acc:0.7365 total_loss: 0.96909  loss:1.1659,stance loss: 0.99391 
Train step: 1610 acc:0.73981 total_loss: 0.96848  loss:1.0824,stance loss: 0.8872 
Train step: 1620 acc:0.73966 total_loss: 0.96588  loss:0.55085,stance loss: 0.47605 
Train step: 1630 acc:0.74194 total_loss: 0.96198  loss:1.3265,stance loss: 0.88763 
Train step: 1640 acc:0.74432 total_loss: 0.96126  loss:1.0444,stance loss: 0.85122 
Train step: 1650 acc:0.74071 total_loss: 0.96648  loss:1.3208,stance loss: 1.1962 
Train step: 1660 acc:0.73986 total_loss: 0.97041  loss:1.3491,stance loss: 1.0002 
Train step: 1670 acc:0.74071 total_loss: 0.97169  loss:1.3371,stance loss: 1.4963 
Train step: 1680 acc:0.73963 total_loss: 0.97305  loss:0.43424,stance loss: 0.23221 
Train step: 1690 acc:0.73895 total_loss: 0.97278  loss:0.86286,stance loss: 0.56262 
Train step: 1700 acc:0.74028 total_loss: 0.97353  loss:0.60557,stance loss: 0.51344 
Train step: 1710 acc:0.74309 total_loss: 0.96799  loss:0.78023,stance loss: 0.59613 
Train step: 1720 acc:0.74362 total_loss: 0.96598  loss:0.92714,stance loss: 0.78119 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.76389 total_loss: 0.96492  loss:1.0568,stance loss: 0.80296 
Train step: 1740 acc:0.80592 total_loss: 0.82964  loss:0.83734,stance loss: 0.62429 
Train step: 1750 acc:0.80819 total_loss: 0.84722  loss:0.62022,stance loss: 0.64358 
Train step: 1760 acc:0.8109 total_loss: 0.83236  loss:0.85294,stance loss: 0.74867 
Train step: 1770 acc:0.80995 total_loss: 0.8118  loss:0.3665,stance loss: 0.17382 
Train step: 1780 acc:0.79979 total_loss: 0.86194  loss:1.5684,stance loss: 1.1225 
Better F1! Saving model!
Saving model of best f1: 0.43326714664645705
              precision    recall  f1-score   support

           0   0.640483  0.389706  0.484571       544
           1   0.395408  0.698198  0.504886       222
           2   0.342857  0.431138  0.381963       167

    accuracy                       0.470525       933
   macro avg   0.459583  0.506347  0.457140       933
weighted avg   0.528897  0.470525  0.471039       933

Test Acc: 0.4705251875669882 F1_ma:0.43326714664645705
Train step: 1790 acc:0.79167 total_loss: 0.8793  loss:1.041,stance loss: 0.8935 
Train step: 1800 acc:0.79272 total_loss: 0.86363  loss:0.6568,stance loss: 0.54899 
Train step: 1810 acc:0.79494 total_loss: 0.86675  loss:0.85993,stance loss: 0.85477 
Train step: 1820 acc:0.79798 total_loss: 0.86095  loss:1.0982,stance loss: 1.2868 
Train step: 1830 acc:0.7953 total_loss: 0.87275  loss:0.62842,stance loss: 0.29534 
Train step: 1840 acc:0.79569 total_loss: 0.86279  loss:1.0593,stance loss: 1.3435 
Train step: 1850 acc:0.79457 total_loss: 0.86112  loss:0.84562,stance loss: 0.65872 
Train step: 1860 acc:0.79182 total_loss: 0.87076  loss:1.0882,stance loss: 1.4331 
Train step: 1870 acc:0.79069 total_loss: 0.87345  loss:0.96206,stance loss: 0.77471 
Train step: 1880 acc:0.78892 total_loss: 0.88136  loss:0.80083,stance loss: 0.75188 
Train step: 1890 acc:0.78772 total_loss: 0.87428  loss:0.91469,stance loss: 0.76995 
Train step: 1900 acc:0.7905 total_loss: 0.8701  loss:0.62263,stance loss: 0.3538 
Train step: 1910 acc:0.78902 total_loss: 0.87219  loss:0.83531,stance loss: 0.75053 
Train step: 1920 acc:0.78643 total_loss: 0.8835  loss:0.80305,stance loss: 0.6756 
Train step: 1930 acc:0.78618 total_loss: 0.88281  loss:0.62112,stance loss: 0.49132 
Train step: 1940 acc:0.78539 total_loss: 0.88536  loss:1.485,stance loss: 1.5854 
Train step: 1950 acc:0.78521 total_loss: 0.88513  loss:1.5907,stance loss: 1.3951 
Train step: 1960 acc:0.78556 total_loss: 0.88122  loss:0.3656,stance loss: 0.23833 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.8125 total_loss: 0.79792  loss:0.89721,stance loss: 0.77345 
Train step: 1980 acc:0.82212 total_loss: 0.71926  loss:0.83174,stance loss: 0.58325 
Train step: 1990 acc:0.83424 total_loss: 0.72768  loss:1.1565,stance loss: 1.4347 
Train step: 2000 acc:0.82386 total_loss: 0.74203  loss:0.8087,stance loss: 0.67445 
Train step: 2010 acc:0.82558 total_loss: 0.71816  loss:0.82693,stance loss: 0.68592 
Train step: 2020 acc:0.82193 total_loss: 0.7439  loss:0.756,stance loss: 0.58472 
Train step: 2030 acc:0.8254 total_loss: 0.75098  loss:1.1519,stance loss: 0.99034 
Train step: 2040 acc:0.82449 total_loss: 0.76001  loss:0.95151,stance loss: 0.89214 
Train step: 2050 acc:0.82078 total_loss: 0.76528  loss:1.6148,stance loss: 1.7649 
Train step: 2060 acc:0.8172 total_loss: 0.78141  loss:0.50989,stance loss: 0.37908 
Train step: 2070 acc:0.81978 total_loss: 0.76869  loss:0.64801,stance loss: 0.63871 
Train step: 2080 acc:0.8208 total_loss: 0.76225  loss:0.75576,stance loss: 0.54008 
Train step: 2090 acc:0.82114 total_loss: 0.75703  loss:0.67955,stance loss: 0.46794 
Train step: 2100 acc:0.8219 total_loss: 0.76026  loss:0.87179,stance loss: 0.83884 
Train step: 2110 acc:0.82343 total_loss: 0.76053  loss:0.4712,stance loss: 0.38574 
Train step: 2120 acc:0.82108 total_loss: 0.76723  loss:0.32755,stance loss: 0.19819 
Train step: 2130 acc:0.81787 total_loss: 0.77173  loss:0.75062,stance loss: 0.59629 
Train step: 2140 acc:0.82153 total_loss: 0.76536  loss:1.1707,stance loss: 1.5335 
Train step: 2150 acc:0.82206 total_loss: 0.76263  loss:0.64623,stance loss: 0.3928 
Train step: 2160 acc:0.82578 total_loss: 0.74805  loss:0.3043,stance loss: 0.21842 
Train step: 2170 acc:0.82728 total_loss: 0.74853  loss:1.0534,stance loss: 0.77107 
Train step: 2180 acc:0.82688 total_loss: 0.75248  loss:0.6282,stance loss: 0.5436 
Train step: 2190 acc:0.82651 total_loss: 0.75111  loss:0.88073,stance loss: 0.72019 
Train step: 2200 acc:0.82725 total_loss: 0.74663  loss:0.67896,stance loss: 0.18806 
Train step: 2210 acc:0.8287 total_loss: 0.74575  loss:1.1413,stance loss: 1.1292 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.79464 total_loss: 0.84517  loss:0.35252,stance loss: 0.29485 
Train step: 2230 acc:0.84559 total_loss: 0.64665  loss:0.55938,stance loss: 0.42705 
Train step: 2240 acc:0.85417 total_loss: 0.667  loss:0.71694,stance loss: 0.57331 
Train step: 2250 acc:0.85473 total_loss: 0.66562  loss:0.65511,stance loss: 0.49782 
Train step: 2260 acc:0.85904 total_loss: 0.65722  loss:0.5389,stance loss: 0.52008 
Train step: 2270 acc:0.85526 total_loss: 0.66618  loss:0.46237,stance loss: 0.44946 
Train step: 2280 acc:0.85634 total_loss: 0.65249  loss:0.37482,stance loss: 0.23365 
Train step: 2290 acc:0.85958 total_loss: 0.64772  loss:0.95633,stance loss: 0.80562 
Train step: 2300 acc:0.85489 total_loss: 0.65452  loss:0.43788,stance loss: 0.31927 
Train step: 2310 acc:0.85374 total_loss: 0.65997  loss:0.95333,stance loss: 0.91017 
Train step: 2320 acc:0.8528 total_loss: 0.65969  loss:0.63069,stance loss: 0.41509 
Train step: 2330 acc:0.85256 total_loss: 0.66483  loss:0.99585,stance loss: 1.0266 
Train step: 2340 acc:0.85285 total_loss: 0.66423  loss:1.1525,stance loss: 1.0026 
Train step: 2350 acc:0.85036 total_loss: 0.67178  loss:0.58711,stance loss: 0.64004 
Train step: 2360 acc:0.85162 total_loss: 0.66983  loss:0.32244,stance loss: 0.22007 
Train step: 2370 acc:0.8543 total_loss: 0.66644  loss:0.88289,stance loss: 0.8017 
Train step: 2380 acc:0.85479 total_loss: 0.67177  loss:0.22145,stance loss: 0.15338 
Train step: 2390 acc:0.85275 total_loss: 0.67521  loss:0.58195,stance loss: 0.32296 
Train step: 2400 acc:0.85194 total_loss: 0.67194  loss:0.66852,stance loss: 0.4873 
Train step: 2410 acc:0.85279 total_loss: 0.67209  loss:0.7563,stance loss: 1.1392 
Train step: 2420 acc:0.85115 total_loss: 0.67639  loss:0.73989,stance loss: 0.49702 
Train step: 2430 acc:0.85282 total_loss: 0.66711  loss:0.72365,stance loss: 0.65306 
Train step: 2440 acc:0.85325 total_loss: 0.66786  loss:0.72875,stance loss: 0.69677 
Train step: 2450 acc:0.85443 total_loss: 0.66937  loss:0.44587,stance loss: 0.35531 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.64181  loss:0.64181,stance loss: 0.4447 
Train step: 2470 acc:0.90909 total_loss: 0.64272  loss:1.0054,stance loss: 1.2347 
Train step: 2480 acc:0.90476 total_loss: 0.59947  loss:0.58065,stance loss: 0.49544 
Train step: 2490 acc:0.90927 total_loss: 0.58587  loss:0.39606,stance loss: 0.22862 
Train step: 2500 acc:0.91463 total_loss: 0.55627  loss:0.1154,stance loss: 0.058579 
Train step: 2510 acc:0.90686 total_loss: 0.54886  loss:0.30105,stance loss: 0.14827 
Train step: 2520 acc:0.90164 total_loss: 0.54903  loss:0.55728,stance loss: 0.36542 
Train step: 2530 acc:0.89877 total_loss: 0.56463  loss:0.18728,stance loss: 0.19538 
Train step: 2540 acc:0.89892 total_loss: 0.55025  loss:0.61945,stance loss: 0.60923 
Train step: 2550 acc:0.89835 total_loss: 0.5566  loss:0.48621,stance loss: 0.45569 
Train step: 2560 acc:0.90037 total_loss: 0.54864  loss:0.90954,stance loss: 0.98501 
Train step: 2570 acc:0.89752 total_loss: 0.55925  loss:0.90795,stance loss: 0.80412 
Train step: 2580 acc:0.89566 total_loss: 0.56327  loss:0.95073,stance loss: 1.3163 
Train step: 2590 acc:0.89552 total_loss: 0.5559  loss:0.57097,stance loss: 0.46161 
Train step: 2600 acc:0.89317 total_loss: 0.56533  loss:0.77203,stance loss: 0.65422 
Train step: 2610 acc:0.89114 total_loss: 0.5653  loss:0.50562,stance loss: 0.45144 
Train step: 2620 acc:0.89208 total_loss: 0.56211  loss:0.51173,stance loss: 0.39645 
Train step: 2630 acc:0.89145 total_loss: 0.55651  loss:0.66294,stance loss: 0.60682 
Better F1! Saving model!
Saving model of best f1: 0.43403590944574555
              precision    recall  f1-score   support

           0   0.661290  0.376838  0.480094       544
           1   0.384434  0.734234  0.504644       222
           2   0.356784  0.425150  0.387978       167

    accuracy                       0.470525       933
   macro avg   0.467503  0.512074  0.457572       933
weighted avg   0.540910  0.470525  0.469447       933

Test Acc: 0.4705251875669882 F1_ma:0.43403590944574555
Train step: 2640 acc:0.89296 total_loss: 0.55238  loss:0.31199,stance loss: 0.29107 
Better F1! Saving model!
Saving model of best f1: 0.4420779806175344
              precision    recall  f1-score   support

           0   0.633690  0.435662  0.516340       544
           1   0.373016  0.635135  0.470000       222
           2   0.353591  0.383234  0.367816       167

    accuracy                       0.473741       933
   macro avg   0.453432  0.484677  0.451385       933
weighted avg   0.521529  0.473741  0.478729       933

Test Acc: 0.4737406216505895 F1_ma:0.4420779806175344
Train step: 2650 acc:0.89202 total_loss: 0.56329  loss:0.43429,stance loss: 0.33713 
Train step: 2660 acc:0.89179 total_loss: 0.56003  loss:0.53662,stance loss: 0.3555 
Train step: 2670 acc:0.891 total_loss: 0.56082  loss:0.83295,stance loss: 1.1445 
Train step: 2680 acc:0.89055 total_loss: 0.56388  loss:0.5102,stance loss: 0.32417 
Train step: 2690 acc:0.89042 total_loss: 0.56307  loss:0.32751,stance loss: 0.20769 
Train step: 2700 acc:0.89056 total_loss: 0.55659  loss:0.37863,stance loss: 0.30897 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.925 total_loss: 0.40044  loss:0.23819,stance loss: 0.1693 
Train step: 2720 acc:0.89167 total_loss: 0.44328  loss:0.16326,stance loss: 0.13216 
Train step: 2730 acc:0.9025 total_loss: 0.47343  loss:0.2494,stance loss: 0.14684 
Train step: 2740 acc:0.89643 total_loss: 0.46053  loss:0.49223,stance loss: 0.33375 
Better F1! Saving model!
Saving model of best f1: 0.4440366750239212
              precision    recall  f1-score   support

           0   0.674699  0.411765  0.511416       544
           1   0.416880  0.734234  0.531811       222
           2   0.338095  0.425150  0.376658       167

    accuracy                       0.490890       933
   macro avg   0.476558  0.523716  0.473295       933
weighted avg   0.553103  0.490890  0.492148       933

Test Acc: 0.4908896034297964 F1_ma:0.4440366750239212
Train step: 2750 acc:0.89861 total_loss: 0.46937  loss:1.2568,stance loss: 1.443 
Train step: 2760 acc:0.89659 total_loss: 0.49067  loss:0.60041,stance loss: 0.59253 
Train step: 2770 acc:0.89808 total_loss: 0.47773  loss:0.10803,stance loss: 0.040088 
Train step: 2780 acc:0.90167 total_loss: 0.46743  loss:0.28548,stance loss: 0.21196 
Train step: 2790 acc:0.90368 total_loss: 0.47792  loss:1.1648,stance loss: 1.5593 
Train step: 2800 acc:0.90658 total_loss: 0.46112  loss:0.24988,stance loss: 0.12591 
Train step: 2810 acc:0.91071 total_loss: 0.4479  loss:0.37951,stance loss: 0.18424 
Train step: 2820 acc:0.90978 total_loss: 0.46168  loss:1.0839,stance loss: 1.1513 
Train step: 2830 acc:0.911 total_loss: 0.4658  loss:1.1403,stance loss: 1.6222 
Train step: 2840 acc:0.9088 total_loss: 0.47074  loss:0.84272,stance loss: 0.66828 
Train step: 2850 acc:0.90647 total_loss: 0.48039  loss:0.91829,stance loss: 1.3354 
Train step: 2860 acc:0.90887 total_loss: 0.47384  loss:0.09009,stance loss: 0.027357 
Train step: 2870 acc:0.90871 total_loss: 0.47675  loss:0.1462,stance loss: 0.087009 
Train step: 2880 acc:0.90893 total_loss: 0.46984  loss:0.19655,stance loss: 0.093888 
Train step: 2890 acc:0.91014 total_loss: 0.46696  loss:0.179,stance loss: 0.17329 
Train step: 2900 acc:0.91058 total_loss: 0.45982  loss:0.075645,stance loss: 0.017129 
Train step: 2910 acc:0.91098 total_loss: 0.46  loss:0.48918,stance loss: 0.36652 
Train step: 2920 acc:0.91047 total_loss: 0.46357  loss:0.07776,stance loss: 0.026859 
Train step: 2930 acc:0.91028 total_loss: 0.46276  loss:0.30405,stance loss: 0.22799 
Train step: 2940 acc:0.91011 total_loss: 0.46183  loss:0.51336,stance loss: 0.37944 
Train step: 2950 acc:0.91071 total_loss: 0.45599  loss:0.15513,stance loss: 0.02385 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.9375 total_loss: 0.34984  loss:0.30943,stance loss: 0.33935 
Train step: 2970 acc:0.92434 total_loss: 0.37226  loss:0.35481,stance loss: 0.26876 
Train step: 2980 acc:0.9375 total_loss: 0.33189  loss:0.6528,stance loss: 0.47094 
Train step: 2990 acc:0.93109 total_loss: 0.33831  loss:0.19126,stance loss: 0.14866 
Train step: 3000 acc:0.93112 total_loss: 0.33922  loss:0.76695,stance loss: 0.59261 
Train step: 3010 acc:0.92585 total_loss: 0.35464  loss:0.86679,stance loss: 0.73338 
Train step: 3020 acc:0.92482 total_loss: 0.37579  loss:0.81841,stance loss: 1.0999 
Train step: 3030 acc:0.91851 total_loss: 0.40122  loss:0.98196,stance loss: 1.4398 
Better F1! Saving model!
Saving model of best f1: 0.46722012433580273
              precision    recall  f1-score   support

           0   0.665782  0.461397  0.545060       544
           1   0.395833  0.684685  0.501650       222
           2   0.383721  0.395210  0.389381       167

    accuracy                       0.502680       933
   macro avg   0.481779  0.513764  0.478697       933
weighted avg   0.551063  0.502680  0.506865       933

Test Acc: 0.5026795284030011 F1_ma:0.46722012433580273
Train step: 3040 acc:0.92416 total_loss: 0.37866  loss:0.66866,stance loss: 1.0682 
Train step: 3050 acc:0.92361 total_loss: 0.38268  loss:0.12061,stance loss: 0.076365 
Train step: 3060 acc:0.92317 total_loss: 0.38351  loss:0.44838,stance loss: 0.19184 
Train step: 3070 acc:0.92279 total_loss: 0.38103  loss:0.48042,stance loss: 0.34631 
Train step: 3080 acc:0.92393 total_loss: 0.39135  loss:0.11152,stance loss: 0.065242 
Train step: 3090 acc:0.92671 total_loss: 0.39034  loss:0.30325,stance loss: 0.24718 
Train step: 3100 acc:0.92995 total_loss: 0.3755  loss:0.096868,stance loss: 0.084096 
Train step: 3110 acc:0.932 total_loss: 0.36751  loss:0.15088,stance loss: 0.076125 
Train step: 3120 acc:0.93158 total_loss: 0.37342  loss:0.92239,stance loss: 0.9303 
Train step: 3130 acc:0.93122 total_loss: 0.37329  loss:0.2979,stance loss: 0.25619 
Train step: 3140 acc:0.93188 total_loss: 0.36609  loss:0.16377,stance loss: 0.14723 
Train step: 3150 acc:0.93028 total_loss: 0.37359  loss:0.28709,stance loss: 0.23091 
Train step: 3160 acc:0.93092 total_loss: 0.37499  loss:0.095205,stance loss: 0.035334 
Train step: 3170 acc:0.93122 total_loss: 0.37205  loss:0.12157,stance loss: 0.030872 
Train step: 3180 acc:0.93204 total_loss: 0.36942  loss:0.074939,stance loss: 0.026571 
Train step: 3190 acc:0.93175 total_loss: 0.36916  loss:0.63797,stance loss: 0.56508 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.95833 total_loss: 0.16017  loss:0.22411,stance loss: 0.19745 
Train step: 3210 acc:0.9375 total_loss: 0.37653  loss:0.20832,stance loss: 0.027299 
Train step: 3220 acc:0.94837 total_loss: 0.28941  loss:0.060349,stance loss: 0.0080524 
Train step: 3230 acc:0.95644 total_loss: 0.26342  loss:0.13569,stance loss: 0.083396 
Train step: 3240 acc:0.9564 total_loss: 0.2749  loss:0.36767,stance loss: 0.18755 
Train step: 3250 acc:0.95873 total_loss: 0.2792  loss:0.047887,stance loss: 0.0059796 
Train step: 3260 acc:0.95734 total_loss: 0.29718  loss:0.059972,stance loss: 0.0087691 
Train step: 3270 acc:0.9512 total_loss: 0.30165  loss:0.043556,stance loss: 0.010491 
Train step: 3280 acc:0.95407 total_loss: 0.28187  loss:0.15997,stance loss: 0.096873 
Train step: 3290 acc:0.95296 total_loss: 0.28959  loss:0.51292,stance loss: 0.50725 
Train step: 3300 acc:0.95146 total_loss: 0.29832  loss:0.68774,stance loss: 0.41349 
Train step: 3310 acc:0.95022 total_loss: 0.29483  loss:0.6374,stance loss: 0.26051 
Train step: 3320 acc:0.95071 total_loss: 0.29991  loss:0.037261,stance loss: 0.0099963 
Train step: 3330 acc:0.95066 total_loss: 0.29756  loss:0.045564,stance loss: 0.0078886 
Train step: 3340 acc:0.95105 total_loss: 0.29109  loss:0.043929,stance loss: 0.010814 
Train step: 3350 acc:0.95098 total_loss: 0.28993  loss:0.31998,stance loss: 0.16973 
Train step: 3360 acc:0.94824 total_loss: 0.29714  loss:0.099542,stance loss: 0.056958 
Train step: 3370 acc:0.94834 total_loss: 0.30343  loss:0.21133,stance loss: 0.11502 
Train step: 3380 acc:0.94775 total_loss: 0.30259  loss:0.70644,stance loss: 0.70303 
Train step: 3390 acc:0.94948 total_loss: 0.29556  loss:0.55902,stance loss: 1.0353 
Train step: 3400 acc:0.94889 total_loss: 0.2973  loss:0.59262,stance loss: 0.50237 
Train step: 3410 acc:0.94865 total_loss: 0.2985  loss:0.30877,stance loss: 0.31213 
Train step: 3420 acc:0.94899 total_loss: 0.3033  loss:0.032741,stance loss: 0.003507 
Train step: 3430 acc:0.94984 total_loss: 0.30167  loss:0.36617,stance loss: 0.33657 
Train step: 3440 acc:0.9501 total_loss: 0.30356  loss:0.12774,stance loss: 0.09266 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.98214 total_loss: 0.20476  loss:0.29506,stance loss: 0.20263 
Train step: 3460 acc:0.97426 total_loss: 0.20195  loss:0.25025,stance loss: 0.21499 
Train step: 3470 acc:0.96991 total_loss: 0.2387  loss:0.021204,stance loss: 0.0054311 
Train step: 3480 acc:0.96791 total_loss: 0.24178  loss:0.24742,stance loss: 0.25756 
Train step: 3490 acc:0.96144 total_loss: 0.23872  loss:0.54925,stance loss: 1.0089 
Train step: 3500 acc:0.96162 total_loss: 0.2435  loss:0.077117,stance loss: 0.047744 
Train step: 3510 acc:0.96082 total_loss: 0.22979  loss:0.21134,stance loss: 0.2309 
Train step: 3520 acc:0.96023 total_loss: 0.22924  loss:0.027847,stance loss: 0.0068268 
Train step: 3530 acc:0.95833 total_loss: 0.23234  loss:0.38384,stance loss: 0.27356 
Train step: 3540 acc:0.95747 total_loss: 0.23747  loss:0.12315,stance loss: 0.087687 
Train step: 3550 acc:0.95736 total_loss: 0.23874  loss:0.32684,stance loss: 0.38663 
Train step: 3560 acc:0.9578 total_loss: 0.23443  loss:0.44301,stance loss: 0.3111 
Train step: 3570 acc:0.95915 total_loss: 0.23171  loss:0.2233,stance loss: 0.25527 
Train step: 3580 acc:0.96031 total_loss: 0.23553  loss:0.56238,stance loss: 1.0174 
Train step: 3590 acc:0.96088 total_loss: 0.23232  loss:0.047894,stance loss: 0.0086761 
Train step: 3600 acc:0.96099 total_loss: 0.22822  loss:0.12011,stance loss: 0.1103 
Train step: 3610 acc:0.9607 total_loss: 0.22881  loss:0.44307,stance loss: 0.334 
Train step: 3620 acc:0.96045 total_loss: 0.23037  loss:0.61027,stance loss: 0.44548 
Train step: 3630 acc:0.96056 total_loss: 0.22971  loss:0.58995,stance loss: 0.55455 
Train step: 3640 acc:0.96003 total_loss: 0.22841  loss:0.58937,stance loss: 1.0856 
Train step: 3650 acc:0.95924 total_loss: 0.23317  loss:0.35131,stance loss: 0.16746 
Train step: 3660 acc:0.9591 total_loss: 0.22921  loss:0.26935,stance loss: 0.051381 
Train step: 3670 acc:0.95898 total_loss: 0.23239  loss:0.050265,stance loss: 0.0069573 
Train step: 3680 acc:0.95939 total_loss: 0.23043  loss:0.22927,stance loss: 0.16536 
Training finished.


Reload the best model with best f1 0.46722012433580273 from path test_outputs/bert-cross-topic/la/2023-08-14 18-55-24/state_dict


              precision    recall  f1-score   support

           0   0.665782  0.461397  0.545060       544
           1   0.395833  0.684685  0.501650       222
           2   0.383721  0.395210  0.389381       167

    accuracy                       0.502680       933
   macro avg   0.481779  0.513764  0.478697       933
weighted avg   0.551063  0.502680  0.506865       933

Test Acc: 0.5026795284030011 F1_ma:0.46722012433580273
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.46722012433580273
acc: 0.5026795284030011, f1 :0.4786968045627024
classification report: 
              precision    recall  f1-score   support

         Con     0.6658    0.4614    0.5451       544
        None     0.3958    0.6847    0.5017       222
         Pro     0.3837    0.3952    0.3894       167

    accuracy                         0.5027       933
   macro avg     0.4818    0.5138    0.4787       933
weighted avg     0.5511    0.5027    0.5069       933

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 19-32-56', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 19-32-56
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.7659  loss:1.7659,stance loss: 0.94062 
Train step: 10 acc:0.26136 total_loss: 1.7489  loss:1.5751,stance loss: 1.0104 
Better F1! Saving model!
Saving model of best f1: 0.2783945345858241
              precision    recall  f1-score   support

           0   0.519936  0.599265  0.556789       544
           1   0.081699  0.112613  0.094697       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.376206       933
   macro avg   0.200545  0.237292  0.217162       933
weighted avg   0.322597  0.376206  0.347177       933

Test Acc: 0.3762057877813505 F1_ma:0.2783945345858241
Train step: 20 acc:0.39881 total_loss: 1.7377  loss:1.764,stance loss: 1.686 
Better F1! Saving model!
Saving model of best f1: 0.36831415030467163
              precision    recall  f1-score   support

           0   0.583065  1.000000  0.736628       544
           1   0.000000  0.000000  0.000000       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.583065       933
   macro avg   0.194355  0.333333  0.245543       933
weighted avg   0.339965  0.583065  0.429502       933

Test Acc: 0.5830653804930332 F1_ma:0.36831415030467163
Train step: 30 acc:0.42944 total_loss: 1.6966  loss:1.3645,stance loss: 0.74369 
Train step: 40 acc:0.43293 total_loss: 1.6974  loss:1.8213,stance loss: 1.7283 
Train step: 50 acc:0.4375 total_loss: 1.6874  loss:1.594,stance loss: 1.1449 
Train step: 60 acc:0.44877 total_loss: 1.6796  loss:1.5895,stance loss: 1.1537 
Train step: 70 acc:0.46303 total_loss: 1.6735  loss:1.6022,stance loss: 1.2413 
Train step: 80 acc:0.46605 total_loss: 1.6711  loss:1.6731,stance loss: 1.2407 
Train step: 90 acc:0.4739 total_loss: 1.6639  loss:1.605,stance loss: 1.1392 
Train step: 100 acc:0.47587 total_loss: 1.6558  loss:1.6389,stance loss: 1.1446 
Train step: 110 acc:0.48029 total_loss: 1.6466  loss:1.5456,stance loss: 1.0638 
Train step: 120 acc:0.47986 total_loss: 1.6463  loss:1.4463,stance loss: 0.98678 
Train step: 130 acc:0.48044 total_loss: 1.6444  loss:1.5845,stance loss: 1.2149 
Train step: 140 acc:0.48803 total_loss: 1.6402  loss:1.5797,stance loss: 1.0855 
Train step: 150 acc:0.49462 total_loss: 1.6314  loss:1.5843,stance loss: 1.1469 
Train step: 160 acc:0.49806 total_loss: 1.627  loss:1.6776,stance loss: 1.214 
Train step: 170 acc:0.49963 total_loss: 1.6245  loss:1.6979,stance loss: 1.2466 
Train step: 180 acc:0.50414 total_loss: 1.6163  loss:1.3729,stance loss: 0.9736 
Train step: 190 acc:0.5036 total_loss: 1.6129  loss:1.3452,stance loss: 0.9374 
Train step: 200 acc:0.5084 total_loss: 1.6045  loss:1.3732,stance loss: 0.92485 
Train step: 210 acc:0.51096 total_loss: 1.6022  loss:1.5265,stance loss: 1.2465 
Train step: 220 acc:0.51669 total_loss: 1.595  loss:1.3958,stance loss: 1.0913 
Train step: 230 acc:0.52219 total_loss: 1.5872  loss:1.5194,stance loss: 0.99057 
Train step: 240 acc:0.52308 total_loss: 1.5837  loss:1.7083,stance loss: 1.3427 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.625 total_loss: 1.427  loss:1.4582,stance loss: 1.1235 
Train step: 260 acc:0.54583 total_loss: 1.4983  loss:1.5079,stance loss: 1.0623 
Train step: 270 acc:0.575 total_loss: 1.4916  loss:1.6042,stance loss: 1.1979 
Train step: 280 acc:0.55714 total_loss: 1.5102  loss:1.7329,stance loss: 1.3793 
Better F1! Saving model!
Saving model of best f1: 0.3907048274423939
              precision    recall  f1-score   support

           0   0.607143  0.625000  0.615942       544
           1   0.404580  0.477477  0.438017       222
           2   0.207207  0.137725  0.165468       167

    accuracy                       0.502680       933
   macro avg   0.406310  0.413401  0.406475       933
weighted avg   0.487359  0.502680  0.492975       933

Test Acc: 0.5026795284030011 F1_ma:0.3907048274423939
Train step: 290 acc:0.575 total_loss: 1.4816  loss:1.1086,stance loss: 0.73894 
Train step: 300 acc:0.58636 total_loss: 1.4664  loss:1.2285,stance loss: 0.81086 
Train step: 310 acc:0.60096 total_loss: 1.4527  loss:1.4844,stance loss: 1.1864 
Train step: 320 acc:0.59583 total_loss: 1.4561  loss:1.4301,stance loss: 1.002 
Train step: 330 acc:0.59779 total_loss: 1.4471  loss:1.3884,stance loss: 1.0607 
Train step: 340 acc:0.6 total_loss: 1.4424  loss:1.2541,stance loss: 0.95829 
Train step: 350 acc:0.60595 total_loss: 1.4304  loss:0.98757,stance loss: 0.65402 
Train step: 360 acc:0.60217 total_loss: 1.4285  loss:1.2549,stance loss: 1.0743 
Train step: 370 acc:0.6035 total_loss: 1.4276  loss:1.0796,stance loss: 0.86175 
Train step: 380 acc:0.60093 total_loss: 1.4268  loss:1.4209,stance loss: 1.1684 
Train step: 390 acc:0.59828 total_loss: 1.4254  loss:1.2029,stance loss: 0.90844 
Train step: 400 acc:0.59798 total_loss: 1.4255  loss:1.4431,stance loss: 1.1783 
Better F1! Saving model!
Saving model of best f1: 0.4463706660014967
              precision    recall  f1-score   support

           0   0.590909  0.812500  0.684211       544
           1   0.333333  0.211712  0.258953       222
           2   0.500000  0.131737  0.208531       167

    accuracy                       0.547696       933
   macro avg   0.474747  0.385316  0.383898       933
weighted avg   0.513349  0.547696  0.497881       933

Test Acc: 0.5476956055734191 F1_ma:0.4463706660014967
Train step: 410 acc:0.59811 total_loss: 1.4241  loss:1.6375,stance loss: 1.2102 
Train step: 420 acc:0.59964 total_loss: 1.426  loss:1.3445,stance loss: 0.93971 
Train step: 430 acc:0.59561 total_loss: 1.4295  loss:1.3274,stance loss: 1.1005 
Train step: 440 acc:0.59423 total_loss: 1.4269  loss:1.387,stance loss: 1.0997 
Train step: 450 acc:0.59573 total_loss: 1.424  loss:1.0345,stance loss: 0.676 
Train step: 460 acc:0.59826 total_loss: 1.4237  loss:1.2503,stance loss: 1.1102 
Train step: 470 acc:0.59944 total_loss: 1.4175  loss:1.2353,stance loss: 0.97388 
Train step: 480 acc:0.59867 total_loss: 1.4181  loss:1.5673,stance loss: 1.37 
Train step: 490 acc:0.59923 total_loss: 1.4166  loss:1.4279,stance loss: 1.1307 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.63194 total_loss: 1.3036  loss:1.2975,stance loss: 1.0188 
Train step: 510 acc:0.57895 total_loss: 1.366  loss:1.4516,stance loss: 1.0277 
Train step: 520 acc:0.59914 total_loss: 1.3586  loss:1.2035,stance loss: 1.0198 
Train step: 530 acc:0.60096 total_loss: 1.356  loss:1.3492,stance loss: 1.039 
Train step: 540 acc:0.60969 total_loss: 1.353  loss:1.5707,stance loss: 1.3458 
Train step: 550 acc:0.62076 total_loss: 1.3276  loss:0.93217,stance loss: 0.64881 
Train step: 560 acc:0.62862 total_loss: 1.3196  loss:1.6622,stance loss: 1.3623 
Train step: 570 acc:0.62896 total_loss: 1.3183  loss:1.6607,stance loss: 1.4858 
Train step: 580 acc:0.62992 total_loss: 1.3283  loss:1.2251,stance loss: 0.9985 
Train step: 590 acc:0.61869 total_loss: 1.3338  loss:1.4812,stance loss: 0.97467 
Train step: 600 acc:0.61984 total_loss: 1.3381  loss:1.4098,stance loss: 1.0629 
Train step: 610 acc:0.62237 total_loss: 1.326  loss:1.3995,stance loss: 1.1003 
Train step: 620 acc:0.62258 total_loss: 1.326  loss:1.7932,stance loss: 1.7322 
Train step: 630 acc:0.62365 total_loss: 1.3208  loss:1.3291,stance loss: 1.0382 
Train step: 640 acc:0.6271 total_loss: 1.3178  loss:1.4985,stance loss: 1.0733 
Train step: 650 acc:0.63168 total_loss: 1.3111  loss:1.0038,stance loss: 0.76738 
Train step: 660 acc:0.63314 total_loss: 1.3097  loss:1.0138,stance loss: 0.61256 
Train step: 670 acc:0.63513 total_loss: 1.303  loss:0.94762,stance loss: 0.69732 
Train step: 680 acc:0.63194 total_loss: 1.3078  loss:1.5301,stance loss: 0.97318 
Train step: 690 acc:0.63285 total_loss: 1.3024  loss:0.85853,stance loss: 0.56734 
Train step: 700 acc:0.63367 total_loss: 1.3044  loss:1.5467,stance loss: 1.1397 
Train step: 710 acc:0.63328 total_loss: 1.3043  loss:1.1182,stance loss: 0.84798 
Train step: 720 acc:0.63155 total_loss: 1.3015  loss:1.3375,stance loss: 0.97 
Train step: 730 acc:0.63128 total_loss: 1.299  loss:1.026,stance loss: 0.72757 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.77083 total_loss: 0.89958  loss:0.94188,stance loss: 0.78534 
Train step: 750 acc:0.66827 total_loss: 1.1425  loss:1.504,stance loss: 1.1543 
Train step: 760 acc:0.64674 total_loss: 1.2373  loss:1.1464,stance loss: 0.90341 
Train step: 770 acc:0.65152 total_loss: 1.2307  loss:1.1262,stance loss: 0.88015 
Train step: 780 acc:0.65552 total_loss: 1.2179  loss:0.75542,stance loss: 0.60462 
Train step: 790 acc:0.65212 total_loss: 1.2136  loss:1.3426,stance loss: 0.89707 
Train step: 800 acc:0.64683 total_loss: 1.2261  loss:0.71888,stance loss: 0.35476 
Train step: 810 acc:0.6464 total_loss: 1.227  loss:1.1973,stance loss: 0.94989 
Train step: 820 acc:0.64608 total_loss: 1.2209  loss:0.64712,stance loss: 0.39818 
Train step: 830 acc:0.64583 total_loss: 1.2286  loss:1.1449,stance loss: 0.83237 
Train step: 840 acc:0.65049 total_loss: 1.2199  loss:1.1476,stance loss: 0.95093 
Train step: 850 acc:0.64989 total_loss: 1.2132  loss:1.0858,stance loss: 0.8482 
Train step: 860 acc:0.65549 total_loss: 1.1984  loss:1.1097,stance loss: 1.0303 
Train step: 870 acc:0.65508 total_loss: 1.198  loss:1.2423,stance loss: 1.0858 
Train step: 880 acc:0.6521 total_loss: 1.2103  loss:1.4369,stance loss: 0.96978 
Train step: 890 acc:0.65441 total_loss: 1.2099  loss:1.1735,stance loss: 1.0627 
Train step: 900 acc:0.65644 total_loss: 1.2105  loss:1.0423,stance loss: 0.82184 
Train step: 910 acc:0.65462 total_loss: 1.2157  loss:1.8521,stance loss: 1.8421 
Train step: 920 acc:0.65608 total_loss: 1.2165  loss:1.0045,stance loss: 0.77963 
Train step: 930 acc:0.65544 total_loss: 1.2191  loss:1.2008,stance loss: 1.0847 
Train step: 940 acc:0.6564 total_loss: 1.2129  loss:1.0709,stance loss: 0.73063 
Train step: 950 acc:0.65816 total_loss: 1.2098  loss:1.1463,stance loss: 0.82513 
Train step: 960 acc:0.65695 total_loss: 1.214  loss:1.6464,stance loss: 1.2452 
Train step: 970 acc:0.65826 total_loss: 1.2137  loss:1.7449,stance loss: 1.7095 
Train step: 980 acc:0.65895 total_loss: 1.2104  loss:1.1215,stance loss: 0.84638 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.625 total_loss: 1.0698  loss:1.1939,stance loss: 0.80774 
Train step: 1000 acc:0.63971 total_loss: 1.1016  loss:1.2437,stance loss: 1.0251 
Train step: 1010 acc:0.62963 total_loss: 1.1449  loss:1.0294,stance loss: 0.82073 
Train step: 1020 acc:0.65709 total_loss: 1.1376  loss:1.3811,stance loss: 0.97077 
Train step: 1030 acc:0.66888 total_loss: 1.118  loss:0.84997,stance loss: 0.46482 
Train step: 1040 acc:0.66557 total_loss: 1.1408  loss:1.3347,stance loss: 0.96695 
Train step: 1050 acc:0.67257 total_loss: 1.1335  loss:1.3995,stance loss: 1.0634 
Train step: 1060 acc:0.67532 total_loss: 1.1425  loss:1.2829,stance loss: 1.1132 
Train step: 1070 acc:0.67313 total_loss: 1.1453  loss:1.2821,stance loss: 1.0232 
Train step: 1080 acc:0.67719 total_loss: 1.1403  loss:1.1568,stance loss: 1.0107 
Train step: 1090 acc:0.67932 total_loss: 1.1336  loss:0.97564,stance loss: 0.65253 
Train step: 1100 acc:0.67895 total_loss: 1.1298  loss:0.88122,stance loss: 0.63001 
Train step: 1110 acc:0.67864 total_loss: 1.1258  loss:1.0799,stance loss: 1.4074 
Train step: 1120 acc:0.68111 total_loss: 1.1278  loss:1.432,stance loss: 1.2256 
Train step: 1130 acc:0.68367 total_loss: 1.1259  loss:0.75228,stance loss: 0.55538 
Train step: 1140 acc:0.68551 total_loss: 1.1212  loss:0.98536,stance loss: 0.86989 
Train step: 1150 acc:0.68638 total_loss: 1.122  loss:0.85376,stance loss: 0.62641 
Train step: 1160 acc:0.68468 total_loss: 1.1293  loss:1.4066,stance loss: 1.4994 
Train step: 1170 acc:0.68516 total_loss: 1.1339  loss:1.48,stance loss: 1.1299 
Train step: 1180 acc:0.6856 total_loss: 1.1336  loss:1.1338,stance loss: 0.90346 
Train step: 1190 acc:0.6875 total_loss: 1.1332  loss:1.1678,stance loss: 0.99196 
Train step: 1200 acc:0.68635 total_loss: 1.1299  loss:0.87653,stance loss: 0.70783 
Train step: 1210 acc:0.68365 total_loss: 1.1324  loss:1.1511,stance loss: 0.80497 
Train step: 1220 acc:0.68618 total_loss: 1.1288  loss:1.5492,stance loss: 1.2489 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 0.77044  loss:0.77044,stance loss: 0.55686 
Train step: 1240 acc:0.67614 total_loss: 1.1374  loss:1.1657,stance loss: 1.0353 
Train step: 1250 acc:0.69345 total_loss: 1.0972  loss:1.0869,stance loss: 0.84561 
Train step: 1260 acc:0.69355 total_loss: 1.0657  loss:1.1724,stance loss: 1.0337 
Train step: 1270 acc:0.6936 total_loss: 1.0806  loss:1.1962,stance loss: 1.013 
Train step: 1280 acc:0.69608 total_loss: 1.0817  loss:0.88857,stance loss: 0.75931 
Train step: 1290 acc:0.6957 total_loss: 1.0904  loss:1.3297,stance loss: 0.89305 
Train step: 1300 acc:0.69982 total_loss: 1.0777  loss:1.2731,stance loss: 0.69232 
Train step: 1310 acc:0.69907 total_loss: 1.0755  loss:1.1741,stance loss: 0.77391 
Train step: 1320 acc:0.6978 total_loss: 1.0825  loss:1.0706,stance loss: 0.78634 
Train step: 1330 acc:0.6974 total_loss: 1.0995  loss:1.1298,stance loss: 0.88794 
Train step: 1340 acc:0.6982 total_loss: 1.0913  loss:0.91098,stance loss: 0.73787 
Train step: 1350 acc:0.69938 total_loss: 1.083  loss:0.69156,stance loss: 0.58467 
Train step: 1360 acc:0.70086 total_loss: 1.0792  loss:0.96717,stance loss: 0.7094 
Train step: 1370 acc:0.70168 total_loss: 1.0744  loss:0.9509,stance loss: 0.75446 
Train step: 1380 acc:0.7024 total_loss: 1.0764  loss:0.82522,stance loss: 0.73607 
Train step: 1390 acc:0.70148 total_loss: 1.0852  loss:1.3094,stance loss: 0.85253 
Train step: 1400 acc:0.70431 total_loss: 1.0802  loss:0.8686,stance loss: 0.68023 
Train step: 1410 acc:0.70304 total_loss: 1.08  loss:0.7163,stance loss: 0.4882 
Train step: 1420 acc:0.70812 total_loss: 1.0744  loss:0.78466,stance loss: 0.50533 
Train step: 1430 acc:0.70896 total_loss: 1.0712  loss:1.1019,stance loss: 0.84376 
Train step: 1440 acc:0.70735 total_loss: 1.0746  loss:0.99524,stance loss: 0.72255 
Train step: 1450 acc:0.70843 total_loss: 1.0732  loss:0.9512,stance loss: 0.79068 
Train step: 1460 acc:0.70915 total_loss: 1.0704  loss:0.62256,stance loss: 0.4981 
Train step: 1470 acc:0.7098 total_loss: 1.0694  loss:0.69283,stance loss: 0.4681 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.75 total_loss: 0.91659  loss:0.84034,stance loss: 0.56834 
Train step: 1490 acc:0.72917 total_loss: 0.95163  loss:1.0908,stance loss: 0.89545 
Train step: 1500 acc:0.73 total_loss: 0.95705  loss:0.7157,stance loss: 0.50891 
Train step: 1510 acc:0.70179 total_loss: 1.0231  loss:0.88176,stance loss: 0.69347 
Train step: 1520 acc:0.69444 total_loss: 1.0216  loss:0.921,stance loss: 0.56136 
Train step: 1530 acc:0.69773 total_loss: 1.0393  loss:0.9364,stance loss: 0.71544 
Train step: 1540 acc:0.69423 total_loss: 1.0435  loss:1.4595,stance loss: 1.6312 
Train step: 1550 acc:0.71417 total_loss: 1.0093  loss:0.7517,stance loss: 0.5814 
Train step: 1560 acc:0.71618 total_loss: 1.0131  loss:1.0724,stance loss: 0.76366 
Train step: 1570 acc:0.71382 total_loss: 1.0219  loss:0.83324,stance loss: 0.65676 
Train step: 1580 acc:0.71488 total_loss: 1.0108  loss:0.94377,stance loss: 0.58792 
Train step: 1590 acc:0.7163 total_loss: 1.0008  loss:1.006,stance loss: 0.84159 
Train step: 1600 acc:0.718 total_loss: 1.0046  loss:1.6998,stance loss: 1.287 
Train step: 1610 acc:0.71806 total_loss: 1.0053  loss:1.3955,stance loss: 1.0465 
Train step: 1620 acc:0.71552 total_loss: 1.006  loss:0.79278,stance loss: 0.65787 
Train step: 1630 acc:0.71815 total_loss: 1.0054  loss:0.79018,stance loss: 0.66568 
Train step: 1640 acc:0.71742 total_loss: 1.0027  loss:0.87584,stance loss: 0.74003 
Train step: 1650 acc:0.71786 total_loss: 0.99981  loss:1.0654,stance loss: 0.76095 
Train step: 1660 acc:0.71723 total_loss: 1.0032  loss:0.85222,stance loss: 0.74385 
Train step: 1670 acc:0.71891 total_loss: 0.99827  loss:0.79181,stance loss: 0.60926 
Train step: 1680 acc:0.71951 total_loss: 1.0003  loss:0.4936,stance loss: 0.38062 
Train step: 1690 acc:0.72297 total_loss: 0.99804  loss:1.4401,stance loss: 1.5558 
Train step: 1700 acc:0.72278 total_loss: 0.9976  loss:1.4862,stance loss: 1.6074 
Train step: 1710 acc:0.71968 total_loss: 1.0061  loss:1.2452,stance loss: 0.85959 
Train step: 1720 acc:0.71913 total_loss: 1.0073  loss:1.5339,stance loss: 1.2186 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.72917 total_loss: 0.93784  loss:1.062,stance loss: 0.74369 
Train step: 1740 acc:0.76974 total_loss: 0.91107  loss:0.7225,stance loss: 0.51456 
Train step: 1750 acc:0.77371 total_loss: 0.90286  loss:0.63437,stance loss: 0.46693 
Train step: 1760 acc:0.77564 total_loss: 0.89231  loss:0.84138,stance loss: 0.74675 
Train step: 1770 acc:0.78571 total_loss: 0.86138  loss:0.74681,stance loss: 0.52105 
Train step: 1780 acc:0.78178 total_loss: 0.87215  loss:1.4019,stance loss: 0.9018 
Train step: 1790 acc:0.77536 total_loss: 0.89263  loss:0.74778,stance loss: 0.61326 
Train step: 1800 acc:0.77927 total_loss: 0.88868  loss:0.47454,stance loss: 0.37802 
Train step: 1810 acc:0.7802 total_loss: 0.8832  loss:0.31762,stance loss: 0.17048 
Train step: 1820 acc:0.77525 total_loss: 0.90009  loss:1.1021,stance loss: 0.93078 
Train step: 1830 acc:0.77179 total_loss: 0.91192  loss:0.90723,stance loss: 0.73212 
Train step: 1840 acc:0.77521 total_loss: 0.90324  loss:0.90802,stance loss: 0.66512 
Train step: 1850 acc:0.77229 total_loss: 0.90715  loss:0.79915,stance loss: 0.60139 
Train step: 1860 acc:0.76888 total_loss: 0.90278  loss:1.2114,stance loss: 0.74293 
Train step: 1870 acc:0.7651 total_loss: 0.90742  loss:0.68809,stance loss: 0.2893 
Train step: 1880 acc:0.76179 total_loss: 0.91364  loss:0.81114,stance loss: 0.74891 
Train step: 1890 acc:0.76331 total_loss: 0.90859  loss:1.0371,stance loss: 0.78285 
Train step: 1900 acc:0.76606 total_loss: 0.90338  loss:0.80742,stance loss: 0.69594 
Train step: 1910 acc:0.76554 total_loss: 0.90708  loss:0.78149,stance loss: 0.64828 
Train step: 1920 acc:0.76162 total_loss: 0.91397  loss:0.94146,stance loss: 0.75904 
Train step: 1930 acc:0.76465 total_loss: 0.90455  loss:1.2367,stance loss: 1.1123 
Train step: 1940 acc:0.76455 total_loss: 0.90691  loss:1.072,stance loss: 0.76899 
Train step: 1950 acc:0.76419 total_loss: 0.90474  loss:0.89319,stance loss: 0.65368 
Train step: 1960 acc:0.76543 total_loss: 0.90678  loss:0.97815,stance loss: 1.2048 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.89583 total_loss: 0.63251  loss:0.63966,stance loss: 0.45863 
Train step: 1980 acc:0.79808 total_loss: 0.8091  loss:0.59344,stance loss: 0.51891 
Train step: 1990 acc:0.80163 total_loss: 0.83839  loss:0.88367,stance loss: 0.88394 
Train step: 2000 acc:0.80871 total_loss: 0.80086  loss:0.70912,stance loss: 0.62449 
Train step: 2010 acc:0.80959 total_loss: 0.79588  loss:0.5844,stance loss: 0.4543 
Train step: 2020 acc:0.80778 total_loss: 0.8029  loss:0.67514,stance loss: 0.53819 
Train step: 2030 acc:0.80456 total_loss: 0.81374  loss:1.0263,stance loss: 0.89128 
Train step: 2040 acc:0.80651 total_loss: 0.8154  loss:0.84376,stance loss: 0.76471 
Train step: 2050 acc:0.8012 total_loss: 0.82475  loss:0.99015,stance loss: 0.95489 
Train step: 2060 acc:0.79973 total_loss: 0.82406  loss:0.81702,stance loss: 0.54098 
Train step: 2070 acc:0.80097 total_loss: 0.83426  loss:0.86215,stance loss: 0.76564 
Train step: 2080 acc:0.79757 total_loss: 0.84498  loss:0.97242,stance loss: 0.70582 
Train step: 2090 acc:0.80132 total_loss: 0.84023  loss:0.4338,stance loss: 0.3248 
Train step: 2100 acc:0.80216 total_loss: 0.83145  loss:0.56386,stance loss: 0.40667 
Train step: 2110 acc:0.80332 total_loss: 0.82584  loss:1.384,stance loss: 1.2785 
Train step: 2120 acc:0.80229 total_loss: 0.83249  loss:0.87764,stance loss: 1.2518 
Train step: 2130 acc:0.80023 total_loss: 0.83547  loss:0.70724,stance loss: 0.56818 
Train step: 2140 acc:0.80022 total_loss: 0.83427  loss:0.53062,stance loss: 0.41036 
Train step: 2150 acc:0.8002 total_loss: 0.83974  loss:0.82878,stance loss: 0.62423 
Train step: 2160 acc:0.80084 total_loss: 0.8367  loss:0.82393,stance loss: 0.47755 
Train step: 2170 acc:0.80234 total_loss: 0.83237  loss:0.37196,stance loss: 0.23357 
Train step: 2180 acc:0.80106 total_loss: 0.82945  loss:0.65214,stance loss: 0.47399 
Train step: 2190 acc:0.79877 total_loss: 0.83351  loss:0.52967,stance loss: 0.43489 
Train step: 2200 acc:0.79936 total_loss: 0.83182  loss:0.91649,stance loss: 0.84065 
Train step: 2210 acc:0.79887 total_loss: 0.83131  loss:0.77134,stance loss: 0.49295 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.875 total_loss: 0.72217  loss:0.91589,stance loss: 0.67298 
Train step: 2230 acc:0.88603 total_loss: 0.60731  loss:0.33551,stance loss: 0.25064 
Train step: 2240 acc:0.8588 total_loss: 0.69023  loss:0.47997,stance loss: 0.30069 
Train step: 2250 acc:0.84628 total_loss: 0.67747  loss:0.44801,stance loss: 0.23185 
Train step: 2260 acc:0.83777 total_loss: 0.71453  loss:0.82665,stance loss: 1.1389 
Train step: 2270 acc:0.83333 total_loss: 0.71072  loss:0.85237,stance loss: 0.81188 
Train step: 2280 acc:0.83022 total_loss: 0.71849  loss:1.0676,stance loss: 0.72493 
Train step: 2290 acc:0.83036 total_loss: 0.72944  loss:0.71502,stance loss: 0.66297 
Train step: 2300 acc:0.82974 total_loss: 0.724  loss:1.0536,stance loss: 0.92748 
Train step: 2310 acc:0.82474 total_loss: 0.73583  loss:0.52882,stance loss: 0.33953 
Train step: 2320 acc:0.8236 total_loss: 0.73883  loss:0.35148,stance loss: 0.23426 
Train step: 2330 acc:0.82585 total_loss: 0.73063  loss:1.1873,stance loss: 1.5085 
Train step: 2340 acc:0.82628 total_loss: 0.7204  loss:0.34665,stance loss: 0.13164 
Train step: 2350 acc:0.82482 total_loss: 0.72727  loss:0.80649,stance loss: 0.63026 
Train step: 2360 acc:0.82313 total_loss: 0.72733  loss:1.1088,stance loss: 0.72212 
Train step: 2370 acc:0.82285 total_loss: 0.72379  loss:0.68294,stance loss: 0.48925 
Train step: 2380 acc:0.82186 total_loss: 0.72321  loss:0.44244,stance loss: 0.36026 
Train step: 2390 acc:0.82239 total_loss: 0.72348  loss:0.4098,stance loss: 0.32621 
Train step: 2400 acc:0.82219 total_loss: 0.72292  loss:0.74316,stance loss: 0.5501 
Train step: 2410 acc:0.82265 total_loss: 0.71854  loss:0.64083,stance loss: 0.58964 
Train step: 2420 acc:0.82397 total_loss: 0.72949  loss:0.78946,stance loss: 0.5553 
Train step: 2430 acc:0.82316 total_loss: 0.73171  loss:0.71248,stance loss: 0.49948 
Train step: 2440 acc:0.82241 total_loss: 0.73069  loss:0.5833,stance loss: 0.38851 
Train step: 2450 acc:0.82331 total_loss: 0.72547  loss:0.85286,stance loss: 0.6779 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.8125 total_loss: 0.8667  loss:0.8667,stance loss: 0.79101 
Train step: 2470 acc:0.86932 total_loss: 0.58366  loss:0.86729,stance loss: 0.74732 
Train step: 2480 acc:0.86905 total_loss: 0.57833  loss:0.23841,stance loss: 0.077001 
Train step: 2490 acc:0.87298 total_loss: 0.58815  loss:0.65379,stance loss: 0.57226 
Train step: 2500 acc:0.87043 total_loss: 0.61117  loss:0.3356,stance loss: 0.24911 
Train step: 2510 acc:0.86642 total_loss: 0.6286  loss:0.81347,stance loss: 0.74226 
Train step: 2520 acc:0.86066 total_loss: 0.62947  loss:0.7116,stance loss: 0.60059 
Train step: 2530 acc:0.85651 total_loss: 0.63031  loss:0.52121,stance loss: 0.2646 
Train step: 2540 acc:0.86265 total_loss: 0.61208  loss:0.20791,stance loss: 0.1161 
Train step: 2550 acc:0.86264 total_loss: 0.6086  loss:0.27967,stance loss: 0.22661 
Train step: 2560 acc:0.86139 total_loss: 0.61115  loss:0.38385,stance loss: 0.20933 
Train step: 2570 acc:0.86261 total_loss: 0.60862  loss:0.46208,stance loss: 0.32925 
Train step: 2580 acc:0.86674 total_loss: 0.59394  loss:0.23994,stance loss: 0.20364 
Train step: 2590 acc:0.86641 total_loss: 0.6085  loss:0.54292,stance loss: 0.42337 
Train step: 2600 acc:0.86658 total_loss: 0.60732  loss:0.50304,stance loss: 0.44851 
Train step: 2610 acc:0.86962 total_loss: 0.59928  loss:0.64742,stance loss: 0.56911 
Train step: 2620 acc:0.87112 total_loss: 0.59336  loss:0.53355,stance loss: 0.41484 
Train step: 2630 acc:0.87098 total_loss: 0.58733  loss:0.45159,stance loss: 0.34943 
Train step: 2640 acc:0.87086 total_loss: 0.58845  loss:0.14128,stance loss: 0.041169 
Train step: 2650 acc:0.8714 total_loss: 0.58801  loss:0.51435,stance loss: 0.31065 
Train step: 2660 acc:0.87034 total_loss: 0.58933  loss:1.0724,stance loss: 0.95902 
Train step: 2670 acc:0.86996 total_loss: 0.59495  loss:0.18749,stance loss: 0.06397 
Train step: 2680 acc:0.8685 total_loss: 0.59923  loss:0.47517,stance loss: 0.32684 
Train step: 2690 acc:0.86742 total_loss: 0.60239  loss:0.8577,stance loss: 0.64191 
Train step: 2700 acc:0.86592 total_loss: 0.60594  loss:0.28188,stance loss: 0.11921 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.8875 total_loss: 0.53356  loss:0.5271,stance loss: 0.45639 
Train step: 2720 acc:0.90833 total_loss: 0.60603  loss:0.87484,stance loss: 1.2421 
Train step: 2730 acc:0.9 total_loss: 0.53321  loss:0.51266,stance loss: 0.48922 
Train step: 2740 acc:0.90536 total_loss: 0.51253  loss:0.42088,stance loss: 0.31862 
Train step: 2750 acc:0.9125 total_loss: 0.50712  loss:0.55854,stance loss: 0.48779 
Train step: 2760 acc:0.91591 total_loss: 0.4964  loss:0.18628,stance loss: 0.085855 
Train step: 2770 acc:0.90962 total_loss: 0.50569  loss:0.49984,stance loss: 0.38044 
Train step: 2780 acc:0.90833 total_loss: 0.49978  loss:0.44547,stance loss: 0.40822 
Train step: 2790 acc:0.90809 total_loss: 0.4901  loss:0.64318,stance loss: 0.65647 
Train step: 2800 acc:0.90987 total_loss: 0.48707  loss:0.3634,stance loss: 0.2901 
Train step: 2810 acc:0.9119 total_loss: 0.47994  loss:0.2325,stance loss: 0.062237 
Train step: 2820 acc:0.90978 total_loss: 0.48295  loss:1.2255,stance loss: 0.96004 
Train step: 2830 acc:0.907 total_loss: 0.48398  loss:0.61491,stance loss: 0.52676 
Train step: 2840 acc:0.9037 total_loss: 0.49547  loss:0.30585,stance loss: 0.27552 
Train step: 2850 acc:0.90431 total_loss: 0.49546  loss:0.65681,stance loss: 0.48595 
Train step: 2860 acc:0.90524 total_loss: 0.49147  loss:0.26155,stance loss: 0.1996 
Train step: 2870 acc:0.90379 total_loss: 0.49731  loss:0.30501,stance loss: 0.28645 
Train step: 2880 acc:0.90321 total_loss: 0.49949  loss:0.68848,stance loss: 0.69053 
Train step: 2890 acc:0.90473 total_loss: 0.49105  loss:0.18325,stance loss: 0.1099 
Train step: 2900 acc:0.90417 total_loss: 0.49369  loss:0.82738,stance loss: 0.56266 
Train step: 2910 acc:0.90152 total_loss: 0.49903  loss:0.213,stance loss: 0.14056 
Train step: 2920 acc:0.90029 total_loss: 0.49974  loss:0.74477,stance loss: 0.42251 
Train step: 2930 acc:0.90167 total_loss: 0.49565  loss:0.058392,stance loss: 0.0036898 
Train step: 2940 acc:0.90133 total_loss: 0.49975  loss:0.07596,stance loss: 0.014633 
Train step: 2950 acc:0.90255 total_loss: 0.49934  loss:0.67794,stance loss: 1.0917 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.9375 total_loss: 0.36175  loss:0.42304,stance loss: 0.27718 
Train step: 2970 acc:0.92763 total_loss: 0.39945  loss:0.30546,stance loss: 0.25532 
Train step: 2980 acc:0.92672 total_loss: 0.44411  loss:0.79448,stance loss: 1.129 
Train step: 2990 acc:0.92628 total_loss: 0.43172  loss:0.32284,stance loss: 0.21201 
Train step: 3000 acc:0.91964 total_loss: 0.44197  loss:0.45955,stance loss: 0.37194 
Train step: 3010 acc:0.91631 total_loss: 0.46537  loss:0.43896,stance loss: 0.35479 
Train step: 3020 acc:0.9212 total_loss: 0.43211  loss:0.15031,stance loss: 0.11884 
Train step: 3030 acc:0.92168 total_loss: 0.41724  loss:0.12232,stance loss: 0.050271 
Train step: 3040 acc:0.92346 total_loss: 0.40954  loss:0.40917,stance loss: 0.35085 
Train step: 3050 acc:0.92614 total_loss: 0.3999  loss:0.28297,stance loss: 0.24497 
Train step: 3060 acc:0.92374 total_loss: 0.41161  loss:0.098734,stance loss: 0.065972 
Train step: 3070 acc:0.92174 total_loss: 0.41511  loss:0.40791,stance loss: 0.33358 
Train step: 3080 acc:0.92248 total_loss: 0.4155  loss:0.12495,stance loss: 0.10246 
Train step: 3090 acc:0.92446 total_loss: 0.41115  loss:0.059965,stance loss: 0.0063095 
Train step: 3100 acc:0.92659 total_loss: 0.4001  loss:0.25048,stance loss: 0.20604 
Train step: 3110 acc:0.92689 total_loss: 0.40229  loss:0.46087,stance loss: 0.3898 
Train step: 3120 acc:0.9253 total_loss: 0.40262  loss:0.91575,stance loss: 0.76695 
Train step: 3130 acc:0.92423 total_loss: 0.40455  loss:0.45161,stance loss: 0.33139 
Train step: 3140 acc:0.92361 total_loss: 0.40413  loss:0.10183,stance loss: 0.047896 
Train step: 3150 acc:0.92431 total_loss: 0.40354  loss:0.25765,stance loss: 0.28585 
Train step: 3160 acc:0.92464 total_loss: 0.4  loss:0.51988,stance loss: 0.35092 
Train step: 3170 acc:0.92466 total_loss: 0.39691  loss:0.13498,stance loss: 0.0070069 
Train step: 3180 acc:0.92385 total_loss: 0.39658  loss:0.32076,stance loss: 0.27472 
Train step: 3190 acc:0.92338 total_loss: 0.39617  loss:0.9001,stance loss: 0.66432 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.95833 total_loss: 0.30039  loss:0.25764,stance loss: 0.25069 
Train step: 3210 acc:0.97115 total_loss: 0.26793  loss:0.16407,stance loss: 0.063276 
Train step: 3220 acc:0.9538 total_loss: 0.32883  loss:0.1949,stance loss: 0.14662 
Train step: 3230 acc:0.95076 total_loss: 0.31353  loss:0.13884,stance loss: 0.083749 
Train step: 3240 acc:0.94913 total_loss: 0.31374  loss:0.45499,stance loss: 0.33696 
Train step: 3250 acc:0.94693 total_loss: 0.3253  loss:0.18664,stance loss: 0.15925 
Train step: 3260 acc:0.94345 total_loss: 0.32808  loss:0.064654,stance loss: 0.0095314 
Train step: 3270 acc:0.94264 total_loss: 0.33328  loss:0.66156,stance loss: 0.51445 
Train step: 3280 acc:0.94352 total_loss: 0.32978  loss:0.32668,stance loss: 0.22838 
Train step: 3290 acc:0.94489 total_loss: 0.3262  loss:0.67435,stance loss: 1.1436 
Train step: 3300 acc:0.94478 total_loss: 0.32665  loss:0.24662,stance loss: 0.21339 
Train step: 3310 acc:0.94856 total_loss: 0.32276  loss:0.68049,stance loss: 1.066 
Train step: 3320 acc:0.94766 total_loss: 0.32182  loss:0.26778,stance loss: 0.19868 
Train step: 3330 acc:0.94878 total_loss: 0.31668  loss:0.15028,stance loss: 0.043499 
Train step: 3340 acc:0.9493 total_loss: 0.3168  loss:0.23197,stance loss: 0.29668 
Train step: 3350 acc:0.9473 total_loss: 0.32441  loss:0.46104,stance loss: 0.38047 
Train step: 3360 acc:0.94632 total_loss: 0.3299  loss:0.078184,stance loss: 0.029916 
Train step: 3370 acc:0.94689 total_loss: 0.3258  loss:0.11428,stance loss: 0.058346 
Train step: 3380 acc:0.94672 total_loss: 0.32714  loss:0.62085,stance loss: 1.0115 
Train step: 3390 acc:0.94527 total_loss: 0.32643  loss:0.25822,stance loss: 0.18592 
Train step: 3400 acc:0.94612 total_loss: 0.32535  loss:0.54491,stance loss: 0.66705 
Train step: 3410 acc:0.9466 total_loss: 0.33031  loss:0.64844,stance loss: 0.62471 
Train step: 3420 acc:0.94591 total_loss: 0.32817  loss:0.22601,stance loss: 0.073938 
Train step: 3430 acc:0.94635 total_loss: 0.3272  loss:0.0311,stance loss: 0.0026156 
Train step: 3440 acc:0.94753 total_loss: 0.31983  loss:0.078702,stance loss: 0.020039 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.96429 total_loss: 0.24743  loss:0.041078,stance loss: 0.0053651 
Train step: 3460 acc:0.96691 total_loss: 0.22144  loss:0.63864,stance loss: 1.0783 
Train step: 3470 acc:0.96528 total_loss: 0.27134  loss:0.053769,stance loss: 0.040762 
Train step: 3480 acc:0.96453 total_loss: 0.24539  loss:0.11691,stance loss: 0.086119 
Train step: 3490 acc:0.9641 total_loss: 0.22895  loss:0.19846,stance loss: 0.094598 
Train step: 3500 acc:0.95833 total_loss: 0.22861  loss:0.039796,stance loss: 0.004781 
Train step: 3510 acc:0.95989 total_loss: 0.23278  loss:0.057909,stance loss: 0.0085334 
Train step: 3520 acc:0.9586 total_loss: 0.23451  loss:0.03149,stance loss: 0.0092496 
Train step: 3530 acc:0.95618 total_loss: 0.23464  loss:0.055478,stance loss: 0.034677 
Train step: 3540 acc:0.95296 total_loss: 0.23483  loss:0.041045,stance loss: 0.00071171 
Train step: 3550 acc:0.95152 total_loss: 0.24541  loss:0.38788,stance loss: 0.26099 
Train step: 3560 acc:0.95032 total_loss: 0.25252  loss:0.54742,stance loss: 0.36037 
Train step: 3570 acc:0.94931 total_loss: 0.25476  loss:0.29338,stance loss: 0.078285 
Train step: 3580 acc:0.95027 total_loss: 0.25732  loss:0.56937,stance loss: 1.02 
Train step: 3590 acc:0.95068 total_loss: 0.2542  loss:0.051402,stance loss: 0.010517 
Train step: 3600 acc:0.95223 total_loss: 0.2514  loss:0.16578,stance loss: 0.19761 
Train step: 3610 acc:0.95322 total_loss: 0.24707  loss:0.079347,stance loss: 0.04347 
Train step: 3620 acc:0.9541 total_loss: 0.24257  loss:0.040614,stance loss: 0.0038211 
Train step: 3630 acc:0.95221 total_loss: 0.24577  loss:0.40566,stance loss: 0.30767 
Train step: 3640 acc:0.95241 total_loss: 0.24789  loss:0.68444,stance loss: 1.116 
Train step: 3650 acc:0.9526 total_loss: 0.24926  loss:0.054171,stance loss: 0.011014 
Train step: 3660 acc:0.95392 total_loss: 0.24616  loss:0.11524,stance loss: 0.050869 
Train step: 3670 acc:0.95402 total_loss: 0.24809  loss:0.1677,stance loss: 0.094299 
Train step: 3680 acc:0.95464 total_loss: 0.24592  loss:0.35069,stance loss: 0.28583 
Training finished.


Reload the best model with best f1 0.4463706660014967 from path test_outputs/bert-cross-topic/la/2023-08-14 19-32-56/state_dict


              precision    recall  f1-score   support

           0   0.590909  0.812500  0.684211       544
           1   0.333333  0.211712  0.258953       222
           2   0.500000  0.131737  0.208531       167

    accuracy                       0.547696       933
   macro avg   0.474747  0.385316  0.383898       933
weighted avg   0.513349  0.547696  0.497881       933

Test Acc: 0.5476956055734191 F1_ma:0.4463706660014967
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4463706660014967
acc: 0.5476956055734191, f1 :0.3838981666823568
classification report: 
              precision    recall  f1-score   support

         Con     0.5909    0.8125    0.6842       544
        None     0.3333    0.2117    0.2590       222
         Pro     0.5000    0.1317    0.2085       167

    accuracy                         0.5477       933
   macro avg     0.4747    0.3853    0.3839       933
weighted avg     0.5133    0.5477    0.4979       933

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='la', dataset_files={'train': './datasets/o_la', 'test': './datasets/la'}, dev_dir='./datasets/la', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/la/2023-08-14 20-10-08', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/la', train_dir='./datasets/o_la', type=0)
using model:  bert-cross-topic
running dataset:  la
output_dir:  test_outputs/bert-cross-topic/la/2023-08-14 20-10-08
Train loader length: 246
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.691  loss:1.691,stance loss: 0.99565 
Train step: 10 acc:0.46023 total_loss: 1.713  loss:1.3884,stance loss: 0.82334 
Better F1! Saving model!
Saving model of best f1: 0.3685636856368564
              precision    recall  f1-score   support

           0   0.583691  1.000000  0.737127       544
           1   1.000000  0.004505  0.008969       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.584137       933
   macro avg   0.527897  0.334835  0.248699       933
weighted avg   0.578272  0.584137  0.431927       933

Test Acc: 0.5841371918542336 F1_ma:0.3685636856368564
Train step: 20 acc:0.45536 total_loss: 1.6792  loss:1.6702,stance loss: 1.1357 
Train step: 30 acc:0.47177 total_loss: 1.6651  loss:1.5363,stance loss: 1.0781 
Train step: 40 acc:0.47713 total_loss: 1.6503  loss:1.4992,stance loss: 1.1188 
Train step: 50 acc:0.49265 total_loss: 1.6328  loss:1.3099,stance loss: 0.76827 
Better F1! Saving model!
Saving model of best f1: 0.3688135593220339
              precision    recall  f1-score   support

           0   0.584318  1.000000  0.737627       544
           1   1.000000  0.009009  0.017857       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.585209       933
   macro avg   0.528106  0.336336  0.251828       933
weighted avg   0.578638  0.585209  0.434334       933

Test Acc: 0.5852090032154341 F1_ma:0.3688135593220339
Train step: 60 acc:0.48463 total_loss: 1.6346  loss:1.6476,stance loss: 1.031 
Train step: 70 acc:0.4868 total_loss: 1.6342  loss:1.8635,stance loss: 1.8059 
Better F1! Saving model!
Saving model of best f1: 0.3709016393442623
              precision    recall  f1-score   support

           0   0.590217  0.998162  0.741803       544
           1   0.846154  0.049550  0.093617       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.593783       933
   macro avg   0.478790  0.349237  0.278473       933
weighted avg   0.545471  0.593783  0.454795       933

Test Acc: 0.5937834941050375 F1_ma:0.3709016393442623
Train step: 80 acc:0.48534 total_loss: 1.6206  loss:1.543,stance loss: 1.0087 
Train step: 90 acc:0.47734 total_loss: 1.6128  loss:1.5399,stance loss: 0.86151 
Better F1! Saving model!
Saving model of best f1: 0.37140902872777015
              precision    recall  f1-score   support

           0   0.591503  0.998162  0.742818       544
           1   0.933333  0.063063  0.118143       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.596999       933
   macro avg   0.508279  0.353742  0.286987       933
weighted avg   0.566964  0.596999  0.461223       933

Test Acc: 0.5969989281886388 F1_ma:0.37140902872777015
Train step: 100 acc:0.4703 total_loss: 1.6137  loss:1.682,stance loss: 1.2058 
Better F1! Saving model!
Saving model of best f1: 0.3723331039229181
              precision    recall  f1-score   support

           0   0.595160  0.994485  0.744666       544
           1   0.833333  0.090090  0.162602       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.601286       933
   macro avg   0.476164  0.361525  0.302423       933
weighted avg   0.545302  0.601286  0.472879       933

Test Acc: 0.6012861736334405 F1_ma:0.3723331039229181
Train step: 110 acc:0.46734 total_loss: 1.6038  loss:1.5222,stance loss: 1.1042 
Better F1! Saving model!
Saving model of best f1: 0.37614678899082565
              precision    recall  f1-score   support

           0   0.610538  0.979779  0.752294       544
           1   0.766667  0.207207  0.326241       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.620579       933
   macro avg   0.459068  0.395662  0.359512       933
weighted avg   0.538406  0.620579  0.516263       933

Test Acc: 0.6205787781350482 F1_ma:0.37614678899082565
Train step: 120 acc:0.46798 total_loss: 1.6041  loss:1.6712,stance loss: 1.348 
Train step: 130 acc:0.47615 total_loss: 1.5948  loss:1.4224,stance loss: 1.0021 
Train step: 140 acc:0.47961 total_loss: 1.59  loss:1.5104,stance loss: 1.1644 
Better F1! Saving model!
Saving model of best f1: 0.37698986975397974
              precision    recall  f1-score   support

           0   0.621718  0.957721  0.753980       544
           1   0.705263  0.301802  0.422713       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.630225       933
   macro avg   0.442327  0.419841  0.392231       933
weighted avg   0.530314  0.630225  0.540201       933

Test Acc: 0.6302250803858521 F1_ma:0.37698986975397974
Train step: 150 acc:0.48551 total_loss: 1.5936  loss:1.6789,stance loss: 1.5992 
Better F1! Saving model!
Saving model of best f1: 0.37744034707158347
              precision    recall  f1-score   support

           0   0.622169  0.959559  0.754881       544
           1   0.712766  0.301802  0.424051       222
           2   0.000000  0.000000  0.000000       167

    accuracy                       0.631297       933
   macro avg   0.444978  0.420454  0.392977       933
weighted avg   0.532362  0.631297  0.541044       933

Test Acc: 0.6312968917470525 F1_ma:0.37744034707158347
Train step: 160 acc:0.48835 total_loss: 1.5898  loss:1.6392,stance loss: 1.1348 
Train step: 170 acc:0.48977 total_loss: 1.58  loss:1.5236,stance loss: 1.0922 
Train step: 180 acc:0.49137 total_loss: 1.5742  loss:1.5433,stance loss: 1.0263 
Train step: 190 acc:0.49575 total_loss: 1.5661  loss:1.4648,stance loss: 1.0563 
Train step: 200 acc:0.49938 total_loss: 1.5617  loss:1.5411,stance loss: 1.26 
Train step: 210 acc:0.50207 total_loss: 1.5627  loss:1.3684,stance loss: 0.98476 
Train step: 220 acc:0.50594 total_loss: 1.5574  loss:1.2065,stance loss: 0.88999 
Train step: 230 acc:0.50622 total_loss: 1.5504  loss:1.2638,stance loss: 0.6884 
Train step: 240 acc:0.50545 total_loss: 1.55  loss:1.6022,stance loss: 1.3224 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.5625 total_loss: 1.3735  loss:1.4248,stance loss: 1.1218 
Train step: 260 acc:0.58333 total_loss: 1.3524  loss:1.4984,stance loss: 1.4949 
Train step: 270 acc:0.6025 total_loss: 1.3561  loss:1.2478,stance loss: 0.89279 
Train step: 280 acc:0.60179 total_loss: 1.3491  loss:1.2586,stance loss: 0.85132 
Train step: 290 acc:0.60278 total_loss: 1.3487  loss:1.5255,stance loss: 1.1338 
Train step: 300 acc:0.60795 total_loss: 1.3495  loss:1.2112,stance loss: 0.87051 
Train step: 310 acc:0.61538 total_loss: 1.3618  loss:1.3476,stance loss: 0.98101 
Train step: 320 acc:0.625 total_loss: 1.3429  loss:1.4365,stance loss: 1.1587 
Train step: 330 acc:0.63162 total_loss: 1.3381  loss:1.31,stance loss: 0.8603 
Train step: 340 acc:0.63618 total_loss: 1.3313  loss:0.97271,stance loss: 0.69328 
Train step: 350 acc:0.63869 total_loss: 1.3315  loss:1.2195,stance loss: 0.86461 
Train step: 360 acc:0.63859 total_loss: 1.3319  loss:1.3737,stance loss: 0.98432 
Train step: 370 acc:0.6385 total_loss: 1.3375  loss:1.6995,stance loss: 1.6745 
Train step: 380 acc:0.64213 total_loss: 1.3363  loss:1.4277,stance loss: 1.1879 
Train step: 390 acc:0.6431 total_loss: 1.3327  loss:1.378,stance loss: 1.0347 
Train step: 400 acc:0.64516 total_loss: 1.3325  loss:0.93219,stance loss: 0.66884 
Train step: 410 acc:0.64205 total_loss: 1.3329  loss:1.3045,stance loss: 1.1056 
Train step: 420 acc:0.64214 total_loss: 1.3305  loss:1.1354,stance loss: 0.8249 
Better F1! Saving model!
Saving model of best f1: 0.38104575163398696
              precision    recall  f1-score   support

           0   0.664706  0.830882  0.738562       544
           1   0.580000  0.653153  0.614407       222
           2   0.666667  0.011976  0.023529       167

    accuracy                       0.642015       933
   macro avg   0.637124  0.498671  0.458833       933
weighted avg   0.644902  0.642015  0.581035       933

Test Acc: 0.6420150053590568 F1_ma:0.38104575163398696
Train step: 430 acc:0.64324 total_loss: 1.3249  loss:1.201,stance loss: 0.97416 
Train step: 440 acc:0.64776 total_loss: 1.3113  loss:1.0401,stance loss: 0.72663 
Better F1! Saving model!
Saving model of best f1: 0.3912406234068895
              precision    recall  f1-score   support

           0   0.682143  0.702206  0.692029       544
           1   0.516129  0.792793  0.625222       222
           2   0.281250  0.053892  0.090452       167

    accuracy                       0.607717       933
   macro avg   0.493174  0.516297  0.469234       933
weighted avg   0.570884  0.607717  0.568455       933

Test Acc: 0.6077170418006431 F1_ma:0.3912406234068895
Train step: 450 acc:0.6497 total_loss: 1.309  loss:1.4232,stance loss: 1.0712 
Train step: 460 acc:0.64971 total_loss: 1.3076  loss:1.3023,stance loss: 1.074 
Train step: 470 acc:0.65139 total_loss: 1.3064  loss:1.4419,stance loss: 1.5306 
Train step: 480 acc:0.65 total_loss: 1.3048  loss:1.1646,stance loss: 0.86983 
Train step: 490 acc:0.6477 total_loss: 1.3074  loss:1.4408,stance loss: 1.0971 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 500 acc:0.68056 total_loss: 1.2617  loss:1.1333,stance loss: 0.9433 
Train step: 510 acc:0.65461 total_loss: 1.2186  loss:0.92682,stance loss: 0.67951 
Train step: 520 acc:0.67241 total_loss: 1.179  loss:0.85269,stance loss: 0.6096 
Train step: 530 acc:0.67628 total_loss: 1.1754  loss:0.85386,stance loss: 0.58699 
Train step: 540 acc:0.67474 total_loss: 1.1824  loss:0.99438,stance loss: 0.76853 
Better F1! Saving model!
Saving model of best f1: 0.41131907308377896
              precision    recall  f1-score   support

           0   0.666090  0.707721  0.686275       544
           1   0.519868  0.707207  0.599237       222
           2   0.283019  0.089820  0.136364       167

    accuracy                       0.596999       933
   macro avg   0.489659  0.501583  0.473958       933
weighted avg   0.562731  0.596999  0.567135       933

Test Acc: 0.5969989281886388 F1_ma:0.41131907308377896
Train step: 550 acc:0.67479 total_loss: 1.1933  loss:1.2188,stance loss: 0.88992 
Better F1! Saving model!
Saving model of best f1: 0.4193899389938993
              precision    recall  f1-score   support

           0   0.673721  0.702206  0.687669       544
           1   0.525974  0.729730  0.611321       222
           2   0.293103  0.101796  0.151111       167

    accuracy                       0.601286       933
   macro avg   0.497600  0.511244  0.483367       933
weighted avg   0.570438  0.601286  0.573463       933

Test Acc: 0.6012861736334405 F1_ma:0.4193899389938993
Train step: 560 acc:0.67572 total_loss: 1.1957  loss:1.1875,stance loss: 0.96426 
Train step: 570 acc:0.68908 total_loss: 1.1792  loss:0.75517,stance loss: 0.44493 
Train step: 580 acc:0.6882 total_loss: 1.1823  loss:1.1429,stance loss: 0.96088 
Train step: 590 acc:0.68182 total_loss: 1.2017  loss:1.4286,stance loss: 1.2907 
Train step: 600 acc:0.68062 total_loss: 1.201  loss:0.84989,stance loss: 0.64524 
Train step: 610 acc:0.67962 total_loss: 1.2018  loss:1.2234,stance loss: 0.87093 
Train step: 620 acc:0.68217 total_loss: 1.1981  loss:0.76162,stance loss: 0.33321 
Train step: 630 acc:0.68165 total_loss: 1.194  loss:1.4236,stance loss: 1.1364 
Train step: 640 acc:0.68247 total_loss: 1.1917  loss:1.1753,stance loss: 0.88558 
Train step: 650 acc:0.68711 total_loss: 1.1787  loss:0.88463,stance loss: 0.72399 
Train step: 660 acc:0.68935 total_loss: 1.1765  loss:1.255,stance loss: 1.4631 
Train step: 670 acc:0.68925 total_loss: 1.1763  loss:1.4851,stance loss: 1.2135 
Train step: 680 acc:0.68651 total_loss: 1.1814  loss:1.3456,stance loss: 1.2972 
Train step: 690 acc:0.68405 total_loss: 1.1895  loss:1.3284,stance loss: 1.0097 
Better F1! Saving model!
Saving model of best f1: 0.4194461581325002
              precision    recall  f1-score   support

           0   0.676829  0.408088  0.509174       544
           1   0.514469  0.720721  0.600375       222
           2   0.258503  0.455090  0.329718       167

    accuracy                       0.490890       933
   macro avg   0.483267  0.527966  0.479756       933
weighted avg   0.563320  0.490890  0.498754       933

Test Acc: 0.4908896034297964 F1_ma:0.4194461581325002
Train step: 700 acc:0.68481 total_loss: 1.1853  loss:1.2213,stance loss: 0.9504 
Train step: 710 acc:0.68436 total_loss: 1.182  loss:1.3074,stance loss: 1.1455 
Better F1! Saving model!
Saving model of best f1: 0.42623357939267303
              precision    recall  f1-score   support

           0   0.685629  0.420956  0.521640       544
           1   0.495913  0.819820  0.617997       222
           2   0.284483  0.395210  0.330827       167

    accuracy                       0.511254       933
   macro avg   0.488675  0.545328  0.490155       933
weighted avg   0.568685  0.511254  0.510413       933

Test Acc: 0.5112540192926045 F1_ma:0.42623357939267303
Train step: 720 acc:0.6845 total_loss: 1.1862  loss:0.68235,stance loss: 0.49481 
Better F1! Saving model!
Saving model of best f1: 0.42993227004588164
              precision    recall  f1-score   support

           0   0.660754  0.547794  0.598995       544
           1   0.529605  0.725225  0.612167       222
           2   0.252809  0.269461  0.260870       167

    accuracy                       0.540193       933
   macro avg   0.481056  0.514160  0.490677       933
weighted avg   0.556529  0.540193  0.541607       933

Test Acc: 0.5401929260450161 F1_ma:0.42993227004588164
Train step: 730 acc:0.68488 total_loss: 1.185  loss:1.1552,stance loss: 0.85211 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.66667 total_loss: 1.0756  loss:1.1685,stance loss: 0.92788 
Train step: 750 acc:0.64904 total_loss: 1.1269  loss:1.2426,stance loss: 1.0441 
Better F1! Saving model!
Saving model of best f1: 0.4328121907777558
              precision    recall  f1-score   support

           0   0.719557  0.358456  0.478528       544
           1   0.505495  0.828829  0.627986       222
           2   0.302013  0.538922  0.387097       167

    accuracy                       0.502680       933
   macro avg   0.509022  0.575402  0.497870       933
weighted avg   0.593885  0.502680  0.497725       933

Test Acc: 0.5026795284030011 F1_ma:0.4328121907777558
Train step: 760 acc:0.67663 total_loss: 1.0943  loss:0.81405,stance loss: 0.65226 
Train step: 770 acc:0.68561 total_loss: 1.0817  loss:1.151,stance loss: 0.95915 
Better F1! Saving model!
Saving model of best f1: 0.4351876749814143
              precision    recall  f1-score   support

           0   0.681265  0.514706  0.586387       544
           1   0.502793  0.810811  0.620690       222
           2   0.286585  0.281437  0.283988       167

    accuracy                       0.543408       933
   macro avg   0.490215  0.535651  0.497022       933
weighted avg   0.568154  0.543408  0.540422       933

Test Acc: 0.5434083601286174 F1_ma:0.4351876749814143
Train step: 780 acc:0.69477 total_loss: 1.0716  loss:0.93886,stance loss: 0.73703 
Train step: 790 acc:0.69575 total_loss: 1.0746  loss:1.0645,stance loss: 0.7616 
Train step: 800 acc:0.69643 total_loss: 1.0895  loss:1.2763,stance loss: 1.09 
Train step: 810 acc:0.70034 total_loss: 1.0843  loss:0.91745,stance loss: 0.76148 
Better F1! Saving model!
Saving model of best f1: 0.44019891644977954
              precision    recall  f1-score   support

           0   0.655303  0.636029  0.645522       544
           1   0.532646  0.698198  0.604288       222
           2   0.289474  0.197605  0.234875       167

    accuracy                       0.572347       933
   macro avg   0.492474  0.510611  0.494895       933
weighted avg   0.560637  0.572347  0.562208       933

Test Acc: 0.572347266881029 F1_ma:0.44019891644977954
Train step: 820 acc:0.6988 total_loss: 1.0908  loss:1.0396,stance loss: 0.80825 
Train step: 830 acc:0.69288 total_loss: 1.0928  loss:1.3107,stance loss: 0.92629 
Better F1! Saving model!
Saving model of best f1: 0.45174759028104194
              precision    recall  f1-score   support

           0   0.679487  0.487132  0.567452       544
           1   0.507331  0.779279  0.614565       222
           2   0.306931  0.371257  0.336043       167

    accuracy                       0.535906       933
   macro avg   0.497916  0.545890  0.506020       933
weighted avg   0.571839  0.535906  0.537242       933

Test Acc: 0.5359056806002144 F1_ma:0.45174759028104194
Train step: 840 acc:0.69053 total_loss: 1.0916  loss:1.4246,stance loss: 1.159 
Better F1! Saving model!
Saving model of best f1: 0.4666853714223937
              precision    recall  f1-score   support

           0   0.707246  0.448529  0.548931       544
           1   0.525157  0.752252  0.618519       222
           2   0.311111  0.502994  0.384439       167

    accuracy                       0.530547       933
   macro avg   0.514505  0.567925  0.517296       933
weighted avg   0.593014  0.530547  0.536046       933

Test Acc: 0.5305466237942122 F1_ma:0.4666853714223937
Train step: 850 acc:0.69192 total_loss: 1.0859  loss:0.72662,stance loss: 0.49419 
Train step: 860 acc:0.69563 total_loss: 1.0846  loss:0.78545,stance loss: 0.63554 
Train step: 870 acc:0.69643 total_loss: 1.0852  loss:1.5035,stance loss: 1.1822 
Train step: 880 acc:0.69537 total_loss: 1.0861  loss:0.92131,stance loss: 0.70297 
Train step: 890 acc:0.69526 total_loss: 1.0925  loss:1.2487,stance loss: 1.0002 
Train step: 900 acc:0.6944 total_loss: 1.0981  loss:1.1647,stance loss: 0.86245 
Train step: 910 acc:0.69364 total_loss: 1.1049  loss:1.4884,stance loss: 1.1288 
Train step: 920 acc:0.69331 total_loss: 1.1001  loss:1.0572,stance loss: 0.78351 
Train step: 930 acc:0.69365 total_loss: 1.099  loss:1.1758,stance loss: 0.84008 
Train step: 940 acc:0.69304 total_loss: 1.1002  loss:1.0978,stance loss: 0.97377 
Train step: 950 acc:0.6919 total_loss: 1.1003  loss:0.79779,stance loss: 0.55503 
Train step: 960 acc:0.69507 total_loss: 1.1034  loss:1.5643,stance loss: 1.2183 
Train step: 970 acc:0.69662 total_loss: 1.1045  loss:1.3387,stance loss: 1.0879 
Train step: 980 acc:0.69907 total_loss: 1.0997  loss:0.65797,stance loss: 0.46025 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 990 acc:0.73214 total_loss: 0.96378  loss:0.76686,stance loss: 0.62868 
Train step: 1000 acc:0.69118 total_loss: 1.0869  loss:1.3123,stance loss: 1.139 
Train step: 1010 acc:0.7338 total_loss: 1.0128  loss:0.69512,stance loss: 0.55585 
Train step: 1020 acc:0.7348 total_loss: 1.0189  loss:1.3247,stance loss: 1.2377 
Train step: 1030 acc:0.72606 total_loss: 1.0283  loss:1.1909,stance loss: 0.82804 
Train step: 1040 acc:0.71711 total_loss: 1.0372  loss:0.86871,stance loss: 0.76841 
Train step: 1050 acc:0.73041 total_loss: 1.0157  loss:1.1388,stance loss: 0.80553 
Train step: 1060 acc:0.73295 total_loss: 1.0052  loss:0.97458,stance loss: 0.72027 
Train step: 1070 acc:0.73276 total_loss: 1.0101  loss:1.1209,stance loss: 0.98147 
Train step: 1080 acc:0.72874 total_loss: 1.0226  loss:0.87341,stance loss: 0.5491 
Train step: 1090 acc:0.73481 total_loss: 1.0144  loss:0.86939,stance loss: 0.74371 
Train step: 1100 acc:0.72917 total_loss: 1.023  loss:1.2161,stance loss: 1.0195 
Train step: 1110 acc:0.72638 total_loss: 1.0371  loss:1.0254,stance loss: 0.91696 
Train step: 1120 acc:0.72582 total_loss: 1.0421  loss:0.75741,stance loss: 0.6503 
Train step: 1130 acc:0.72534 total_loss: 1.0417  loss:1.1292,stance loss: 1.0216 
Train step: 1140 acc:0.72611 total_loss: 1.0332  loss:0.92048,stance loss: 0.60217 
Train step: 1150 acc:0.72754 total_loss: 1.0243  loss:0.91324,stance loss: 0.79578 
Train step: 1160 acc:0.72599 total_loss: 1.0321  loss:1.9698,stance loss: 1.7506 
Train step: 1170 acc:0.7256 total_loss: 1.0296  loss:0.95397,stance loss: 0.74492 
Train step: 1180 acc:0.72589 total_loss: 1.0247  loss:0.78481,stance loss: 0.61932 
Train step: 1190 acc:0.72554 total_loss: 1.0259  loss:1.4681,stance loss: 1.2787 
Train step: 1200 acc:0.72696 total_loss: 1.0214  loss:1.0077,stance loss: 0.78757 
Train step: 1210 acc:0.72715 total_loss: 1.0215  loss:1.3096,stance loss: 1.1138 
Better F1! Saving model!
Saving model of best f1: 0.48273590085496904
              precision    recall  f1-score   support

           0   0.678643  0.625000  0.650718       544
           1   0.544218  0.720721  0.620155       222
           2   0.347826  0.287425  0.314754       167

    accuracy                       0.587353       933
   macro avg   0.523562  0.544382  0.528542       933
weighted avg   0.587444  0.587353  0.583311       933

Test Acc: 0.587352625937835 F1_ma:0.48273590085496904
Train step: 1220 acc:0.72917 total_loss: 1.0139  loss:0.7887,stance loss: 0.55741 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.875 total_loss: 0.70927  loss:0.70927,stance loss: 0.55746 
Train step: 1240 acc:0.76136 total_loss: 0.87694  loss:1.0501,stance loss: 0.83945 
Train step: 1250 acc:0.77679 total_loss: 0.8891  loss:1.4787,stance loss: 1.7066 
Train step: 1260 acc:0.76815 total_loss: 0.90829  loss:0.73337,stance loss: 0.54801 
Train step: 1270 acc:0.75 total_loss: 0.92663  loss:1.3506,stance loss: 1.468 
Train step: 1280 acc:0.75368 total_loss: 0.95149  loss:1.0813,stance loss: 0.84717 
Train step: 1290 acc:0.75615 total_loss: 0.93682  loss:0.95372,stance loss: 0.77948 
Train step: 1300 acc:0.74912 total_loss: 0.9391  loss:1.1478,stance loss: 0.85592 
Train step: 1310 acc:0.7446 total_loss: 0.94103  loss:0.97083,stance loss: 0.81571 
Train step: 1320 acc:0.74382 total_loss: 0.9537  loss:1.3287,stance loss: 1.5133 
Train step: 1330 acc:0.74505 total_loss: 0.94428  loss:1.046,stance loss: 0.86963 
Train step: 1340 acc:0.74718 total_loss: 0.93657  loss:0.66315,stance loss: 0.55341 
Train step: 1350 acc:0.75052 total_loss: 0.93258  loss:0.91536,stance loss: 0.60297 
Train step: 1360 acc:0.74952 total_loss: 0.93499  loss:1.0427,stance loss: 0.74759 
Train step: 1370 acc:0.7469 total_loss: 0.9408  loss:0.65488,stance loss: 0.39565 
Train step: 1380 acc:0.75083 total_loss: 0.92869  loss:0.59808,stance loss: 0.4957 
Train step: 1390 acc:0.75155 total_loss: 0.92648  loss:1.1979,stance loss: 1.0178 
Train step: 1400 acc:0.75183 total_loss: 0.9193  loss:0.65675,stance loss: 0.38854 
Train step: 1410 acc:0.75104 total_loss: 0.92136  loss:0.47359,stance loss: 0.34638 
Train step: 1420 acc:0.75393 total_loss: 0.92021  loss:0.78648,stance loss: 0.65431 
Train step: 1430 acc:0.75124 total_loss: 0.9256  loss:1.0111,stance loss: 0.76017 
Train step: 1440 acc:0.75148 total_loss: 0.9277  loss:0.90733,stance loss: 0.59336 
Train step: 1450 acc:0.75339 total_loss: 0.92515  loss:0.62774,stance loss: 0.4747 
Train step: 1460 acc:0.7546 total_loss: 0.92355  loss:0.84189,stance loss: 0.72364 
Train step: 1470 acc:0.75571 total_loss: 0.91528  loss:0.557,stance loss: 0.38635 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1480 acc:0.7875 total_loss: 0.86614  loss:0.81503,stance loss: 0.62882 
Train step: 1490 acc:0.7875 total_loss: 0.91946  loss:0.98576,stance loss: 1.1132 
Train step: 1500 acc:0.79 total_loss: 0.89541  loss:0.39592,stance loss: 0.29745 
Train step: 1510 acc:0.80357 total_loss: 0.86205  loss:0.77084,stance loss: 0.57335 
Train step: 1520 acc:0.80417 total_loss: 0.85094  loss:1.0693,stance loss: 0.74639 
Train step: 1530 acc:0.79773 total_loss: 0.85823  loss:0.74663,stance loss: 0.60548 
Train step: 1540 acc:0.79038 total_loss: 0.88106  loss:0.71577,stance loss: 0.50753 
Train step: 1550 acc:0.7925 total_loss: 0.87859  loss:0.70013,stance loss: 0.60377 
Train step: 1560 acc:0.78456 total_loss: 0.88711  loss:0.95825,stance loss: 0.75461 
Train step: 1570 acc:0.78355 total_loss: 0.87946  loss:0.66841,stance loss: 0.51061 
Train step: 1580 acc:0.78452 total_loss: 0.87594  loss:1.0661,stance loss: 0.91894 
Train step: 1590 acc:0.78315 total_loss: 0.87191  loss:0.70035,stance loss: 0.52294 
Train step: 1600 acc:0.787 total_loss: 0.87151  loss:1.039,stance loss: 0.97615 
Train step: 1610 acc:0.78519 total_loss: 0.86573  loss:0.95352,stance loss: 0.66875 
Train step: 1620 acc:0.78578 total_loss: 0.85879  loss:0.60162,stance loss: 0.36157 
Train step: 1630 acc:0.7875 total_loss: 0.84566  loss:0.70164,stance loss: 0.47447 
Train step: 1640 acc:0.78788 total_loss: 0.83517  loss:0.68636,stance loss: 0.57941 
Train step: 1650 acc:0.78929 total_loss: 0.83447  loss:1.0103,stance loss: 0.85437 
Train step: 1660 acc:0.78818 total_loss: 0.82493  loss:0.58401,stance loss: 0.42886 
Train step: 1670 acc:0.7891 total_loss: 0.82445  loss:0.43754,stance loss: 0.35892 
Train step: 1680 acc:0.79238 total_loss: 0.82258  loss:0.67137,stance loss: 0.51064 
Train step: 1690 acc:0.79419 total_loss: 0.82112  loss:1.1441,stance loss: 0.80491 
Train step: 1700 acc:0.79528 total_loss: 0.81751  loss:0.5131,stance loss: 0.44169 
Train step: 1710 acc:0.79468 total_loss: 0.81782  loss:0.73821,stance loss: 0.56615 
Train step: 1720 acc:0.79566 total_loss: 0.81706  loss:0.54847,stance loss: 0.41843 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1730 acc:0.79861 total_loss: 0.79052  loss:0.53067,stance loss: 0.34728 
Train step: 1740 acc:0.82895 total_loss: 0.71513  loss:0.55795,stance loss: 0.46555 
Train step: 1750 acc:0.84052 total_loss: 0.66526  loss:0.50107,stance loss: 0.42432 
Train step: 1760 acc:0.84135 total_loss: 0.73145  loss:0.68543,stance loss: 0.58755 
Train step: 1770 acc:0.83546 total_loss: 0.72556  loss:0.57407,stance loss: 0.51738 
Train step: 1780 acc:0.83792 total_loss: 0.7165  loss:0.57821,stance loss: 0.43403 
Train step: 1790 acc:0.83696 total_loss: 0.71602  loss:0.5889,stance loss: 0.48075 
Train step: 1800 acc:0.83782 total_loss: 0.7027  loss:0.61082,stance loss: 0.37658 
Train step: 1810 acc:0.83146 total_loss: 0.71178  loss:1.198,stance loss: 1.0948 
Train step: 1820 acc:0.8327 total_loss: 0.7086  loss:0.86433,stance loss: 0.60057 
Train step: 1830 acc:0.83142 total_loss: 0.71811  loss:0.27508,stance loss: 0.14057 
Train step: 1840 acc:0.83141 total_loss: 0.7226  loss:0.33899,stance loss: 0.25171 
Train step: 1850 acc:0.8343 total_loss: 0.71512  loss:1.1238,stance loss: 0.97901 
Train step: 1860 acc:0.83453 total_loss: 0.70944  loss:0.78721,stance loss: 0.68054 
Train step: 1870 acc:0.83473 total_loss: 0.7046  loss:0.81867,stance loss: 0.61694 
Train step: 1880 acc:0.83608 total_loss: 0.69752  loss:0.84149,stance loss: 0.81175 
Train step: 1890 acc:0.83469 total_loss: 0.7008  loss:0.26845,stance loss: 0.11802 
Train step: 1900 acc:0.8331 total_loss: 0.7069  loss:0.64784,stance loss: 0.46139 
Train step: 1910 acc:0.83433 total_loss: 0.70792  loss:1.2438,stance loss: 1.1816 
Train step: 1920 acc:0.83543 total_loss: 0.70568  loss:0.6004,stance loss: 0.4459 
Train step: 1930 acc:0.83194 total_loss: 0.70886  loss:0.76676,stance loss: 0.64198 
Train step: 1940 acc:0.83076 total_loss: 0.71008  loss:0.67556,stance loss: 0.55114 
Train step: 1950 acc:0.83133 total_loss: 0.70759  loss:0.44346,stance loss: 0.3628 
Train step: 1960 acc:0.83159 total_loss: 0.71254  loss:0.69749,stance loss: 0.63804 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1970 acc:0.875 total_loss: 0.54388  loss:0.51095,stance loss: 0.39657 
Train step: 1980 acc:0.82212 total_loss: 0.75003  loss:0.94464,stance loss: 0.68863 
Train step: 1990 acc:0.84239 total_loss: 0.64487  loss:0.43874,stance loss: 0.33176 
Train step: 2000 acc:0.84659 total_loss: 0.63654  loss:1.2596,stance loss: 1.0671 
Train step: 2010 acc:0.85029 total_loss: 0.63888  loss:0.4568,stance loss: 0.32134 
Train step: 2020 acc:0.85495 total_loss: 0.62398  loss:0.42208,stance loss: 0.32706 
Train step: 2030 acc:0.85714 total_loss: 0.61063  loss:0.84685,stance loss: 1.2089 
Train step: 2040 acc:0.86045 total_loss: 0.59924  loss:0.34207,stance loss: 0.19801 
Train step: 2050 acc:0.86747 total_loss: 0.58875  loss:0.41286,stance loss: 0.41719 
Train step: 2060 acc:0.87164 total_loss: 0.58807  loss:0.71637,stance loss: 1.0914 
Train step: 2070 acc:0.87197 total_loss: 0.58344  loss:0.64459,stance loss: 0.43846 
Train step: 2080 acc:0.87389 total_loss: 0.586  loss:0.60937,stance loss: 0.51373 
Train step: 2090 acc:0.86839 total_loss: 0.59555  loss:0.66489,stance loss: 0.44167 
Train step: 2100 acc:0.8656 total_loss: 0.59904  loss:0.79267,stance loss: 0.72424 
Train step: 2110 acc:0.86407 total_loss: 0.59781  loss:0.32267,stance loss: 0.20305 
Train step: 2120 acc:0.86275 total_loss: 0.60275  loss:0.91074,stance loss: 0.6851 
Train step: 2130 acc:0.86196 total_loss: 0.60372  loss:0.60839,stance loss: 0.50626 
Train step: 2140 acc:0.86091 total_loss: 0.60935  loss:1.0533,stance loss: 0.91723 
Train step: 2150 acc:0.86236 total_loss: 0.60274  loss:0.41239,stance loss: 0.31452 
Train step: 2160 acc:0.86172 total_loss: 0.60364  loss:0.88387,stance loss: 0.52312 
Train step: 2170 acc:0.86022 total_loss: 0.60418  loss:0.50257,stance loss: 0.37523 
Train step: 2180 acc:0.86209 total_loss: 0.60485  loss:0.94399,stance loss: 1.3188 
Train step: 2190 acc:0.86295 total_loss: 0.60118  loss:0.36454,stance loss: 0.24955 
Train step: 2200 acc:0.86105 total_loss: 0.60444  loss:0.67051,stance loss: 0.53057 
Train step: 2210 acc:0.8606 total_loss: 0.60292  loss:0.23373,stance loss: 0.10926 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2220 acc:0.90179 total_loss: 0.49858  loss:0.48503,stance loss: 0.24556 
Train step: 2230 acc:0.89706 total_loss: 0.50189  loss:1.0298,stance loss: 0.90571 
Train step: 2240 acc:0.89352 total_loss: 0.53211  loss:0.36266,stance loss: 0.26731 
Train step: 2250 acc:0.88514 total_loss: 0.52133  loss:0.90575,stance loss: 0.76116 
Train step: 2260 acc:0.875 total_loss: 0.54136  loss:0.51793,stance loss: 0.41219 
Train step: 2270 acc:0.87939 total_loss: 0.5425  loss:1.0124,stance loss: 1.3505 
Train step: 2280 acc:0.88526 total_loss: 0.52494  loss:0.86354,stance loss: 0.57608 
Train step: 2290 acc:0.88312 total_loss: 0.53294  loss:0.33289,stance loss: 0.2758 
Train step: 2300 acc:0.8829 total_loss: 0.53349  loss:0.32505,stance loss: 0.20757 
Train step: 2310 acc:0.8808 total_loss: 0.54427  loss:0.68323,stance loss: 0.53438 
Train step: 2320 acc:0.87909 total_loss: 0.54868  loss:0.50152,stance loss: 0.43975 
Train step: 2330 acc:0.8766 total_loss: 0.55112  loss:0.55773,stance loss: 0.26917 
Train step: 2340 acc:0.875 total_loss: 0.55364  loss:0.20405,stance loss: 0.1466 
Train step: 2350 acc:0.87911 total_loss: 0.54743  loss:0.41116,stance loss: 0.32107 
Train step: 2360 acc:0.87968 total_loss: 0.54488  loss:1.0283,stance loss: 1.4121 
Train step: 2370 acc:0.87739 total_loss: 0.54551  loss:0.71775,stance loss: 0.3512 
Train step: 2380 acc:0.87725 total_loss: 0.54561  loss:0.42028,stance loss: 0.38657 
Train step: 2390 acc:0.87747 total_loss: 0.54054  loss:0.37756,stance loss: 0.32142 
Train step: 2400 acc:0.87533 total_loss: 0.5426  loss:0.72008,stance loss: 0.47508 
Train step: 2410 acc:0.87849 total_loss: 0.53998  loss:0.38809,stance loss: 0.30089 
Train step: 2420 acc:0.8753 total_loss: 0.54772  loss:1.4369,stance loss: 1.327 
Train step: 2430 acc:0.875 total_loss: 0.54402  loss:0.29617,stance loss: 0.23081 
Train step: 2440 acc:0.87555 total_loss: 0.54418  loss:0.95389,stance loss: 1.3442 
Train step: 2450 acc:0.87526 total_loss: 0.55638  loss:1.6313,stance loss: 1.9142 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2460 acc:0.9375 total_loss: 0.45912  loss:0.45912,stance loss: 0.41453 
Train step: 2470 acc:0.91477 total_loss: 0.47502  loss:0.47471,stance loss: 0.38956 
Train step: 2480 acc:0.90179 total_loss: 0.49317  loss:0.27651,stance loss: 0.21596 
Train step: 2490 acc:0.91935 total_loss: 0.42117  loss:0.37433,stance loss: 0.31399 
Train step: 2500 acc:0.92378 total_loss: 0.39952  loss:0.13905,stance loss: 0.085066 
Train step: 2510 acc:0.92402 total_loss: 0.39913  loss:0.52858,stance loss: 0.27855 
Train step: 2520 acc:0.91906 total_loss: 0.41434  loss:0.7843,stance loss: 0.69178 
Train step: 2530 acc:0.91989 total_loss: 0.40941  loss:0.38323,stance loss: 0.29221 
Train step: 2540 acc:0.91975 total_loss: 0.4047  loss:0.6052,stance loss: 0.44527 
Train step: 2550 acc:0.9217 total_loss: 0.39801  loss:0.39802,stance loss: 0.096568 
Train step: 2560 acc:0.92079 total_loss: 0.41504  loss:0.42627,stance loss: 0.29002 
Train step: 2570 acc:0.92005 total_loss: 0.42251  loss:0.40621,stance loss: 0.31849 
Train step: 2580 acc:0.91787 total_loss: 0.42917  loss:0.40839,stance loss: 0.27738 
Train step: 2590 acc:0.91555 total_loss: 0.42875  loss:0.82037,stance loss: 0.50834 
Train step: 2600 acc:0.91268 total_loss: 0.43365  loss:0.2092,stance loss: 0.16887 
Train step: 2610 acc:0.91267 total_loss: 0.43033  loss:0.48463,stance loss: 0.38484 
Train step: 2620 acc:0.91188 total_loss: 0.4337  loss:0.55899,stance loss: 0.52111 
Train step: 2630 acc:0.91301 total_loss: 0.43569  loss:0.72903,stance loss: 1.0733 
Train step: 2640 acc:0.91402 total_loss: 0.43438  loss:0.54068,stance loss: 0.42434 
Train step: 2650 acc:0.91263 total_loss: 0.43788  loss:0.95556,stance loss: 0.58844 
Train step: 2660 acc:0.91014 total_loss: 0.44369  loss:0.65165,stance loss: 0.47448 
Train step: 2670 acc:0.91114 total_loss: 0.43825  loss:0.8657,stance loss: 1.2503 
Train step: 2680 acc:0.91176 total_loss: 0.43385  loss:0.66648,stance loss: 0.66909 
Train step: 2690 acc:0.91234 total_loss: 0.43005  loss:0.47151,stance loss: 0.3148 
Train step: 2700 acc:0.91105 total_loss: 0.43756  loss:0.15371,stance loss: 0.095807 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2710 acc:0.9625 total_loss: 0.29427  loss:0.13651,stance loss: 0.076092 
Train step: 2720 acc:0.9375 total_loss: 0.4276  loss:0.47215,stance loss: 0.27794 
Train step: 2730 acc:0.935 total_loss: 0.44143  loss:1.1294,stance loss: 1.39 
Train step: 2740 acc:0.93393 total_loss: 0.4239  loss:0.2999,stance loss: 0.1346 
Train step: 2750 acc:0.9375 total_loss: 0.3878  loss:0.24141,stance loss: 0.07875 
Train step: 2760 acc:0.92955 total_loss: 0.40316  loss:0.33949,stance loss: 0.27601 
Train step: 2770 acc:0.93269 total_loss: 0.4097  loss:0.35253,stance loss: 0.22525 
Train step: 2780 acc:0.93583 total_loss: 0.39057  loss:0.13951,stance loss: 0.060235 
Train step: 2790 acc:0.93456 total_loss: 0.38761  loss:0.42498,stance loss: 0.46229 
Train step: 2800 acc:0.9375 total_loss: 0.37862  loss:0.12285,stance loss: 0.035684 
Train step: 2810 acc:0.9375 total_loss: 0.37421  loss:0.4597,stance loss: 0.3611 
Train step: 2820 acc:0.93587 total_loss: 0.37992  loss:0.35489,stance loss: 0.39482 
Train step: 2830 acc:0.9345 total_loss: 0.38475  loss:0.46747,stance loss: 0.33577 
Train step: 2840 acc:0.93194 total_loss: 0.38475  loss:0.33516,stance loss: 0.33967 
Train step: 2850 acc:0.9319 total_loss: 0.38795  loss:0.50001,stance loss: 0.37447 
Train step: 2860 acc:0.93065 total_loss: 0.39002  loss:0.10466,stance loss: 0.0067252 
Train step: 2870 acc:0.93068 total_loss: 0.39253  loss:0.70611,stance loss: 0.69247 
Train step: 2880 acc:0.92929 total_loss: 0.39979  loss:1.3962,stance loss: 1.6236 
Train step: 2890 acc:0.93041 total_loss: 0.39956  loss:0.65974,stance loss: 1.0571 
Train step: 2900 acc:0.92981 total_loss: 0.402  loss:0.14069,stance loss: 0.089523 
Train step: 2910 acc:0.92988 total_loss: 0.39896  loss:0.081346,stance loss: 0.011244 
Train step: 2920 acc:0.9282 total_loss: 0.40568  loss:0.61082,stance loss: 0.41351 
Train step: 2930 acc:0.92639 total_loss: 0.40724  loss:0.31535,stance loss: 0.27046 
Train step: 2940 acc:0.92739 total_loss: 0.40333  loss:0.19646,stance loss: 0.11644 
Train step: 2950 acc:0.92806 total_loss: 0.39791  loss:0.44777,stance loss: 0.32888 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2960 acc:0.9375 total_loss: 0.27037  loss:0.33441,stance loss: 0.20377 
Train step: 2970 acc:0.94408 total_loss: 0.31397  loss:0.8378,stance loss: 1.0755 
Train step: 2980 acc:0.94181 total_loss: 0.30125  loss:0.41152,stance loss: 0.42358 
Train step: 2990 acc:0.94551 total_loss: 0.29903  loss:0.85134,stance loss: 1.244 
Train step: 3000 acc:0.94133 total_loss: 0.31548  loss:0.43209,stance loss: 0.38682 
Train step: 3010 acc:0.93962 total_loss: 0.33525  loss:0.29622,stance loss: 0.20942 
Train step: 3020 acc:0.93659 total_loss: 0.34765  loss:0.52451,stance loss: 0.5069 
Train step: 3030 acc:0.93829 total_loss: 0.34693  loss:0.66907,stance loss: 0.58815 
Train step: 3040 acc:0.9382 total_loss: 0.34893  loss:0.98256,stance loss: 0.88996 
Train step: 3050 acc:0.9375 total_loss: 0.34641  loss:0.37145,stance loss: 0.27961 
Train step: 3060 acc:0.94094 total_loss: 0.33502  loss:0.049932,stance loss: 0.0034913 
Train step: 3070 acc:0.94065 total_loss: 0.33643  loss:0.28739,stance loss: 0.22889 
Train step: 3080 acc:0.94089 total_loss: 0.33017  loss:0.13109,stance loss: 0.075396 
Train step: 3090 acc:0.93975 total_loss: 0.33438  loss:0.52695,stance loss: 0.34844 
Train step: 3100 acc:0.93834 total_loss: 0.33095  loss:0.40348,stance loss: 0.31853 
Train step: 3110 acc:0.93868 total_loss: 0.32808  loss:0.10858,stance loss: 0.053288 
Train step: 3120 acc:0.93861 total_loss: 0.3301  loss:0.10447,stance loss: 0.036311 
Train step: 3130 acc:0.9389 total_loss: 0.32893  loss:0.27606,stance loss: 0.17075 
Train step: 3140 acc:0.93849 total_loss: 0.32851  loss:0.11126,stance loss: 0.075342 
Train step: 3150 acc:0.9375 total_loss: 0.32903  loss:0.44855,stance loss: 0.38246 
Train step: 3160 acc:0.9366 total_loss: 0.32951  loss:0.20181,stance loss: 0.15025 
Train step: 3170 acc:0.9355 total_loss: 0.33099  loss:0.46226,stance loss: 0.4433 
Train step: 3180 acc:0.93614 total_loss: 0.33538  loss:0.38003,stance loss: 0.45766 
Train step: 3190 acc:0.93488 total_loss: 0.33873  loss:0.26834,stance loss: 0.1914 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3200 acc:0.91667 total_loss: 0.41635  loss:0.37307,stance loss: 0.37663 
Train step: 3210 acc:0.95192 total_loss: 0.34659  loss:0.26967,stance loss: 0.20077 
Train step: 3220 acc:0.9538 total_loss: 0.32775  loss:0.13461,stance loss: 0.024458 
Train step: 3230 acc:0.94886 total_loss: 0.35053  loss:0.26792,stance loss: 0.22639 
Train step: 3240 acc:0.94913 total_loss: 0.34487  loss:0.071924,stance loss: 0.024637 
Train step: 3250 acc:0.95047 total_loss: 0.32656  loss:0.12982,stance loss: 0.066352 
Train step: 3260 acc:0.94742 total_loss: 0.32735  loss:0.26183,stance loss: 0.15973 
Train step: 3270 acc:0.95034 total_loss: 0.32007  loss:0.39398,stance loss: 0.4089 
Train step: 3280 acc:0.95181 total_loss: 0.30885  loss:0.1429,stance loss: 0.13312 
Train step: 3290 acc:0.95094 total_loss: 0.30565  loss:0.27041,stance loss: 0.21925 
Train step: 3300 acc:0.95388 total_loss: 0.29113  loss:0.13842,stance loss: 0.076507 
Train step: 3310 acc:0.95409 total_loss: 0.29585  loss:0.23379,stance loss: 0.19613 
Train step: 3320 acc:0.95427 total_loss: 0.29261  loss:0.039466,stance loss: 0.0072431 
Train step: 3330 acc:0.95442 total_loss: 0.28582  loss:0.2737,stance loss: 0.17516 
Train step: 3340 acc:0.95105 total_loss: 0.29713  loss:0.40478,stance loss: 0.3295 
Train step: 3350 acc:0.94975 total_loss: 0.29516  loss:0.11947,stance loss: 0.056457 
Train step: 3360 acc:0.94939 total_loss: 0.29552  loss:0.5269,stance loss: 0.48811 
Train step: 3370 acc:0.94978 total_loss: 0.29549  loss:0.20406,stance loss: 0.12986 
Train step: 3380 acc:0.94911 total_loss: 0.30117  loss:0.64049,stance loss: 1.0717 
Train step: 3390 acc:0.94883 total_loss: 0.30342  loss:0.603,stance loss: 1.0495 
Train step: 3400 acc:0.94797 total_loss: 0.30213  loss:0.36562,stance loss: 0.16565 
Train step: 3410 acc:0.94894 total_loss: 0.3013  loss:0.55105,stance loss: 1.0147 
Train step: 3420 acc:0.94955 total_loss: 0.29749  loss:0.2505,stance loss: 0.20936 
Train step: 3430 acc:0.94957 total_loss: 0.29622  loss:0.050408,stance loss: 0.013552 
Train step: 3440 acc:0.95036 total_loss: 0.29575  loss:0.15025,stance loss: 0.036521 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3450 acc:0.9375 total_loss: 0.28322  loss:0.63884,stance loss: 0.42921 
Train step: 3460 acc:0.94853 total_loss: 0.28194  loss:0.14828,stance loss: 0.11132 
Train step: 3470 acc:0.94444 total_loss: 0.28415  loss:0.48282,stance loss: 0.36304 
Train step: 3480 acc:0.94426 total_loss: 0.29996  loss:0.59053,stance loss: 1.0274 
Train step: 3490 acc:0.9508 total_loss: 0.28242  loss:0.14663,stance loss: 0.088157 
Train step: 3500 acc:0.95395 total_loss: 0.27602  loss:0.82176,stance loss: 1.2954 
Train step: 3510 acc:0.95802 total_loss: 0.26261  loss:0.5177,stance loss: 0.27264 
Train step: 3520 acc:0.9586 total_loss: 0.24952  loss:0.076215,stance loss: 0.023461 
Train step: 3530 acc:0.95833 total_loss: 0.24485  loss:0.46454,stance loss: 0.46467 
Train step: 3540 acc:0.96198 total_loss: 0.22889  loss:0.093157,stance loss: 0.055127 
Train step: 3550 acc:0.96495 total_loss: 0.21633  loss:0.091268,stance loss: 0.074312 
Train step: 3560 acc:0.96528 total_loss: 0.21485  loss:0.49986,stance loss: 0.45074 
Train step: 3570 acc:0.96457 total_loss: 0.2293  loss:1.0624,stance loss: 1.3353 
Train step: 3580 acc:0.96487 total_loss: 0.22458  loss:0.038014,stance loss: 0.0053658 
Train step: 3590 acc:0.96471 total_loss: 0.22889  loss:0.34486,stance loss: 0.27241 
Train step: 3600 acc:0.96616 total_loss: 0.22417  loss:0.11077,stance loss: 0.072441 
Train step: 3610 acc:0.96594 total_loss: 0.22362  loss:0.46893,stance loss: 0.30641 
Train step: 3620 acc:0.96434 total_loss: 0.22635  loss:0.23773,stance loss: 0.035208 
Train step: 3630 acc:0.96491 total_loss: 0.22215  loss:0.24979,stance loss: 0.13717 
Train step: 3640 acc:0.96542 total_loss: 0.21696  loss:0.033289,stance loss: 0.0034237 
Train step: 3650 acc:0.96347 total_loss: 0.22216  loss:0.45178,stance loss: 0.37195 
Train step: 3660 acc:0.96256 total_loss: 0.22759  loss:0.13603,stance loss: 0.083101 
Train step: 3670 acc:0.96228 total_loss: 0.22768  loss:0.54136,stance loss: 0.50933 
Train step: 3680 acc:0.96176 total_loss: 0.23212  loss:1.0157,stance loss: 1.099 
Training finished.


Reload the best model with best f1 0.48273590085496904 from path test_outputs/bert-cross-topic/la/2023-08-14 20-10-08/state_dict


              precision    recall  f1-score   support

           0   0.678643  0.625000  0.650718       544
           1   0.544218  0.720721  0.620155       222
           2   0.347826  0.287425  0.314754       167

    accuracy                       0.587353       933
   macro avg   0.523562  0.544382  0.528542       933
weighted avg   0.587444  0.587353  0.583311       933

Test Acc: 0.587352625937835 F1_ma:0.48273590085496904
Test dataset: la
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.48273590085496904
acc: 0.587352625937835, f1 :0.5285422801565427
classification report: 
              precision    recall  f1-score   support

         Con     0.6786    0.6250    0.6507       544
        None     0.5442    0.7207    0.6202       222
         Pro     0.3478    0.2874    0.3148       167

    accuracy                         0.5874       933
   macro avg     0.5236    0.5444    0.5285       933
weighted avg     0.5874    0.5874    0.5833       933

