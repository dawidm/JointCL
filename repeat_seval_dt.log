run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 13-18-10', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 13-18-10
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.8677  loss:1.8677,stance loss: 1.1907 
Train step: 10 acc:0.26705 total_loss: 1.8337  loss:1.821,stance loss: 1.134 
Better F1! Saving model!
Saving model of best f1: 0.10918114143920597
              precision    recall  f1-score   support

           0   0.423077  0.147157  0.218362       299
           1   0.343284  0.796154  0.479722       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.355021       707
   macro avg   0.255454  0.314437  0.232695       707
weighted avg   0.305168  0.355021  0.268767       707

Test Acc: 0.355021216407355 F1_ma:0.10918114143920597
Train step: 20 acc:0.29167 total_loss: 1.7631  loss:1.6149,stance loss: 1.1426 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 30 acc:0.36895 total_loss: 1.7461  loss:1.7162,stance loss: 1.3329 
Train step: 40 acc:0.39024 total_loss: 1.7204  loss:1.4765,stance loss: 1.0847 
Train step: 50 acc:0.41667 total_loss: 1.7055  loss:1.7349,stance loss: 1.7063 
Train step: 60 acc:0.43033 total_loss: 1.7032  loss:1.6426,stance loss: 1.1677 
Train step: 70 acc:0.4419 total_loss: 1.693  loss:1.6089,stance loss: 1.1762 
Train step: 80 acc:0.44753 total_loss: 1.6879  loss:1.5364,stance loss: 1.0934 
Train step: 90 acc:0.45604 total_loss: 1.6792  loss:1.6241,stance loss: 1.2509 
Train step: 100 acc:0.45545 total_loss: 1.6895  loss:1.9476,stance loss: 1.7647 
Train step: 110 acc:0.46171 total_loss: 1.6849  loss:1.5434,stance loss: 1.096 
Train step: 120 acc:0.46746 total_loss: 1.6804  loss:1.3793,stance loss: 1.0066 
Train step: 130 acc:0.46517 total_loss: 1.6837  loss:1.7753,stance loss: 1.193 
Train step: 140 acc:0.4734 total_loss: 1.6733  loss:1.6933,stance loss: 1.2352 
Train step: 150 acc:0.47144 total_loss: 1.6681  loss:1.6549,stance loss: 1.2311 
Train step: 160 acc:0.4771 total_loss: 1.6619  loss:1.6908,stance loss: 1.1464 
Train step: 170 acc:0.48319 total_loss: 1.6605  loss:1.5991,stance loss: 1.6405 
Train step: 180 acc:0.49102 total_loss: 1.6501  loss:1.733,stance loss: 1.6156 
Train step: 190 acc:0.49444 total_loss: 1.6453  loss:1.4675,stance loss: 1.1319 
Train step: 200 acc:0.49876 total_loss: 1.6374  loss:1.2801,stance loss: 0.88107 
Train step: 210 acc:0.50178 total_loss: 1.6334  loss:1.5552,stance loss: 1.5924 
Train step: 220 acc:0.50622 total_loss: 1.6254  loss:1.5006,stance loss: 1.2251 
Train step: 230 acc:0.50839 total_loss: 1.6178  loss:1.4513,stance loss: 1.0421 
Train step: 240 acc:0.51193 total_loss: 1.6103  loss:1.5836,stance loss: 1.315 
Train step: 250 acc:0.51519 total_loss: 1.6077  loss:1.4434,stance loss: 1.0182 
Train step: 260 acc:0.52078 total_loss: 1.6016  loss:0.63344,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.5625 total_loss: 1.3828  loss:1.5894,stance loss: 1.3223 
Train step: 280 acc:0.575 total_loss: 1.3742  loss:1.2248,stance loss: 0.78345 
Train step: 290 acc:0.5875 total_loss: 1.3898  loss:1.5474,stance loss: 1.1165 
Train step: 300 acc:0.59844 total_loss: 1.4197  loss:1.3349,stance loss: 1.0694 
Train step: 310 acc:0.59 total_loss: 1.4414  loss:1.5292,stance loss: 0.96511 
Train step: 320 acc:0.59479 total_loss: 1.434  loss:1.5025,stance loss: 1.1236 
Train step: 330 acc:0.59196 total_loss: 1.4303  loss:1.4391,stance loss: 0.9421 
Train step: 340 acc:0.58672 total_loss: 1.4254  loss:1.5504,stance loss: 1.1139 
Train step: 350 acc:0.59444 total_loss: 1.4133  loss:1.1354,stance loss: 0.79146 
Train step: 360 acc:0.59562 total_loss: 1.4117  loss:1.5762,stance loss: 1.2375 
Train step: 370 acc:0.59205 total_loss: 1.4142  loss:1.4778,stance loss: 1.0892 
Train step: 380 acc:0.5901 total_loss: 1.4099  loss:1.5345,stance loss: 1.2504 
Train step: 390 acc:0.59327 total_loss: 1.4048  loss:1.4772,stance loss: 1.5966 
Train step: 400 acc:0.59732 total_loss: 1.4047  loss:1.5544,stance loss: 1.2225 
Better F1! Saving model!
Saving model of best f1: 0.29889669007021064
              precision    recall  f1-score   support

           0   0.426934  0.996656  0.597793       299
           1   0.777778  0.026923  0.052045       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.431400       707
   macro avg   0.401571  0.341193  0.216613       707
weighted avg   0.466585  0.431400  0.271954       707

Test Acc: 0.4314002828854314 F1_ma:0.29889669007021064
Train step: 410 acc:0.59833 total_loss: 1.4005  loss:1.3976,stance loss: 0.93529 
Train step: 420 acc:0.60156 total_loss: 1.3948  loss:1.477,stance loss: 1.0742 
Train step: 430 acc:0.60331 total_loss: 1.3913  loss:1.4207,stance loss: 1.2617 
Train step: 440 acc:0.60451 total_loss: 1.3862  loss:0.98129,stance loss: 0.54573 
Train step: 450 acc:0.60724 total_loss: 1.3801  loss:1.238,stance loss: 0.71126 
Train step: 460 acc:0.61281 total_loss: 1.3743  loss:1.3758,stance loss: 1.2413 
Train step: 470 acc:0.61548 total_loss: 1.3723  loss:1.3148,stance loss: 0.95152 
Train step: 480 acc:0.61705 total_loss: 1.3725  loss:1.198,stance loss: 1.0349 
Train step: 490 acc:0.61821 total_loss: 1.3705  loss:1.3731,stance loss: 1.0547 
Train step: 500 acc:0.61875 total_loss: 1.3688  loss:1.4372,stance loss: 1.4003 
Train step: 510 acc:0.6205 total_loss: 1.3696  loss:1.5635,stance loss: 1.2462 
Train step: 520 acc:0.62212 total_loss: 1.3679  loss:1.3615,stance loss: 1.043 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.5625 total_loss: 1.3175  loss:1.3242,stance loss: 0.96818 
Train step: 540 acc:0.61184 total_loss: 1.2954  loss:1.2476,stance loss: 0.87362 
Train step: 550 acc:0.63793 total_loss: 1.2867  loss:0.98213,stance loss: 0.82118 
Train step: 560 acc:0.64103 total_loss: 1.2935  loss:1.3725,stance loss: 1.0888 
Better F1! Saving model!
Saving model of best f1: 0.2992922143579373
              precision    recall  f1-score   support

           0   0.428986  0.989967  0.598584       299
           1   0.764706  0.050000  0.093863       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.437058       707
   macro avg   0.397897  0.346656  0.230816       707
weighted avg   0.462645  0.437058  0.287668       707

Test Acc: 0.43705799151343705 F1_ma:0.2992922143579373
Train step: 570 acc:0.64668 total_loss: 1.2911  loss:1.2532,stance loss: 1.027 
Train step: 580 acc:0.64089 total_loss: 1.2968  loss:1.1565,stance loss: 0.92254 
Train step: 590 acc:0.64493 total_loss: 1.3009  loss:1.3063,stance loss: 1.1522 
Better F1! Saving model!
Saving model of best f1: 0.29949748743718596
              precision    recall  f1-score   support

           0   0.428161  0.996656  0.598995       299
           1   0.909091  0.038462  0.073801       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.435644       707
   macro avg   0.445751  0.345039  0.224265       707
weighted avg   0.515394  0.435644  0.280463       707

Test Acc: 0.43564356435643564 F1_ma:0.29949748743718596
Train step: 600 acc:0.64953 total_loss: 1.2891  loss:0.93287,stance loss: 0.69612 
Train step: 610 acc:0.64888 total_loss: 1.2831  loss:1.3485,stance loss: 0.92094 
Train step: 620 acc:0.65278 total_loss: 1.2874  loss:1.3489,stance loss: 1.4646 
Train step: 630 acc:0.65539 total_loss: 1.2881  loss:1.254,stance loss: 1.0581 
Train step: 640 acc:0.65494 total_loss: 1.2857  loss:1.5795,stance loss: 1.155 
Train step: 650 acc:0.65891 total_loss: 1.2828  loss:1.297,stance loss: 1.2303 
Train step: 660 acc:0.65468 total_loss: 1.2906  loss:0.94205,stance loss: 0.66585 
Train step: 670 acc:0.65436 total_loss: 1.2928  loss:1.411,stance loss: 1.5915 
Train step: 680 acc:0.65881 total_loss: 1.2827  loss:1.2851,stance loss: 0.83888 
Train step: 690 acc:0.65976 total_loss: 1.2835  loss:0.98432,stance loss: 0.60264 
Train step: 700 acc:0.66411 total_loss: 1.279  loss:1.3264,stance loss: 1.0915 
Train step: 710 acc:0.66468 total_loss: 1.2783  loss:0.97448,stance loss: 0.76482 
Train step: 720 acc:0.66457 total_loss: 1.2778  loss:1.3786,stance loss: 1.1303 
Train step: 730 acc:0.66507 total_loss: 1.274  loss:1.5115,stance loss: 1.1875 
Train step: 740 acc:0.66638 total_loss: 1.2689  loss:1.4233,stance loss: 1.1543 
Train step: 750 acc:0.66676 total_loss: 1.2651  loss:1.2112,stance loss: 1.105 
Train step: 760 acc:0.66815 total_loss: 1.2647  loss:1.5035,stance loss: 1.2145 
Train step: 770 acc:0.66516 total_loss: 1.2692  loss:1.3475,stance loss: 0.89971 
Train step: 780 acc:0.66578 total_loss: 1.2641  loss:1.0335,stance loss: 0.71569 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.74219 total_loss: 1.13  loss:0.64979,stance loss: 0.4518 
Train step: 800 acc:0.74653 total_loss: 1.1803  loss:1.1028,stance loss: 0.76338 
Train step: 810 acc:0.71652 total_loss: 1.2138  loss:1.4729,stance loss: 1.1737 
Train step: 820 acc:0.71217 total_loss: 1.2094  loss:1.034,stance loss: 0.70034 
Train step: 830 acc:0.71354 total_loss: 1.1892  loss:0.86251,stance loss: 0.70027 
Train step: 840 acc:0.70905 total_loss: 1.1876  loss:1.3445,stance loss: 1.0883 
Train step: 850 acc:0.70221 total_loss: 1.201  loss:1.4934,stance loss: 1.0564 
Train step: 860 acc:0.69872 total_loss: 1.2017  loss:1.3103,stance loss: 0.99882 
Train step: 870 acc:0.69531 total_loss: 1.2072  loss:0.83473,stance loss: 0.65127 
Train step: 880 acc:0.69579 total_loss: 1.2133  loss:1.457,stance loss: 1.7138 
Train step: 890 acc:0.69676 total_loss: 1.2113  loss:1.0691,stance loss: 0.88526 
Train step: 900 acc:0.69968 total_loss: 1.2011  loss:1.2022,stance loss: 0.96555 
Train step: 910 acc:0.69775 total_loss: 1.2052  loss:1.0413,stance loss: 0.66139 
Train step: 920 acc:0.69203 total_loss: 1.2108  loss:1.1523,stance loss: 0.91804 
Train step: 930 acc:0.69426 total_loss: 1.2032  loss:1.0367,stance loss: 0.63145 
Train step: 940 acc:0.69581 total_loss: 1.1969  loss:0.95607,stance loss: 0.56901 
Train step: 950 acc:0.69308 total_loss: 1.1974  loss:0.88493,stance loss: 0.66722 
Train step: 960 acc:0.69101 total_loss: 1.1958  loss:0.95467,stance loss: 0.69703 
Train step: 970 acc:0.68949 total_loss: 1.1958  loss:0.67828,stance loss: 0.45632 
Train step: 980 acc:0.68971 total_loss: 1.1928  loss:1.6142,stance loss: 1.603 
Train step: 990 acc:0.69351 total_loss: 1.1877  loss:1.6008,stance loss: 1.6672 
Train step: 1000 acc:0.69381 total_loss: 1.1887  loss:0.92347,stance loss: 0.58468 
Train step: 1010 acc:0.69435 total_loss: 1.1868  loss:1.5905,stance loss: 1.1856 
Train step: 1020 acc:0.69407 total_loss: 1.1863  loss:0.95052,stance loss: 0.74362 
Train step: 1030 acc:0.69481 total_loss: 1.1822  loss:1.215,stance loss: 0.81996 
Train step: 1040 acc:0.69501 total_loss: 1.181  loss:0.83372,stance loss: 0.68736 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.71429 total_loss: 1.1637  loss:1.0594,stance loss: 0.76682 
Train step: 1060 acc:0.73162 total_loss: 1.1004  loss:1.3814,stance loss: 1.129 
Train step: 1070 acc:0.70602 total_loss: 1.1016  loss:0.87704,stance loss: 0.67584 
Train step: 1080 acc:0.68919 total_loss: 1.1561  loss:1.1936,stance loss: 0.82612 
Train step: 1090 acc:0.68883 total_loss: 1.1746  loss:1.2401,stance loss: 1.4121 
Train step: 1100 acc:0.69518 total_loss: 1.1785  loss:1.2992,stance loss: 0.97577 
Train step: 1110 acc:0.69776 total_loss: 1.1688  loss:0.80345,stance loss: 0.63479 
Train step: 1120 acc:0.70292 total_loss: 1.1532  loss:0.94417,stance loss: 0.63495 
Train step: 1130 acc:0.70043 total_loss: 1.1559  loss:1.0372,stance loss: 0.88398 
Train step: 1140 acc:0.70619 total_loss: 1.1524  loss:1.1659,stance loss: 0.87639 
Train step: 1150 acc:0.7021 total_loss: 1.1605  loss:1.3372,stance loss: 1.0349 
Train step: 1160 acc:0.70994 total_loss: 1.1402  loss:0.82075,stance loss: 0.62226 
Train step: 1170 acc:0.70915 total_loss: 1.1355  loss:0.97328,stance loss: 0.80188 
Train step: 1180 acc:0.70985 total_loss: 1.1366  loss:0.94133,stance loss: 0.82953 
Train step: 1190 acc:0.71131 total_loss: 1.134  loss:0.88752,stance loss: 0.65542 
Train step: 1200 acc:0.709 total_loss: 1.1352  loss:1.0897,stance loss: 0.78409 
Train step: 1210 acc:0.70883 total_loss: 1.1371  loss:0.9057,stance loss: 0.68637 
Train step: 1220 acc:0.71186 total_loss: 1.129  loss:0.93075,stance loss: 0.67419 
Train step: 1230 acc:0.71123 total_loss: 1.13  loss:1.5494,stance loss: 1.3601 
Train step: 1240 acc:0.71098 total_loss: 1.1299  loss:1.1034,stance loss: 0.92185 
Train step: 1250 acc:0.71165 total_loss: 1.1254  loss:1.115,stance loss: 0.7698 
Train step: 1260 acc:0.714 total_loss: 1.1221  loss:0.90692,stance loss: 0.53443 
Train step: 1270 acc:0.71669 total_loss: 1.1146  loss:0.93714,stance loss: 0.76482 
Train step: 1280 acc:0.71651 total_loss: 1.1158  loss:1.0637,stance loss: 0.75763 
Train step: 1290 acc:0.71711 total_loss: 1.1172  loss:1.0049,stance loss: 0.85192 
Train step: 1300 acc:0.71766 total_loss: 1.1186  loss:0.83914,stance loss: 0.66245 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.71875 total_loss: 1.0256  loss:1.0937,stance loss: 0.71205 
Train step: 1320 acc:0.75391 total_loss: 1.0001  loss:0.95121,stance loss: 0.88226 
Train step: 1330 acc:0.73558 total_loss: 1.0158  loss:1.167,stance loss: 0.89533 
Train step: 1340 acc:0.72743 total_loss: 1.0418  loss:1.2547,stance loss: 1.3886 
Train step: 1350 acc:0.72826 total_loss: 1.0518  loss:1.1155,stance loss: 0.76299 
Train step: 1360 acc:0.72321 total_loss: 1.0649  loss:0.98016,stance loss: 0.81354 
Train step: 1370 acc:0.72822 total_loss: 1.0469  loss:1.0289,stance loss: 0.95737 
Train step: 1380 acc:0.74013 total_loss: 1.016  loss:0.95655,stance loss: 0.877 
Train step: 1390 acc:0.73837 total_loss: 1.0296  loss:0.68699,stance loss: 0.47743 
Train step: 1400 acc:0.73372 total_loss: 1.0365  loss:1.3434,stance loss: 1.029 
Train step: 1410 acc:0.73172 total_loss: 1.0352  loss:1.0273,stance loss: 0.56637 
Train step: 1420 acc:0.73006 total_loss: 1.0382  loss:1.0857,stance loss: 0.91927 
Train step: 1430 acc:0.73512 total_loss: 1.0294  loss:0.83428,stance loss: 0.6126 
Train step: 1440 acc:0.73851 total_loss: 1.0278  loss:1.1427,stance loss: 0.91471 
Train step: 1450 acc:0.74315 total_loss: 1.0151  loss:0.89633,stance loss: 0.7176 
Train step: 1460 acc:0.74519 total_loss: 1.0101  loss:0.79327,stance loss: 0.59655 
Train step: 1470 acc:0.74699 total_loss: 1.01  loss:0.9609,stance loss: 0.76267 
Train step: 1480 acc:0.74787 total_loss: 1.0108  loss:0.87227,stance loss: 0.75546 
Train step: 1490 acc:0.74563 total_loss: 1.0184  loss:1.2802,stance loss: 1.5582 
Train step: 1500 acc:0.7449 total_loss: 1.0169  loss:0.93279,stance loss: 0.64138 
Train step: 1510 acc:0.74757 total_loss: 1.0102  loss:1.2004,stance loss: 1.098 
Train step: 1520 acc:0.74566 total_loss: 1.009  loss:0.89933,stance loss: 0.81816 
Better F1! Saving model!
Saving model of best f1: 0.3541605198853105
              precision    recall  f1-score   support

           0   0.453586  0.719064  0.556274       299
           1   0.557143  0.450000  0.497872       260
           2   0.565217  0.087838  0.152047       148

    accuracy                       0.487977       707
   macro avg   0.525316  0.418967  0.402064       707
weighted avg   0.515038  0.487977  0.450178       707

Test Acc: 0.48797736916548795 F1_ma:0.3541605198853105
Train step: 1530 acc:0.74364 total_loss: 1.0152  loss:0.94629,stance loss: 0.66192 
Train step: 1540 acc:0.74232 total_loss: 1.0149  loss:1.7277,stance loss: 1.7323 
Train step: 1550 acc:0.74162 total_loss: 1.0171  loss:0.86354,stance loss: 0.68782 
Train step: 1560 acc:0.74194 total_loss: 1.015  loss:0.67545,stance loss: 0.49459 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.7375 total_loss: 1.045  loss:1.4012,stance loss: 1.1128 
Train step: 1580 acc:0.7375 total_loss: 0.9588  loss:0.65795,stance loss: 0.48982 
Train step: 1590 acc:0.775 total_loss: 0.90784  loss:1.0329,stance loss: 0.59455 
Train step: 1600 acc:0.78036 total_loss: 0.88581  loss:0.67036,stance loss: 0.57612 
Train step: 1610 acc:0.78472 total_loss: 0.89766  loss:1.2873,stance loss: 1.1022 
Train step: 1620 acc:0.78977 total_loss: 0.8944  loss:0.77132,stance loss: 0.48855 
Train step: 1630 acc:0.78365 total_loss: 0.90208  loss:0.4458,stance loss: 0.32185 
Train step: 1640 acc:0.7825 total_loss: 0.90668  loss:1.4263,stance loss: 0.97453 
Train step: 1650 acc:0.77868 total_loss: 0.91374  loss:0.74212,stance loss: 0.62545 
Train step: 1660 acc:0.775 total_loss: 0.93062  loss:0.77847,stance loss: 0.69628 
Train step: 1670 acc:0.77738 total_loss: 0.93865  loss:1.2538,stance loss: 1.3167 
Train step: 1680 acc:0.77609 total_loss: 0.94153  loss:1.0444,stance loss: 1.4272 
Train step: 1690 acc:0.7735 total_loss: 0.94686  loss:0.87765,stance loss: 0.72527 
Train step: 1700 acc:0.77083 total_loss: 0.94603  loss:0.57656,stance loss: 0.48636 
Train step: 1710 acc:0.77328 total_loss: 0.94152  loss:0.93969,stance loss: 0.64083 
Train step: 1720 acc:0.77258 total_loss: 0.94805  loss:1.0814,stance loss: 1.3278 
Train step: 1730 acc:0.77311 total_loss: 0.94513  loss:0.49386,stance loss: 0.34765 
Train step: 1740 acc:0.77393 total_loss: 0.94656  loss:1.5438,stance loss: 1.6569 
Train step: 1750 acc:0.77703 total_loss: 0.93892  loss:0.81554,stance loss: 0.53987 
Train step: 1760 acc:0.77596 total_loss: 0.93674  loss:0.36981,stance loss: 0.17624 
Train step: 1770 acc:0.77378 total_loss: 0.94123  loss:1.0544,stance loss: 0.83049 
Train step: 1780 acc:0.77326 total_loss: 0.93632  loss:0.95524,stance loss: 0.75077 
Train step: 1790 acc:0.77389 total_loss: 0.93095  loss:1.1492,stance loss: 1.4681 
Train step: 1800 acc:0.77314 total_loss: 0.93899  loss:0.62671,stance loss: 0.4857 
Train step: 1810 acc:0.77321 total_loss: 0.93917  loss:0.98092,stance loss: 0.62161 
Train step: 1820 acc:0.77402 total_loss: 0.93648  loss:0.73191,stance loss: 0.59415 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.8125 total_loss: 0.91657  loss:1.0315,stance loss: 0.96427 
Train step: 1840 acc:0.79911 total_loss: 0.84888  loss:0.61831,stance loss: 0.45986 
Train step: 1850 acc:0.78646 total_loss: 0.87651  loss:0.83854,stance loss: 0.54179 
Train step: 1860 acc:0.78676 total_loss: 0.8845  loss:0.99094,stance loss: 0.79262 
Train step: 1870 acc:0.79403 total_loss: 0.86715  loss:1.1232,stance loss: 0.97843 
Train step: 1880 acc:0.78935 total_loss: 0.87902  loss:0.47068,stance loss: 0.33988 
Train step: 1890 acc:0.79297 total_loss: 0.87997  loss:0.60704,stance loss: 0.4527 
Train step: 1900 acc:0.79139 total_loss: 0.8638  loss:1.0474,stance loss: 0.73652 
Train step: 1910 acc:0.79167 total_loss: 0.84587  loss:0.53967,stance loss: 0.44976 
Train step: 1920 acc:0.79721 total_loss: 0.84486  loss:0.87993,stance loss: 0.74735 
Train step: 1930 acc:0.79868 total_loss: 0.83335  loss:0.46162,stance loss: 0.35958 
Train step: 1940 acc:0.80373 total_loss: 0.82957  loss:1.1866,stance loss: 1.4909 
Train step: 1950 acc:0.80343 total_loss: 0.8332  loss:0.59932,stance loss: 0.48868 
Train step: 1960 acc:0.79991 total_loss: 0.83554  loss:0.93621,stance loss: 1.3156 
Train step: 1970 acc:0.80035 total_loss: 0.83653  loss:0.95745,stance loss: 0.6361 
Train step: 1980 acc:0.80398 total_loss: 0.82065  loss:0.95772,stance loss: 0.59776 
Train step: 1990 acc:0.80373 total_loss: 0.8231  loss:1.3261,stance loss: 1.1413 
Train step: 2000 acc:0.80424 total_loss: 0.82296  loss:0.96622,stance loss: 0.63765 
Train step: 2010 acc:0.80503 total_loss: 0.82168  loss:0.32154,stance loss: 0.18061 
Train step: 2020 acc:0.80509 total_loss: 0.82206  loss:1.0964,stance loss: 1.1912 
Train step: 2030 acc:0.80668 total_loss: 0.8203  loss:0.82133,stance loss: 0.62126 
Train step: 2040 acc:0.80491 total_loss: 0.82252  loss:0.73326,stance loss: 0.37419 
Train step: 2050 acc:0.80357 total_loss: 0.82335  loss:0.73851,stance loss: 0.58558 
Train step: 2060 acc:0.80449 total_loss: 0.82155  loss:1.1534,stance loss: 0.85853 
Train step: 2070 acc:0.80507 total_loss: 0.82218  loss:1.2151,stance loss: 1.4735 
Train step: 2080 acc:0.80389 total_loss: 0.8242  loss:0.9826,stance loss: 0.73651 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.89583 total_loss: 0.44786  loss:0.54355,stance loss: 0.40339 
Train step: 2100 acc:0.84615 total_loss: 0.60935  loss:0.51689,stance loss: 0.43799 
Train step: 2110 acc:0.8288 total_loss: 0.74168  loss:0.8607,stance loss: 0.77024 
Train step: 2120 acc:0.83902 total_loss: 0.72447  loss:0.60546,stance loss: 0.44211 
Train step: 2130 acc:0.84012 total_loss: 0.71797  loss:0.72214,stance loss: 0.64971 
Train step: 2140 acc:0.83491 total_loss: 0.74017  loss:0.84581,stance loss: 0.59325 
Train step: 2150 acc:0.83135 total_loss: 0.74641  loss:0.47791,stance loss: 0.32111 
Train step: 2160 acc:0.83476 total_loss: 0.72933  loss:0.32887,stance loss: 0.22391 
Train step: 2170 acc:0.83434 total_loss: 0.73018  loss:0.82632,stance loss: 0.5502 
Train step: 2180 acc:0.82594 total_loss: 0.75006  loss:1.4523,stance loss: 1.2562 
Train step: 2190 acc:0.82585 total_loss: 0.74757  loss:0.59901,stance loss: 0.36199 
Train step: 2200 acc:0.82577 total_loss: 0.75292  loss:1.3098,stance loss: 1.2402 
Train step: 2210 acc:0.82724 total_loss: 0.74275  loss:0.82865,stance loss: 0.56639 
Train step: 2220 acc:0.8266 total_loss: 0.74426  loss:0.86569,stance loss: 0.69548 
Train step: 2230 acc:0.82823 total_loss: 0.7422  loss:0.72574,stance loss: 0.58383 
Train step: 2240 acc:0.82843 total_loss: 0.73692  loss:0.98323,stance loss: 0.82001 
Train step: 2250 acc:0.8263 total_loss: 0.7449  loss:0.71281,stance loss: 0.69228 
Train step: 2260 acc:0.82587 total_loss: 0.74596  loss:0.75678,stance loss: 0.62635 
Train step: 2270 acc:0.82616 total_loss: 0.7444  loss:0.55721,stance loss: 0.36533 
Train step: 2280 acc:0.83063 total_loss: 0.73204  loss:0.44033,stance loss: 0.43598 
Train step: 2290 acc:0.83128 total_loss: 0.72599  loss:0.48753,stance loss: 0.0099164 
Train step: 2300 acc:0.83187 total_loss: 0.72714  loss:1.0637,stance loss: 1.4519 
Train step: 2310 acc:0.83212 total_loss: 0.72698  loss:0.64973,stance loss: 0.55604 
Train step: 2320 acc:0.8302 total_loss: 0.7307  loss:0.93657,stance loss: 0.85422 
Train step: 2330 acc:0.83076 total_loss: 0.73128  loss:0.68301,stance loss: 0.46288 
Train step: 2340 acc:0.83103 total_loss: 0.73076  loss:0.72675,stance loss: 0.49803 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.96875 total_loss: 0.5569  loss:0.77477,stance loss: 1.2111 
Train step: 2360 acc:0.86979 total_loss: 0.6363  loss:0.72294,stance loss: 0.48688 
Train step: 2370 acc:0.875 total_loss: 0.58559  loss:0.61275,stance loss: 0.54022 
Train step: 2380 acc:0.86914 total_loss: 0.61219  loss:0.51874,stance loss: 0.40764 
Train step: 2390 acc:0.86161 total_loss: 0.62766  loss:0.64525,stance loss: 0.54654 
Train step: 2400 acc:0.86058 total_loss: 0.63954  loss:0.46234,stance loss: 0.2866 
Train step: 2410 acc:0.85282 total_loss: 0.64042  loss:0.57663,stance loss: 0.50397 
Train step: 2420 acc:0.85677 total_loss: 0.64311  loss:0.74354,stance loss: 1.151 
Train step: 2430 acc:0.85671 total_loss: 0.65146  loss:1.0115,stance loss: 1.2878 
Train step: 2440 acc:0.85938 total_loss: 0.65338  loss:0.84695,stance loss: 0.5244 
Better F1! Saving model!
Saving model of best f1: 0.36665454809859666
              precision    recall  f1-score   support

           0   0.450980  0.769231  0.568603       299
           1   0.565714  0.380769  0.455172       260
           2   0.636364  0.094595  0.164706       148

    accuracy                       0.485149       707
   macro avg   0.551019  0.414865  0.396161       707
weighted avg   0.531981  0.485149  0.442339       707

Test Acc: 0.48514851485148514 F1_ma:0.36665454809859666
Train step: 2450 acc:0.85478 total_loss: 0.65865  loss:0.74166,stance loss: 0.52106 
Better F1! Saving model!
Saving model of best f1: 0.3939654301020924
              precision    recall  f1-score   support

           0   0.458874  0.709030  0.557162       299
           1   0.545024  0.442308  0.488323       260
           2   0.617647  0.141892  0.230769       148

    accuracy                       0.492221       707
   macro avg   0.540515  0.431077  0.425418       707
weighted avg   0.523793  0.492221  0.463521       707

Test Acc: 0.49222065063649223 F1_ma:0.3939654301020924
Train step: 2460 acc:0.85603 total_loss: 0.65573  loss:0.34022,stance loss: 0.30817 
Train step: 2470 acc:0.85912 total_loss: 0.6515  loss:0.24028,stance loss: 0.13276 
Train step: 2480 acc:0.8608 total_loss: 0.63911  loss:0.19551,stance loss: 0.11465 
Train step: 2490 acc:0.8596 total_loss: 0.64112  loss:0.76362,stance loss: 1.1806 
Train step: 2500 acc:0.85938 total_loss: 0.64418  loss:0.7403,stance loss: 1.0632 
Train step: 2510 acc:0.86073 total_loss: 0.64036  loss:0.49449,stance loss: 0.43578 
Train step: 2520 acc:0.86047 total_loss: 0.63669  loss:1.0925,stance loss: 0.90286 
Train step: 2530 acc:0.86126 total_loss: 0.62635  loss:0.17001,stance loss: 0.084296 
Train step: 2540 acc:0.8623 total_loss: 0.62362  loss:0.64177,stance loss: 0.58555 
Better F1! Saving model!
Saving model of best f1: 0.4036856368563686
              precision    recall  f1-score   support

           0   0.470745  0.591973  0.524444       299
           1   0.529197  0.557692  0.543071       260
           2   0.508772  0.195946  0.282927       148

    accuracy                       0.496464       707
   macro avg   0.502905  0.448537  0.450147       707
weighted avg   0.500201  0.496464  0.480736       707

Test Acc: 0.49646393210749645 F1_ma:0.4036856368563686
Train step: 2550 acc:0.86262 total_loss: 0.62566  loss:0.68661,stance loss: 0.50138 
Train step: 2560 acc:0.86173 total_loss: 0.62661  loss:0.90913,stance loss: 1.1261 
Train step: 2570 acc:0.86205 total_loss: 0.62962  loss:0.28068,stance loss: 0.16377 
Train step: 2580 acc:0.86395 total_loss: 0.62408  loss:0.4127,stance loss: 0.37859 
Train step: 2590 acc:0.86235 total_loss: 0.62904  loss:0.51722,stance loss: 0.35736 
Train step: 2600 acc:0.8626 total_loss: 0.63064  loss:1.2621,stance loss: 0.92521 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.8125 total_loss: 0.66172  loss:0.66172,stance loss: 0.59454 
Train step: 2620 acc:0.88068 total_loss: 0.62843  loss:0.7168,stance loss: 0.65079 
Train step: 2630 acc:0.89286 total_loss: 0.56038  loss:0.45959,stance loss: 0.3966 
Train step: 2640 acc:0.88508 total_loss: 0.5732  loss:0.49207,stance loss: 0.3364 
Train step: 2650 acc:0.87043 total_loss: 0.59375  loss:1.0275,stance loss: 1.0303 
Train step: 2660 acc:0.87745 total_loss: 0.58075  loss:0.99954,stance loss: 1.3705 
Train step: 2670 acc:0.88525 total_loss: 0.56022  loss:0.2342,stance loss: 0.11292 
Train step: 2680 acc:0.8838 total_loss: 0.55263  loss:0.52741,stance loss: 0.41816 
Train step: 2690 acc:0.88812 total_loss: 0.55164  loss:0.16107,stance loss: 0.11037 
Train step: 2700 acc:0.89217 total_loss: 0.53931  loss:0.75354,stance loss: 1.0686 
Train step: 2710 acc:0.89171 total_loss: 0.53739  loss:0.30701,stance loss: 0.20355 
Train step: 2720 acc:0.88908 total_loss: 0.54333  loss:0.44008,stance loss: 0.38335 
Train step: 2730 acc:0.88585 total_loss: 0.54692  loss:0.37798,stance loss: 0.37337 
Train step: 2740 acc:0.88502 total_loss: 0.55406  loss:0.5232,stance loss: 0.4087 
Train step: 2750 acc:0.88608 total_loss: 0.55119  loss:0.21946,stance loss: 0.13865 
Train step: 2760 acc:0.88535 total_loss: 0.54959  loss:0.30017,stance loss: 0.24087 
Train step: 2770 acc:0.8847 total_loss: 0.54708  loss:0.18378,stance loss: 0.15901 
Train step: 2780 acc:0.88268 total_loss: 0.55075  loss:0.54726,stance loss: 0.37163 
Better F1! Saving model!
Saving model of best f1: 0.416475378477346
              precision    recall  f1-score   support

           0   0.449351  0.578595  0.505848       299
           1   0.519531  0.511538  0.515504       260
           2   0.530303  0.236486  0.327103       148

    accuracy                       0.482320       707
   macro avg   0.499728  0.442207  0.449485       707
weighted avg   0.492106  0.482320  0.471981       707

Test Acc: 0.4823196605374823 F1_ma:0.416475378477346
Train step: 2790 acc:0.88156 total_loss: 0.55219  loss:0.24353,stance loss: 0.062596 
Train step: 2800 acc:0.88089 total_loss: 0.55307  loss:0.78023,stance loss: 1.2267 
Train step: 2810 acc:0.88029 total_loss: 0.55859  loss:1.2789,stance loss: 1.5745 
Train step: 2820 acc:0.87944 total_loss: 0.55705  loss:0.45204,stance loss: 0.40101 
Train step: 2830 acc:0.87981 total_loss: 0.55557  loss:0.4437,stance loss: 0.38394 
Train step: 2840 acc:0.87716 total_loss: 0.56457  loss:0.71308,stance loss: 0.65208 
Train step: 2850 acc:0.87837 total_loss: 0.56004  loss:0.15607,stance loss: 0.12292 
Train step: 2860 acc:0.87973 total_loss: 0.55659  loss:0.38966,stance loss: 0.30962 
Train step: 2870 acc:0.87941 total_loss: 0.55823  loss:2.7292,stance loss: 5.3763 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.86875 total_loss: 0.48406  loss:0.49106,stance loss: 0.39317 
Train step: 2890 acc:0.89062 total_loss: 0.52321  loss:1.4163,stance loss: 1.6259 
Train step: 2900 acc:0.88542 total_loss: 0.49654  loss:0.20765,stance loss: 0.15064 
Train step: 2910 acc:0.89062 total_loss: 0.48694  loss:0.20843,stance loss: 0.15137 
Train step: 2920 acc:0.89375 total_loss: 0.45903  loss:0.28111,stance loss: 0.18717 
Train step: 2930 acc:0.9 total_loss: 0.47508  loss:0.624,stance loss: 1.0289 
Train step: 2940 acc:0.90357 total_loss: 0.47196  loss:0.81649,stance loss: 1.0586 
Train step: 2950 acc:0.90078 total_loss: 0.4733  loss:0.67692,stance loss: 0.52068 
Train step: 2960 acc:0.90208 total_loss: 0.46818  loss:1.134,stance loss: 1.175 
Train step: 2970 acc:0.90125 total_loss: 0.4785  loss:0.73066,stance loss: 0.61977 
Train step: 2980 acc:0.90057 total_loss: 0.47483  loss:0.5323,stance loss: 0.40952 
Train step: 2990 acc:0.90365 total_loss: 0.46597  loss:0.57565,stance loss: 0.44685 
Train step: 3000 acc:0.90673 total_loss: 0.45244  loss:0.26611,stance loss: 0.1915 
Train step: 3010 acc:0.90893 total_loss: 0.44269  loss:0.077685,stance loss: 0.043369 
Train step: 3020 acc:0.9075 total_loss: 0.44517  loss:0.51735,stance loss: 0.49858 
Train step: 3030 acc:0.90391 total_loss: 0.46015  loss:0.79665,stance loss: 0.82353 
Train step: 3040 acc:0.90515 total_loss: 0.45141  loss:0.19683,stance loss: 0.077422 
Train step: 3050 acc:0.90486 total_loss: 0.45428  loss:0.24503,stance loss: 0.13862 
Train step: 3060 acc:0.90461 total_loss: 0.44871  loss:0.10507,stance loss: 0.058035 
Train step: 3070 acc:0.90531 total_loss: 0.44917  loss:0.51094,stance loss: 0.32479 
Train step: 3080 acc:0.90327 total_loss: 0.45822  loss:0.47889,stance loss: 0.44048 
Better F1! Saving model!
Saving model of best f1: 0.4213615167882673
              precision    recall  f1-score   support

           0   0.450521  0.578595  0.506589       299
           1   0.549356  0.492308  0.519270       260
           2   0.444444  0.270270  0.336134       148

    accuracy                       0.482320       707
   macro avg   0.481441  0.447058  0.453998       707
weighted avg   0.485596  0.482320  0.475570       707

Test Acc: 0.4823196605374823 F1_ma:0.4213615167882673
Train step: 3090 acc:0.90426 total_loss: 0.45409  loss:0.45102,stance loss: 0.36854 
Train step: 3100 acc:0.90435 total_loss: 0.45436  loss:0.18028,stance loss: 0.13567 
Train step: 3110 acc:0.90417 total_loss: 0.45548  loss:0.53534,stance loss: 0.46299 
Train step: 3120 acc:0.90375 total_loss: 0.45298  loss:0.48953,stance loss: 0.44824 
Train step: 3130 acc:0.90337 total_loss: 0.45688  loss:0.12123,stance loss: 0.056241 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.92361 total_loss: 0.48006  loss:0.39353,stance loss: 0.22571 
Train step: 3150 acc:0.92434 total_loss: 0.41115  loss:0.27841,stance loss: 0.21454 
Train step: 3160 acc:0.9181 total_loss: 0.4083  loss:0.41727,stance loss: 0.40457 
Train step: 3170 acc:0.91667 total_loss: 0.38252  loss:0.31938,stance loss: 0.26315 
Train step: 3180 acc:0.91709 total_loss: 0.38381  loss:0.91998,stance loss: 0.86615 
Train step: 3190 acc:0.92055 total_loss: 0.38618  loss:0.68387,stance loss: 1.1503 
Train step: 3200 acc:0.92663 total_loss: 0.35604  loss:0.18044,stance loss: 0.084651 
Train step: 3210 acc:0.92801 total_loss: 0.34468  loss:0.33453,stance loss: 0.31614 
Train step: 3220 acc:0.92626 total_loss: 0.35644  loss:0.73666,stance loss: 1.2196 
Train step: 3230 acc:0.9274 total_loss: 0.3701  loss:1.1462,stance loss: 2.0682 
Train step: 3240 acc:0.92718 total_loss: 0.38034  loss:0.39739,stance loss: 0.31741 
Train step: 3250 acc:0.92332 total_loss: 0.38837  loss:0.14475,stance loss: 0.084589 
Train step: 3260 acc:0.92248 total_loss: 0.39221  loss:0.36577,stance loss: 0.34601 
Train step: 3270 acc:0.92221 total_loss: 0.39578  loss:0.10526,stance loss: 0.043161 
Train step: 3280 acc:0.92324 total_loss: 0.39209  loss:0.69296,stance loss: 1.0669 
Train step: 3290 acc:0.92649 total_loss: 0.38383  loss:0.22319,stance loss: 0.20437 
Train step: 3300 acc:0.92456 total_loss: 0.3878  loss:0.32639,stance loss: 0.35268 
Better F1! Saving model!
Saving model of best f1: 0.4241909814323608
              precision    recall  f1-score   support

           0   0.460094  0.655518  0.540690       299
           1   0.588235  0.500000  0.540541       260
           2   0.533333  0.216216  0.307692       148

    accuracy                       0.506365       707
   macro avg   0.527221  0.457245  0.462974       707
weighted avg   0.522550  0.506365  0.491860       707

Test Acc: 0.5063649222065064 F1_ma:0.4241909814323608
Train step: 3310 acc:0.92388 total_loss: 0.38506  loss:0.070388,stance loss: 0.030526 
Train step: 3320 acc:0.92361 total_loss: 0.38395  loss:0.039349,stance loss: 0.0057134 
Train step: 3330 acc:0.92337 total_loss: 0.38447  loss:0.2359,stance loss: 0.11265 
Train step: 3340 acc:0.92225 total_loss: 0.3927  loss:0.78998,stance loss: 0.60005 
Better F1! Saving model!
Saving model of best f1: 0.45013557551182865
              precision    recall  f1-score   support

           0   0.463889  0.558528  0.506829       299
           1   0.533865  0.515385  0.524462       260
           2   0.500000  0.324324  0.393443       148

    accuracy                       0.493635       707
   macro avg   0.499251  0.466079  0.474911       707
weighted avg   0.497182  0.493635  0.489578       707

Test Acc: 0.49363507779349364 F1_ma:0.45013557551182865
Train step: 3350 acc:0.9218 total_loss: 0.39652  loss:0.23171,stance loss: 0.082504 
Train step: 3360 acc:0.92276 total_loss: 0.39783  loss:0.7124,stance loss: 0.58999 
Train step: 3370 acc:0.92416 total_loss: 0.39511  loss:0.48195,stance loss: 0.4812 
Train step: 3380 acc:0.92344 total_loss: 0.3987  loss:0.30215,stance loss: 0.26546 
Train step: 3390 acc:0.92326 total_loss: 0.39879  loss:0.39136,stance loss: 0.24531 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.92969 total_loss: 0.43317  loss:0.39351,stance loss: 0.25596 
Train step: 3410 acc:0.92361 total_loss: 0.46396  loss:0.56954,stance loss: 0.40976 
Train step: 3420 acc:0.93527 total_loss: 0.38222  loss:0.20707,stance loss: 0.12595 
Train step: 3430 acc:0.94243 total_loss: 0.36709  loss:0.7321,stance loss: 0.56543 
Train step: 3440 acc:0.94531 total_loss: 0.35262  loss:0.34134,stance loss: 0.2742 
Train step: 3450 acc:0.94504 total_loss: 0.33783  loss:0.23422,stance loss: 0.22038 
Train step: 3460 acc:0.94853 total_loss: 0.33047  loss:0.037067,stance loss: 0.010487 
Train step: 3470 acc:0.94952 total_loss: 0.31656  loss:0.21017,stance loss: 0.16418 
Train step: 3480 acc:0.94673 total_loss: 0.31884  loss:0.023007,stance loss: 0.0011171 
Train step: 3490 acc:0.94834 total_loss: 0.31294  loss:0.32888,stance loss: 0.22169 
Train step: 3500 acc:0.94907 total_loss: 0.31316  loss:0.10517,stance loss: 0.10101 
Train step: 3510 acc:0.9518 total_loss: 0.30674  loss:0.13905,stance loss: 0.076849 
Train step: 3520 acc:0.95166 total_loss: 0.30709  loss:0.63707,stance loss: 1.076 
Train step: 3530 acc:0.95109 total_loss: 0.30508  loss:0.2366,stance loss: 0.10713 
Train step: 3540 acc:0.9527 total_loss: 0.29809  loss:0.030273,stance loss: 0.0055241 
Train step: 3550 acc:0.95134 total_loss: 0.30103  loss:0.20723,stance loss: 0.11665 
Train step: 3560 acc:0.95089 total_loss: 0.30142  loss:0.25808,stance loss: 0.23845 
Train step: 3570 acc:0.94979 total_loss: 0.31062  loss:0.66324,stance loss: 0.5324 
Train step: 3580 acc:0.94648 total_loss: 0.31697  loss:0.25961,stance loss: 0.27136 
Train step: 3590 acc:0.94476 total_loss: 0.31781  loss:0.49396,stance loss: 0.42881 
Train step: 3600 acc:0.94561 total_loss: 0.31421  loss:0.19685,stance loss: 0.16087 
Train step: 3610 acc:0.94639 total_loss: 0.31136  loss:0.61641,stance loss: 1.0176 
Train step: 3620 acc:0.946 total_loss: 0.31406  loss:1.3478,stance loss: 1.8249 
Train step: 3630 acc:0.94617 total_loss: 0.31349  loss:0.38661,stance loss: 0.10891 
Train step: 3640 acc:0.94582 total_loss: 0.31275  loss:0.07585,stance loss: 0.055907 
Train step: 3650 acc:0.94549 total_loss: 0.31208  loss:0.17857,stance loss: 0.16235 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.92857 total_loss: 0.37002  loss:0.24505,stance loss: 0.16364 
Train step: 3670 acc:0.94485 total_loss: 0.30014  loss:0.11394,stance loss: 0.087845 
Train step: 3680 acc:0.95139 total_loss: 0.28602  loss:0.080676,stance loss: 0.05238 
Train step: 3690 acc:0.94257 total_loss: 0.30567  loss:0.49784,stance loss: 0.33148 
Train step: 3700 acc:0.94681 total_loss: 0.2983  loss:0.73512,stance loss: 1.0494 
Train step: 3710 acc:0.94846 total_loss: 0.29728  loss:0.35097,stance loss: 0.26257 
Train step: 3720 acc:0.95429 total_loss: 0.3028  loss:0.14486,stance loss: 0.12558 
Train step: 3730 acc:0.95455 total_loss: 0.29477  loss:0.24773,stance loss: 0.19695 
Train step: 3740 acc:0.9569 total_loss: 0.28327  loss:0.26863,stance loss: 0.22103 
Train step: 3750 acc:0.95876 total_loss: 0.28199  loss:0.30461,stance loss: 0.2666 
Train step: 3760 acc:0.96028 total_loss: 0.27236  loss:0.018391,stance loss: 0.0021402 
Train step: 3770 acc:0.961 total_loss: 0.25898  loss:0.063225,stance loss: 0.019409 
Train step: 3780 acc:0.95915 total_loss: 0.26963  loss:0.10098,stance loss: 0.050771 
Train step: 3790 acc:0.96077 total_loss: 0.26532  loss:0.080097,stance loss: 0.054915 
Train step: 3800 acc:0.96131 total_loss: 0.26298  loss:0.058744,stance loss: 0.023898 
Train step: 3810 acc:0.96218 total_loss: 0.2579  loss:0.035514,stance loss: 0.0046361 
Train step: 3820 acc:0.96145 total_loss: 0.26509  loss:0.3395,stance loss: 0.31593 
Train step: 3830 acc:0.96222 total_loss: 0.26633  loss:0.16219,stance loss: 0.042517 
Train step: 3840 acc:0.9609 total_loss: 0.27109  loss:0.46513,stance loss: 0.28529 
Train step: 3850 acc:0.96193 total_loss: 0.26691  loss:0.30675,stance loss: 0.25695 
Train step: 3860 acc:0.96135 total_loss: 0.27057  loss:0.08722,stance loss: 0.034683 
Train step: 3870 acc:0.96141 total_loss: 0.26708  loss:0.54646,stance loss: 0.58491 
Train step: 3880 acc:0.96228 total_loss: 0.26246  loss:0.13961,stance loss: 0.14004 
Train step: 3890 acc:0.96229 total_loss: 0.26054  loss:0.66167,stance loss: 0.28605 
Train step: 3900 acc:0.96154 total_loss: 0.26411  loss:0.38666,stance loss: 0.27503 
Train step: 3910 acc:0.95987 total_loss: 0.26846  loss:0.1939,stance loss: 0.14173 
Training finished.


Reload the best model with best f1 0.45013557551182865 from path test_outputs/bert-cross-topic/dt/2023-08-14 13-18-10/state_dict


              precision    recall  f1-score   support

           0   0.463889  0.558528  0.506829       299
           1   0.533865  0.515385  0.524462       260
           2   0.500000  0.324324  0.393443       148

    accuracy                       0.493635       707
   macro avg   0.499251  0.466079  0.474911       707
weighted avg   0.497182  0.493635  0.489578       707

Test Acc: 0.49363507779349364 F1_ma:0.45013557551182865
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.45013557551182865
acc: 0.49363507779349364, f1 :0.47491099685133004
classification report: 
              precision    recall  f1-score   support

         Con     0.4639    0.5585    0.5068       299
        None     0.5339    0.5154    0.5245       260
         Pro     0.5000    0.3243    0.3934       148

    accuracy                         0.4936       707
   macro avg     0.4993    0.4661    0.4749       707
weighted avg     0.4972    0.4936    0.4896       707

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 13-36-58', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 13-36-58
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.6929  loss:1.6929,stance loss: 1.1567 
Train step: 10 acc:0.375 total_loss: 1.6802  loss:1.5412,stance loss: 1.0339 
Better F1! Saving model!
Saving model of best f1: 0.2532239155920281
              precision    recall  f1-score   support

           0   0.389892  0.722408  0.506448       299
           1   0.052288  0.030769  0.038741       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.316832       707
   macro avg   0.147393  0.251059  0.181730       707
weighted avg   0.184119  0.316832  0.228431       707

Test Acc: 0.31683168316831684 F1_ma:0.2532239155920281
Train step: 20 acc:0.41071 total_loss: 1.6842  loss:1.6591,stance loss: 1.1773 
Better F1! Saving model!
Saving model of best f1: 0.29120323559150657
              precision    recall  f1-score   support

           0   0.417391  0.963211  0.582406       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.407355       707
   macro avg   0.139130  0.321070  0.194135       707
weighted avg   0.176521  0.407355  0.246308       707

Test Acc: 0.4073550212164074 F1_ma:0.29120323559150657
Train step: 30 acc:0.45363 total_loss: 1.6443  loss:1.4207,stance loss: 0.91343 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 40 acc:0.43598 total_loss: 1.6669  loss:1.9685,stance loss: 1.8283 
Train step: 50 acc:0.45221 total_loss: 1.6537  loss:1.646,stance loss: 1.1976 
Train step: 60 acc:0.45389 total_loss: 1.66  loss:1.9737,stance loss: 1.7368 
Train step: 70 acc:0.45246 total_loss: 1.6519  loss:1.5054,stance loss: 0.98899 
Train step: 80 acc:0.45448 total_loss: 1.6464  loss:1.7128,stance loss: 1.2755 
Train step: 90 acc:0.46154 total_loss: 1.6377  loss:1.659,stance loss: 1.4837 
Train step: 100 acc:0.46473 total_loss: 1.6346  loss:1.4289,stance loss: 0.96806 
Train step: 110 acc:0.46959 total_loss: 1.6241  loss:1.4432,stance loss: 0.99385 
Train step: 120 acc:0.46643 total_loss: 1.6249  loss:1.4779,stance loss: 0.95596 
Train step: 130 acc:0.46756 total_loss: 1.6218  loss:1.6705,stance loss: 1.2115 
Train step: 140 acc:0.47385 total_loss: 1.6126  loss:1.4126,stance loss: 0.79423 
Train step: 150 acc:0.47641 total_loss: 1.6113  loss:1.4441,stance loss: 0.85146 
Train step: 160 acc:0.48098 total_loss: 1.6104  loss:1.6291,stance loss: 1.2142 
Train step: 170 acc:0.48538 total_loss: 1.6008  loss:1.6268,stance loss: 1.3372 
Train step: 180 acc:0.49344 total_loss: 1.5952  loss:1.594,stance loss: 1.0147 
Train step: 190 acc:0.49607 total_loss: 1.5912  loss:1.5418,stance loss: 1.1892 
Train step: 200 acc:0.49627 total_loss: 1.5896  loss:1.3828,stance loss: 0.91194 
Better F1! Saving model!
Saving model of best f1: 0.29740518962075846
              precision    recall  f1-score   support

           0   0.423898  0.996656  0.594810       299
           1   0.750000  0.011538  0.022727       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.425743       707
   macro avg   0.391299  0.336065  0.205846       707
weighted avg   0.455085  0.425743  0.259911       707

Test Acc: 0.42574257425742573 F1_ma:0.29740518962075846
Train step: 210 acc:0.50207 total_loss: 1.5835  loss:1.4099,stance loss: 0.99107 
Train step: 220 acc:0.5065 total_loss: 1.5745  loss:1.4172,stance loss: 0.91784 
Better F1! Saving model!
Saving model of best f1: 0.29759519038076154
              precision    recall  f1-score   support

           0   0.424893  0.993311  0.595190       299
           1   0.625000  0.019231  0.037313       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.427157       707
   macro avg   0.349964  0.337514  0.210835       707
weighted avg   0.409537  0.427157  0.265436       707

Test Acc: 0.42715700141442714 F1_ma:0.29759519038076154
Train step: 230 acc:0.50785 total_loss: 1.5696  loss:1.1339,stance loss: 0.62745 
Train step: 240 acc:0.5096 total_loss: 1.5671  loss:1.6682,stance loss: 1.649 
Train step: 250 acc:0.51544 total_loss: 1.5618  loss:1.5872,stance loss: 1.167 
Train step: 260 acc:0.52006 total_loss: 1.5543  loss:0.59348,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.6 total_loss: 1.4003  loss:1.1239,stance loss: 0.74788 
Train step: 280 acc:0.59062 total_loss: 1.4101  loss:1.2697,stance loss: 0.90801 
Train step: 290 acc:0.60208 total_loss: 1.3681  loss:1.5303,stance loss: 1.012 
Train step: 300 acc:0.60938 total_loss: 1.3636  loss:1.4136,stance loss: 1.0265 
Train step: 310 acc:0.625 total_loss: 1.3452  loss:1.4194,stance loss: 1.1143 
Train step: 320 acc:0.62187 total_loss: 1.3621  loss:1.2507,stance loss: 0.87186 
Train step: 330 acc:0.62232 total_loss: 1.3691  loss:1.6111,stance loss: 1.2926 
Train step: 340 acc:0.62891 total_loss: 1.3668  loss:1.235,stance loss: 0.88604 
Train step: 350 acc:0.63194 total_loss: 1.3673  loss:1.3219,stance loss: 1.3592 
Better F1! Saving model!
Saving model of best f1: 0.29780876494023906
              precision    recall  f1-score   support

           0   0.424113  1.000000  0.595618       299
           1   1.000000  0.007692  0.015267       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.425743       707
   macro avg   0.474704  0.335897  0.203628       707
weighted avg   0.547114  0.425743  0.257509       707

Test Acc: 0.42574257425742573 F1_ma:0.29780876494023906
Train step: 360 acc:0.62875 total_loss: 1.3734  loss:1.4388,stance loss: 1.1437 
Better F1! Saving model!
Saving model of best f1: 0.29959514170040485
              precision    recall  f1-score   support

           0   0.429608  0.989967  0.599190       299
           1   0.722222  0.050000  0.093525       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.437058       707
   macro avg   0.383943  0.346656  0.230905       707
weighted avg   0.447285  0.437058  0.287800       707

Test Acc: 0.43705799151343705 F1_ma:0.29959514170040485
Train step: 370 acc:0.63239 total_loss: 1.3663  loss:1.2619,stance loss: 0.93694 
Train step: 380 acc:0.63646 total_loss: 1.3597  loss:1.4807,stance loss: 1.2274 
Train step: 390 acc:0.6399 total_loss: 1.355  loss:1.3697,stance loss: 1.4504 
Train step: 400 acc:0.63661 total_loss: 1.3602  loss:1.4448,stance loss: 1.1583 
Train step: 410 acc:0.63875 total_loss: 1.3613  loss:1.3893,stance loss: 1.122 
Train step: 420 acc:0.63984 total_loss: 1.3591  loss:1.2374,stance loss: 1.0177 
Train step: 430 acc:0.64191 total_loss: 1.3574  loss:1.2691,stance loss: 0.8341 
Train step: 440 acc:0.6441 total_loss: 1.3549  loss:1.1468,stance loss: 0.87155 
Train step: 450 acc:0.64243 total_loss: 1.3536  loss:1.2979,stance loss: 0.88849 
Train step: 460 acc:0.64594 total_loss: 1.35  loss:1.2062,stance loss: 0.92152 
Train step: 470 acc:0.64851 total_loss: 1.3442  loss:1.3437,stance loss: 1.044 
Train step: 480 acc:0.64972 total_loss: 1.3418  loss:0.92327,stance loss: 0.53878 
Train step: 490 acc:0.65 total_loss: 1.3424  loss:1.7353,stance loss: 1.3659 
Train step: 500 acc:0.64896 total_loss: 1.3401  loss:1.1306,stance loss: 0.81746 
Train step: 510 acc:0.64875 total_loss: 1.3366  loss:1.4026,stance loss: 1.1811 
Train step: 520 acc:0.64832 total_loss: 1.3338  loss:1.0854,stance loss: 0.96293 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.65972 total_loss: 1.3315  loss:1.2735,stance loss: 1.2868 
Train step: 540 acc:0.64145 total_loss: 1.3232  loss:1.2423,stance loss: 1.0218 
Train step: 550 acc:0.66595 total_loss: 1.292  loss:1.2156,stance loss: 0.9047 
Train step: 560 acc:0.67949 total_loss: 1.2704  loss:1.4512,stance loss: 1.0492 
Train step: 570 acc:0.68495 total_loss: 1.2678  loss:1.7874,stance loss: 1.8563 
Train step: 580 acc:0.68644 total_loss: 1.2694  loss:1.4426,stance loss: 1.065 
Train step: 590 acc:0.6875 total_loss: 1.2737  loss:1.1646,stance loss: 0.89468 
Train step: 600 acc:0.68829 total_loss: 1.2549  loss:1.1692,stance loss: 0.81637 
Train step: 610 acc:0.6882 total_loss: 1.2448  loss:1.0454,stance loss: 0.64459 
Train step: 620 acc:0.69255 total_loss: 1.2354  loss:1.0366,stance loss: 0.74776 
Train step: 630 acc:0.69266 total_loss: 1.2345  loss:1.1833,stance loss: 0.96175 
Train step: 640 acc:0.69065 total_loss: 1.2324  loss:1.1601,stance loss: 0.94415 
Train step: 650 acc:0.68992 total_loss: 1.2348  loss:0.88092,stance loss: 0.72247 
Train step: 660 acc:0.6875 total_loss: 1.2338  loss:1.0295,stance loss: 0.78784 
Train step: 670 acc:0.6875 total_loss: 1.2337  loss:1.6134,stance loss: 1.5991 
Train step: 680 acc:0.69182 total_loss: 1.2346  loss:1.2892,stance loss: 1.1477 
Train step: 690 acc:0.69416 total_loss: 1.2244  loss:1.0755,stance loss: 0.93529 
Train step: 700 acc:0.69448 total_loss: 1.219  loss:0.68574,stance loss: 0.45244 
Train step: 710 acc:0.69411 total_loss: 1.2214  loss:1.1564,stance loss: 1.0972 
Train step: 720 acc:0.6941 total_loss: 1.217  loss:1.0008,stance loss: 0.70408 
Train step: 730 acc:0.68959 total_loss: 1.2245  loss:1.8598,stance loss: 1.7598 
Train step: 740 acc:0.68978 total_loss: 1.2222  loss:1.1766,stance loss: 1.0224 
Train step: 750 acc:0.69378 total_loss: 1.2151  loss:1.4131,stance loss: 1.249 
Train step: 760 acc:0.69325 total_loss: 1.2184  loss:0.96199,stance loss: 0.84551 
Train step: 770 acc:0.69453 total_loss: 1.2184  loss:1.1108,stance loss: 0.94505 
Train step: 780 acc:0.69764 total_loss: 1.2146  loss:1.3176,stance loss: 1.0125 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.71875 total_loss: 1.0207  loss:1.1832,stance loss: 0.99454 
Train step: 800 acc:0.72917 total_loss: 1.1518  loss:0.76495,stance loss: 0.47788 
Train step: 810 acc:0.73884 total_loss: 1.0971  loss:0.92831,stance loss: 0.69819 
Train step: 820 acc:0.74178 total_loss: 1.0845  loss:0.95895,stance loss: 0.84631 
Train step: 830 acc:0.7513 total_loss: 1.0799  loss:1.6236,stance loss: 1.3985 
Train step: 840 acc:0.73815 total_loss: 1.0861  loss:1.276,stance loss: 0.96916 
Train step: 850 acc:0.73162 total_loss: 1.0967  loss:0.94828,stance loss: 0.76708 
Train step: 860 acc:0.73317 total_loss: 1.1002  loss:1.3889,stance loss: 1.6043 
Train step: 870 acc:0.73722 total_loss: 1.0921  loss:0.96864,stance loss: 0.72405 
Train step: 880 acc:0.73788 total_loss: 1.091  loss:1.5039,stance loss: 1.2775 
Train step: 890 acc:0.7338 total_loss: 1.0931  loss:1.2216,stance loss: 1.1305 
Train step: 900 acc:0.72775 total_loss: 1.095  loss:1.4751,stance loss: 0.98784 
Train step: 910 acc:0.72363 total_loss: 1.0991  loss:1.023,stance loss: 0.82512 
Train step: 920 acc:0.72418 total_loss: 1.093  loss:0.87701,stance loss: 0.65342 
Train step: 930 acc:0.72635 total_loss: 1.0873  loss:0.7424,stance loss: 0.56762 
Train step: 940 acc:0.72508 total_loss: 1.092  loss:1.2531,stance loss: 1.4725 
Train step: 950 acc:0.72396 total_loss: 1.0953  loss:1.4663,stance loss: 1.1179 
Train step: 960 acc:0.72261 total_loss: 1.1016  loss:1.7231,stance loss: 1.6776 
Train step: 970 acc:0.72241 total_loss: 1.1012  loss:1.1953,stance loss: 0.93273 
Train step: 980 acc:0.72348 total_loss: 1.0943  loss:0.95314,stance loss: 0.70685 
Train step: 990 acc:0.72206 total_loss: 1.1037  loss:1.0264,stance loss: 0.73564 
Train step: 1000 acc:0.72276 total_loss: 1.1055  loss:0.9254,stance loss: 0.77827 
Train step: 1010 acc:0.72286 total_loss: 1.1046  loss:0.99888,stance loss: 0.8231 
Train step: 1020 acc:0.72295 total_loss: 1.1092  loss:1.028,stance loss: 0.79318 
Train step: 1030 acc:0.71976 total_loss: 1.1114  loss:1.3673,stance loss: 0.96832 
Train step: 1040 acc:0.72093 total_loss: 1.1123  loss:1.3827,stance loss: 1.1085 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.77679 total_loss: 1.0666  loss:0.85536,stance loss: 0.74578 
Train step: 1060 acc:0.70588 total_loss: 1.1701  loss:1.7256,stance loss: 1.7894 
Train step: 1070 acc:0.72222 total_loss: 1.1139  loss:1.049,stance loss: 0.92369 
Train step: 1080 acc:0.73142 total_loss: 1.1138  loss:1.4293,stance loss: 1.5858 
Train step: 1090 acc:0.73138 total_loss: 1.0879  loss:0.82766,stance loss: 0.56436 
Train step: 1100 acc:0.73794 total_loss: 1.0872  loss:0.73811,stance loss: 0.52908 
Train step: 1110 acc:0.73974 total_loss: 1.0687  loss:0.95906,stance loss: 0.28777 
Train step: 1120 acc:0.73377 total_loss: 1.0693  loss:0.95617,stance loss: 0.84879 
Train step: 1130 acc:0.73491 total_loss: 1.08  loss:0.90376,stance loss: 0.66808 
Train step: 1140 acc:0.73905 total_loss: 1.0737  loss:1.022,stance loss: 0.71579 
Train step: 1150 acc:0.73072 total_loss: 1.0734  loss:1.2597,stance loss: 0.73714 
Train step: 1160 acc:0.73451 total_loss: 1.0615  loss:0.94697,stance loss: 0.5934 
Train step: 1170 acc:0.7377 total_loss: 1.0512  loss:1.1778,stance loss: 0.97668 
Train step: 1180 acc:0.74088 total_loss: 1.0383  loss:0.99486,stance loss: 0.60355 
Train step: 1190 acc:0.74192 total_loss: 1.0362  loss:1.3066,stance loss: 0.98034 
Train step: 1200 acc:0.74084 total_loss: 1.035  loss:0.70001,stance loss: 0.55475 
Train step: 1210 acc:0.74139 total_loss: 1.0349  loss:1.0374,stance loss: 0.92278 
Train step: 1220 acc:0.74223 total_loss: 1.0315  loss:0.67117,stance loss: 0.51448 
Train step: 1230 acc:0.74332 total_loss: 1.027  loss:0.8889,stance loss: 0.59255 
Train step: 1240 acc:0.74239 total_loss: 1.0294  loss:0.93461,stance loss: 0.71154 
Train step: 1250 acc:0.74185 total_loss: 1.034  loss:1.1636,stance loss: 0.95934 
Train step: 1260 acc:0.74194 total_loss: 1.0348  loss:0.99347,stance loss: 0.7417 
Train step: 1270 acc:0.74174 total_loss: 1.0351  loss:1.1072,stance loss: 0.87771 
Train step: 1280 acc:0.74209 total_loss: 1.0362  loss:1.1386,stance loss: 1.0093 
Train step: 1290 acc:0.74064 total_loss: 1.0333  loss:1.0951,stance loss: 0.89162 
Train step: 1300 acc:0.74173 total_loss: 1.0297  loss:0.75237,stance loss: 0.56458 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.73958 total_loss: 1.0249  loss:0.81317,stance loss: 0.58626 
Train step: 1320 acc:0.75391 total_loss: 0.94563  loss:0.87255,stance loss: 0.61766 
Train step: 1330 acc:0.76202 total_loss: 0.90749  loss:0.69183,stance loss: 0.56378 
Train step: 1340 acc:0.75521 total_loss: 0.94995  loss:0.87709,stance loss: 0.67808 
Train step: 1350 acc:0.76087 total_loss: 0.93073  loss:0.74322,stance loss: 0.6721 
Train step: 1360 acc:0.76339 total_loss: 0.9118  loss:0.74978,stance loss: 0.6205 
Train step: 1370 acc:0.76515 total_loss: 0.91156  loss:1.3648,stance loss: 1.1691 
Train step: 1380 acc:0.76069 total_loss: 0.92734  loss:0.85231,stance loss: 0.70092 
Train step: 1390 acc:0.75363 total_loss: 0.94806  loss:0.80778,stance loss: 0.61426 
Train step: 1400 acc:0.76172 total_loss: 0.93483  loss:0.61026,stance loss: 0.45775 
Train step: 1410 acc:0.75884 total_loss: 0.93507  loss:1.0248,stance loss: 0.7845 
Train step: 1420 acc:0.76239 total_loss: 0.92435  loss:0.97968,stance loss: 0.73105 
Train step: 1430 acc:0.76637 total_loss: 0.92029  loss:0.98813,stance loss: 0.80622 
Train step: 1440 acc:0.76654 total_loss: 0.91703  loss:0.43518,stance loss: 0.30072 
Train step: 1450 acc:0.76841 total_loss: 0.91323  loss:0.91597,stance loss: 0.74243 
Train step: 1460 acc:0.76442 total_loss: 0.92212  loss:1.1706,stance loss: 0.77999 
Train step: 1470 acc:0.76393 total_loss: 0.91812  loss:0.74646,stance loss: 0.667 
Train step: 1480 acc:0.76172 total_loss: 0.92196  loss:0.97078,stance loss: 0.60687 
Train step: 1490 acc:0.76277 total_loss: 0.91808  loss:1.1701,stance loss: 1.0345 
Train step: 1500 acc:0.76307 total_loss: 0.92229  loss:1.0591,stance loss: 0.85371 
Train step: 1510 acc:0.76335 total_loss: 0.92366  loss:0.88069,stance loss: 0.60128 
Train step: 1520 acc:0.7636 total_loss: 0.9252  loss:0.85539,stance loss: 0.74098 
Train step: 1530 acc:0.76244 total_loss: 0.92417  loss:0.95458,stance loss: 0.81907 
Train step: 1540 acc:0.76192 total_loss: 0.92485  loss:1.1875,stance loss: 1.5119 
Train step: 1550 acc:0.76245 total_loss: 0.9245  loss:0.6422,stance loss: 0.50373 
Train step: 1560 acc:0.76196 total_loss: 0.92435  loss:1.3501,stance loss: 1.2289 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.7625 total_loss: 0.83517  loss:0.91807,stance loss: 0.8632 
Train step: 1580 acc:0.79583 total_loss: 0.7372  loss:1.1558,stance loss: 1.0717 
Train step: 1590 acc:0.7775 total_loss: 0.78807  loss:0.41236,stance loss: 0.2235 
Train step: 1600 acc:0.77679 total_loss: 0.78895  loss:0.8362,stance loss: 0.51981 
Train step: 1610 acc:0.77778 total_loss: 0.7851  loss:0.45054,stance loss: 0.25011 
Train step: 1620 acc:0.77841 total_loss: 0.79135  loss:0.63393,stance loss: 0.3856 
Train step: 1630 acc:0.77885 total_loss: 0.806  loss:0.64687,stance loss: 0.46846 
Train step: 1640 acc:0.77833 total_loss: 0.80526  loss:0.40081,stance loss: 0.15372 
Train step: 1650 acc:0.77794 total_loss: 0.81534  loss:0.69635,stance loss: 0.46629 
Train step: 1660 acc:0.78289 total_loss: 0.80582  loss:0.19104,stance loss: 0.090852 
Train step: 1670 acc:0.78869 total_loss: 0.80458  loss:0.65923,stance loss: 0.49481 
Train step: 1680 acc:0.78804 total_loss: 0.8136  loss:0.57342,stance loss: 0.4837 
Train step: 1690 acc:0.785 total_loss: 0.81797  loss:1.0022,stance loss: 0.72909 
Train step: 1700 acc:0.7875 total_loss: 0.8197  loss:0.7161,stance loss: 0.53055 
Train step: 1710 acc:0.78578 total_loss: 0.82226  loss:0.97328,stance loss: 0.64958 
Train step: 1720 acc:0.78589 total_loss: 0.82962  loss:1.0155,stance loss: 0.64615 
Train step: 1730 acc:0.78636 total_loss: 0.83116  loss:1.1358,stance loss: 1.3319 
Train step: 1740 acc:0.78929 total_loss: 0.82124  loss:0.27164,stance loss: 0.13565 
Train step: 1750 acc:0.79088 total_loss: 0.82243  loss:1.1531,stance loss: 0.89121 
Train step: 1760 acc:0.78974 total_loss: 0.82429  loss:0.84518,stance loss: 0.5955 
Train step: 1770 acc:0.78841 total_loss: 0.82458  loss:1.065,stance loss: 0.83557 
Train step: 1780 acc:0.78837 total_loss: 0.82891  loss:1.0244,stance loss: 0.66869 
Train step: 1790 acc:0.78639 total_loss: 0.82611  loss:0.80809,stance loss: 0.72015 
Train step: 1800 acc:0.78803 total_loss: 0.82651  loss:0.81366,stance loss: 0.73009 
Train step: 1810 acc:0.78673 total_loss: 0.82921  loss:0.61412,stance loss: 0.49815 
Train step: 1820 acc:0.78725 total_loss: 0.83258  loss:0.65839,stance loss: 0.43673 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.8125 total_loss: 0.73346  loss:0.57789,stance loss: 0.44835 
Train step: 1840 acc:0.80804 total_loss: 0.73906  loss:0.64389,stance loss: 0.41506 
Train step: 1850 acc:0.8151 total_loss: 0.73736  loss:0.6909,stance loss: 0.55236 
Train step: 1860 acc:0.81801 total_loss: 0.75485  loss:0.55451,stance loss: 0.45894 
Train step: 1870 acc:0.82386 total_loss: 0.75295  loss:0.66468,stance loss: 0.52294 
Train step: 1880 acc:0.8206 total_loss: 0.75523  loss:0.58151,stance loss: 0.36548 
Train step: 1890 acc:0.81445 total_loss: 0.76697  loss:0.78922,stance loss: 0.63048 
Train step: 1900 acc:0.81588 total_loss: 0.77243  loss:0.72636,stance loss: 0.59756 
Train step: 1910 acc:0.81696 total_loss: 0.78316  loss:0.69631,stance loss: 0.55053 
Train step: 1920 acc:0.8125 total_loss: 0.77676  loss:0.68253,stance loss: 0.53098 
Train step: 1930 acc:0.81611 total_loss: 0.76314  loss:0.67984,stance loss: 0.46727 
Train step: 1940 acc:0.81689 total_loss: 0.76818  loss:0.49205,stance loss: 0.36941 
Train step: 1950 acc:0.81855 total_loss: 0.76868  loss:0.82835,stance loss: 0.64595 
Train step: 1960 acc:0.81856 total_loss: 0.7597  loss:0.79782,stance loss: 0.42337 
Train step: 1970 acc:0.81771 total_loss: 0.77027  loss:0.93441,stance loss: 0.74427 
Train step: 1980 acc:0.81859 total_loss: 0.76478  loss:0.57015,stance loss: 0.41836 
Train step: 1990 acc:0.81936 total_loss: 0.76382  loss:0.45845,stance loss: 0.3714 
Train step: 2000 acc:0.81932 total_loss: 0.7632  loss:0.45903,stance loss: 0.34612 
Train step: 2010 acc:0.81726 total_loss: 0.76147  loss:0.77719,stance loss: 0.51621 
Better F1! Saving model!
Saving model of best f1: 0.3487685947493021
              precision    recall  f1-score   support

           0   0.470588  0.508361  0.488746       299
           1   0.517143  0.696154  0.593443       260
           2   0.558824  0.128378  0.208791       148

    accuracy                       0.497878       707
   macro avg   0.515518  0.444298  0.430327       707
weighted avg   0.506180  0.497878  0.468644       707

Test Acc: 0.49787835926449786 F1_ma:0.3487685947493021
Train step: 2020 acc:0.81476 total_loss: 0.76568  loss:1.0312,stance loss: 0.71671 
Train step: 2030 acc:0.81403 total_loss: 0.76257  loss:0.74651,stance loss: 0.59565 
Train step: 2040 acc:0.81513 total_loss: 0.7635  loss:1.0696,stance loss: 1.1889 
Train step: 2050 acc:0.81641 total_loss: 0.7599  loss:0.7643,stance loss: 0.59502 
Train step: 2060 acc:0.81517 total_loss: 0.76537  loss:0.56212,stance loss: 0.58787 
Train step: 2070 acc:0.81455 total_loss: 0.76304  loss:1.148,stance loss: 0.80935 
Train step: 2080 acc:0.81471 total_loss: 0.76405  loss:0.35884,stance loss: 0.26091 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.83333 total_loss: 0.68867  loss:0.69291,stance loss: 0.54301 
Train step: 2100 acc:0.875 total_loss: 0.61  loss:0.73575,stance loss: 0.54354 
Train step: 2110 acc:0.86141 total_loss: 0.59743  loss:0.67201,stance loss: 0.60041 
Train step: 2120 acc:0.85985 total_loss: 0.61473  loss:1.1578,stance loss: 0.85806 
Train step: 2130 acc:0.84738 total_loss: 0.63667  loss:0.78852,stance loss: 0.58217 
Train step: 2140 acc:0.85613 total_loss: 0.62968  loss:0.65414,stance loss: 1.0368 
Train step: 2150 acc:0.85913 total_loss: 0.60844  loss:0.39233,stance loss: 0.35114 
Train step: 2160 acc:0.86644 total_loss: 0.59661  loss:0.48297,stance loss: 0.51013 
Train step: 2170 acc:0.86898 total_loss: 0.588  loss:0.7026,stance loss: 1.0327 
Train step: 2180 acc:0.86626 total_loss: 0.59767  loss:1.0433,stance loss: 0.89935 
Train step: 2190 acc:0.86772 total_loss: 0.61516  loss:1.1117,stance loss: 0.77001 
Train step: 2200 acc:0.87223 total_loss: 0.60295  loss:0.206,stance loss: 0.089816 
Train step: 2210 acc:0.86992 total_loss: 0.61173  loss:0.99887,stance loss: 1.131 
Train step: 2220 acc:0.86748 total_loss: 0.61767  loss:0.37859,stance loss: 0.26189 
Train step: 2230 acc:0.86582 total_loss: 0.62844  loss:1.0566,stance loss: 1.058 
Train step: 2240 acc:0.86479 total_loss: 0.63964  loss:0.82175,stance loss: 0.76544 
Train step: 2250 acc:0.86005 total_loss: 0.65178  loss:0.54168,stance loss: 0.33218 
Better F1! Saving model!
Saving model of best f1: 0.37960829493087556
              precision    recall  f1-score   support

           0   0.461126  0.575251  0.511905       299
           1   0.516892  0.588462  0.550360       260
           2   0.605263  0.155405  0.247312       148

    accuracy                       0.492221       707
   macro avg   0.527760  0.439706  0.436525       707
weighted avg   0.511807  0.492221  0.470658       707

Test Acc: 0.49222065063649223 F1_ma:0.37960829493087556
Train step: 2260 acc:0.86055 total_loss: 0.65161  loss:0.80694,stance loss: 0.58225 
Train step: 2270 acc:0.85827 total_loss: 0.65534  loss:0.7487,stance loss: 0.50485 
Train step: 2280 acc:0.85654 total_loss: 0.65572  loss:0.7346,stance loss: 0.4632 
Train step: 2290 acc:0.8556 total_loss: 0.65821  loss:0.17658,stance loss: 0.096755 
Train step: 2300 acc:0.85446 total_loss: 0.6666  loss:0.90204,stance loss: 0.82978 
Train step: 2310 acc:0.8523 total_loss: 0.66803  loss:0.37107,stance loss: 0.26495 
Train step: 2320 acc:0.85113 total_loss: 0.66761  loss:0.47569,stance loss: 0.40482 
Train step: 2330 acc:0.85082 total_loss: 0.66834  loss:1.1001,stance loss: 0.95509 
Train step: 2340 acc:0.85054 total_loss: 0.66463  loss:0.60424,stance loss: 0.51609 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.875 total_loss: 0.76262  loss:0.54319,stance loss: 0.38179 
Train step: 2360 acc:0.85938 total_loss: 0.71843  loss:1.174,stance loss: 1.4806 
Train step: 2370 acc:0.875 total_loss: 0.64547  loss:0.57678,stance loss: 0.42711 
Train step: 2380 acc:0.87305 total_loss: 0.62306  loss:0.73662,stance loss: 0.57003 
Train step: 2390 acc:0.87202 total_loss: 0.62375  loss:1.4541,stance loss: 1.7103 
Train step: 2400 acc:0.8726 total_loss: 0.61734  loss:0.62346,stance loss: 0.45902 
Train step: 2410 acc:0.87702 total_loss: 0.60252  loss:0.4872,stance loss: 0.40077 
Train step: 2420 acc:0.87674 total_loss: 0.58178  loss:0.53711,stance loss: 0.23047 
Train step: 2430 acc:0.875 total_loss: 0.56858  loss:0.4777,stance loss: 0.32278 
Train step: 2440 acc:0.87364 total_loss: 0.5594  loss:0.41106,stance loss: 0.31188 
Train step: 2450 acc:0.87194 total_loss: 0.56584  loss:0.25883,stance loss: 0.20338 
Train step: 2460 acc:0.87723 total_loss: 0.55602  loss:0.31097,stance loss: 0.21543 
Train step: 2470 acc:0.87398 total_loss: 0.57199  loss:1.0379,stance loss: 1.3797 
Train step: 2480 acc:0.86979 total_loss: 0.57463  loss:0.21518,stance loss: 0.051168 
Train step: 2490 acc:0.8684 total_loss: 0.57827  loss:0.39812,stance loss: 0.30696 
Train step: 2500 acc:0.86842 total_loss: 0.57492  loss:0.83968,stance loss: 0.79978 
Train step: 2510 acc:0.87114 total_loss: 0.56436  loss:0.1618,stance loss: 0.10696 
Train step: 2520 acc:0.87209 total_loss: 0.55882  loss:0.76263,stance loss: 0.58077 
Better F1! Saving model!
Saving model of best f1: 0.3816628670683384
              precision    recall  f1-score   support

           0   0.444223  0.745819  0.556804       299
           1   0.556213  0.361538  0.438228       260
           2   0.527778  0.128378  0.206522       148

    accuracy                       0.475248       707
   macro avg   0.509405  0.411912  0.400518       707
weighted avg   0.502898  0.475248  0.439871       707

Test Acc: 0.4752475247524752 F1_ma:0.3816628670683384
Train step: 2530 acc:0.87294 total_loss: 0.56416  loss:0.91114,stance loss: 0.84237 
Train step: 2540 acc:0.8724 total_loss: 0.56828  loss:0.56065,stance loss: 0.48831 
Train step: 2550 acc:0.87005 total_loss: 0.57663  loss:0.3443,stance loss: 0.19729 
Better F1! Saving model!
Saving model of best f1: 0.43690153105637763
              precision    recall  f1-score   support

           0   0.449036  0.545151  0.492447       299
           1   0.511719  0.503846  0.507752       260
           2   0.511364  0.304054  0.381356       148

    accuracy                       0.479491       707
   macro avg   0.490706  0.451017  0.460518       707
weighted avg   0.485135  0.479491  0.474820       707

Test Acc: 0.4794908062234795 F1_ma:0.43690153105637763
Train step: 2560 acc:0.86999 total_loss: 0.574  loss:0.88341,stance loss: 0.72726 
Train step: 2570 acc:0.87106 total_loss: 0.56989  loss:0.30903,stance loss: 0.27367 
Train step: 2580 acc:0.87177 total_loss: 0.56775  loss:0.34697,stance loss: 0.33254 
Train step: 2590 acc:0.87138 total_loss: 0.57115  loss:0.60362,stance loss: 0.53272 
Train step: 2600 acc:0.87054 total_loss: 0.57123  loss:0.58461,stance loss: 0.48075 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.40846  loss:0.40846,stance loss: 0.33966 
Train step: 2620 acc:0.90909 total_loss: 0.46269  loss:0.39784,stance loss: 0.29653 
Train step: 2630 acc:0.89583 total_loss: 0.50297  loss:0.59511,stance loss: 0.44271 
Train step: 2640 acc:0.89113 total_loss: 0.50813  loss:0.7261,stance loss: 0.79285 
Train step: 2650 acc:0.87652 total_loss: 0.58183  loss:0.83524,stance loss: 1.1686 
Train step: 2660 acc:0.88235 total_loss: 0.55367  loss:0.24646,stance loss: 0.13086 
Better F1! Saving model!
Saving model of best f1: 0.4623486045286993
              precision    recall  f1-score   support

           0   0.455090  0.508361  0.480253       299
           1   0.505576  0.523077  0.514178       260
           2   0.538462  0.378378  0.444444       148

    accuracy                       0.486563       707
   macro avg   0.499709  0.469939  0.479625       707
weighted avg   0.491109  0.486563  0.485233       707

Test Acc: 0.48656294200848654 F1_ma:0.4623486045286993
Train step: 2670 acc:0.88012 total_loss: 0.56732  loss:0.56153,stance loss: 0.36086 
Train step: 2680 acc:0.8794 total_loss: 0.56675  loss:0.18669,stance loss: 0.13396 
Train step: 2690 acc:0.88194 total_loss: 0.54918  loss:0.58249,stance loss: 0.74142 
Train step: 2700 acc:0.88118 total_loss: 0.53966  loss:0.59193,stance loss: 0.46513 
Train step: 2710 acc:0.88366 total_loss: 0.52718  loss:0.27769,stance loss: 0.21683 
Train step: 2720 acc:0.88232 total_loss: 0.52798  loss:0.55429,stance loss: 0.45416 
Train step: 2730 acc:0.88585 total_loss: 0.52654  loss:0.46069,stance loss: 0.39412 
Train step: 2740 acc:0.88884 total_loss: 0.52214  loss:0.47096,stance loss: 0.4384 
Train step: 2750 acc:0.88741 total_loss: 0.52546  loss:0.79835,stance loss: 0.72669 
Train step: 2760 acc:0.88866 total_loss: 0.52483  loss:0.75645,stance loss: 0.81534 
Train step: 2770 acc:0.89053 total_loss: 0.51475  loss:0.59554,stance loss: 0.51025 
Train step: 2780 acc:0.88999 total_loss: 0.51546  loss:0.36165,stance loss: 0.29477 
Train step: 2790 acc:0.89019 total_loss: 0.51879  loss:0.70941,stance loss: 0.52176 
Train step: 2800 acc:0.89136 total_loss: 0.51535  loss:0.67609,stance loss: 0.38361 
Train step: 2810 acc:0.89024 total_loss: 0.5188  loss:0.66392,stance loss: 1.0393 
Train step: 2820 acc:0.88892 total_loss: 0.51655  loss:0.24757,stance loss: 0.17571 
Train step: 2830 acc:0.88942 total_loss: 0.51261  loss:0.10289,stance loss: 0.049492 
Train step: 2840 acc:0.89015 total_loss: 0.51541  loss:0.66434,stance loss: 0.46169 
Train step: 2850 acc:0.8916 total_loss: 0.51662  loss:0.30913,stance loss: 0.29855 
Train step: 2860 acc:0.89218 total_loss: 0.51375  loss:0.68016,stance loss: 1.0818 
Train step: 2870 acc:0.89118 total_loss: 0.51323  loss:1.2459,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.875 total_loss: 0.45031  loss:1.0022,stance loss: 1.3444 
Train step: 2890 acc:0.875 total_loss: 0.47486  loss:0.37451,stance loss: 0.34212 
Train step: 2900 acc:0.88958 total_loss: 0.49657  loss:0.13703,stance loss: 0.044646 
Train step: 2910 acc:0.88906 total_loss: 0.47955  loss:0.22696,stance loss: 0.18565 
Train step: 2920 acc:0.89625 total_loss: 0.48613  loss:0.58722,stance loss: 1.0559 
Train step: 2930 acc:0.89896 total_loss: 0.47782  loss:0.34868,stance loss: 0.28703 
Train step: 2940 acc:0.90357 total_loss: 0.4586  loss:0.13235,stance loss: 0.069348 
Train step: 2950 acc:0.90547 total_loss: 0.45195  loss:0.21536,stance loss: 0.085797 
Train step: 2960 acc:0.90833 total_loss: 0.44746  loss:0.26409,stance loss: 0.25581 
Train step: 2970 acc:0.90438 total_loss: 0.46048  loss:0.066005,stance loss: 0.03029 
Train step: 2980 acc:0.90455 total_loss: 0.45411  loss:0.21102,stance loss: 0.14732 
Train step: 2990 acc:0.90365 total_loss: 0.45179  loss:0.19539,stance loss: 0.14939 
Train step: 3000 acc:0.90625 total_loss: 0.44699  loss:0.26458,stance loss: 0.23789 
Train step: 3010 acc:0.9067 total_loss: 0.44674  loss:0.33427,stance loss: 0.32769 
Train step: 3020 acc:0.90292 total_loss: 0.45381  loss:0.94164,stance loss: 1.2519 
Train step: 3030 acc:0.90156 total_loss: 0.45391  loss:0.088139,stance loss: 0.0047686 
Train step: 3040 acc:0.9 total_loss: 0.46077  loss:0.63105,stance loss: 0.47255 
Train step: 3050 acc:0.90208 total_loss: 0.45451  loss:0.42994,stance loss: 0.34103 
Train step: 3060 acc:0.90428 total_loss: 0.44594  loss:0.86142,stance loss: 1.2752 
Train step: 3070 acc:0.90344 total_loss: 0.4502  loss:0.18039,stance loss: 0.014816 
Train step: 3080 acc:0.90298 total_loss: 0.45656  loss:0.1273,stance loss: 0.085966 
Train step: 3090 acc:0.90227 total_loss: 0.45639  loss:0.58141,stance loss: 0.41801 
Train step: 3100 acc:0.9019 total_loss: 0.45553  loss:0.31258,stance loss: 0.22017 
Train step: 3110 acc:0.90104 total_loss: 0.45633  loss:0.43818,stance loss: 0.31812 
Train step: 3120 acc:0.903 total_loss: 0.44904  loss:0.22931,stance loss: 0.19542 
Train step: 3130 acc:0.9024 total_loss: 0.4536  loss:0.46726,stance loss: 0.22852 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.9375 total_loss: 0.32709  loss:0.25705,stance loss: 0.19755 
Train step: 3150 acc:0.9375 total_loss: 0.33382  loss:0.16579,stance loss: 0.1221 
Train step: 3160 acc:0.92457 total_loss: 0.39412  loss:0.38374,stance loss: 0.31068 
Train step: 3170 acc:0.92788 total_loss: 0.40802  loss:0.59577,stance loss: 1.012 
Train step: 3180 acc:0.92602 total_loss: 0.38937  loss:0.098908,stance loss: 0.029252 
Train step: 3190 acc:0.92479 total_loss: 0.39732  loss:0.515,stance loss: 0.43025 
Train step: 3200 acc:0.92572 total_loss: 0.39153  loss:0.47059,stance loss: 0.37813 
Train step: 3210 acc:0.92405 total_loss: 0.38988  loss:0.66205,stance loss: 0.55821 
Train step: 3220 acc:0.92346 total_loss: 0.38615  loss:0.19982,stance loss: 0.12586 
Train step: 3230 acc:0.92298 total_loss: 0.39509  loss:0.88066,stance loss: 1.0775 
Train step: 3240 acc:0.92317 total_loss: 0.3942  loss:0.22848,stance loss: 0.15121 
Train step: 3250 acc:0.92647 total_loss: 0.3862  loss:0.31057,stance loss: 0.31311 
Train step: 3260 acc:0.92587 total_loss: 0.39085  loss:0.23148,stance loss: 0.15617 
Train step: 3270 acc:0.92716 total_loss: 0.38422  loss:0.65316,stance loss: 0.6856 
Train step: 3280 acc:0.92534 total_loss: 0.39106  loss:0.43289,stance loss: 0.39881 
Train step: 3290 acc:0.9261 total_loss: 0.38873  loss:0.30473,stance loss: 0.24433 
Train step: 3300 acc:0.92788 total_loss: 0.38292  loss:0.087365,stance loss: 0.069069 
Train step: 3310 acc:0.92633 total_loss: 0.38692  loss:0.58838,stance loss: 1.0175 
Train step: 3320 acc:0.92593 total_loss: 0.38524  loss:0.54949,stance loss: 0.44666 
Train step: 3330 acc:0.92588 total_loss: 0.38065  loss:0.60912,stance loss: 0.63676 
Train step: 3340 acc:0.92554 total_loss: 0.38199  loss:0.18852,stance loss: 0.10379 
Train step: 3350 acc:0.92523 total_loss: 0.38551  loss:0.91343,stance loss: 0.92063 
Train step: 3360 acc:0.92549 total_loss: 0.3848  loss:0.91459,stance loss: 1.2428 
Train step: 3370 acc:0.92416 total_loss: 0.38845  loss:0.6632,stance loss: 0.63634 
Train step: 3380 acc:0.92369 total_loss: 0.39102  loss:0.90907,stance loss: 1.4149 
Train step: 3390 acc:0.92447 total_loss: 0.38943  loss:0.30748,stance loss: 0.23778 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.90625 total_loss: 0.32397  loss:0.2535,stance loss: 0.18964 
Train step: 3410 acc:0.91319 total_loss: 0.38887  loss:0.64542,stance loss: 0.55203 
Train step: 3420 acc:0.92188 total_loss: 0.33504  loss:0.33441,stance loss: 0.21756 
Train step: 3430 acc:0.92434 total_loss: 0.32316  loss:0.33296,stance loss: 0.21775 
Train step: 3440 acc:0.92057 total_loss: 0.32328  loss:0.45781,stance loss: 0.36698 
Train step: 3450 acc:0.92349 total_loss: 0.33082  loss:0.22641,stance loss: 0.14493 
Train step: 3460 acc:0.92923 total_loss: 0.31173  loss:0.2759,stance loss: 0.22813 
Train step: 3470 acc:0.92708 total_loss: 0.31698  loss:0.48528,stance loss: 0.50646 
Train step: 3480 acc:0.9304 total_loss: 0.31748  loss:0.85052,stance loss: 1.1064 
Train step: 3490 acc:0.93176 total_loss: 0.31652  loss:0.75424,stance loss: 1.2197 
Train step: 3500 acc:0.93287 total_loss: 0.31913  loss:0.058113,stance loss: 0.017392 
Train step: 3510 acc:0.93538 total_loss: 0.31006  loss:0.2881,stance loss: 0.24894 
Train step: 3520 acc:0.93604 total_loss: 0.31352  loss:0.04036,stance loss: 0.0047185 
Train step: 3530 acc:0.93705 total_loss: 0.31276  loss:0.25467,stance loss: 0.123 
Better F1! Saving model!
Saving model of best f1: 0.47876159307869137
              precision    recall  f1-score   support

           0   0.457516  0.702341  0.554090       299
           1   0.515337  0.323077  0.397163       260
           2   0.552941  0.317568  0.403433       148

    accuracy                       0.482320       707
   macro avg   0.508598  0.447662  0.451562       707
weighted avg   0.498756  0.482320  0.464842       707

Test Acc: 0.4823196605374823 F1_ma:0.47876159307869137
Train step: 3540 acc:0.93834 total_loss: 0.30617  loss:0.087796,stance loss: 0.041717 
Train step: 3550 acc:0.9379 total_loss: 0.3049  loss:0.39858,stance loss: 0.3792 
Train step: 3560 acc:0.93713 total_loss: 0.31174  loss:0.85346,stance loss: 0.66616 
Train step: 3570 acc:0.93785 total_loss: 0.30931  loss:0.59979,stance loss: 1.0441 
Train step: 3580 acc:0.93684 total_loss: 0.31011  loss:0.44076,stance loss: 0.36088 
Train step: 3590 acc:0.93592 total_loss: 0.32128  loss:0.37483,stance loss: 0.36608 
Train step: 3600 acc:0.936 total_loss: 0.31907  loss:0.11307,stance loss: 0.066379 
Train step: 3610 acc:0.93635 total_loss: 0.31727  loss:0.090146,stance loss: 0.028995 
Train step: 3620 acc:0.93586 total_loss: 0.31734  loss:0.52024,stance loss: 0.44295 
Train step: 3630 acc:0.93592 total_loss: 0.31725  loss:0.34068,stance loss: 0.16794 
Train step: 3640 acc:0.93624 total_loss: 0.3198  loss:0.57036,stance loss: 0.48796 
Train step: 3650 acc:0.93484 total_loss: 0.32558  loss:0.28118,stance loss: 0.25148 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.96429 total_loss: 0.21226  loss:0.039022,stance loss: 0.0034269 
Train step: 3670 acc:0.95588 total_loss: 0.22592  loss:0.12392,stance loss: 0.044498 
Train step: 3680 acc:0.96065 total_loss: 0.29548  loss:0.30435,stance loss: 0.28205 
Train step: 3690 acc:0.96284 total_loss: 0.25462  loss:0.11766,stance loss: 0.043676 
Train step: 3700 acc:0.96277 total_loss: 0.26135  loss:0.052819,stance loss: 0.007921 
Train step: 3710 acc:0.9682 total_loss: 0.2322  loss:0.040954,stance loss: 0.016639 
Train step: 3720 acc:0.96642 total_loss: 0.22908  loss:0.5633,stance loss: 0.48603 
Train step: 3730 acc:0.96753 total_loss: 0.21658  loss:0.054927,stance loss: 0.022869 
Train step: 3740 acc:0.96695 total_loss: 0.20797  loss:0.17096,stance loss: 0.13113 
Train step: 3750 acc:0.96778 total_loss: 0.20717  loss:0.30975,stance loss: 0.30953 
Train step: 3760 acc:0.96612 total_loss: 0.21632  loss:0.076635,stance loss: 0.034023 
Train step: 3770 acc:0.96368 total_loss: 0.22895  loss:0.30971,stance loss: 0.30954 
Train step: 3780 acc:0.96457 total_loss: 0.2287  loss:0.036433,stance loss: 0.0073843 
Train step: 3790 acc:0.96442 total_loss: 0.22835  loss:0.20085,stance loss: 0.20555 
Train step: 3800 acc:0.96514 total_loss: 0.22659  loss:0.050107,stance loss: 0.0013678 
Train step: 3810 acc:0.96099 total_loss: 0.24067  loss:0.78558,stance loss: 1.2905 
Train step: 3820 acc:0.95921 total_loss: 0.25098  loss:1.3802,stance loss: 1.7085 
Train step: 3830 acc:0.95939 total_loss: 0.25452  loss:0.13132,stance loss: 0.092788 
Train step: 3840 acc:0.95989 total_loss: 0.2531  loss:0.1752,stance loss: 0.15885 
Train step: 3850 acc:0.96066 total_loss: 0.24713  loss:0.05584,stance loss: 0.02254 
Train step: 3860 acc:0.96045 total_loss: 0.25038  loss:0.35862,stance loss: 0.263 
Train step: 3870 acc:0.95997 total_loss: 0.2522  loss:0.51007,stance loss: 0.48281 
Train step: 3880 acc:0.95898 total_loss: 0.25962  loss:0.31662,stance loss: 0.38144 
Train step: 3890 acc:0.9586 total_loss: 0.25819  loss:0.17985,stance loss: 0.11725 
Train step: 3900 acc:0.95901 total_loss: 0.25898  loss:0.062134,stance loss: 0.0049298 
Train step: 3910 acc:0.95793 total_loss: 0.26499  loss:0.56917,stance loss: 1.0179 
Training finished.


Reload the best model with best f1 0.47876159307869137 from path test_outputs/bert-cross-topic/dt/2023-08-14 13-36-58/state_dict


              precision    recall  f1-score   support

           0   0.457516  0.702341  0.554090       299
           1   0.515337  0.323077  0.397163       260
           2   0.552941  0.317568  0.403433       148

    accuracy                       0.482320       707
   macro avg   0.508598  0.447662  0.451562       707
weighted avg   0.498756  0.482320  0.464842       707

Test Acc: 0.4823196605374823 F1_ma:0.47876159307869137
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.47876159307869137
acc: 0.4823196605374823, f1 :0.45156210224158616
classification report: 
              precision    recall  f1-score   support

         Con     0.4575    0.7023    0.5541       299
        None     0.5153    0.3231    0.3972       260
         Pro     0.5529    0.3176    0.4034       148

    accuracy                         0.4823       707
   macro avg     0.5086    0.4477    0.4516       707
weighted avg     0.4988    0.4823    0.4648       707

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 13-55-50', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 13-55-50
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.9909  loss:1.9909,stance loss: 1.5687 
Train step: 10 acc:0.32955 total_loss: 1.7987  loss:1.9296,stance loss: 1.6893 
Better F1! Saving model!
Saving model of best f1: 0.26578073089701
              precision    recall  f1-score   support

           0   0.397351  0.802676  0.531561       299
           1   0.029412  0.011538  0.016575       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.343706       707
   macro avg   0.142254  0.271405  0.182712       707
weighted avg   0.178861  0.343706  0.230900       707

Test Acc: 0.3437057991513437 F1_ma:0.26578073089701
Train step: 20 acc:0.38095 total_loss: 1.7379  loss:1.59,stance loss: 1.0838 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 30 acc:0.41935 total_loss: 1.6959  loss:1.4908,stance loss: 1.0185 
Train step: 40 acc:0.44817 total_loss: 1.6698  loss:1.4982,stance loss: 1.072 
Train step: 50 acc:0.45098 total_loss: 1.6526  loss:1.3536,stance loss: 0.96227 
Train step: 60 acc:0.45594 total_loss: 1.6493  loss:1.6069,stance loss: 1.067 
Train step: 70 acc:0.45158 total_loss: 1.6509  loss:1.8523,stance loss: 1.4703 
Train step: 80 acc:0.4537 total_loss: 1.644  loss:1.4448,stance loss: 0.95597 
Train step: 90 acc:0.46635 total_loss: 1.6293  loss:1.5642,stance loss: 1.1705 
Train step: 100 acc:0.47401 total_loss: 1.6187  loss:1.5421,stance loss: 1.4895 
Train step: 110 acc:0.47804 total_loss: 1.6062  loss:1.3079,stance loss: 0.74905 
Train step: 120 acc:0.47572 total_loss: 1.5955  loss:1.5862,stance loss: 1.1285 
Better F1! Saving model!
Saving model of best f1: 0.2975124378109452
              precision    recall  f1-score   support

           0   0.423513  1.000000  0.595025       299
           1   1.000000  0.003846  0.007663       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.474504  0.334615  0.200896       707
weighted avg   0.546860  0.424328  0.254462       707

Test Acc: 0.4243281471004243 F1_ma:0.2975124378109452
Train step: 130 acc:0.47567 total_loss: 1.5884  loss:1.6096,stance loss: 1.1522 
Train step: 140 acc:0.48183 total_loss: 1.5816  loss:1.9348,stance loss: 1.7512 
Train step: 150 acc:0.48344 total_loss: 1.5756  loss:1.275,stance loss: 0.73347 
Train step: 160 acc:0.49146 total_loss: 1.5678  loss:1.1775,stance loss: 0.78037 
Train step: 170 acc:0.49159 total_loss: 1.5664  loss:1.6087,stance loss: 1.712 
Train step: 180 acc:0.49551 total_loss: 1.5577  loss:1.5866,stance loss: 1.1962 
Train step: 190 acc:0.49575 total_loss: 1.5509  loss:1.4082,stance loss: 0.85231 
Train step: 200 acc:0.49782 total_loss: 1.5487  loss:1.582,stance loss: 1.6662 
Train step: 210 acc:0.50267 total_loss: 1.5412  loss:1.3794,stance loss: 1.2313 
Better F1! Saving model!
Saving model of best f1: 0.2981056829511466
              precision    recall  f1-score   support

           0   0.424716  1.000000  0.596211       299
           1   1.000000  0.011538  0.022814       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.427157       707
   macro avg   0.474905  0.337179  0.206342       707
weighted avg   0.547369  0.427157  0.260536       707

Test Acc: 0.42715700141442714 F1_ma:0.2981056829511466
Train step: 220 acc:0.50735 total_loss: 1.5349  loss:1.2244,stance loss: 0.79941 
Train step: 230 acc:0.50974 total_loss: 1.526  loss:1.2743,stance loss: 0.79356 
Train step: 240 acc:0.51608 total_loss: 1.5234  loss:1.3747,stance loss: 1.0126 
Train step: 250 acc:0.52092 total_loss: 1.5155  loss:1.3435,stance loss: 0.95746 
Train step: 260 acc:0.52534 total_loss: 1.51  loss:3.7508,stance loss: 5.4086 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.58125 total_loss: 1.363  loss:1.3998,stance loss: 1.1867 
Train step: 280 acc:0.60313 total_loss: 1.3386  loss:1.2334,stance loss: 0.92726 
Train step: 290 acc:0.61875 total_loss: 1.3134  loss:1.248,stance loss: 0.91914 
Train step: 300 acc:0.6375 total_loss: 1.2956  loss:1.1049,stance loss: 0.77876 
Train step: 310 acc:0.645 total_loss: 1.3008  loss:1.1258,stance loss: 0.6704 
Train step: 320 acc:0.64479 total_loss: 1.3083  loss:1.3527,stance loss: 1.2291 
Train step: 330 acc:0.64286 total_loss: 1.3061  loss:1.4394,stance loss: 1.1073 
Train step: 340 acc:0.65469 total_loss: 1.2941  loss:0.86539,stance loss: 0.54244 
Train step: 350 acc:0.65556 total_loss: 1.3042  loss:1.2243,stance loss: 0.92502 
Train step: 360 acc:0.65938 total_loss: 1.3032  loss:1.0581,stance loss: 0.8049 
Train step: 370 acc:0.6642 total_loss: 1.2938  loss:1.2459,stance loss: 0.92781 
Train step: 380 acc:0.66771 total_loss: 1.2914  loss:1.1677,stance loss: 0.88462 
Train step: 390 acc:0.66587 total_loss: 1.2891  loss:1.3455,stance loss: 1.0663 
Train step: 400 acc:0.66696 total_loss: 1.2934  loss:1.5864,stance loss: 1.6711 
Train step: 410 acc:0.66417 total_loss: 1.2916  loss:1.452,stance loss: 1.2578 
Train step: 420 acc:0.66133 total_loss: 1.2972  loss:1.6686,stance loss: 1.5593 
Train step: 430 acc:0.66507 total_loss: 1.293  loss:0.87705,stance loss: 0.7552 
Train step: 440 acc:0.66667 total_loss: 1.2943  loss:1.4168,stance loss: 1.5047 
Train step: 450 acc:0.6648 total_loss: 1.2967  loss:1.0944,stance loss: 0.83791 
Train step: 460 acc:0.66469 total_loss: 1.2941  loss:1.1192,stance loss: 0.87709 
Train step: 470 acc:0.66429 total_loss: 1.2961  loss:1.3347,stance loss: 1.1265 
Train step: 480 acc:0.66222 total_loss: 1.2972  loss:1.6579,stance loss: 1.7339 
Train step: 490 acc:0.66087 total_loss: 1.2949  loss:1.2873,stance loss: 0.88657 
Train step: 500 acc:0.66276 total_loss: 1.2914  loss:1.0598,stance loss: 0.83717 
Train step: 510 acc:0.663 total_loss: 1.2919  loss:1.3107,stance loss: 0.98011 
Train step: 520 acc:0.66274 total_loss: 1.2914  loss:1.8624,stance loss: 2.2163 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.70139 total_loss: 1.189  loss:1.1204,stance loss: 0.84098 
Train step: 540 acc:0.68092 total_loss: 1.1657  loss:1.2729,stance loss: 0.87767 
Train step: 550 acc:0.6875 total_loss: 1.1795  loss:1.0989,stance loss: 0.77808 
Train step: 560 acc:0.69231 total_loss: 1.1623  loss:1.3207,stance loss: 1.4927 
Train step: 570 acc:0.70408 total_loss: 1.1679  loss:1.0412,stance loss: 0.755 
Train step: 580 acc:0.70339 total_loss: 1.1594  loss:1.1728,stance loss: 0.75605 
Train step: 590 acc:0.70109 total_loss: 1.1527  loss:1.4423,stance loss: 1.2192 
Train step: 600 acc:0.70016 total_loss: 1.1614  loss:1.0446,stance loss: 1.004 
Train step: 610 acc:0.70365 total_loss: 1.1645  loss:1.1913,stance loss: 0.95733 
Train step: 620 acc:0.69823 total_loss: 1.1818  loss:1.4143,stance loss: 1.148 
Train step: 630 acc:0.69323 total_loss: 1.1832  loss:1.0783,stance loss: 0.72021 
Train step: 640 acc:0.69433 total_loss: 1.1837  loss:1.0316,stance loss: 0.73541 
Train step: 650 acc:0.69622 total_loss: 1.1727  loss:1.009,stance loss: 0.72461 
Train step: 660 acc:0.69514 total_loss: 1.181  loss:1.1829,stance loss: 0.94496 
Train step: 670 acc:0.69715 total_loss: 1.1785  loss:0.98263,stance loss: 0.67777 
Train step: 680 acc:0.69418 total_loss: 1.1801  loss:0.99299,stance loss: 0.66247 
Train step: 690 acc:0.69268 total_loss: 1.1837  loss:1.1361,stance loss: 1.039 
Train step: 700 acc:0.69483 total_loss: 1.1823  loss:1.2539,stance loss: 0.96605 
Train step: 710 acc:0.69544 total_loss: 1.1812  loss:1.2274,stance loss: 1.3694 
Train step: 720 acc:0.69504 total_loss: 1.1906  loss:1.5921,stance loss: 1.6519 
Train step: 730 acc:0.69677 total_loss: 1.1888  loss:0.64586,stance loss: 0.44673 
Train step: 740 acc:0.70006 total_loss: 1.1823  loss:1.3203,stance loss: 1.5698 
Train step: 750 acc:0.70142 total_loss: 1.1798  loss:1.0787,stance loss: 0.83677 
Train step: 760 acc:0.70345 total_loss: 1.1775  loss:1.2302,stance loss: 1.0309 
Train step: 770 acc:0.70256 total_loss: 1.1762  loss:1.0588,stance loss: 0.69363 
Train step: 780 acc:0.70415 total_loss: 1.1745  loss:0.71405,stance loss: 0.41273 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.75 total_loss: 0.98032  loss:0.96025,stance loss: 0.57622 
Train step: 800 acc:0.74306 total_loss: 0.99587  loss:1.1186,stance loss: 1.1448 
Train step: 810 acc:0.72768 total_loss: 1.0873  loss:1.2002,stance loss: 0.7912 
Train step: 820 acc:0.72039 total_loss: 1.1169  loss:0.98214,stance loss: 0.7632 
Train step: 830 acc:0.72526 total_loss: 1.1183  loss:1.089,stance loss: 1.1214 
Train step: 840 acc:0.71767 total_loss: 1.1253  loss:1.4842,stance loss: 1.6565 
Train step: 850 acc:0.71967 total_loss: 1.1275  loss:0.63361,stance loss: 0.4992 
Train step: 860 acc:0.72356 total_loss: 1.1128  loss:1.177,stance loss: 1.0462 
Train step: 870 acc:0.72372 total_loss: 1.1115  loss:0.93277,stance loss: 0.76957 
Train step: 880 acc:0.7213 total_loss: 1.1139  loss:1.2215,stance loss: 0.96218 
Train step: 890 acc:0.71875 total_loss: 1.107  loss:1.1091,stance loss: 0.84238 
Train step: 900 acc:0.71981 total_loss: 1.1076  loss:0.71302,stance loss: 0.46 
Train step: 910 acc:0.72021 total_loss: 1.1035  loss:0.79129,stance loss: 0.6392 
Train step: 920 acc:0.72237 total_loss: 1.0985  loss:1.1434,stance loss: 1.2506 
Train step: 930 acc:0.7272 total_loss: 1.0859  loss:1.1977,stance loss: 0.91459 
Train step: 940 acc:0.72745 total_loss: 1.0845  loss:1.1988,stance loss: 0.98288 
Train step: 950 acc:0.72879 total_loss: 1.0759  loss:1.018,stance loss: 0.80559 
Train step: 960 acc:0.73069 total_loss: 1.0755  loss:1.075,stance loss: 1.2185 
Train step: 970 acc:0.73238 total_loss: 1.0748  loss:1.2962,stance loss: 1.4256 
Train step: 980 acc:0.73138 total_loss: 1.0734  loss:0.97783,stance loss: 0.76748 
Train step: 990 acc:0.73167 total_loss: 1.0691  loss:0.75009,stance loss: 0.48099 
Train step: 1000 acc:0.7328 total_loss: 1.0674  loss:0.90257,stance loss: 0.77409 
Train step: 1010 acc:0.73081 total_loss: 1.0663  loss:1.0687,stance loss: 0.84825 
Train step: 1020 acc:0.73057 total_loss: 1.0652  loss:1.2272,stance loss: 1.1217 
Train step: 1030 acc:0.72883 total_loss: 1.0651  loss:1.5971,stance loss: 1.4101 
Train step: 1040 acc:0.73062 total_loss: 1.0603  loss:0.75074,stance loss: 0.56013 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.77679 total_loss: 0.88869  loss:1.0737,stance loss: 0.79563 
Train step: 1060 acc:0.76471 total_loss: 0.96249  loss:1.61,stance loss: 1.8811 
Train step: 1070 acc:0.76852 total_loss: 0.91578  loss:0.80151,stance loss: 0.66386 
Train step: 1080 acc:0.77196 total_loss: 0.91399  loss:0.80153,stance loss: 0.67715 
Train step: 1090 acc:0.76995 total_loss: 0.90043  loss:0.77197,stance loss: 0.62582 
Train step: 1100 acc:0.76096 total_loss: 0.93217  loss:1.0688,stance loss: 0.84218 
Train step: 1110 acc:0.76772 total_loss: 0.93521  loss:0.4471,stance loss: 0.26324 
Train step: 1120 acc:0.75812 total_loss: 0.95611  loss:1.1002,stance loss: 0.71936 
Train step: 1130 acc:0.76006 total_loss: 0.94623  loss:0.82769,stance loss: 0.48226 
Train step: 1140 acc:0.76224 total_loss: 0.93361  loss:0.5464,stance loss: 0.47432 
Train step: 1150 acc:0.76168 total_loss: 0.9283  loss:0.85785,stance loss: 0.659 
Train step: 1160 acc:0.75374 total_loss: 0.94901  loss:0.88913,stance loss: 0.36953 
Train step: 1170 acc:0.75295 total_loss: 0.95739  loss:1.6143,stance loss: 1.3983 
Train step: 1180 acc:0.75182 total_loss: 0.95387  loss:1.0131,stance loss: 0.63946 
Train step: 1190 acc:0.75425 total_loss: 0.95753  loss:0.78919,stance loss: 0.79349 
Train step: 1200 acc:0.75478 total_loss: 0.96155  loss:1.2459,stance loss: 1.3892 
Train step: 1210 acc:0.75898 total_loss: 0.9548  loss:0.74583,stance loss: 0.75529 
Train step: 1220 acc:0.75989 total_loss: 0.95318  loss:1.0561,stance loss: 0.80079 
Train step: 1230 acc:0.75802 total_loss: 0.95823  loss:0.74392,stance loss: 0.55389 
Train step: 1240 acc:0.7592 total_loss: 0.95594  loss:1.0951,stance loss: 0.86032 
Train step: 1250 acc:0.75936 total_loss: 0.95498  loss:0.84754,stance loss: 0.71048 
Better F1! Saving model!
Saving model of best f1: 0.29955905272360966
              precision    recall  f1-score   support

           0   0.463215  0.568562  0.510511       299
           1   0.530303  0.673077  0.593220       260
           2   0.700000  0.047297  0.088608       148

    accuracy                       0.497878       707
   macro avg   0.564506  0.429645  0.397446       707
weighted avg   0.537454  0.497878  0.452608       707

Test Acc: 0.49787835926449786 F1_ma:0.29955905272360966
Train step: 1260 acc:0.75893 total_loss: 0.95293  loss:0.60281,stance loss: 0.5305 
Better F1! Saving model!
Saving model of best f1: 0.3098540145985402
              precision    recall  f1-score   support

           0   0.461140  0.595318  0.519708       299
           1   0.533981  0.634615  0.579965       260
           2   0.666667  0.054054  0.100000       148

    accuracy                       0.496464       707
   macro avg   0.553929  0.427996  0.399891       707
weighted avg   0.530951  0.496464  0.454008       707

Test Acc: 0.49646393210749645 F1_ma:0.3098540145985402
Train step: 1270 acc:0.75606 total_loss: 0.96078  loss:1.1804,stance loss: 0.83241 
Train step: 1280 acc:0.75818 total_loss: 0.95361  loss:0.90326,stance loss: 0.75458 
Train step: 1290 acc:0.75658 total_loss: 0.95845  loss:0.80825,stance loss: 0.63984 
Train step: 1300 acc:0.75535 total_loss: 0.96159  loss:0.92895,stance loss: 0.71816 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.79167 total_loss: 0.83209  loss:1.0011,stance loss: 0.75979 
Better F1! Saving model!
Saving model of best f1: 0.3229843433805517
              precision    recall  f1-score   support

           0   0.463918  0.602007  0.524017       299
           1   0.537954  0.626923  0.579041       260
           2   0.625000  0.067568  0.121951       148

    accuracy                       0.499293       707
   macro avg   0.542290  0.432166  0.408337       707
weighted avg   0.524865  0.499293  0.460086       707

Test Acc: 0.49929278642149927 F1_ma:0.3229843433805517
Train step: 1320 acc:0.78516 total_loss: 0.76723  loss:0.46029,stance loss: 0.34861 
Train step: 1330 acc:0.77163 total_loss: 0.84337  loss:1.1015,stance loss: 0.93566 
Train step: 1340 acc:0.77431 total_loss: 0.83142  loss:0.62146,stance loss: 0.40159 
Train step: 1350 acc:0.77853 total_loss: 0.83716  loss:0.46384,stance loss: 0.24865 
Train step: 1360 acc:0.78013 total_loss: 0.82711  loss:0.9244,stance loss: 0.50027 
Train step: 1370 acc:0.78125 total_loss: 0.82619  loss:0.76099,stance loss: 0.60325 
Better F1! Saving model!
Saving model of best f1: 0.3456942172616184
              precision    recall  f1-score   support

           0   0.483871  0.401338  0.438757       299
           1   0.501199  0.803846  0.617430       260
           2   0.571429  0.162162  0.252632       148

    accuracy                       0.499293       707
   macro avg   0.518833  0.455782  0.436273       707
weighted avg   0.508572  0.499293  0.465501       707

Test Acc: 0.49929278642149927 F1_ma:0.3456942172616184
Train step: 1380 acc:0.78454 total_loss: 0.83143  loss:0.48872,stance loss: 0.3803 
Train step: 1390 acc:0.78706 total_loss: 0.82397  loss:0.47419,stance loss: 0.36792 
Train step: 1400 acc:0.7819 total_loss: 0.83903  loss:0.5001,stance loss: 0.34551 
Train step: 1410 acc:0.78892 total_loss: 0.83192  loss:0.42999,stance loss: 0.25424 
Better F1! Saving model!
Saving model of best f1: 0.4345671316138081
              precision    recall  f1-score   support

           0   0.477064  0.521739  0.498403       299
           1   0.520124  0.646154  0.576329       260
           2   0.666667  0.256757  0.370732       148

    accuracy                       0.512023       707
   macro avg   0.554618  0.474883  0.481821       707
weighted avg   0.532590  0.512023  0.500334       707

Test Acc: 0.512022630834512 F1_ma:0.4345671316138081
Train step: 1420 acc:0.78933 total_loss: 0.84243  loss:1.5126,stance loss: 1.7905 
Train step: 1430 acc:0.79067 total_loss: 0.83111  loss:0.31518,stance loss: 0.11601 
Train step: 1440 acc:0.7955 total_loss: 0.82098  loss:0.46384,stance loss: 0.29983 
Train step: 1450 acc:0.79709 total_loss: 0.81778  loss:1.0704,stance loss: 1.1067 
Train step: 1460 acc:0.79527 total_loss: 0.81528  loss:0.79597,stance loss: 0.69424 
Train step: 1470 acc:0.79631 total_loss: 0.82336  loss:0.98307,stance loss: 0.7718 
Train step: 1480 acc:0.79297 total_loss: 0.82839  loss:0.68294,stance loss: 0.59948 
Train step: 1490 acc:0.79435 total_loss: 0.82704  loss:0.63722,stance loss: 0.46365 
Train step: 1500 acc:0.79464 total_loss: 0.82674  loss:0.5971,stance loss: 0.47889 
Train step: 1510 acc:0.79399 total_loss: 0.82823  loss:1.2035,stance loss: 1.4089 
Train step: 1520 acc:0.79369 total_loss: 0.8256  loss:0.83821,stance loss: 0.68507 
Train step: 1530 acc:0.79314 total_loss: 0.83061  loss:0.6071,stance loss: 0.52799 
Train step: 1540 acc:0.79211 total_loss: 0.83693  loss:0.84277,stance loss: 0.78547 
Train step: 1550 acc:0.79217 total_loss: 0.83309  loss:0.53723,stance loss: 0.38487 
Better F1! Saving model!
Saving model of best f1: 0.4606353001451627
              precision    recall  f1-score   support

           0   0.477509  0.461538  0.469388       299
           1   0.516820  0.650000  0.575809       260
           2   0.593407  0.364865  0.451883       148

    accuracy                       0.510608       707
   macro avg   0.529245  0.492134  0.499027       707
weighted avg   0.516227  0.510608  0.504860       707

Test Acc: 0.5106082036775106 F1_ma:0.4606353001451627
Train step: 1560 acc:0.79492 total_loss: 0.82839  loss:0.74154,stance loss: 0.56071 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.825 total_loss: 0.73409  loss:0.78244,stance loss: 1.1367 
Train step: 1580 acc:0.80417 total_loss: 0.88503  loss:1.1629,stance loss: 0.97021 
Train step: 1590 acc:0.815 total_loss: 0.86489  loss:0.68282,stance loss: 0.59776 
Train step: 1600 acc:0.83036 total_loss: 0.80312  loss:0.34048,stance loss: 0.1832 
Train step: 1610 acc:0.82639 total_loss: 0.81683  loss:0.57343,stance loss: 0.4027 
Train step: 1620 acc:0.82955 total_loss: 0.80877  loss:0.71123,stance loss: 1.0497 
Train step: 1630 acc:0.83269 total_loss: 0.77392  loss:0.31242,stance loss: 0.20689 
Train step: 1640 acc:0.835 total_loss: 0.76139  loss:0.64547,stance loss: 0.45163 
Train step: 1650 acc:0.83309 total_loss: 0.74436  loss:0.48215,stance loss: 0.35714 
Train step: 1660 acc:0.83684 total_loss: 0.72757  loss:0.79143,stance loss: 0.62322 
Train step: 1670 acc:0.8369 total_loss: 0.72841  loss:1.0122,stance loss: 0.74208 
Train step: 1680 acc:0.83696 total_loss: 0.72451  loss:0.43349,stance loss: 0.30566 
Train step: 1690 acc:0.837 total_loss: 0.7322  loss:0.44866,stance loss: 0.28826 
Train step: 1700 acc:0.83565 total_loss: 0.73183  loss:0.8552,stance loss: 0.67732 
Train step: 1710 acc:0.8375 total_loss: 0.72221  loss:0.48513,stance loss: 0.29867 
Train step: 1720 acc:0.83911 total_loss: 0.71726  loss:0.64425,stance loss: 0.56506 
Train step: 1730 acc:0.8375 total_loss: 0.71757  loss:0.69165,stance loss: 0.63515 
Train step: 1740 acc:0.83643 total_loss: 0.72468  loss:0.85646,stance loss: 0.60015 
Train step: 1750 acc:0.83176 total_loss: 0.73069  loss:0.58152,stance loss: 0.28174 
Train step: 1760 acc:0.83141 total_loss: 0.73335  loss:0.6547,stance loss: 0.5173 
Train step: 1770 acc:0.83049 total_loss: 0.73551  loss:0.82051,stance loss: 0.60682 
Train step: 1780 acc:0.83198 total_loss: 0.73383  loss:1.1809,stance loss: 1.5044 
Train step: 1790 acc:0.83306 total_loss: 0.72752  loss:0.47326,stance loss: 0.36749 
Train step: 1800 acc:0.83378 total_loss: 0.72495  loss:0.8671,stance loss: 0.75307 
Train step: 1810 acc:0.83418 total_loss: 0.72309  loss:0.72188,stance loss: 0.42623 
Train step: 1820 acc:0.83554 total_loss: 0.71684  loss:0.40571,stance loss: 0.32064 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.85938 total_loss: 0.64535  loss:0.51641,stance loss: 0.37706 
Train step: 1840 acc:0.87054 total_loss: 0.59375  loss:0.42571,stance loss: 0.36425 
Train step: 1850 acc:0.89062 total_loss: 0.52168  loss:0.37058,stance loss: 0.26819 
Train step: 1860 acc:0.87868 total_loss: 0.53154  loss:0.64272,stance loss: 0.50543 
Train step: 1870 acc:0.87926 total_loss: 0.55091  loss:0.28862,stance loss: 0.17382 
Train step: 1880 acc:0.87384 total_loss: 0.55777  loss:0.55828,stance loss: 0.30515 
Train step: 1890 acc:0.87793 total_loss: 0.58569  loss:0.88518,stance loss: 1.1952 
Train step: 1900 acc:0.88091 total_loss: 0.58579  loss:0.6,stance loss: 0.46818 
Train step: 1910 acc:0.88021 total_loss: 0.58659  loss:0.41487,stance loss: 0.18285 
Train step: 1920 acc:0.88298 total_loss: 0.57403  loss:0.24102,stance loss: 0.10172 
Train step: 1930 acc:0.88221 total_loss: 0.57649  loss:0.41198,stance loss: 0.30271 
Train step: 1940 acc:0.87993 total_loss: 0.57255  loss:0.26276,stance loss: 0.13104 
Train step: 1950 acc:0.87399 total_loss: 0.58075  loss:0.39086,stance loss: 0.16922 
Train step: 1960 acc:0.87407 total_loss: 0.57688  loss:0.3696,stance loss: 0.30359 
Train step: 1970 acc:0.87283 total_loss: 0.58135  loss:0.75485,stance loss: 1.1203 
Train step: 1980 acc:0.86891 total_loss: 0.59333  loss:0.63047,stance loss: 0.46696 
Train step: 1990 acc:0.86966 total_loss: 0.59742  loss:0.46395,stance loss: 0.27835 
Train step: 2000 acc:0.87105 total_loss: 0.59577  loss:0.71525,stance loss: 1.0074 
Train step: 2010 acc:0.86855 total_loss: 0.60575  loss:0.72639,stance loss: 0.64996 
Train step: 2020 acc:0.86856 total_loss: 0.6096  loss:0.31602,stance loss: 0.20254 
Train step: 2030 acc:0.86703 total_loss: 0.6189  loss:0.85003,stance loss: 1.2118 
Train step: 2040 acc:0.8677 total_loss: 0.61955  loss:0.97213,stance loss: 0.98264 
Train step: 2050 acc:0.86691 total_loss: 0.62002  loss:0.30994,stance loss: 0.22035 
Train step: 2060 acc:0.86752 total_loss: 0.6195  loss:0.85308,stance loss: 0.9428 
Train step: 2070 acc:0.86783 total_loss: 0.6192  loss:0.53235,stance loss: 0.38354 
Train step: 2080 acc:0.86565 total_loss: 0.62701  loss:1.1377,stance loss: 1.0591 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.95833 total_loss: 0.45093  loss:0.43863,stance loss: 0.30208 
Train step: 2100 acc:0.91346 total_loss: 0.47201  loss:0.60379,stance loss: 0.3214 
Train step: 2110 acc:0.90489 total_loss: 0.50486  loss:0.48338,stance loss: 0.33209 
Train step: 2120 acc:0.89583 total_loss: 0.49838  loss:0.64266,stance loss: 0.47725 
Train step: 2130 acc:0.89535 total_loss: 0.52233  loss:0.63583,stance loss: 0.5095 
Train step: 2140 acc:0.89387 total_loss: 0.51146  loss:0.22521,stance loss: 0.099083 
Train step: 2150 acc:0.89881 total_loss: 0.50187  loss:0.4321,stance loss: 0.318 
Train step: 2160 acc:0.89555 total_loss: 0.50348  loss:0.22825,stance loss: 0.17242 
Train step: 2170 acc:0.89307 total_loss: 0.51332  loss:0.58837,stance loss: 0.34432 
Train step: 2180 acc:0.89516 total_loss: 0.51161  loss:0.30777,stance loss: 0.25366 
Train step: 2190 acc:0.89502 total_loss: 0.51781  loss:0.58123,stance loss: 0.44919 
Train step: 2200 acc:0.88993 total_loss: 0.54337  loss:1.3049,stance loss: 1.7273 
Train step: 2210 acc:0.89126 total_loss: 0.53993  loss:0.87709,stance loss: 0.67351 
Train step: 2220 acc:0.89333 total_loss: 0.54166  loss:0.25894,stance loss: 0.17214 
Train step: 2230 acc:0.89161 total_loss: 0.53682  loss:0.22774,stance loss: 0.10679 
Train step: 2240 acc:0.8942 total_loss: 0.52756  loss:0.36827,stance loss: 0.2617 
Train step: 2250 acc:0.89609 total_loss: 0.52574  loss:0.35484,stance loss: 0.32626 
Train step: 2260 acc:0.89704 total_loss: 0.52899  loss:1.2034,stance loss: 1.4741 
Train step: 2270 acc:0.89754 total_loss: 0.52401  loss:0.17041,stance loss: 0.083909 
Train step: 2280 acc:0.89864 total_loss: 0.52189  loss:0.66474,stance loss: 1.0467 
Train step: 2290 acc:0.89932 total_loss: 0.51757  loss:0.10645,stance loss: 0.038947 
Train step: 2300 acc:0.89994 total_loss: 0.51791  loss:0.19787,stance loss: 0.069206 
Train step: 2310 acc:0.89854 total_loss: 0.516  loss:0.4474,stance loss: 0.25785 
Train step: 2320 acc:0.89995 total_loss: 0.51588  loss:0.29519,stance loss: 0.19985 
Train step: 2330 acc:0.90046 total_loss: 0.51324  loss:0.74974,stance loss: 0.61248 
Train step: 2340 acc:0.90069 total_loss: 0.51159  loss:0.66213,stance loss: 0.46858 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.9375 total_loss: 0.38082  loss:0.31283,stance loss: 0.22635 
Train step: 2360 acc:0.92188 total_loss: 0.33644  loss:0.296,stance loss: 0.19571 
Train step: 2370 acc:0.93182 total_loss: 0.32497  loss:0.36531,stance loss: 0.30985 
Train step: 2380 acc:0.92773 total_loss: 0.37011  loss:0.67968,stance loss: 1.1439 
Train step: 2390 acc:0.91815 total_loss: 0.40472  loss:0.11916,stance loss: 0.046616 
Train step: 2400 acc:0.92308 total_loss: 0.43125  loss:0.40104,stance loss: 0.33813 
Train step: 2410 acc:0.92238 total_loss: 0.43457  loss:1.2632,stance loss: 1.6896 
Train step: 2420 acc:0.92101 total_loss: 0.43416  loss:0.40102,stance loss: 0.37932 
Train step: 2430 acc:0.91997 total_loss: 0.43798  loss:0.52841,stance loss: 0.37216 
Train step: 2440 acc:0.9212 total_loss: 0.44215  loss:0.17608,stance loss: 0.022384 
Train step: 2450 acc:0.9185 total_loss: 0.44248  loss:0.69368,stance loss: 0.68676 
Train step: 2460 acc:0.91295 total_loss: 0.4494  loss:0.81664,stance loss: 0.4301 
Train step: 2470 acc:0.9124 total_loss: 0.44777  loss:0.93759,stance loss: 1.0841 
Train step: 2480 acc:0.91288 total_loss: 0.45505  loss:0.30519,stance loss: 0.23204 
Train step: 2490 acc:0.91285 total_loss: 0.45289  loss:0.49234,stance loss: 0.40673 
Train step: 2500 acc:0.91612 total_loss: 0.44491  loss:0.27525,stance loss: 0.20936 
Train step: 2510 acc:0.91628 total_loss: 0.44619  loss:0.40093,stance loss: 0.13908 
Train step: 2520 acc:0.91788 total_loss: 0.44184  loss:0.5005,stance loss: 0.43925 
Train step: 2530 acc:0.91758 total_loss: 0.44036  loss:0.45727,stance loss: 0.27182 
Train step: 2540 acc:0.91862 total_loss: 0.43289  loss:0.693,stance loss: 0.55638 
Train step: 2550 acc:0.91832 total_loss: 0.43666  loss:0.92746,stance loss: 1.1909 
Train step: 2560 acc:0.91981 total_loss: 0.43262  loss:0.33145,stance loss: 0.20036 
Train step: 2570 acc:0.92033 total_loss: 0.42913  loss:0.13408,stance loss: 0.075216 
Train step: 2580 acc:0.91837 total_loss: 0.43173  loss:0.95349,stance loss: 0.86018 
Train step: 2590 acc:0.91606 total_loss: 0.43823  loss:1.0309,stance loss: 0.91159 
Train step: 2600 acc:0.91642 total_loss: 0.43851  loss:1.3096,stance loss: 1.6028 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.29583  loss:0.29583,stance loss: 0.23562 
Train step: 2620 acc:0.93182 total_loss: 0.44038  loss:0.67958,stance loss: 1.0976 
Train step: 2630 acc:0.91667 total_loss: 0.45701  loss:0.30025,stance loss: 0.19889 
Train step: 2640 acc:0.92742 total_loss: 0.43812  loss:0.65111,stance loss: 1.0784 
Train step: 2650 acc:0.9253 total_loss: 0.42113  loss:0.50175,stance loss: 0.37671 
Train step: 2660 acc:0.93137 total_loss: 0.3987  loss:0.21114,stance loss: 0.16594 
Train step: 2670 acc:0.93033 total_loss: 0.38995  loss:0.31987,stance loss: 0.26696 
Train step: 2680 acc:0.93398 total_loss: 0.3674  loss:0.10355,stance loss: 0.038488 
Train step: 2690 acc:0.93287 total_loss: 0.36057  loss:0.58285,stance loss: 0.58503 
Train step: 2700 acc:0.93475 total_loss: 0.37261  loss:0.58721,stance loss: 1.0137 
Train step: 2710 acc:0.93317 total_loss: 0.37306  loss:0.27946,stance loss: 0.2536 
Train step: 2720 acc:0.933 total_loss: 0.37457  loss:0.39897,stance loss: 0.35749 
Train step: 2730 acc:0.93233 total_loss: 0.37379  loss:0.37155,stance loss: 0.29546 
Train step: 2740 acc:0.93321 total_loss: 0.3665  loss:0.1078,stance loss: 0.045756 
Train step: 2750 acc:0.93129 total_loss: 0.36982  loss:0.2031,stance loss: 0.081425 
Train step: 2760 acc:0.93129 total_loss: 0.36997  loss:0.23379,stance loss: 0.19922 
Train step: 2770 acc:0.93168 total_loss: 0.37463  loss:0.26368,stance loss: 0.20648 
Train step: 2780 acc:0.93019 total_loss: 0.37739  loss:0.19762,stance loss: 0.15668 
Train step: 2790 acc:0.93059 total_loss: 0.38224  loss:0.35689,stance loss: 0.26689 
Train step: 2800 acc:0.92997 total_loss: 0.38255  loss:0.22677,stance loss: 0.073233 
Train step: 2810 acc:0.9319 total_loss: 0.37265  loss:0.072863,stance loss: 0.0072054 
Train step: 2820 acc:0.93187 total_loss: 0.37749  loss:0.13928,stance loss: 0.12784 
Train step: 2830 acc:0.931 total_loss: 0.38087  loss:0.72603,stance loss: 0.67362 
Train step: 2840 acc:0.92992 total_loss: 0.38256  loss:0.84179,stance loss: 0.71615 
Train step: 2850 acc:0.92972 total_loss: 0.38371  loss:0.52109,stance loss: 0.4305 
Train step: 2860 acc:0.93127 total_loss: 0.37621  loss:0.49005,stance loss: 0.42884 
Train step: 2870 acc:0.93058 total_loss: 0.38609  loss:8.0932,stance loss: 16.118 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9375 total_loss: 0.36167  loss:0.51506,stance loss: 0.37919 
Train step: 2890 acc:0.94375 total_loss: 0.31914  loss:0.17315,stance loss: 0.11966 
Train step: 2900 acc:0.95208 total_loss: 0.27569  loss:0.20315,stance loss: 0.19603 
Train step: 2910 acc:0.95781 total_loss: 0.26793  loss:0.27854,stance loss: 0.2656 
Train step: 2920 acc:0.95375 total_loss: 0.26722  loss:0.12591,stance loss: 0.080139 
Train step: 2930 acc:0.95833 total_loss: 0.27091  loss:0.10856,stance loss: 0.040991 
Train step: 2940 acc:0.95804 total_loss: 0.2682  loss:0.55943,stance loss: 0.4361 
Train step: 2950 acc:0.95547 total_loss: 0.27444  loss:0.17552,stance loss: 0.098246 
Train step: 2960 acc:0.95417 total_loss: 0.27516  loss:0.12019,stance loss: 0.06495 
Train step: 2970 acc:0.955 total_loss: 0.2699  loss:0.28777,stance loss: 0.13144 
Train step: 2980 acc:0.95682 total_loss: 0.26766  loss:0.17013,stance loss: 0.16463 
Train step: 2990 acc:0.95625 total_loss: 0.27239  loss:0.14071,stance loss: 0.0022923 
Train step: 3000 acc:0.95625 total_loss: 0.26848  loss:0.13848,stance loss: 0.050626 
Train step: 3010 acc:0.9558 total_loss: 0.27185  loss:0.058067,stance loss: 0.0095361 
Train step: 3020 acc:0.95458 total_loss: 0.27164  loss:0.062271,stance loss: 0.023246 
Train step: 3030 acc:0.95352 total_loss: 0.27085  loss:0.11096,stance loss: 0.034822 
Train step: 3040 acc:0.95294 total_loss: 0.28086  loss:0.11057,stance loss: 0.048799 
Train step: 3050 acc:0.95347 total_loss: 0.28158  loss:0.23018,stance loss: 0.23159 
Train step: 3060 acc:0.95132 total_loss: 0.28909  loss:0.28095,stance loss: 0.2411 
Train step: 3070 acc:0.95281 total_loss: 0.28367  loss:0.097533,stance loss: 0.058418 
Train step: 3080 acc:0.95208 total_loss: 0.28454  loss:0.52522,stance loss: 0.37477 
Train step: 3090 acc:0.95284 total_loss: 0.28475  loss:0.22511,stance loss: 0.15345 
Train step: 3100 acc:0.95245 total_loss: 0.2912  loss:0.17314,stance loss: 0.058548 
Train step: 3110 acc:0.95156 total_loss: 0.29032  loss:0.1423,stance loss: 0.047335 
Train step: 3120 acc:0.9505 total_loss: 0.29797  loss:0.54572,stance loss: 0.44315 
Train step: 3130 acc:0.95096 total_loss: 0.29795  loss:0.2691,stance loss: 0.18737 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.97222 total_loss: 0.16038  loss:0.045665,stance loss: 0.010244 
Train step: 3150 acc:0.97039 total_loss: 0.24483  loss:0.64494,stance loss: 1.1287 
Train step: 3160 acc:0.97198 total_loss: 0.23549  loss:0.098107,stance loss: 0.055071 
Train step: 3170 acc:0.96154 total_loss: 0.25039  loss:0.58627,stance loss: 0.41127 
Train step: 3180 acc:0.96046 total_loss: 0.24455  loss:0.29013,stance loss: 0.26266 
Train step: 3190 acc:0.96398 total_loss: 0.23413  loss:0.087148,stance loss: 0.046095 
Train step: 3200 acc:0.95924 total_loss: 0.23979  loss:0.24949,stance loss: 0.21326 
Train step: 3210 acc:0.96044 total_loss: 0.25547  loss:0.043223,stance loss: 0.0081011 
Train step: 3220 acc:0.96278 total_loss: 0.24448  loss:0.036643,stance loss: 0.0048386 
Train step: 3230 acc:0.96275 total_loss: 0.24582  loss:0.13186,stance loss: 0.096703 
Train step: 3240 acc:0.96445 total_loss: 0.2573  loss:0.565,stance loss: 1.0132 
Train step: 3250 acc:0.96534 total_loss: 0.2494  loss:0.086446,stance loss: 0.080654 
Train step: 3260 acc:0.96512 total_loss: 0.25587  loss:0.21161,stance loss: 0.19803 
Train step: 3270 acc:0.96583 total_loss: 0.24945  loss:0.042756,stance loss: 0.010402 
Train step: 3280 acc:0.96435 total_loss: 0.25331  loss:0.16113,stance loss: 0.11707 
Train step: 3290 acc:0.96344 total_loss: 0.25315  loss:0.15583,stance loss: 0.11558 
Train step: 3300 acc:0.96376 total_loss: 0.25382  loss:0.28614,stance loss: 0.17791 
Train step: 3310 acc:0.96369 total_loss: 0.25371  loss:0.40013,stance loss: 0.33643 
Train step: 3320 acc:0.96296 total_loss: 0.25572  loss:0.37002,stance loss: 0.16123 
Train step: 3330 acc:0.96263 total_loss: 0.25499  loss:0.045313,stance loss: 0.005417 
Train step: 3340 acc:0.96202 total_loss: 0.25248  loss:0.58509,stance loss: 0.39743 
Train step: 3350 acc:0.96261 total_loss: 0.25455  loss:0.10998,stance loss: 0.089402 
Train step: 3360 acc:0.96179 total_loss: 0.25453  loss:0.17797,stance loss: 0.14387 
Train step: 3370 acc:0.96208 total_loss: 0.2509  loss:0.10685,stance loss: 0.033063 
Train step: 3380 acc:0.9626 total_loss: 0.24952  loss:0.069719,stance loss: 0.034942 
Train step: 3390 acc:0.96236 total_loss: 0.24909  loss:0.74226,stance loss: 0.73058 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.97656 total_loss: 0.1808  loss:0.71425,stance loss: 1.1764 
Train step: 3410 acc:0.96528 total_loss: 0.22266  loss:0.19622,stance loss: 0.14517 
Train step: 3420 acc:0.96205 total_loss: 0.24724  loss:0.22876,stance loss: 0.2128 
Train step: 3430 acc:0.97204 total_loss: 0.21333  loss:0.079135,stance loss: 0.043021 
Train step: 3440 acc:0.97526 total_loss: 0.20463  loss:0.038279,stance loss: 0.0035077 
Train step: 3450 acc:0.97414 total_loss: 0.20102  loss:0.19959,stance loss: 0.14539 
Train step: 3460 acc:0.97151 total_loss: 0.21441  loss:0.069492,stance loss: 0.022044 
Train step: 3470 acc:0.97196 total_loss: 0.20264  loss:0.1762,stance loss: 0.097755 
Train step: 3480 acc:0.97372 total_loss: 0.20719  loss:0.096861,stance loss: 0.025771 
Train step: 3490 acc:0.97449 total_loss: 0.20624  loss:0.073582,stance loss: 0.040384 
Train step: 3500 acc:0.97222 total_loss: 0.20748  loss:0.40756,stance loss: 0.43552 
Train step: 3510 acc:0.97299 total_loss: 0.20449  loss:0.1438,stance loss: 0.10304 
Train step: 3520 acc:0.97168 total_loss: 0.20497  loss:0.16076,stance loss: 0.16848 
Train step: 3530 acc:0.97147 total_loss: 0.20806  loss:0.037216,stance loss: 0.0095792 
Train step: 3540 acc:0.97297 total_loss: 0.20615  loss:0.076306,stance loss: 0.034474 
Train step: 3550 acc:0.9731 total_loss: 0.20444  loss:0.07206,stance loss: 0.033836 
Train step: 3560 acc:0.97135 total_loss: 0.21972  loss:0.16913,stance loss: 0.11027 
Train step: 3570 acc:0.97051 total_loss: 0.21817  loss:0.17805,stance loss: 0.10487 
Train step: 3580 acc:0.97041 total_loss: 0.21671  loss:0.025773,stance loss: 0.005919 
Train step: 3590 acc:0.97159 total_loss: 0.21491  loss:0.089989,stance loss: 0.036129 
Train step: 3600 acc:0.97175 total_loss: 0.21117  loss:0.088299,stance loss: 0.021145 
Train step: 3610 acc:0.97276 total_loss: 0.2077  loss:0.22528,stance loss: 0.079489 
Train step: 3620 acc:0.97341 total_loss: 0.20714  loss:0.032287,stance loss: 0.0050272 
Train step: 3630 acc:0.97426 total_loss: 0.20376  loss:0.037404,stance loss: 0.011174 
Train step: 3640 acc:0.97354 total_loss: 0.2074  loss:0.15882,stance loss: 0.13914 
Train step: 3650 acc:0.97335 total_loss: 0.20612  loss:0.17776,stance loss: 0.16655 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.99107 total_loss: 0.079035  loss:0.027537,stance loss: 0.0016169 
Train step: 3670 acc:0.98162 total_loss: 0.16371  loss:0.055241,stance loss: 0.0074136 
Train step: 3680 acc:0.98611 total_loss: 0.13955  loss:0.043132,stance loss: 0.027607 
Train step: 3690 acc:0.98649 total_loss: 0.16339  loss:0.095031,stance loss: 0.063344 
Train step: 3700 acc:0.98138 total_loss: 0.16753  loss:0.024717,stance loss: 0.0041518 
Train step: 3710 acc:0.98026 total_loss: 0.19444  loss:0.026123,stance loss: 0.0074245 
Train step: 3720 acc:0.98041 total_loss: 0.1852  loss:0.19778,stance loss: 0.072563 
Train step: 3730 acc:0.98052 total_loss: 0.17991  loss:0.059642,stance loss: 0.0075269 
Train step: 3740 acc:0.98132 total_loss: 0.1811  loss:0.056897,stance loss: 0.024748 
Train step: 3750 acc:0.98325 total_loss: 0.18833  loss:0.084499,stance loss: 0.010733 
Train step: 3760 acc:0.98364 total_loss: 0.18375  loss:0.16196,stance loss: 0.14033 
Train step: 3770 acc:0.98344 total_loss: 0.18309  loss:0.53486,stance loss: 1.009 
Train step: 3780 acc:0.98179 total_loss: 0.17733  loss:0.067894,stance loss: 0.009029 
Train step: 3790 acc:0.98175 total_loss: 0.17161  loss:0.031293,stance loss: 0.0054076 
Train step: 3800 acc:0.98044 total_loss: 0.17656  loss:0.61225,stance loss: 0.52573 
Train step: 3810 acc:0.9801 total_loss: 0.17548  loss:0.025379,stance loss: 0.005165 
Train step: 3820 acc:0.97942 total_loss: 0.18096  loss:0.032327,stance loss: 0.0056861 
Train step: 3830 acc:0.97493 total_loss: 0.19128  loss:1.0508,stance loss: 1.2232 
Train step: 3840 acc:0.97594 total_loss: 0.18685  loss:0.53939,stance loss: 1.0213 
Train step: 3850 acc:0.97462 total_loss: 0.19124  loss:0.041376,stance loss: 0.0062034 
Train step: 3860 acc:0.97434 total_loss: 0.19834  loss:0.026374,stance loss: 0.0059894 
Train step: 3870 acc:0.97494 total_loss: 0.19229  loss:0.036684,stance loss: 0.0091563 
Train step: 3880 acc:0.97522 total_loss: 0.19928  loss:0.053179,stance loss: 0.021771 
Train step: 3890 acc:0.97627 total_loss: 0.19862  loss:0.51562,stance loss: 1.0076 
Train step: 3900 acc:0.97621 total_loss: 0.19624  loss:0.013884,stance loss: 0.00047271 
Train step: 3910 acc:0.97665 total_loss: 0.19478  loss:0.098858,stance loss: 0.085778 
Training finished.


Reload the best model with best f1 0.4606353001451627 from path test_outputs/bert-cross-topic/dt/2023-08-14 13-55-50/state_dict


              precision    recall  f1-score   support

           0   0.477509  0.461538  0.469388       299
           1   0.516820  0.650000  0.575809       260
           2   0.593407  0.364865  0.451883       148

    accuracy                       0.510608       707
   macro avg   0.529245  0.492134  0.499027       707
weighted avg   0.516227  0.510608  0.504860       707

Test Acc: 0.5106082036775106 F1_ma:0.4606353001451627
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4606353001451627
acc: 0.5106082036775106, f1 :0.4990265998696315
classification report: 
              precision    recall  f1-score   support

         Con     0.4775    0.4615    0.4694       299
        None     0.5168    0.6500    0.5758       260
         Pro     0.5934    0.3649    0.4519       148

    accuracy                         0.5106       707
   macro avg     0.5292    0.4921    0.4990       707
weighted avg     0.5162    0.5106    0.5049       707

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 14-14-42', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 14-14-42
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.8846  loss:1.8846,stance loss: 1.5563 
Train step: 10 acc:0.44886 total_loss: 1.6864  loss:1.6821,stance loss: 1.151 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 20 acc:0.43452 total_loss: 1.6641  loss:1.5963,stance loss: 1.3018 
Train step: 30 acc:0.46774 total_loss: 1.6325  loss:1.3836,stance loss: 0.87682 
Train step: 40 acc:0.47713 total_loss: 1.6159  loss:1.5391,stance loss: 1.1017 
Train step: 50 acc:0.49387 total_loss: 1.6013  loss:1.4833,stance loss: 1.1018 
Train step: 60 acc:0.5041 total_loss: 1.5925  loss:1.4571,stance loss: 1.1071 
Train step: 70 acc:0.49912 total_loss: 1.5878  loss:1.4512,stance loss: 0.91643 
Better F1! Saving model!
Saving model of best f1: 0.29780876494023906
              precision    recall  f1-score   support

           0   0.424113  1.000000  0.595618       299
           1   1.000000  0.007692  0.015267       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.425743       707
   macro avg   0.474704  0.335897  0.203628       707
weighted avg   0.547114  0.425743  0.257509       707

Test Acc: 0.42574257425742573 F1_ma:0.29780876494023906
Train step: 80 acc:0.49769 total_loss: 1.5953  loss:1.4569,stance loss: 1.0923 
Train step: 90 acc:0.49725 total_loss: 1.5933  loss:1.5667,stance loss: 1.1459 
Train step: 100 acc:0.50619 total_loss: 1.5853  loss:1.5259,stance loss: 1.0234 
Train step: 110 acc:0.50619 total_loss: 1.5823  loss:1.8923,stance loss: 1.8013 
Train step: 120 acc:0.51188 total_loss: 1.5763  loss:1.5095,stance loss: 1.1325 
Better F1! Saving model!
Saving model of best f1: 0.2981366459627329
              precision    recall  f1-score   support

           0   0.431784  0.963211  0.596273       299
           1   0.675000  0.103846  0.180000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.445545       707
   macro avg   0.368928  0.355686  0.258758       707
weighted avg   0.430839  0.445545  0.318367       707

Test Acc: 0.44554455445544555 F1_ma:0.2981366459627329
Train step: 130 acc:0.51336 total_loss: 1.5672  loss:1.8033,stance loss: 1.565 
Train step: 140 acc:0.51418 total_loss: 1.5642  loss:1.3522,stance loss: 0.89837 
Train step: 150 acc:0.5178 total_loss: 1.5534  loss:1.4436,stance loss: 0.9593 
Train step: 160 acc:0.51941 total_loss: 1.5501  loss:1.2385,stance loss: 0.64481 
Train step: 170 acc:0.52485 total_loss: 1.5485  loss:1.1442,stance loss: 0.59487 
Train step: 180 acc:0.52624 total_loss: 1.5421  loss:1.2962,stance loss: 0.96375 
Train step: 190 acc:0.52945 total_loss: 1.5331  loss:1.5272,stance loss: 1.5619 
Train step: 200 acc:0.53234 total_loss: 1.5308  loss:1.5342,stance loss: 1.1001 
Train step: 210 acc:0.53406 total_loss: 1.525  loss:1.2729,stance loss: 0.81317 
Train step: 220 acc:0.5345 total_loss: 1.5221  loss:1.368,stance loss: 0.95374 
Train step: 230 acc:0.53842 total_loss: 1.5154  loss:1.8859,stance loss: 1.8622 
Train step: 240 acc:0.54305 total_loss: 1.5083  loss:1.4892,stance loss: 1.2096 
Train step: 250 acc:0.54532 total_loss: 1.5048  loss:1.366,stance loss: 0.90156 
Train step: 260 acc:0.54864 total_loss: 1.5015  loss:3.2635,stance loss: 5.4306 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.58125 total_loss: 1.3693  loss:1.3149,stance loss: 0.98022 
Train step: 280 acc:0.58125 total_loss: 1.3544  loss:1.5935,stance loss: 1.1803 
Train step: 290 acc:0.59792 total_loss: 1.3474  loss:1.1996,stance loss: 0.74661 
Train step: 300 acc:0.60156 total_loss: 1.3467  loss:1.5028,stance loss: 1.1467 
Train step: 310 acc:0.615 total_loss: 1.3297  loss:1.2751,stance loss: 0.9668 
Train step: 320 acc:0.61354 total_loss: 1.3323  loss:1.0229,stance loss: 0.67554 
Train step: 330 acc:0.60804 total_loss: 1.3425  loss:1.3683,stance loss: 1.1548 
Train step: 340 acc:0.61094 total_loss: 1.3535  loss:1.4311,stance loss: 1.4191 
Train step: 350 acc:0.61806 total_loss: 1.346  loss:1.1063,stance loss: 0.79736 
Train step: 360 acc:0.62813 total_loss: 1.3403  loss:1.5212,stance loss: 1.5427 
Train step: 370 acc:0.62727 total_loss: 1.3429  loss:1.3672,stance loss: 0.94759 
Train step: 380 acc:0.6276 total_loss: 1.3499  loss:1.3869,stance loss: 1.0164 
Train step: 390 acc:0.6351 total_loss: 1.337  loss:0.99418,stance loss: 0.67856 
Train step: 400 acc:0.64018 total_loss: 1.3321  loss:1.1121,stance loss: 0.77871 
Train step: 410 acc:0.64125 total_loss: 1.3346  loss:1.2383,stance loss: 0.89496 
Train step: 420 acc:0.64258 total_loss: 1.3322  loss:1.4804,stance loss: 1.5729 
Better F1! Saving model!
Saving model of best f1: 0.3
              precision    recall  f1-score   support

           0   0.442155  0.933110  0.600000       299
           1   0.684211  0.200000  0.309524       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.468175       707
   macro avg   0.375455  0.377703  0.303175       707
weighted avg   0.438613  0.468175  0.367576       707

Test Acc: 0.4681753889674682 F1_ma:0.3
Train step: 430 acc:0.64449 total_loss: 1.3316  loss:1.1804,stance loss: 1.0304 
Train step: 440 acc:0.64236 total_loss: 1.3325  loss:1.3942,stance loss: 1.0822 
Train step: 450 acc:0.64408 total_loss: 1.3347  loss:1.1255,stance loss: 0.90576 
Train step: 460 acc:0.64406 total_loss: 1.3328  loss:1.2659,stance loss: 0.77658 
Train step: 470 acc:0.64911 total_loss: 1.3247  loss:0.94506,stance loss: 0.76882 
Train step: 480 acc:0.65256 total_loss: 1.3185  loss:1.7863,stance loss: 1.7328 
Train step: 490 acc:0.65082 total_loss: 1.3194  loss:1.2713,stance loss: 1.5462 
Train step: 500 acc:0.65052 total_loss: 1.3215  loss:1.2678,stance loss: 0.93089 
Train step: 510 acc:0.65225 total_loss: 1.3131  loss:0.93583,stance loss: 0.57512 
Train step: 520 acc:0.65312 total_loss: 1.3108  loss:1.5635,stance loss: 1.5178 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.69444 total_loss: 1.248  loss:1.1294,stance loss: 0.8892 
Train step: 540 acc:0.64803 total_loss: 1.2854  loss:1.5248,stance loss: 1.4577 
Train step: 550 acc:0.67026 total_loss: 1.2157  loss:0.92177,stance loss: 0.6426 
Train step: 560 acc:0.66827 total_loss: 1.2387  loss:1.2442,stance loss: 0.98408 
Train step: 570 acc:0.6824 total_loss: 1.2136  loss:1.0643,stance loss: 0.70521 
Train step: 580 acc:0.68432 total_loss: 1.2116  loss:1.0239,stance loss: 0.77651 
Train step: 590 acc:0.68297 total_loss: 1.2153  loss:1.4342,stance loss: 1.0775 
Train step: 600 acc:0.67722 total_loss: 1.2203  loss:1.722,stance loss: 1.6029 
Train step: 610 acc:0.67556 total_loss: 1.2244  loss:1.1696,stance loss: 0.67473 
Train step: 620 acc:0.67992 total_loss: 1.227  loss:0.83765,stance loss: 0.57607 
Train step: 630 acc:0.68062 total_loss: 1.2285  loss:1.4369,stance loss: 1.0457 
Train step: 640 acc:0.68277 total_loss: 1.2265  loss:1.5315,stance loss: 1.2757 
Train step: 650 acc:0.68944 total_loss: 1.2229  loss:1.0728,stance loss: 1.0161 
Train step: 660 acc:0.69245 total_loss: 1.2186  loss:1.6614,stance loss: 1.7805 
Train step: 670 acc:0.69253 total_loss: 1.2223  loss:1.4799,stance loss: 1.2784 
Train step: 680 acc:0.69693 total_loss: 1.2124  loss:1.2565,stance loss: 0.78124 
Train step: 690 acc:0.69675 total_loss: 1.2134  loss:0.84586,stance loss: 0.5647 
Train step: 700 acc:0.69518 total_loss: 1.2111  loss:1.5342,stance loss: 1.2 
Train step: 710 acc:0.70007 total_loss: 1.1999  loss:0.68344,stance loss: 0.53065 
Train step: 720 acc:0.70163 total_loss: 1.1941  loss:0.82497,stance loss: 0.61247 
Train step: 730 acc:0.70096 total_loss: 1.1941  loss:1.308,stance loss: 1.4414 
Train step: 740 acc:0.70148 total_loss: 1.1908  loss:1.1954,stance loss: 1.3892 
Train step: 750 acc:0.70224 total_loss: 1.184  loss:1.2343,stance loss: 1.1942 
Train step: 760 acc:0.70293 total_loss: 1.1819  loss:0.83157,stance loss: 0.52115 
Train step: 770 acc:0.70105 total_loss: 1.1836  loss:1.0784,stance loss: 0.89475 
Train step: 780 acc:0.69981 total_loss: 1.1869  loss:1.3414,stance loss: 1.0672 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.72656 total_loss: 1.116  loss:0.75939,stance loss: 0.66716 
Train step: 800 acc:0.6875 total_loss: 1.1419  loss:1.4671,stance loss: 1.0812 
Train step: 810 acc:0.70982 total_loss: 1.1059  loss:1.5478,stance loss: 1.3706 
Train step: 820 acc:0.71382 total_loss: 1.1011  loss:0.95399,stance loss: 0.84065 
Train step: 830 acc:0.72005 total_loss: 1.1049  loss:0.84516,stance loss: 0.62651 
Train step: 840 acc:0.72953 total_loss: 1.0963  loss:1.139,stance loss: 0.88646 
Train step: 850 acc:0.72702 total_loss: 1.1115  loss:0.91007,stance loss: 0.5096 
Train step: 860 acc:0.73317 total_loss: 1.1038  loss:1.1821,stance loss: 0.95776 
Train step: 870 acc:0.73366 total_loss: 1.1045  loss:0.91021,stance loss: 0.6375 
Train step: 880 acc:0.73724 total_loss: 1.0991  loss:1.3873,stance loss: 1.4407 
Train step: 890 acc:0.73206 total_loss: 1.1091  loss:1.111,stance loss: 0.92232 
Train step: 900 acc:0.72775 total_loss: 1.1136  loss:1.1082,stance loss: 0.89346 
Train step: 910 acc:0.72461 total_loss: 1.1163  loss:1.1993,stance loss: 0.92308 
Train step: 920 acc:0.72645 total_loss: 1.1201  loss:1.1999,stance loss: 1.2916 
Train step: 930 acc:0.72804 total_loss: 1.1152  loss:0.95289,stance loss: 0.63686 
Train step: 940 acc:0.72745 total_loss: 1.1169  loss:0.99843,stance loss: 0.70836 
Train step: 950 acc:0.72507 total_loss: 1.1103  loss:0.97698,stance loss: 0.60575 
Train step: 960 acc:0.72156 total_loss: 1.1133  loss:1.1101,stance loss: 0.99456 
Train step: 970 acc:0.72307 total_loss: 1.108  loss:0.93018,stance loss: 0.84107 
Train step: 980 acc:0.72191 total_loss: 1.1079  loss:1.2103,stance loss: 0.75579 
Train step: 990 acc:0.72055 total_loss: 1.1085  loss:1.1686,stance loss: 0.97485 
Train step: 1000 acc:0.72047 total_loss: 1.1083  loss:0.94518,stance loss: 0.68661 
Train step: 1010 acc:0.72314 total_loss: 1.1042  loss:0.6403,stance loss: 0.4933 
Train step: 1020 acc:0.72111 total_loss: 1.1076  loss:1.2105,stance loss: 0.89942 
Train step: 1030 acc:0.72177 total_loss: 1.1058  loss:0.5723,stance loss: 0.23615 
Train step: 1040 acc:0.72263 total_loss: 1.1044  loss:1.4322,stance loss: 1.6553 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.75 total_loss: 1.0102  loss:0.93187,stance loss: 0.76652 
Train step: 1060 acc:0.73897 total_loss: 1.0238  loss:0.94425,stance loss: 0.83429 
Train step: 1070 acc:0.73611 total_loss: 1.0483  loss:1.0435,stance loss: 0.80186 
Train step: 1080 acc:0.74493 total_loss: 1.0611  loss:0.99348,stance loss: 0.80869 
Train step: 1090 acc:0.75532 total_loss: 1.0262  loss:1.0336,stance loss: 0.77203 
Train step: 1100 acc:0.74561 total_loss: 1.0651  loss:1.32,stance loss: 1.5439 
Train step: 1110 acc:0.74067 total_loss: 1.061  loss:1.0392,stance loss: 0.80582 
Train step: 1120 acc:0.73458 total_loss: 1.0618  loss:0.9719,stance loss: 0.80025 
Train step: 1130 acc:0.73348 total_loss: 1.0665  loss:1.1184,stance loss: 0.76313 
Train step: 1140 acc:0.73582 total_loss: 1.0581  loss:1.1357,stance loss: 1.0759 
Train step: 1150 acc:0.73832 total_loss: 1.0577  loss:1.0537,stance loss: 1.333 
Train step: 1160 acc:0.73985 total_loss: 1.0697  loss:0.86696,stance loss: 0.64086 
Train step: 1170 acc:0.73671 total_loss: 1.0708  loss:1.4035,stance loss: 0.94005 
Train step: 1180 acc:0.74133 total_loss: 1.0642  loss:0.79496,stance loss: 0.7562 
Train step: 1190 acc:0.74405 total_loss: 1.0495  loss:0.4849,stance loss: 0.36967 
Train step: 1200 acc:0.74482 total_loss: 1.0472  loss:1.0143,stance loss: 0.72404 
Train step: 1210 acc:0.74738 total_loss: 1.0381  loss:1.0817,stance loss: 1.0703 
Train step: 1220 acc:0.75177 total_loss: 1.0301  loss:0.98996,stance loss: 1.1029 
Train step: 1230 acc:0.75134 total_loss: 1.0318  loss:1.2729,stance loss: 1.0156 
Train step: 1240 acc:0.75127 total_loss: 1.0278  loss:1.1417,stance loss: 0.86641 
Train step: 1250 acc:0.75181 total_loss: 1.0307  loss:1.2532,stance loss: 1.5432 
Train step: 1260 acc:0.75202 total_loss: 1.0307  loss:1.3431,stance loss: 1.2619 
Train step: 1270 acc:0.75 total_loss: 1.033  loss:0.87399,stance loss: 0.66126 
Train step: 1280 acc:0.75237 total_loss: 1.0268  loss:0.82838,stance loss: 0.65608 
Train step: 1290 acc:0.75253 total_loss: 1.025  loss:0.58743,stance loss: 0.44033 
Train step: 1300 acc:0.7534 total_loss: 1.0237  loss:0.81817,stance loss: 0.57558 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.72917 total_loss: 1.0758  loss:0.90958,stance loss: 0.84387 
Train step: 1320 acc:0.74609 total_loss: 0.99669  loss:0.90915,stance loss: 0.65046 
Train step: 1330 acc:0.7524 total_loss: 0.95446  loss:0.66361,stance loss: 0.54375 
Train step: 1340 acc:0.75868 total_loss: 0.95379  loss:0.9252,stance loss: 0.83202 
Train step: 1350 acc:0.75679 total_loss: 0.94918  loss:0.81843,stance loss: 0.70843 
Train step: 1360 acc:0.76004 total_loss: 0.94383  loss:0.78619,stance loss: 0.64536 
Train step: 1370 acc:0.76894 total_loss: 0.93507  loss:1.3359,stance loss: 1.6321 
Train step: 1380 acc:0.77467 total_loss: 0.93374  loss:0.66985,stance loss: 0.56797 
Train step: 1390 acc:0.77326 total_loss: 0.94729  loss:0.7658,stance loss: 0.60467 
Train step: 1400 acc:0.77539 total_loss: 0.93709  loss:0.74843,stance loss: 0.58127 
Train step: 1410 acc:0.773 total_loss: 0.94551  loss:1.2468,stance loss: 1.2038 
Train step: 1420 acc:0.77802 total_loss: 0.93489  loss:0.86577,stance loss: 0.69124 
Train step: 1430 acc:0.77679 total_loss: 0.9349  loss:1.5786,stance loss: 1.3539 
Train step: 1440 acc:0.77298 total_loss: 0.93625  loss:0.87709,stance loss: 0.80748 
Train step: 1450 acc:0.77226 total_loss: 0.93341  loss:0.75605,stance loss: 0.6635 
Train step: 1460 acc:0.77444 total_loss: 0.92609  loss:0.90714,stance loss: 0.68312 
Train step: 1470 acc:0.77523 total_loss: 0.92255  loss:1.1503,stance loss: 1.5196 
Train step: 1480 acc:0.77344 total_loss: 0.93079  loss:1.3412,stance loss: 1.3709 
Train step: 1490 acc:0.77016 total_loss: 0.93434  loss:1.4855,stance loss: 1.7255 
Train step: 1500 acc:0.76913 total_loss: 0.93314  loss:0.80229,stance loss: 0.50907 
Train step: 1510 acc:0.76729 total_loss: 0.93498  loss:0.96326,stance loss: 0.74585 
Train step: 1520 acc:0.76881 total_loss: 0.93053  loss:0.9647,stance loss: 0.89914 
Train step: 1530 acc:0.76576 total_loss: 0.93384  loss:0.82255,stance loss: 0.76903 
Train step: 1540 acc:0.7651 total_loss: 0.93122  loss:1.0624,stance loss: 0.95909 
Train step: 1550 acc:0.76728 total_loss: 0.92771  loss:0.62692,stance loss: 0.50906 
Train step: 1560 acc:0.76855 total_loss: 0.92163  loss:0.71821,stance loss: 0.53436 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.7875 total_loss: 0.95868  loss:1.1963,stance loss: 1.5604 
Train step: 1580 acc:0.8 total_loss: 0.85692  loss:0.60288,stance loss: 0.54119 
Train step: 1590 acc:0.79 total_loss: 0.87834  loss:1.37,stance loss: 1.6748 
Train step: 1600 acc:0.78036 total_loss: 0.89888  loss:0.86664,stance loss: 0.65332 
Train step: 1610 acc:0.78194 total_loss: 0.8806  loss:0.81024,stance loss: 0.62492 
Train step: 1620 acc:0.79545 total_loss: 0.83661  loss:0.80098,stance loss: 0.62319 
Train step: 1630 acc:0.79712 total_loss: 0.83317  loss:1.038,stance loss: 0.96133 
Train step: 1640 acc:0.79917 total_loss: 0.82465  loss:0.71567,stance loss: 0.6213 
Train step: 1650 acc:0.79926 total_loss: 0.81721  loss:0.72483,stance loss: 0.69738 
Train step: 1660 acc:0.80197 total_loss: 0.81396  loss:0.78912,stance loss: 0.5477 
Train step: 1670 acc:0.79762 total_loss: 0.81925  loss:0.5003,stance loss: 0.41443 
Train step: 1680 acc:0.80163 total_loss: 0.81155  loss:0.60625,stance loss: 0.50372 
Train step: 1690 acc:0.7975 total_loss: 0.81626  loss:1.0568,stance loss: 0.81434 
Train step: 1700 acc:0.79954 total_loss: 0.80443  loss:0.45232,stance loss: 0.27435 
Train step: 1710 acc:0.79828 total_loss: 0.80477  loss:0.46791,stance loss: 0.36794 
Train step: 1720 acc:0.79637 total_loss: 0.80426  loss:0.86055,stance loss: 0.68176 
Train step: 1730 acc:0.79394 total_loss: 0.81137  loss:1.0458,stance loss: 0.49962 
Train step: 1740 acc:0.79179 total_loss: 0.81345  loss:0.44678,stance loss: 0.30163 
Train step: 1750 acc:0.79426 total_loss: 0.80607  loss:0.40931,stance loss: 0.35441 
Train step: 1760 acc:0.79423 total_loss: 0.81251  loss:0.68545,stance loss: 0.579 
Train step: 1770 acc:0.79207 total_loss: 0.81857  loss:1.1666,stance loss: 0.94368 
Train step: 1780 acc:0.79331 total_loss: 0.81624  loss:0.80789,stance loss: 0.61135 
Train step: 1790 acc:0.79194 total_loss: 0.82023  loss:0.59475,stance loss: 0.52942 
Train step: 1800 acc:0.79176 total_loss: 0.82188  loss:1.1339,stance loss: 0.87198 
Train step: 1810 acc:0.79056 total_loss: 0.82891  loss:0.73883,stance loss: 0.61863 
Train step: 1820 acc:0.79118 total_loss: 0.8295  loss:1.131,stance loss: 0.75152 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.76562 total_loss: 0.69083  loss:0.90157,stance loss: 0.78326 
Train step: 1840 acc:0.79018 total_loss: 0.73714  loss:0.47132,stance loss: 0.3701 
Train step: 1850 acc:0.80469 total_loss: 0.78019  loss:1.1897,stance loss: 1.5828 
Train step: 1860 acc:0.81066 total_loss: 0.77325  loss:0.29528,stance loss: 0.2163 
Train step: 1870 acc:0.81676 total_loss: 0.73689  loss:0.60976,stance loss: 0.54105 
Train step: 1880 acc:0.82523 total_loss: 0.71266  loss:0.73193,stance loss: 0.45477 
Train step: 1890 acc:0.82129 total_loss: 0.73868  loss:0.32611,stance loss: 0.24581 
Train step: 1900 acc:0.82939 total_loss: 0.71769  loss:0.96661,stance loss: 0.84856 
Train step: 1910 acc:0.82961 total_loss: 0.72081  loss:0.52923,stance loss: 0.46734 
Train step: 1920 acc:0.82447 total_loss: 0.73894  loss:1.0505,stance loss: 0.85463 
Train step: 1930 acc:0.82933 total_loss: 0.74154  loss:0.774,stance loss: 0.60787 
Train step: 1940 acc:0.83114 total_loss: 0.73992  loss:0.49847,stance loss: 0.38643 
Train step: 1950 acc:0.82762 total_loss: 0.73947  loss:0.84114,stance loss: 0.73071 
Train step: 1960 acc:0.82743 total_loss: 0.73713  loss:0.52343,stance loss: 0.45604 
Train step: 1970 acc:0.82812 total_loss: 0.73292  loss:0.71154,stance loss: 0.52115 
Train step: 1980 acc:0.82752 total_loss: 0.72948  loss:0.64641,stance loss: 0.5563 
Train step: 1990 acc:0.83117 total_loss: 0.72503  loss:0.53064,stance loss: 0.45318 
Train step: 2000 acc:0.83046 total_loss: 0.72186  loss:0.73222,stance loss: 0.54787 
Train step: 2010 acc:0.8305 total_loss: 0.72394  loss:0.43715,stance loss: 0.32874 
Train step: 2020 acc:0.82796 total_loss: 0.73292  loss:0.66324,stance loss: 0.4927 
Train step: 2030 acc:0.82721 total_loss: 0.73679  loss:1.5787,stance loss: 1.798 
Train step: 2040 acc:0.82798 total_loss: 0.72943  loss:0.62878,stance loss: 0.547 
Train step: 2050 acc:0.82896 total_loss: 0.72515  loss:0.78743,stance loss: 0.74988 
Train step: 2060 acc:0.82986 total_loss: 0.71833  loss:0.56118,stance loss: 0.44937 
Train step: 2070 acc:0.82864 total_loss: 0.72378  loss:0.65792,stance loss: 0.53877 
Train step: 2080 acc:0.82923 total_loss: 0.72113  loss:0.36359,stance loss: 0.28351 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.91667 total_loss: 0.46607  loss:0.35906,stance loss: 0.2056 
Train step: 2100 acc:0.81731 total_loss: 0.71444  loss:0.6018,stance loss: 0.46951 
Train step: 2110 acc:0.85054 total_loss: 0.64349  loss:0.58681,stance loss: 0.40054 
Train step: 2120 acc:0.85227 total_loss: 0.65292  loss:0.61262,stance loss: 0.46975 
Train step: 2130 acc:0.83866 total_loss: 0.7191  loss:0.97182,stance loss: 1.0923 
Train step: 2140 acc:0.84552 total_loss: 0.72011  loss:0.85164,stance loss: 0.76998 
Train step: 2150 acc:0.84921 total_loss: 0.69603  loss:0.74175,stance loss: 1.0786 
Train step: 2160 acc:0.84846 total_loss: 0.70657  loss:1.1264,stance loss: 1.4099 
Train step: 2170 acc:0.85617 total_loss: 0.67784  loss:0.56046,stance loss: 0.47966 
Train step: 2180 acc:0.85551 total_loss: 0.68463  loss:0.91684,stance loss: 0.6625 
Train step: 2190 acc:0.85255 total_loss: 0.68023  loss:1.1727,stance loss: 1.5165 
Train step: 2200 acc:0.85177 total_loss: 0.68435  loss:0.68867,stance loss: 0.57665 
Train step: 2210 acc:0.85467 total_loss: 0.67686  loss:0.3985,stance loss: 0.32241 
Train step: 2220 acc:0.85479 total_loss: 0.67433  loss:0.49999,stance loss: 0.3972 
Train step: 2230 acc:0.85708 total_loss: 0.66076  loss:0.43053,stance loss: 0.35169 
Train step: 2240 acc:0.85662 total_loss: 0.6536  loss:0.80983,stance loss: 0.5343 
Train step: 2250 acc:0.85775 total_loss: 0.64944  loss:0.53335,stance loss: 0.41909 
Train step: 2260 acc:0.85621 total_loss: 0.65886  loss:0.7377,stance loss: 1.0886 
Train step: 2270 acc:0.85417 total_loss: 0.66804  loss:0.76211,stance loss: 0.72191 
Train step: 2280 acc:0.84974 total_loss: 0.67056  loss:0.64941,stance loss: 0.48153 
Train step: 2290 acc:0.85099 total_loss: 0.66777  loss:0.76236,stance loss: 0.71235 
Train step: 2300 acc:0.8527 total_loss: 0.66099  loss:0.28299,stance loss: 0.19503 
Train step: 2310 acc:0.85062 total_loss: 0.66551  loss:0.99626,stance loss: 1.0457 
Train step: 2320 acc:0.85059 total_loss: 0.66165  loss:0.5339,stance loss: 0.44132 
Train step: 2330 acc:0.84928 total_loss: 0.66516  loss:0.32089,stance loss: 0.2629 
Train step: 2340 acc:0.85005 total_loss: 0.66476  loss:0.93004,stance loss: 1.2417 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.78125 total_loss: 0.78528  loss:0.24106,stance loss: 0.096344 
Train step: 2360 acc:0.82812 total_loss: 0.7221  loss:0.45415,stance loss: 0.40151 
Train step: 2370 acc:0.85511 total_loss: 0.64221  loss:0.35221,stance loss: 0.2465 
Train step: 2380 acc:0.85352 total_loss: 0.66011  loss:0.23015,stance loss: 0.14068 
Train step: 2390 acc:0.85417 total_loss: 0.63973  loss:0.78897,stance loss: 1.1686 
Train step: 2400 acc:0.86538 total_loss: 0.6044  loss:0.2084,stance loss: 0.1419 
Train step: 2410 acc:0.86895 total_loss: 0.60556  loss:0.55864,stance loss: 0.4482 
Better F1! Saving model!
Saving model of best f1: 0.3009607593471466
              precision    recall  f1-score   support

           0   0.466667  0.608696  0.528302       299
           1   0.536424  0.623077  0.576512       260
           2   0.400000  0.040541  0.073620       148

    accuracy                       0.495050       707
   macro avg   0.467697  0.424104  0.392811       707
weighted avg   0.478364  0.495050  0.450850       707

Test Acc: 0.49504950495049505 F1_ma:0.3009607593471466
Train step: 2420 acc:0.86979 total_loss: 0.60647  loss:0.56727,stance loss: 0.34312 
Train step: 2430 acc:0.87271 total_loss: 0.58531  loss:0.53055,stance loss: 0.39976 
Train step: 2440 acc:0.87432 total_loss: 0.57374  loss:0.6644,stance loss: 0.60794 
Train step: 2450 acc:0.87623 total_loss: 0.56783  loss:0.66398,stance loss: 0.50723 
Train step: 2460 acc:0.86998 total_loss: 0.58449  loss:1.0226,stance loss: 1.4847 
Better F1! Saving model!
Saving model of best f1: 0.3671350507416081
              precision    recall  f1-score   support

           0   0.480363  0.531773  0.504762       299
           1   0.524927  0.688462  0.595674       260
           2   0.600000  0.141892  0.229508       148

    accuracy                       0.507779       707
   macro avg   0.535096  0.454042  0.443315       707
weighted avg   0.521795  0.507779  0.480575       707

Test Acc: 0.5077793493635078 F1_ma:0.3671350507416081
Train step: 2470 acc:0.86988 total_loss: 0.58758  loss:0.81637,stance loss: 1.2508 
Train step: 2480 acc:0.87453 total_loss: 0.575  loss:0.4459,stance loss: 0.4257 
Train step: 2490 acc:0.87632 total_loss: 0.57416  loss:0.72211,stance loss: 0.33063 
Train step: 2500 acc:0.875 total_loss: 0.57281  loss:0.43412,stance loss: 0.39306 
Train step: 2510 acc:0.87654 total_loss: 0.56567  loss:0.32123,stance loss: 0.22173 
Train step: 2520 acc:0.87645 total_loss: 0.56612  loss:0.70935,stance loss: 1.0896 
Train step: 2530 acc:0.87603 total_loss: 0.57293  loss:0.74382,stance loss: 1.2139 
Train step: 2540 acc:0.87435 total_loss: 0.57242  loss:0.4244,stance loss: 0.35626 
Train step: 2550 acc:0.87252 total_loss: 0.57179  loss:0.91295,stance loss: 0.8039 
Train step: 2560 acc:0.87323 total_loss: 0.57043  loss:0.3988,stance loss: 0.31568 
Train step: 2570 acc:0.87303 total_loss: 0.57569  loss:0.9873,stance loss: 1.3561 
Train step: 2580 acc:0.87258 total_loss: 0.57686  loss:0.68632,stance loss: 0.56809 
Train step: 2590 acc:0.87371 total_loss: 0.57221  loss:0.43678,stance loss: 0.31506 
Train step: 2600 acc:0.87426 total_loss: 0.56869  loss:0.47991,stance loss: 0.40137 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.28277  loss:0.28277,stance loss: 0.18909 
Train step: 2620 acc:0.85795 total_loss: 0.44604  loss:0.67327,stance loss: 0.36899 
Train step: 2630 acc:0.88393 total_loss: 0.41906  loss:0.41519,stance loss: 0.34202 
Train step: 2640 acc:0.89718 total_loss: 0.394  loss:0.26198,stance loss: 0.21743 
Train step: 2650 acc:0.89329 total_loss: 0.40701  loss:0.26358,stance loss: 0.21346 
Train step: 2660 acc:0.89828 total_loss: 0.41084  loss:0.59452,stance loss: 0.48244 
Train step: 2670 acc:0.90164 total_loss: 0.40552  loss:0.61046,stance loss: 0.43759 
Train step: 2680 acc:0.90229 total_loss: 0.40909  loss:0.40885,stance loss: 0.34142 
Train step: 2690 acc:0.90278 total_loss: 0.42188  loss:0.18834,stance loss: 0.17283 
Train step: 2700 acc:0.90385 total_loss: 0.43026  loss:0.83366,stance loss: 1.0225 
Train step: 2710 acc:0.90161 total_loss: 0.44326  loss:0.58284,stance loss: 0.38037 
Train step: 2720 acc:0.9009 total_loss: 0.45077  loss:1.1587,stance loss: 1.2502 
Train step: 2730 acc:0.90134 total_loss: 0.44284  loss:0.50128,stance loss: 0.38917 
Train step: 2740 acc:0.90363 total_loss: 0.44616  loss:0.33426,stance loss: 0.25637 
Train step: 2750 acc:0.90381 total_loss: 0.44895  loss:0.18035,stance loss: 0.11432 
Train step: 2760 acc:0.90356 total_loss: 0.44941  loss:0.19988,stance loss: 0.1786 
Train step: 2770 acc:0.90256 total_loss: 0.45593  loss:0.70229,stance loss: 0.69038 
Train step: 2780 acc:0.90278 total_loss: 0.45686  loss:0.79911,stance loss: 0.56836 
Train step: 2790 acc:0.90124 total_loss: 0.46126  loss:0.54353,stance loss: 0.53819 
Train step: 2800 acc:0.90118 total_loss: 0.46564  loss:0.36989,stance loss: 0.35802 
Train step: 2810 acc:0.9005 total_loss: 0.46543  loss:0.58777,stance loss: 0.35897 
Train step: 2820 acc:0.8984 total_loss: 0.47188  loss:0.35777,stance loss: 0.21937 
Train step: 2830 acc:0.8996 total_loss: 0.46709  loss:0.17432,stance loss: 0.097091 
Train step: 2840 acc:0.89962 total_loss: 0.47032  loss:0.48876,stance loss: 0.44868 
Train step: 2850 acc:0.89964 total_loss: 0.47258  loss:0.35177,stance loss: 0.16542 
Train step: 2860 acc:0.8989 total_loss: 0.47278  loss:0.49256,stance loss: 0.40482 
Train step: 2870 acc:0.89839 total_loss: 0.47516  loss:2.8182,stance loss: 5.3729 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9375 total_loss: 0.47961  loss:0.7436,stance loss: 0.59896 
Train step: 2890 acc:0.91875 total_loss: 0.5053  loss:0.3223,stance loss: 0.25665 
Train step: 2900 acc:0.91667 total_loss: 0.49929  loss:0.6306,stance loss: 0.53199 
Train step: 2910 acc:0.92031 total_loss: 0.46553  loss:0.64489,stance loss: 0.43352 
Train step: 2920 acc:0.92375 total_loss: 0.43559  loss:0.26377,stance loss: 0.23079 
Train step: 2930 acc:0.925 total_loss: 0.39865  loss:0.1378,stance loss: 0.1178 
Train step: 2940 acc:0.92321 total_loss: 0.40336  loss:0.39799,stance loss: 0.28611 
Train step: 2950 acc:0.92266 total_loss: 0.40867  loss:0.83564,stance loss: 0.76382 
Train step: 2960 acc:0.92153 total_loss: 0.40547  loss:0.55792,stance loss: 0.53759 
Train step: 2970 acc:0.91875 total_loss: 0.41073  loss:0.49909,stance loss: 0.42169 
Train step: 2980 acc:0.91591 total_loss: 0.41898  loss:0.56025,stance loss: 0.24807 
Train step: 2990 acc:0.91615 total_loss: 0.42242  loss:0.69762,stance loss: 1.1359 
Train step: 3000 acc:0.91442 total_loss: 0.42769  loss:0.53573,stance loss: 0.48152 
Train step: 3010 acc:0.91473 total_loss: 0.43028  loss:0.20225,stance loss: 0.090144 
Train step: 3020 acc:0.91208 total_loss: 0.43572  loss:0.20461,stance loss: 0.15065 
Train step: 3030 acc:0.91172 total_loss: 0.44066  loss:1.1835,stance loss: 1.5012 
Train step: 3040 acc:0.91324 total_loss: 0.43428  loss:0.34604,stance loss: 0.28576 
Train step: 3050 acc:0.91319 total_loss: 0.43432  loss:0.33906,stance loss: 0.30009 
Train step: 3060 acc:0.9125 total_loss: 0.43032  loss:0.31975,stance loss: 0.25659 
Train step: 3070 acc:0.91187 total_loss: 0.43387  loss:0.55048,stance loss: 0.38946 
Train step: 3080 acc:0.91339 total_loss: 0.42812  loss:0.20973,stance loss: 0.14967 
Train step: 3090 acc:0.91307 total_loss: 0.42686  loss:0.53948,stance loss: 0.46366 
Train step: 3100 acc:0.91168 total_loss: 0.42838  loss:0.30292,stance loss: 0.19614 
Train step: 3110 acc:0.9125 total_loss: 0.42645  loss:0.1004,stance loss: 0.037406 
Train step: 3120 acc:0.91175 total_loss: 0.42961  loss:0.092238,stance loss: 0.066123 
Train step: 3130 acc:0.9125 total_loss: 0.42788  loss:0.44971,stance loss: 0.43555 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.96528 total_loss: 0.21803  loss:0.13624,stance loss: 0.036538 
Train step: 3150 acc:0.95066 total_loss: 0.29518  loss:0.24852,stance loss: 0.25518 
Train step: 3160 acc:0.94828 total_loss: 0.31946  loss:0.32759,stance loss: 0.27671 
Train step: 3170 acc:0.94231 total_loss: 0.33072  loss:0.31996,stance loss: 0.39389 
Train step: 3180 acc:0.94133 total_loss: 0.3272  loss:0.15641,stance loss: 0.087993 
Train step: 3190 acc:0.94068 total_loss: 0.31978  loss:0.15317,stance loss: 0.08274 
Train step: 3200 acc:0.93569 total_loss: 0.335  loss:0.83263,stance loss: 0.71266 
Train step: 3210 acc:0.9375 total_loss: 0.33319  loss:0.12907,stance loss: 0.096005 
Train step: 3220 acc:0.9368 total_loss: 0.32924  loss:0.28653,stance loss: 0.11944 
Train step: 3230 acc:0.93245 total_loss: 0.3484  loss:0.50798,stance loss: 0.4118 
Train step: 3240 acc:0.93349 total_loss: 0.34042  loss:0.56215,stance loss: 0.45812 
Train step: 3250 acc:0.93382 total_loss: 0.34014  loss:0.67036,stance loss: 0.57399 
Train step: 3260 acc:0.93217 total_loss: 0.34157  loss:0.46523,stance loss: 0.37967 
Train step: 3270 acc:0.92896 total_loss: 0.35231  loss:0.34974,stance loss: 0.27611 
Train step: 3280 acc:0.92743 total_loss: 0.3571  loss:0.17665,stance loss: 0.17296 
Train step: 3290 acc:0.92571 total_loss: 0.36696  loss:0.29298,stance loss: 0.24535 
Better F1! Saving model!
Saving model of best f1: 0.4021476625840953
              precision    recall  f1-score   support

           0   0.480418  0.615385  0.539589       299
           1   0.563433  0.580769  0.571970       260
           2   0.482143  0.182432  0.264706       148

    accuracy                       0.512023       707
   macro avg   0.508664  0.459529  0.458755       707
weighted avg   0.511308  0.512023  0.493955       707

Test Acc: 0.512022630834512 F1_ma:0.4021476625840953
Train step: 3300 acc:0.92456 total_loss: 0.36422  loss:0.14444,stance loss: 0.0978 
Train step: 3310 acc:0.92528 total_loss: 0.36099  loss:0.26737,stance loss: 0.23052 
Train step: 3320 acc:0.92626 total_loss: 0.35547  loss:0.38258,stance loss: 0.34533 
Train step: 3330 acc:0.92682 total_loss: 0.35401  loss:0.32818,stance loss: 0.27394 
Train step: 3340 acc:0.92853 total_loss: 0.34773  loss:0.19948,stance loss: 0.20315 
Train step: 3350 acc:0.92865 total_loss: 0.34867  loss:0.4607,stance loss: 0.32673 
Train step: 3360 acc:0.92822 total_loss: 0.352  loss:0.42639,stance loss: 0.38556 
Train step: 3370 acc:0.92782 total_loss: 0.35022  loss:0.42385,stance loss: 0.29275 
Train step: 3380 acc:0.92871 total_loss: 0.34631  loss:0.090463,stance loss: 0.069706 
Train step: 3390 acc:0.92954 total_loss: 0.34195  loss:0.09804,stance loss: 0.036259 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.98438 total_loss: 0.12214  loss:0.037213,stance loss: 0.0067753 
Train step: 3410 acc:0.96181 total_loss: 0.28688  loss:0.73064,stance loss: 1.1793 
Train step: 3420 acc:0.96652 total_loss: 0.28327  loss:0.81806,stance loss: 1.2464 
Train step: 3430 acc:0.96711 total_loss: 0.31734  loss:0.099054,stance loss: 0.043558 
Train step: 3440 acc:0.96224 total_loss: 0.32008  loss:0.55868,stance loss: 0.58316 
Train step: 3450 acc:0.95797 total_loss: 0.33069  loss:0.16481,stance loss: 0.15954 
Train step: 3460 acc:0.95404 total_loss: 0.35305  loss:0.48516,stance loss: 0.28466 
Train step: 3470 acc:0.95593 total_loss: 0.33793  loss:0.36846,stance loss: 0.30802 
Train step: 3480 acc:0.95241 total_loss: 0.33382  loss:0.59338,stance loss: 1.02 
Train step: 3490 acc:0.95217 total_loss: 0.32988  loss:0.21165,stance loss: 0.18353 
Train step: 3500 acc:0.95081 total_loss: 0.32916  loss:1.14,stance loss: 1.3375 
Train step: 3510 acc:0.94809 total_loss: 0.33266  loss:0.31269,stance loss: 0.2031 
Train step: 3520 acc:0.94385 total_loss: 0.34252  loss:0.56924,stance loss: 0.41711 
Train step: 3530 acc:0.94475 total_loss: 0.34942  loss:0.73006,stance loss: 1.0842 
Train step: 3540 acc:0.94637 total_loss: 0.34154  loss:0.21363,stance loss: 0.19693 
Train step: 3550 acc:0.94541 total_loss: 0.34355  loss:0.15797,stance loss: 0.10699 
Train step: 3560 acc:0.94568 total_loss: 0.33898  loss:0.14404,stance loss: 0.12277 
Train step: 3570 acc:0.94733 total_loss: 0.33852  loss:0.20775,stance loss: 0.18626 
Train step: 3580 acc:0.94581 total_loss: 0.33693  loss:0.3864,stance loss: 0.35246 
Train step: 3590 acc:0.94571 total_loss: 0.33273  loss:0.69112,stance loss: 0.40704 
Train step: 3600 acc:0.94531 total_loss: 0.33098  loss:0.78722,stance loss: 0.56458 
Train step: 3610 acc:0.94667 total_loss: 0.32221  loss:0.063262,stance loss: 0.026867 
Train step: 3620 acc:0.94627 total_loss: 0.32006  loss:0.058801,stance loss: 0.029158 
Train step: 3630 acc:0.94564 total_loss: 0.32304  loss:0.064135,stance loss: 0.038699 
Train step: 3640 acc:0.94657 total_loss: 0.31808  loss:0.026762,stance loss: 0.008476 
Train step: 3650 acc:0.94598 total_loss: 0.32304  loss:0.65093,stance loss: 0.65936 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.9375 total_loss: 0.28449  loss:0.30084,stance loss: 0.25109 
Train step: 3670 acc:0.95588 total_loss: 0.30237  loss:0.89832,stance loss: 1.3473 
Train step: 3680 acc:0.9537 total_loss: 0.28087  loss:0.59187,stance loss: 0.39147 
Train step: 3690 acc:0.95946 total_loss: 0.28044  loss:0.86208,stance loss: 1.321 
Train step: 3700 acc:0.95745 total_loss: 0.26491  loss:0.16121,stance loss: 0.11304 
Train step: 3710 acc:0.95724 total_loss: 0.26943  loss:0.14034,stance loss: 0.093335 
Train step: 3720 acc:0.96175 total_loss: 0.25558  loss:0.12055,stance loss: 0.092529 
Train step: 3730 acc:0.96104 total_loss: 0.26399  loss:0.92657,stance loss: 0.83488 
Train step: 3740 acc:0.96193 total_loss: 0.2653  loss:0.043318,stance loss: 0.0069114 
Train step: 3750 acc:0.96134 total_loss: 0.25871  loss:0.17452,stance loss: 0.18483 
Train step: 3760 acc:0.96028 total_loss: 0.25795  loss:0.031401,stance loss: 0.0062115 
Train step: 3770 acc:0.961 total_loss: 0.26886  loss:0.9101,stance loss: 1.4013 
Train step: 3780 acc:0.96112 total_loss: 0.26021  loss:0.34856,stance loss: 0.11727 
Train step: 3790 acc:0.95985 total_loss: 0.2593  loss:0.048522,stance loss: 0.011889 
Train step: 3800 acc:0.96131 total_loss: 0.25067  loss:0.10425,stance loss: 0.11286 
Train step: 3810 acc:0.9586 total_loss: 0.25332  loss:0.57072,stance loss: 0.43581 
Train step: 3820 acc:0.95958 total_loss: 0.25282  loss:0.192,stance loss: 0.14444 
Train step: 3830 acc:0.95939 total_loss: 0.25544  loss:0.40403,stance loss: 0.37376 
Train step: 3840 acc:0.96056 total_loss: 0.25037  loss:0.17467,stance loss: 0.17148 
Train step: 3850 acc:0.95971 total_loss: 0.25318  loss:0.61125,stance loss: 1.0309 
Train step: 3860 acc:0.96045 total_loss: 0.24936  loss:0.1715,stance loss: 0.16696 
Train step: 3870 acc:0.96083 total_loss: 0.24549  loss:0.047214,stance loss: 0.011004 
Train step: 3880 acc:0.9598 total_loss: 0.2538  loss:0.45338,stance loss: 0.43106 
Train step: 3890 acc:0.96044 total_loss: 0.25077  loss:0.10326,stance loss: 0.0445 
Train step: 3900 acc:0.95876 total_loss: 0.25325  loss:0.14164,stance loss: 0.017859 
Train step: 3910 acc:0.95841 total_loss: 0.25857  loss:0.26829,stance loss: 0.097177 
Training finished.


Reload the best model with best f1 0.4021476625840953 from path test_outputs/bert-cross-topic/dt/2023-08-14 14-14-42/state_dict


              precision    recall  f1-score   support

           0   0.480418  0.615385  0.539589       299
           1   0.563433  0.580769  0.571970       260
           2   0.482143  0.182432  0.264706       148

    accuracy                       0.512023       707
   macro avg   0.508664  0.459529  0.458755       707
weighted avg   0.511308  0.512023  0.493955       707

Test Acc: 0.512022630834512 F1_ma:0.4021476625840953
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4021476625840953
acc: 0.512022630834512, f1 :0.45875500737929586
classification report: 
              precision    recall  f1-score   support

         Con     0.4804    0.6154    0.5396       299
        None     0.5634    0.5808    0.5720       260
         Pro     0.4821    0.1824    0.2647       148

    accuracy                         0.5120       707
   macro avg     0.5087    0.4595    0.4588       707
weighted avg     0.5113    0.5120    0.4940       707

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 14-33-18', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 14-33-18
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.9088  loss:1.9088,stance loss: 1.7374 
Train step: 10 acc:0.51705 total_loss: 1.6771  loss:1.6277,stance loss: 1.1068 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 20 acc:0.5 total_loss: 1.6787  loss:1.7004,stance loss: 1.2204 
Train step: 30 acc:0.49798 total_loss: 1.6508  loss:1.6012,stance loss: 1.164 
Train step: 40 acc:0.50915 total_loss: 1.6425  loss:1.2551,stance loss: 0.72363 
Train step: 50 acc:0.51838 total_loss: 1.6191  loss:1.7151,stance loss: 1.2033 
Train step: 60 acc:0.52561 total_loss: 1.604  loss:1.3977,stance loss: 0.88652 
Train step: 70 acc:0.53257 total_loss: 1.5918  loss:1.9301,stance loss: 1.4702 
Train step: 80 acc:0.52701 total_loss: 1.5944  loss:1.5539,stance loss: 1.1375 
Train step: 90 acc:0.53365 total_loss: 1.5898  loss:1.4811,stance loss: 1.2179 
Train step: 100 acc:0.53465 total_loss: 1.5856  loss:1.3565,stance loss: 0.91857 
Train step: 110 acc:0.52928 total_loss: 1.5826  loss:1.6514,stance loss: 1.1209 
Train step: 120 acc:0.53048 total_loss: 1.5785  loss:1.5668,stance loss: 1.0529 
Train step: 130 acc:0.53006 total_loss: 1.576  loss:1.7389,stance loss: 0.97648 
Train step: 140 acc:0.53502 total_loss: 1.5681  loss:1.8078,stance loss: 1.7564 
Train step: 150 acc:0.53891 total_loss: 1.5613  loss:1.394,stance loss: 1.1987 
Train step: 160 acc:0.53649 total_loss: 1.5596  loss:1.3536,stance loss: 0.97896 
Train step: 170 acc:0.53728 total_loss: 1.5571  loss:1.5348,stance loss: 1.1443 
Train step: 180 acc:0.53867 total_loss: 1.5523  loss:1.6505,stance loss: 1.7 
Train step: 190 acc:0.53796 total_loss: 1.5495  loss:1.5589,stance loss: 1.1405 
Train step: 200 acc:0.54073 total_loss: 1.546  loss:1.6994,stance loss: 1.2468 
Train step: 210 acc:0.54088 total_loss: 1.543  loss:1.6825,stance loss: 1.2946 
Train step: 220 acc:0.54327 total_loss: 1.5379  loss:1.402,stance loss: 1.1647 
Train step: 230 acc:0.54518 total_loss: 1.5374  loss:1.8311,stance loss: 1.8608 
Train step: 240 acc:0.54642 total_loss: 1.5361  loss:1.421,stance loss: 1.117 
Train step: 250 acc:0.5488 total_loss: 1.5289  loss:1.4367,stance loss: 1.0756 
Train step: 260 acc:0.5496 total_loss: 1.5255  loss:3.8372,stance loss: 6.0811 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.58125 total_loss: 1.4364  loss:1.3461,stance loss: 0.67179 
Train step: 280 acc:0.60313 total_loss: 1.4682  loss:1.3853,stance loss: 1.1677 
Train step: 290 acc:0.60208 total_loss: 1.4384  loss:0.98461,stance loss: 0.51933 
Train step: 300 acc:0.60469 total_loss: 1.4026  loss:1.2678,stance loss: 1.0179 
Train step: 310 acc:0.6125 total_loss: 1.3848  loss:1.4579,stance loss: 1.12 
Train step: 320 acc:0.61042 total_loss: 1.3742  loss:1.4885,stance loss: 1.0155 
Train step: 330 acc:0.60714 total_loss: 1.377  loss:1.4473,stance loss: 1.1342 
Train step: 340 acc:0.60234 total_loss: 1.3754  loss:1.4201,stance loss: 1.0238 
Train step: 350 acc:0.60417 total_loss: 1.3708  loss:1.2854,stance loss: 1.4485 
Train step: 360 acc:0.6075 total_loss: 1.373  loss:1.2388,stance loss: 1.0231 
Train step: 370 acc:0.60795 total_loss: 1.3756  loss:1.7092,stance loss: 1.0959 
Train step: 380 acc:0.61198 total_loss: 1.3751  loss:1.2816,stance loss: 0.93619 
Train step: 390 acc:0.61442 total_loss: 1.3731  loss:1.3259,stance loss: 0.8637 
Train step: 400 acc:0.61786 total_loss: 1.3646  loss:1.3707,stance loss: 1.0605 
Train step: 410 acc:0.62458 total_loss: 1.3589  loss:1.4747,stance loss: 1.6277 
Train step: 420 acc:0.62422 total_loss: 1.3596  loss:1.3756,stance loss: 1.5662 
Train step: 430 acc:0.62243 total_loss: 1.3591  loss:1.3317,stance loss: 0.94494 
Train step: 440 acc:0.62292 total_loss: 1.3569  loss:1.1419,stance loss: 0.65747 
Train step: 450 acc:0.62368 total_loss: 1.3573  loss:1.5513,stance loss: 1.325 
Train step: 460 acc:0.62281 total_loss: 1.3618  loss:1.6344,stance loss: 1.4827 
Train step: 470 acc:0.6253 total_loss: 1.3565  loss:1.0287,stance loss: 0.61463 
Train step: 480 acc:0.62813 total_loss: 1.3515  loss:1.205,stance loss: 1.0366 
Train step: 490 acc:0.63098 total_loss: 1.3424  loss:1.1761,stance loss: 0.80305 
Train step: 500 acc:0.63281 total_loss: 1.3398  loss:1.3649,stance loss: 1.1118 
Train step: 510 acc:0.633 total_loss: 1.3384  loss:1.4371,stance loss: 1.3013 
Train step: 520 acc:0.63413 total_loss: 1.3333  loss:1.2961,stance loss: 1.0775 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.63889 total_loss: 1.347  loss:1.377,stance loss: 1.0796 
Train step: 540 acc:0.67763 total_loss: 1.2555  loss:1.4335,stance loss: 1.189 
Train step: 550 acc:0.66595 total_loss: 1.2632  loss:1.3675,stance loss: 1.0813 
Train step: 560 acc:0.67147 total_loss: 1.2871  loss:1.5612,stance loss: 1.6593 
Train step: 570 acc:0.6824 total_loss: 1.2615  loss:0.99602,stance loss: 0.56326 
Train step: 580 acc:0.68432 total_loss: 1.2475  loss:1.093,stance loss: 0.72788 
Train step: 590 acc:0.68569 total_loss: 1.2305  loss:1.3587,stance loss: 1.1186 
Train step: 600 acc:0.68671 total_loss: 1.2368  loss:1.2829,stance loss: 1.0702 
Train step: 610 acc:0.6889 total_loss: 1.2344  loss:1.1712,stance loss: 0.87602 
Train step: 620 acc:0.68876 total_loss: 1.2344  loss:0.96298,stance loss: 0.68297 
Train step: 630 acc:0.68807 total_loss: 1.2307  loss:1.1807,stance loss: 1.0998 
Train step: 640 acc:0.68382 total_loss: 1.2368  loss:1.8301,stance loss: 1.8614 
Train step: 650 acc:0.6875 total_loss: 1.2295  loss:1.1085,stance loss: 0.92281 
Train step: 660 acc:0.68525 total_loss: 1.2257  loss:1.5094,stance loss: 1.2097 
Train step: 670 acc:0.68582 total_loss: 1.2287  loss:1.3166,stance loss: 1.3388 
Train step: 680 acc:0.68396 total_loss: 1.2289  loss:1.3746,stance loss: 0.95669 
Train step: 690 acc:0.68787 total_loss: 1.2239  loss:1.0744,stance loss: 0.8127 
Train step: 700 acc:0.68541 total_loss: 1.223  loss:1.2948,stance loss: 0.92542 
Train step: 710 acc:0.68585 total_loss: 1.2235  loss:1.5763,stance loss: 1.7419 
Train step: 720 acc:0.68656 total_loss: 1.2208  loss:1.3973,stance loss: 1.1101 
Train step: 730 acc:0.686 total_loss: 1.2193  loss:1.2545,stance loss: 0.9948 
Train step: 740 acc:0.68693 total_loss: 1.2155  loss:0.98895,stance loss: 0.72169 
Train step: 750 acc:0.68641 total_loss: 1.2118  loss:0.89307,stance loss: 0.60014 
Train step: 760 acc:0.68672 total_loss: 1.2108  loss:1.1855,stance loss: 0.80228 
Train step: 770 acc:0.68474 total_loss: 1.2106  loss:1.4334,stance loss: 1.1126 
Train step: 780 acc:0.68678 total_loss: 1.2056  loss:0.7836,stance loss: 0.64722 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.71875 total_loss: 1.2474  loss:1.7624,stance loss: 1.2206 
Train step: 800 acc:0.67708 total_loss: 1.2501  loss:1.2491,stance loss: 1.0211 
Train step: 810 acc:0.69643 total_loss: 1.219  loss:0.88646,stance loss: 0.48868 
Train step: 820 acc:0.70888 total_loss: 1.1842  loss:0.85428,stance loss: 0.62765 
Train step: 830 acc:0.70964 total_loss: 1.1779  loss:1.09,stance loss: 0.82459 
Train step: 840 acc:0.70905 total_loss: 1.1688  loss:1.3271,stance loss: 1.1245 
Train step: 850 acc:0.7114 total_loss: 1.1485  loss:0.74744,stance loss: 0.58696 
Train step: 860 acc:0.71074 total_loss: 1.1503  loss:0.98604,stance loss: 0.81902 
Train step: 870 acc:0.70668 total_loss: 1.1568  loss:0.98213,stance loss: 0.64576 
Train step: 880 acc:0.70982 total_loss: 1.1383  loss:0.83506,stance loss: 0.53825 
Train step: 890 acc:0.71238 total_loss: 1.1398  loss:1.2385,stance loss: 1.2662 
Train step: 900 acc:0.71557 total_loss: 1.1333  loss:1.2977,stance loss: 1.0002 
Train step: 910 acc:0.71533 total_loss: 1.1368  loss:1.2471,stance loss: 0.96986 
Train step: 920 acc:0.71467 total_loss: 1.1383  loss:0.75285,stance loss: 0.44196 
Train step: 930 acc:0.71537 total_loss: 1.1327  loss:1.2541,stance loss: 1.0408 
Train step: 940 acc:0.71559 total_loss: 1.1255  loss:0.97418,stance loss: 0.68587 
Train step: 950 acc:0.71726 total_loss: 1.1207  loss:1.3164,stance loss: 1.5729 
Train step: 960 acc:0.7184 total_loss: 1.1141  loss:0.5972,stance loss: 0.40415 
Train step: 970 acc:0.71809 total_loss: 1.1111  loss:0.87032,stance loss: 0.77797 
Train step: 980 acc:0.71907 total_loss: 1.1085  loss:0.56807,stance loss: 0.30077 
Train step: 990 acc:0.71995 total_loss: 1.1068  loss:0.77181,stance loss: 0.50409 
Train step: 1000 acc:0.72018 total_loss: 1.1016  loss:1.0636,stance loss: 0.65152 
Train step: 1010 acc:0.71711 total_loss: 1.1017  loss:0.91352,stance loss: 0.68355 
Train step: 1020 acc:0.71639 total_loss: 1.108  loss:1.2706,stance loss: 1.3541 
Train step: 1030 acc:0.71699 total_loss: 1.1063  loss:0.81215,stance loss: 0.50332 
Train step: 1040 acc:0.71633 total_loss: 1.1032  loss:0.87074,stance loss: 0.66253 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.74107 total_loss: 0.96166  loss:0.69395,stance loss: 0.58141 
Train step: 1060 acc:0.75 total_loss: 0.99572  loss:1.1654,stance loss: 0.83172 
Train step: 1070 acc:0.75231 total_loss: 0.96831  loss:0.91035,stance loss: 0.73646 
Train step: 1080 acc:0.74831 total_loss: 0.93478  loss:0.98223,stance loss: 0.57502 
Train step: 1090 acc:0.75665 total_loss: 0.94558  loss:0.54435,stance loss: 0.35455 
Train step: 1100 acc:0.75329 total_loss: 0.96276  loss:1.2629,stance loss: 1.5039 
Train step: 1110 acc:0.7472 total_loss: 0.9794  loss:1.1274,stance loss: 0.73878 
Train step: 1120 acc:0.75 total_loss: 0.96929  loss:0.49169,stance loss: 0.33621 
Train step: 1130 acc:0.75144 total_loss: 0.97732  loss:0.61365,stance loss: 0.50471 
Train step: 1140 acc:0.75064 total_loss: 0.96575  loss:0.8293,stance loss: 0.52866 
Train step: 1150 acc:0.75117 total_loss: 0.96844  loss:1.3638,stance loss: 1.1248 
Train step: 1160 acc:0.75374 total_loss: 0.96117  loss:1.2011,stance loss: 1.0136 
Train step: 1170 acc:0.75541 total_loss: 0.96853  loss:1.204,stance loss: 0.90856 
Train step: 1180 acc:0.75411 total_loss: 0.97708  loss:1.228,stance loss: 1.5667 
Train step: 1190 acc:0.75638 total_loss: 0.98034  loss:1.0729,stance loss: 0.85928 
Train step: 1200 acc:0.75557 total_loss: 0.98348  loss:1.3033,stance loss: 0.93854 
Train step: 1210 acc:0.75262 total_loss: 0.98785  loss:0.86981,stance loss: 0.53612 
Train step: 1220 acc:0.75494 total_loss: 0.97872  loss:0.37524,stance loss: 0.2279 
Train step: 1230 acc:0.75267 total_loss: 0.97815  loss:1.2386,stance loss: 1.0772 
Train step: 1240 acc:0.75127 total_loss: 0.97797  loss:1.0639,stance loss: 0.7937 
Train step: 1250 acc:0.75151 total_loss: 0.97805  loss:0.67985,stance loss: 0.6065 
Train step: 1260 acc:0.75346 total_loss: 0.97079  loss:1.0958,stance loss: 1.305 
Train step: 1270 acc:0.75385 total_loss: 0.9679  loss:0.81439,stance loss: 0.70611 
Train step: 1280 acc:0.75422 total_loss: 0.97648  loss:1.0126,stance loss: 0.92543 
Train step: 1290 acc:0.75506 total_loss: 0.97604  loss:0.78789,stance loss: 0.40883 
Train step: 1300 acc:0.75292 total_loss: 0.97758  loss:1.2997,stance loss: 1.1022 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.8125 total_loss: 0.69143  loss:0.60992,stance loss: 0.51793 
Train step: 1320 acc:0.80078 total_loss: 0.81043  loss:1.2456,stance loss: 1.5956 
Train step: 1330 acc:0.79808 total_loss: 0.84113  loss:1.1086,stance loss: 1.0358 
Train step: 1340 acc:0.79861 total_loss: 0.83616  loss:1.0819,stance loss: 0.8742 
Train step: 1350 acc:0.79348 total_loss: 0.83012  loss:0.79885,stance loss: 0.69107 
Train step: 1360 acc:0.79464 total_loss: 0.84888  loss:0.50802,stance loss: 0.34403 
Train step: 1370 acc:0.79545 total_loss: 0.83501  loss:0.88667,stance loss: 0.66741 
Train step: 1380 acc:0.78947 total_loss: 0.83982  loss:0.95981,stance loss: 0.63797 
Train step: 1390 acc:0.78125 total_loss: 0.86151  loss:1.1877,stance loss: 1.0176 
Train step: 1400 acc:0.78385 total_loss: 0.85469  loss:1.005,stance loss: 0.68313 
Train step: 1410 acc:0.78243 total_loss: 0.85798  loss:0.61097,stance loss: 0.52902 
Train step: 1420 acc:0.78071 total_loss: 0.86466  loss:1.1904,stance loss: 0.93582 
Train step: 1430 acc:0.77728 total_loss: 0.87228  loss:1.1302,stance loss: 1.0284 
Train step: 1440 acc:0.77987 total_loss: 0.86747  loss:1.1188,stance loss: 0.99465 
Train step: 1450 acc:0.7774 total_loss: 0.8724  loss:1.3005,stance loss: 1.1538 
Train step: 1460 acc:0.78005 total_loss: 0.86789  loss:0.53833,stance loss: 0.38069 
Train step: 1470 acc:0.77711 total_loss: 0.88263  loss:1.2789,stance loss: 1.3189 
Train step: 1480 acc:0.77663 total_loss: 0.88592  loss:0.84891,stance loss: 0.7328 
Train step: 1490 acc:0.77722 total_loss: 0.8933  loss:1.0685,stance loss: 0.94783 
Train step: 1500 acc:0.77966 total_loss: 0.88986  loss:0.58887,stance loss: 0.42612 
Train step: 1510 acc:0.78277 total_loss: 0.88193  loss:0.52929,stance loss: 0.35942 
Train step: 1520 acc:0.78385 total_loss: 0.87973  loss:1.1486,stance loss: 0.91886 
Train step: 1530 acc:0.7865 total_loss: 0.87561  loss:1.2732,stance loss: 1.2159 
Train step: 1540 acc:0.78469 total_loss: 0.88142  loss:1.4122,stance loss: 1.1153 
Better F1! Saving model!
Saving model of best f1: 0.30581998232832636
              precision    recall  f1-score   support

           0   0.454167  0.729097  0.559692       299
           1   0.588235  0.500000  0.540541       260
           2   0.666667  0.027027  0.051948       148

    accuracy                       0.497878       707
   macro avg   0.569690  0.418708  0.384060       707
weighted avg   0.547954  0.497878  0.446360       707

Test Acc: 0.49787835926449786 F1_ma:0.30581998232832636
Train step: 1550 acc:0.78328 total_loss: 0.87911  loss:0.77123,stance loss: 0.549 
Better F1! Saving model!
Saving model of best f1: 0.3159943382873319
              precision    recall  f1-score   support

           0   0.452632  0.719064  0.555556       299
           1   0.578475  0.496154  0.534161       260
           2   0.666667  0.040541  0.076433       148

    accuracy                       0.495050       707
   macro avg   0.565925  0.418586  0.388717       707
weighted avg   0.543716  0.495050  0.447391       707

Test Acc: 0.49504950495049505 F1_ma:0.3159943382873319
Train step: 1560 acc:0.78418 total_loss: 0.87614  loss:0.99947,stance loss: 0.92782 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.8375 total_loss: 0.58183  loss:0.68801,stance loss: 0.50723 
Train step: 1580 acc:0.83333 total_loss: 0.71972  loss:0.89573,stance loss: 0.78274 
Train step: 1590 acc:0.8475 total_loss: 0.6918  loss:0.41615,stance loss: 0.31961 
Train step: 1600 acc:0.85357 total_loss: 0.7036  loss:0.97539,stance loss: 0.86111 
Train step: 1610 acc:0.84861 total_loss: 0.7288  loss:0.60418,stance loss: 0.47347 
Train step: 1620 acc:0.85795 total_loss: 0.70084  loss:0.30948,stance loss: 0.21025 
Better F1! Saving model!
Saving model of best f1: 0.31891829689298046
              precision    recall  f1-score   support

           0   0.450570  0.792642  0.574545       299
           1   0.602339  0.396154  0.477958       260
           2   0.500000  0.033784  0.063291       148

    accuracy                       0.487977       707
   macro avg   0.517637  0.407527  0.371932       707
weighted avg   0.516731  0.487977  0.432002       707

Test Acc: 0.48797736916548795 F1_ma:0.31891829689298046
Train step: 1630 acc:0.85865 total_loss: 0.70466  loss:0.9413,stance loss: 0.70854 
Train step: 1640 acc:0.84917 total_loss: 0.71741  loss:1.0973,stance loss: 1.0441 
Train step: 1650 acc:0.85 total_loss: 0.72875  loss:0.65078,stance loss: 0.47621 
Train step: 1660 acc:0.84737 total_loss: 0.72783  loss:0.78545,stance loss: 0.51743 
Train step: 1670 acc:0.84405 total_loss: 0.73625  loss:0.87466,stance loss: 0.74013 
Train step: 1680 acc:0.84185 total_loss: 0.73855  loss:0.94831,stance loss: 0.77298 
Train step: 1690 acc:0.8375 total_loss: 0.74975  loss:0.72411,stance loss: 0.56823 
Train step: 1700 acc:0.83472 total_loss: 0.75309  loss:0.75045,stance loss: 0.49265 
Train step: 1710 acc:0.83491 total_loss: 0.74945  loss:0.87849,stance loss: 0.7402 
Train step: 1720 acc:0.83347 total_loss: 0.75497  loss:1.7272,stance loss: 1.5124 
Train step: 1730 acc:0.83561 total_loss: 0.74021  loss:0.41344,stance loss: 0.29898 
Train step: 1740 acc:0.83571 total_loss: 0.7462  loss:0.53715,stance loss: 0.44271 
Train step: 1750 acc:0.83277 total_loss: 0.7558  loss:0.95988,stance loss: 0.61952 
Better F1! Saving model!
Saving model of best f1: 0.31968321421672785
              precision    recall  f1-score   support

           0   0.447761  0.802676  0.574850       299
           1   0.579268  0.365385  0.448113       260
           2   0.714286  0.033784  0.064516       148

    accuracy                       0.480905       707
   macro avg   0.580438  0.400615  0.362493       707
weighted avg   0.551916  0.480905  0.421412       707

Test Acc: 0.4809052333804809 F1_ma:0.31968321421672785
Train step: 1760 acc:0.83205 total_loss: 0.75818  loss:0.50721,stance loss: 0.413 
Train step: 1770 acc:0.83171 total_loss: 0.75784  loss:0.63438,stance loss: 0.44745 
Train step: 1780 acc:0.83227 total_loss: 0.75251  loss:0.69252,stance loss: 0.52814 
Train step: 1790 acc:0.83028 total_loss: 0.75119  loss:0.99601,stance loss: 0.83738 
Train step: 1800 acc:0.83165 total_loss: 0.7458  loss:0.47673,stance loss: 0.44943 
Train step: 1810 acc:0.83265 total_loss: 0.74526  loss:1.0938,stance loss: 0.94977 
Train step: 1820 acc:0.83162 total_loss: 0.75118  loss:1.1425,stance loss: 1.0082 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.89062 total_loss: 0.60366  loss:0.34457,stance loss: 0.21796 
Train step: 1840 acc:0.83482 total_loss: 0.65734  loss:0.19808,stance loss: 0.074844 
Train step: 1850 acc:0.84635 total_loss: 0.64441  loss:0.32072,stance loss: 0.20647 
Train step: 1860 acc:0.84743 total_loss: 0.68556  loss:0.65004,stance loss: 0.47321 
Train step: 1870 acc:0.85085 total_loss: 0.67404  loss:0.58589,stance loss: 0.50783 
Train step: 1880 acc:0.85069 total_loss: 0.67139  loss:0.59841,stance loss: 0.40883 
Better F1! Saving model!
Saving model of best f1: 0.3283401899342535
              precision    recall  f1-score   support

           0   0.450000  0.812709  0.579261       299
           1   0.593750  0.365385  0.452381       260
           2   0.857143  0.040541  0.077419       148

    accuracy                       0.486563       707
   macro avg   0.633631  0.406211  0.369687       707
weighted avg   0.588094  0.486563  0.427548       707

Test Acc: 0.48656294200848654 F1_ma:0.3283401899342535
Train step: 1890 acc:0.85059 total_loss: 0.66927  loss:0.85308,stance loss: 0.87451 
Train step: 1900 acc:0.85051 total_loss: 0.67889  loss:0.6394,stance loss: 0.52927 
Train step: 1910 acc:0.85193 total_loss: 0.67696  loss:1.1389,stance loss: 1.4693 
Train step: 1920 acc:0.8504 total_loss: 0.67297  loss:0.99639,stance loss: 0.77136 
Better F1! Saving model!
Saving model of best f1: 0.34193598387971785
              precision    recall  f1-score   support

           0   0.455487  0.735786  0.562660       299
           1   0.565217  0.450000  0.501071       260
           2   0.588235  0.067568  0.121212       148

    accuracy                       0.490806       707
   macro avg   0.536313  0.417785  0.394981       707
weighted avg   0.523629  0.490806  0.447600       707

Test Acc: 0.4908062234794908 F1_ma:0.34193598387971785
Train step: 1930 acc:0.84495 total_loss: 0.6752  loss:0.49415,stance loss: 0.32528 
Train step: 1940 acc:0.84539 total_loss: 0.68613  loss:0.66617,stance loss: 1.0719 
Train step: 1950 acc:0.84476 total_loss: 0.68626  loss:0.65809,stance loss: 0.62152 
Train step: 1960 acc:0.84562 total_loss: 0.68495  loss:0.54572,stance loss: 0.42716 
Train step: 1970 acc:0.84679 total_loss: 0.68686  loss:0.94217,stance loss: 0.55587 
Train step: 1980 acc:0.84619 total_loss: 0.69701  loss:0.57953,stance loss: 0.47976 
Better F1! Saving model!
Saving model of best f1: 0.3821579532814239
              precision    recall  f1-score   support

           0   0.453782  0.722408  0.557419       299
           1   0.565854  0.446154  0.498925       260
           2   0.692308  0.121622  0.206897       148

    accuracy                       0.495050       707
   macro avg   0.570648  0.430061  0.421080       707
weighted avg   0.544928  0.495050  0.462531       707

Test Acc: 0.49504950495049505 F1_ma:0.3821579532814239
Train step: 1990 acc:0.84604 total_loss: 0.69635  loss:0.38593,stance loss: 0.28048 
Train step: 2000 acc:0.84555 total_loss: 0.69255  loss:0.89315,stance loss: 0.70134 
Train step: 2010 acc:0.84375 total_loss: 0.6946  loss:0.62041,stance loss: 0.5288 
Train step: 2020 acc:0.84633 total_loss: 0.6841  loss:0.52962,stance loss: 0.38004 
Train step: 2030 acc:0.84804 total_loss: 0.68308  loss:1.3438,stance loss: 1.715 
Train step: 2040 acc:0.84901 total_loss: 0.68202  loss:1.1795,stance loss: 1.1991 
Train step: 2050 acc:0.84877 total_loss: 0.6812  loss:0.6207,stance loss: 0.44996 
Train step: 2060 acc:0.84882 total_loss: 0.68103  loss:1.133,stance loss: 0.83204 
Train step: 2070 acc:0.84913 total_loss: 0.67467  loss:0.58883,stance loss: 0.48693 
Train step: 2080 acc:0.84916 total_loss: 0.67413  loss:0.97759,stance loss: 1.1953 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.89583 total_loss: 0.51515  loss:0.55583,stance loss: 0.54353 
Train step: 2100 acc:0.87981 total_loss: 0.60662  loss:0.93794,stance loss: 0.65495 
Train step: 2110 acc:0.88587 total_loss: 0.54805  loss:0.21162,stance loss: 0.10485 
Train step: 2120 acc:0.87311 total_loss: 0.56544  loss:0.41266,stance loss: 0.35063 
Train step: 2130 acc:0.87209 total_loss: 0.57259  loss:0.56856,stance loss: 0.3731 
Train step: 2140 acc:0.87736 total_loss: 0.57386  loss:0.36379,stance loss: 0.18791 
Train step: 2150 acc:0.88393 total_loss: 0.55612  loss:0.54255,stance loss: 0.53885 
Train step: 2160 acc:0.88699 total_loss: 0.5599  loss:0.74029,stance loss: 1.177 
Train step: 2170 acc:0.89006 total_loss: 0.56437  loss:0.33594,stance loss: 0.19562 
Train step: 2180 acc:0.8918 total_loss: 0.55544  loss:0.30315,stance loss: 0.264 
Train step: 2190 acc:0.89381 total_loss: 0.55442  loss:0.76306,stance loss: 1.0242 
Train step: 2200 acc:0.89325 total_loss: 0.55822  loss:1.1301,stance loss: 0.93165 
Train step: 2210 acc:0.89329 total_loss: 0.55788  loss:0.39936,stance loss: 0.22937 
Train step: 2220 acc:0.88957 total_loss: 0.56929  loss:0.36097,stance loss: 0.2911 
Train step: 2230 acc:0.88724 total_loss: 0.56985  loss:0.18262,stance loss: 0.11269 
Train step: 2240 acc:0.88603 total_loss: 0.57605  loss:0.58257,stance loss: 0.55069 
Train step: 2250 acc:0.88229 total_loss: 0.58065  loss:0.84175,stance loss: 0.59855 
Train step: 2260 acc:0.88114 total_loss: 0.58172  loss:0.53508,stance loss: 0.45044 
Train step: 2270 acc:0.87978 total_loss: 0.58008  loss:0.34507,stance loss: 0.23606 
Train step: 2280 acc:0.88018 total_loss: 0.57452  loss:0.43693,stance loss: 0.34892 
Train step: 2290 acc:0.88208 total_loss: 0.56794  loss:0.1793,stance loss: 0.14361 
Train step: 2300 acc:0.88204 total_loss: 0.56457  loss:0.34046,stance loss: 0.26805 
Train step: 2310 acc:0.88201 total_loss: 0.56378  loss:0.22287,stance loss: 0.09993 
Train step: 2320 acc:0.88197 total_loss: 0.56806  loss:0.77653,stance loss: 0.58919 
Train step: 2330 acc:0.88272 total_loss: 0.56597  loss:0.63324,stance loss: 0.58707 
Train step: 2340 acc:0.88266 total_loss: 0.5672  loss:0.22428,stance loss: 0.1753 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.90625 total_loss: 0.55612  loss:0.18363,stance loss: 0.16473 
Train step: 2360 acc:0.90625 total_loss: 0.42381  loss:0.43224,stance loss: 0.35564 
Train step: 2370 acc:0.91193 total_loss: 0.40068  loss:0.3672,stance loss: 0.31677 
Train step: 2380 acc:0.91211 total_loss: 0.40816  loss:0.096326,stance loss: 0.039976 
Train step: 2390 acc:0.91369 total_loss: 0.45721  loss:0.58739,stance loss: 1.0198 
Train step: 2400 acc:0.91466 total_loss: 0.45031  loss:0.22069,stance loss: 0.1558 
Train step: 2410 acc:0.91129 total_loss: 0.46147  loss:0.1899,stance loss: 0.077751 
Train step: 2420 acc:0.90972 total_loss: 0.46356  loss:0.37463,stance loss: 0.31717 
Train step: 2430 acc:0.91082 total_loss: 0.46158  loss:0.61581,stance loss: 0.38376 
Train step: 2440 acc:0.90897 total_loss: 0.4792  loss:0.29273,stance loss: 0.18969 
Train step: 2450 acc:0.90686 total_loss: 0.48763  loss:1.0006,stance loss: 1.3522 
Train step: 2460 acc:0.90513 total_loss: 0.49536  loss:1.2012,stance loss: 0.98479 
Train step: 2470 acc:0.90523 total_loss: 0.50104  loss:0.45723,stance loss: 0.356 
Train step: 2480 acc:0.90625 total_loss: 0.49895  loss:0.35506,stance loss: 0.30832 
Train step: 2490 acc:0.90449 total_loss: 0.50034  loss:0.39512,stance loss: 0.29065 
Train step: 2500 acc:0.90461 total_loss: 0.50073  loss:0.25873,stance loss: 0.2351 
Train step: 2510 acc:0.90741 total_loss: 0.50169  loss:0.75885,stance loss: 1.1811 
Train step: 2520 acc:0.90625 total_loss: 0.50571  loss:0.27772,stance loss: 0.18382 
Train step: 2530 acc:0.90694 total_loss: 0.50275  loss:0.57358,stance loss: 0.36465 
Train step: 2540 acc:0.90495 total_loss: 0.505  loss:0.73135,stance loss: 0.45693 
Train step: 2550 acc:0.90408 total_loss: 0.50628  loss:0.61256,stance loss: 0.49049 
Train step: 2560 acc:0.90537 total_loss: 0.50299  loss:0.43111,stance loss: 0.32627 
Train step: 2570 acc:0.90315 total_loss: 0.51161  loss:0.38917,stance loss: 0.35795 
Train step: 2580 acc:0.90356 total_loss: 0.50795  loss:0.27574,stance loss: 0.21812 
Train step: 2590 acc:0.90367 total_loss: 0.50761  loss:0.12617,stance loss: 0.068455 
Train step: 2600 acc:0.90427 total_loss: 0.50386  loss:0.15757,stance loss: 0.094179 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.81745  loss:0.81745,stance loss: 1.1349 
Train step: 2620 acc:0.91477 total_loss: 0.47958  loss:0.27977,stance loss: 0.11176 
Train step: 2630 acc:0.91667 total_loss: 0.47501  loss:0.48713,stance loss: 0.51438 
Train step: 2640 acc:0.90927 total_loss: 0.51891  loss:0.42728,stance loss: 0.32791 
Train step: 2650 acc:0.91768 total_loss: 0.46858  loss:0.21618,stance loss: 0.10669 
Train step: 2660 acc:0.92034 total_loss: 0.45  loss:0.51382,stance loss: 0.41848 
Train step: 2670 acc:0.92418 total_loss: 0.45044  loss:0.45443,stance loss: 0.39828 
Train step: 2680 acc:0.92606 total_loss: 0.45889  loss:0.34688,stance loss: 0.29785 
Train step: 2690 acc:0.92438 total_loss: 0.45269  loss:0.15307,stance loss: 0.067581 
Train step: 2700 acc:0.9217 total_loss: 0.46255  loss:0.31306,stance loss: 0.23953 
Train step: 2710 acc:0.9245 total_loss: 0.45888  loss:0.20418,stance loss: 0.14896 
Train step: 2720 acc:0.92342 total_loss: 0.45339  loss:0.19773,stance loss: 0.13418 
Train step: 2730 acc:0.92407 total_loss: 0.44448  loss:0.1884,stance loss: 0.177 
Train step: 2740 acc:0.92366 total_loss: 0.44618  loss:0.31611,stance loss: 0.26107 
Train step: 2750 acc:0.9242 total_loss: 0.45122  loss:0.20052,stance loss: 0.15477 
Train step: 2760 acc:0.92591 total_loss: 0.44331  loss:0.082285,stance loss: 0.024793 
Train step: 2770 acc:0.9243 total_loss: 0.44483  loss:0.45749,stance loss: 0.26974 
Train step: 2780 acc:0.92434 total_loss: 0.43876  loss:0.29531,stance loss: 0.15763 
Train step: 2790 acc:0.92472 total_loss: 0.43808  loss:0.21657,stance loss: 0.14072 
Train step: 2800 acc:0.92605 total_loss: 0.43789  loss:0.59762,stance loss: 1.0196 
Train step: 2810 acc:0.92662 total_loss: 0.44245  loss:0.96573,stance loss: 0.61656 
Train step: 2820 acc:0.92595 total_loss: 0.43992  loss:0.27143,stance loss: 0.20995 
Train step: 2830 acc:0.92477 total_loss: 0.44064  loss:0.62852,stance loss: 1.097 
Train step: 2840 acc:0.92262 total_loss: 0.44178  loss:0.59832,stance loss: 1.0438 
Train step: 2850 acc:0.92168 total_loss: 0.44205  loss:0.056476,stance loss: 0.016763 
Train step: 2860 acc:0.92181 total_loss: 0.43892  loss:0.31872,stance loss: 0.25114 
Train step: 2870 acc:0.92097 total_loss: 0.43647  loss:0.036509,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9625 total_loss: 0.3531  loss:0.20694,stance loss: 0.15032 
Train step: 2890 acc:0.95312 total_loss: 0.30954  loss:0.34181,stance loss: 0.33547 
Train step: 2900 acc:0.95208 total_loss: 0.34251  loss:1.1247,stance loss: 1.3634 
Train step: 2910 acc:0.94688 total_loss: 0.35569  loss:0.12994,stance loss: 0.091977 
Train step: 2920 acc:0.945 total_loss: 0.374  loss:0.26349,stance loss: 0.25035 
Train step: 2930 acc:0.94583 total_loss: 0.3787  loss:0.13491,stance loss: 0.10974 
Train step: 2940 acc:0.94732 total_loss: 0.36495  loss:0.24377,stance loss: 0.17431 
Train step: 2950 acc:0.94609 total_loss: 0.36289  loss:0.15121,stance loss: 0.079982 
Train step: 2960 acc:0.94375 total_loss: 0.39387  loss:0.24448,stance loss: 0.2175 
Train step: 2970 acc:0.94125 total_loss: 0.40203  loss:0.39972,stance loss: 0.31817 
Train step: 2980 acc:0.94261 total_loss: 0.38416  loss:0.45022,stance loss: 0.39265 
Train step: 2990 acc:0.94271 total_loss: 0.37987  loss:0.26297,stance loss: 0.18863 
Train step: 3000 acc:0.93942 total_loss: 0.38604  loss:0.19845,stance loss: 0.093719 
Train step: 3010 acc:0.93884 total_loss: 0.38943  loss:0.51176,stance loss: 0.38304 
Train step: 3020 acc:0.93958 total_loss: 0.38495  loss:0.1215,stance loss: 0.067033 
Train step: 3030 acc:0.94063 total_loss: 0.37911  loss:0.10905,stance loss: 0.088804 
Train step: 3040 acc:0.94081 total_loss: 0.37273  loss:0.23468,stance loss: 0.18147 
Train step: 3050 acc:0.94063 total_loss: 0.36815  loss:0.091097,stance loss: 0.031378 
Train step: 3060 acc:0.94145 total_loss: 0.36638  loss:0.25839,stance loss: 0.23556 
Train step: 3070 acc:0.94188 total_loss: 0.36121  loss:0.24441,stance loss: 0.1883 
Train step: 3080 acc:0.94167 total_loss: 0.36035  loss:0.16528,stance loss: 0.13994 
Train step: 3090 acc:0.94205 total_loss: 0.36182  loss:0.23942,stance loss: 0.25687 
Train step: 3100 acc:0.9413 total_loss: 0.35889  loss:0.56501,stance loss: 0.35995 
Train step: 3110 acc:0.94063 total_loss: 0.36237  loss:0.14325,stance loss: 0.11155 
Train step: 3120 acc:0.941 total_loss: 0.35749  loss:0.054309,stance loss: 0.037022 
Train step: 3130 acc:0.93942 total_loss: 0.36233  loss:0.39831,stance loss: 0.29137 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.93056 total_loss: 0.38145  loss:0.54913,stance loss: 0.40192 
Train step: 3150 acc:0.92105 total_loss: 0.41922  loss:0.24415,stance loss: 0.24429 
Train step: 3160 acc:0.93103 total_loss: 0.36285  loss:0.52157,stance loss: 0.47366 
Train step: 3170 acc:0.94071 total_loss: 0.33072  loss:0.19351,stance loss: 0.18175 
Train step: 3180 acc:0.9477 total_loss: 0.30208  loss:0.082673,stance loss: 0.042375 
Train step: 3190 acc:0.94809 total_loss: 0.30998  loss:0.089622,stance loss: 0.072673 
Train step: 3200 acc:0.95199 total_loss: 0.28673  loss:0.30956,stance loss: 0.23866 
Train step: 3210 acc:0.95411 total_loss: 0.27188  loss:0.046682,stance loss: 0.018011 
Train step: 3220 acc:0.95295 total_loss: 0.2732  loss:0.23014,stance loss: 0.21492 
Train step: 3230 acc:0.95076 total_loss: 0.27841  loss:1.0649,stance loss: 1.5821 
Train step: 3240 acc:0.95183 total_loss: 0.2777  loss:0.10512,stance loss: 0.060245 
Train step: 3250 acc:0.95063 total_loss: 0.27884  loss:0.27987,stance loss: 0.28113 
Train step: 3260 acc:0.95058 total_loss: 0.29017  loss:0.15625,stance loss: 0.11422 
Train step: 3270 acc:0.95144 total_loss: 0.28767  loss:0.22092,stance loss: 0.19667 
Train step: 3280 acc:0.9505 total_loss: 0.29169  loss:0.27166,stance loss: 0.02672 
Train step: 3290 acc:0.95047 total_loss: 0.29118  loss:0.33025,stance loss: 0.27317 
Train step: 3300 acc:0.95044 total_loss: 0.29493  loss:0.84421,stance loss: 1.2455 
Train step: 3310 acc:0.95042 total_loss: 0.29013  loss:0.033342,stance loss: 0.0096565 
Train step: 3320 acc:0.95172 total_loss: 0.28517  loss:0.10015,stance loss: 0.038401 
Train step: 3330 acc:0.95195 total_loss: 0.28756  loss:0.63478,stance loss: 0.73035 
Train step: 3340 acc:0.95215 total_loss: 0.28528  loss:0.31812,stance loss: 0.24757 
Train step: 3350 acc:0.95234 total_loss: 0.28472  loss:0.092879,stance loss: 0.06938 
Train step: 3360 acc:0.95197 total_loss: 0.28627  loss:0.23271,stance loss: 0.28071 
Train step: 3370 acc:0.9511 total_loss: 0.28888  loss:0.15009,stance loss: 0.066355 
Train step: 3380 acc:0.95105 total_loss: 0.29002  loss:0.064095,stance loss: 0.03099 
Train step: 3390 acc:0.95053 total_loss: 0.29357  loss:0.81581,stance loss: 0.62118 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.96094 total_loss: 0.34305  loss:0.15029,stance loss: 0.093399 
Train step: 3410 acc:0.95833 total_loss: 0.28346  loss:0.3978,stance loss: 0.43637 
Train step: 3420 acc:0.95982 total_loss: 0.30978  loss:0.17446,stance loss: 0.1799 
Train step: 3430 acc:0.95724 total_loss: 0.27561  loss:0.049197,stance loss: 0.0075191 
Train step: 3440 acc:0.94792 total_loss: 0.28798  loss:0.21165,stance loss: 0.14787 
Train step: 3450 acc:0.94828 total_loss: 0.29052  loss:0.097478,stance loss: 0.076198 
Train step: 3460 acc:0.94945 total_loss: 0.29833  loss:0.44921,stance loss: 0.37676 
Train step: 3470 acc:0.94712 total_loss: 0.29814  loss:0.063275,stance loss: 0.033829 
Train step: 3480 acc:0.94957 total_loss: 0.29598  loss:0.094084,stance loss: 0.067448 
Train step: 3490 acc:0.94962 total_loss: 0.29058  loss:0.086375,stance loss: 0.06861 
Train step: 3500 acc:0.94965 total_loss: 0.29334  loss:0.10188,stance loss: 0.016973 
Train step: 3510 acc:0.95127 total_loss: 0.28517  loss:0.10053,stance loss: 0.056618 
Train step: 3520 acc:0.95068 total_loss: 0.28672  loss:0.068645,stance loss: 0.01385 
Train step: 3530 acc:0.95154 total_loss: 0.28574  loss:0.18971,stance loss: 0.12612 
Train step: 3540 acc:0.9527 total_loss: 0.28211  loss:1.0021,stance loss: 1.3928 
Train step: 3550 acc:0.95332 total_loss: 0.2829  loss:0.092278,stance loss: 0.044642 
Train step: 3560 acc:0.95387 total_loss: 0.28083  loss:0.13705,stance loss: 0.096993 
Train step: 3570 acc:0.95471 total_loss: 0.28168  loss:0.094505,stance loss: 0.066256 
Better F1! Saving model!
Saving model of best f1: 0.41060105504342725
              precision    recall  f1-score   support

           0   0.447537  0.698997  0.545692       299
           1   0.567708  0.419231  0.482301       260
           2   0.562500  0.182432  0.275510       148

    accuracy                       0.487977       707
   macro avg   0.525915  0.433553  0.434501       707
weighted avg   0.515796  0.487977  0.465821       707

Test Acc: 0.48797736916548795 F1_ma:0.41060105504342725
Train step: 3580 acc:0.95412 total_loss: 0.28402  loss:0.35781,stance loss: 0.41176 
Train step: 3590 acc:0.95486 total_loss: 0.28737  loss:0.63177,stance loss: 0.53394 
Train step: 3600 acc:0.95433 total_loss: 0.28394  loss:0.48662,stance loss: 0.41186 
Train step: 3610 acc:0.95442 total_loss: 0.28514  loss:0.11731,stance loss: 0.1088 
Train step: 3620 acc:0.9545 total_loss: 0.28387  loss:0.6569,stance loss: 1.0635 
Train step: 3630 acc:0.95457 total_loss: 0.28246  loss:0.50447,stance loss: 0.50767 
Train step: 3640 acc:0.95464 total_loss: 0.27904  loss:0.021184,stance loss: 0.0041033 
Train step: 3650 acc:0.9547 total_loss: 0.27793  loss:0.13555,stance loss: 0.1229 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.97321 total_loss: 0.24614  loss:0.063402,stance loss: 0.036712 
Train step: 3670 acc:0.98162 total_loss: 0.21079  loss:0.054975,stance loss: 0.0080526 
Train step: 3680 acc:0.9838 total_loss: 0.19031  loss:0.15419,stance loss: 0.080112 
Train step: 3690 acc:0.97466 total_loss: 0.26253  loss:0.35829,stance loss: 0.39693 
Train step: 3700 acc:0.9734 total_loss: 0.24914  loss:0.08063,stance loss: 0.007059 
Train step: 3710 acc:0.97259 total_loss: 0.23437  loss:0.075002,stance loss: 0.0066468 
Train step: 3720 acc:0.97575 total_loss: 0.21727  loss:0.038165,stance loss: 0.0014963 
Train step: 3730 acc:0.97727 total_loss: 0.21339  loss:0.062554,stance loss: 0.031934 
Train step: 3740 acc:0.97629 total_loss: 0.21515  loss:0.61558,stance loss: 0.36006 
Train step: 3750 acc:0.9768 total_loss: 0.20676  loss:0.044828,stance loss: 0.022674 
Train step: 3760 acc:0.97488 total_loss: 0.2048  loss:0.25268,stance loss: 0.16423 
Train step: 3770 acc:0.97382 total_loss: 0.20519  loss:0.23123,stance loss: 0.13317 
Train step: 3780 acc:0.97589 total_loss: 0.2002  loss:0.021283,stance loss: 0.00086304 
Train step: 3790 acc:0.97445 total_loss: 0.19617  loss:0.035721,stance loss: 0.004355 
Train step: 3800 acc:0.97449 total_loss: 0.19101  loss:0.086825,stance loss: 0.008686 
Train step: 3810 acc:0.97373 total_loss: 0.20137  loss:0.61434,stance loss: 1.0598 
Train step: 3820 acc:0.97305 total_loss: 0.20102  loss:0.09657,stance loss: 0.043123 
Train step: 3830 acc:0.9721 total_loss: 0.2056  loss:0.245,stance loss: 0.0048512 
Train step: 3840 acc:0.97293 total_loss: 0.20659  loss:0.56538,stance loss: 1.0389 
Train step: 3850 acc:0.97208 total_loss: 0.21146  loss:0.11281,stance loss: 0.078692 
Train step: 3860 acc:0.97222 total_loss: 0.21336  loss:0.15115,stance loss: 0.051074 
Train step: 3870 acc:0.9712 total_loss: 0.22044  loss:0.055422,stance loss: 0.032925 
Train step: 3880 acc:0.97026 total_loss: 0.22746  loss:0.68179,stance loss: 1.1311 
Train step: 3890 acc:0.96994 total_loss: 0.22507  loss:0.096294,stance loss: 0.043725 
Train step: 3900 acc:0.96938 total_loss: 0.22607  loss:0.51777,stance loss: 0.44575 
Train step: 3910 acc:0.96911 total_loss: 0.22639  loss:0.52681,stance loss: 0.5273 
Training finished.


Reload the best model with best f1 0.41060105504342725 from path test_outputs/bert-cross-topic/dt/2023-08-14 14-33-18/state_dict


              precision    recall  f1-score   support

           0   0.447537  0.698997  0.545692       299
           1   0.567708  0.419231  0.482301       260
           2   0.562500  0.182432  0.275510       148

    accuracy                       0.487977       707
   macro avg   0.525915  0.433553  0.434501       707
weighted avg   0.515796  0.487977  0.465821       707

Test Acc: 0.48797736916548795 F1_ma:0.41060105504342725
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.41060105504342725
acc: 0.48797736916548795, f1 :0.43450099834753564
classification report: 
              precision    recall  f1-score   support

         Con     0.4475    0.6990    0.5457       299
        None     0.5677    0.4192    0.4823       260
         Pro     0.5625    0.1824    0.2755       148

    accuracy                         0.4880       707
   macro avg     0.5259    0.4336    0.4345       707
weighted avg     0.5158    0.4880    0.4658       707

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 14-51-42', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 14-51-42
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.6421  loss:1.6421,stance loss: 0.98873 
Train step: 10 acc:0.45455 total_loss: 1.6726  loss:1.6729,stance loss: 1.2144 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 20 acc:0.4881 total_loss: 1.6462  loss:1.7058,stance loss: 1.15 
Train step: 30 acc:0.50202 total_loss: 1.6507  loss:1.7819,stance loss: 1.6831 
Train step: 40 acc:0.50152 total_loss: 1.6368  loss:1.6199,stance loss: 1.6823 
Train step: 50 acc:0.51471 total_loss: 1.6272  loss:1.6599,stance loss: 1.6372 
Train step: 60 acc:0.51537 total_loss: 1.6181  loss:1.6558,stance loss: 1.1717 
Train step: 70 acc:0.5088 total_loss: 1.6217  loss:1.6177,stance loss: 1.1443 
Train step: 80 acc:0.5108 total_loss: 1.6082  loss:1.6699,stance loss: 1.2523 
Train step: 90 acc:0.5261 total_loss: 1.5869  loss:1.1867,stance loss: 0.77452 
Train step: 100 acc:0.52537 total_loss: 1.5811  loss:1.7886,stance loss: 1.288 
Train step: 110 acc:0.52646 total_loss: 1.5812  loss:1.6418,stance loss: 1.0961 
Train step: 120 acc:0.52324 total_loss: 1.5783  loss:1.3849,stance loss: 1.0303 
Train step: 130 acc:0.52624 total_loss: 1.5699  loss:1.5491,stance loss: 1.2324 
Train step: 140 acc:0.53236 total_loss: 1.5623  loss:1.3233,stance loss: 0.92713 
Train step: 150 acc:0.53146 total_loss: 1.5595  loss:1.351,stance loss: 0.85852 
Train step: 160 acc:0.53766 total_loss: 1.5516  loss:1.1958,stance loss: 0.75687 
Train step: 170 acc:0.54276 total_loss: 1.5455  loss:1.1518,stance loss: 0.8339 
Train step: 180 acc:0.54593 total_loss: 1.5394  loss:1.2895,stance loss: 0.84111 
Train step: 190 acc:0.54777 total_loss: 1.5392  loss:1.3939,stance loss: 1.0841 
Train step: 200 acc:0.54789 total_loss: 1.5348  loss:1.461,stance loss: 1.0744 
Train step: 210 acc:0.54858 total_loss: 1.5316  loss:1.5116,stance loss: 1.1745 
Train step: 220 acc:0.55062 total_loss: 1.5245  loss:1.4257,stance loss: 1.1507 
Train step: 230 acc:0.5487 total_loss: 1.5236  loss:1.6899,stance loss: 1.0977 
Train step: 240 acc:0.55135 total_loss: 1.5212  loss:1.555,stance loss: 0.99297 
Train step: 250 acc:0.55428 total_loss: 1.5151  loss:1.1119,stance loss: 0.6262 
Train step: 260 acc:0.55801 total_loss: 1.51  loss:0.79896,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.68125 total_loss: 1.3496  loss:1.6444,stance loss: 1.6924 
Train step: 280 acc:0.64375 total_loss: 1.3903  loss:1.4652,stance loss: 1.3514 
Train step: 290 acc:0.6375 total_loss: 1.3963  loss:1.3138,stance loss: 0.94502 
Train step: 300 acc:0.64687 total_loss: 1.3883  loss:1.5914,stance loss: 1.4855 
Train step: 310 acc:0.63875 total_loss: 1.3941  loss:1.5752,stance loss: 1.231 
Train step: 320 acc:0.64479 total_loss: 1.3935  loss:1.2944,stance loss: 1.0355 
Train step: 330 acc:0.64375 total_loss: 1.3798  loss:1.307,stance loss: 0.77294 
Train step: 340 acc:0.65156 total_loss: 1.3741  loss:1.5353,stance loss: 1.2072 
Train step: 350 acc:0.65069 total_loss: 1.3672  loss:1.2467,stance loss: 0.95029 
Train step: 360 acc:0.6575 total_loss: 1.3581  loss:1.2601,stance loss: 0.95766 
Train step: 370 acc:0.65341 total_loss: 1.3597  loss:1.1196,stance loss: 0.66437 
Train step: 380 acc:0.65677 total_loss: 1.3543  loss:1.7275,stance loss: 1.3237 
Train step: 390 acc:0.65529 total_loss: 1.3543  loss:1.3911,stance loss: 1.1747 
Train step: 400 acc:0.66027 total_loss: 1.3459  loss:1.0505,stance loss: 0.78084 
Train step: 410 acc:0.66292 total_loss: 1.3418  loss:1.8995,stance loss: 1.8189 
Train step: 420 acc:0.66406 total_loss: 1.3399  loss:1.5374,stance loss: 1.2809 
Train step: 430 acc:0.66544 total_loss: 1.3346  loss:1.1228,stance loss: 0.9755 
Train step: 440 acc:0.67153 total_loss: 1.3202  loss:1.3407,stance loss: 0.95644 
Train step: 450 acc:0.66645 total_loss: 1.3272  loss:1.8698,stance loss: 1.4813 
Train step: 460 acc:0.66875 total_loss: 1.3285  loss:1.5954,stance loss: 1.7151 
Train step: 470 acc:0.66726 total_loss: 1.3293  loss:1.2086,stance loss: 0.96933 
Train step: 480 acc:0.66563 total_loss: 1.3273  loss:1.1885,stance loss: 0.87564 
Train step: 490 acc:0.67092 total_loss: 1.3226  loss:1.1839,stance loss: 1.1508 
Train step: 500 acc:0.66927 total_loss: 1.3223  loss:0.9968,stance loss: 0.73347 
Train step: 510 acc:0.67075 total_loss: 1.318  loss:1.5624,stance loss: 1.5998 
Train step: 520 acc:0.67236 total_loss: 1.3154  loss:0.96885,stance loss: 0.61987 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.67361 total_loss: 1.2385  loss:1.0584,stance loss: 0.72882 
Train step: 540 acc:0.68092 total_loss: 1.2682  loss:1.1121,stance loss: 0.78844 
Train step: 550 acc:0.68319 total_loss: 1.2819  loss:1.3565,stance loss: 1.4637 
Train step: 560 acc:0.69551 total_loss: 1.2421  loss:0.89031,stance loss: 0.51166 
Train step: 570 acc:0.70663 total_loss: 1.207  loss:0.99035,stance loss: 0.81689 
Train step: 580 acc:0.70233 total_loss: 1.2108  loss:0.96598,stance loss: 0.69182 
Train step: 590 acc:0.69203 total_loss: 1.2171  loss:1.0233,stance loss: 0.70035 
Train step: 600 acc:0.70095 total_loss: 1.2119  loss:1.3624,stance loss: 1.1544 
Train step: 610 acc:0.69242 total_loss: 1.2285  loss:1.3522,stance loss: 0.94702 
Train step: 620 acc:0.69192 total_loss: 1.2278  loss:1.0006,stance loss: 0.73734 
Train step: 630 acc:0.69094 total_loss: 1.23  loss:1.2663,stance loss: 0.99601 
Train step: 640 acc:0.6938 total_loss: 1.2253  loss:1.1633,stance loss: 0.92677 
Train step: 650 acc:0.69428 total_loss: 1.2246  loss:1.151,stance loss: 0.83357 
Train step: 660 acc:0.69739 total_loss: 1.2194  loss:1.4508,stance loss: 1.0524 
Train step: 670 acc:0.69757 total_loss: 1.215  loss:1.1901,stance loss: 0.80762 
Train step: 680 acc:0.69693 total_loss: 1.2134  loss:0.94713,stance loss: 0.7777 
Train step: 690 acc:0.69453 total_loss: 1.2146  loss:0.85254,stance loss: 0.62245 
Train step: 700 acc:0.69588 total_loss: 1.2104  loss:0.92034,stance loss: 0.74804 
Train step: 710 acc:0.69808 total_loss: 1.2056  loss:0.94149,stance loss: 0.78995 
Train step: 720 acc:0.70101 total_loss: 1.1992  loss:0.88673,stance loss: 0.69421 
Train step: 730 acc:0.70036 total_loss: 1.2019  loss:1.4619,stance loss: 1.1633 
Train step: 740 acc:0.70006 total_loss: 1.1986  loss:1.1968,stance loss: 0.92768 
Train step: 750 acc:0.69924 total_loss: 1.2039  loss:1.268,stance loss: 1.1226 
Train step: 760 acc:0.70319 total_loss: 1.1986  loss:1.287,stance loss: 1.2737 
Train step: 770 acc:0.70206 total_loss: 1.2023  loss:1.0754,stance loss: 0.68068 
Train step: 780 acc:0.70101 total_loss: 1.207  loss:0.69352,stance loss: 0.51244 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.71094 total_loss: 1.2736  loss:1.1106,stance loss: 0.7337 
Train step: 800 acc:0.72917 total_loss: 1.1405  loss:1.3043,stance loss: 1.034 
Train step: 810 acc:0.73884 total_loss: 1.1223  loss:0.9858,stance loss: 0.87734 
Train step: 820 acc:0.73684 total_loss: 1.1283  loss:1.4395,stance loss: 1.1944 
Train step: 830 acc:0.72786 total_loss: 1.1257  loss:1.351,stance loss: 0.85475 
Train step: 840 acc:0.72306 total_loss: 1.1393  loss:0.74905,stance loss: 0.51672 
Train step: 850 acc:0.71691 total_loss: 1.1589  loss:0.73117,stance loss: 0.48665 
Train step: 860 acc:0.71955 total_loss: 1.1505  loss:1.2735,stance loss: 1.1194 
Train step: 870 acc:0.71733 total_loss: 1.1487  loss:1.0147,stance loss: 0.75428 
Train step: 880 acc:0.72066 total_loss: 1.1444  loss:1.6417,stance loss: 1.8099 
Train step: 890 acc:0.7228 total_loss: 1.135  loss:1.7379,stance loss: 1.159 
Train step: 900 acc:0.72617 total_loss: 1.1161  loss:0.86747,stance loss: 0.68596 
Train step: 910 acc:0.729 total_loss: 1.1137  loss:1.0473,stance loss: 1.0538 
Train step: 920 acc:0.72871 total_loss: 1.1128  loss:0.68423,stance loss: 0.54086 
Train step: 930 acc:0.72973 total_loss: 1.121  loss:1.6577,stance loss: 1.7746 
Train step: 940 acc:0.72627 total_loss: 1.1227  loss:1.3694,stance loss: 0.92892 
Train step: 950 acc:0.7247 total_loss: 1.1268  loss:1.2547,stance loss: 0.92908 
Train step: 960 acc:0.72647 total_loss: 1.127  loss:0.76198,stance loss: 0.51991 
Train step: 970 acc:0.72606 total_loss: 1.1268  loss:1.3461,stance loss: 1.4514 
Train step: 980 acc:0.72633 total_loss: 1.1292  loss:1.4589,stance loss: 1.03 
Train step: 990 acc:0.72476 total_loss: 1.134  loss:1.8405,stance loss: 1.7323 
Train step: 1000 acc:0.72592 total_loss: 1.1267  loss:1.3121,stance loss: 1.0919 
Train step: 1010 acc:0.72697 total_loss: 1.1194  loss:1.1265,stance loss: 0.83863 
Train step: 1020 acc:0.72453 total_loss: 1.122  loss:1.4922,stance loss: 1.1544 
Train step: 1030 acc:0.72429 total_loss: 1.1194  loss:0.77614,stance loss: 0.62618 
Train step: 1040 acc:0.72771 total_loss: 1.1162  loss:1.0982,stance loss: 1.0589 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.73214 total_loss: 1.2015  loss:1.5797,stance loss: 1.6337 
Train step: 1060 acc:0.71324 total_loss: 1.1562  loss:1.6124,stance loss: 1.1977 
Train step: 1070 acc:0.73148 total_loss: 1.1165  loss:0.98339,stance loss: 0.75151 
Train step: 1080 acc:0.74831 total_loss: 1.0582  loss:0.68679,stance loss: 0.58174 
Train step: 1090 acc:0.73803 total_loss: 1.0501  loss:1.1638,stance loss: 1.1519 
Train step: 1100 acc:0.74671 total_loss: 1.0432  loss:0.92115,stance loss: 0.8307 
Train step: 1110 acc:0.74534 total_loss: 1.0433  loss:0.98259,stance loss: 0.74078 
Train step: 1120 acc:0.75244 total_loss: 1.0345  loss:0.78371,stance loss: 0.58822 
Train step: 1130 acc:0.75144 total_loss: 1.0414  loss:0.48633,stance loss: 0.32052 
Train step: 1140 acc:0.75387 total_loss: 1.0333  loss:1.0113,stance loss: 0.85075 
Train step: 1150 acc:0.7611 total_loss: 1.0224  loss:1.4184,stance loss: 1.0665 
Train step: 1160 acc:0.76229 total_loss: 1.019  loss:1.1973,stance loss: 1.0157 
Train step: 1170 acc:0.75935 total_loss: 1.0296  loss:1.4185,stance loss: 1.0533 
Train step: 1180 acc:0.7573 total_loss: 1.0377  loss:1.4557,stance loss: 1.1404 
Train step: 1190 acc:0.75425 total_loss: 1.0412  loss:1.4468,stance loss: 1.1925 
Train step: 1200 acc:0.7492 total_loss: 1.0503  loss:1.3643,stance loss: 1.2068 
Train step: 1210 acc:0.75112 total_loss: 1.0484  loss:0.88035,stance loss: 0.66014 
Train step: 1220 acc:0.75106 total_loss: 1.0451  loss:0.81023,stance loss: 0.61145 
Train step: 1230 acc:0.74967 total_loss: 1.0507  loss:1.3355,stance loss: 1.1857 
Train step: 1240 acc:0.74905 total_loss: 1.0541  loss:1.1285,stance loss: 1.1965 
Train step: 1250 acc:0.74607 total_loss: 1.0501  loss:0.49461,stance loss: 0.32195 
Train step: 1260 acc:0.74741 total_loss: 1.0442  loss:1.0509,stance loss: 0.83259 
Train step: 1270 acc:0.74862 total_loss: 1.0415  loss:1.4753,stance loss: 1.6862 
Train step: 1280 acc:0.74895 total_loss: 1.036  loss:1.0361,stance loss: 0.80946 
Train step: 1290 acc:0.74873 total_loss: 1.0346  loss:0.91342,stance loss: 0.73022 
Train step: 1300 acc:0.7466 total_loss: 1.0416  loss:1.0236,stance loss: 0.91974 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.79167 total_loss: 0.86565  loss:0.94315,stance loss: 0.7222 
Train step: 1320 acc:0.75 total_loss: 1.0039  loss:0.60738,stance loss: 0.51875 
Train step: 1330 acc:0.75962 total_loss: 0.96128  loss:1.0809,stance loss: 0.85266 
Train step: 1340 acc:0.75521 total_loss: 0.95112  loss:0.7915,stance loss: 0.61375 
Train step: 1350 acc:0.76766 total_loss: 0.924  loss:0.65909,stance loss: 0.46002 
Train step: 1360 acc:0.76786 total_loss: 0.93125  loss:0.88621,stance loss: 0.63261 
Train step: 1370 acc:0.76231 total_loss: 0.92292  loss:0.6389,stance loss: 0.48334 
Train step: 1380 acc:0.7648 total_loss: 0.91622  loss:1.0504,stance loss: 0.9578 
Train step: 1390 acc:0.76235 total_loss: 0.91338  loss:1.1907,stance loss: 0.98345 
Train step: 1400 acc:0.75781 total_loss: 0.92071  loss:0.83159,stance loss: 0.6242 
Train step: 1410 acc:0.75767 total_loss: 0.92214  loss:0.61109,stance loss: 0.49273 
Train step: 1420 acc:0.76455 total_loss: 0.92904  loss:0.99861,stance loss: 0.87017 
Train step: 1430 acc:0.76488 total_loss: 0.93087  loss:1.0468,stance loss: 0.85414 
Train step: 1440 acc:0.76746 total_loss: 0.92032  loss:0.43002,stance loss: 0.029756 
Train step: 1450 acc:0.76926 total_loss: 0.91567  loss:1.0756,stance loss: 0.93081 
Train step: 1460 acc:0.76883 total_loss: 0.92427  loss:1.0977,stance loss: 0.93191 
Train step: 1470 acc:0.76732 total_loss: 0.93178  loss:1.1679,stance loss: 0.95577 
Train step: 1480 acc:0.77024 total_loss: 0.92272  loss:0.52048,stance loss: 0.35395 
Train step: 1490 acc:0.7705 total_loss: 0.92101  loss:1.3301,stance loss: 1.603 
Train step: 1500 acc:0.76818 total_loss: 0.92473  loss:0.90301,stance loss: 0.76828 
Train step: 1510 acc:0.7676 total_loss: 0.93428  loss:1.1449,stance loss: 1.3242 
Train step: 1520 acc:0.7662 total_loss: 0.94118  loss:0.86658,stance loss: 0.69249 
Train step: 1530 acc:0.76493 total_loss: 0.94211  loss:1.4577,stance loss: 1.5232 
Train step: 1540 acc:0.76589 total_loss: 0.94116  loss:1.1559,stance loss: 1.4407 
Train step: 1550 acc:0.76575 total_loss: 0.94415  loss:0.80868,stance loss: 0.60468 
Train step: 1560 acc:0.76611 total_loss: 0.94391  loss:0.66146,stance loss: 0.52801 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.775 total_loss: 0.92957  loss:0.58234,stance loss: 0.3076 
Train step: 1580 acc:0.775 total_loss: 0.89991  loss:1.395,stance loss: 1.1158 
Train step: 1590 acc:0.7675 total_loss: 0.94305  loss:1.0814,stance loss: 0.77968 
Train step: 1600 acc:0.76786 total_loss: 0.97491  loss:0.57566,stance loss: 0.44652 
Train step: 1610 acc:0.76944 total_loss: 0.95589  loss:0.69138,stance loss: 0.61079 
Train step: 1620 acc:0.77841 total_loss: 0.93101  loss:0.6261,stance loss: 0.50406 
Train step: 1630 acc:0.77885 total_loss: 0.91948  loss:0.72949,stance loss: 0.61912 
Train step: 1640 acc:0.78417 total_loss: 0.89833  loss:0.99291,stance loss: 0.72324 
Train step: 1650 acc:0.78971 total_loss: 0.87424  loss:0.63574,stance loss: 0.54085 
Train step: 1660 acc:0.78618 total_loss: 0.87583  loss:0.86805,stance loss: 0.63398 
Train step: 1670 acc:0.7875 total_loss: 0.86591  loss:0.76628,stance loss: 0.45613 
Train step: 1680 acc:0.78967 total_loss: 0.85763  loss:0.66357,stance loss: 0.54355 
Train step: 1690 acc:0.7915 total_loss: 0.85552  loss:0.68445,stance loss: 0.26318 
Train step: 1700 acc:0.79213 total_loss: 0.85412  loss:1.0291,stance loss: 0.85426 
Train step: 1710 acc:0.79267 total_loss: 0.85458  loss:0.53629,stance loss: 0.42835 
Train step: 1720 acc:0.79073 total_loss: 0.85415  loss:0.54016,stance loss: 0.43475 
Train step: 1730 acc:0.79053 total_loss: 0.85383  loss:1.096,stance loss: 0.90202 
Train step: 1740 acc:0.78821 total_loss: 0.8509  loss:0.92816,stance loss: 0.47134 
Train step: 1750 acc:0.79088 total_loss: 0.84515  loss:0.46528,stance loss: 0.39522 
Train step: 1760 acc:0.79006 total_loss: 0.8434  loss:1.0696,stance loss: 0.78435 
Train step: 1770 acc:0.78872 total_loss: 0.84186  loss:0.42305,stance loss: 0.27003 
Train step: 1780 acc:0.7875 total_loss: 0.84741  loss:1.1743,stance loss: 1.4714 
Train step: 1790 acc:0.78694 total_loss: 0.84225  loss:0.60637,stance loss: 0.4433 
Train step: 1800 acc:0.78697 total_loss: 0.84317  loss:0.75491,stance loss: 0.65984 
Train step: 1810 acc:0.78827 total_loss: 0.83951  loss:0.67721,stance loss: 0.56378 
Train step: 1820 acc:0.7875 total_loss: 0.84286  loss:1.5945,stance loss: 0.92149 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.79688 total_loss: 0.81542  loss:0.7839,stance loss: 0.80948 
Train step: 1840 acc:0.78571 total_loss: 0.81077  loss:1.1271,stance loss: 0.7724 
Train step: 1850 acc:0.8151 total_loss: 0.79994  loss:0.86219,stance loss: 1.1186 
Train step: 1860 acc:0.81066 total_loss: 0.78436  loss:0.90224,stance loss: 0.53881 
Train step: 1870 acc:0.80966 total_loss: 0.79367  loss:0.86501,stance loss: 0.63444 
Train step: 1880 acc:0.81597 total_loss: 0.78057  loss:0.66687,stance loss: 0.58237 
Train step: 1890 acc:0.8125 total_loss: 0.79977  loss:0.78708,stance loss: 0.57936 
Train step: 1900 acc:0.81588 total_loss: 0.7835  loss:0.65261,stance loss: 0.4867 
Train step: 1910 acc:0.81176 total_loss: 0.78336  loss:1.0788,stance loss: 0.64434 
Train step: 1920 acc:0.81383 total_loss: 0.78324  loss:0.54251,stance loss: 0.41249 
Train step: 1930 acc:0.8101 total_loss: 0.7748  loss:0.76277,stance loss: 0.66876 
Train step: 1940 acc:0.80976 total_loss: 0.77312  loss:0.54406,stance loss: 0.43506 
Train step: 1950 acc:0.80847 total_loss: 0.77702  loss:1.4465,stance loss: 1.7227 
Train step: 1960 acc:0.81063 total_loss: 0.76726  loss:0.77297,stance loss: 0.67187 
Train step: 1970 acc:0.81424 total_loss: 0.7644  loss:1.4531,stance loss: 1.8462 
Train step: 1980 acc:0.81169 total_loss: 0.77715  loss:1.3996,stance loss: 1.6605 
Train step: 1990 acc:0.81021 total_loss: 0.7844  loss:0.55558,stance loss: 0.40205 
Train step: 2000 acc:0.8107 total_loss: 0.78655  loss:0.41981,stance loss: 0.28105 
Train step: 2010 acc:0.80842 total_loss: 0.78475  loss:0.71676,stance loss: 0.4986 
Train step: 2020 acc:0.80928 total_loss: 0.78116  loss:0.36454,stance loss: 0.23526 
Train step: 2030 acc:0.81066 total_loss: 0.78093  loss:0.50192,stance loss: 0.41047 
Better F1! Saving model!
Saving model of best f1: 0.3005589430894309
              precision    recall  f1-score   support

           0   0.498195  0.461538  0.479167       299
           1   0.512077  0.815385  0.629080       260
           2   0.625000  0.067568  0.121951       148

    accuracy                       0.509194       707
   macro avg   0.545091  0.448164  0.410066       707
weighted avg   0.529845  0.509194  0.459520       707

Test Acc: 0.5091937765205092 F1_ma:0.3005589430894309
Train step: 2040 acc:0.81162 total_loss: 0.78197  loss:0.94288,stance loss: 1.1463 
Train step: 2050 acc:0.81027 total_loss: 0.77874  loss:0.8408,stance loss: 0.66552 
Train step: 2060 acc:0.81197 total_loss: 0.77031  loss:0.8379,stance loss: 0.69536 
Train step: 2070 acc:0.81301 total_loss: 0.76901  loss:0.5717,stance loss: 0.45997 
Train step: 2080 acc:0.81176 total_loss: 0.77636  loss:0.96936,stance loss: 0.71046 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.66667 total_loss: 0.9232  loss:1.1942,stance loss: 1.5181 
Train step: 2100 acc:0.76923 total_loss: 0.79574  loss:0.8412,stance loss: 0.72101 
Train step: 2110 acc:0.80707 total_loss: 0.74269  loss:0.59941,stance loss: 0.50794 
Train step: 2120 acc:0.81439 total_loss: 0.75588  loss:0.77999,stance loss: 1.0711 
Train step: 2130 acc:0.81541 total_loss: 0.75156  loss:0.26724,stance loss: 0.11724 
Train step: 2140 acc:0.82311 total_loss: 0.72936  loss:0.59417,stance loss: 0.43741 
Train step: 2150 acc:0.82639 total_loss: 0.72399  loss:0.63886,stance loss: 0.6166 
Train step: 2160 acc:0.82962 total_loss: 0.71038  loss:0.58331,stance loss: 0.44201 
Train step: 2170 acc:0.82831 total_loss: 0.71637  loss:0.96518,stance loss: 0.91511 
Train step: 2180 acc:0.83333 total_loss: 0.71099  loss:0.26857,stance loss: 0.14114 
Train step: 2190 acc:0.83556 total_loss: 0.70871  loss:0.39152,stance loss: 0.29613 
Train step: 2200 acc:0.83573 total_loss: 0.70483  loss:0.69157,stance loss: 0.51347 
Train step: 2210 acc:0.83283 total_loss: 0.70802  loss:0.49386,stance loss: 0.37065 
Train step: 2220 acc:0.83224 total_loss: 0.69726  loss:0.65302,stance loss: 0.52766 
Train step: 2230 acc:0.83304 total_loss: 0.69239  loss:0.5445,stance loss: 0.64497 
Train step: 2240 acc:0.83619 total_loss: 0.68484  loss:0.82873,stance loss: 1.0824 
Train step: 2250 acc:0.83857 total_loss: 0.68161  loss:0.56849,stance loss: 0.47306 
Train step: 2260 acc:0.84068 total_loss: 0.68305  loss:0.27732,stance loss: 0.13059 
Train step: 2270 acc:0.84051 total_loss: 0.67791  loss:0.23944,stance loss: 0.1612 
Train step: 2280 acc:0.84165 total_loss: 0.67956  loss:0.69504,stance loss: 0.60887 
Train step: 2290 acc:0.84113 total_loss: 0.68315  loss:0.34578,stance loss: 0.33091 
Train step: 2300 acc:0.84038 total_loss: 0.68364  loss:0.74991,stance loss: 0.50932 
Train step: 2310 acc:0.84109 total_loss: 0.68074  loss:0.41321,stance loss: 0.30011 
Train step: 2320 acc:0.8412 total_loss: 0.67587  loss:0.64962,stance loss: 0.49966 
Train step: 2330 acc:0.84079 total_loss: 0.67277  loss:0.60571,stance loss: 0.52777 
Train step: 2340 acc:0.84017 total_loss: 0.67066  loss:0.78723,stance loss: 0.59171 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.90625 total_loss: 0.6733  loss:0.44525,stance loss: 0.34326 
Train step: 2360 acc:0.86979 total_loss: 0.57857  loss:0.38938,stance loss: 0.32087 
Train step: 2370 acc:0.86648 total_loss: 0.58845  loss:0.56081,stance loss: 0.47492 
Train step: 2380 acc:0.86133 total_loss: 0.55359  loss:0.44924,stance loss: 0.31709 
Better F1! Saving model!
Saving model of best f1: 0.323130086287981
              precision    recall  f1-score   support

           0   0.505495  0.461538  0.482517       299
           1   0.513382  0.811538  0.628912       260
           2   0.608696  0.094595  0.163743       148

    accuracy                       0.513437       707
   macro avg   0.542524  0.455891  0.425057       707
weighted avg   0.529999  0.513437  0.469623       707

Test Acc: 0.5134370579915134 F1_ma:0.323130086287981
Train step: 2390 acc:0.86607 total_loss: 0.55727  loss:0.21726,stance loss: 0.0013105 
Train step: 2400 acc:0.86779 total_loss: 0.56726  loss:0.98479,stance loss: 0.84851 
Train step: 2410 acc:0.86694 total_loss: 0.56687  loss:0.61974,stance loss: 0.51909 
Train step: 2420 acc:0.86111 total_loss: 0.59435  loss:0.71455,stance loss: 0.59055 
Train step: 2430 acc:0.85671 total_loss: 0.6061  loss:0.76439,stance loss: 1.0981 
Train step: 2440 acc:0.86277 total_loss: 0.5829  loss:0.82589,stance loss: 0.43651 
Train step: 2450 acc:0.86458 total_loss: 0.5892  loss:0.62521,stance loss: 0.38695 
Train step: 2460 acc:0.86663 total_loss: 0.57829  loss:0.41065,stance loss: 0.37031 
Train step: 2470 acc:0.86219 total_loss: 0.58047  loss:0.65031,stance loss: 0.50752 
Train step: 2480 acc:0.86032 total_loss: 0.58984  loss:0.96168,stance loss: 1.0425 
Train step: 2490 acc:0.8618 total_loss: 0.58221  loss:0.5026,stance loss: 0.43743 
Train step: 2500 acc:0.86061 total_loss: 0.5883  loss:0.61222,stance loss: 0.57548 
Train step: 2510 acc:0.8642 total_loss: 0.58156  loss:0.16482,stance loss: 0.067938 
Train step: 2520 acc:0.86301 total_loss: 0.58118  loss:0.69871,stance loss: 0.60954 
Train step: 2530 acc:0.86332 total_loss: 0.57858  loss:0.51074,stance loss: 0.44812 
Train step: 2540 acc:0.86328 total_loss: 0.57756  loss:1.1406,stance loss: 1.4843 
Train step: 2550 acc:0.86262 total_loss: 0.57903  loss:0.51126,stance loss: 0.34402 
Better F1! Saving model!
Saving model of best f1: 0.3532549501494121
              precision    recall  f1-score   support

           0   0.486111  0.468227  0.477002       299
           1   0.513021  0.757692  0.611801       260
           2   0.600000  0.141892  0.229508       148

    accuracy                       0.506365       707
   macro avg   0.533044  0.455937  0.439437       707
weighted avg   0.519848  0.506365  0.474765       707

Test Acc: 0.5063649222065064 F1_ma:0.3532549501494121
Train step: 2560 acc:0.86144 total_loss: 0.58659  loss:1.164,stance loss: 0.91563 
Train step: 2570 acc:0.86402 total_loss: 0.58193  loss:0.35556,stance loss: 0.25463 
Train step: 2580 acc:0.86342 total_loss: 0.57971  loss:0.75032,stance loss: 0.5821 
Train step: 2590 acc:0.86389 total_loss: 0.57717  loss:0.69424,stance loss: 0.46587 
Train step: 2600 acc:0.86359 total_loss: 0.57565  loss:0.64798,stance loss: 0.49127 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:1.0 total_loss: 0.17273  loss:0.17273,stance loss: 0.045036 
Better F1! Saving model!
Saving model of best f1: 0.3666414727166897
              precision    recall  f1-score   support

           0   0.469697  0.518395  0.492846       299
           1   0.517544  0.680769  0.588040       260
           2   0.628571  0.148649  0.240437       148

    accuracy                       0.500707       707
   macro avg   0.538604  0.449271  0.440441       707
weighted avg   0.520551  0.500707  0.475015       707

Test Acc: 0.5007072135785007 F1_ma:0.3666414727166897
Train step: 2620 acc:0.86364 total_loss: 0.55512  loss:0.70391,stance loss: 0.56165 
Train step: 2630 acc:0.8869 total_loss: 0.52974  loss:0.98883,stance loss: 0.7865 
Train step: 2640 acc:0.89315 total_loss: 0.51938  loss:0.9402,stance loss: 1.3392 
Train step: 2650 acc:0.89329 total_loss: 0.52336  loss:0.44129,stance loss: 0.34808 
Train step: 2660 acc:0.89216 total_loss: 0.56024  loss:0.42846,stance loss: 0.30245 
Train step: 2670 acc:0.89549 total_loss: 0.54331  loss:0.7592,stance loss: 1.0609 
Train step: 2680 acc:0.89877 total_loss: 0.53341  loss:0.73648,stance loss: 0.53073 
Train step: 2690 acc:0.89969 total_loss: 0.53564  loss:0.74975,stance loss: 1.0403 
Train step: 2700 acc:0.8956 total_loss: 0.53728  loss:0.20038,stance loss: 0.070483 
Train step: 2710 acc:0.89604 total_loss: 0.53957  loss:0.82892,stance loss: 0.63782 
Train step: 2720 acc:0.89245 total_loss: 0.54255  loss:0.57763,stance loss: 0.50123 
Train step: 2730 acc:0.89101 total_loss: 0.54304  loss:0.61074,stance loss: 0.45312 
Train step: 2740 acc:0.89027 total_loss: 0.54209  loss:1.0462,stance loss: 1.3246 
Train step: 2750 acc:0.8883 total_loss: 0.54037  loss:0.69851,stance loss: 0.52915 
Train step: 2760 acc:0.88742 total_loss: 0.53239  loss:0.44376,stance loss: 0.37685 
Train step: 2770 acc:0.88781 total_loss: 0.52789  loss:0.37478,stance loss: 0.2302 
Train step: 2780 acc:0.8867 total_loss: 0.53568  loss:0.42399,stance loss: 0.32623 
Train step: 2790 acc:0.88674 total_loss: 0.53043  loss:0.17447,stance loss: 0.00088208 
Train step: 2800 acc:0.88874 total_loss: 0.52417  loss:0.53859,stance loss: 0.43029 
Train step: 2810 acc:0.88557 total_loss: 0.53554  loss:0.62137,stance loss: 0.46433 
Train step: 2820 acc:0.88655 total_loss: 0.53487  loss:0.51253,stance loss: 0.44686 
Train step: 2830 acc:0.88857 total_loss: 0.53044  loss:0.31325,stance loss: 0.25961 
Train step: 2840 acc:0.88718 total_loss: 0.53257  loss:0.54877,stance loss: 0.28798 
Train step: 2850 acc:0.88719 total_loss: 0.53251  loss:0.46427,stance loss: 0.35716 
Train step: 2860 acc:0.88645 total_loss: 0.53388  loss:0.64521,stance loss: 0.49211 
Train step: 2870 acc:0.88686 total_loss: 0.53243  loss:0.075033,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.8875 total_loss: 0.50571  loss:0.37063,stance loss: 0.225 
Train step: 2890 acc:0.90938 total_loss: 0.4325  loss:0.25585,stance loss: 0.14997 
Train step: 2900 acc:0.90208 total_loss: 0.44202  loss:0.16279,stance loss: 0.093081 
Train step: 2910 acc:0.90312 total_loss: 0.42424  loss:0.23004,stance loss: 0.1533 
Train step: 2920 acc:0.89875 total_loss: 0.44505  loss:0.2857,stance loss: 0.24823 
Train step: 2930 acc:0.90729 total_loss: 0.43055  loss:0.47997,stance loss: 0.43927 
Train step: 2940 acc:0.91071 total_loss: 0.41772  loss:0.2066,stance loss: 0.13691 
Train step: 2950 acc:0.90938 total_loss: 0.41447  loss:0.21173,stance loss: 0.10259 
Train step: 2960 acc:0.91528 total_loss: 0.39364  loss:0.13512,stance loss: 0.048293 
Train step: 2970 acc:0.91375 total_loss: 0.39431  loss:0.64356,stance loss: 0.56907 
Train step: 2980 acc:0.9125 total_loss: 0.39616  loss:0.28975,stance loss: 0.17584 
Train step: 2990 acc:0.91302 total_loss: 0.3961  loss:0.37325,stance loss: 0.17691 
Train step: 3000 acc:0.91298 total_loss: 0.39489  loss:0.42249,stance loss: 0.2974 
Train step: 3010 acc:0.91116 total_loss: 0.40141  loss:0.36077,stance loss: 0.24943 
Better F1! Saving model!
Saving model of best f1: 0.3761130766206908
              precision    recall  f1-score   support

           0   0.481356  0.474916  0.478114       299
           1   0.506887  0.707692  0.590690       260
           2   0.551020  0.182432  0.274112       148

    accuracy                       0.499293       707
   macro avg   0.513088  0.455014  0.447639       707
weighted avg   0.505328  0.499293  0.476809       707

Test Acc: 0.49929278642149927 F1_ma:0.3761130766206908
Train step: 3020 acc:0.91 total_loss: 0.41274  loss:0.85439,stance loss: 1.0247 
Train step: 3030 acc:0.91055 total_loss: 0.42151  loss:0.42144,stance loss: 0.3754 
Train step: 3040 acc:0.91103 total_loss: 0.42375  loss:0.6524,stance loss: 1.0415 
Train step: 3050 acc:0.91042 total_loss: 0.42713  loss:0.19369,stance loss: 0.17282 
Train step: 3060 acc:0.90921 total_loss: 0.43214  loss:0.10824,stance loss: 0.039621 
Train step: 3070 acc:0.91094 total_loss: 0.42746  loss:0.24838,stance loss: 0.21071 
Train step: 3080 acc:0.90923 total_loss: 0.42924  loss:0.36439,stance loss: 0.27902 
Train step: 3090 acc:0.90625 total_loss: 0.43248  loss:1.0335,stance loss: 0.75081 
Train step: 3100 acc:0.90707 total_loss: 0.42886  loss:0.96377,stance loss: 0.91466 
Train step: 3110 acc:0.90677 total_loss: 0.42877  loss:0.1004,stance loss: 0.051781 
Train step: 3120 acc:0.90575 total_loss: 0.43663  loss:0.24291,stance loss: 0.14278 
Better F1! Saving model!
Saving model of best f1: 0.40412690645134985
              precision    recall  f1-score   support

           0   0.516000  0.431438  0.469945       299
           1   0.504950  0.784615  0.614458       260
           2   0.641509  0.229730  0.338308       148

    accuracy                       0.519095       707
   macro avg   0.554153  0.481928  0.474237       707
weighted avg   0.538210  0.519095  0.495534       707

Test Acc: 0.5190947666195191 F1_ma:0.40412690645134985
Train step: 3130 acc:0.90505 total_loss: 0.44791  loss:0.063549,stance loss: 0.012473 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.90278 total_loss: 0.32111  loss:0.33507,stance loss: 0.27987 
Train step: 3150 acc:0.90132 total_loss: 0.34815  loss:0.10899,stance loss: 0.045318 
Train step: 3160 acc:0.92457 total_loss: 0.34304  loss:0.51476,stance loss: 0.55213 
Train step: 3170 acc:0.92147 total_loss: 0.3826  loss:0.14851,stance loss: 0.075085 
Train step: 3180 acc:0.92985 total_loss: 0.35304  loss:0.54667,stance loss: 0.54005 
Train step: 3190 acc:0.92585 total_loss: 0.37039  loss:1.0902,stance loss: 1.343 
Train step: 3200 acc:0.9221 total_loss: 0.38653  loss:0.48191,stance loss: 0.29384 
Train step: 3210 acc:0.92484 total_loss: 0.39223  loss:0.70913,stance loss: 1.138 
Train step: 3220 acc:0.92556 total_loss: 0.38715  loss:0.4616,stance loss: 0.41741 
Train step: 3230 acc:0.92551 total_loss: 0.39007  loss:0.30917,stance loss: 0.25219 
Train step: 3240 acc:0.92546 total_loss: 0.39972  loss:0.7118,stance loss: 1.174 
Train step: 3250 acc:0.92595 total_loss: 0.39222  loss:0.45904,stance loss: 0.41971 
Train step: 3260 acc:0.92587 total_loss: 0.38954  loss:0.096651,stance loss: 0.048015 
Train step: 3270 acc:0.92401 total_loss: 0.38575  loss:0.70706,stance loss: 1.0601 
Train step: 3280 acc:0.92576 total_loss: 0.37874  loss:0.49678,stance loss: 0.38331 
Train step: 3290 acc:0.92374 total_loss: 0.381  loss:0.37839,stance loss: 0.38475 
Train step: 3300 acc:0.92382 total_loss: 0.39374  loss:0.42103,stance loss: 0.46128 
Train step: 3310 acc:0.92423 total_loss: 0.39506  loss:0.29547,stance loss: 0.28215 
Train step: 3320 acc:0.92328 total_loss: 0.39141  loss:0.24983,stance loss: 0.1154 
Train step: 3330 acc:0.92462 total_loss: 0.39379  loss:0.74273,stance loss: 0.56685 
Train step: 3340 acc:0.92524 total_loss: 0.38969  loss:0.066569,stance loss: 0.021815 
Train step: 3350 acc:0.92437 total_loss: 0.39161  loss:0.27449,stance loss: 0.27871 
Train step: 3360 acc:0.9244 total_loss: 0.38711  loss:0.6732,stance loss: 0.63568 
Train step: 3370 acc:0.92442 total_loss: 0.38549  loss:0.2539,stance loss: 0.2242 
Train step: 3380 acc:0.9242 total_loss: 0.38132  loss:0.32178,stance loss: 0.29129 
Train step: 3390 acc:0.92375 total_loss: 0.38454  loss:1.1716,stance loss: 1.2229 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.9375 total_loss: 0.34224  loss:0.25346,stance loss: 0.16257 
Train step: 3410 acc:0.9375 total_loss: 0.31227  loss:0.64307,stance loss: 0.43836 
Train step: 3420 acc:0.93973 total_loss: 0.28325  loss:0.53751,stance loss: 0.4123 
Train step: 3430 acc:0.94079 total_loss: 0.29636  loss:0.19789,stance loss: 0.13246 
Train step: 3440 acc:0.94531 total_loss: 0.28243  loss:0.49775,stance loss: 0.27071 
Train step: 3450 acc:0.94612 total_loss: 0.26905  loss:0.11002,stance loss: 0.086187 
Train step: 3460 acc:0.94945 total_loss: 0.28112  loss:0.30873,stance loss: 0.23464 
Train step: 3470 acc:0.94952 total_loss: 0.28564  loss:0.16498,stance loss: 0.12413 
Train step: 3480 acc:0.94744 total_loss: 0.29687  loss:0.21638,stance loss: 0.13743 
Train step: 3490 acc:0.94707 total_loss: 0.28797  loss:0.073348,stance loss: 0.032715 
Train step: 3500 acc:0.9485 total_loss: 0.2922  loss:0.98118,stance loss: 0.85332 
Train step: 3510 acc:0.94809 total_loss: 0.29124  loss:0.28345,stance loss: 0.13338 
Train step: 3520 acc:0.94678 total_loss: 0.29291  loss:0.75978,stance loss: 0.77174 
Train step: 3530 acc:0.94701 total_loss: 0.29012  loss:0.52941,stance loss: 1.0092 
Train step: 3540 acc:0.9451 total_loss: 0.29501  loss:0.46858,stance loss: 0.52994 
Train step: 3550 acc:0.94383 total_loss: 0.30198  loss:0.094932,stance loss: 0.05569 
Train step: 3560 acc:0.94345 total_loss: 0.30171  loss:0.063624,stance loss: 0.054106 
Train step: 3570 acc:0.94242 total_loss: 0.30866  loss:0.13212,stance loss: 0.1018 
Train step: 3580 acc:0.94182 total_loss: 0.31175  loss:0.63031,stance loss: 0.58014 
Train step: 3590 acc:0.94097 total_loss: 0.3184  loss:0.2457,stance loss: 0.11585 
Train step: 3600 acc:0.94081 total_loss: 0.32066  loss:0.14243,stance loss: 0.095408 
Train step: 3610 acc:0.94123 total_loss: 0.31721  loss:0.57894,stance loss: 1.0306 
Train step: 3620 acc:0.94216 total_loss: 0.31391  loss:0.05081,stance loss: 0.02542 
Train step: 3630 acc:0.94249 total_loss: 0.31363  loss:0.27544,stance loss: 0.22683 
Train step: 3640 acc:0.94153 total_loss: 0.31524  loss:0.73016,stance loss: 0.78346 
Train step: 3650 acc:0.9421 total_loss: 0.31296  loss:0.23902,stance loss: 0.15969 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.94643 total_loss: 0.22157  loss:0.084819,stance loss: 0.050774 
Train step: 3670 acc:0.94853 total_loss: 0.22726  loss:0.063989,stance loss: 0.012632 
Better F1! Saving model!
Saving model of best f1: 0.4409154179972161
              precision    recall  f1-score   support

           0   0.521552  0.404682  0.455744       299
           1   0.513995  0.776923  0.618683       260
           2   0.597561  0.331081  0.426087       148

    accuracy                       0.526167       707
   macro avg   0.544369  0.504229  0.500171       707
weighted avg   0.534684  0.526167  0.509457       707

Test Acc: 0.5261669024045261 F1_ma:0.4409154179972161
Train step: 3680 acc:0.93981 total_loss: 0.25153  loss:0.079727,stance loss: 0.068809 
Better F1! Saving model!
Saving model of best f1: 0.4414951560661738
              precision    recall  f1-score   support

           0   0.503704  0.454849  0.478032       299
           1   0.524781  0.692308  0.597015       260
           2   0.521277  0.331081  0.404959       148

    accuracy                       0.516266       707
   macro avg   0.516587  0.492746  0.493335       707
weighted avg   0.515134  0.516266  0.506491       707

Test Acc: 0.5162659123055162 F1_ma:0.4414951560661738
Train step: 3690 acc:0.94764 total_loss: 0.27952  loss:0.056854,stance loss: 0.025288 
Train step: 3700 acc:0.94947 total_loss: 0.27976  loss:0.21768,stance loss: 0.15081 
Train step: 3710 acc:0.95066 total_loss: 0.2781  loss:0.39941,stance loss: 0.3262 
Train step: 3720 acc:0.94683 total_loss: 0.27569  loss:0.18711,stance loss: 0.14174 
Train step: 3730 acc:0.95211 total_loss: 0.26184  loss:0.10319,stance loss: 0.038535 
Train step: 3740 acc:0.9533 total_loss: 0.26017  loss:0.11598,stance loss: 0.06284 
Train step: 3750 acc:0.95361 total_loss: 0.26173  loss:0.019938,stance loss: 0.0014327 
Train step: 3760 acc:0.95678 total_loss: 0.25258  loss:0.026795,stance loss: 0.00099635 
Train step: 3770 acc:0.95726 total_loss: 0.25324  loss:0.029867,stance loss: 0.011092 
Train step: 3780 acc:0.95768 total_loss: 0.25363  loss:0.24797,stance loss: 0.26053 
Train step: 3790 acc:0.95712 total_loss: 0.2509  loss:0.52231,stance loss: 0.36528 
Train step: 3800 acc:0.95748 total_loss: 0.26185  loss:0.063086,stance loss: 0.025181 
Train step: 3810 acc:0.9578 total_loss: 0.25839  loss:0.22652,stance loss: 0.11496 
Train step: 3820 acc:0.95734 total_loss: 0.25906  loss:0.021322,stance loss: 0.0022531 
Train step: 3830 acc:0.95798 total_loss: 0.25523  loss:0.089431,stance loss: 0.094867 
Train step: 3840 acc:0.95755 total_loss: 0.25628  loss:0.88322,stance loss: 0.89687 
Train step: 3850 acc:0.95939 total_loss: 0.25375  loss:0.60439,stance loss: 1.0707 
Train step: 3860 acc:0.95803 total_loss: 0.25575  loss:0.53744,stance loss: 0.7167 
Train step: 3870 acc:0.95795 total_loss: 0.25476  loss:0.11993,stance loss: 0.10655 
Train step: 3880 acc:0.95843 total_loss: 0.25208  loss:0.0937,stance loss: 0.086089 
Train step: 3890 acc:0.9586 total_loss: 0.25043  loss:0.047201,stance loss: 0.00086967 
Train step: 3900 acc:0.9585 total_loss: 0.24959  loss:0.11041,stance loss: 0.083778 
Train step: 3910 acc:0.95817 total_loss: 0.24836  loss:0.22132,stance loss: 0.12893 
Training finished.


Reload the best model with best f1 0.4414951560661738 from path test_outputs/bert-cross-topic/dt/2023-08-14 14-51-42/state_dict


              precision    recall  f1-score   support

           0   0.503704  0.454849  0.478032       299
           1   0.524781  0.692308  0.597015       260
           2   0.521277  0.331081  0.404959       148

    accuracy                       0.516266       707
   macro avg   0.516587  0.492746  0.493335       707
weighted avg   0.515134  0.516266  0.506491       707

Test Acc: 0.5162659123055162 F1_ma:0.4414951560661738
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4414951560661738
acc: 0.5162659123055162, f1 :0.4933350791684939
classification report: 
              precision    recall  f1-score   support

         Con     0.5037    0.4548    0.4780       299
        None     0.5248    0.6923    0.5970       260
         Pro     0.5213    0.3311    0.4050       148

    accuracy                         0.5163       707
   macro avg     0.5166    0.4927    0.4933       707
weighted avg     0.5151    0.5163    0.5065       707

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 15-10-13', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 15-10-13
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.7067  loss:1.7067,stance loss: 1.0956 
Train step: 10 acc:0.32955 total_loss: 1.7089  loss:1.688,stance loss: 1.1545 
Better F1! Saving model!
Saving model of best f1: 0.2975124378109452
              precision    recall  f1-score   support

           0   0.423513  1.000000  0.595025       299
           1   1.000000  0.003846  0.007663       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.474504  0.334615  0.200896       707
weighted avg   0.546860  0.424328  0.254462       707

Test Acc: 0.4243281471004243 F1_ma:0.2975124378109452
Train step: 20 acc:0.38988 total_loss: 1.725  loss:1.7642,stance loss: 1.2874 
Train step: 30 acc:0.43145 total_loss: 1.7033  loss:1.663,stance loss: 1.0645 
Train step: 40 acc:0.44512 total_loss: 1.6901  loss:1.3608,stance loss: 0.95509 
Train step: 50 acc:0.45956 total_loss: 1.6769  loss:1.6318,stance loss: 1.1785 
Train step: 60 acc:0.46619 total_loss: 1.6658  loss:1.5772,stance loss: 1.0896 
Train step: 70 acc:0.47183 total_loss: 1.6524  loss:1.5395,stance loss: 1.0777 
Train step: 80 acc:0.47531 total_loss: 1.6434  loss:1.8454,stance loss: 1.7067 
Train step: 90 acc:0.48008 total_loss: 1.6365  loss:1.5957,stance loss: 1.5317 
Train step: 100 acc:0.48391 total_loss: 1.6266  loss:1.6511,stance loss: 1.2571 
Train step: 110 acc:0.48818 total_loss: 1.616  loss:1.5169,stance loss: 1.0349 
Train step: 120 acc:0.49225 total_loss: 1.6152  loss:1.8216,stance loss: 1.7397 
Train step: 130 acc:0.48855 total_loss: 1.6108  loss:1.7603,stance loss: 1.2321 
Train step: 140 acc:0.48936 total_loss: 1.6077  loss:1.5223,stance loss: 1.192 
Train step: 150 acc:0.49627 total_loss: 1.5973  loss:1.479,stance loss: 0.97588 
Train step: 160 acc:0.5 total_loss: 1.5932  loss:1.9001,stance loss: 1.7777 
Train step: 170 acc:0.49561 total_loss: 1.5944  loss:1.4317,stance loss: 0.92092 
Train step: 180 acc:0.49724 total_loss: 1.5849  loss:1.5021,stance loss: 0.91136 
Train step: 190 acc:0.50262 total_loss: 1.58  loss:1.3687,stance loss: 1.0335 
Train step: 200 acc:0.50529 total_loss: 1.574  loss:1.2871,stance loss: 0.95452 
Train step: 210 acc:0.50592 total_loss: 1.5688  loss:1.7631,stance loss: 1.7413 
Train step: 220 acc:0.50962 total_loss: 1.5646  loss:1.4937,stance loss: 1.1632 
Train step: 230 acc:0.51569 total_loss: 1.5547  loss:1.1816,stance loss: 0.89392 
Train step: 240 acc:0.51815 total_loss: 1.5526  loss:1.5463,stance loss: 0.9548 
Train step: 250 acc:0.52166 total_loss: 1.5484  loss:1.9401,stance loss: 1.9291 
Better F1! Saving model!
Saving model of best f1: 0.2978723404255319
              precision    recall  f1-score   support

           0   0.427326  0.983278  0.595745       299
           1   0.684211  0.050000  0.093190       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.434229       707
   macro avg   0.370512  0.344426  0.229645       707
weighted avg   0.432341  0.434229  0.286219       707

Test Acc: 0.43422913719943423 F1_ma:0.2978723404255319
Train step: 260 acc:0.5251 total_loss: 1.5427  loss:0.46415,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.56875 total_loss: 1.3607  loss:1.4244,stance loss: 1.0399 
Train step: 280 acc:0.62813 total_loss: 1.3609  loss:1.3223,stance loss: 1.0603 
Train step: 290 acc:0.64167 total_loss: 1.3863  loss:1.6389,stance loss: 1.7626 
Train step: 300 acc:0.63281 total_loss: 1.3802  loss:1.2722,stance loss: 0.92556 
Train step: 310 acc:0.635 total_loss: 1.3757  loss:1.335,stance loss: 0.9915 
Train step: 320 acc:0.63542 total_loss: 1.3719  loss:1.3934,stance loss: 1.1638 
Train step: 330 acc:0.63839 total_loss: 1.3711  loss:1.2264,stance loss: 0.67383 
Train step: 340 acc:0.63438 total_loss: 1.3791  loss:1.3774,stance loss: 1.058 
Train step: 350 acc:0.62847 total_loss: 1.3865  loss:1.652,stance loss: 1.259 
Train step: 360 acc:0.63 total_loss: 1.3817  loss:1.2187,stance loss: 0.90687 
Train step: 370 acc:0.63125 total_loss: 1.3714  loss:1.6278,stance loss: 1.3915 
Train step: 380 acc:0.63177 total_loss: 1.3579  loss:1.0203,stance loss: 0.61686 
Train step: 390 acc:0.62788 total_loss: 1.3567  loss:1.148,stance loss: 0.85129 
Train step: 400 acc:0.62902 total_loss: 1.3534  loss:1.0547,stance loss: 0.63791 
Train step: 410 acc:0.63042 total_loss: 1.3489  loss:0.98986,stance loss: 0.68254 
Better F1! Saving model!
Saving model of best f1: 0.2984047202797202
              precision    recall  f1-score   support

           0   0.451852  0.612040  0.519886       299
           1   0.520408  0.588462  0.552347       260
           2   0.750000  0.040541  0.076923       148

    accuracy                       0.483734       707
   macro avg   0.574087  0.413681  0.383052       707
weighted avg   0.539476  0.483734  0.439096       707

Test Acc: 0.4837340876944837 F1_ma:0.2984047202797202
Train step: 420 acc:0.63594 total_loss: 1.3444  loss:0.78418,stance loss: 0.43641 
Train step: 430 acc:0.6375 total_loss: 1.3413  loss:1.4697,stance loss: 1.2022 
Train step: 440 acc:0.64167 total_loss: 1.339  loss:1.1119,stance loss: 0.89638 
Train step: 450 acc:0.64013 total_loss: 1.3396  loss:1.1586,stance loss: 0.84671 
Train step: 460 acc:0.64312 total_loss: 1.3345  loss:1.111,stance loss: 0.78796 
Train step: 470 acc:0.64315 total_loss: 1.3355  loss:1.2723,stance loss: 1.413 
Train step: 480 acc:0.64233 total_loss: 1.3329  loss:1.1434,stance loss: 0.90191 
Train step: 490 acc:0.64293 total_loss: 1.3277  loss:1.192,stance loss: 1.311 
Train step: 500 acc:0.64479 total_loss: 1.3261  loss:1.5203,stance loss: 0.78534 
Train step: 510 acc:0.64825 total_loss: 1.3198  loss:1.2789,stance loss: 0.97482 
Train step: 520 acc:0.64976 total_loss: 1.3155  loss:1.1557,stance loss: 0.93121 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.67361 total_loss: 1.2837  loss:1.3916,stance loss: 1.0781 
Train step: 540 acc:0.67105 total_loss: 1.296  loss:1.6291,stance loss: 1.1765 
Train step: 550 acc:0.68319 total_loss: 1.2567  loss:1.2529,stance loss: 0.94448 
Train step: 560 acc:0.67308 total_loss: 1.2758  loss:1.4949,stance loss: 1.3928 
Train step: 570 acc:0.67985 total_loss: 1.2459  loss:1.4356,stance loss: 1.2611 
Train step: 580 acc:0.68962 total_loss: 1.2286  loss:1.1497,stance loss: 0.99189 
Train step: 590 acc:0.69837 total_loss: 1.2057  loss:1.4805,stance loss: 1.8034 
Train step: 600 acc:0.7057 total_loss: 1.1956  loss:0.81874,stance loss: 0.55501 
Train step: 610 acc:0.70506 total_loss: 1.1948  loss:1.5976,stance loss: 1.6268 
Train step: 620 acc:0.69697 total_loss: 1.2059  loss:1.3946,stance loss: 0.98353 
Train step: 630 acc:0.6961 total_loss: 1.2074  loss:1.2231,stance loss: 1.0738 
Train step: 640 acc:0.70063 total_loss: 1.2058  loss:1.1935,stance loss: 1.0082 
Train step: 650 acc:0.70058 total_loss: 1.2032  loss:1.3953,stance loss: 1.1481 
Train step: 660 acc:0.70369 total_loss: 1.1956  loss:1.016,stance loss: 1.1237 
Train step: 670 acc:0.70344 total_loss: 1.192  loss:0.9309,stance loss: 0.72086 
Train step: 680 acc:0.6989 total_loss: 1.1956  loss:1.2999,stance loss: 1.1699 
Train step: 690 acc:0.6949 total_loss: 1.2013  loss:1.1257,stance loss: 0.85306 
Better F1! Saving model!
Saving model of best f1: 0.31228680821441007
              precision    recall  f1-score   support

           0   0.540284  0.381271  0.447059       299
           1   0.503158  0.919231  0.650340       260
           2   0.714286  0.101351  0.177515       148

    accuracy                       0.520509       707
   macro avg   0.585909  0.467284  0.424971       707
weighted avg   0.563056  0.520509  0.465391       707

Test Acc: 0.5205091937765205 F1_ma:0.31228680821441007
Train step: 700 acc:0.69972 total_loss: 1.1951  loss:1.4669,stance loss: 1.2394 
Train step: 710 acc:0.69841 total_loss: 1.1959  loss:1.4875,stance loss: 1.2721 
Train step: 720 acc:0.70006 total_loss: 1.1914  loss:1.6007,stance loss: 1.7201 
Train step: 730 acc:0.69976 total_loss: 1.191  loss:1.6602,stance loss: 1.1828 
Train step: 740 acc:0.69834 total_loss: 1.1926  loss:1.4793,stance loss: 1.4159 
Train step: 750 acc:0.69814 total_loss: 1.1933  loss:0.99583,stance loss: 0.76365 
Train step: 760 acc:0.69822 total_loss: 1.1915  loss:0.92354,stance loss: 0.56311 
Train step: 770 acc:0.69478 total_loss: 1.1941  loss:1.174,stance loss: 0.87433 
Train step: 780 acc:0.6904 total_loss: 1.2017  loss:1.5254,stance loss: 1.3648 
Better F1! Saving model!
Saving model of best f1: 0.32025930754744314
              precision    recall  f1-score   support

           0   0.573964  0.324415  0.414530       299
           1   0.487230  0.953846  0.644993       260
           2   0.689655  0.135135  0.225989       148

    accuracy                       0.516266       707
   macro avg   0.583617  0.471132  0.428504       707
weighted avg   0.566286  0.516266  0.459815       707

Test Acc: 0.5162659123055162 F1_ma:0.32025930754744314
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.74219 total_loss: 1.0855  loss:0.83151,stance loss: 0.65643 
Train step: 800 acc:0.73264 total_loss: 1.1061  loss:0.93661,stance loss: 0.673 
Train step: 810 acc:0.73661 total_loss: 1.1406  loss:1.143,stance loss: 1.0268 
Train step: 820 acc:0.73191 total_loss: 1.1137  loss:0.91607,stance loss: 0.55109 
Train step: 830 acc:0.71224 total_loss: 1.1593  loss:1.3226,stance loss: 1.2006 
Train step: 840 acc:0.7069 total_loss: 1.1566  loss:1.2808,stance loss: 0.95994 
Train step: 850 acc:0.70864 total_loss: 1.1469  loss:1.09,stance loss: 0.89823 
Train step: 860 acc:0.71234 total_loss: 1.1407  loss:1.2697,stance loss: 1.1264 
Train step: 870 acc:0.71165 total_loss: 1.1303  loss:0.84127,stance loss: 0.64645 
Train step: 880 acc:0.7111 total_loss: 1.135  loss:1.4118,stance loss: 1.1742 
Better F1! Saving model!
Saving model of best f1: 0.3262026862026862
              precision    recall  f1-score   support

           0   0.468531  0.448161  0.458120       299
           1   0.489848  0.742308  0.590214       260
           2   0.629630  0.114865  0.194286       148

    accuracy                       0.486563       707
   macro avg   0.529336  0.435111  0.414206       707
weighted avg   0.510094  0.486563  0.451468       707

Test Acc: 0.48656294200848654 F1_ma:0.3262026862026862
Train step: 890 acc:0.71586 total_loss: 1.116  loss:0.48337,stance loss: 0.25691 
Train step: 900 acc:0.71822 total_loss: 1.1219  loss:1.1704,stance loss: 1.2774 
Train step: 910 acc:0.71729 total_loss: 1.1238  loss:1.4827,stance loss: 1.2827 
Train step: 920 acc:0.71513 total_loss: 1.1201  loss:0.97123,stance loss: 0.82665 
Train step: 930 acc:0.71326 total_loss: 1.118  loss:1.2268,stance loss: 0.99174 
Better F1! Saving model!
Saving model of best f1: 0.33910290948275856
              precision    recall  f1-score   support

           0   0.483568  0.344482  0.402344       299
           1   0.485194  0.819231  0.609442       260
           2   0.509091  0.189189  0.275862       148

    accuracy                       0.486563       707
   macro avg   0.492618  0.450967  0.429216       707
weighted avg   0.489509  0.486563  0.452027       707

Test Acc: 0.48656294200848654 F1_ma:0.33910290948275856
Train step: 940 acc:0.71321 total_loss: 1.1148  loss:1.1267,stance loss: 0.91691 
Train step: 950 acc:0.71429 total_loss: 1.1149  loss:1.2464,stance loss: 1.1158 
Train step: 960 acc:0.71313 total_loss: 1.1151  loss:1.0795,stance loss: 0.80703 
Train step: 970 acc:0.71343 total_loss: 1.1124  loss:0.90988,stance loss: 0.58743 
Train step: 980 acc:0.71181 total_loss: 1.1136  loss:1.3455,stance loss: 1.26 
Train step: 990 acc:0.71334 total_loss: 1.1139  loss:1.394,stance loss: 1.3637 
Train step: 1000 acc:0.71474 total_loss: 1.1139  loss:0.78411,stance loss: 0.59096 
Train step: 1010 acc:0.71107 total_loss: 1.1211  loss:1.3487,stance loss: 0.81286 
Train step: 1020 acc:0.71297 total_loss: 1.1191  loss:1.4026,stance loss: 1.5976 
Train step: 1030 acc:0.71321 total_loss: 1.1186  loss:0.99911,stance loss: 0.74925 
Train step: 1040 acc:0.71342 total_loss: 1.1162  loss:0.92518,stance loss: 0.81813 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.66071 total_loss: 1.3437  loss:0.90273,stance loss: 0.70223 
Train step: 1060 acc:0.70221 total_loss: 1.1661  loss:1.1556,stance loss: 0.96089 
Train step: 1070 acc:0.70602 total_loss: 1.1441  loss:1.1938,stance loss: 0.85432 
Train step: 1080 acc:0.72804 total_loss: 1.0846  loss:0.55609,stance loss: 0.28753 
Better F1! Saving model!
Saving model of best f1: 0.3535110427958903
              precision    recall  f1-score   support

           0   0.511013  0.387960  0.441065       299
           1   0.490909  0.830769  0.617143       260
           2   0.625000  0.168919  0.265957       148

    accuracy                       0.504950       707
   macro avg   0.542307  0.462549  0.441388       707
weighted avg   0.527481  0.504950  0.469161       707

Test Acc: 0.504950495049505 F1_ma:0.3535110427958903
Train step: 1090 acc:0.73005 total_loss: 1.0788  loss:0.88494,stance loss: 0.80045 
Train step: 1100 acc:0.73136 total_loss: 1.0657  loss:0.86323,stance loss: 0.76329 
Train step: 1110 acc:0.72575 total_loss: 1.0929  loss:0.76745,stance loss: 0.64818 
Train step: 1120 acc:0.73458 total_loss: 1.0663  loss:1.0342,stance loss: 0.85057 
Train step: 1130 acc:0.73348 total_loss: 1.0568  loss:1.261,stance loss: 1.0053 
Train step: 1140 acc:0.7384 total_loss: 1.0484  loss:1.1303,stance loss: 0.98614 
Train step: 1150 acc:0.74182 total_loss: 1.0555  loss:0.94836,stance loss: 0.73869 
Train step: 1160 acc:0.74199 total_loss: 1.0622  loss:1.5071,stance loss: 1.6529 
Train step: 1170 acc:0.7377 total_loss: 1.0672  loss:1.3822,stance loss: 0.94708 
Train step: 1180 acc:0.74133 total_loss: 1.062  loss:0.54512,stance loss: 0.39152 
Train step: 1190 acc:0.74235 total_loss: 1.0593  loss:1.1254,stance loss: 0.95225 
Train step: 1200 acc:0.74283 total_loss: 1.0557  loss:1.0665,stance loss: 0.93835 
Train step: 1210 acc:0.73952 total_loss: 1.0628  loss:1.3406,stance loss: 0.82635 
Train step: 1220 acc:0.74011 total_loss: 1.0644  loss:1.3603,stance loss: 1.0641 
Train step: 1230 acc:0.73797 total_loss: 1.0676  loss:1.037,stance loss: 0.80739 
Train step: 1240 acc:0.74016 total_loss: 1.0584  loss:0.83784,stance loss: 0.70973 
Train step: 1250 acc:0.74215 total_loss: 1.0563  loss:1.1742,stance loss: 1.0328 
Train step: 1260 acc:0.7405 total_loss: 1.0621  loss:0.94136,stance loss: 0.68226 
Train step: 1270 acc:0.74064 total_loss: 1.0641  loss:1.1182,stance loss: 0.96758 
Train step: 1280 acc:0.74262 total_loss: 1.0559  loss:1.3887,stance loss: 1.6302 
Train step: 1290 acc:0.74342 total_loss: 1.0481  loss:0.52319,stance loss: 0.44786 
Train step: 1300 acc:0.74611 total_loss: 1.0414  loss:0.55079,stance loss: 0.2771 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.82292 total_loss: 0.85813  loss:0.80197,stance loss: 0.55217 
Train step: 1320 acc:0.77734 total_loss: 0.86326  loss:0.86402,stance loss: 0.67373 
Train step: 1330 acc:0.78846 total_loss: 0.8872  loss:1.0611,stance loss: 0.9382 
Train step: 1340 acc:0.78646 total_loss: 0.89731  loss:0.32444,stance loss: 0.20708 
Train step: 1350 acc:0.79076 total_loss: 0.88629  loss:0.83079,stance loss: 0.62923 
Better F1! Saving model!
Saving model of best f1: 0.3663698006274668
              precision    recall  f1-score   support

           0   0.540984  0.331104  0.410788       299
           1   0.494647  0.888462  0.635488       260
           2   0.578947  0.222973  0.321951       148

    accuracy                       0.513437       707
   macro avg   0.538193  0.480846  0.456076       707
weighted avg   0.531890  0.513437  0.474825       707

Test Acc: 0.5134370579915134 F1_ma:0.3663698006274668
Train step: 1360 acc:0.78571 total_loss: 0.88501  loss:1.2288,stance loss: 1.011 
Train step: 1370 acc:0.78125 total_loss: 0.90257  loss:1.0833,stance loss: 0.86633 
Train step: 1380 acc:0.77796 total_loss: 0.90851  loss:0.85477,stance loss: 0.60116 
Better F1! Saving model!
Saving model of best f1: 0.37622395610048875
              precision    recall  f1-score   support

           0   0.491870  0.404682  0.444037       299
           1   0.491139  0.746154  0.592366       260
           2   0.500000  0.222973  0.308411       148

    accuracy                       0.492221       707
   macro avg   0.494336  0.457936  0.448271       707
weighted avg   0.493303  0.492221  0.470194       707

Test Acc: 0.49222065063649223 F1_ma:0.37622395610048875
Train step: 1390 acc:0.77544 total_loss: 0.92436  loss:0.93458,stance loss: 0.63724 
Train step: 1400 acc:0.77409 total_loss: 0.91369  loss:0.93327,stance loss: 0.65045 
Train step: 1410 acc:0.77948 total_loss: 0.90415  loss:0.86833,stance loss: 0.6943 
Train step: 1420 acc:0.77694 total_loss: 0.92657  loss:1.4288,stance loss: 1.0736 
Train step: 1430 acc:0.77728 total_loss: 0.93535  loss:0.9567,stance loss: 1.2542 
Train step: 1440 acc:0.78079 total_loss: 0.93194  loss:0.72227,stance loss: 0.66825 
Train step: 1450 acc:0.78082 total_loss: 0.92878  loss:0.94924,stance loss: 0.82484 
Train step: 1460 acc:0.78085 total_loss: 0.92985  loss:0.89276,stance loss: 0.61147 
Better F1! Saving model!
Saving model of best f1: 0.3792539601430761
              precision    recall  f1-score   support

           0   0.527778  0.381271  0.442718       299
           1   0.509302  0.842308  0.634783       260
           2   0.540984  0.222973  0.315789       148

    accuracy                       0.517680       707
   macro avg   0.526021  0.482184  0.464430       707
weighted avg   0.523748  0.517680  0.486780       707

Test Acc: 0.5176803394625177 F1_ma:0.3792539601430761
Train step: 1470 acc:0.77673 total_loss: 0.93907  loss:0.48229,stance loss: 0.32879 
Train step: 1480 acc:0.77983 total_loss: 0.9321  loss:0.89915,stance loss: 0.73126 
Train step: 1490 acc:0.77923 total_loss: 0.92817  loss:0.74112,stance loss: 0.6111 
Train step: 1500 acc:0.78029 total_loss: 0.93228  loss:1.0719,stance loss: 0.74243 
Train step: 1510 acc:0.77822 total_loss: 0.93522  loss:1.0305,stance loss: 0.85182 
Train step: 1520 acc:0.77778 total_loss: 0.93436  loss:0.9488,stance loss: 0.72088 
Train step: 1530 acc:0.77821 total_loss: 0.9282  loss:0.94216,stance loss: 1.0214 
Train step: 1540 acc:0.77701 total_loss: 0.93199  loss:1.0476,stance loss: 0.79362 
Train step: 1550 acc:0.77693 total_loss: 0.93162  loss:0.45934,stance loss: 0.32634 
Train step: 1560 acc:0.7771 total_loss: 0.93476  loss:1.246,stance loss: 1.4249 
Better F1! Saving model!
Saving model of best f1: 0.38187279613425623
              precision    recall  f1-score   support

           0   0.517949  0.337793  0.408907       299
           1   0.507282  0.803846  0.622024       260
           2   0.440000  0.297297  0.354839       148

    accuracy                       0.500707       707
   macro avg   0.488410  0.479645  0.461923       707
weighted avg   0.497708  0.500707  0.475962       707

Test Acc: 0.5007072135785007 F1_ma:0.38187279613425623
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.7625 total_loss: 1.117  loss:0.87146,stance loss: 0.68465 
Train step: 1580 acc:0.82917 total_loss: 0.83757  loss:0.47607,stance loss: 0.26464 
Train step: 1590 acc:0.825 total_loss: 0.84587  loss:0.66253,stance loss: 0.50299 
Train step: 1600 acc:0.82143 total_loss: 0.84946  loss:0.9932,stance loss: 0.92307 
Train step: 1610 acc:0.81667 total_loss: 0.85207  loss:1.0316,stance loss: 0.96789 
Train step: 1620 acc:0.81932 total_loss: 0.84668  loss:0.46556,stance loss: 0.35231 
Train step: 1630 acc:0.8125 total_loss: 0.87017  loss:1.3947,stance loss: 1.5122 
Train step: 1640 acc:0.8075 total_loss: 0.87433  loss:0.73297,stance loss: 0.54784 
Train step: 1650 acc:0.80809 total_loss: 0.86449  loss:0.99061,stance loss: 1.1265 
Better F1! Saving model!
Saving model of best f1: 0.3875
              precision    recall  f1-score   support

           0   0.521505  0.324415  0.400000       299
           1   0.519814  0.857692  0.647315       260
           2   0.489130  0.304054  0.375000       148

    accuracy                       0.516266       707
   macro avg   0.510150  0.495387  0.474105       707
weighted avg   0.514106  0.516266  0.485717       707

Test Acc: 0.5162659123055162 F1_ma:0.3875
Train step: 1660 acc:0.81053 total_loss: 0.8619  loss:0.64755,stance loss: 0.49815 
Train step: 1670 acc:0.80952 total_loss: 0.86602  loss:0.55192,stance loss: 0.4382 
Train step: 1680 acc:0.81033 total_loss: 0.867  loss:0.6828,stance loss: 0.62123 
Train step: 1690 acc:0.8125 total_loss: 0.85916  loss:1.1019,stance loss: 0.96156 
Train step: 1700 acc:0.81204 total_loss: 0.8569  loss:0.43887,stance loss: 0.31398 
Train step: 1710 acc:0.80991 total_loss: 0.8566  loss:0.68955,stance loss: 0.35206 
Train step: 1720 acc:0.80726 total_loss: 0.86403  loss:0.77925,stance loss: 0.59756 
Train step: 1730 acc:0.8072 total_loss: 0.86663  loss:1.0783,stance loss: 0.93259 
Train step: 1740 acc:0.80536 total_loss: 0.8664  loss:0.99279,stance loss: 0.77864 
Train step: 1750 acc:0.80541 total_loss: 0.8678  loss:0.94082,stance loss: 0.82383 
Train step: 1760 acc:0.80609 total_loss: 0.86061  loss:0.47731,stance loss: 0.35975 
Train step: 1770 acc:0.80427 total_loss: 0.86176  loss:0.77333,stance loss: 0.50007 
Train step: 1780 acc:0.80349 total_loss: 0.86074  loss:1.2307,stance loss: 1.3068 
Train step: 1790 acc:0.80306 total_loss: 0.86025  loss:1.1529,stance loss: 1.5337 
Train step: 1800 acc:0.80346 total_loss: 0.85894  loss:0.79112,stance loss: 0.66416 
Train step: 1810 acc:0.80383 total_loss: 0.85577  loss:0.7915,stance loss: 0.73705 
Train step: 1820 acc:0.8027 total_loss: 0.85805  loss:0.72051,stance loss: 0.54561 
Better F1! Saving model!
Saving model of best f1: 0.41169688040484276
              precision    recall  f1-score   support

           0   0.544910  0.304348  0.390558       299
           1   0.521429  0.842308  0.644118       260
           2   0.483333  0.391892  0.432836       148

    accuracy                       0.520509       707
   macro avg   0.516557  0.512849  0.489170       707
weighted avg   0.523385  0.520509  0.492655       707

Test Acc: 0.5205091937765205 F1_ma:0.41169688040484276
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.79688 total_loss: 0.77432  loss:0.85125,stance loss: 0.68188 
Train step: 1840 acc:0.83929 total_loss: 0.69086  loss:0.64426,stance loss: 0.46351 
Train step: 1850 acc:0.83333 total_loss: 0.71526  loss:0.26224,stance loss: 0.10766 
Train step: 1860 acc:0.84926 total_loss: 0.68689  loss:0.64705,stance loss: 0.57376 
Train step: 1870 acc:0.84801 total_loss: 0.69372  loss:0.40197,stance loss: 0.32277 
Train step: 1880 acc:0.84722 total_loss: 0.67738  loss:0.51228,stance loss: 0.25558 
Train step: 1890 acc:0.85059 total_loss: 0.68986  loss:0.52018,stance loss: 0.48603 
Train step: 1900 acc:0.83868 total_loss: 0.69476  loss:0.49195,stance loss: 0.30347 
Train step: 1910 acc:0.83854 total_loss: 0.70474  loss:0.47827,stance loss: 0.43015 
Train step: 1920 acc:0.83245 total_loss: 0.72066  loss:0.41428,stance loss: 0.264 
Train step: 1930 acc:0.82812 total_loss: 0.72311  loss:1.0138,stance loss: 1.3117 
Train step: 1940 acc:0.83224 total_loss: 0.72071  loss:0.29475,stance loss: 0.14495 
Train step: 1950 acc:0.82913 total_loss: 0.72535  loss:0.46821,stance loss: 0.27484 
Train step: 1960 acc:0.82976 total_loss: 0.72774  loss:0.89861,stance loss: 0.82427 
Train step: 1970 acc:0.82682 total_loss: 0.73851  loss:1.0999,stance loss: 1.3877 
Better F1! Saving model!
Saving model of best f1: 0.4265661461138036
              precision    recall  f1-score   support

           0   0.481250  0.515050  0.497577       299
           1   0.545161  0.650000  0.592982       260
           2   0.519481  0.270270  0.355556       148

    accuracy                       0.513437       707
   macro avg   0.515297  0.478440  0.482038       707
weighted avg   0.512756  0.513437  0.502932       707

Test Acc: 0.5134370579915134 F1_ma:0.4265661461138036
Train step: 1980 acc:0.82468 total_loss: 0.74273  loss:0.50414,stance loss: 0.37803 
Train step: 1990 acc:0.82851 total_loss: 0.7411  loss:1.1618,stance loss: 1.0206 
Train step: 2000 acc:0.82938 total_loss: 0.73559  loss:0.39731,stance loss: 0.18752 
Train step: 2010 acc:0.82948 total_loss: 0.72643  loss:0.95601,stance loss: 0.7975 
Train step: 2020 acc:0.83022 total_loss: 0.73548  loss:1.2633,stance loss: 1.3939 
Train step: 2030 acc:0.8315 total_loss: 0.73115  loss:0.81466,stance loss: 0.60438 
Train step: 2040 acc:0.82944 total_loss: 0.73733  loss:0.58167,stance loss: 0.53101 
Train step: 2050 acc:0.82924 total_loss: 0.73495  loss:0.43517,stance loss: 0.35278 
Train step: 2060 acc:0.8312 total_loss: 0.73432  loss:0.56935,stance loss: 0.52429 
Train step: 2070 acc:0.83171 total_loss: 0.73338  loss:0.50569,stance loss: 0.34857 
Train step: 2080 acc:0.83268 total_loss: 0.72988  loss:0.41853,stance loss: 0.316 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.875 total_loss: 0.62819  loss:0.82309,stance loss: 0.87205 
Train step: 2100 acc:0.88942 total_loss: 0.61027  loss:0.57016,stance loss: 0.48842 
Train step: 2110 acc:0.89402 total_loss: 0.63392  loss:0.7438,stance loss: 1.1323 
Train step: 2120 acc:0.89394 total_loss: 0.62789  loss:0.55186,stance loss: 0.41362 
Train step: 2130 acc:0.8968 total_loss: 0.60695  loss:0.2482,stance loss: 0.081644 
Train step: 2140 acc:0.89858 total_loss: 0.59933  loss:0.66799,stance loss: 0.53573 
Train step: 2150 acc:0.89683 total_loss: 0.59047  loss:1.0411,stance loss: 1.2668 
Train step: 2160 acc:0.89212 total_loss: 0.6148  loss:1.1195,stance loss: 1.4219 
Train step: 2170 acc:0.8878 total_loss: 0.62587  loss:0.53333,stance loss: 0.29871 
Train step: 2180 acc:0.88508 total_loss: 0.62281  loss:1.3445,stance loss: 1.438 
Train step: 2190 acc:0.88046 total_loss: 0.62742  loss:0.95239,stance loss: 1.0721 
Train step: 2200 acc:0.88108 total_loss: 0.61957  loss:0.38591,stance loss: 0.29666 
Train step: 2210 acc:0.8811 total_loss: 0.61889  loss:0.58447,stance loss: 0.38534 
Train step: 2220 acc:0.88252 total_loss: 0.611  loss:0.58536,stance loss: 0.47685 
Train step: 2230 acc:0.88199 total_loss: 0.60793  loss:0.5127,stance loss: 0.33413 
Train step: 2240 acc:0.87745 total_loss: 0.62519  loss:1.2275,stance loss: 1.4008 
Train step: 2250 acc:0.87615 total_loss: 0.63053  loss:1.3445,stance loss: 1.6058 
Train step: 2260 acc:0.87464 total_loss: 0.63352  loss:0.81025,stance loss: 0.64507 
Train step: 2270 acc:0.87398 total_loss: 0.6315  loss:0.43116,stance loss: 0.19418 
Train step: 2280 acc:0.87338 total_loss: 0.63192  loss:0.42928,stance loss: 0.37163 
Train step: 2290 acc:0.87069 total_loss: 0.63222  loss:0.37623,stance loss: 0.29784 
Train step: 2300 acc:0.87177 total_loss: 0.62871  loss:0.67981,stance loss: 0.61535 
Train step: 2310 acc:0.87248 total_loss: 0.62911  loss:0.51289,stance loss: 0.65558 
Train step: 2320 acc:0.87205 total_loss: 0.63132  loss:0.72257,stance loss: 1.0181 
Train step: 2330 acc:0.87011 total_loss: 0.63703  loss:0.7566,stance loss: 0.51733 
Train step: 2340 acc:0.87006 total_loss: 0.63804  loss:0.39816,stance loss: 0.36111 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.8125 total_loss: 0.83502  loss:0.39168,stance loss: 0.21645 
Train step: 2360 acc:0.84896 total_loss: 0.67621  loss:0.83398,stance loss: 0.63912 
Train step: 2370 acc:0.86648 total_loss: 0.59379  loss:0.88775,stance loss: 1.1915 
Train step: 2380 acc:0.87109 total_loss: 0.57548  loss:1.0248,stance loss: 1.4464 
Train step: 2390 acc:0.88244 total_loss: 0.53796  loss:0.64362,stance loss: 0.53552 
Train step: 2400 acc:0.89062 total_loss: 0.50748  loss:0.12278,stance loss: 0.082637 
Train step: 2410 acc:0.89516 total_loss: 0.50997  loss:0.61361,stance loss: 0.5809 
Train step: 2420 acc:0.90017 total_loss: 0.50958  loss:0.32054,stance loss: 0.29724 
Train step: 2430 acc:0.89405 total_loss: 0.5176  loss:0.69398,stance loss: 0.62259 
Train step: 2440 acc:0.89402 total_loss: 0.51802  loss:0.70861,stance loss: 1.0463 
Train step: 2450 acc:0.894 total_loss: 0.52219  loss:0.53372,stance loss: 0.41596 
Train step: 2460 acc:0.89453 total_loss: 0.51443  loss:0.5381,stance loss: 0.45631 
Train step: 2470 acc:0.89498 total_loss: 0.51862  loss:0.41161,stance loss: 0.34463 
Train step: 2480 acc:0.89299 total_loss: 0.52764  loss:0.24605,stance loss: 0.19233 
Train step: 2490 acc:0.89349 total_loss: 0.52243  loss:0.14739,stance loss: 0.10009 
Train step: 2500 acc:0.8935 total_loss: 0.52744  loss:0.068656,stance loss: 0.013296 
Train step: 2510 acc:0.8939 total_loss: 0.52717  loss:0.4033,stance loss: 0.29084 
Train step: 2520 acc:0.89462 total_loss: 0.52487  loss:0.27952,stance loss: 0.15219 
Train step: 2530 acc:0.89663 total_loss: 0.52112  loss:0.94825,stance loss: 1.2959 
Train step: 2540 acc:0.89746 total_loss: 0.52578  loss:0.71193,stance loss: 1.152 
Train step: 2550 acc:0.8979 total_loss: 0.52282  loss:0.57846,stance loss: 0.46112 
Train step: 2560 acc:0.89711 total_loss: 0.52579  loss:0.43134,stance loss: 0.34567 
Train step: 2570 acc:0.89527 total_loss: 0.53016  loss:1.0804,stance loss: 1.3653 
Train step: 2580 acc:0.89386 total_loss: 0.53142  loss:0.24592,stance loss: 0.23916 
Train step: 2590 acc:0.89463 total_loss: 0.53159  loss:0.16873,stance loss: 0.083514 
Train step: 2600 acc:0.8941 total_loss: 0.5355  loss:0.67861,stance loss: 0.47866 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.875 total_loss: 0.50869  loss:0.50869,stance loss: 0.50509 
Train step: 2620 acc:0.93182 total_loss: 0.42402  loss:0.25442,stance loss: 0.25787 
Train step: 2630 acc:0.91071 total_loss: 0.50421  loss:0.18468,stance loss: 0.11225 
Train step: 2640 acc:0.91331 total_loss: 0.4664  loss:0.10671,stance loss: 0.088756 
Train step: 2650 acc:0.91616 total_loss: 0.44759  loss:0.55714,stance loss: 0.41806 
Train step: 2660 acc:0.90931 total_loss: 0.46555  loss:0.31533,stance loss: 0.27143 
Train step: 2670 acc:0.91598 total_loss: 0.46983  loss:0.79803,stance loss: 1.082 
Train step: 2680 acc:0.91373 total_loss: 0.4692  loss:0.63565,stance loss: 0.5637 
Train step: 2690 acc:0.91127 total_loss: 0.4592  loss:0.63117,stance loss: 0.534 
Train step: 2700 acc:0.91209 total_loss: 0.45329  loss:0.38954,stance loss: 0.22457 
Train step: 2710 acc:0.91337 total_loss: 0.4539  loss:0.22316,stance loss: 0.22752 
Train step: 2720 acc:0.90991 total_loss: 0.47092  loss:0.78929,stance loss: 0.51076 
Train step: 2730 acc:0.91271 total_loss: 0.46514  loss:0.16362,stance loss: 0.083452 
Train step: 2740 acc:0.91078 total_loss: 0.4646  loss:0.2851,stance loss: 0.2253 
Train step: 2750 acc:0.90691 total_loss: 0.46431  loss:0.5304,stance loss: 0.41131 
Train step: 2760 acc:0.90522 total_loss: 0.47082  loss:1.0991,stance loss: 0.82287 
Train step: 2770 acc:0.90567 total_loss: 0.46537  loss:0.66541,stance loss: 0.62737 
Train step: 2780 acc:0.90789 total_loss: 0.46515  loss:0.89744,stance loss: 1.3048 
Train step: 2790 acc:0.91022 total_loss: 0.4561  loss:0.58742,stance loss: 0.48931 
Train step: 2800 acc:0.91067 total_loss: 0.45418  loss:0.12638,stance loss: 0.062327 
Train step: 2810 acc:0.91076 total_loss: 0.44863  loss:0.45914,stance loss: 0.29013 
Train step: 2820 acc:0.91055 total_loss: 0.44865  loss:0.9801,stance loss: 0.93144 
Train step: 2830 acc:0.90979 total_loss: 0.45198  loss:0.11948,stance loss: 0.031613 
Train step: 2840 acc:0.90801 total_loss: 0.45476  loss:0.13619,stance loss: 0.077192 
Train step: 2850 acc:0.90845 total_loss: 0.45396  loss:0.34243,stance loss: 0.18896 
Train step: 2860 acc:0.91061 total_loss: 0.44923  loss:0.5951,stance loss: 1.0166 
Train step: 2870 acc:0.91064 total_loss: 0.45241  loss:2.7326,stance loss: 5.3727 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9125 total_loss: 0.45194  loss:0.11378,stance loss: 0.014413 
Train step: 2890 acc:0.92812 total_loss: 0.3876  loss:0.15406,stance loss: 0.099616 
Train step: 2900 acc:0.93125 total_loss: 0.38172  loss:0.6169,stance loss: 1.06 
Train step: 2910 acc:0.93437 total_loss: 0.36235  loss:0.080476,stance loss: 0.036394 
Train step: 2920 acc:0.9275 total_loss: 0.4112  loss:0.24092,stance loss: 0.14393 
Train step: 2930 acc:0.92708 total_loss: 0.42497  loss:0.15629,stance loss: 0.058984 
Train step: 2940 acc:0.92768 total_loss: 0.4144  loss:0.33053,stance loss: 0.32116 
Train step: 2950 acc:0.92578 total_loss: 0.4143  loss:0.45323,stance loss: 0.30051 
Train step: 2960 acc:0.92847 total_loss: 0.40174  loss:0.4031,stance loss: 0.47013 
Train step: 2970 acc:0.9275 total_loss: 0.40366  loss:0.17785,stance loss: 0.12818 
Train step: 2980 acc:0.92841 total_loss: 0.4091  loss:0.67982,stance loss: 0.6292 
Train step: 2990 acc:0.92604 total_loss: 0.4114  loss:1.2255,stance loss: 1.4828 
Train step: 3000 acc:0.92644 total_loss: 0.41117  loss:0.64196,stance loss: 0.59777 
Train step: 3010 acc:0.92723 total_loss: 0.40692  loss:0.36415,stance loss: 0.38751 
Train step: 3020 acc:0.92708 total_loss: 0.40814  loss:0.39025,stance loss: 0.22958 
Train step: 3030 acc:0.92695 total_loss: 0.40875  loss:0.31204,stance loss: 0.35152 
Train step: 3040 acc:0.92684 total_loss: 0.4074  loss:0.49065,stance loss: 0.41455 
Train step: 3050 acc:0.92604 total_loss: 0.40086  loss:0.24192,stance loss: 0.15545 
Train step: 3060 acc:0.9273 total_loss: 0.39454  loss:0.61154,stance loss: 1.031 
Train step: 3070 acc:0.92812 total_loss: 0.38877  loss:0.64379,stance loss: 0.52502 
Train step: 3080 acc:0.92857 total_loss: 0.39398  loss:0.99866,stance loss: 1.4237 
Train step: 3090 acc:0.92869 total_loss: 0.39402  loss:0.59527,stance loss: 0.5037 
Train step: 3100 acc:0.92799 total_loss: 0.39124  loss:0.41043,stance loss: 0.34556 
Better F1! Saving model!
Saving model of best f1: 0.4317291776010336
              precision    recall  f1-score   support

           0   0.530702  0.404682  0.459203       299
           1   0.576812  0.765385  0.657851       260
           2   0.425373  0.385135  0.404255       148

    accuracy                       0.533239       707
   macro avg   0.510962  0.518401  0.507103       707
weighted avg   0.525610  0.533239  0.520754       707

Test Acc: 0.5332390381895332 F1_ma:0.4317291776010336
Train step: 3110 acc:0.9276 total_loss: 0.39103  loss:0.072241,stance loss: 0.048868 
Train step: 3120 acc:0.9285 total_loss: 0.38673  loss:0.20926,stance loss: 0.12836 
Train step: 3130 acc:0.93029 total_loss: 0.38007  loss:0.203,stance loss: 0.11026 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.97222 total_loss: 0.29042  loss:0.23378,stance loss: 0.1211 
Train step: 3150 acc:0.96053 total_loss: 0.29606  loss:0.13151,stance loss: 0.12876 
Train step: 3160 acc:0.94828 total_loss: 0.33202  loss:0.61785,stance loss: 1.0495 
Train step: 3170 acc:0.94391 total_loss: 0.35068  loss:0.73611,stance loss: 1.2207 
Train step: 3180 acc:0.94388 total_loss: 0.35291  loss:0.36172,stance loss: 0.33585 
Train step: 3190 acc:0.94703 total_loss: 0.34899  loss:0.2099,stance loss: 0.12349 
Train step: 3200 acc:0.94475 total_loss: 0.34688  loss:0.22857,stance loss: 0.18664 
Train step: 3210 acc:0.93987 total_loss: 0.36458  loss:0.20625,stance loss: 0.14316 
Train step: 3220 acc:0.94382 total_loss: 0.34102  loss:0.071861,stance loss: 0.014616 
Train step: 3230 acc:0.94381 total_loss: 0.33787  loss:0.54632,stance loss: 0.52402 
Train step: 3240 acc:0.94438 total_loss: 0.33714  loss:0.60739,stance loss: 1.013 
Train step: 3250 acc:0.94643 total_loss: 0.32567  loss:0.074231,stance loss: 0.017836 
Train step: 3260 acc:0.94719 total_loss: 0.32163  loss:0.14723,stance loss: 0.12187 
Train step: 3270 acc:0.94739 total_loss: 0.31922  loss:0.16647,stance loss: 0.053597 
Train step: 3280 acc:0.94715 total_loss: 0.32015  loss:0.10453,stance loss: 0.039667 
Train step: 3290 acc:0.94693 total_loss: 0.32916  loss:1.0996,stance loss: 1.2822 
Train step: 3300 acc:0.94675 total_loss: 0.32718  loss:0.38523,stance loss: 0.37851 
Train step: 3310 acc:0.94658 total_loss: 0.33061  loss:0.48342,stance loss: 0.30458 
Train step: 3320 acc:0.94643 total_loss: 0.32364  loss:0.30219,stance loss: 0.31051 
Train step: 3330 acc:0.94598 total_loss: 0.32301  loss:0.083022,stance loss: 0.074813 
Train step: 3340 acc:0.94647 total_loss: 0.32219  loss:0.05069,stance loss: 0.0087552 
Train step: 3350 acc:0.94663 total_loss: 0.32683  loss:0.044666,stance loss: 0.02153 
Train step: 3360 acc:0.94569 total_loss: 0.33484  loss:0.99375,stance loss: 1.3942 
Train step: 3370 acc:0.94482 total_loss: 0.33783  loss:0.058964,stance loss: 0.0259 
Train step: 3380 acc:0.94428 total_loss: 0.33482  loss:0.47056,stance loss: 0.42881 
Train step: 3390 acc:0.94498 total_loss: 0.33746  loss:0.27133,stance loss: 0.1262 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.97656 total_loss: 0.1636  loss:0.22958,stance loss: 0.37396 
Train step: 3410 acc:0.95486 total_loss: 0.31049  loss:0.091855,stance loss: 0.027304 
Train step: 3420 acc:0.95312 total_loss: 0.28637  loss:0.36931,stance loss: 0.29176 
Train step: 3430 acc:0.95888 total_loss: 0.2539  loss:0.076604,stance loss: 0.039688 
Train step: 3440 acc:0.95833 total_loss: 0.25725  loss:0.2128,stance loss: 0.1782 
Train step: 3450 acc:0.9569 total_loss: 0.26149  loss:0.18763,stance loss: 0.15658 
Train step: 3460 acc:0.95772 total_loss: 0.26478  loss:0.53625,stance loss: 1.0084 
Train step: 3470 acc:0.95833 total_loss: 0.26653  loss:0.045406,stance loss: 0.037129 
Train step: 3480 acc:0.9581 total_loss: 0.27127  loss:0.090412,stance loss: 0.0087953 
Train step: 3490 acc:0.95663 total_loss: 0.27355  loss:0.62306,stance loss: 1.0586 
Train step: 3500 acc:0.95428 total_loss: 0.28506  loss:0.84194,stance loss: 0.68696 
Train step: 3510 acc:0.95339 total_loss: 0.29832  loss:0.44105,stance loss: 0.34708 
Train step: 3520 acc:0.95312 total_loss: 0.29473  loss:0.24265,stance loss: 0.269 
Train step: 3530 acc:0.95245 total_loss: 0.30617  loss:0.12961,stance loss: 0.12407 
Train step: 3540 acc:0.95439 total_loss: 0.29568  loss:0.13564,stance loss: 0.087614 
Train step: 3550 acc:0.9553 total_loss: 0.28974  loss:0.58448,stance loss: 0.55803 
Train step: 3560 acc:0.9561 total_loss: 0.28862  loss:0.92451,stance loss: 0.82578 
Train step: 3570 acc:0.95681 total_loss: 0.28453  loss:0.36897,stance loss: 0.40417 
Train step: 3580 acc:0.95678 total_loss: 0.28471  loss:0.11879,stance loss: 0.074784 
Train step: 3590 acc:0.95739 total_loss: 0.28418  loss:0.10191,stance loss: 0.078454 
Train step: 3600 acc:0.95703 total_loss: 0.28055  loss:0.14027,stance loss: 0.10099 
Train step: 3610 acc:0.95642 total_loss: 0.28295  loss:1.0101,stance loss: 1.0861 
Train step: 3620 acc:0.95614 total_loss: 0.28418  loss:0.56232,stance loss: 1.0091 
Train step: 3630 acc:0.95641 total_loss: 0.28079  loss:0.32934,stance loss: 0.17918 
Train step: 3640 acc:0.95665 total_loss: 0.27953  loss:0.39384,stance loss: 0.30657 
Train step: 3650 acc:0.95736 total_loss: 0.27452  loss:0.20146,stance loss: 0.13866 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.98214 total_loss: 0.10168  loss:0.26076,stance loss: 0.26607 
Train step: 3670 acc:0.97426 total_loss: 0.17446  loss:0.071902,stance loss: 0.031548 
Train step: 3680 acc:0.96759 total_loss: 0.22435  loss:0.76111,stance loss: 1.2152 
Train step: 3690 acc:0.96791 total_loss: 0.21492  loss:0.060885,stance loss: 0.012175 
Train step: 3700 acc:0.96809 total_loss: 0.21423  loss:0.20835,stance loss: 0.13547 
Train step: 3710 acc:0.96491 total_loss: 0.22942  loss:0.068611,stance loss: 0.053496 
Train step: 3720 acc:0.95709 total_loss: 0.25325  loss:0.32627,stance loss: 0.31253 
Train step: 3730 acc:0.96104 total_loss: 0.2481  loss:0.073966,stance loss: 0.045252 
Train step: 3740 acc:0.96264 total_loss: 0.24598  loss:0.11665,stance loss: 0.14011 
Train step: 3750 acc:0.96392 total_loss: 0.24692  loss:0.051125,stance loss: 0.006981 
Train step: 3760 acc:0.96495 total_loss: 0.24075  loss:0.039496,stance loss: 0.0087323 
Train step: 3770 acc:0.96474 total_loss: 0.24385  loss:0.071422,stance loss: 0.052277 
Train step: 3780 acc:0.96309 total_loss: 0.24722  loss:0.073703,stance loss: 0.015189 
Train step: 3790 acc:0.9635 total_loss: 0.24928  loss:0.19069,stance loss: 0.07179 
Train step: 3800 acc:0.96301 total_loss: 0.24768  loss:0.049262,stance loss: 0.016016 
Train step: 3810 acc:0.96298 total_loss: 0.24545  loss:0.046717,stance loss: 0.0068376 
Train step: 3820 acc:0.96257 total_loss: 0.24056  loss:0.074207,stance loss: 0.087959 
Train step: 3830 acc:0.96257 total_loss: 0.24022  loss:0.044576,stance loss: 0.0018972 
Train step: 3840 acc:0.96123 total_loss: 0.24163  loss:0.025568,stance loss: 0.002432 
Train step: 3850 acc:0.96034 total_loss: 0.24399  loss:0.61375,stance loss: 0.53682 
Train step: 3860 acc:0.95894 total_loss: 0.24589  loss:0.053931,stance loss: 0.019931 
Train step: 3870 acc:0.95795 total_loss: 0.24441  loss:0.18733,stance loss: 0.17353 
Train step: 3880 acc:0.9587 total_loss: 0.24559  loss:0.029779,stance loss: 0.013796 
Train step: 3890 acc:0.95728 total_loss: 0.25087  loss:0.32085,stance loss: 0.24648 
Train step: 3900 acc:0.95724 total_loss: 0.24986  loss:0.071322,stance loss: 0.023351 
Train step: 3910 acc:0.95647 total_loss: 0.25211  loss:0.11787,stance loss: 0.060366 
Training finished.


Reload the best model with best f1 0.4317291776010336 from path test_outputs/bert-cross-topic/dt/2023-08-14 15-10-13/state_dict


              precision    recall  f1-score   support

           0   0.530702  0.404682  0.459203       299
           1   0.576812  0.765385  0.657851       260
           2   0.425373  0.385135  0.404255       148

    accuracy                       0.533239       707
   macro avg   0.510962  0.518401  0.507103       707
weighted avg   0.525610  0.533239  0.520754       707

Test Acc: 0.5332390381895332 F1_ma:0.4317291776010336
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4317291776010336
acc: 0.5332390381895332, f1 :0.5071031982904962
classification report: 
              precision    recall  f1-score   support

         Con     0.5307    0.4047    0.4592       299
        None     0.5768    0.7654    0.6579       260
         Pro     0.4254    0.3851    0.4043       148

    accuracy                         0.5332       707
   macro avg     0.5110    0.5184    0.5071       707
weighted avg     0.5256    0.5332    0.5208       707

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 15-29-00', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 15-29-00
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.7994  loss:1.7994,stance loss: 1.1385 
Train step: 10 acc:0.32386 total_loss: 1.7721  loss:1.9318,stance loss: 1.7349 
Better F1! Saving model!
Saving model of best f1: 0.17309941520467836
              precision    recall  f1-score   support

           0   0.000000  0.000000  0.000000       299
           1   0.000000  0.000000  0.000000       260
           2   0.209335  1.000000  0.346199       148

    accuracy                       0.209335       707
   macro avg   0.069778  0.333333  0.115400       707
weighted avg   0.043821  0.209335  0.072472       707

Test Acc: 0.20933521923620935 F1_ma:0.17309941520467836
Train step: 20 acc:0.3125 total_loss: 1.7261  loss:2.0564,stance loss: 1.8079 
Better F1! Saving model!
Saving model of best f1: 0.4611102483544576
              precision    recall  f1-score   support

           0   0.390071  0.735786  0.509849       299
           1   0.000000  0.000000  0.000000       260
           2   0.419580  0.405405  0.412371       148

    accuracy                       0.396040       707
   macro avg   0.269884  0.380397  0.307407       707
weighted avg   0.252799  0.396040  0.301946       707

Test Acc: 0.39603960396039606 F1_ma:0.4611102483544576
Train step: 30 acc:0.3629 total_loss: 1.6831  loss:1.6274,stance loss: 1.2079 
Train step: 40 acc:0.40396 total_loss: 1.6924  loss:1.9044,stance loss: 1.6855 
Train step: 50 acc:0.4277 total_loss: 1.6652  loss:1.3077,stance loss: 0.9195 
Train step: 60 acc:0.43443 total_loss: 1.6576  loss:1.4806,stance loss: 0.88708 
Train step: 70 acc:0.44278 total_loss: 1.6534  loss:1.7456,stance loss: 1.6693 
Train step: 80 acc:0.45988 total_loss: 1.6388  loss:1.4665,stance loss: 1.0796 
Train step: 90 acc:0.46154 total_loss: 1.6363  loss:1.6228,stance loss: 1.0685 
Train step: 100 acc:0.46658 total_loss: 1.6264  loss:1.4614,stance loss: 0.98208 
Train step: 110 acc:0.47691 total_loss: 1.6102  loss:1.3951,stance loss: 0.92642 
Train step: 120 acc:0.47934 total_loss: 1.6028  loss:1.5223,stance loss: 1.0061 
Train step: 130 acc:0.48521 total_loss: 1.5948  loss:1.1806,stance loss: 0.79819 
Train step: 140 acc:0.48626 total_loss: 1.5849  loss:1.5233,stance loss: 0.94681 
Train step: 150 acc:0.48965 total_loss: 1.5787  loss:1.619,stance loss: 1.3203 
Train step: 160 acc:0.49224 total_loss: 1.5739  loss:1.5749,stance loss: 1.4261 
Train step: 170 acc:0.49488 total_loss: 1.567  loss:1.5087,stance loss: 0.89857 
Train step: 180 acc:0.49378 total_loss: 1.5632  loss:1.6389,stance loss: 1.3768 
Train step: 190 acc:0.49869 total_loss: 1.5579  loss:1.6437,stance loss: 1.2721 
Train step: 200 acc:0.50404 total_loss: 1.5507  loss:1.373,stance loss: 0.88661 
Train step: 210 acc:0.50622 total_loss: 1.5465  loss:1.5651,stance loss: 1.1736 
Train step: 220 acc:0.50877 total_loss: 1.5403  loss:1.2941,stance loss: 0.9356 
Train step: 230 acc:0.51623 total_loss: 1.5339  loss:1.459,stance loss: 1.3871 
Train step: 240 acc:0.51919 total_loss: 1.5263  loss:1.1581,stance loss: 0.60974 
Train step: 250 acc:0.52291 total_loss: 1.5187  loss:1.2534,stance loss: 0.90743 
Train step: 260 acc:0.52438 total_loss: 1.519  loss:8.9252,stance loss: 16.118 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.6125 total_loss: 1.3511  loss:1.4393,stance loss: 1.0894 
Train step: 280 acc:0.66563 total_loss: 1.3734  loss:1.0372,stance loss: 0.66022 
Train step: 290 acc:0.64583 total_loss: 1.362  loss:1.3807,stance loss: 1.1443 
Train step: 300 acc:0.64531 total_loss: 1.3229  loss:1.2015,stance loss: 0.87498 
Train step: 310 acc:0.63 total_loss: 1.3239  loss:1.3936,stance loss: 0.81481 
Train step: 320 acc:0.62917 total_loss: 1.3296  loss:1.5762,stance loss: 1.5959 
Train step: 330 acc:0.63214 total_loss: 1.3271  loss:1.0765,stance loss: 0.74482 
Train step: 340 acc:0.63125 total_loss: 1.3403  loss:1.3577,stance loss: 1.0595 
Train step: 350 acc:0.62917 total_loss: 1.3557  loss:1.8192,stance loss: 1.8089 
Train step: 360 acc:0.63125 total_loss: 1.3406  loss:0.87365,stance loss: 0.60209 
Train step: 370 acc:0.63466 total_loss: 1.3443  loss:1.4029,stance loss: 1.501 
Train step: 380 acc:0.63958 total_loss: 1.3422  loss:1.5453,stance loss: 1.2195 
Train step: 390 acc:0.63558 total_loss: 1.3513  loss:1.2495,stance loss: 0.93124 
Train step: 400 acc:0.63839 total_loss: 1.3445  loss:1.142,stance loss: 0.89242 
Train step: 410 acc:0.64 total_loss: 1.3397  loss:1.4784,stance loss: 0.98909 
Train step: 420 acc:0.64141 total_loss: 1.3413  loss:1.5498,stance loss: 1.6266 
Train step: 430 acc:0.63897 total_loss: 1.3412  loss:1.3824,stance loss: 1.0192 
Train step: 440 acc:0.64062 total_loss: 1.3374  loss:1.2196,stance loss: 0.96681 
Train step: 450 acc:0.64441 total_loss: 1.333  loss:0.9959,stance loss: 0.63209 
Train step: 460 acc:0.64531 total_loss: 1.3309  loss:1.1448,stance loss: 0.89386 
Train step: 470 acc:0.64881 total_loss: 1.3275  loss:1.1778,stance loss: 0.91652 
Train step: 480 acc:0.64801 total_loss: 1.3273  loss:1.1752,stance loss: 0.84813 
Train step: 490 acc:0.64918 total_loss: 1.3244  loss:1.4777,stance loss: 1.465 
Train step: 500 acc:0.64922 total_loss: 1.3215  loss:1.2135,stance loss: 0.86501 
Train step: 510 acc:0.65125 total_loss: 1.3194  loss:1.2179,stance loss: 0.85463 
Train step: 520 acc:0.65409 total_loss: 1.3139  loss:1.3817,stance loss: 0.90557 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.65278 total_loss: 1.1568  loss:1.1105,stance loss: 0.76256 
Train step: 540 acc:0.71053 total_loss: 1.1644  loss:0.78794,stance loss: 0.6403 
Train step: 550 acc:0.71121 total_loss: 1.1847  loss:1.1943,stance loss: 0.86397 
Train step: 560 acc:0.72596 total_loss: 1.1622  loss:1.4553,stance loss: 1.2206 
Train step: 570 acc:0.71811 total_loss: 1.1891  loss:0.73404,stance loss: 0.42445 
Train step: 580 acc:0.72034 total_loss: 1.1871  loss:1.1087,stance loss: 0.82239 
Train step: 590 acc:0.72101 total_loss: 1.172  loss:0.97538,stance loss: 0.71134 
Train step: 600 acc:0.71361 total_loss: 1.1738  loss:1.1559,stance loss: 0.83345 
Train step: 610 acc:0.70857 total_loss: 1.1743  loss:1.2713,stance loss: 1.1213 
Train step: 620 acc:0.70455 total_loss: 1.1836  loss:1.2756,stance loss: 0.94396 
Train step: 630 acc:0.70986 total_loss: 1.1704  loss:1.0467,stance loss: 0.85845 
Train step: 640 acc:0.70273 total_loss: 1.1819  loss:1.7012,stance loss: 1.1635 
Train step: 650 acc:0.70494 total_loss: 1.1769  loss:1.3659,stance loss: 0.98306 
Train step: 660 acc:0.70594 total_loss: 1.1716  loss:1.0204,stance loss: 0.72339 
Train step: 670 acc:0.70805 total_loss: 1.1705  loss:1.1187,stance loss: 0.89761 
Train step: 680 acc:0.70873 total_loss: 1.1702  loss:1.1871,stance loss: 0.8107 
Train step: 690 acc:0.70488 total_loss: 1.1746  loss:1.1531,stance loss: 1.1926 
Train step: 700 acc:0.70705 total_loss: 1.1759  loss:1.2089,stance loss: 1.0167 
Train step: 710 acc:0.70933 total_loss: 1.1806  loss:1.4812,stance loss: 1.3566 
Train step: 720 acc:0.7098 total_loss: 1.1753  loss:1.0546,stance loss: 0.81077 
Train step: 730 acc:0.70664 total_loss: 1.1834  loss:0.84136,stance loss: 0.62216 
Train step: 740 acc:0.70462 total_loss: 1.1857  loss:1.0946,stance loss: 0.67105 
Train step: 750 acc:0.70415 total_loss: 1.1848  loss:1.2264,stance loss: 1.0118 
Train step: 760 acc:0.70476 total_loss: 1.1805  loss:1.2193,stance loss: 1.3756 
Train step: 770 acc:0.70582 total_loss: 1.1791  loss:0.98625,stance loss: 0.73336 
Train step: 780 acc:0.70343 total_loss: 1.1835  loss:1.4217,stance loss: 1.5931 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.75 total_loss: 0.95675  loss:0.73733,stance loss: 0.62027 
Train step: 800 acc:0.70486 total_loss: 1.125  loss:1.1447,stance loss: 1.1078 
Train step: 810 acc:0.72768 total_loss: 1.0782  loss:1.0213,stance loss: 0.81102 
Train step: 820 acc:0.72533 total_loss: 1.0923  loss:1.6468,stance loss: 1.8197 
Train step: 830 acc:0.72786 total_loss: 1.0915  loss:1.2391,stance loss: 1.0491 
Train step: 840 acc:0.72414 total_loss: 1.0969  loss:1.3213,stance loss: 1.1029 
Train step: 850 acc:0.73254 total_loss: 1.0722  loss:0.97162,stance loss: 0.83625 
Train step: 860 acc:0.73878 total_loss: 1.0498  loss:0.70021,stance loss: 0.49917 
Train step: 870 acc:0.73793 total_loss: 1.055  loss:1.4453,stance loss: 1.5465 
Train step: 880 acc:0.73469 total_loss: 1.0573  loss:1.2231,stance loss: 1.0033 
Train step: 890 acc:0.73785 total_loss: 1.0455  loss:0.90229,stance loss: 0.78405 
Train step: 900 acc:0.73994 total_loss: 1.0409  loss:1.1502,stance loss: 0.90216 
Train step: 910 acc:0.7373 total_loss: 1.0439  loss:0.94059,stance loss: 0.73076 
Train step: 920 acc:0.73188 total_loss: 1.0679  loss:1.3638,stance loss: 1.1756 
Train step: 930 acc:0.73353 total_loss: 1.0703  loss:1.0568,stance loss: 0.80479 
Train step: 940 acc:0.73457 total_loss: 1.0692  loss:1.192,stance loss: 0.71082 
Train step: 950 acc:0.73438 total_loss: 1.0756  loss:1.6258,stance loss: 1.7823 
Train step: 960 acc:0.73315 total_loss: 1.0812  loss:1.3287,stance loss: 1.0649 
Train step: 970 acc:0.73205 total_loss: 1.0797  loss:0.92129,stance loss: 0.61841 
Train step: 980 acc:0.72917 total_loss: 1.0849  loss:1.3485,stance loss: 0.98983 
Train step: 990 acc:0.72957 total_loss: 1.0868  loss:1.2323,stance loss: 1.0676 
Train step: 1000 acc:0.73165 total_loss: 1.081  loss:0.68398,stance loss: 0.44813 
Train step: 1010 acc:0.73109 total_loss: 1.0808  loss:0.87983,stance loss: 0.81044 
Train step: 1020 acc:0.72925 total_loss: 1.0819  loss:0.84774,stance loss: 0.69054 
Train step: 1030 acc:0.72858 total_loss: 1.0812  loss:0.64202,stance loss: 0.40549 
Train step: 1040 acc:0.7282 total_loss: 1.0818  loss:1.6158,stance loss: 1.3346 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.79464 total_loss: 1.0714  loss:1.0452,stance loss: 0.9698 
Train step: 1060 acc:0.77574 total_loss: 1.0418  loss:0.94283,stance loss: 0.58809 
Train step: 1070 acc:0.76157 total_loss: 1.0284  loss:0.75784,stance loss: 0.49473 
Train step: 1080 acc:0.7652 total_loss: 0.98308  loss:0.8707,stance loss: 0.6635 
Train step: 1090 acc:0.76596 total_loss: 0.98652  loss:1.6589,stance loss: 1.8005 
Train step: 1100 acc:0.76096 total_loss: 0.98714  loss:0.82755,stance loss: 0.69715 
Train step: 1110 acc:0.75746 total_loss: 0.98376  loss:0.7002,stance loss: 0.55586 
Train step: 1120 acc:0.74838 total_loss: 0.99748  loss:0.94383,stance loss: 0.81036 
Train step: 1130 acc:0.74713 total_loss: 1.0097  loss:1.1861,stance loss: 0.95229 
Train step: 1140 acc:0.74549 total_loss: 1.0074  loss:0.80458,stance loss: 0.72797 
Train step: 1150 acc:0.75409 total_loss: 1.0084  loss:1.2179,stance loss: 1.4835 
Train step: 1160 acc:0.75427 total_loss: 1.0013  loss:0.76994,stance loss: 0.55169 
Train step: 1170 acc:0.75148 total_loss: 1.0055  loss:0.91809,stance loss: 0.74733 
Train step: 1180 acc:0.75 total_loss: 1.0061  loss:0.89634,stance loss: 0.62581 
Train step: 1190 acc:0.7534 total_loss: 1.0039  loss:0.73227,stance loss: 0.56358 
Train step: 1200 acc:0.75358 total_loss: 1.0007  loss:0.82496,stance loss: 0.70831 
Train step: 1210 acc:0.75187 total_loss: 0.99396  loss:0.80297,stance loss: 0.54945 
Train step: 1220 acc:0.74859 total_loss: 0.99937  loss:0.92813,stance loss: 0.81741 
Train step: 1230 acc:0.74766 total_loss: 1.0054  loss:0.91889,stance loss: 0.76296 
Train step: 1240 acc:0.74619 total_loss: 1.0082  loss:1.2656,stance loss: 0.82138 
Train step: 1250 acc:0.74607 total_loss: 1.0083  loss:0.67512,stance loss: 0.51896 
Train step: 1260 acc:0.74654 total_loss: 1.0102  loss:0.9225,stance loss: 0.56364 
Train step: 1270 acc:0.74642 total_loss: 1.004  loss:0.71398,stance loss: 0.57274 
Train step: 1280 acc:0.74657 total_loss: 1.0033  loss:0.47578,stance loss: 0.32035 
Train step: 1290 acc:0.7462 total_loss: 1.0033  loss:1.1464,stance loss: 1.0491 
Train step: 1300 acc:0.7483 total_loss: 0.99549  loss:0.55855,stance loss: 0.47584 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.78125 total_loss: 0.79294  loss:0.9251,stance loss: 0.77247 
Train step: 1320 acc:0.71875 total_loss: 0.88303  loss:1.1015,stance loss: 0.95423 
Train step: 1330 acc:0.74038 total_loss: 0.8723  loss:0.56148,stance loss: 0.43587 
Train step: 1340 acc:0.75347 total_loss: 0.86572  loss:1.5028,stance loss: 1.3658 
Train step: 1350 acc:0.75951 total_loss: 0.88359  loss:1.1995,stance loss: 1.4875 
Train step: 1360 acc:0.76228 total_loss: 0.87884  loss:1.0027,stance loss: 1.0895 
Train step: 1370 acc:0.75758 total_loss: 0.88961  loss:1.1068,stance loss: 0.87086 
Train step: 1380 acc:0.75822 total_loss: 0.90106  loss:1.4208,stance loss: 1.1434 
Train step: 1390 acc:0.76817 total_loss: 0.88191  loss:0.75804,stance loss: 0.52693 
Train step: 1400 acc:0.76953 total_loss: 0.87571  loss:0.7688,stance loss: 0.77154 
Train step: 1410 acc:0.76533 total_loss: 0.89583  loss:0.99848,stance loss: 0.79455 
Train step: 1420 acc:0.76778 total_loss: 0.8861  loss:0.51619,stance loss: 0.34318 
Train step: 1430 acc:0.76488 total_loss: 0.89676  loss:1.3414,stance loss: 0.96073 
Train step: 1440 acc:0.76792 total_loss: 0.8961  loss:0.74792,stance loss: 0.64109 
Train step: 1450 acc:0.76926 total_loss: 0.89175  loss:0.99995,stance loss: 0.8785 
Train step: 1460 acc:0.77284 total_loss: 0.89142  loss:0.55071,stance loss: 0.38655 
Train step: 1470 acc:0.77259 total_loss: 0.89266  loss:0.65781,stance loss: 0.44701 
Train step: 1480 acc:0.77131 total_loss: 0.89287  loss:0.43455,stance loss: 0.33251 
Train step: 1490 acc:0.77419 total_loss: 0.88668  loss:0.7031,stance loss: 0.46814 
Train step: 1500 acc:0.77551 total_loss: 0.88796  loss:0.87395,stance loss: 0.814 
Train step: 1510 acc:0.77488 total_loss: 0.88355  loss:0.90229,stance loss: 1.0904 
Train step: 1520 acc:0.77344 total_loss: 0.88864  loss:1.0306,stance loss: 0.8011 
Train step: 1530 acc:0.776 total_loss: 0.88775  loss:0.77974,stance loss: 0.60561 
Train step: 1540 acc:0.77436 total_loss: 0.89331  loss:1.2471,stance loss: 0.81578 
Train step: 1550 acc:0.77439 total_loss: 0.8924  loss:1.0914,stance loss: 1.2755 
Train step: 1560 acc:0.77271 total_loss: 0.89455  loss:0.88964,stance loss: 0.71842 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.8625 total_loss: 0.81319  loss:0.85748,stance loss: 0.78392 
Train step: 1580 acc:0.82083 total_loss: 0.76995  loss:0.72815,stance loss: 0.6635 
Train step: 1590 acc:0.8275 total_loss: 0.77855  loss:0.51989,stance loss: 0.38883 
Train step: 1600 acc:0.81964 total_loss: 0.79594  loss:0.81699,stance loss: 0.46515 
Train step: 1610 acc:0.82917 total_loss: 0.76989  loss:0.49587,stance loss: 0.44199 
Train step: 1620 acc:0.82841 total_loss: 0.76711  loss:0.89187,stance loss: 0.72882 
Train step: 1630 acc:0.82115 total_loss: 0.79721  loss:1.4187,stance loss: 1.3839 
Train step: 1640 acc:0.82583 total_loss: 0.78445  loss:0.54711,stance loss: 0.3643 
Train step: 1650 acc:0.82353 total_loss: 0.78892  loss:0.78939,stance loss: 0.6863 
Train step: 1660 acc:0.82434 total_loss: 0.77893  loss:0.68514,stance loss: 0.60122 
Train step: 1670 acc:0.82798 total_loss: 0.77222  loss:0.39405,stance loss: 0.28922 
Train step: 1680 acc:0.8288 total_loss: 0.76359  loss:1.1307,stance loss: 1.5063 
Train step: 1690 acc:0.8295 total_loss: 0.7582  loss:0.70382,stance loss: 0.48924 
Train step: 1700 acc:0.82685 total_loss: 0.76285  loss:0.92936,stance loss: 0.85539 
Train step: 1710 acc:0.82759 total_loss: 0.75136  loss:0.56278,stance loss: 0.44542 
Train step: 1720 acc:0.83065 total_loss: 0.74749  loss:0.71655,stance loss: 0.66247 
Train step: 1730 acc:0.82803 total_loss: 0.74962  loss:0.74196,stance loss: 0.55601 
Train step: 1740 acc:0.82679 total_loss: 0.75287  loss:0.78462,stance loss: 0.57878 
Train step: 1750 acc:0.82635 total_loss: 0.74729  loss:0.56677,stance loss: 0.50628 
Train step: 1760 acc:0.82468 total_loss: 0.7521  loss:0.2911,stance loss: 0.16552 
Train step: 1770 acc:0.82439 total_loss: 0.75555  loss:0.91677,stance loss: 1.133 
Train step: 1780 acc:0.82471 total_loss: 0.75194  loss:0.47748,stance loss: 0.3792 
Train step: 1790 acc:0.82417 total_loss: 0.75522  loss:0.37763,stance loss: 0.257 
Train step: 1800 acc:0.82314 total_loss: 0.75482  loss:0.62762,stance loss: 0.48402 
Train step: 1810 acc:0.82219 total_loss: 0.75613  loss:0.80817,stance loss: 0.72569 
Train step: 1820 acc:0.82279 total_loss: 0.7562  loss:1.2286,stance loss: 1.507 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.92188 total_loss: 0.78767  loss:0.93888,stance loss: 1.313 
Train step: 1840 acc:0.84375 total_loss: 0.72648  loss:0.94925,stance loss: 0.81532 
Train step: 1850 acc:0.85677 total_loss: 0.68607  loss:0.22433,stance loss: 0.12199 
Train step: 1860 acc:0.84559 total_loss: 0.68471  loss:1.169,stance loss: 1.3954 
Train step: 1870 acc:0.84091 total_loss: 0.69556  loss:0.70097,stance loss: 0.45185 
Train step: 1880 acc:0.83912 total_loss: 0.70501  loss:0.87556,stance loss: 0.67444 
Train step: 1890 acc:0.83496 total_loss: 0.69812  loss:0.70454,stance loss: 0.59557 
Train step: 1900 acc:0.83361 total_loss: 0.70075  loss:0.61728,stance loss: 0.53069 
Train step: 1910 acc:0.84226 total_loss: 0.67589  loss:0.3554,stance loss: 0.24837 
Train step: 1920 acc:0.84508 total_loss: 0.6732  loss:0.73282,stance loss: 1.0786 
Train step: 1930 acc:0.84014 total_loss: 0.69254  loss:0.80669,stance loss: 0.56077 
Train step: 1940 acc:0.84265 total_loss: 0.68968  loss:0.60041,stance loss: 0.4986 
Train step: 1950 acc:0.84173 total_loss: 0.67913  loss:0.45618,stance loss: 0.1649 
Train step: 1960 acc:0.83955 total_loss: 0.6808  loss:0.62627,stance loss: 0.49862 
Train step: 1970 acc:0.84028 total_loss: 0.68086  loss:0.56605,stance loss: 0.44298 
Train step: 1980 acc:0.83807 total_loss: 0.68531  loss:0.52833,stance loss: 0.44423 
Train step: 1990 acc:0.83765 total_loss: 0.68152  loss:0.57458,stance loss: 0.33081 
Train step: 2000 acc:0.83908 total_loss: 0.68115  loss:0.41177,stance loss: 0.35951 
Train step: 2010 acc:0.84035 total_loss: 0.68208  loss:1.1952,stance loss: 1.1051 
Train step: 2020 acc:0.83988 total_loss: 0.68256  loss:0.54412,stance loss: 0.37761 
Train step: 2030 acc:0.84191 total_loss: 0.67896  loss:0.16252,stance loss: 0.079812 
Train step: 2040 acc:0.84258 total_loss: 0.67253  loss:0.70644,stance loss: 1.064 
Train step: 2050 acc:0.8418 total_loss: 0.67718  loss:0.77228,stance loss: 1.0486 
Train step: 2060 acc:0.84161 total_loss: 0.68616  loss:0.95561,stance loss: 0.88012 
Train step: 2070 acc:0.84093 total_loss: 0.68455  loss:0.85043,stance loss: 0.77679 
Train step: 2080 acc:0.84203 total_loss: 0.68286  loss:1.1199,stance loss: 1.6141 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.875 total_loss: 0.51044  loss:0.53656,stance loss: 0.4671 
Train step: 2100 acc:0.84615 total_loss: 0.58691  loss:0.70171,stance loss: 1.0397 
Train step: 2110 acc:0.84511 total_loss: 0.63945  loss:0.43107,stance loss: 0.35712 
Train step: 2120 acc:0.85038 total_loss: 0.62082  loss:1.0894,stance loss: 1.3136 
Train step: 2130 acc:0.86192 total_loss: 0.63017  loss:0.21742,stance loss: 0.11752 
Train step: 2140 acc:0.86675 total_loss: 0.60865  loss:0.52984,stance loss: 0.47665 
Train step: 2150 acc:0.86905 total_loss: 0.58755  loss:0.54037,stance loss: 0.56131 
Train step: 2160 acc:0.87671 total_loss: 0.56859  loss:0.26227,stance loss: 0.18845 
Train step: 2170 acc:0.875 total_loss: 0.56768  loss:0.56842,stance loss: 0.44759 
Train step: 2180 acc:0.87433 total_loss: 0.57859  loss:1.5272,stance loss: 1.4072 
Train step: 2190 acc:0.87379 total_loss: 0.58304  loss:0.32673,stance loss: 0.27576 
Train step: 2200 acc:0.87058 total_loss: 0.58627  loss:0.57607,stance loss: 0.40164 
Train step: 2210 acc:0.87297 total_loss: 0.57949  loss:0.70606,stance loss: 0.56763 
Train step: 2220 acc:0.875 total_loss: 0.5748  loss:0.55343,stance loss: 0.45393 
Train step: 2230 acc:0.87325 total_loss: 0.58981  loss:1.0509,stance loss: 1.3693 
Train step: 2240 acc:0.87214 total_loss: 0.59492  loss:0.88239,stance loss: 1.1536 
Train step: 2250 acc:0.8704 total_loss: 0.59635  loss:0.58107,stance loss: 0.51374 
Train step: 2260 acc:0.87283 total_loss: 0.58944  loss:0.65053,stance loss: 0.70168 
Train step: 2270 acc:0.87124 total_loss: 0.59205  loss:0.73199,stance loss: 0.77846 
Train step: 2280 acc:0.86788 total_loss: 0.59507  loss:0.92125,stance loss: 0.4932 
Train step: 2290 acc:0.86915 total_loss: 0.58999  loss:0.48064,stance loss: 0.37566 
Train step: 2300 acc:0.87001 total_loss: 0.58556  loss:0.36418,stance loss: 0.30091 
Train step: 2310 acc:0.86911 total_loss: 0.58634  loss:0.4098,stance loss: 0.29379 
Train step: 2320 acc:0.87071 total_loss: 0.58437  loss:0.52626,stance loss: 0.65819 
Train step: 2330 acc:0.86986 total_loss: 0.58534  loss:0.3724,stance loss: 0.27755 
Train step: 2340 acc:0.87055 total_loss: 0.58125  loss:0.3181,stance loss: 0.30163 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.84375 total_loss: 0.35789  loss:0.29063,stance loss: 0.16324 
Train step: 2360 acc:0.93229 total_loss: 0.38529  loss:0.40857,stance loss: 0.42297 
Train step: 2370 acc:0.90057 total_loss: 0.50007  loss:0.443,stance loss: 0.33236 
Train step: 2380 acc:0.9043 total_loss: 0.48665  loss:0.54192,stance loss: 0.34408 
Train step: 2390 acc:0.91071 total_loss: 0.45683  loss:0.73333,stance loss: 0.51242 
Train step: 2400 acc:0.90865 total_loss: 0.46662  loss:0.33267,stance loss: 0.27143 
Train step: 2410 acc:0.90625 total_loss: 0.4831  loss:0.95203,stance loss: 0.62384 
Train step: 2420 acc:0.90278 total_loss: 0.48035  loss:0.8803,stance loss: 1.2081 
Train step: 2430 acc:0.90473 total_loss: 0.48412  loss:0.39827,stance loss: 0.35024 
Train step: 2440 acc:0.90625 total_loss: 0.48047  loss:0.25655,stance loss: 0.18429 
Train step: 2450 acc:0.90502 total_loss: 0.48415  loss:0.45869,stance loss: 0.48446 
Train step: 2460 acc:0.9029 total_loss: 0.48733  loss:0.52661,stance loss: 0.43837 
Train step: 2470 acc:0.90369 total_loss: 0.49287  loss:1.0643,stance loss: 1.4311 
Train step: 2480 acc:0.90388 total_loss: 0.49129  loss:0.70553,stance loss: 0.61774 
Train step: 2490 acc:0.90053 total_loss: 0.49386  loss:0.62505,stance loss: 0.66326 
Train step: 2500 acc:0.90049 total_loss: 0.48954  loss:0.36551,stance loss: 0.29227 
Train step: 2510 acc:0.90008 total_loss: 0.49526  loss:0.3973,stance loss: 0.3429 
Train step: 2520 acc:0.90116 total_loss: 0.49481  loss:0.62272,stance loss: 1.0366 
Train step: 2530 acc:0.8987 total_loss: 0.50267  loss:0.45127,stance loss: 0.33257 
Train step: 2540 acc:0.90007 total_loss: 0.49676  loss:0.57381,stance loss: 0.25122 
Train step: 2550 acc:0.89759 total_loss: 0.5012  loss:0.5959,stance loss: 0.47803 
Train step: 2560 acc:0.8977 total_loss: 0.50734  loss:0.72064,stance loss: 0.64261 
Train step: 2570 acc:0.89949 total_loss: 0.49669  loss:0.4229,stance loss: 0.37545 
Train step: 2580 acc:0.90005 total_loss: 0.49583  loss:0.37672,stance loss: 0.29888 
Train step: 2590 acc:0.89928 total_loss: 0.49712  loss:0.47499,stance loss: 0.36186 
Train step: 2600 acc:0.89955 total_loss: 0.49506  loss:0.64262,stance loss: 0.46496 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.35263  loss:0.35263,stance loss: 0.30417 
Train step: 2620 acc:0.90909 total_loss: 0.4314  loss:0.46942,stance loss: 0.30389 
Train step: 2630 acc:0.92857 total_loss: 0.42215  loss:0.62839,stance loss: 1.0412 
Train step: 2640 acc:0.92944 total_loss: 0.3896  loss:0.15495,stance loss: 0.1121 
Train step: 2650 acc:0.92835 total_loss: 0.37061  loss:0.3911,stance loss: 0.3767 
Train step: 2660 acc:0.9277 total_loss: 0.35593  loss:0.24457,stance loss: 0.2159 
Train step: 2670 acc:0.92725 total_loss: 0.35831  loss:0.50624,stance loss: 0.41506 
Train step: 2680 acc:0.93046 total_loss: 0.35836  loss:0.11291,stance loss: 0.053189 
Train step: 2690 acc:0.9321 total_loss: 0.364  loss:0.3045,stance loss: 0.26923 
Train step: 2700 acc:0.93063 total_loss: 0.37741  loss:0.2705,stance loss: 0.2703 
Train step: 2710 acc:0.93007 total_loss: 0.3844  loss:0.07464,stance loss: 0.031872 
Train step: 2720 acc:0.92849 total_loss: 0.38159  loss:0.33737,stance loss: 0.32093 
Train step: 2730 acc:0.92614 total_loss: 0.39245  loss:0.46397,stance loss: 0.42358 
Train step: 2740 acc:0.92605 total_loss: 0.39277  loss:0.28613,stance loss: 0.19024 
Train step: 2750 acc:0.92509 total_loss: 0.39687  loss:0.52876,stance loss: 0.38578 
Train step: 2760 acc:0.92508 total_loss: 0.3918  loss:0.29065,stance loss: 0.20307 
Train step: 2770 acc:0.92508 total_loss: 0.3938  loss:0.27937,stance loss: 0.19153 
Train step: 2780 acc:0.92727 total_loss: 0.38725  loss:0.21062,stance loss: 0.13596 
Train step: 2790 acc:0.92645 total_loss: 0.3885  loss:0.35211,stance loss: 0.32868 
Train step: 2800 acc:0.92539 total_loss: 0.39151  loss:0.39443,stance loss: 0.27462 
Train step: 2810 acc:0.92475 total_loss: 0.39289  loss:0.75455,stance loss: 1.1642 
Train step: 2820 acc:0.92417 total_loss: 0.39561  loss:0.059355,stance loss: 0.01542 
Train step: 2830 acc:0.92364 total_loss: 0.39839  loss:0.25922,stance loss: 0.18498 
Train step: 2840 acc:0.92208 total_loss: 0.40338  loss:0.57363,stance loss: 0.37272 
Train step: 2850 acc:0.92324 total_loss: 0.40125  loss:0.35161,stance loss: 0.28539 
Train step: 2860 acc:0.92231 total_loss: 0.408  loss:0.48538,stance loss: 0.42031 
Train step: 2870 acc:0.92169 total_loss: 0.41377  loss:3.101,stance loss: 5.4858 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.88125 total_loss: 0.50498  loss:0.31627,stance loss: 0.29531 
Train step: 2890 acc:0.90625 total_loss: 0.41173  loss:0.26821,stance loss: 0.22583 
Train step: 2900 acc:0.925 total_loss: 0.36068  loss:0.23728,stance loss: 0.15624 
Train step: 2910 acc:0.92656 total_loss: 0.36168  loss:0.49177,stance loss: 0.4923 
Train step: 2920 acc:0.92625 total_loss: 0.35922  loss:0.21525,stance loss: 0.16502 
Train step: 2930 acc:0.93229 total_loss: 0.33811  loss:0.11143,stance loss: 0.067864 
Train step: 2940 acc:0.92768 total_loss: 0.35859  loss:0.78708,stance loss: 1.2087 
Train step: 2950 acc:0.92656 total_loss: 0.35458  loss:0.6256,stance loss: 0.5909 
Train step: 2960 acc:0.92292 total_loss: 0.35923  loss:0.17581,stance loss: 0.15304 
Train step: 2970 acc:0.92437 total_loss: 0.35371  loss:0.54515,stance loss: 1.0128 
Train step: 2980 acc:0.92727 total_loss: 0.35304  loss:0.22687,stance loss: 0.24973 
Train step: 2990 acc:0.92812 total_loss: 0.35103  loss:0.18582,stance loss: 0.041854 
Train step: 3000 acc:0.92788 total_loss: 0.357  loss:0.12619,stance loss: 0.1075 
Train step: 3010 acc:0.92723 total_loss: 0.35445  loss:0.42038,stance loss: 0.36216 
Train step: 3020 acc:0.92792 total_loss: 0.365  loss:1.1465,stance loss: 1.3914 
Train step: 3030 acc:0.92695 total_loss: 0.36819  loss:0.29208,stance loss: 0.23726 
Train step: 3040 acc:0.92794 total_loss: 0.36772  loss:0.13593,stance loss: 0.080462 
Train step: 3050 acc:0.92917 total_loss: 0.37153  loss:0.11572,stance loss: 0.070139 
Train step: 3060 acc:0.92961 total_loss: 0.36753  loss:0.057458,stance loss: 0.002013 
Train step: 3070 acc:0.93031 total_loss: 0.36614  loss:0.58789,stance loss: 0.41302 
Train step: 3080 acc:0.93095 total_loss: 0.36569  loss:0.63031,stance loss: 1.0941 
Train step: 3090 acc:0.93182 total_loss: 0.36183  loss:0.14069,stance loss: 0.043054 
Train step: 3100 acc:0.93179 total_loss: 0.36029  loss:0.36327,stance loss: 0.38593 
Train step: 3110 acc:0.93073 total_loss: 0.36419  loss:0.51285,stance loss: 0.31553 
Train step: 3120 acc:0.93 total_loss: 0.36561  loss:0.19185,stance loss: 0.19152 
Train step: 3130 acc:0.93149 total_loss: 0.36176  loss:0.072225,stance loss: 0.054855 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.93056 total_loss: 0.35807  loss:0.90811,stance loss: 1.2468 
Train step: 3150 acc:0.95066 total_loss: 0.33028  loss:0.16866,stance loss: 0.16397 
Train step: 3160 acc:0.94612 total_loss: 0.33845  loss:0.26611,stance loss: 0.20033 
Train step: 3170 acc:0.95513 total_loss: 0.32111  loss:0.37714,stance loss: 0.28278 
Train step: 3180 acc:0.95153 total_loss: 0.3481  loss:0.071772,stance loss: 0.054776 
Train step: 3190 acc:0.95127 total_loss: 0.35895  loss:0.76382,stance loss: 0.75359 
Train step: 3200 acc:0.94384 total_loss: 0.35931  loss:0.3715,stance loss: 0.26148 
Train step: 3210 acc:0.94146 total_loss: 0.36349  loss:0.56924,stance loss: 1.0164 
Train step: 3220 acc:0.9382 total_loss: 0.36458  loss:0.27791,stance loss: 0.063177 
Train step: 3230 acc:0.94003 total_loss: 0.34876  loss:0.22238,stance loss: 0.171 
Train step: 3240 acc:0.94381 total_loss: 0.33265  loss:0.59545,stance loss: 1.022 
Train step: 3250 acc:0.9396 total_loss: 0.33558  loss:0.17701,stance loss: 0.12119 
Train step: 3260 acc:0.94041 total_loss: 0.32953  loss:0.27242,stance loss: 0.14504 
Train step: 3270 acc:0.9402 total_loss: 0.32652  loss:0.29217,stance loss: 0.22205 
Train step: 3280 acc:0.93792 total_loss: 0.33651  loss:0.6553,stance loss: 0.54133 
Train step: 3290 acc:0.93632 total_loss: 0.34337  loss:0.33197,stance loss: 0.2919 
Train step: 3300 acc:0.93824 total_loss: 0.33219  loss:0.17617,stance loss: 0.13947 
Train step: 3310 acc:0.9382 total_loss: 0.33074  loss:0.71323,stance loss: 1.2042 
Train step: 3320 acc:0.93816 total_loss: 0.32901  loss:0.18724,stance loss: 0.22404 
Train step: 3330 acc:0.93813 total_loss: 0.32991  loss:0.54046,stance loss: 0.48263 
Train step: 3340 acc:0.939 total_loss: 0.32883  loss:0.080853,stance loss: 0.01947 
Train step: 3350 acc:0.93836 total_loss: 0.331  loss:0.20221,stance loss: 0.14308 
Train step: 3360 acc:0.93914 total_loss: 0.32804  loss:0.40296,stance loss: 0.36965 
Train step: 3370 acc:0.93907 total_loss: 0.32935  loss:0.33445,stance loss: 0.33866 
Train step: 3380 acc:0.93926 total_loss: 0.32427  loss:0.073556,stance loss: 0.0025799 
Train step: 3390 acc:0.94015 total_loss: 0.32554  loss:0.12083,stance loss: 0.093288 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.96094 total_loss: 0.17355  loss:0.15472,stance loss: 0.1128 
Train step: 3410 acc:0.95833 total_loss: 0.16678  loss:0.048629,stance loss: 0.021445 
Train step: 3420 acc:0.96429 total_loss: 0.17826  loss:0.24098,stance loss: 0.20951 
Train step: 3430 acc:0.96053 total_loss: 0.20406  loss:0.33298,stance loss: 0.29919 
Train step: 3440 acc:0.95964 total_loss: 0.21093  loss:0.13568,stance loss: 0.083467 
Train step: 3450 acc:0.96013 total_loss: 0.23651  loss:0.15309,stance loss: 0.072286 
Train step: 3460 acc:0.95129 total_loss: 0.28523  loss:0.055334,stance loss: 0.016622 
Train step: 3470 acc:0.95433 total_loss: 0.2696  loss:0.057689,stance loss: 0.010689 
Train step: 3480 acc:0.95526 total_loss: 0.26213  loss:0.12176,stance loss: 0.096464 
Train step: 3490 acc:0.95344 total_loss: 0.25523  loss:0.071023,stance loss: 0.021622 
Train step: 3500 acc:0.9537 total_loss: 0.25543  loss:0.37839,stance loss: 0.38877 
Train step: 3510 acc:0.95021 total_loss: 0.26333  loss:0.11983,stance loss: 0.089965 
Better F1! Saving model!
Saving model of best f1: 0.46394544178116537
              precision    recall  f1-score   support

           0   0.474801  0.598662  0.529586       299
           1   0.561983  0.523077  0.541833       260
           2   0.534091  0.317568  0.398305       148

    accuracy                       0.512023       707
   macro avg   0.523625  0.479769  0.489908       707
weighted avg   0.519274  0.512023  0.506608       707

Test Acc: 0.512022630834512 F1_ma:0.46394544178116537
Train step: 3520 acc:0.95215 total_loss: 0.26338  loss:0.92713,stance loss: 1.2122 
Train step: 3530 acc:0.9529 total_loss: 0.25883  loss:0.057669,stance loss: 0.013167 
Train step: 3540 acc:0.95186 total_loss: 0.26058  loss:0.23936,stance loss: 0.20362 
Train step: 3550 acc:0.95214 total_loss: 0.25717  loss:0.53118,stance loss: 0.45522 
Train step: 3560 acc:0.95312 total_loss: 0.25321  loss:0.57426,stance loss: 0.30157 
Train step: 3570 acc:0.95435 total_loss: 0.25295  loss:0.51813,stance loss: 0.458 
Train step: 3580 acc:0.95412 total_loss: 0.25396  loss:0.071976,stance loss: 0.010542 
Train step: 3590 acc:0.95455 total_loss: 0.2513  loss:0.3345,stance loss: 0.24867 
Train step: 3600 acc:0.95523 total_loss: 0.249  loss:0.084799,stance loss: 0.036583 
Train step: 3610 acc:0.95413 total_loss: 0.25422  loss:0.24489,stance loss: 0.22821 
Train step: 3620 acc:0.95477 total_loss: 0.25331  loss:0.5942,stance loss: 1.0488 
Train step: 3630 acc:0.95431 total_loss: 0.25468  loss:0.056623,stance loss: 0.03079 
Train step: 3640 acc:0.95539 total_loss: 0.25133  loss:0.15991,stance loss: 0.17747 
Train step: 3650 acc:0.95543 total_loss: 0.25133  loss:0.056785,stance loss: 0.01426 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.97321 total_loss: 0.39641  loss:0.54645,stance loss: 1.0081 
Train step: 3670 acc:0.97426 total_loss: 0.26209  loss:0.14156,stance loss: 0.072373 
Train step: 3680 acc:0.97685 total_loss: 0.23662  loss:0.53892,stance loss: 0.45543 
Train step: 3690 acc:0.98142 total_loss: 0.21243  loss:0.082922,stance loss: 0.035757 
Train step: 3700 acc:0.97872 total_loss: 0.20989  loss:0.062255,stance loss: 0.017741 
Train step: 3710 acc:0.9682 total_loss: 0.25559  loss:0.10929,stance loss: 0.081369 
Train step: 3720 acc:0.96922 total_loss: 0.2354  loss:0.039689,stance loss: 0.0079242 
Train step: 3730 acc:0.96834 total_loss: 0.24285  loss:0.9273,stance loss: 1.3022 
Train step: 3740 acc:0.96839 total_loss: 0.23669  loss:0.055925,stance loss: 0.026263 
Train step: 3750 acc:0.96649 total_loss: 0.24487  loss:0.2377,stance loss: 0.17071 
Train step: 3760 acc:0.96437 total_loss: 0.25939  loss:0.83395,stance loss: 0.40469 
Train step: 3770 acc:0.96368 total_loss: 0.25944  loss:0.1381,stance loss: 0.085058 
Train step: 3780 acc:0.96506 total_loss: 0.25181  loss:0.048323,stance loss: 0.016924 
Train step: 3790 acc:0.96578 total_loss: 0.25201  loss:0.79432,stance loss: 0.81381 
Train step: 3800 acc:0.96599 total_loss: 0.25344  loss:0.44665,stance loss: 0.37946 
Train step: 3810 acc:0.96576 total_loss: 0.26034  loss:0.43301,stance loss: 0.35285 
Train step: 3820 acc:0.96557 total_loss: 0.25751  loss:0.36332,stance loss: 0.35526 
Train step: 3830 acc:0.96681 total_loss: 0.25013  loss:0.015734,stance loss: 0.0008087 
Train step: 3840 acc:0.96758 total_loss: 0.24176  loss:0.036991,stance loss: 0.014417 
Train step: 3850 acc:0.96732 total_loss: 0.24211  loss:0.061926,stance loss: 0.031499 
Train step: 3860 acc:0.96739 total_loss: 0.24121  loss:0.038476,stance loss: 0.0069797 
Train step: 3870 acc:0.96688 total_loss: 0.23831  loss:0.053302,stance loss: 0.004739 
Train step: 3880 acc:0.96696 total_loss: 0.23723  loss:0.5438,stance loss: 1.0107 
Train step: 3890 acc:0.9673 total_loss: 0.23673  loss:0.27132,stance loss: 0.22373 
Train step: 3900 acc:0.96736 total_loss: 0.23572  loss:0.034384,stance loss: 0.003729 
Train step: 3910 acc:0.96668 total_loss: 0.23736  loss:0.19781,stance loss: 0.038619 
Training finished.


Reload the best model with best f1 0.46394544178116537 from path test_outputs/bert-cross-topic/dt/2023-08-14 15-29-00/state_dict


              precision    recall  f1-score   support

           0   0.474801  0.598662  0.529586       299
           1   0.561983  0.523077  0.541833       260
           2   0.534091  0.317568  0.398305       148

    accuracy                       0.512023       707
   macro avg   0.523625  0.479769  0.489908       707
weighted avg   0.519274  0.512023  0.506608       707

Test Acc: 0.512022630834512 F1_ma:0.46394544178116537
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.46394544178116537
acc: 0.512022630834512, f1 :0.48990785096167994
classification report: 
              precision    recall  f1-score   support

         Con     0.4748    0.5987    0.5296       299
        None     0.5620    0.5231    0.5418       260
         Pro     0.5341    0.3176    0.3983       148

    accuracy                         0.5120       707
   macro avg     0.5236    0.4798    0.4899       707
weighted avg     0.5193    0.5120    0.5066       707

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 15-47-05', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 15-47-05
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.7526  loss:1.7526,stance loss: 1.0307 
Train step: 10 acc:0.18182 total_loss: 2.0308  loss:1.6903,stance loss: 1.1358 
Better F1! Saving model!
Saving model of best f1: 0.04261363636363637
              precision    recall  f1-score   support

           0   0.283019  0.050167  0.085227       299
           1   0.339478  0.850000  0.485181       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.333805       707
   macro avg   0.207499  0.300056  0.190136       707
weighted avg   0.244536  0.333805  0.214470       707

Test Acc: 0.3338048090523338 F1_ma:0.04261363636363637
Train step: 20 acc:0.25298 total_loss: 1.8911  loss:1.9335,stance loss: 1.7912 
Better F1! Saving model!
Saving model of best f1: 0.34429178645126024
              precision    recall  f1-score   support

           0   0.425982  0.943144  0.586889       299
           1   0.312500  0.019231  0.036232       260
           2   0.310345  0.060811  0.101695       148

    accuracy                       0.418670       707
   macro avg   0.349609  0.341062  0.241605       707
weighted avg   0.360042  0.418670  0.282816       707

Test Acc: 0.4186704384724187 F1_ma:0.34429178645126024
Train step: 30 acc:0.32258 total_loss: 1.8402  loss:1.608,stance loss: 1.0449 
Train step: 40 acc:0.36585 total_loss: 1.7915  loss:1.4518,stance loss: 1.0175 
Train step: 50 acc:0.39338 total_loss: 1.7451  loss:1.5745,stance loss: 1.1169 
Train step: 60 acc:0.41393 total_loss: 1.7266  loss:1.8236,stance loss: 1.7343 
Train step: 70 acc:0.42342 total_loss: 1.7157  loss:1.7176,stance loss: 1.2537 
Train step: 80 acc:0.43673 total_loss: 1.7028  loss:1.5657,stance loss: 1.1687 
Train step: 90 acc:0.45124 total_loss: 1.6871  loss:1.5893,stance loss: 0.99658 
Train step: 100 acc:0.46101 total_loss: 1.6781  loss:1.7194,stance loss: 1.1991 
Train step: 110 acc:0.46959 total_loss: 1.6701  loss:1.6095,stance loss: 1.0738 
Train step: 120 acc:0.47831 total_loss: 1.6615  loss:1.5354,stance loss: 1.2714 
Train step: 130 acc:0.48473 total_loss: 1.6513  loss:1.5955,stance loss: 1.2315 
Train step: 140 acc:0.48759 total_loss: 1.6451  loss:1.4982,stance loss: 1.0678 
Train step: 150 acc:0.49959 total_loss: 1.6296  loss:1.0669,stance loss: 0.6572 
Train step: 160 acc:0.50272 total_loss: 1.6256  loss:1.1991,stance loss: 0.95601 
Train step: 170 acc:0.50804 total_loss: 1.6184  loss:1.6476,stance loss: 1.3863 
Train step: 180 acc:0.50898 total_loss: 1.6125  loss:1.545,stance loss: 1.088 
Train step: 190 acc:0.51014 total_loss: 1.6124  loss:1.5317,stance loss: 1.0657 
Train step: 200 acc:0.51026 total_loss: 1.6112  loss:1.4919,stance loss: 1.2002 
Train step: 210 acc:0.51126 total_loss: 1.6118  loss:1.5229,stance loss: 1.1033 
Train step: 220 acc:0.51301 total_loss: 1.6087  loss:1.4455,stance loss: 0.91279 
Train step: 230 acc:0.51461 total_loss: 1.6051  loss:1.4291,stance loss: 1.1766 
Train step: 240 acc:0.51738 total_loss: 1.5987  loss:1.7503,stance loss: 1.2525 
Train step: 250 acc:0.51917 total_loss: 1.5981  loss:1.7553,stance loss: 1.7442 
Train step: 260 acc:0.52174 total_loss: 1.6024  loss:9.3485,stance loss: 16.118 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.51875 total_loss: 1.5111  loss:1.771,stance loss: 1.3102 
Train step: 280 acc:0.57188 total_loss: 1.4816  loss:1.3454,stance loss: 0.96016 
Train step: 290 acc:0.56042 total_loss: 1.4675  loss:1.5944,stance loss: 1.3145 
Train step: 300 acc:0.5875 total_loss: 1.4306  loss:1.3103,stance loss: 1.1539 
Train step: 310 acc:0.58875 total_loss: 1.446  loss:1.2524,stance loss: 0.9435 
Train step: 320 acc:0.59271 total_loss: 1.4427  loss:1.2898,stance loss: 0.94999 
Train step: 330 acc:0.58929 total_loss: 1.4481  loss:1.3925,stance loss: 0.97848 
Train step: 340 acc:0.58203 total_loss: 1.4542  loss:1.4724,stance loss: 1.0816 
Train step: 350 acc:0.58889 total_loss: 1.4446  loss:1.3254,stance loss: 1.1171 
Train step: 360 acc:0.59 total_loss: 1.442  loss:1.2854,stance loss: 1.0517 
Train step: 370 acc:0.59205 total_loss: 1.436  loss:1.3543,stance loss: 1.0815 
Train step: 380 acc:0.59219 total_loss: 1.4425  loss:1.2752,stance loss: 0.95467 
Train step: 390 acc:0.59183 total_loss: 1.4445  loss:1.6316,stance loss: 1.1475 
Train step: 400 acc:0.59196 total_loss: 1.4398  loss:1.4774,stance loss: 1.1527 
Train step: 410 acc:0.59083 total_loss: 1.4378  loss:1.2689,stance loss: 0.98157 
Train step: 420 acc:0.59141 total_loss: 1.4363  loss:1.4002,stance loss: 1.126 
Train step: 430 acc:0.59706 total_loss: 1.4296  loss:1.4864,stance loss: 1.2201 
Train step: 440 acc:0.59514 total_loss: 1.4322  loss:1.3697,stance loss: 1.0273 
Train step: 450 acc:0.59803 total_loss: 1.4288  loss:1.2754,stance loss: 0.96917 
Train step: 460 acc:0.60094 total_loss: 1.4237  loss:1.1241,stance loss: 0.75142 
Train step: 470 acc:0.60238 total_loss: 1.4232  loss:1.3165,stance loss: 0.86161 
Train step: 480 acc:0.60256 total_loss: 1.4191  loss:1.1744,stance loss: 0.96412 
Train step: 490 acc:0.60299 total_loss: 1.4204  loss:1.0985,stance loss: 0.86765 
Train step: 500 acc:0.60547 total_loss: 1.418  loss:1.6325,stance loss: 1.7303 
Train step: 510 acc:0.60475 total_loss: 1.4187  loss:1.2772,stance loss: 0.66377 
Train step: 520 acc:0.60553 total_loss: 1.4181  loss:1.2911,stance loss: 0.97492 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.57639 total_loss: 1.3459  loss:1.1023,stance loss: 0.78352 
Train step: 540 acc:0.60855 total_loss: 1.3547  loss:1.3211,stance loss: 1.1511 
Train step: 550 acc:0.6056 total_loss: 1.3193  loss:1.3294,stance loss: 0.90936 
Train step: 560 acc:0.62179 total_loss: 1.299  loss:1.3544,stance loss: 0.94812 
Train step: 570 acc:0.61352 total_loss: 1.3074  loss:1.2236,stance loss: 0.89696 
Train step: 580 acc:0.61335 total_loss: 1.3236  loss:1.4456,stance loss: 1.206 
Train step: 590 acc:0.63315 total_loss: 1.3058  loss:1.1075,stance loss: 0.88556 
Train step: 600 acc:0.63133 total_loss: 1.3139  loss:1.2728,stance loss: 1.015 
Train step: 610 acc:0.63624 total_loss: 1.3052  loss:1.3608,stance loss: 1.0872 
Train step: 620 acc:0.63952 total_loss: 1.2965  loss:1.1398,stance loss: 0.72503 
Train step: 630 acc:0.64163 total_loss: 1.3027  loss:1.7825,stance loss: 1.9804 
Train step: 640 acc:0.64758 total_loss: 1.2999  loss:1.1183,stance loss: 0.67233 
Train step: 650 acc:0.64777 total_loss: 1.302  loss:1.2193,stance loss: 1.0339 
Train step: 660 acc:0.64973 total_loss: 1.3008  loss:1.8127,stance loss: 1.7467 
Train step: 670 acc:0.65143 total_loss: 1.2932  loss:1.2111,stance loss: 1.0693 
Train step: 680 acc:0.65055 total_loss: 1.2867  loss:1.1995,stance loss: 0.88665 
Train step: 690 acc:0.64867 total_loss: 1.2832  loss:1.4416,stance loss: 1.1028 
Train step: 700 acc:0.64665 total_loss: 1.2866  loss:1.366,stance loss: 1.1339 
Train step: 710 acc:0.64815 total_loss: 1.2868  loss:1.386,stance loss: 1.1483 
Train step: 720 acc:0.64981 total_loss: 1.2857  loss:1.1555,stance loss: 0.85018 
Train step: 730 acc:0.64803 total_loss: 1.2869  loss:1.6464,stance loss: 1.6815 
Train step: 740 acc:0.65011 total_loss: 1.2888  loss:0.94975,stance loss: 0.76071 
Train step: 750 acc:0.65202 total_loss: 1.2853  loss:0.84176,stance loss: 0.69579 
Train step: 760 acc:0.65533 total_loss: 1.2762  loss:0.62012,stance loss: 0.40963 
Train step: 770 acc:0.65437 total_loss: 1.2806  loss:1.7498,stance loss: 1.7308 
Train step: 780 acc:0.65396 total_loss: 1.2803  loss:1.158,stance loss: 0.82352 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.74219 total_loss: 1.2025  loss:0.95931,stance loss: 0.69713 
Train step: 800 acc:0.71875 total_loss: 1.1743  loss:1.2036,stance loss: 0.8683 
Train step: 810 acc:0.68973 total_loss: 1.2125  loss:1.0879,stance loss: 0.91008 
Train step: 820 acc:0.6727 total_loss: 1.2345  loss:1.3967,stance loss: 1.1249 
Train step: 830 acc:0.66146 total_loss: 1.2388  loss:1.2389,stance loss: 0.89774 
Train step: 840 acc:0.67026 total_loss: 1.2164  loss:1.204,stance loss: 1.0377 
Train step: 850 acc:0.67371 total_loss: 1.2251  loss:1.2899,stance loss: 1.0331 
Train step: 860 acc:0.67548 total_loss: 1.2162  loss:1.4249,stance loss: 1.052 
Train step: 870 acc:0.67756 total_loss: 1.2091  loss:0.98947,stance loss: 0.78936 
Train step: 880 acc:0.67921 total_loss: 1.2079  loss:1.4724,stance loss: 1.1025 
Train step: 890 acc:0.67766 total_loss: 1.2084  loss:1.3782,stance loss: 0.94785 
Train step: 900 acc:0.68167 total_loss: 1.2062  loss:0.89483,stance loss: 0.704 
Train step: 910 acc:0.68604 total_loss: 1.1986  loss:1.4106,stance loss: 1.1724 
Train step: 920 acc:0.6875 total_loss: 1.1928  loss:0.83296,stance loss: 0.72536 
Train step: 930 acc:0.6837 total_loss: 1.1981  loss:1.251,stance loss: 1.042 
Train step: 940 acc:0.68196 total_loss: 1.2049  loss:0.86849,stance loss: 0.70255 
Train step: 950 acc:0.68304 total_loss: 1.2036  loss:1.7045,stance loss: 1.4753 
Train step: 960 acc:0.68434 total_loss: 1.1992  loss:0.65794,stance loss: 0.49261 
Train step: 970 acc:0.68517 total_loss: 1.2064  loss:1.0796,stance loss: 0.88721 
Train step: 980 acc:0.68308 total_loss: 1.2077  loss:1.1058,stance loss: 0.89655 
Train step: 990 acc:0.6857 total_loss: 1.2  loss:0.8519,stance loss: 0.63029 
Train step: 1000 acc:0.68291 total_loss: 1.202  loss:1.2882,stance loss: 1.0101 
Train step: 1010 acc:0.68531 total_loss: 1.1958  loss:0.73759,stance loss: 0.60823 
Train step: 1020 acc:0.68671 total_loss: 1.1952  loss:1.4959,stance loss: 1.1189 
Train step: 1030 acc:0.68775 total_loss: 1.1935  loss:1.0025,stance loss: 0.65289 
Train step: 1040 acc:0.68702 total_loss: 1.1932  loss:1.3408,stance loss: 0.94625 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.74107 total_loss: 1.1805  loss:1.2309,stance loss: 1.1669 
Train step: 1060 acc:0.71691 total_loss: 1.1198  loss:1.0428,stance loss: 0.87046 
Train step: 1070 acc:0.71759 total_loss: 1.1094  loss:0.7405,stance loss: 0.63346 
Better F1! Saving model!
Saving model of best f1: 0.3604740726016846
              precision    recall  f1-score   support

           0   0.427068  0.949833  0.589212       299
           1   0.652174  0.057692  0.106007       260
           2   0.578947  0.074324  0.131737       148

    accuracy                       0.438472       707
   macro avg   0.552730  0.360616  0.275652       707
weighted avg   0.541644  0.438472  0.315747       707

Test Acc: 0.43847241867043846 F1_ma:0.3604740726016846
Train step: 1080 acc:0.69088 total_loss: 1.1588  loss:1.4296,stance loss: 1.512 
Train step: 1090 acc:0.69016 total_loss: 1.158  loss:1.0396,stance loss: 0.92842 
Train step: 1100 acc:0.70504 total_loss: 1.1371  loss:1.1127,stance loss: 0.94916 
Train step: 1110 acc:0.70243 total_loss: 1.1465  loss:1.6824,stance loss: 1.2985 
Train step: 1120 acc:0.70779 total_loss: 1.1341  loss:0.94936,stance loss: 0.71171 
Train step: 1130 acc:0.71264 total_loss: 1.1315  loss:0.86404,stance loss: 0.78989 
Train step: 1140 acc:0.71327 total_loss: 1.1078  loss:0.98602,stance loss: 0.71296 
Train step: 1150 acc:0.70502 total_loss: 1.1286  loss:1.1526,stance loss: 0.94111 
Train step: 1160 acc:0.70406 total_loss: 1.1308  loss:1.6867,stance loss: 1.6632 
Train step: 1170 acc:0.70128 total_loss: 1.1438  loss:0.76311,stance loss: 0.60216 
Train step: 1180 acc:0.70119 total_loss: 1.1329  loss:0.96717,stance loss: 0.78668 
Train step: 1190 acc:0.70281 total_loss: 1.1273  loss:0.69314,stance loss: 0.48796 
Train step: 1200 acc:0.70024 total_loss: 1.132  loss:1.4028,stance loss: 1.1347 
Train step: 1210 acc:0.70135 total_loss: 1.1272  loss:0.8513,stance loss: 0.62227 
Train step: 1220 acc:0.70516 total_loss: 1.1169  loss:0.98009,stance loss: 0.73955 
Train step: 1230 acc:0.70722 total_loss: 1.1163  loss:0.83562,stance loss: 0.65249 
Train step: 1240 acc:0.70685 total_loss: 1.1163  loss:1.3115,stance loss: 1.1361 
Train step: 1250 acc:0.70592 total_loss: 1.1154  loss:0.9267,stance loss: 0.69799 
Train step: 1260 acc:0.70536 total_loss: 1.1165  loss:1.5368,stance loss: 1.1642 
Train step: 1270 acc:0.70595 total_loss: 1.1131  loss:0.95179,stance loss: 0.70191 
Train step: 1280 acc:0.70675 total_loss: 1.111  loss:0.99011,stance loss: 0.80011 
Train step: 1290 acc:0.7085 total_loss: 1.1069  loss:0.94875,stance loss: 0.66721 
Train step: 1300 acc:0.70744 total_loss: 1.1112  loss:1.4933,stance loss: 1.6347 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.78125 total_loss: 0.98666  loss:0.64849,stance loss: 0.59306 
Train step: 1320 acc:0.78125 total_loss: 0.94114  loss:1.0198,stance loss: 0.756 
Train step: 1330 acc:0.75 total_loss: 1.0414  loss:0.804,stance loss: 0.66743 
Train step: 1340 acc:0.75174 total_loss: 1.0471  loss:0.88889,stance loss: 0.71403 
Train step: 1350 acc:0.75408 total_loss: 1.046  loss:0.99051,stance loss: 0.94341 
Train step: 1360 acc:0.74442 total_loss: 1.0606  loss:1.2966,stance loss: 1.5038 
Train step: 1370 acc:0.73295 total_loss: 1.0533  loss:0.88813,stance loss: 0.70429 
Train step: 1380 acc:0.73766 total_loss: 1.0398  loss:1.089,stance loss: 0.92148 
Train step: 1390 acc:0.74128 total_loss: 1.0279  loss:1.6849,stance loss: 1.1723 
Train step: 1400 acc:0.74674 total_loss: 1.0192  loss:0.45578,stance loss: 0.33733 
Train step: 1410 acc:0.75118 total_loss: 1.0206  loss:1.4672,stance loss: 1.6733 
Train step: 1420 acc:0.74892 total_loss: 1.0183  loss:1.2088,stance loss: 0.9992 
Train step: 1430 acc:0.74702 total_loss: 1.026  loss:0.95989,stance loss: 0.77547 
Train step: 1440 acc:0.74632 total_loss: 1.0298  loss:1.3955,stance loss: 1.6065 
Better F1! Saving model!
Saving model of best f1: 0.3646601146601146
              precision    recall  f1-score   support

           0   0.444660  0.765886  0.562654       299
           1   0.459302  0.303846  0.365741       260
           2   0.700000  0.094595  0.166667       148

    accuracy                       0.455446       707
   macro avg   0.534654  0.388109  0.365020       707
weighted avg   0.503496  0.455446  0.407345       707

Test Acc: 0.45544554455445546 F1_ma:0.3646601146601146
Train step: 1450 acc:0.74443 total_loss: 1.0332  loss:0.93311,stance loss: 0.80671 
Better F1! Saving model!
Saving model of best f1: 0.4012296444001329
              precision    recall  f1-score   support

           0   0.444646  0.819398  0.576471       299
           1   0.472441  0.230769  0.310078       260
           2   0.689655  0.135135  0.225989       148

    accuracy                       0.459689       707
   macro avg   0.535581  0.395101  0.370846       707
weighted avg   0.506157  0.459689  0.405136       707

Test Acc: 0.4596888260254597 F1_ma:0.4012296444001329
Train step: 1460 acc:0.7476 total_loss: 1.0318  loss:1.1754,stance loss: 1.0987 
Train step: 1470 acc:0.74925 total_loss: 1.0249  loss:1.1623,stance loss: 0.92509 
Train step: 1480 acc:0.74929 total_loss: 1.0261  loss:0.79038,stance loss: 0.5838 
Train step: 1490 acc:0.75672 total_loss: 1.006  loss:0.59316,stance loss: 0.40437 
Train step: 1500 acc:0.75829 total_loss: 1.0029  loss:1.2958,stance loss: 1.0304 
Train step: 1510 acc:0.76092 total_loss: 0.99286  loss:0.93198,stance loss: 0.83206 
Better F1! Saving model!
Saving model of best f1: 0.4110455192034139
              precision    recall  f1-score   support

           0   0.445545  0.602007  0.512091       299
           1   0.458167  0.442308  0.450098       260
           2   0.596154  0.209459  0.310000       148

    accuracy                       0.461103       707
   macro avg   0.499955  0.417925  0.424063       707
weighted avg   0.481714  0.461103  0.446988       707

Test Acc: 0.4611032531824611 F1_ma:0.4110455192034139
Train step: 1520 acc:0.75984 total_loss: 0.99487  loss:0.93264,stance loss: 0.69888 
Train step: 1530 acc:0.7594 total_loss: 0.99806  loss:1.3138,stance loss: 1.4879 
Train step: 1540 acc:0.75768 total_loss: 1.0006  loss:0.761,stance loss: 0.63107 
Train step: 1550 acc:0.76042 total_loss: 0.99368  loss:1.1155,stance loss: 1.0728 
Train step: 1560 acc:0.75903 total_loss: 0.99455  loss:1.1301,stance loss: 0.74693 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.8 total_loss: 1.016  loss:0.98067,stance loss: 0.77903 
Train step: 1580 acc:0.7875 total_loss: 0.91594  loss:0.96577,stance loss: 0.6976 
Train step: 1590 acc:0.765 total_loss: 0.92167  loss:1.1081,stance loss: 0.9267 
Better F1! Saving model!
Saving model of best f1: 0.43508369226007787
              precision    recall  f1-score   support

           0   0.448343  0.769231  0.566502       299
           1   0.496689  0.288462  0.364964       260
           2   0.674419  0.195946  0.303665       148

    accuracy                       0.472419       707
   macro avg   0.539817  0.417879  0.411710       707
weighted avg   0.513448  0.472419  0.437365       707

Test Acc: 0.4724186704384724 F1_ma:0.43508369226007787
Train step: 1600 acc:0.77679 total_loss: 0.91104  loss:0.62137,stance loss: 0.47124 
Train step: 1610 acc:0.76528 total_loss: 0.95471  loss:1.0877,stance loss: 0.99242 
Train step: 1620 acc:0.76818 total_loss: 0.94457  loss:0.69025,stance loss: 0.52205 
Train step: 1630 acc:0.77981 total_loss: 0.92753  loss:0.45842,stance loss: 0.34271 
Train step: 1640 acc:0.78417 total_loss: 0.91576  loss:0.70495,stance loss: 0.64559 
Train step: 1650 acc:0.78824 total_loss: 0.89681  loss:1.1134,stance loss: 0.60304 
Train step: 1660 acc:0.79079 total_loss: 0.895  loss:1.0311,stance loss: 0.97867 
Train step: 1670 acc:0.78036 total_loss: 0.91437  loss:0.79733,stance loss: 0.50936 
Train step: 1680 acc:0.78315 total_loss: 0.90435  loss:0.81985,stance loss: 0.79362 
Train step: 1690 acc:0.787 total_loss: 0.891  loss:1.1898,stance loss: 1.0899 
Train step: 1700 acc:0.78935 total_loss: 0.88786  loss:0.81815,stance loss: 0.81148 
Train step: 1710 acc:0.78836 total_loss: 0.88895  loss:0.41178,stance loss: 0.2805 
Train step: 1720 acc:0.79073 total_loss: 0.88457  loss:0.58508,stance loss: 0.49161 
Train step: 1730 acc:0.79129 total_loss: 0.88193  loss:0.4551,stance loss: 0.31296 
Train step: 1740 acc:0.79179 total_loss: 0.88256  loss:1.1683,stance loss: 0.79765 
Train step: 1750 acc:0.78986 total_loss: 0.88498  loss:0.73286,stance loss: 0.58161 
Train step: 1760 acc:0.78846 total_loss: 0.88377  loss:0.66775,stance loss: 0.53387 
Train step: 1770 acc:0.78963 total_loss: 0.87848  loss:1.046,stance loss: 0.93458 
Train step: 1780 acc:0.78983 total_loss: 0.87834  loss:1.039,stance loss: 0.89594 
Train step: 1790 acc:0.78861 total_loss: 0.88653  loss:1.0733,stance loss: 0.89407 
Train step: 1800 acc:0.78989 total_loss: 0.88842  loss:1.0297,stance loss: 0.82053 
Train step: 1810 acc:0.78827 total_loss: 0.89531  loss:0.74333,stance loss: 0.49852 
Train step: 1820 acc:0.78701 total_loss: 0.89723  loss:0.50468,stance loss: 0.34823 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.90625 total_loss: 0.6421  loss:0.37356,stance loss: 0.25337 
Train step: 1840 acc:0.86607 total_loss: 0.79965  loss:0.90643,stance loss: 0.76487 
Train step: 1850 acc:0.84375 total_loss: 0.81317  loss:0.99449,stance loss: 0.46056 
Train step: 1860 acc:0.84559 total_loss: 0.77989  loss:0.81021,stance loss: 0.65326 
Train step: 1870 acc:0.83949 total_loss: 0.78132  loss:0.58397,stance loss: 0.43326 
Train step: 1880 acc:0.83565 total_loss: 0.80662  loss:1.0834,stance loss: 0.82669 
Train step: 1890 acc:0.83691 total_loss: 0.77325  loss:0.61037,stance loss: 0.47194 
Train step: 1900 acc:0.82686 total_loss: 0.82431  loss:0.90748,stance loss: 0.64683 
Train step: 1910 acc:0.8311 total_loss: 0.81555  loss:0.54571,stance loss: 0.46582 
Train step: 1920 acc:0.83378 total_loss: 0.80147  loss:1.2015,stance loss: 1.0413 
Train step: 1930 acc:0.82993 total_loss: 0.80801  loss:0.48862,stance loss: 0.40738 
Train step: 1940 acc:0.83114 total_loss: 0.80157  loss:0.99152,stance loss: 0.85882 
Train step: 1950 acc:0.83266 total_loss: 0.79135  loss:0.72799,stance loss: 0.57893 
Train step: 1960 acc:0.83489 total_loss: 0.78792  loss:0.74342,stance loss: 0.6944 
Train step: 1970 acc:0.83681 total_loss: 0.78216  loss:0.47742,stance loss: 0.34688 
Train step: 1980 acc:0.83563 total_loss: 0.78998  loss:0.7276,stance loss: 0.57586 
Train step: 1990 acc:0.83651 total_loss: 0.78197  loss:0.80898,stance loss: 0.70348 
Train step: 2000 acc:0.83872 total_loss: 0.7733  loss:0.63999,stance loss: 0.48658 
Train step: 2010 acc:0.83832 total_loss: 0.77645  loss:0.34861,stance loss: 0.22909 
Train step: 2020 acc:0.83795 total_loss: 0.77622  loss:0.90666,stance loss: 0.57928 
Train step: 2030 acc:0.83946 total_loss: 0.77485  loss:0.67339,stance loss: 0.66544 
Train step: 2040 acc:0.83645 total_loss: 0.77731  loss:0.48776,stance loss: 0.37394 
Train step: 2050 acc:0.83705 total_loss: 0.7731  loss:0.36385,stance loss: 0.27469 
Train step: 2060 acc:0.83761 total_loss: 0.76881  loss:0.9705,stance loss: 0.71833 
Train step: 2070 acc:0.83453 total_loss: 0.77442  loss:0.62782,stance loss: 0.51754 
Train step: 2080 acc:0.83317 total_loss: 0.78038  loss:1.0543,stance loss: 1.0109 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.91667 total_loss: 0.50149  loss:0.87983,stance loss: 0.58284 
Train step: 2100 acc:0.9375 total_loss: 0.44928  loss:0.2348,stance loss: 0.21623 
Train step: 2110 acc:0.90489 total_loss: 0.58791  loss:0.55829,stance loss: 0.42353 
Train step: 2120 acc:0.89962 total_loss: 0.60903  loss:0.22471,stance loss: 0.10889 
Train step: 2130 acc:0.89244 total_loss: 0.60901  loss:0.69195,stance loss: 0.67947 
Train step: 2140 acc:0.88443 total_loss: 0.62668  loss:0.44691,stance loss: 0.40163 
Train step: 2150 acc:0.88889 total_loss: 0.59544  loss:0.95918,stance loss: 0.78807 
Train step: 2160 acc:0.89555 total_loss: 0.57222  loss:0.45504,stance loss: 0.44004 
Train step: 2170 acc:0.88931 total_loss: 0.58666  loss:0.72366,stance loss: 0.63784 
Better F1! Saving model!
Saving model of best f1: 0.45562249857499226
              precision    recall  f1-score   support

           0   0.444444  0.561873  0.496307       299
           1   0.483051  0.438462  0.459677       260
           2   0.537634  0.337838  0.414938       148

    accuracy                       0.469590       707
   macro avg   0.488377  0.446057  0.456974       707
weighted avg   0.478150  0.469590  0.465803       707

Test Acc: 0.4695898161244696 F1_ma:0.45562249857499226
Train step: 2180 acc:0.8871 total_loss: 0.60072  loss:1.0695,stance loss: 0.94464 
Train step: 2190 acc:0.88592 total_loss: 0.6055  loss:1.1007,stance loss: 1.4181 
Train step: 2200 acc:0.8833 total_loss: 0.60868  loss:0.85972,stance loss: 0.58867 
Train step: 2210 acc:0.87754 total_loss: 0.61611  loss:0.99094,stance loss: 0.92158 
Train step: 2220 acc:0.87359 total_loss: 0.62531  loss:0.5285,stance loss: 0.43111 
Train step: 2230 acc:0.86888 total_loss: 0.63283  loss:1.0588,stance loss: 0.90983 
Train step: 2240 acc:0.86683 total_loss: 0.64535  loss:1.1079,stance loss: 1.0439 
Train step: 2250 acc:0.86887 total_loss: 0.64151  loss:0.50112,stance loss: 0.43049 
Train step: 2260 acc:0.8638 total_loss: 0.65111  loss:0.92101,stance loss: 0.80938 
Train step: 2270 acc:0.8651 total_loss: 0.64147  loss:0.71223,stance loss: 0.6571 
Train step: 2280 acc:0.86658 total_loss: 0.63706  loss:0.17642,stance loss: 0.10176 
Train step: 2290 acc:0.86484 total_loss: 0.64549  loss:0.69734,stance loss: 0.55546 
Train step: 2300 acc:0.86532 total_loss: 0.6388  loss:0.52186,stance loss: 0.3469 
Train step: 2310 acc:0.86463 total_loss: 0.64139  loss:0.32408,stance loss: 0.24545 
Train step: 2320 acc:0.86239 total_loss: 0.64361  loss:0.54477,stance loss: 0.23412 
Train step: 2330 acc:0.86265 total_loss: 0.64204  loss:0.44452,stance loss: 0.38179 
Train step: 2340 acc:0.86265 total_loss: 0.64605  loss:0.65819,stance loss: 0.62276 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.9375 total_loss: 0.3901  loss:0.20407,stance loss: 0.13766 
Train step: 2360 acc:0.90625 total_loss: 0.4699  loss:1.0677,stance loss: 0.90617 
Train step: 2370 acc:0.91193 total_loss: 0.47032  loss:0.58296,stance loss: 0.39674 
Train step: 2380 acc:0.91406 total_loss: 0.47226  loss:0.9902,stance loss: 1.6343 
Train step: 2390 acc:0.90774 total_loss: 0.49506  loss:0.87185,stance loss: 0.55461 
Train step: 2400 acc:0.90264 total_loss: 0.52211  loss:0.37086,stance loss: 0.31998 
Train step: 2410 acc:0.90323 total_loss: 0.52812  loss:0.26006,stance loss: 0.19508 
Train step: 2420 acc:0.90538 total_loss: 0.53421  loss:0.54222,stance loss: 0.42607 
Train step: 2430 acc:0.91082 total_loss: 0.51446  loss:0.8275,stance loss: 0.79925 
Train step: 2440 acc:0.91101 total_loss: 0.49696  loss:0.20372,stance loss: 0.090031 
Train step: 2450 acc:0.90686 total_loss: 0.50687  loss:0.85314,stance loss: 1.2151 
Train step: 2460 acc:0.90681 total_loss: 0.51389  loss:1.569,stance loss: 1.2117 
Train step: 2470 acc:0.90369 total_loss: 0.51624  loss:0.74794,stance loss: 0.6155 
Train step: 2480 acc:0.90246 total_loss: 0.52152  loss:0.20316,stance loss: 0.1494 
Train step: 2490 acc:0.90229 total_loss: 0.51522  loss:0.79803,stance loss: 1.2067 
Train step: 2500 acc:0.90502 total_loss: 0.50039  loss:0.45958,stance loss: 0.37272 
Train step: 2510 acc:0.90509 total_loss: 0.4953  loss:0.21928,stance loss: 0.1411 
Train step: 2520 acc:0.9048 total_loss: 0.5019  loss:0.85452,stance loss: 0.7329 
Train step: 2530 acc:0.90247 total_loss: 0.51218  loss:0.76888,stance loss: 0.81188 
Train step: 2540 acc:0.90007 total_loss: 0.51642  loss:0.7017,stance loss: 0.5115 
Train step: 2550 acc:0.90068 total_loss: 0.51861  loss:0.10529,stance loss: 0.017744 
Train step: 2560 acc:0.89976 total_loss: 0.51592  loss:0.73842,stance loss: 0.67963 
Train step: 2570 acc:0.89977 total_loss: 0.52113  loss:0.44977,stance loss: 0.5071 
Train step: 2580 acc:0.90059 total_loss: 0.51717  loss:0.15631,stance loss: 0.041307 
Train step: 2590 acc:0.89954 total_loss: 0.5227  loss:0.50513,stance loss: 0.47603 
Train step: 2600 acc:0.89856 total_loss: 0.52412  loss:0.084994,stance loss: 0.026561 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:0.9375 total_loss: 0.2387  loss:0.2387,stance loss: 0.13913 
Train step: 2620 acc:0.90341 total_loss: 0.37027  loss:0.26115,stance loss: 0.16248 
Train step: 2630 acc:0.93155 total_loss: 0.34054  loss:0.23974,stance loss: 0.24208 
Train step: 2640 acc:0.93548 total_loss: 0.37278  loss:0.20165,stance loss: 0.062602 
Train step: 2650 acc:0.93598 total_loss: 0.36367  loss:0.10668,stance loss: 0.061607 
Train step: 2660 acc:0.93505 total_loss: 0.37779  loss:0.3108,stance loss: 0.26689 
Train step: 2670 acc:0.93648 total_loss: 0.36768  loss:0.12638,stance loss: 0.043878 
Train step: 2680 acc:0.93662 total_loss: 0.3617  loss:0.49113,stance loss: 0.51956 
Train step: 2690 acc:0.93441 total_loss: 0.36171  loss:0.60755,stance loss: 0.60893 
Train step: 2700 acc:0.9272 total_loss: 0.38511  loss:0.48391,stance loss: 0.48475 
Train step: 2710 acc:0.92884 total_loss: 0.38446  loss:0.27906,stance loss: 0.15381 
Train step: 2720 acc:0.92962 total_loss: 0.38917  loss:0.33859,stance loss: 0.23973 
Train step: 2730 acc:0.9313 total_loss: 0.38108  loss:0.3187,stance loss: 0.12336 
Train step: 2740 acc:0.92796 total_loss: 0.38997  loss:0.12857,stance loss: 0.047622 
Train step: 2750 acc:0.92819 total_loss: 0.39444  loss:1.1201,stance loss: 1.0961 
Train step: 2760 acc:0.92674 total_loss: 0.40236  loss:0.14135,stance loss: 0.099225 
Train step: 2770 acc:0.92702 total_loss: 0.40282  loss:0.22896,stance loss: 0.16763 
Train step: 2780 acc:0.92727 total_loss: 0.40609  loss:0.14966,stance loss: 0.10083 
Train step: 2790 acc:0.9268 total_loss: 0.40804  loss:0.47164,stance loss: 0.42648 
Train step: 2800 acc:0.92572 total_loss: 0.41459  loss:0.50343,stance loss: 0.36701 
Train step: 2810 acc:0.92413 total_loss: 0.42086  loss:0.47096,stance loss: 0.45648 
Train step: 2820 acc:0.92476 total_loss: 0.42226  loss:0.57874,stance loss: 0.63798 
Train step: 2830 acc:0.92449 total_loss: 0.4191  loss:0.40621,stance loss: 0.30797 
Train step: 2840 acc:0.92343 total_loss: 0.42609  loss:0.29589,stance loss: 0.29242 
Train step: 2850 acc:0.92298 total_loss: 0.42536  loss:0.39007,stance loss: 0.38825 
Train step: 2860 acc:0.92281 total_loss: 0.42379  loss:0.49228,stance loss: 0.47155 
Train step: 2870 acc:0.92049 total_loss: 0.42796  loss:0.47378,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.94375 total_loss: 0.31999  loss:0.10056,stance loss: 0.043032 
Train step: 2890 acc:0.95937 total_loss: 0.33424  loss:0.31496,stance loss: 0.25374 
Train step: 2900 acc:0.94792 total_loss: 0.36086  loss:0.82023,stance loss: 1.2164 
Train step: 2910 acc:0.95 total_loss: 0.33016  loss:0.31765,stance loss: 0.08683 
Train step: 2920 acc:0.95 total_loss: 0.32983  loss:0.071675,stance loss: 0.021294 
Train step: 2930 acc:0.95 total_loss: 0.3191  loss:0.074721,stance loss: 0.0028663 
Train step: 2940 acc:0.94375 total_loss: 0.34921  loss:0.71351,stance loss: 1.1473 
Train step: 2950 acc:0.94063 total_loss: 0.34979  loss:0.40953,stance loss: 0.45646 
Train step: 2960 acc:0.93889 total_loss: 0.36414  loss:0.14439,stance loss: 0.078222 
Train step: 2970 acc:0.93812 total_loss: 0.36189  loss:0.38001,stance loss: 0.13316 
Train step: 2980 acc:0.9375 total_loss: 0.36248  loss:0.33805,stance loss: 0.29064 
Train step: 2990 acc:0.93854 total_loss: 0.35148  loss:0.22482,stance loss: 0.20722 
Train step: 3000 acc:0.9399 total_loss: 0.33936  loss:0.08843,stance loss: 0.055625 
Train step: 3010 acc:0.93884 total_loss: 0.34267  loss:0.15512,stance loss: 0.026486 
Train step: 3020 acc:0.93917 total_loss: 0.33621  loss:0.11808,stance loss: 0.068397 
Train step: 3030 acc:0.93672 total_loss: 0.33995  loss:0.39246,stance loss: 0.37898 
Train step: 3040 acc:0.93824 total_loss: 0.33397  loss:0.59171,stance loss: 1.0109 
Train step: 3050 acc:0.9375 total_loss: 0.3403  loss:0.74638,stance loss: 0.45296 
Train step: 3060 acc:0.9375 total_loss: 0.3433  loss:0.19358,stance loss: 0.1622 
Train step: 3070 acc:0.93844 total_loss: 0.34599  loss:1.038,stance loss: 0.89518 
Train step: 3080 acc:0.93988 total_loss: 0.34081  loss:0.38254,stance loss: 0.44921 
Train step: 3090 acc:0.94034 total_loss: 0.34076  loss:0.55422,stance loss: 0.4528 
Train step: 3100 acc:0.93913 total_loss: 0.34818  loss:0.16739,stance loss: 0.072139 
Train step: 3110 acc:0.93828 total_loss: 0.35352  loss:0.46873,stance loss: 0.32342 
Train step: 3120 acc:0.93825 total_loss: 0.35177  loss:0.14832,stance loss: 0.095891 
Train step: 3130 acc:0.93846 total_loss: 0.3505  loss:0.25529,stance loss: 0.24282 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.94444 total_loss: 0.41212  loss:0.2285,stance loss: 0.2272 
Train step: 3150 acc:0.95724 total_loss: 0.33017  loss:0.097904,stance loss: 0.025422 
Train step: 3160 acc:0.9569 total_loss: 0.30443  loss:0.15271,stance loss: 0.064356 
Train step: 3170 acc:0.95353 total_loss: 0.2814  loss:0.31191,stance loss: 0.26812 
Train step: 3180 acc:0.95791 total_loss: 0.27224  loss:0.10308,stance loss: 0.014461 
Train step: 3190 acc:0.95339 total_loss: 0.28339  loss:0.29722,stance loss: 0.23147 
Train step: 3200 acc:0.95018 total_loss: 0.2841  loss:0.16459,stance loss: 0.13588 
Train step: 3210 acc:0.95016 total_loss: 0.29506  loss:0.13306,stance loss: 0.11084 
Train step: 3220 acc:0.95225 total_loss: 0.29167  loss:0.61066,stance loss: 1.0193 
Train step: 3230 acc:0.95581 total_loss: 0.2838  loss:0.048799,stance loss: 0.0084291 
Train step: 3240 acc:0.957 total_loss: 0.28153  loss:0.056626,stance loss: 0.0054832 
Train step: 3250 acc:0.95746 total_loss: 0.2796  loss:0.078543,stance loss: 0.034884 
Train step: 3260 acc:0.95785 total_loss: 0.27315  loss:0.2751,stance loss: 0.36162 
Train step: 3270 acc:0.95773 total_loss: 0.2811  loss:0.19933,stance loss: 0.14931 
Train step: 3280 acc:0.95763 total_loss: 0.28033  loss:0.41637,stance loss: 0.38607 
Train step: 3290 acc:0.95637 total_loss: 0.2853  loss:0.10266,stance loss: 0.073173 
Train step: 3300 acc:0.95636 total_loss: 0.28317  loss:0.044504,stance loss: 0.0061726 
Train step: 3310 acc:0.95496 total_loss: 0.28418  loss:0.88127,stance loss: 0.69689 
Train step: 3320 acc:0.9547 total_loss: 0.28196  loss:0.39672,stance loss: 0.34319 
Train step: 3330 acc:0.95352 total_loss: 0.28149  loss:0.034073,stance loss: 0.0080472 
Train step: 3340 acc:0.95365 total_loss: 0.28638  loss:0.56506,stance loss: 0.47325 
Train step: 3350 acc:0.9532 total_loss: 0.2934  loss:0.47952,stance loss: 0.39094 
Train step: 3360 acc:0.9536 total_loss: 0.29295  loss:0.60877,stance loss: 1.0735 
Train step: 3370 acc:0.95371 total_loss: 0.29534  loss:0.083871,stance loss: 0.040783 
Train step: 3380 acc:0.95482 total_loss: 0.29216  loss:0.15941,stance loss: 0.11839 
Train step: 3390 acc:0.95463 total_loss: 0.29181  loss:0.76216,stance loss: 0.98583 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.96875 total_loss: 0.16285  loss:0.024402,stance loss: 0.010978 
Train step: 3410 acc:0.95833 total_loss: 0.25185  loss:0.27381,stance loss: 0.16087 
Train step: 3420 acc:0.96205 total_loss: 0.24099  loss:0.031443,stance loss: 0.0040978 
Train step: 3430 acc:0.96217 total_loss: 0.23902  loss:0.62547,stance loss: 1.0624 
Train step: 3440 acc:0.96354 total_loss: 0.25423  loss:0.082864,stance loss: 0.01018 
Train step: 3450 acc:0.96336 total_loss: 0.24157  loss:0.038842,stance loss: 0.014308 
Train step: 3460 acc:0.96048 total_loss: 0.24606  loss:0.33444,stance loss: 0.26278 
Train step: 3470 acc:0.95994 total_loss: 0.25164  loss:0.56852,stance loss: 1.0456 
Train step: 3480 acc:0.95952 total_loss: 0.24629  loss:0.095547,stance loss: 0.021009 
Train step: 3490 acc:0.95982 total_loss: 0.24676  loss:0.64286,stance loss: 0.64617 
Train step: 3500 acc:0.96065 total_loss: 0.25422  loss:0.046183,stance loss: 0.0061836 
Train step: 3510 acc:0.96239 total_loss: 0.24098  loss:0.050444,stance loss: 0.010944 
Train step: 3520 acc:0.9624 total_loss: 0.24239  loss:0.13065,stance loss: 0.028012 
Train step: 3530 acc:0.96286 total_loss: 0.24452  loss:0.76298,stance loss: 0.74859 
Train step: 3540 acc:0.96242 total_loss: 0.24642  loss:0.034861,stance loss: 0.011535 
Train step: 3550 acc:0.96282 total_loss: 0.24575  loss:0.10026,stance loss: 0.012193 
Train step: 3560 acc:0.96243 total_loss: 0.24549  loss:0.38433,stance loss: 0.35245 
Train step: 3570 acc:0.96243 total_loss: 0.24612  loss:0.12343,stance loss: 0.10924 
Train step: 3580 acc:0.96277 total_loss: 0.24428  loss:0.16186,stance loss: 0.076223 
Train step: 3590 acc:0.9637 total_loss: 0.24303  loss:0.53776,stance loss: 0.59077 
Train step: 3600 acc:0.96394 total_loss: 0.23681  loss:0.068405,stance loss: 0.011087 
Train step: 3610 acc:0.96474 total_loss: 0.23414  loss:0.17012,stance loss: 0.085599 
Train step: 3620 acc:0.96299 total_loss: 0.24187  loss:0.13518,stance loss: 0.077595 
Train step: 3630 acc:0.96087 total_loss: 0.2514  loss:0.46822,stance loss: 0.48749 
Train step: 3640 acc:0.96043 total_loss: 0.25164  loss:0.97668,stance loss: 1.3975 
Train step: 3650 acc:0.96027 total_loss: 0.25031  loss:0.29184,stance loss: 0.14377 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.95536 total_loss: 0.29166  loss:0.074282,stance loss: 0.032457 
Train step: 3670 acc:0.95956 total_loss: 0.25242  loss:0.069099,stance loss: 0.025432 
Train step: 3680 acc:0.96065 total_loss: 0.26919  loss:0.049684,stance loss: 0.023938 
Train step: 3690 acc:0.95608 total_loss: 0.27615  loss:0.30448,stance loss: 0.18288 
Train step: 3700 acc:0.95878 total_loss: 0.25513  loss:0.21556,stance loss: 0.158 
Train step: 3710 acc:0.96491 total_loss: 0.23754  loss:0.51547,stance loss: 1.0077 
Train step: 3720 acc:0.96455 total_loss: 0.23401  loss:0.026795,stance loss: 0.0054126 
Train step: 3730 acc:0.96429 total_loss: 0.23563  loss:0.03017,stance loss: 0.011529 
Train step: 3740 acc:0.96552 total_loss: 0.23891  loss:0.66231,stance loss: 1.1765 
Train step: 3750 acc:0.96649 total_loss: 0.23335  loss:0.080419,stance loss: 0.033982 
Train step: 3760 acc:0.96963 total_loss: 0.21551  loss:0.045994,stance loss: 0.012922 
Train step: 3770 acc:0.96902 total_loss: 0.22428  loss:0.03632,stance loss: 0.021202 
Train step: 3780 acc:0.96949 total_loss: 0.21904  loss:0.061931,stance loss: 0.033453 
Train step: 3790 acc:0.97035 total_loss: 0.20909  loss:0.21552,stance loss: 0.21392 
Train step: 3800 acc:0.97066 total_loss: 0.20767  loss:0.10713,stance loss: 0.036326 
Train step: 3810 acc:0.97054 total_loss: 0.21936  loss:0.53829,stance loss: 1.0123 
Train step: 3820 acc:0.96969 total_loss: 0.2215  loss:0.17242,stance loss: 0.03861 
Train step: 3830 acc:0.96999 total_loss: 0.21948  loss:0.60925,stance loss: 1.0854 
Train step: 3840 acc:0.97025 total_loss: 0.2238  loss:0.49249,stance loss: 0.58277 
Train step: 3850 acc:0.96954 total_loss: 0.22131  loss:0.081001,stance loss: 0.073362 
Train step: 3860 acc:0.9692 total_loss: 0.22664  loss:0.087155,stance loss: 0.041615 
Train step: 3870 acc:0.96918 total_loss: 0.23053  loss:0.50298,stance loss: 0.31484 
Train step: 3880 acc:0.96999 total_loss: 0.22754  loss:0.53944,stance loss: 1.0079 
Train step: 3890 acc:0.96941 total_loss: 0.2236  loss:0.023391,stance loss: 0.0044074 
Train step: 3900 acc:0.96989 total_loss: 0.22022  loss:0.017552,stance loss: 0.0031003 
Train step: 3910 acc:0.96863 total_loss: 0.22727  loss:0.022982,stance loss: 0.0077818 
Training finished.


Reload the best model with best f1 0.45562249857499226 from path test_outputs/bert-cross-topic/dt/2023-08-14 15-47-05/state_dict


              precision    recall  f1-score   support

           0   0.444444  0.561873  0.496307       299
           1   0.483051  0.438462  0.459677       260
           2   0.537634  0.337838  0.414938       148

    accuracy                       0.469590       707
   macro avg   0.488377  0.446057  0.456974       707
weighted avg   0.478150  0.469590  0.465803       707

Test Acc: 0.4695898161244696 F1_ma:0.45562249857499226
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.45562249857499226
acc: 0.4695898161244696, f1 :0.45697413883494103
classification report: 
              precision    recall  f1-score   support

         Con     0.4444    0.5619    0.4963       299
        None     0.4831    0.4385    0.4597       260
         Pro     0.5376    0.3378    0.4149       148

    accuracy                         0.4696       707
   macro avg     0.4884    0.4461    0.4570       707
weighted avg     0.4781    0.4696    0.4658       707

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 16-05-19', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 16-05-19
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.9352  loss:1.9352,stance loss: 1.4958 
Train step: 10 acc:0.19886 total_loss: 1.9744  loss:2.2703,stance loss: 1.7542 
Train step: 20 acc:0.21726 total_loss: 1.8585  loss:1.7728,stance loss: 1.1885 
Better F1! Saving model!
Saving model of best f1: 0.24270557029177717
              precision    recall  f1-score   support

           0   0.402198  0.612040  0.485411       299
           1   0.230159  0.223077  0.226562       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.340877       707
   macro avg   0.210786  0.278372  0.237325       707
weighted avg   0.254736  0.340877  0.288606       707

Test Acc: 0.3408769448373409 F1_ma:0.24270557029177717
Train step: 30 acc:0.29032 total_loss: 1.7944  loss:1.6868,stance loss: 1.164 
Better F1! Saving model!
Saving model of best f1: 0.29651741293532335
              precision    recall  f1-score   support

           0   0.422096  0.996656  0.593035       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.421499       707
   macro avg   0.140699  0.332219  0.197678       707
weighted avg   0.178510  0.421499  0.250803       707

Test Acc: 0.4214992927864215 F1_ma:0.29651741293532335
Train step: 40 acc:0.34909 total_loss: 1.747  loss:1.5748,stance loss: 1.1238 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 50 acc:0.375 total_loss: 1.7326  loss:1.5676,stance loss: 1.119 
Train step: 60 acc:0.40881 total_loss: 1.7013  loss:1.6316,stance loss: 1.1405 
Train step: 70 acc:0.42254 total_loss: 1.6958  loss:1.9099,stance loss: 1.1987 
Train step: 80 acc:0.43596 total_loss: 1.6942  loss:1.4914,stance loss: 1.1063 
Train step: 90 acc:0.44437 total_loss: 1.6923  loss:1.7258,stance loss: 1.1507 
Train step: 100 acc:0.4505 total_loss: 1.6849  loss:1.5248,stance loss: 1.1238 
Train step: 110 acc:0.4527 total_loss: 1.6841  loss:1.7614,stance loss: 1.2278 
Train step: 120 acc:0.46074 total_loss: 1.6767  loss:1.5812,stance loss: 1.1418 
Train step: 130 acc:0.4604 total_loss: 1.6754  loss:1.6419,stance loss: 1.1285 
Train step: 140 acc:0.46764 total_loss: 1.671  loss:1.7643,stance loss: 1.2173 
Train step: 150 acc:0.47144 total_loss: 1.6674  loss:1.6651,stance loss: 1.1987 
Train step: 160 acc:0.47399 total_loss: 1.6616  loss:1.8284,stance loss: 1.2479 
Train step: 170 acc:0.47222 total_loss: 1.6621  loss:1.8132,stance loss: 1.2328 
Train step: 180 acc:0.47756 total_loss: 1.655  loss:1.6213,stance loss: 1.0456 
Train step: 190 acc:0.47873 total_loss: 1.6538  loss:1.6557,stance loss: 1.1807 
Train step: 200 acc:0.4801 total_loss: 1.6551  loss:1.6412,stance loss: 1.1964 
Train step: 210 acc:0.48312 total_loss: 1.65  loss:1.4031,stance loss: 1.034 
Train step: 220 acc:0.48133 total_loss: 1.6518  loss:1.7714,stance loss: 1.2214 
Train step: 230 acc:0.48674 total_loss: 1.6477  loss:1.6037,stance loss: 1.2278 
Train step: 240 acc:0.48677 total_loss: 1.6464  loss:1.677,stance loss: 1.1031 
Train step: 250 acc:0.48755 total_loss: 1.6449  loss:1.7196,stance loss: 1.2029 
Train step: 260 acc:0.49075 total_loss: 1.6435  loss:3.5492,stance loss: 5.4571 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.5625 total_loss: 1.5947  loss:1.4748,stance loss: 1.0917 
Train step: 280 acc:0.56563 total_loss: 1.5558  loss:1.0169,stance loss: 0.46661 
Train step: 290 acc:0.56042 total_loss: 1.5645  loss:1.3902,stance loss: 1.1251 
Train step: 300 acc:0.57969 total_loss: 1.5465  loss:1.0464,stance loss: 0.6174 
Train step: 310 acc:0.5875 total_loss: 1.5338  loss:1.7566,stance loss: 1.1875 
Train step: 320 acc:0.57708 total_loss: 1.5504  loss:1.5196,stance loss: 1.0712 
Train step: 330 acc:0.57411 total_loss: 1.5468  loss:1.7348,stance loss: 1.4569 
Train step: 340 acc:0.57578 total_loss: 1.542  loss:1.6611,stance loss: 1.2498 
Train step: 350 acc:0.56944 total_loss: 1.5449  loss:1.4928,stance loss: 1.1097 
Train step: 360 acc:0.565 total_loss: 1.5498  loss:1.3555,stance loss: 0.98934 
Better F1! Saving model!
Saving model of best f1: 0.29740518962075846
              precision    recall  f1-score   support

           0   0.423898  0.996656  0.594810       299
           1   0.500000  0.007692  0.015152       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.307966  0.334783  0.203321       707
weighted avg   0.363148  0.424328  0.257125       707

Test Acc: 0.4243281471004243 F1_ma:0.29740518962075846
Train step: 370 acc:0.5608 total_loss: 1.5521  loss:1.5514,stance loss: 1.1935 
Train step: 380 acc:0.5625 total_loss: 1.5552  loss:1.4355,stance loss: 1.0594 
Train step: 390 acc:0.55625 total_loss: 1.5577  loss:1.6035,stance loss: 1.1737 
Train step: 400 acc:0.55893 total_loss: 1.5527  loss:1.6235,stance loss: 1.1252 
Train step: 410 acc:0.56333 total_loss: 1.5461  loss:1.5265,stance loss: 1.06 
Train step: 420 acc:0.56641 total_loss: 1.5399  loss:1.6909,stance loss: 1.122 
Train step: 430 acc:0.56728 total_loss: 1.5327  loss:1.3955,stance loss: 0.93666 
Train step: 440 acc:0.57222 total_loss: 1.5262  loss:1.6363,stance loss: 1.2644 
Train step: 450 acc:0.575 total_loss: 1.522  loss:1.1088,stance loss: 0.8215 
Train step: 460 acc:0.57688 total_loss: 1.5147  loss:1.1781,stance loss: 0.96738 
Train step: 470 acc:0.57976 total_loss: 1.5127  loss:1.3872,stance loss: 1.2923 
Better F1! Saving model!
Saving model of best f1: 0.2975124378109452
              precision    recall  f1-score   support

           0   0.423513  1.000000  0.595025       299
           1   1.000000  0.003846  0.007663       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.474504  0.334615  0.200896       707
weighted avg   0.546860  0.424328  0.254462       707

Test Acc: 0.4243281471004243 F1_ma:0.2975124378109452
Train step: 480 acc:0.57756 total_loss: 1.5159  loss:1.0537,stance loss: 0.75786 
Train step: 490 acc:0.57908 total_loss: 1.5103  loss:1.4139,stance loss: 1.034 
Train step: 500 acc:0.58073 total_loss: 1.5079  loss:1.418,stance loss: 0.95477 
Train step: 510 acc:0.5775 total_loss: 1.5092  loss:1.6396,stance loss: 1.2099 
Train step: 520 acc:0.57933 total_loss: 1.5062  loss:1.5074,stance loss: 1.141 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.57639 total_loss: 1.4318  loss:1.3378,stance loss: 0.92201 
Train step: 540 acc:0.57237 total_loss: 1.4131  loss:1.484,stance loss: 1.0115 
Better F1! Saving model!
Saving model of best f1: 0.29780876494023906
              precision    recall  f1-score   support

           0   0.424113  1.000000  0.595618       299
           1   0.500000  0.003846  0.007634       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.308038  0.334615  0.201084       707
weighted avg   0.363239  0.424328  0.254702       707

Test Acc: 0.4243281471004243 F1_ma:0.29780876494023906
Train step: 550 acc:0.57543 total_loss: 1.4537  loss:1.4977,stance loss: 1.0141 
Train step: 560 acc:0.57853 total_loss: 1.4673  loss:1.6194,stance loss: 1.2148 
Train step: 570 acc:0.58291 total_loss: 1.4683  loss:1.5489,stance loss: 1.6001 
Train step: 580 acc:0.58686 total_loss: 1.4516  loss:1.4314,stance loss: 1.1461 
Train step: 590 acc:0.5933 total_loss: 1.4445  loss:0.98309,stance loss: 0.60503 
Train step: 600 acc:0.59889 total_loss: 1.4462  loss:1.2038,stance loss: 0.94389 
Train step: 610 acc:0.60674 total_loss: 1.4305  loss:1.2298,stance loss: 0.9764 
Train step: 620 acc:0.61301 total_loss: 1.4193  loss:1.5019,stance loss: 1.0339 
Train step: 630 acc:0.61583 total_loss: 1.4116  loss:1.54,stance loss: 1.2217 
Train step: 640 acc:0.61712 total_loss: 1.4035  loss:1.3937,stance loss: 1.0558 
Train step: 650 acc:0.62258 total_loss: 1.3956  loss:1.3597,stance loss: 1.06 
Train step: 660 acc:0.61871 total_loss: 1.3968  loss:1.3396,stance loss: 1.0078 
Train step: 670 acc:0.61913 total_loss: 1.3933  loss:0.94887,stance loss: 0.6767 
Train step: 680 acc:0.61714 total_loss: 1.3936  loss:1.501,stance loss: 1.5028 
Train step: 690 acc:0.61391 total_loss: 1.3939  loss:1.1701,stance loss: 0.91218 
Train step: 700 acc:0.61348 total_loss: 1.3896  loss:1.4972,stance loss: 0.84699 
Train step: 710 acc:0.61409 total_loss: 1.3851  loss:1.4561,stance loss: 1.6747 
Train step: 720 acc:0.61212 total_loss: 1.387  loss:1.6999,stance loss: 1.8747 
Train step: 730 acc:0.61334 total_loss: 1.3821  loss:1.1736,stance loss: 0.91883 
Train step: 740 acc:0.61216 total_loss: 1.382  loss:1.5063,stance loss: 1.5198 
Train step: 750 acc:0.61354 total_loss: 1.3801  loss:1.3469,stance loss: 1.0887 
Train step: 760 acc:0.61428 total_loss: 1.3807  loss:1.0781,stance loss: 0.78698 
Train step: 770 acc:0.61521 total_loss: 1.3765  loss:1.1711,stance loss: 0.82092 
Train step: 780 acc:0.61559 total_loss: 1.372  loss:1.2737,stance loss: 0.96797 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.61719 total_loss: 1.2769  loss:1.5679,stance loss: 1.5274 
Train step: 800 acc:0.66667 total_loss: 1.2722  loss:1.0796,stance loss: 0.78149 
Train step: 810 acc:0.68527 total_loss: 1.2608  loss:1.8588,stance loss: 1.6811 
Train step: 820 acc:0.66283 total_loss: 1.2769  loss:1.4253,stance loss: 1.1753 
Train step: 830 acc:0.66146 total_loss: 1.278  loss:1.2695,stance loss: 1.0462 
Train step: 840 acc:0.6778 total_loss: 1.2439  loss:1.1873,stance loss: 1.2369 
Train step: 850 acc:0.67647 total_loss: 1.2457  loss:0.70995,stance loss: 0.47297 
Train step: 860 acc:0.66907 total_loss: 1.2452  loss:1.3765,stance loss: 0.96296 
Train step: 870 acc:0.66974 total_loss: 1.2438  loss:1.074,stance loss: 0.79294 
Train step: 880 acc:0.66964 total_loss: 1.2334  loss:1.1218,stance loss: 0.73794 
Train step: 890 acc:0.66725 total_loss: 1.249  loss:1.2952,stance loss: 1.218 
Train step: 900 acc:0.66578 total_loss: 1.2515  loss:1.2839,stance loss: 1.104 
Train step: 910 acc:0.66455 total_loss: 1.2557  loss:1.3572,stance loss: 1.0471 
Train step: 920 acc:0.65987 total_loss: 1.2589  loss:0.77156,stance loss: 0.25476 
Train step: 930 acc:0.66258 total_loss: 1.2624  loss:1.5846,stance loss: 0.92775 
Train step: 940 acc:0.66535 total_loss: 1.2589  loss:0.71761,stance loss: 0.4826 
Train step: 950 acc:0.66406 total_loss: 1.2641  loss:1.2938,stance loss: 0.87536 
Train step: 960 acc:0.66292 total_loss: 1.2631  loss:0.86,stance loss: 0.50448 
Train step: 970 acc:0.66223 total_loss: 1.264  loss:1.6218,stance loss: 1.2041 
Train step: 980 acc:0.66162 total_loss: 1.2629  loss:1.4216,stance loss: 1.1522 
Train step: 990 acc:0.66256 total_loss: 1.2574  loss:0.92557,stance loss: 0.73157 
Train step: 1000 acc:0.66141 total_loss: 1.2608  loss:1.8529,stance loss: 1.8821 
Train step: 1010 acc:0.66393 total_loss: 1.2563  loss:1.0788,stance loss: 0.90822 
Train step: 1020 acc:0.66597 total_loss: 1.2547  loss:1.124,stance loss: 0.92809 
Train step: 1030 acc:0.66608 total_loss: 1.2532  loss:1.3689,stance loss: 1.1311 
Train step: 1040 acc:0.66642 total_loss: 1.2536  loss:1.345,stance loss: 1.0577 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.65179 total_loss: 1.298  loss:1.0905,stance loss: 0.83663 
Train step: 1060 acc:0.66544 total_loss: 1.1975  loss:1.5565,stance loss: 1.2138 
Train step: 1070 acc:0.67361 total_loss: 1.2086  loss:1.1342,stance loss: 0.85138 
Train step: 1080 acc:0.66385 total_loss: 1.2198  loss:1.009,stance loss: 0.90755 
Train step: 1090 acc:0.67021 total_loss: 1.2153  loss:0.93555,stance loss: 0.62039 
Train step: 1100 acc:0.66886 total_loss: 1.2165  loss:1.3064,stance loss: 1.0259 
Train step: 1110 acc:0.67444 total_loss: 1.2119  loss:1.014,stance loss: 0.79218 
Train step: 1120 acc:0.67451 total_loss: 1.2138  loss:1.1157,stance loss: 0.99843 
Train step: 1130 acc:0.67529 total_loss: 1.215  loss:1.3357,stance loss: 1.4808 
Train step: 1140 acc:0.67912 total_loss: 1.1964  loss:1.0705,stance loss: 0.77301 
Train step: 1150 acc:0.68107 total_loss: 1.1956  loss:1.0646,stance loss: 0.81778 
Train step: 1160 acc:0.68269 total_loss: 1.1883  loss:1.2355,stance loss: 0.86441 
Train step: 1170 acc:0.68061 total_loss: 1.1865  loss:1.1679,stance loss: 0.86325 
Train step: 1180 acc:0.67838 total_loss: 1.1901  loss:1.367,stance loss: 1.16 
Better F1! Saving model!
Saving model of best f1: 0.3002597964927473
              precision    recall  f1-score   support

           0   0.432647  0.913043  0.587097       299
           1   0.493333  0.142308  0.220896       260
           2   1.000000  0.006757  0.013423       148

    accuracy                       0.439887       707
   macro avg   0.641993  0.354036  0.273805       707
weighted avg   0.573731  0.439887  0.332336       707

Test Acc: 0.43988684582743987 F1_ma:0.3002597964927473
Train step: 1190 acc:0.67985 total_loss: 1.1865  loss:1.4582,stance loss: 1.2024 
Train step: 1200 acc:0.67874 total_loss: 1.1879  loss:0.9402,stance loss: 0.76506 
Train step: 1210 acc:0.68114 total_loss: 1.1861  loss:1.2283,stance loss: 0.80639 
Train step: 1220 acc:0.68291 total_loss: 1.1845  loss:1.1263,stance loss: 0.87498 
Train step: 1230 acc:0.68449 total_loss: 1.1809  loss:0.80001,stance loss: 0.61921 
Train step: 1240 acc:0.68687 total_loss: 1.1843  loss:1.2671,stance loss: 0.96664 
Train step: 1250 acc:0.69173 total_loss: 1.1733  loss:0.9529,stance loss: 0.76121 
Train step: 1260 acc:0.69556 total_loss: 1.1656  loss:0.97846,stance loss: 0.98058 
Train step: 1270 acc:0.69493 total_loss: 1.1684  loss:1.0489,stance loss: 0.90145 
Train step: 1280 acc:0.6962 total_loss: 1.1679  loss:1.1137,stance loss: 0.76318 
Train step: 1290 acc:0.69712 total_loss: 1.1664  loss:1.3606,stance loss: 1.1775 
Train step: 1300 acc:0.69553 total_loss: 1.1667  loss:1.2301,stance loss: 0.96107 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.66667 total_loss: 0.93219  loss:0.81626,stance loss: 0.55411 
Better F1! Saving model!
Saving model of best f1: 0.3389589759537397
              precision    recall  f1-score   support

           0   0.454545  0.668896  0.541272       299
           1   0.503937  0.492308  0.498054       260
           2   0.846154  0.074324  0.136646       148

    accuracy                       0.479491       707
   macro avg   0.601545  0.411843  0.391991       707
weighted avg   0.554687  0.479491  0.440676       707

Test Acc: 0.4794908062234795 F1_ma:0.3389589759537397
Train step: 1320 acc:0.73828 total_loss: 0.94222  loss:0.91138,stance loss: 0.67462 
Train step: 1330 acc:0.72596 total_loss: 0.99439  loss:1.334,stance loss: 1.0899 
Train step: 1340 acc:0.72917 total_loss: 1.0186  loss:1.021,stance loss: 0.74899 
Train step: 1350 acc:0.72011 total_loss: 1.0221  loss:0.72578,stance loss: 0.53156 
Train step: 1360 acc:0.71429 total_loss: 1.0564  loss:1.0409,stance loss: 0.76425 
Train step: 1370 acc:0.71875 total_loss: 1.0481  loss:1.0278,stance loss: 0.70073 
Train step: 1380 acc:0.71793 total_loss: 1.0527  loss:0.98118,stance loss: 0.89193 
Train step: 1390 acc:0.71802 total_loss: 1.0384  loss:1.0633,stance loss: 0.812 
Train step: 1400 acc:0.7207 total_loss: 1.0405  loss:1.0039,stance loss: 0.76871 
Train step: 1410 acc:0.71934 total_loss: 1.0443  loss:0.7575,stance loss: 0.55985 
Train step: 1420 acc:0.72144 total_loss: 1.0388  loss:0.58159,stance loss: 0.27985 
Train step: 1430 acc:0.72222 total_loss: 1.0421  loss:1.3567,stance loss: 1.2245 
Train step: 1440 acc:0.72289 total_loss: 1.0411  loss:1.1314,stance loss: 0.86498 
Train step: 1450 acc:0.72346 total_loss: 1.0412  loss:1.2712,stance loss: 1.4591 
Train step: 1460 acc:0.72476 total_loss: 1.0423  loss:1.0248,stance loss: 0.72569 
Train step: 1470 acc:0.72101 total_loss: 1.0516  loss:1.278,stance loss: 1.0957 
Train step: 1480 acc:0.72408 total_loss: 1.0486  loss:0.39046,stance loss: 0.24856 
Train step: 1490 acc:0.72379 total_loss: 1.0519  loss:1.1817,stance loss: 0.99628 
Train step: 1500 acc:0.72194 total_loss: 1.0603  loss:0.97144,stance loss: 0.70528 
Better F1! Saving model!
Saving model of best f1: 0.3648954318569533
              precision    recall  f1-score   support

           0   0.433544  0.916388  0.588614       299
           1   0.660377  0.134615  0.223642       260
           2   0.545455  0.081081  0.141176       148

    accuracy                       0.454031       707
   macro avg   0.546459  0.377361  0.317811       707
weighted avg   0.540389  0.454031  0.360731       707

Test Acc: 0.45403111739745405 F1_ma:0.3648954318569533
Train step: 1510 acc:0.72178 total_loss: 1.0608  loss:0.91625,stance loss: 0.67987 
Train step: 1520 acc:0.72512 total_loss: 1.0599  loss:1.2661,stance loss: 1.0927 
Train step: 1530 acc:0.72539 total_loss: 1.0574  loss:0.84289,stance loss: 0.65149 
Train step: 1540 acc:0.72828 total_loss: 1.0492  loss:0.73149,stance loss: 0.44379 
Train step: 1550 acc:0.72764 total_loss: 1.054  loss:0.86306,stance loss: 0.88514 
Train step: 1560 acc:0.729 total_loss: 1.0536  loss:0.61647,stance loss: 0.45249 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.7125 total_loss: 1.1616  loss:1.0228,stance loss: 0.83571 
Train step: 1580 acc:0.74167 total_loss: 1.031  loss:0.95833,stance loss: 0.85091 
Train step: 1590 acc:0.7575 total_loss: 0.98409  loss:0.63232,stance loss: 0.52179 
Train step: 1600 acc:0.7625 total_loss: 0.96068  loss:0.92445,stance loss: 0.61516 
Train step: 1610 acc:0.7625 total_loss: 0.96133  loss:0.92951,stance loss: 0.55449 
Train step: 1620 acc:0.76023 total_loss: 0.97402  loss:1.0591,stance loss: 0.71136 
Better F1! Saving model!
Saving model of best f1: 0.3754513143540838
              precision    recall  f1-score   support

           0   0.454733  0.739130  0.563057       299
           1   0.579787  0.419231  0.486607       260
           2   0.515152  0.114865  0.187845       148

    accuracy                       0.490806       707
   macro avg   0.516557  0.424409  0.412503       707
weighted avg   0.513369  0.490806  0.456398       707

Test Acc: 0.4908062234794908 F1_ma:0.3754513143540838
Train step: 1630 acc:0.75192 total_loss: 0.9753  loss:1.8412,stance loss: 1.9526 
Train step: 1640 acc:0.75833 total_loss: 0.96654  loss:0.7667,stance loss: 0.45542 
Train step: 1650 acc:0.75147 total_loss: 0.98272  loss:1.356,stance loss: 0.96551 
Train step: 1660 acc:0.75132 total_loss: 0.99459  loss:0.81306,stance loss: 0.58763 
Better F1! Saving model!
Saving model of best f1: 0.4138155483373567
              precision    recall  f1-score   support

           0   0.445763  0.879599  0.591676       299
           1   0.609195  0.203846  0.305476       260
           2   0.700000  0.141892  0.235955       148

    accuracy                       0.476662       707
   macro avg   0.584986  0.408446  0.377702       707
weighted avg   0.559086  0.476662  0.411961       707

Test Acc: 0.4766619519094767 F1_ma:0.4138155483373567
Train step: 1670 acc:0.75298 total_loss: 0.98163  loss:0.6283,stance loss: 0.37115 
Train step: 1680 acc:0.75109 total_loss: 0.98609  loss:0.57703,stance loss: 0.38608 
Train step: 1690 acc:0.75 total_loss: 0.98758  loss:0.75444,stance loss: 0.65323 
Train step: 1700 acc:0.75231 total_loss: 0.97862  loss:0.76269,stance loss: 0.61957 
Train step: 1710 acc:0.75603 total_loss: 0.96887  loss:0.85874,stance loss: 0.70617 
Train step: 1720 acc:0.75484 total_loss: 0.96245  loss:1.1393,stance loss: 0.68986 
Train step: 1730 acc:0.75227 total_loss: 0.96379  loss:1.233,stance loss: 0.84203 
Train step: 1740 acc:0.75214 total_loss: 0.96958  loss:0.8102,stance loss: 0.61242 
Better F1! Saving model!
Saving model of best f1: 0.4396734635163808
              precision    recall  f1-score   support

           0   0.449833  0.899666  0.599777       299
           1   0.647887  0.176923  0.277946       260
           2   0.684211  0.175676  0.279570       148

    accuracy                       0.482320       707
   macro avg   0.593977  0.417421  0.385764       707
weighted avg   0.571731  0.482320  0.414393       707

Test Acc: 0.4823196605374823 F1_ma:0.4396734635163808
Train step: 1750 acc:0.75473 total_loss: 0.96592  loss:0.97797,stance loss: 0.75991 
Train step: 1760 acc:0.75353 total_loss: 0.9664  loss:1.5911,stance loss: 1.2577 
Train step: 1770 acc:0.75335 total_loss: 0.9664  loss:0.70911,stance loss: 0.43409 
Train step: 1780 acc:0.7564 total_loss: 0.96084  loss:1.0448,stance loss: 0.92627 
Train step: 1790 acc:0.75444 total_loss: 0.96092  loss:0.5548,stance loss: 0.40166 
Train step: 1800 acc:0.75505 total_loss: 0.96003  loss:1.5796,stance loss: 1.7236 
Train step: 1810 acc:0.75918 total_loss: 0.94966  loss:0.67138,stance loss: 0.52178 
Train step: 1820 acc:0.75931 total_loss: 0.95178  loss:1.0482,stance loss: 0.76844 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.85938 total_loss: 0.70616  loss:0.49457,stance loss: 0.33117 
Train step: 1840 acc:0.83482 total_loss: 0.72335  loss:0.45073,stance loss: 0.27938 
Train step: 1850 acc:0.8125 total_loss: 0.7484  loss:1.0768,stance loss: 1.0064 
Train step: 1860 acc:0.81066 total_loss: 0.76224  loss:0.69524,stance loss: 0.488 
Train step: 1870 acc:0.79688 total_loss: 0.79669  loss:1.0557,stance loss: 0.57033 
Train step: 1880 acc:0.81134 total_loss: 0.76871  loss:0.87092,stance loss: 0.63896 
Train step: 1890 acc:0.80566 total_loss: 0.78573  loss:0.8045,stance loss: 0.6086 
Train step: 1900 acc:0.80405 total_loss: 0.7871  loss:0.75174,stance loss: 0.48611 
Train step: 1910 acc:0.80506 total_loss: 0.79172  loss:0.82183,stance loss: 0.87379 
Train step: 1920 acc:0.80851 total_loss: 0.77808  loss:0.56873,stance loss: 0.36502 
Train step: 1930 acc:0.80409 total_loss: 0.78466  loss:1.6215,stance loss: 0.83987 
Train step: 1940 acc:0.80373 total_loss: 0.78651  loss:0.70805,stance loss: 0.57624 
Train step: 1950 acc:0.79889 total_loss: 0.79916  loss:0.82924,stance loss: 0.62799 
Train step: 1960 acc:0.79991 total_loss: 0.80779  loss:0.56857,stance loss: 0.42697 
Train step: 1970 acc:0.79818 total_loss: 0.81497  loss:1.5734,stance loss: 1.717 
Train step: 1980 acc:0.7983 total_loss: 0.80975  loss:0.86123,stance loss: 0.49537 
Train step: 1990 acc:0.7984 total_loss: 0.81212  loss:1.2053,stance loss: 1.0828 
Train step: 2000 acc:0.79849 total_loss: 0.81191  loss:0.61273,stance loss: 0.41733 
Train step: 2010 acc:0.79959 total_loss: 0.80724  loss:0.58632,stance loss: 0.45915 
Train step: 2020 acc:0.79671 total_loss: 0.81959  loss:0.53733,stance loss: 0.35411 
Train step: 2030 acc:0.79626 total_loss: 0.82052  loss:0.72343,stance loss: 0.60152 
Train step: 2040 acc:0.79848 total_loss: 0.8185  loss:1.2204,stance loss: 1.1778 
Train step: 2050 acc:0.79855 total_loss: 0.82175  loss:0.98224,stance loss: 0.6104 
Train step: 2060 acc:0.79567 total_loss: 0.82474  loss:0.91644,stance loss: 0.7076 
Train step: 2070 acc:0.79713 total_loss: 0.82446  loss:0.92235,stance loss: 1.2526 
Train step: 2080 acc:0.79675 total_loss: 0.83036  loss:1.1567,stance loss: 1.0731 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.83333 total_loss: 0.63571  loss:0.91008,stance loss: 0.50775 
Train step: 2100 acc:0.84135 total_loss: 0.69983  loss:0.39194,stance loss: 0.30628 
Train step: 2110 acc:0.85598 total_loss: 0.66005  loss:0.58248,stance loss: 0.55929 
Better F1! Saving model!
Saving model of best f1: 0.4656261612783352
              precision    recall  f1-score   support

           0   0.472851  0.698997  0.564103       299
           1   0.582524  0.461538  0.515021       260
           2   0.644068  0.256757  0.367150       148

    accuracy                       0.519095       707
   macro avg   0.566481  0.472431  0.482091       707
weighted avg   0.549025  0.519095  0.504824       707

Test Acc: 0.5190947666195191 F1_ma:0.4656261612783352
Train step: 2120 acc:0.85038 total_loss: 0.69737  loss:1.2877,stance loss: 1.1645 
Train step: 2130 acc:0.84738 total_loss: 0.7043  loss:1.0826,stance loss: 0.83358 
Train step: 2140 acc:0.84316 total_loss: 0.70736  loss:0.69973,stance loss: 0.55271 
Train step: 2150 acc:0.8373 total_loss: 0.70548  loss:0.64999,stance loss: 0.41533 
Train step: 2160 acc:0.83562 total_loss: 0.72533  loss:0.9823,stance loss: 1.2516 
Train step: 2170 acc:0.83057 total_loss: 0.75329  loss:0.92137,stance loss: 1.2373 
Train step: 2180 acc:0.8293 total_loss: 0.76946  loss:1.4035,stance loss: 1.1353 
Train step: 2190 acc:0.83252 total_loss: 0.7589  loss:0.60348,stance loss: 0.4902 
Train step: 2200 acc:0.83462 total_loss: 0.75626  loss:0.75352,stance loss: 0.62697 
Train step: 2210 acc:0.83283 total_loss: 0.75335  loss:0.79319,stance loss: 0.68495 
Train step: 2220 acc:0.83318 total_loss: 0.7541  loss:0.90547,stance loss: 0.89152 
Train step: 2230 acc:0.83566 total_loss: 0.75331  loss:0.88628,stance loss: 0.84994 
Train step: 2240 acc:0.83456 total_loss: 0.75439  loss:0.40701,stance loss: 0.28876 
Train step: 2250 acc:0.83359 total_loss: 0.75976  loss:0.93893,stance loss: 1.2924 
Train step: 2260 acc:0.83273 total_loss: 0.76207  loss:0.70638,stance loss: 0.62538 
Train step: 2270 acc:0.83333 total_loss: 0.75513  loss:0.96785,stance loss: 1.2752 
Train step: 2280 acc:0.83744 total_loss: 0.74364  loss:0.50513,stance loss: 0.25803 
Train step: 2290 acc:0.83559 total_loss: 0.74389  loss:0.36347,stance loss: 0.15447 
Train step: 2300 acc:0.83509 total_loss: 0.74633  loss:0.61499,stance loss: 0.52755 
Train step: 2310 acc:0.83576 total_loss: 0.74952  loss:0.83269,stance loss: 0.64417 
Train step: 2320 acc:0.83637 total_loss: 0.7469  loss:0.74747,stance loss: 0.63321 
Train step: 2330 acc:0.83899 total_loss: 0.73804  loss:0.63959,stance loss: 0.5065 
Train step: 2340 acc:0.84091 total_loss: 0.73376  loss:0.66077,stance loss: 0.51728 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.875 total_loss: 0.46013  loss:0.43387,stance loss: 0.33039 
Train step: 2360 acc:0.88021 total_loss: 0.66682  loss:1.0466,stance loss: 1.2851 
Train step: 2370 acc:0.89205 total_loss: 0.6384  loss:0.51286,stance loss: 0.37002 
Train step: 2380 acc:0.875 total_loss: 0.65764  loss:0.42828,stance loss: 0.33217 
Train step: 2390 acc:0.875 total_loss: 0.64768  loss:0.51398,stance loss: 0.32094 
Train step: 2400 acc:0.87981 total_loss: 0.64377  loss:0.99936,stance loss: 1.3761 
Train step: 2410 acc:0.88004 total_loss: 0.64454  loss:0.78106,stance loss: 0.7171 
Train step: 2420 acc:0.87326 total_loss: 0.6486  loss:1.1186,stance loss: 1.3026 
Train step: 2430 acc:0.8689 total_loss: 0.65294  loss:0.53584,stance loss: 0.36775 
Train step: 2440 acc:0.86957 total_loss: 0.64775  loss:1.0672,stance loss: 1.3035 
Train step: 2450 acc:0.87316 total_loss: 0.63904  loss:0.92328,stance loss: 1.2865 
Train step: 2460 acc:0.8683 total_loss: 0.6426  loss:0.64157,stance loss: 0.51474 
Train step: 2470 acc:0.86834 total_loss: 0.64354  loss:0.55952,stance loss: 0.35257 
Train step: 2480 acc:0.87074 total_loss: 0.63534  loss:0.51888,stance loss: 0.30904 
Train step: 2490 acc:0.87236 total_loss: 0.62935  loss:1.0183,stance loss: 0.76277 
Train step: 2500 acc:0.8713 total_loss: 0.63751  loss:0.38655,stance loss: 0.17235 
Train step: 2510 acc:0.8723 total_loss: 0.64109  loss:0.091373,stance loss: 0.025639 
Train step: 2520 acc:0.87173 total_loss: 0.64114  loss:0.85136,stance loss: 0.60007 
Train step: 2530 acc:0.87157 total_loss: 0.63851  loss:0.33829,stance loss: 0.25691 
Train step: 2540 acc:0.86979 total_loss: 0.6386  loss:0.46998,stance loss: 0.33035 
Train step: 2550 acc:0.86943 total_loss: 0.63815  loss:1.0928,stance loss: 1.2675 
Train step: 2560 acc:0.86792 total_loss: 0.64114  loss:1.2025,stance loss: 0.92956 
Train step: 2570 acc:0.86684 total_loss: 0.64211  loss:0.92913,stance loss: 1.1696 
Train step: 2580 acc:0.86853 total_loss: 0.64071  loss:0.55174,stance loss: 0.42184 
Train step: 2590 acc:0.86854 total_loss: 0.64354  loss:0.75724,stance loss: 0.63234 
Train step: 2600 acc:0.86954 total_loss: 0.63577  loss:0.20649,stance loss: 0.13096 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:1.0 total_loss: 0.25608  loss:0.25608,stance loss: 0.1727 
Train step: 2620 acc:0.92045 total_loss: 0.50312  loss:0.7669,stance loss: 0.73192 
Train step: 2630 acc:0.89286 total_loss: 0.58081  loss:0.28269,stance loss: 0.18616 
Train step: 2640 acc:0.89113 total_loss: 0.58744  loss:0.48488,stance loss: 0.31873 
Train step: 2650 acc:0.89634 total_loss: 0.57641  loss:0.45933,stance loss: 0.11646 
Train step: 2660 acc:0.89583 total_loss: 0.58158  loss:0.50585,stance loss: 0.3712 
Train step: 2670 acc:0.89037 total_loss: 0.5903  loss:0.56911,stance loss: 0.39881 
Train step: 2680 acc:0.8838 total_loss: 0.58682  loss:0.44494,stance loss: 0.29516 
Train step: 2690 acc:0.88966 total_loss: 0.55951  loss:0.47002,stance loss: 0.33922 
Train step: 2700 acc:0.89011 total_loss: 0.55358  loss:0.15756,stance loss: 0.052779 
Better F1! Saving model!
Saving model of best f1: 0.48737841940729276
              precision    recall  f1-score   support

           0   0.471861  0.729097  0.572930       299
           1   0.603448  0.403846  0.483871       260
           2   0.619718  0.297297  0.401826       148

    accuracy                       0.519095       707
   macro avg   0.565009  0.476747  0.486209       707
weighted avg   0.551204  0.519095  0.504361       707

Test Acc: 0.5190947666195191 F1_ma:0.48737841940729276
Train step: 2710 acc:0.89109 total_loss: 0.55959  loss:0.27547,stance loss: 0.15503 
Train step: 2720 acc:0.89245 total_loss: 0.55359  loss:0.093929,stance loss: 0.0077991 
Train step: 2730 acc:0.89308 total_loss: 0.55681  loss:0.60855,stance loss: 1.0184 
Train step: 2740 acc:0.89408 total_loss: 0.54718  loss:0.40819,stance loss: 0.27986 
Train step: 2750 acc:0.89362 total_loss: 0.54465  loss:1.0086,stance loss: 0.46417 
Train step: 2760 acc:0.89445 total_loss: 0.53535  loss:0.4478,stance loss: 0.25153 
Train step: 2770 acc:0.89286 total_loss: 0.54438  loss:0.68103,stance loss: 0.70718 
Train step: 2780 acc:0.89327 total_loss: 0.5497  loss:0.35614,stance loss: 0.25537 
Train step: 2790 acc:0.89537 total_loss: 0.54039  loss:0.13989,stance loss: 0.056399 
Train step: 2800 acc:0.89496 total_loss: 0.54313  loss:0.74819,stance loss: 0.52339 
Train step: 2810 acc:0.89459 total_loss: 0.54456  loss:0.99979,stance loss: 1.3872 
Train step: 2820 acc:0.89544 total_loss: 0.54615  loss:0.13853,stance loss: 0.075413 
Train step: 2830 acc:0.89536 total_loss: 0.54368  loss:0.73068,stance loss: 0.71588 
Train step: 2840 acc:0.89637 total_loss: 0.54357  loss:0.71606,stance loss: 1.0798 
Train step: 2850 acc:0.89575 total_loss: 0.54513  loss:0.82793,stance loss: 1.1381 
Train step: 2860 acc:0.89567 total_loss: 0.54358  loss:0.48524,stance loss: 0.35257 
Train step: 2870 acc:0.89623 total_loss: 0.55021  loss:8.1934,stance loss: 16.118 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9375 total_loss: 0.40261  loss:0.36094,stance loss: 0.30422 
Train step: 2890 acc:0.92812 total_loss: 0.43433  loss:0.16924,stance loss: 0.11269 
Train step: 2900 acc:0.93333 total_loss: 0.37641  loss:0.18609,stance loss: 0.12479 
Train step: 2910 acc:0.94063 total_loss: 0.37522  loss:0.34537,stance loss: 0.20424 
Train step: 2920 acc:0.935 total_loss: 0.40895  loss:0.77391,stance loss: 1.1081 
Train step: 2930 acc:0.92604 total_loss: 0.4294  loss:0.63042,stance loss: 0.478 
Train step: 2940 acc:0.92768 total_loss: 0.43393  loss:0.21749,stance loss: 0.095176 
Train step: 2950 acc:0.91875 total_loss: 0.45047  loss:0.55978,stance loss: 0.38256 
Train step: 2960 acc:0.91944 total_loss: 0.44937  loss:0.49138,stance loss: 0.45573 
Train step: 2970 acc:0.92 total_loss: 0.44746  loss:0.48171,stance loss: 0.36153 
Train step: 2980 acc:0.92216 total_loss: 0.44804  loss:0.44322,stance loss: 0.4179 
Train step: 2990 acc:0.92083 total_loss: 0.45491  loss:0.47887,stance loss: 0.42709 
Train step: 3000 acc:0.91683 total_loss: 0.46818  loss:0.4951,stance loss: 0.2892 
Train step: 3010 acc:0.91607 total_loss: 0.47004  loss:0.58183,stance loss: 0.56081 
Train step: 3020 acc:0.91583 total_loss: 0.47872  loss:0.66155,stance loss: 1.0865 
Train step: 3030 acc:0.91484 total_loss: 0.48504  loss:0.53636,stance loss: 0.43974 
Train step: 3040 acc:0.91618 total_loss: 0.472  loss:0.17411,stance loss: 0.083128 
Train step: 3050 acc:0.91632 total_loss: 0.47321  loss:0.2022,stance loss: 0.17753 
Train step: 3060 acc:0.91645 total_loss: 0.47096  loss:0.085507,stance loss: 0.033652 
Train step: 3070 acc:0.91844 total_loss: 0.46791  loss:0.80496,stance loss: 0.73019 
Train step: 3080 acc:0.91667 total_loss: 0.46734  loss:0.12635,stance loss: 0.050995 
Train step: 3090 acc:0.91676 total_loss: 0.46589  loss:0.26269,stance loss: 0.15039 
Train step: 3100 acc:0.91576 total_loss: 0.46588  loss:0.093952,stance loss: 0.029355 
Train step: 3110 acc:0.91589 total_loss: 0.4667  loss:0.25869,stance loss: 0.2092 
Train step: 3120 acc:0.91575 total_loss: 0.46416  loss:0.23057,stance loss: 0.13807 
Train step: 3130 acc:0.9149 total_loss: 0.46536  loss:1.1452,stance loss: 1.0495 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.89583 total_loss: 0.52246  loss:0.25106,stance loss: 0.095276 
Train step: 3150 acc:0.91447 total_loss: 0.4274  loss:0.090104,stance loss: 0.022261 
Train step: 3160 acc:0.93319 total_loss: 0.3716  loss:0.14472,stance loss: 0.072868 
Train step: 3170 acc:0.9375 total_loss: 0.36356  loss:0.045716,stance loss: 0.0013358 
Train step: 3180 acc:0.94005 total_loss: 0.36548  loss:0.56666,stance loss: 0.52408 
Train step: 3190 acc:0.94703 total_loss: 0.36446  loss:0.2048,stance loss: 0.17654 
Train step: 3200 acc:0.94565 total_loss: 0.36639  loss:0.070599,stance loss: 0.0026824 
Train step: 3210 acc:0.94225 total_loss: 0.37746  loss:0.34229,stance loss: 0.3037 
Train step: 3220 acc:0.94452 total_loss: 0.36237  loss:0.15169,stance loss: 0.081023 
Train step: 3230 acc:0.94192 total_loss: 0.37907  loss:0.40136,stance loss: 0.38142 
Train step: 3240 acc:0.94094 total_loss: 0.3836  loss:0.12385,stance loss: 0.054343 
Train step: 3250 acc:0.94013 total_loss: 0.38201  loss:0.15667,stance loss: 0.063119 
Train step: 3260 acc:0.93847 total_loss: 0.38824  loss:0.6247,stance loss: 0.50815 
Train step: 3270 acc:0.9384 total_loss: 0.38422  loss:0.26304,stance loss: 0.1653 
Train step: 3280 acc:0.93708 total_loss: 0.38607  loss:0.2429,stance loss: 0.21191 
Train step: 3290 acc:0.93671 total_loss: 0.38222  loss:0.24832,stance loss: 0.16823 
Train step: 3300 acc:0.93861 total_loss: 0.37422  loss:0.092043,stance loss: 0.037079 
Train step: 3310 acc:0.9375 total_loss: 0.37615  loss:0.28356,stance loss: 0.20149 
Train step: 3320 acc:0.93783 total_loss: 0.37357  loss:0.15747,stance loss: 0.14378 
Train step: 3330 acc:0.93844 total_loss: 0.36534  loss:0.61956,stance loss: 0.50563 
Train step: 3340 acc:0.9381 total_loss: 0.3684  loss:0.65474,stance loss: 0.64354 
Train step: 3350 acc:0.93807 total_loss: 0.36905  loss:0.18152,stance loss: 0.075747 
Train step: 3360 acc:0.93886 total_loss: 0.36694  loss:0.36427,stance loss: 0.279 
Train step: 3370 acc:0.93881 total_loss: 0.36312  loss:0.14614,stance loss: 0.083485 
Train step: 3380 acc:0.93825 total_loss: 0.36182  loss:0.30577,stance loss: 0.24443 
Train step: 3390 acc:0.93774 total_loss: 0.36518  loss:0.13106,stance loss: 0.1052 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.92969 total_loss: 0.30563  loss:0.47551,stance loss: 0.37982 
Train step: 3410 acc:0.95833 total_loss: 0.27175  loss:0.056977,stance loss: 0.020115 
Train step: 3420 acc:0.95982 total_loss: 0.30919  loss:0.42047,stance loss: 0.34233 
Train step: 3430 acc:0.96053 total_loss: 0.29492  loss:0.12897,stance loss: 0.065702 
Train step: 3440 acc:0.95833 total_loss: 0.3032  loss:0.3643,stance loss: 0.24869 
Train step: 3450 acc:0.95582 total_loss: 0.30811  loss:0.4233,stance loss: 0.36153 
Train step: 3460 acc:0.95404 total_loss: 0.31019  loss:0.053989,stance loss: 0.00094708 
Train step: 3470 acc:0.95433 total_loss: 0.33584  loss:0.6108,stance loss: 1.0644 
Train step: 3480 acc:0.9517 total_loss: 0.34133  loss:0.61135,stance loss: 1.0658 
Train step: 3490 acc:0.95026 total_loss: 0.34123  loss:0.45944,stance loss: 0.38168 
Train step: 3500 acc:0.94792 total_loss: 0.33358  loss:0.078268,stance loss: 0.047067 
Train step: 3510 acc:0.94544 total_loss: 0.33187  loss:0.063859,stance loss: 0.020602 
Train step: 3520 acc:0.94531 total_loss: 0.32954  loss:0.25701,stance loss: 0.23635 
Train step: 3530 acc:0.94611 total_loss: 0.32675  loss:0.046491,stance loss: 0.0094199 
Train step: 3540 acc:0.94806 total_loss: 0.32693  loss:0.54237,stance loss: 1.011 
Train step: 3550 acc:0.94858 total_loss: 0.32725  loss:0.61068,stance loss: 1.0481 
Train step: 3560 acc:0.94903 total_loss: 0.32934  loss:0.30761,stance loss: 0.23024 
Train step: 3570 acc:0.95084 total_loss: 0.32999  loss:0.35503,stance loss: 0.35117 
Train step: 3580 acc:0.9508 total_loss: 0.32736  loss:0.10782,stance loss: 0.045318 
Train step: 3590 acc:0.9517 total_loss: 0.32627  loss:0.29615,stance loss: 0.25498 
Train step: 3600 acc:0.95192 total_loss: 0.32997  loss:0.87127,stance loss: 1.3073 
Train step: 3610 acc:0.95183 total_loss: 0.33048  loss:0.21636,stance loss: 0.24685 
Train step: 3620 acc:0.95258 total_loss: 0.32429  loss:0.10612,stance loss: 0.060165 
Train step: 3630 acc:0.95168 total_loss: 0.32807  loss:0.34033,stance loss: 0.28732 
Train step: 3640 acc:0.95237 total_loss: 0.32397  loss:0.14092,stance loss: 0.15385 
Train step: 3650 acc:0.95228 total_loss: 0.32493  loss:0.20924,stance loss: 0.17118 
Better F1! Saving model!
Saving model of best f1: 0.488043089576256
              precision    recall  f1-score   support

           0   0.466000  0.779264  0.583229       299
           1   0.664122  0.334615  0.445013       260
           2   0.578947  0.297297  0.392857       148

    accuracy                       0.514851       707
   macro avg   0.569690  0.470392  0.473700       707
weighted avg   0.562503  0.514851  0.492548       707

Test Acc: 0.5148514851485149 F1_ma:0.488043089576256
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.94643 total_loss: 0.31755  loss:0.3274,stance loss: 0.33843 
Train step: 3670 acc:0.96324 total_loss: 0.23529  loss:0.20962,stance loss: 0.16855 
Train step: 3680 acc:0.96991 total_loss: 0.227  loss:0.043542,stance loss: 0.015699 
Train step: 3690 acc:0.96791 total_loss: 0.28572  loss:0.09574,stance loss: 0.046777 
Train step: 3700 acc:0.97207 total_loss: 0.26437  loss:0.16536,stance loss: 0.12121 
Train step: 3710 acc:0.9693 total_loss: 0.27452  loss:0.071926,stance loss: 0.033677 
Train step: 3720 acc:0.96642 total_loss: 0.27451  loss:0.055134,stance loss: 0.031983 
Train step: 3730 acc:0.96672 total_loss: 0.26549  loss:0.49797,stance loss: 0.40546 
Train step: 3740 acc:0.96336 total_loss: 0.27448  loss:0.08889,stance loss: 0.018259 
Train step: 3750 acc:0.96134 total_loss: 0.27169  loss:0.25895,stance loss: 0.21758 
Train step: 3760 acc:0.96262 total_loss: 0.2677  loss:0.11504,stance loss: 0.084889 
Train step: 3770 acc:0.96474 total_loss: 0.26366  loss:0.62737,stance loss: 1.062 
Train step: 3780 acc:0.96309 total_loss: 0.27756  loss:0.073961,stance loss: 0.014593 
Train step: 3790 acc:0.96442 total_loss: 0.27199  loss:0.028451,stance loss: 0.0023159 
Train step: 3800 acc:0.96599 total_loss: 0.26632  loss:0.54008,stance loss: 1.0166 
Train step: 3810 acc:0.96457 total_loss: 0.26972  loss:0.64677,stance loss: 1.0133 
Train step: 3820 acc:0.96482 total_loss: 0.26536  loss:0.30595,stance loss: 0.24799 
Train step: 3830 acc:0.96469 total_loss: 0.26992  loss:0.31399,stance loss: 0.18745 
Train step: 3840 acc:0.96424 total_loss: 0.27318  loss:0.18131,stance loss: 0.037469 
Train step: 3850 acc:0.96415 total_loss: 0.27075  loss:0.062798,stance loss: 0.030025 
Train step: 3860 acc:0.96437 total_loss: 0.26958  loss:0.12903,stance loss: 0.062182 
Train step: 3870 acc:0.96486 total_loss: 0.26713  loss:0.57209,stance loss: 0.60627 
Train step: 3880 acc:0.96476 total_loss: 0.26341  loss:0.10516,stance loss: 0.085841 
Train step: 3890 acc:0.96493 total_loss: 0.26163  loss:0.074277,stance loss: 0.019593 
Train step: 3900 acc:0.96483 total_loss: 0.26028  loss:0.17214,stance loss: 0.16581 
Train step: 3910 acc:0.96498 total_loss: 0.25813  loss:0.27963,stance loss: 0.19456 
Training finished.


Reload the best model with best f1 0.488043089576256 from path test_outputs/bert-cross-topic/dt/2023-08-14 16-05-19/state_dict


              precision    recall  f1-score   support

           0   0.466000  0.779264  0.583229       299
           1   0.664122  0.334615  0.445013       260
           2   0.578947  0.297297  0.392857       148

    accuracy                       0.514851       707
   macro avg   0.569690  0.470392  0.473700       707
weighted avg   0.562503  0.514851  0.492548       707

Test Acc: 0.5148514851485149 F1_ma:0.488043089576256
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.488043089576256
acc: 0.5148514851485149, f1 :0.4736996556254323
classification report: 
              precision    recall  f1-score   support

         Con     0.4660    0.7793    0.5832       299
        None     0.6641    0.3346    0.4450       260
         Pro     0.5789    0.2973    0.3929       148

    accuracy                         0.5149       707
   macro avg     0.5697    0.4704    0.4737       707
weighted avg     0.5625    0.5149    0.4925       707

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='dt', dataset_files={'train': './datasets/o_dt', 'test': './datasets/dt'}, dev_dir='./datasets/dt', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/dt/2023-08-14 16-23-56', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/dt', train_dir='./datasets/o_dt', type=0)
using model:  bert-cross-topic
running dataset:  dt
output_dir:  test_outputs/bert-cross-topic/dt/2023-08-14 16-23-56
Train loader length: 261
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.5349  loss:1.5349,stance loss: 0.86465 
Train step: 10 acc:0.44318 total_loss: 1.6158  loss:1.7121,stance loss: 1.0544 
Better F1! Saving model!
Saving model of best f1: 0.2972166998011928
              precision    recall  f1-score   support

           0   0.422914  1.000000  0.594433       299
           1   0.000000  0.000000  0.000000       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.422914       707
   macro avg   0.140971  0.333333  0.198144       707
weighted avg   0.178856  0.422914  0.251394       707

Test Acc: 0.4229137199434229 F1_ma:0.2972166998011928
Train step: 20 acc:0.46726 total_loss: 1.624  loss:1.543,stance loss: 0.94533 
Train step: 30 acc:0.47984 total_loss: 1.6193  loss:1.4133,stance loss: 1.0233 
Train step: 40 acc:0.49238 total_loss: 1.6166  loss:1.7072,stance loss: 1.2846 
Train step: 50 acc:0.47917 total_loss: 1.6135  loss:1.582,stance loss: 0.92477 
Train step: 60 acc:0.48668 total_loss: 1.612  loss:1.5297,stance loss: 1.13 
Train step: 70 acc:0.49648 total_loss: 1.6016  loss:1.6943,stance loss: 1.7732 
Train step: 80 acc:0.4946 total_loss: 1.6022  loss:1.8426,stance loss: 1.8676 
Train step: 90 acc:0.4897 total_loss: 1.605  loss:1.7427,stance loss: 1.2559 
Train step: 100 acc:0.49567 total_loss: 1.5885  loss:1.5113,stance loss: 1.1638 
Train step: 110 acc:0.50113 total_loss: 1.592  loss:1.7583,stance loss: 1.711 
Train step: 120 acc:0.50258 total_loss: 1.5871  loss:1.6912,stance loss: 1.6616 
Train step: 130 acc:0.50095 total_loss: 1.5858  loss:1.467,stance loss: 0.96094 
Train step: 140 acc:0.50044 total_loss: 1.5783  loss:1.5572,stance loss: 1.1131 
Train step: 150 acc:0.50166 total_loss: 1.5713  loss:1.7191,stance loss: 1.648 
Better F1! Saving model!
Saving model of best f1: 0.2975124378109452
              precision    recall  f1-score   support

           0   0.423513  1.000000  0.595025       299
           1   1.000000  0.003846  0.007663       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.424328       707
   macro avg   0.474504  0.334615  0.200896       707
weighted avg   0.546860  0.424328  0.254462       707

Test Acc: 0.4243281471004243 F1_ma:0.2975124378109452
Train step: 160 acc:0.50543 total_loss: 1.5615  loss:1.3216,stance loss: 0.86376 
Train step: 170 acc:0.50768 total_loss: 1.5566  loss:1.6938,stance loss: 1.7309 
Train step: 180 acc:0.50656 total_loss: 1.5544  loss:1.6082,stance loss: 1.2193 
Train step: 190 acc:0.50654 total_loss: 1.5472  loss:1.2871,stance loss: 0.83005 
Train step: 200 acc:0.50964 total_loss: 1.5421  loss:1.4303,stance loss: 0.87298 
Better F1! Saving model!
Saving model of best f1: 0.29759519038076154
              precision    recall  f1-score   support

           0   0.424893  0.993311  0.595190       299
           1   0.750000  0.023077  0.044776       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.428571       707
   macro avg   0.391631  0.338796  0.213322       707
weighted avg   0.455506  0.428571  0.268181       707

Test Acc: 0.42857142857142855 F1_ma:0.29759519038076154
Train step: 210 acc:0.51185 total_loss: 1.5407  loss:1.4797,stance loss: 1.0848 
Train step: 220 acc:0.51357 total_loss: 1.5359  loss:1.4062,stance loss: 1.0533 
Train step: 230 acc:0.51623 total_loss: 1.5321  loss:1.2502,stance loss: 0.86065 
Better F1! Saving model!
Saving model of best f1: 0.29780876494023906
              precision    recall  f1-score   support

           0   0.424113  1.000000  0.595618       299
           1   1.000000  0.007692  0.015267       260
           2   0.000000  0.000000  0.000000       148

    accuracy                       0.425743       707
   macro avg   0.474704  0.335897  0.203628       707
weighted avg   0.547114  0.425743  0.257509       707

Test Acc: 0.42574257425742573 F1_ma:0.29780876494023906
Train step: 240 acc:0.51504 total_loss: 1.5296  loss:1.2164,stance loss: 0.55931 
Train step: 250 acc:0.51892 total_loss: 1.5244  loss:1.2899,stance loss: 0.93814 
Train step: 260 acc:0.52006 total_loss: 1.5201  loss:0.64955,stance loss: -1.1921e-07 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 270 acc:0.6 total_loss: 1.4352  loss:1.3679,stance loss: 1.0705 
Train step: 280 acc:0.6125 total_loss: 1.4015  loss:1.0628,stance loss: 0.5522 
Train step: 290 acc:0.61042 total_loss: 1.3837  loss:1.1688,stance loss: 0.54796 
Train step: 300 acc:0.61094 total_loss: 1.3891  loss:1.5295,stance loss: 1.6547 
Train step: 310 acc:0.605 total_loss: 1.3834  loss:1.4181,stance loss: 1.0914 
Train step: 320 acc:0.59792 total_loss: 1.3933  loss:1.4806,stance loss: 1.3996 
Train step: 330 acc:0.60179 total_loss: 1.3871  loss:1.7803,stance loss: 2.104 
Train step: 340 acc:0.59609 total_loss: 1.39  loss:1.6551,stance loss: 1.6385 
Train step: 350 acc:0.6 total_loss: 1.3847  loss:1.5929,stance loss: 1.7736 
Train step: 360 acc:0.6125 total_loss: 1.3761  loss:1.3303,stance loss: 0.93418 
Train step: 370 acc:0.61761 total_loss: 1.3781  loss:1.191,stance loss: 0.83569 
Train step: 380 acc:0.61927 total_loss: 1.3813  loss:1.4548,stance loss: 1.5272 
Train step: 390 acc:0.62308 total_loss: 1.373  loss:1.1929,stance loss: 0.93758 
Train step: 400 acc:0.62455 total_loss: 1.3738  loss:1.6786,stance loss: 1.6742 
Train step: 410 acc:0.62917 total_loss: 1.3679  loss:1.286,stance loss: 0.9963 
Train step: 420 acc:0.63398 total_loss: 1.3592  loss:1.0855,stance loss: 0.81389 
Train step: 430 acc:0.63566 total_loss: 1.3563  loss:1.3701,stance loss: 1.0663 
Train step: 440 acc:0.63715 total_loss: 1.3512  loss:1.1712,stance loss: 1.0052 
Train step: 450 acc:0.63947 total_loss: 1.3497  loss:1.0453,stance loss: 0.73955 
Train step: 460 acc:0.64031 total_loss: 1.3493  loss:1.1425,stance loss: 0.82395 
Train step: 470 acc:0.64196 total_loss: 1.3422  loss:1.3021,stance loss: 0.8576 
Train step: 480 acc:0.64318 total_loss: 1.338  loss:1.1405,stance loss: 0.86658 
Train step: 490 acc:0.64457 total_loss: 1.3403  loss:1.1309,stance loss: 0.91813 
Train step: 500 acc:0.64818 total_loss: 1.3323  loss:0.95304,stance loss: 0.61732 
Train step: 510 acc:0.65075 total_loss: 1.323  loss:1.538,stance loss: 1.1833 
Train step: 520 acc:0.65288 total_loss: 1.3193  loss:1.098,stance loss: 0.81534 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 530 acc:0.79167 total_loss: 1.0082  loss:0.85908,stance loss: 0.73926 
Train step: 540 acc:0.75329 total_loss: 1.141  loss:1.0435,stance loss: 0.7034 
Train step: 550 acc:0.74784 total_loss: 1.1408  loss:0.8074,stance loss: 0.69893 
Train step: 560 acc:0.74519 total_loss: 1.111  loss:1.2217,stance loss: 0.91125 
Train step: 570 acc:0.73342 total_loss: 1.1374  loss:1.2168,stance loss: 1.287 
Train step: 580 acc:0.73305 total_loss: 1.1247  loss:1.1286,stance loss: 0.86083 
Train step: 590 acc:0.72917 total_loss: 1.1258  loss:0.92224,stance loss: 0.62971 
Train step: 600 acc:0.72231 total_loss: 1.1403  loss:1.5729,stance loss: 1.2501 
Train step: 610 acc:0.72612 total_loss: 1.1377  loss:1.2336,stance loss: 0.99056 
Train step: 620 acc:0.72412 total_loss: 1.1386  loss:0.95042,stance loss: 0.60562 
Train step: 630 acc:0.72076 total_loss: 1.1489  loss:1.5,stance loss: 1.2656 
Train step: 640 acc:0.71849 total_loss: 1.1455  loss:0.92567,stance loss: 0.64712 
Train step: 650 acc:0.71415 total_loss: 1.1515  loss:1.0442,stance loss: 0.80809 
Train step: 660 acc:0.71403 total_loss: 1.1525  loss:1.3606,stance loss: 1.346 
Train step: 670 acc:0.70973 total_loss: 1.1597  loss:1.321,stance loss: 1.0421 
Train step: 680 acc:0.70951 total_loss: 1.168  loss:1.0527,stance loss: 0.93864 
Train step: 690 acc:0.7108 total_loss: 1.1713  loss:1.1124,stance loss: 1.0128 
Train step: 700 acc:0.7088 total_loss: 1.1725  loss:1.0854,stance loss: 0.67718 
Train step: 710 acc:0.70767 total_loss: 1.1719  loss:0.93779,stance loss: 0.59607 
Train step: 720 acc:0.70791 total_loss: 1.1723  loss:1.3364,stance loss: 1.4506 
Train step: 730 acc:0.70544 total_loss: 1.1688  loss:0.83735,stance loss: 0.72934 
Train step: 740 acc:0.7032 total_loss: 1.1713  loss:1.0976,stance loss: 0.84447 
Train step: 750 acc:0.70306 total_loss: 1.1715  loss:1.107,stance loss: 0.87351 
Train step: 760 acc:0.70371 total_loss: 1.173  loss:1.0522,stance loss: 0.92438 
Train step: 770 acc:0.70156 total_loss: 1.179  loss:1.4462,stance loss: 1.6559 
Train step: 780 acc:0.70101 total_loss: 1.1779  loss:1.0227,stance loss: 0.73788 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 790 acc:0.70312 total_loss: 1.1103  loss:0.84194,stance loss: 0.6519 
Train step: 800 acc:0.73264 total_loss: 1.07  loss:1.1726,stance loss: 1.092 
Train step: 810 acc:0.74777 total_loss: 1.0605  loss:1.5899,stance loss: 1.6727 
Train step: 820 acc:0.72697 total_loss: 1.0613  loss:1.1477,stance loss: 0.86345 
Train step: 830 acc:0.73177 total_loss: 1.0638  loss:1.0438,stance loss: 0.82013 
Train step: 840 acc:0.72198 total_loss: 1.0945  loss:1.2405,stance loss: 1.0534 
Train step: 850 acc:0.72794 total_loss: 1.0808  loss:1.0293,stance loss: 0.72573 
Train step: 860 acc:0.73077 total_loss: 1.0687  loss:0.71011,stance loss: 0.50296 
Train step: 870 acc:0.73082 total_loss: 1.0574  loss:1.2323,stance loss: 0.96244 
Train step: 880 acc:0.73087 total_loss: 1.0591  loss:1.3471,stance loss: 1.5704 
Train step: 890 acc:0.72569 total_loss: 1.0659  loss:1.611,stance loss: 1.6447 
Train step: 900 acc:0.72722 total_loss: 1.0728  loss:1.1415,stance loss: 1.0034 
Train step: 910 acc:0.72754 total_loss: 1.074  loss:0.78463,stance loss: 0.63137 
Train step: 920 acc:0.72781 total_loss: 1.0727  loss:1.0293,stance loss: 0.91033 
Train step: 930 acc:0.72973 total_loss: 1.0738  loss:0.85596,stance loss: 0.75743 
Train step: 940 acc:0.73062 total_loss: 1.0729  loss:1.0171,stance loss: 0.8738 
Train step: 950 acc:0.73326 total_loss: 1.0642  loss:1.0694,stance loss: 0.93084 
Train step: 960 acc:0.73139 total_loss: 1.0709  loss:1.397,stance loss: 1.3101 
Train step: 970 acc:0.72839 total_loss: 1.0732  loss:0.89626,stance loss: 0.60273 
Train step: 980 acc:0.7279 total_loss: 1.0733  loss:1.202,stance loss: 0.96682 
Train step: 990 acc:0.72656 total_loss: 1.075  loss:1.2969,stance loss: 1.0011 
Train step: 1000 acc:0.72563 total_loss: 1.0776  loss:1.1614,stance loss: 0.8957 
Train step: 1010 acc:0.72615 total_loss: 1.0754  loss:1.1563,stance loss: 0.92176 
Train step: 1020 acc:0.72374 total_loss: 1.0775  loss:1.1525,stance loss: 0.8521 
Train step: 1030 acc:0.72354 total_loss: 1.0777  loss:1.0273,stance loss: 0.82813 
Train step: 1040 acc:0.72166 total_loss: 1.083  loss:0.91085,stance loss: 0.61625 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 1050 acc:0.73214 total_loss: 0.93663  loss:0.79617,stance loss: 0.52371 
Train step: 1060 acc:0.73897 total_loss: 0.98581  loss:1.0086,stance loss: 0.77794 
Train step: 1070 acc:0.75 total_loss: 0.99783  loss:1.4052,stance loss: 1.6683 
Train step: 1080 acc:0.76182 total_loss: 0.9824  loss:0.49,stance loss: 0.3481 
Train step: 1090 acc:0.76197 total_loss: 0.99825  loss:0.75495,stance loss: 0.61805 
Train step: 1100 acc:0.75439 total_loss: 1.0266  loss:1.379,stance loss: 1.1053 
Train step: 1110 acc:0.7528 total_loss: 1.0131  loss:0.76596,stance loss: 0.59428 
Train step: 1120 acc:0.74756 total_loss: 1.0098  loss:1.1607,stance loss: 1.0261 
Train step: 1130 acc:0.75216 total_loss: 1.0063  loss:0.88831,stance loss: 0.65626 
Train step: 1140 acc:0.75451 total_loss: 1.0006  loss:0.85204,stance loss: 0.68148 
Train step: 1150 acc:0.74708 total_loss: 1.017  loss:1.4689,stance loss: 1.1966 
Train step: 1160 acc:0.74733 total_loss: 1.0118  loss:0.8591,stance loss: 0.54777 
Train step: 1170 acc:0.75049 total_loss: 1.0142  loss:0.63778,stance loss: 0.45095 
Train step: 1180 acc:0.74635 total_loss: 1.0224  loss:0.55404,stance loss: 0.41887 
Train step: 1190 acc:0.75128 total_loss: 1.0099  loss:0.85653,stance loss: 0.69266 
Train step: 1200 acc:0.7508 total_loss: 1.0097  loss:1.2015,stance loss: 0.82234 
Train step: 1210 acc:0.7515 total_loss: 1.0157  loss:1.0165,stance loss: 0.75655 
Train step: 1220 acc:0.75071 total_loss: 1.0099  loss:1.1282,stance loss: 0.83946 
Train step: 1230 acc:0.74666 total_loss: 1.0157  loss:1.1641,stance loss: 1.5376 
Train step: 1240 acc:0.74524 total_loss: 1.0107  loss:1.1046,stance loss: 0.8151 
Train step: 1250 acc:0.74487 total_loss: 1.0119  loss:0.87404,stance loss: 0.65556 
Train step: 1260 acc:0.74568 total_loss: 1.0102  loss:0.722,stance loss: 0.57177 
Train step: 1270 acc:0.74559 total_loss: 1.0081  loss:1.0729,stance loss: 0.90594 
Train step: 1280 acc:0.74367 total_loss: 1.0133  loss:1.0437,stance loss: 0.84855 
Train step: 1290 acc:0.74418 total_loss: 1.0112  loss:0.72059,stance loss: 0.45637 
Train step: 1300 acc:0.74465 total_loss: 1.0099  loss:1.0357,stance loss: 0.86322 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1310 acc:0.8125 total_loss: 0.92179  loss:0.81684,stance loss: 0.6636 
Train step: 1320 acc:0.74219 total_loss: 0.95574  loss:0.83692,stance loss: 0.68921 
Train step: 1330 acc:0.7476 total_loss: 0.96726  loss:0.83772,stance loss: 0.67193 
Train step: 1340 acc:0.75521 total_loss: 0.95812  loss:1.3307,stance loss: 1.0202 
Train step: 1350 acc:0.77174 total_loss: 0.9147  loss:0.76181,stance loss: 0.70443 
Train step: 1360 acc:0.77455 total_loss: 0.90158  loss:0.97116,stance loss: 1.0167 
Train step: 1370 acc:0.77557 total_loss: 0.90818  loss:0.70767,stance loss: 0.39583 
Train step: 1380 acc:0.78043 total_loss: 0.90342  loss:1.1433,stance loss: 1.4307 
Train step: 1390 acc:0.77762 total_loss: 0.89691  loss:0.57998,stance loss: 0.46051 
Train step: 1400 acc:0.78451 total_loss: 0.88531  loss:0.50952,stance loss: 0.44444 
Train step: 1410 acc:0.78597 total_loss: 0.88698  loss:0.48369,stance loss: 0.36459 
Train step: 1420 acc:0.7861 total_loss: 0.88381  loss:1.1313,stance loss: 0.85467 
Train step: 1430 acc:0.78373 total_loss: 0.88411  loss:0.64635,stance loss: 0.49026 
Train step: 1440 acc:0.78079 total_loss: 0.89006  loss:0.92799,stance loss: 0.76473 
Train step: 1450 acc:0.77783 total_loss: 0.89061  loss:1.5557,stance loss: 1.2992 
Train step: 1460 acc:0.77564 total_loss: 0.8947  loss:0.89072,stance loss: 0.79339 
Train step: 1470 acc:0.77523 total_loss: 0.89313  loss:0.48347,stance loss: 0.35372 
Train step: 1480 acc:0.7706 total_loss: 0.89945  loss:0.8103,stance loss: 0.56118 
Train step: 1490 acc:0.77016 total_loss: 0.90296  loss:0.866,stance loss: 1.1806 
Train step: 1500 acc:0.77168 total_loss: 0.90123  loss:0.60504,stance loss: 0.50631 
Train step: 1510 acc:0.77154 total_loss: 0.89985  loss:0.9351,stance loss: 0.72249 
Train step: 1520 acc:0.77402 total_loss: 0.8947  loss:1.2185,stance loss: 1.4894 
Train step: 1530 acc:0.77461 total_loss: 0.88729  loss:0.41349,stance loss: 0.28721 
Train step: 1540 acc:0.7741 total_loss: 0.88165  loss:0.6307,stance loss: 0.40699 
Train step: 1550 acc:0.77566 total_loss: 0.88049  loss:1.5623,stance loss: 1.1213 
Train step: 1560 acc:0.77563 total_loss: 0.87782  loss:0.81303,stance loss: 0.52823 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1570 acc:0.9125 total_loss: 0.51405  loss:0.49742,stance loss: 0.3937 
Train step: 1580 acc:0.84167 total_loss: 0.71714  loss:0.63985,stance loss: 0.51587 
Train step: 1590 acc:0.8225 total_loss: 0.74836  loss:0.76541,stance loss: 0.54816 
Train step: 1600 acc:0.82857 total_loss: 0.7138  loss:1.1256,stance loss: 0.88886 
Train step: 1610 acc:0.83333 total_loss: 0.70423  loss:0.41371,stance loss: 0.2988 
Train step: 1620 acc:0.83409 total_loss: 0.70999  loss:0.48305,stance loss: 0.40397 
Train step: 1630 acc:0.82404 total_loss: 0.71503  loss:0.7603,stance loss: 0.61171 
Train step: 1640 acc:0.81833 total_loss: 0.73656  loss:0.81417,stance loss: 0.65184 
Train step: 1650 acc:0.81618 total_loss: 0.75021  loss:0.8719,stance loss: 0.64163 
Train step: 1660 acc:0.81513 total_loss: 0.76138  loss:0.94674,stance loss: 0.71281 
Train step: 1670 acc:0.81131 total_loss: 0.76891  loss:1.1956,stance loss: 1.0964 
Train step: 1680 acc:0.80761 total_loss: 0.77494  loss:0.57144,stance loss: 0.41502 
Better F1! Saving model!
Saving model of best f1: 0.31260338853192643
              precision    recall  f1-score   support

           0   0.465854  0.638796  0.538787       299
           1   0.551237  0.600000  0.574586       260
           2   0.500000  0.047297  0.086420       148

    accuracy                       0.500707       707
   macro avg   0.505697  0.428698  0.399931       707
weighted avg   0.504401  0.500707  0.457256       707

Test Acc: 0.5007072135785007 F1_ma:0.31260338853192643
Train step: 1690 acc:0.802 total_loss: 0.78583  loss:1.3716,stance loss: 1.0654 
Better F1! Saving model!
Saving model of best f1: 0.3268445759771405
              precision    recall  f1-score   support

           0   0.466507  0.652174  0.543933       299
           1   0.553114  0.580769  0.566604       260
           2   0.562500  0.060811  0.109756       148

    accuracy                       0.502122       707
   macro avg   0.527374  0.431251  0.406764       707
weighted avg   0.518451  0.502122  0.461382       707

Test Acc: 0.5021216407355021 F1_ma:0.3268445759771405
Train step: 1700 acc:0.8037 total_loss: 0.78578  loss:0.81159,stance loss: 0.73667 
Train step: 1710 acc:0.80259 total_loss: 0.77963  loss:0.84721,stance loss: 0.71402 
Better F1! Saving model!
Saving model of best f1: 0.3979671740900833
              precision    recall  f1-score   support

           0   0.470948  0.515050  0.492013       299
           1   0.533951  0.665385  0.592466       260
           2   0.553571  0.209459  0.303922       148

    accuracy                       0.506365       707
   macro avg   0.519490  0.463298  0.462800       707
weighted avg   0.511413  0.506365  0.489580       707

Test Acc: 0.5063649222065064 F1_ma:0.3979671740900833
Train step: 1720 acc:0.8004 total_loss: 0.78279  loss:0.63297,stance loss: 0.54488 
Better F1! Saving model!
Saving model of best f1: 0.43918569582076694
              precision    recall  f1-score   support

           0   0.473684  0.571906  0.518182       299
           1   0.540636  0.588462  0.563536       260
           2   0.603175  0.256757  0.360190       148

    accuracy                       0.512023       707
   macro avg   0.539165  0.472375  0.480636       707
weighted avg   0.525413  0.512023  0.501787       707

Test Acc: 0.512022630834512 F1_ma:0.43918569582076694
Train step: 1730 acc:0.80076 total_loss: 0.7853  loss:1.2741,stance loss: 1.4741 
Train step: 1740 acc:0.80036 total_loss: 0.79381  loss:1.2599,stance loss: 1.1455 
Train step: 1750 acc:0.80439 total_loss: 0.78804  loss:0.55841,stance loss: 0.39529 
Train step: 1760 acc:0.80417 total_loss: 0.78868  loss:0.77396,stance loss: 0.62118 
Train step: 1770 acc:0.80488 total_loss: 0.7894  loss:0.31158,stance loss: 0.24049 
Train step: 1780 acc:0.80552 total_loss: 0.78817  loss:0.49373,stance loss: 0.38616 
Train step: 1790 acc:0.80389 total_loss: 0.79088  loss:1.2312,stance loss: 1.0493 
Train step: 1800 acc:0.80399 total_loss: 0.79275  loss:0.88813,stance loss: 0.91401 
Train step: 1810 acc:0.80383 total_loss: 0.79335  loss:0.52944,stance loss: 0.44112 
Train step: 1820 acc:0.80392 total_loss: 0.79603  loss:0.60055,stance loss: 0.45902 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1830 acc:0.79688 total_loss: 0.89761  loss:1.0553,stance loss: 0.99828 
Train step: 1840 acc:0.80357 total_loss: 0.76679  loss:0.61107,stance loss: 0.42061 
Train step: 1850 acc:0.83854 total_loss: 0.70014  loss:0.92916,stance loss: 1.0746 
Train step: 1860 acc:0.84007 total_loss: 0.65848  loss:0.74164,stance loss: 0.54791 
Train step: 1870 acc:0.83523 total_loss: 0.66055  loss:0.61643,stance loss: 0.55383 
Train step: 1880 acc:0.84606 total_loss: 0.64242  loss:0.73853,stance loss: 1.1046 
Train step: 1890 acc:0.83691 total_loss: 0.66337  loss:0.4239,stance loss: 0.32149 
Train step: 1900 acc:0.83446 total_loss: 0.67143  loss:0.40435,stance loss: 0.32655 
Train step: 1910 acc:0.84003 total_loss: 0.66996  loss:0.64337,stance loss: 0.53759 
Train step: 1920 acc:0.83511 total_loss: 0.68239  loss:0.90317,stance loss: 0.72838 
Train step: 1930 acc:0.83774 total_loss: 0.69327  loss:0.99699,stance loss: 0.95053 
Train step: 1940 acc:0.83772 total_loss: 0.69509  loss:0.60552,stance loss: 0.49879 
Train step: 1950 acc:0.83619 total_loss: 0.68955  loss:0.25916,stance loss: 0.13002 
Train step: 1960 acc:0.83396 total_loss: 0.69667  loss:1.1521,stance loss: 1.4413 
Train step: 1970 acc:0.8329 total_loss: 0.69172  loss:0.7317,stance loss: 1.036 
Train step: 1980 acc:0.8336 total_loss: 0.69848  loss:0.72124,stance loss: 0.57873 
Train step: 1990 acc:0.83727 total_loss: 0.68814  loss:0.54805,stance loss: 0.49944 
Train step: 2000 acc:0.83872 total_loss: 0.68485  loss:0.14346,stance loss: 0.078551 
Train step: 2010 acc:0.83899 total_loss: 0.68374  loss:0.82034,stance loss: 0.49988 
Train step: 2020 acc:0.83924 total_loss: 0.68069  loss:0.94288,stance loss: 0.75473 
Train step: 2030 acc:0.83824 total_loss: 0.68277  loss:1.0083,stance loss: 0.81119 
Train step: 2040 acc:0.83849 total_loss: 0.67886  loss:0.82591,stance loss: 0.70991 
Train step: 2050 acc:0.83929 total_loss: 0.68876  loss:0.60855,stance loss: 0.56722 
Train step: 2060 acc:0.84081 total_loss: 0.68657  loss:0.9408,stance loss: 1.2855 
Train step: 2070 acc:0.84247 total_loss: 0.68302  loss:1.1428,stance loss: 0.90466 
Train step: 2080 acc:0.84006 total_loss: 0.6858  loss:1.3766,stance loss: 1.6204 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 2090 acc:0.79167 total_loss: 0.56339  loss:0.68381,stance loss: 0.58377 
Train step: 2100 acc:0.82212 total_loss: 0.60865  loss:1.1893,stance loss: 0.70848 
Train step: 2110 acc:0.85054 total_loss: 0.62825  loss:0.80033,stance loss: 0.6338 
Train step: 2120 acc:0.85417 total_loss: 0.63856  loss:1.0092,stance loss: 0.95434 
Train step: 2130 acc:0.85901 total_loss: 0.6202  loss:0.31904,stance loss: 0.27907 
Train step: 2140 acc:0.85849 total_loss: 0.62384  loss:0.5948,stance loss: 0.45499 
Train step: 2150 acc:0.86012 total_loss: 0.62869  loss:0.73581,stance loss: 0.50812 
Train step: 2160 acc:0.86473 total_loss: 0.624  loss:0.27086,stance loss: 0.23385 
Train step: 2170 acc:0.86446 total_loss: 0.62861  loss:1.1001,stance loss: 1.4681 
Train step: 2180 acc:0.8582 total_loss: 0.64144  loss:0.71551,stance loss: 0.69588 
Better F1! Saving model!
Saving model of best f1: 0.4551661881587967
              precision    recall  f1-score   support

           0   0.474654  0.688963  0.562074       299
           1   0.572727  0.484615  0.525000       260
           2   0.660377  0.236486  0.348259       148

    accuracy                       0.519095       707
   macro avg   0.569253  0.470022  0.478444       707
weighted avg   0.549599  0.519095  0.503681       707

Test Acc: 0.5190947666195191 F1_ma:0.4551661881587967
Train step: 2190 acc:0.85558 total_loss: 0.64435  loss:0.42041,stance loss: 0.3314 
Train step: 2200 acc:0.85619 total_loss: 0.65167  loss:0.35184,stance loss: 0.22517 
Train step: 2210 acc:0.85976 total_loss: 0.64367  loss:0.67516,stance loss: 1.0679 
Train step: 2220 acc:0.85949 total_loss: 0.64168  loss:0.71117,stance loss: 0.56658 
Train step: 2230 acc:0.86014 total_loss: 0.63478  loss:0.59999,stance loss: 0.51064 
Train step: 2240 acc:0.8607 total_loss: 0.63433  loss:0.55521,stance loss: 0.43461 
Train step: 2250 acc:0.86503 total_loss: 0.62712  loss:0.37936,stance loss: 0.25307 
Train step: 2260 acc:0.86669 total_loss: 0.61745  loss:0.5108,stance loss: 0.51431 
Train step: 2270 acc:0.86407 total_loss: 0.62599  loss:0.47434,stance loss: 0.36366 
Train step: 2280 acc:0.86464 total_loss: 0.62023  loss:0.51569,stance loss: 0.41881 
Train step: 2290 acc:0.86361 total_loss: 0.62035  loss:0.44504,stance loss: 0.34912 
Train step: 2300 acc:0.86326 total_loss: 0.61964  loss:1.1228,stance loss: 1.4203 
Train step: 2310 acc:0.86267 total_loss: 0.62448  loss:1.3949,stance loss: 1.7017 
Train step: 2320 acc:0.86373 total_loss: 0.62051  loss:0.24503,stance loss: 0.15475 
Train step: 2330 acc:0.86214 total_loss: 0.62137  loss:0.69657,stance loss: 0.50835 
Train step: 2340 acc:0.86166 total_loss: 0.62353  loss:1.0539,stance loss: 1.4543 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2350 acc:0.84375 total_loss: 0.54315  loss:0.66951,stance loss: 0.43632 
Train step: 2360 acc:0.90104 total_loss: 0.45756  loss:0.58382,stance loss: 0.61211 
Train step: 2370 acc:0.89773 total_loss: 0.48452  loss:0.17743,stance loss: 0.075533 
Train step: 2380 acc:0.89648 total_loss: 0.46865  loss:0.29949,stance loss: 0.2499 
Train step: 2390 acc:0.90476 total_loss: 0.44955  loss:0.079213,stance loss: 0.00056253 
Train step: 2400 acc:0.90024 total_loss: 0.4397  loss:0.31333,stance loss: 0.21996 
Train step: 2410 acc:0.90121 total_loss: 0.43413  loss:0.59318,stance loss: 0.44648 
Train step: 2420 acc:0.90104 total_loss: 0.44489  loss:0.46459,stance loss: 0.32355 
Train step: 2430 acc:0.89634 total_loss: 0.45836  loss:0.65364,stance loss: 0.5332 
Train step: 2440 acc:0.89402 total_loss: 0.47092  loss:0.59871,stance loss: 0.51705 
Train step: 2450 acc:0.89461 total_loss: 0.48216  loss:0.32972,stance loss: 0.27642 
Train step: 2460 acc:0.89342 total_loss: 0.4878  loss:0.18082,stance loss: 0.086911 
Train step: 2470 acc:0.89088 total_loss: 0.48895  loss:0.28246,stance loss: 0.19136 
Train step: 2480 acc:0.89062 total_loss: 0.48922  loss:0.32011,stance loss: 0.28245 
Train step: 2490 acc:0.8882 total_loss: 0.49364  loss:0.46658,stance loss: 0.3528 
Train step: 2500 acc:0.89062 total_loss: 0.48667  loss:1.0187,stance loss: 1.3246 
Train step: 2510 acc:0.89082 total_loss: 0.49636  loss:0.36605,stance loss: 0.1869 
Train step: 2520 acc:0.89026 total_loss: 0.49284  loss:0.85277,stance loss: 0.69488 
Train step: 2530 acc:0.89148 total_loss: 0.49919  loss:1.0752,stance loss: 1.0359 
Train step: 2540 acc:0.89355 total_loss: 0.49774  loss:0.63571,stance loss: 1.0512 
Train step: 2550 acc:0.89511 total_loss: 0.50143  loss:0.31025,stance loss: 0.26277 
Train step: 2560 acc:0.89623 total_loss: 0.498  loss:0.59124,stance loss: 0.50432 
Train step: 2570 acc:0.89386 total_loss: 0.50386  loss:0.42178,stance loss: 0.36688 
Train step: 2580 acc:0.89278 total_loss: 0.50785  loss:0.36943,stance loss: 0.33387 
Train step: 2590 acc:0.8923 total_loss: 0.50743  loss:0.48545,stance loss: 0.34113 
Train step: 2600 acc:0.89311 total_loss: 0.50337  loss:0.21409,stance loss: 0.13969 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2610 acc:1.0 total_loss: 0.24164  loss:0.24164,stance loss: 0.15144 
Train step: 2620 acc:0.9375 total_loss: 0.42412  loss:1.382,stance loss: 1.6781 
Train step: 2630 acc:0.89881 total_loss: 0.49918  loss:0.43397,stance loss: 0.23482 
Train step: 2640 acc:0.89315 total_loss: 0.49576  loss:0.67752,stance loss: 0.51829 
Train step: 2650 acc:0.89482 total_loss: 0.47364  loss:0.29793,stance loss: 0.16823 
Train step: 2660 acc:0.89951 total_loss: 0.48442  loss:0.67851,stance loss: 1.0932 
Train step: 2670 acc:0.89652 total_loss: 0.47847  loss:0.44758,stance loss: 0.39142 
Train step: 2680 acc:0.89437 total_loss: 0.48348  loss:0.60883,stance loss: 0.50492 
Train step: 2690 acc:0.90201 total_loss: 0.45489  loss:0.28189,stance loss: 0.15909 
Train step: 2700 acc:0.90385 total_loss: 0.46068  loss:0.32936,stance loss: 0.28502 
Train step: 2710 acc:0.90223 total_loss: 0.45518  loss:0.066828,stance loss: 0.019667 
Train step: 2720 acc:0.90709 total_loss: 0.4531  loss:0.19028,stance loss: 0.10562 
Train step: 2730 acc:0.90754 total_loss: 0.44927  loss:0.54614,stance loss: 0.41269 
Train step: 2740 acc:0.90697 total_loss: 0.45776  loss:0.55371,stance loss: 0.47407 
Train step: 2750 acc:0.90736 total_loss: 0.45446  loss:0.46046,stance loss: 0.2335 
Train step: 2760 acc:0.90728 total_loss: 0.45598  loss:0.14751,stance loss: 0.081772 
Train step: 2770 acc:0.90955 total_loss: 0.45286  loss:0.22301,stance loss: 0.17543 
Train step: 2780 acc:0.90753 total_loss: 0.45566  loss:0.30522,stance loss: 0.12008 
Train step: 2790 acc:0.9078 total_loss: 0.45187  loss:0.60125,stance loss: 0.39332 
Train step: 2800 acc:0.9087 total_loss: 0.44783  loss:0.44351,stance loss: 0.2655 
Train step: 2810 acc:0.90858 total_loss: 0.44241  loss:0.36473,stance loss: 0.26106 
Train step: 2820 acc:0.90758 total_loss: 0.44519  loss:0.36342,stance loss: 0.27808 
Train step: 2830 acc:0.90724 total_loss: 0.44612  loss:0.46659,stance loss: 0.33348 
Train step: 2840 acc:0.90611 total_loss: 0.4511  loss:0.68817,stance loss: 0.63794 
Train step: 2850 acc:0.90612 total_loss: 0.45701  loss:0.96023,stance loss: 1.3052 
Train step: 2860 acc:0.90712 total_loss: 0.45127  loss:0.35837,stance loss: 0.26395 
Train step: 2870 acc:0.90656 total_loss: 0.45371  loss:2.7104,stance loss: 5.3727 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2880 acc:0.9375 total_loss: 0.34945  loss:0.18515,stance loss: 0.098745 
Train step: 2890 acc:0.9625 total_loss: 0.27645  loss:0.27314,stance loss: 0.2347 
Train step: 2900 acc:0.94583 total_loss: 0.34025  loss:0.94984,stance loss: 1.3463 
Train step: 2910 acc:0.94531 total_loss: 0.36979  loss:0.31483,stance loss: 0.37187 
Train step: 2920 acc:0.94125 total_loss: 0.3654  loss:0.12125,stance loss: 0.020932 
Train step: 2930 acc:0.93646 total_loss: 0.37487  loss:0.18903,stance loss: 0.065506 
Train step: 2940 acc:0.93661 total_loss: 0.39459  loss:0.093303,stance loss: 0.016416 
Train step: 2950 acc:0.93906 total_loss: 0.39104  loss:0.66739,stance loss: 1.0259 
Train step: 2960 acc:0.9375 total_loss: 0.39131  loss:0.39811,stance loss: 0.34226 
Train step: 2970 acc:0.93375 total_loss: 0.38846  loss:0.46695,stance loss: 0.3754 
Train step: 2980 acc:0.93466 total_loss: 0.38818  loss:0.094921,stance loss: 0.053771 
Train step: 2990 acc:0.93385 total_loss: 0.38619  loss:0.084906,stance loss: 0.0072795 
Train step: 3000 acc:0.93365 total_loss: 0.37857  loss:0.40345,stance loss: 0.39282 
Train step: 3010 acc:0.93393 total_loss: 0.37779  loss:1.0843,stance loss: 1.1801 
Train step: 3020 acc:0.93333 total_loss: 0.3778  loss:0.11538,stance loss: 0.057664 
Train step: 3030 acc:0.93516 total_loss: 0.3773  loss:0.38599,stance loss: 0.36084 
Train step: 3040 acc:0.93713 total_loss: 0.37356  loss:0.23306,stance loss: 0.17227 
Train step: 3050 acc:0.93542 total_loss: 0.37512  loss:0.42154,stance loss: 0.27855 
Train step: 3060 acc:0.93586 total_loss: 0.37237  loss:0.20198,stance loss: 0.12939 
Train step: 3070 acc:0.93594 total_loss: 0.37366  loss:0.34756,stance loss: 0.2929 
Train step: 3080 acc:0.93661 total_loss: 0.36946  loss:0.10454,stance loss: 0.039611 
Train step: 3090 acc:0.93494 total_loss: 0.37174  loss:0.70447,stance loss: 0.63818 
Train step: 3100 acc:0.93533 total_loss: 0.37128  loss:0.23544,stance loss: 0.14936 
Train step: 3110 acc:0.93411 total_loss: 0.37595  loss:0.7134,stance loss: 0.7964 
Train step: 3120 acc:0.9325 total_loss: 0.37835  loss:0.16333,stance loss: 0.087902 
Train step: 3130 acc:0.93269 total_loss: 0.37504  loss:0.23166,stance loss: 0.17478 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 3140 acc:0.95139 total_loss: 0.34048  loss:0.39166,stance loss: 0.33977 
Train step: 3150 acc:0.94737 total_loss: 0.33671  loss:0.53182,stance loss: 0.43243 
Better F1! Saving model!
Saving model of best f1: 0.4992145754200734
              precision    recall  f1-score   support

           0   0.504478  0.565217  0.533123       299
           1   0.563636  0.596154  0.579439       260
           2   0.587629  0.385135  0.465306       148

    accuracy                       0.538897       707
   macro avg   0.551914  0.515502  0.525956       707
weighted avg   0.543640  0.538897  0.535959       707

Test Acc: 0.5388967468175389 F1_ma:0.4992145754200734
Train step: 3160 acc:0.95259 total_loss: 0.33971  loss:0.10607,stance loss: 0.037304 
Train step: 3170 acc:0.95032 total_loss: 0.34579  loss:0.27692,stance loss: 0.24814 
Train step: 3180 acc:0.95281 total_loss: 0.33632  loss:0.21722,stance loss: 0.10913 
Train step: 3190 acc:0.95339 total_loss: 0.31773  loss:0.63583,stance loss: 0.49813 
Train step: 3200 acc:0.95562 total_loss: 0.30223  loss:0.11896,stance loss: 0.035862 
Train step: 3210 acc:0.95332 total_loss: 0.30001  loss:0.42318,stance loss: 0.39338 
Train step: 3220 acc:0.95576 total_loss: 0.29688  loss:0.78703,stance loss: 1.1757 
Train step: 3230 acc:0.95455 total_loss: 0.29854  loss:0.17806,stance loss: 0.1199 
Train step: 3240 acc:0.95585 total_loss: 0.29005  loss:0.18878,stance loss: 0.14013 
Train step: 3250 acc:0.95693 total_loss: 0.28459  loss:0.95064,stance loss: 1.3365 
Train step: 3260 acc:0.95155 total_loss: 0.29556  loss:0.58073,stance loss: 0.34507 
Train step: 3270 acc:0.94919 total_loss: 0.29602  loss:0.35653,stance loss: 0.24233 
Train step: 3280 acc:0.94757 total_loss: 0.30271  loss:0.39738,stance loss: 0.37505 
Train step: 3290 acc:0.94615 total_loss: 0.30076  loss:0.80534,stance loss: 0.95578 
Train step: 3300 acc:0.94822 total_loss: 0.2996  loss:0.088396,stance loss: 0.014912 
Train step: 3310 acc:0.94867 total_loss: 0.30174  loss:0.15417,stance loss: 0.062871 
Train step: 3320 acc:0.94808 total_loss: 0.30769  loss:0.65885,stance loss: 0.58378 
Train step: 3330 acc:0.94661 total_loss: 0.3095  loss:0.37434,stance loss: 0.4352 
Train step: 3340 acc:0.94557 total_loss: 0.312  loss:0.20625,stance loss: 0.16931 
Train step: 3350 acc:0.94378 total_loss: 0.32349  loss:0.878,stance loss: 1.2663 
Train step: 3360 acc:0.94514 total_loss: 0.31999  loss:0.65086,stance loss: 1.1147 
Train step: 3370 acc:0.94535 total_loss: 0.31687  loss:0.51263,stance loss: 0.4665 
Train step: 3380 acc:0.94428 total_loss: 0.32021  loss:0.66853,stance loss: 0.52136 
Train step: 3390 acc:0.94474 total_loss: 0.31809  loss:0.38562,stance loss: 0.27607 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3400 acc:0.97656 total_loss: 0.30734  loss:0.090091,stance loss: 0.033744 
Train step: 3410 acc:0.96875 total_loss: 0.36144  loss:0.67634,stance loss: 1.1078 
Train step: 3420 acc:0.96429 total_loss: 0.31276  loss:0.6086,stance loss: 0.52755 
Train step: 3430 acc:0.96711 total_loss: 0.27968  loss:0.12522,stance loss: 0.086684 
Train step: 3440 acc:0.96745 total_loss: 0.2722  loss:0.25902,stance loss: 0.24428 
Train step: 3450 acc:0.96444 total_loss: 0.27323  loss:0.51033,stance loss: 0.43736 
Train step: 3460 acc:0.96232 total_loss: 0.27227  loss:0.028399,stance loss: 0.0018365 
Train step: 3470 acc:0.96074 total_loss: 0.28011  loss:0.59348,stance loss: 0.37361 
Train step: 3480 acc:0.95952 total_loss: 0.28384  loss:0.30843,stance loss: 0.19354 
Train step: 3490 acc:0.95727 total_loss: 0.29765  loss:0.46341,stance loss: 0.49706 
Train step: 3500 acc:0.95544 total_loss: 0.30523  loss:0.33755,stance loss: 0.34307 
Train step: 3510 acc:0.95551 total_loss: 0.29856  loss:0.6451,stance loss: 1.0907 
Train step: 3520 acc:0.95508 total_loss: 0.29157  loss:0.049249,stance loss: 0.020329 
Train step: 3530 acc:0.95562 total_loss: 0.28652  loss:0.47494,stance loss: 0.32858 
Train step: 3540 acc:0.95735 total_loss: 0.2768  loss:0.14172,stance loss: 0.10156 
Train step: 3550 acc:0.95807 total_loss: 0.27165  loss:0.4196,stance loss: 0.40557 
Train step: 3560 acc:0.95908 total_loss: 0.26593  loss:0.05691,stance loss: 0.012629 
Train step: 3570 acc:0.95962 total_loss: 0.26676  loss:0.58575,stance loss: 0.51164 
Train step: 3580 acc:0.95977 total_loss: 0.27064  loss:0.23596,stance loss: 0.041035 
Train step: 3590 acc:0.96086 total_loss: 0.26486  loss:0.58142,stance loss: 1.034 
Train step: 3600 acc:0.96064 total_loss: 0.26515  loss:0.68221,stance loss: 1.0594 
Train step: 3610 acc:0.96158 total_loss: 0.2593  loss:0.11152,stance loss: 0.067607 
Train step: 3620 acc:0.96245 total_loss: 0.26243  loss:0.78705,stance loss: 1.0551 
Train step: 3630 acc:0.96245 total_loss: 0.25906  loss:0.14951,stance loss: 0.087772 
Train step: 3640 acc:0.96245 total_loss: 0.25539  loss:0.059371,stance loss: 0.014455 
Train step: 3650 acc:0.96245 total_loss: 0.25515  loss:0.1526,stance loss: 0.03732 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3660 acc:0.95536 total_loss: 0.38214  loss:0.21315,stance loss: 0.24708 
Train step: 3670 acc:0.97794 total_loss: 0.24761  loss:0.084742,stance loss: 0.051328 
Train step: 3680 acc:0.96759 total_loss: 0.28138  loss:0.072706,stance loss: 0.034707 
Train step: 3690 acc:0.96959 total_loss: 0.25082  loss:0.050887,stance loss: 0.017979 
Train step: 3700 acc:0.96543 total_loss: 0.25593  loss:0.43763,stance loss: 0.40645 
Train step: 3710 acc:0.96382 total_loss: 0.25089  loss:0.049065,stance loss: 0.016489 
Train step: 3720 acc:0.96549 total_loss: 0.24356  loss:0.043548,stance loss: 0.012918 
Train step: 3730 acc:0.96347 total_loss: 0.248  loss:0.21764,stance loss: 0.18821 
Train step: 3740 acc:0.96624 total_loss: 0.23552  loss:0.18952,stance loss: 0.17602 
Train step: 3750 acc:0.96714 total_loss: 0.22373  loss:0.034974,stance loss: 0.0048936 
Train step: 3760 acc:0.96612 total_loss: 0.22872  loss:0.1145,stance loss: 0.075744 
Train step: 3770 acc:0.96474 total_loss: 0.23072  loss:0.31453,stance loss: 0.33598 
Train step: 3780 acc:0.96555 total_loss: 0.23085  loss:0.049114,stance loss: 0.035826 
Train step: 3790 acc:0.96442 total_loss: 0.2261  loss:0.031721,stance loss: 0.0075255 
Train step: 3800 acc:0.96429 total_loss: 0.23069  loss:0.18825,stance loss: 0.11452 
Train step: 3810 acc:0.96497 total_loss: 0.23828  loss:0.05972,stance loss: 0.0066556 
Train step: 3820 acc:0.96519 total_loss: 0.23928  loss:0.1504,stance loss: 0.11205 
Train step: 3830 acc:0.9661 total_loss: 0.23299  loss:0.10868,stance loss: 0.095145 
Train step: 3840 acc:0.96758 total_loss: 0.2253  loss:0.01966,stance loss: 0.0014693 
Train step: 3850 acc:0.96827 total_loss: 0.22465  loss:0.029327,stance loss: 0.004406 
Train step: 3860 acc:0.9689 total_loss: 0.2244  loss:0.099853,stance loss: 0.096375 
Train step: 3870 acc:0.96861 total_loss: 0.2258  loss:0.13076,stance loss: 0.11 
Train step: 3880 acc:0.96834 total_loss: 0.22474  loss:0.045332,stance loss: 0.0062649 
Train step: 3890 acc:0.96835 total_loss: 0.22289  loss:0.27499,stance loss: 0.2111 
Train step: 3900 acc:0.96862 total_loss: 0.22277  loss:0.52027,stance loss: 1.0081 
Train step: 3910 acc:0.9679 total_loss: 0.2241  loss:0.39789,stance loss: 0.35742 
Training finished.


Reload the best model with best f1 0.4992145754200734 from path test_outputs/bert-cross-topic/dt/2023-08-14 16-23-56/state_dict


              precision    recall  f1-score   support

           0   0.504478  0.565217  0.533123       299
           1   0.563636  0.596154  0.579439       260
           2   0.587629  0.385135  0.465306       148

    accuracy                       0.538897       707
   macro avg   0.551914  0.515502  0.525956       707
weighted avg   0.543640  0.538897  0.535959       707

Test Acc: 0.5388967468175389 F1_ma:0.4992145754200734
Test dataset: dt
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4992145754200734
acc: 0.5388967468175389, f1 :0.5259561343921985
classification report: 
              precision    recall  f1-score   support

         Con     0.5045    0.5652    0.5331       299
        None     0.5636    0.5962    0.5794       260
         Pro     0.5876    0.3851    0.4653       148

    accuracy                         0.5389       707
   macro avg     0.5519    0.5155    0.5260       707
weighted avg     0.5436    0.5389    0.5360       707

