run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 13-03-59', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 13-03-59
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 2.1126  loss:2.1126,stance loss: 1.4207 
Train step: 10 acc:0.21591 total_loss: 1.9163  loss:1.751,stance loss: 1.2282 
Better F1! Saving model!
Saving model of best f1: 0.1478494623655914
              precision    recall  f1-score   support

           0   0.614525  0.194690  0.295699       565
           1   0.272050  0.855469  0.412818       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.334350       984
   macro avg   0.295525  0.350053  0.236172       984
weighted avg   0.423629  0.334350  0.277186       984

Test Acc: 0.33434959349593496 F1_ma:0.1478494623655914
Train step: 20 acc:0.25 total_loss: 1.8267  loss:1.7257,stance loss: 1.2535 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 30 acc:0.33669 total_loss: 1.772  loss:1.7062,stance loss: 1.3146 
Train step: 40 acc:0.3689 total_loss: 1.7453  loss:1.585,stance loss: 1.1507 
Train step: 50 acc:0.38848 total_loss: 1.7393  loss:1.6637,stance loss: 1.1665 
Train step: 60 acc:0.40574 total_loss: 1.7286  loss:1.606,stance loss: 1.1321 
Train step: 70 acc:0.41989 total_loss: 1.716  loss:1.5706,stance loss: 1.0986 
Train step: 80 acc:0.42824 total_loss: 1.7086  loss:1.865,stance loss: 1.2039 
Train step: 90 acc:0.43269 total_loss: 1.7029  loss:1.908,stance loss: 1.5509 
Train step: 100 acc:0.43626 total_loss: 1.6891  loss:1.4385,stance loss: 0.95716 
Train step: 110 acc:0.44369 total_loss: 1.6805  loss:1.6595,stance loss: 1.2683 
Train step: 120 acc:0.44267 total_loss: 1.68  loss:1.468,stance loss: 0.88557 
Train step: 130 acc:0.44752 total_loss: 1.6746  loss:1.7403,stance loss: 1.2815 
Train step: 140 acc:0.44725 total_loss: 1.6693  loss:1.6855,stance loss: 1.2272 
Train step: 150 acc:0.4524 total_loss: 1.6644  loss:1.4215,stance loss: 0.83754 
Train step: 160 acc:0.45652 total_loss: 1.6592  loss:1.6876,stance loss: 1.2427 
Better F1! Saving model!
Saving model of best f1: 0.3715568106521945
              precision    recall  f1-score   support

           0   0.575943  1.000000  0.730918       565
           1   1.000000  0.007812  0.015504       256
           2   1.000000  0.006135  0.012195       163

    accuracy                       0.577236       984
   macro avg   0.858648  0.337982  0.252872       984
weighted avg   0.756512  0.577236  0.425738       984

Test Acc: 0.5772357723577236 F1_ma:0.3715568106521945
Train step: 170 acc:0.4598 total_loss: 1.6573  loss:1.5512,stance loss: 1.1774 
Train step: 180 acc:0.46374 total_loss: 1.6513  loss:1.713,stance loss: 1.642 
Train step: 190 acc:0.46728 total_loss: 1.642  loss:1.476,stance loss: 0.93258 
Train step: 200 acc:0.46891 total_loss: 1.6362  loss:1.3798,stance loss: 1.0022 
Train step: 210 acc:0.47334 total_loss: 1.6332  loss:1.4627,stance loss: 1.0859 
Train step: 220 acc:0.47738 total_loss: 1.6276  loss:1.6756,stance loss: 1.1089 
Better F1! Saving model!
Saving model of best f1: 0.37277428730179074
              precision    recall  f1-score   support

           0   0.609613  0.920354  0.733427       565
           1   0.620155  0.312500  0.415584       256
           2   0.500000  0.006135  0.012121       163

    accuracy                       0.610772       984
   macro avg   0.576589  0.412996  0.387044       984
weighted avg   0.594198  0.610772  0.531252       984

Test Acc: 0.6107723577235772 F1_ma:0.37277428730179074
Train step: 230 acc:0.48187 total_loss: 1.6217  loss:1.395,stance loss: 0.96333 
Better F1! Saving model!
Saving model of best f1: 0.5051244262916333
              precision    recall  f1-score   support

           0   0.591346  0.870796  0.704366       565
           1   0.616667  0.144531  0.234177       256
           2   0.423913  0.239264  0.305882       163

    accuracy                       0.577236       984
   macro avg   0.543975  0.418197  0.414809       984
weighted avg   0.570198  0.577236  0.516032       984

Test Acc: 0.5772357723577236 F1_ma:0.5051244262916333
Train step: 240 acc:0.48444 total_loss: 1.6131  loss:1.5365,stance loss: 1.2854 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.58594 total_loss: 1.442  loss:1.843,stance loss: 1.8596 
Train step: 260 acc:0.56597 total_loss: 1.4586  loss:1.8401,stance loss: 1.8414 
Train step: 270 acc:0.59821 total_loss: 1.4288  loss:1.5228,stance loss: 1.2961 
Train step: 280 acc:0.60033 total_loss: 1.4372  loss:1.4325,stance loss: 1.2224 
Train step: 290 acc:0.60156 total_loss: 1.4332  loss:1.6082,stance loss: 1.3286 
Train step: 300 acc:0.61315 total_loss: 1.4138  loss:1.2891,stance loss: 0.75085 
Train step: 310 acc:0.61305 total_loss: 1.4096  loss:1.4994,stance loss: 1.1979 
Train step: 320 acc:0.61699 total_loss: 1.3978  loss:1.3737,stance loss: 0.99335 
Train step: 330 acc:0.62003 total_loss: 1.3932  loss:1.3373,stance loss: 1.0363 
Train step: 340 acc:0.6199 total_loss: 1.3951  loss:1.4942,stance loss: 1.15 
Train step: 350 acc:0.62269 total_loss: 1.3958  loss:1.3003,stance loss: 1.0187 
Train step: 360 acc:0.62129 total_loss: 1.3912  loss:1.2879,stance loss: 0.91136 
Train step: 370 acc:0.62793 total_loss: 1.3814  loss:1.1322,stance loss: 0.52914 
Train step: 380 acc:0.62908 total_loss: 1.3775  loss:1.4952,stance loss: 1.1818 
Train step: 390 acc:0.63133 total_loss: 1.3757  loss:1.3591,stance loss: 0.91089 
Train step: 400 acc:0.63212 total_loss: 1.3707  loss:1.5585,stance loss: 1.1553 
Train step: 410 acc:0.63132 total_loss: 1.3689  loss:1.0721,stance loss: 0.86525 
Train step: 420 acc:0.63343 total_loss: 1.3674  loss:1.7336,stance loss: 1.2688 
Train step: 430 acc:0.63531 total_loss: 1.3664  loss:1.7397,stance loss: 1.7228 
Train step: 440 acc:0.63573 total_loss: 1.3643  loss:1.1694,stance loss: 0.77058 
Train step: 450 acc:0.63642 total_loss: 1.3617  loss:1.3533,stance loss: 1.1638 
Train step: 460 acc:0.63675 total_loss: 1.3557  loss:1.1267,stance loss: 0.80835 
Train step: 470 acc:0.63651 total_loss: 1.3528  loss:1.177,stance loss: 0.86549 
Train step: 480 acc:0.63603 total_loss: 1.3499  loss:1.3043,stance loss: 0.97863 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.7375 total_loss: 0.98476  loss:0.93789,stance loss: 0.61637 
Train step: 500 acc:0.7125 total_loss: 1.1613  loss:1.3354,stance loss: 1.2854 
Train step: 510 acc:0.675 total_loss: 1.2216  loss:1.468,stance loss: 0.98097 
Train step: 520 acc:0.66964 total_loss: 1.2094  loss:1.3785,stance loss: 1.0675 
Train step: 530 acc:0.68194 total_loss: 1.1761  loss:1.1751,stance loss: 0.73468 
Better F1! Saving model!
Saving model of best f1: 0.5086992023114126
              precision    recall  f1-score   support

           0   0.645403  0.608850  0.626594       565
           1   0.556391  0.578125  0.567050       256
           2   0.367568  0.417178  0.390805       163

    accuracy                       0.569106       984
   macro avg   0.523121  0.534717  0.528149       984
weighted avg   0.576222  0.569106  0.572044       984

Test Acc: 0.5691056910569106 F1_ma:0.5086992023114126
Train step: 540 acc:0.68295 total_loss: 1.1706  loss:1.1152,stance loss: 0.83078 
Train step: 550 acc:0.68846 total_loss: 1.176  loss:1.0551,stance loss: 0.81459 
Train step: 560 acc:0.685 total_loss: 1.1842  loss:1.0917,stance loss: 0.78562 
Train step: 570 acc:0.68088 total_loss: 1.1948  loss:1.3209,stance loss: 0.99734 
Better F1! Saving model!
Saving model of best f1: 0.5187828355840767
              precision    recall  f1-score   support

           0   0.624194  0.684956  0.653165       565
           1   0.601190  0.394531  0.476415       256
           2   0.352041  0.423313  0.384401       163

    accuracy                       0.566057       984
   macro avg   0.525808  0.500933  0.504660       984
weighted avg   0.573127  0.566057  0.562660       984

Test Acc: 0.5660569105691057 F1_ma:0.5187828355840767
Train step: 580 acc:0.68553 total_loss: 1.189  loss:1.3005,stance loss: 0.9748 
Train step: 590 acc:0.68631 total_loss: 1.1981  loss:1.1516,stance loss: 0.86144 
Train step: 600 acc:0.68859 total_loss: 1.197  loss:1.4175,stance loss: 1.1433 
Train step: 610 acc:0.684 total_loss: 1.2052  loss:1.463,stance loss: 1.3006 
Train step: 620 acc:0.68704 total_loss: 1.204  loss:1.1252,stance loss: 0.80244 
Train step: 630 acc:0.68879 total_loss: 1.2038  loss:0.91695,stance loss: 0.63199 
Train step: 640 acc:0.69435 total_loss: 1.1921  loss:1.2055,stance loss: 0.99138 
Train step: 650 acc:0.69129 total_loss: 1.1955  loss:1.1034,stance loss: 0.868 
Better F1! Saving model!
Saving model of best f1: 0.522205857435189
              precision    recall  f1-score   support

           0   0.679012  0.584071  0.627973       565
           1   0.557432  0.644531  0.597826       256
           2   0.376238  0.466258  0.416438       163

    accuracy                       0.580285       984
   macro avg   0.537561  0.564953  0.547413       984
weighted avg   0.597227  0.580285  0.585089       984

Test Acc: 0.5802845528455285 F1_ma:0.522205857435189
Train step: 660 acc:0.68821 total_loss: 1.2012  loss:1.2062,stance loss: 0.86115 
Train step: 670 acc:0.68818 total_loss: 1.196  loss:1.0877,stance loss: 0.84431 
Train step: 680 acc:0.68622 total_loss: 1.2008  loss:1.8649,stance loss: 1.9422 
Train step: 690 acc:0.68537 total_loss: 1.2005  loss:1.0703,stance loss: 0.90961 
Train step: 700 acc:0.68692 total_loss: 1.2024  loss:1.4602,stance loss: 1.2019 
Train step: 710 acc:0.68417 total_loss: 1.207  loss:1.1556,stance loss: 0.76577 
Train step: 720 acc:0.68564 total_loss: 1.2029  loss:1.1567,stance loss: 0.74983 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.71875 total_loss: 1.0037  loss:0.7938,stance loss: 0.49836 
Train step: 740 acc:0.66667 total_loss: 1.1091  loss:1.0392,stance loss: 0.82857 
Train step: 750 acc:0.69318 total_loss: 1.0643  loss:1.0094,stance loss: 0.80289 
Train step: 760 acc:0.71094 total_loss: 1.029  loss:1.0794,stance loss: 0.63431 
Train step: 770 acc:0.70982 total_loss: 1.0716  loss:1.4987,stance loss: 1.6593 
Train step: 780 acc:0.70913 total_loss: 1.093  loss:1.5525,stance loss: 1.26 
Train step: 790 acc:0.70968 total_loss: 1.0924  loss:1.1393,stance loss: 0.86856 
Train step: 800 acc:0.70833 total_loss: 1.1033  loss:0.83618,stance loss: 0.5743 
Train step: 810 acc:0.70579 total_loss: 1.105  loss:1.1447,stance loss: 0.75647 
Train step: 820 acc:0.70109 total_loss: 1.1068  loss:0.98645,stance loss: 0.78762 
Train step: 830 acc:0.69975 total_loss: 1.1005  loss:1.0511,stance loss: 0.74463 
Train step: 840 acc:0.69978 total_loss: 1.1007  loss:1.4812,stance loss: 1.5301 
Train step: 850 acc:0.70082 total_loss: 1.1015  loss:0.93374,stance loss: 0.80114 
Train step: 860 acc:0.70644 total_loss: 1.0963  loss:1.0593,stance loss: 0.832 
Train step: 870 acc:0.70995 total_loss: 1.0894  loss:0.47495,stance loss: 0.26238 
Train step: 880 acc:0.71094 total_loss: 1.0837  loss:1.0649,stance loss: 0.74422 
Train step: 890 acc:0.70949 total_loss: 1.0898  loss:1.0412,stance loss: 0.8513 
Train step: 900 acc:0.71185 total_loss: 1.0862  loss:0.98955,stance loss: 0.7702 
Train step: 910 acc:0.71497 total_loss: 1.0827  loss:0.6374,stance loss: 0.36405 
Train step: 920 acc:0.71484 total_loss: 1.0903  loss:0.97567,stance loss: 0.73152 
Train step: 930 acc:0.71535 total_loss: 1.0895  loss:0.6642,stance loss: 0.60389 
Train step: 940 acc:0.71315 total_loss: 1.0912  loss:0.76258,stance loss: 0.42479 
Train step: 950 acc:0.71565 total_loss: 1.087  loss:1.148,stance loss: 0.91737 
Train step: 960 acc:0.71713 total_loss: 1.0885  loss:0.93802,stance loss: 0.61474 
Train step: 970 acc:0.71978 total_loss: 1.0818  loss:0.83787,stance loss: 0.46582 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.72917 total_loss: 1.0185  loss:1.4369,stance loss: 1.1945 
Train step: 990 acc:0.76645 total_loss: 0.98663  loss:0.48097,stance loss: 0.26877 
Train step: 1000 acc:0.77802 total_loss: 0.93424  loss:0.59332,stance loss: 0.33094 
Train step: 1010 acc:0.77564 total_loss: 0.94906  loss:0.65219,stance loss: 0.33769 
Train step: 1020 acc:0.76531 total_loss: 0.98604  loss:1.0321,stance loss: 0.67888 
Train step: 1030 acc:0.75847 total_loss: 1.0007  loss:1.4458,stance loss: 0.96142 
Train step: 1040 acc:0.76721 total_loss: 0.9737  loss:0.58382,stance loss: 0.38663 
Train step: 1050 acc:0.75712 total_loss: 0.98703  loss:0.72786,stance loss: 0.53011 
Train step: 1060 acc:0.76053 total_loss: 0.97842  loss:1.2728,stance loss: 0.84119 
Train step: 1070 acc:0.76452 total_loss: 0.97049  loss:0.89151,stance loss: 0.78127 
Train step: 1080 acc:0.76319 total_loss: 0.96781  loss:0.97972,stance loss: 0.81772 
Train step: 1090 acc:0.75998 total_loss: 0.97044  loss:1.5681,stance loss: 1.151 
Train step: 1100 acc:0.75678 total_loss: 0.98279  loss:0.85208,stance loss: 0.59821 
Train step: 1110 acc:0.7527 total_loss: 0.99777  loss:1.7547,stance loss: 1.6594 
Train step: 1120 acc:0.75336 total_loss: 0.99306  loss:1.0505,stance loss: 0.79677 
Train step: 1130 acc:0.7559 total_loss: 0.9884  loss:0.57643,stance loss: 0.49653 
Train step: 1140 acc:0.75185 total_loss: 0.99565  loss:1.1229,stance loss: 1.4131 
Train step: 1150 acc:0.75 total_loss: 0.99556  loss:1.2935,stance loss: 1.2462 
Train step: 1160 acc:0.75298 total_loss: 0.98225  loss:0.90159,stance loss: 0.67026 
Train step: 1170 acc:0.75283 total_loss: 0.98496  loss:1.4473,stance loss: 1.2996 
Train step: 1180 acc:0.75598 total_loss: 0.98412  loss:1.0733,stance loss: 1.3274 
Train step: 1190 acc:0.75514 total_loss: 0.99084  loss:1.3346,stance loss: 1.5101 
Train step: 1200 acc:0.75382 total_loss: 0.98918  loss:1.1833,stance loss: 0.97739 
Train step: 1210 acc:0.75157 total_loss: 0.99354  loss:0.75498,stance loss: 0.47179 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.82292 total_loss: 0.76652  loss:1.1301,stance loss: 1.0196 
Train step: 1230 acc:0.80469 total_loss: 0.87288  loss:1.0504,stance loss: 0.84698 
Train step: 1240 acc:0.8101 total_loss: 0.83298  loss:0.92002,stance loss: 0.66957 
Better F1! Saving model!
Saving model of best f1: 0.5347382952626798
              precision    recall  f1-score   support

           0   0.659864  0.686726  0.673027       565
           1   0.583710  0.503906  0.540881       256
           2   0.382857  0.411043  0.396450       163

    accuracy                       0.593496       984
   macro avg   0.542144  0.533892  0.536786       984
weighted avg   0.594165  0.593496  0.592832       984

Test Acc: 0.5934959349593496 F1_ma:0.5347382952626798
Train step: 1250 acc:0.79688 total_loss: 0.88119  loss:0.90953,stance loss: 0.82343 
Train step: 1260 acc:0.80842 total_loss: 0.87208  loss:1.022,stance loss: 0.95044 
Train step: 1270 acc:0.81027 total_loss: 0.86963  loss:1.4294,stance loss: 1.2765 
Train step: 1280 acc:0.80492 total_loss: 0.88234  loss:0.77373,stance loss: 0.53356 
Train step: 1290 acc:0.80757 total_loss: 0.87156  loss:0.77911,stance loss: 0.61527 
Train step: 1300 acc:0.80887 total_loss: 0.86908  loss:1.1582,stance loss: 1.1287 
Train step: 1310 acc:0.80404 total_loss: 0.866  loss:0.80624,stance loss: 0.62808 
Train step: 1320 acc:0.7954 total_loss: 0.88325  loss:0.87859,stance loss: 0.62336 
Train step: 1330 acc:0.79256 total_loss: 0.88902  loss:0.84288,stance loss: 0.71907 
Train step: 1340 acc:0.79415 total_loss: 0.88305  loss:0.81325,stance loss: 0.61501 
Train step: 1350 acc:0.79136 total_loss: 0.87911  loss:1.0176,stance loss: 0.80728 
Train step: 1360 acc:0.79281 total_loss: 0.86836  loss:0.60692,stance loss: 0.38665 
Train step: 1370 acc:0.79087 total_loss: 0.87739  loss:0.45012,stance loss: 0.24958 
Train step: 1380 acc:0.7933 total_loss: 0.87201  loss:0.55725,stance loss: 0.41269 
Train step: 1390 acc:0.79084 total_loss: 0.88035  loss:0.93222,stance loss: 0.7361 
Train step: 1400 acc:0.792 total_loss: 0.87618  loss:0.56974,stance loss: 0.3729 
Train step: 1410 acc:0.79145 total_loss: 0.87151  loss:0.62348,stance loss: 0.41228 
Train step: 1420 acc:0.79126 total_loss: 0.8736  loss:1.0153,stance loss: 0.88212 
Train step: 1430 acc:0.79167 total_loss: 0.87204  loss:1.269,stance loss: 1.237 
Train step: 1440 acc:0.79452 total_loss: 0.86894  loss:0.98544,stance loss: 1.3338 
Train step: 1450 acc:0.79582 total_loss: 0.86699  loss:1.0327,stance loss: 0.92271 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.875 total_loss: 0.63047  loss:0.52455,stance loss: 0.37359 
Train step: 1470 acc:0.89904 total_loss: 0.65883  loss:0.73572,stance loss: 0.65388 
Train step: 1480 acc:0.86957 total_loss: 0.67652  loss:0.50317,stance loss: 0.30388 
Train step: 1490 acc:0.85795 total_loss: 0.69112  loss:0.60101,stance loss: 0.36845 
Train step: 1500 acc:0.8532 total_loss: 0.70509  loss:0.28424,stance loss: 0.12241 
Train step: 1510 acc:0.84552 total_loss: 0.71014  loss:0.77209,stance loss: 0.6217 
Train step: 1520 acc:0.83929 total_loss: 0.73739  loss:0.48049,stance loss: 0.35751 
Train step: 1530 acc:0.82877 total_loss: 0.75878  loss:0.68785,stance loss: 0.47912 
Train step: 1540 acc:0.83133 total_loss: 0.75608  loss:0.82587,stance loss: 1.2218 
Train step: 1550 acc:0.8293 total_loss: 0.75524  loss:0.82795,stance loss: 0.68026 
Train step: 1560 acc:0.82828 total_loss: 0.74968  loss:0.42916,stance loss: 0.31547 
Train step: 1570 acc:0.82356 total_loss: 0.76335  loss:1.1596,stance loss: 0.95787 
Train step: 1580 acc:0.8247 total_loss: 0.7633  loss:0.81242,stance loss: 0.67777 
Train step: 1590 acc:0.82425 total_loss: 0.76291  loss:0.4218,stance loss: 0.33036 
Train step: 1600 acc:0.82649 total_loss: 0.75758  loss:0.21815,stance loss: 0.064203 
Train step: 1610 acc:0.82516 total_loss: 0.76237  loss:0.82926,stance loss: 0.44475 
Train step: 1620 acc:0.82669 total_loss: 0.75744  loss:0.68579,stance loss: 0.49104 
Train step: 1630 acc:0.82659 total_loss: 0.76221  loss:0.55164,stance loss: 0.3107 
Train step: 1640 acc:0.8265 total_loss: 0.75702  loss:0.7339,stance loss: 0.52127 
Train step: 1650 acc:0.8274 total_loss: 0.75308  loss:0.98606,stance loss: 0.7746 
Train step: 1660 acc:0.82789 total_loss: 0.74876  loss:0.53911,stance loss: 0.41003 
Train step: 1670 acc:0.82776 total_loss: 0.74546  loss:0.49619,stance loss: 0.25589 
Train step: 1680 acc:0.82595 total_loss: 0.74949  loss:0.71088,stance loss: 0.57941 
Train step: 1690 acc:0.82645 total_loss: 0.74548  loss:0.50044,stance loss: 0.40107 
Train step: 1700 acc:0.82784 total_loss: 0.74527  loss:0.83891,stance loss: 0.59742 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.83125 total_loss: 0.69529  loss:0.35074,stance loss: 0.27341 
Train step: 1720 acc:0.8375 total_loss: 0.73874  loss:0.72166,stance loss: 0.53756 
Train step: 1730 acc:0.83125 total_loss: 0.74923  loss:1.1097,stance loss: 1.0196 
Better F1! Saving model!
Saving model of best f1: 0.5403772384870709
              precision    recall  f1-score   support

           0   0.680851  0.623009  0.650647       565
           1   0.589147  0.593750  0.591440       256
           2   0.382775  0.490798  0.430108       163

    accuracy                       0.593496       984
   macro avg   0.550924  0.569185  0.557398       984
weighted avg   0.607617  0.593496  0.598711       984

Test Acc: 0.5934959349593496 F1_ma:0.5403772384870709
Train step: 1740 acc:0.84062 total_loss: 0.71862  loss:0.45245,stance loss: 0.24638 
Train step: 1750 acc:0.8475 total_loss: 0.69531  loss:0.25222,stance loss: 0.10101 
Train step: 1760 acc:0.84062 total_loss: 0.7271  loss:1.138,stance loss: 1.4367 
Train step: 1770 acc:0.84375 total_loss: 0.71471  loss:0.53191,stance loss: 0.33256 
Train step: 1780 acc:0.84219 total_loss: 0.72356  loss:0.85285,stance loss: 0.72322 
Train step: 1790 acc:0.84792 total_loss: 0.71558  loss:0.7716,stance loss: 0.73045 
Train step: 1800 acc:0.84937 total_loss: 0.70704  loss:0.6059,stance loss: 0.43485 
Train step: 1810 acc:0.85 total_loss: 0.69188  loss:1.0664,stance loss: 0.76894 
Train step: 1820 acc:0.85365 total_loss: 0.67624  loss:0.29772,stance loss: 0.088764 
Train step: 1830 acc:0.85385 total_loss: 0.67801  loss:0.22742,stance loss: 0.10565 
Train step: 1840 acc:0.85357 total_loss: 0.67557  loss:0.54064,stance loss: 0.50829 
Train step: 1850 acc:0.85375 total_loss: 0.67081  loss:0.62677,stance loss: 0.53353 
Better F1! Saving model!
Saving model of best f1: 0.5461743086052477
              precision    recall  f1-score   support

           0   0.687140  0.633628  0.659300       565
           1   0.574545  0.617188  0.595104       256
           2   0.404255  0.466258  0.433048       163

    accuracy                       0.601626       984
   macro avg   0.555314  0.572358  0.562484       984
weighted avg   0.610987  0.601626  0.605120       984

Test Acc: 0.6016260162601627 F1_ma:0.5461743086052477
Train step: 1860 acc:0.85508 total_loss: 0.67553  loss:0.58342,stance loss: 0.5903 
Train step: 1870 acc:0.85625 total_loss: 0.66931  loss:0.35592,stance loss: 0.27763 
Train step: 1880 acc:0.85833 total_loss: 0.66086  loss:0.93138,stance loss: 1.205 
Train step: 1890 acc:0.86053 total_loss: 0.6587  loss:0.77136,stance loss: 0.67099 
Train step: 1900 acc:0.86062 total_loss: 0.65815  loss:0.65297,stance loss: 0.55256 
Better F1! Saving model!
Saving model of best f1: 0.5513015294236808
              precision    recall  f1-score   support

           0   0.678571  0.638938  0.658159       565
           1   0.572549  0.570312  0.571429       256
           2   0.406091  0.490798  0.444444       163

    accuracy                       0.596545       984
   macro avg   0.552404  0.566683  0.558011       984
weighted avg   0.605852  0.596545  0.600193       984

Test Acc: 0.5965447154471545 F1_ma:0.5513015294236808
Train step: 1910 acc:0.86101 total_loss: 0.65373  loss:0.28404,stance loss: 0.079154 
Train step: 1920 acc:0.8625 total_loss: 0.64587  loss:0.56609,stance loss: 0.42201 
Train step: 1930 acc:0.86304 total_loss: 0.64646  loss:0.70683,stance loss: 0.6827 
Train step: 1940 acc:0.86224 total_loss: 0.64377  loss:0.7548,stance loss: 0.65392 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.84821 total_loss: 0.60364  loss:0.29902,stance loss: 0.090905 
Train step: 1960 acc:0.88603 total_loss: 0.6095  loss:0.40918,stance loss: 0.32323 
Train step: 1970 acc:0.88657 total_loss: 0.58162  loss:0.31067,stance loss: 0.21125 
Train step: 1980 acc:0.89189 total_loss: 0.54516  loss:0.43804,stance loss: 0.33618 
Train step: 1990 acc:0.88564 total_loss: 0.54557  loss:0.53385,stance loss: 0.23975 
Train step: 2000 acc:0.88158 total_loss: 0.55368  loss:0.31916,stance loss: 0.17498 
Train step: 2010 acc:0.8834 total_loss: 0.56045  loss:0.96991,stance loss: 1.0223 
Train step: 2020 acc:0.87744 total_loss: 0.57384  loss:0.25622,stance loss: 0.11356 
Train step: 2030 acc:0.88003 total_loss: 0.56495  loss:0.81376,stance loss: 0.70344 
Train step: 2040 acc:0.8808 total_loss: 0.58004  loss:1.6107,stance loss: 2.0604 
Train step: 2050 acc:0.88084 total_loss: 0.58035  loss:0.92647,stance loss: 1.2343 
Train step: 2060 acc:0.88088 total_loss: 0.57755  loss:0.40201,stance loss: 0.29122 
Train step: 2070 acc:0.88287 total_loss: 0.57459  loss:1.1127,stance loss: 1.1658 
Train step: 2080 acc:0.88549 total_loss: 0.56397  loss:0.48886,stance loss: 0.39361 
Train step: 2090 acc:0.8869 total_loss: 0.56164  loss:0.42308,stance loss: 0.24778 
Train step: 2100 acc:0.88973 total_loss: 0.55104  loss:0.91711,stance loss: 0.85342 
Train step: 2110 acc:0.89109 total_loss: 0.54686  loss:0.45294,stance loss: 0.36909 
Train step: 2120 acc:0.88701 total_loss: 0.56239  loss:0.75761,stance loss: 0.5112 
Train step: 2130 acc:0.88436 total_loss: 0.56572  loss:0.50366,stance loss: 0.24883 
Train step: 2140 acc:0.88642 total_loss: 0.56373  loss:0.69331,stance loss: 0.581 
Train step: 2150 acc:0.88557 total_loss: 0.56728  loss:0.56436,stance loss: 0.58644 
Train step: 2160 acc:0.88738 total_loss: 0.56433  loss:0.15656,stance loss: 0.088342 
Train step: 2170 acc:0.88849 total_loss: 0.56147  loss:0.54517,stance loss: 0.41158 
Train step: 2180 acc:0.88845 total_loss: 0.55899  loss:0.17646,stance loss: 0.10833 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.9375 total_loss: 0.55347  loss:0.22493,stance loss: 0.10273 
Train step: 2200 acc:0.94643 total_loss: 0.3706  loss:0.1791,stance loss: 0.070899 
Train step: 2210 acc:0.94531 total_loss: 0.39631  loss:0.42348,stance loss: 0.33681 
Train step: 2220 acc:0.92463 total_loss: 0.43164  loss:0.99692,stance loss: 1.3422 
Train step: 2230 acc:0.92756 total_loss: 0.43312  loss:0.31296,stance loss: 0.26165 
Train step: 2240 acc:0.9294 total_loss: 0.41861  loss:0.37701,stance loss: 0.32758 
Train step: 2250 acc:0.92285 total_loss: 0.43237  loss:0.58254,stance loss: 0.44442 
Train step: 2260 acc:0.91892 total_loss: 0.44411  loss:0.83217,stance loss: 1.1162 
Train step: 2270 acc:0.91741 total_loss: 0.44676  loss:0.75407,stance loss: 0.4853 
Train step: 2280 acc:0.91888 total_loss: 0.44397  loss:0.53054,stance loss: 0.295 
Train step: 2290 acc:0.91887 total_loss: 0.44972  loss:0.72375,stance loss: 0.41904 
Train step: 2300 acc:0.9227 total_loss: 0.43613  loss:0.11461,stance loss: 0.056366 
Train step: 2310 acc:0.92087 total_loss: 0.45613  loss:0.5512,stance loss: 0.52032 
Train step: 2320 acc:0.91698 total_loss: 0.46777  loss:0.58729,stance loss: 0.46161 
Train step: 2330 acc:0.9158 total_loss: 0.46228  loss:0.20133,stance loss: 0.12753 
Train step: 2340 acc:0.91518 total_loss: 0.47271  loss:0.36557,stance loss: 0.34956 
Train step: 2350 acc:0.9173 total_loss: 0.46549  loss:0.20379,stance loss: 0.17039 
Train step: 2360 acc:0.91703 total_loss: 0.46188  loss:0.28109,stance loss: 0.12889 
Train step: 2370 acc:0.9161 total_loss: 0.46451  loss:0.96561,stance loss: 0.94887 
Train step: 2380 acc:0.91591 total_loss: 0.46599  loss:0.45563,stance loss: 0.30987 
Train step: 2390 acc:0.91697 total_loss: 0.46807  loss:0.21927,stance loss: 0.19514 
Train step: 2400 acc:0.91472 total_loss: 0.47251  loss:0.49599,stance loss: 0.35672 
Train step: 2410 acc:0.91546 total_loss: 0.47345  loss:0.61401,stance loss: 0.45378 
Train step: 2420 acc:0.91453 total_loss: 0.47395  loss:1.0513,stance loss: 0.88883 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.93186  loss:0.93186,stance loss: 1.3595 
Train step: 2440 acc:0.9375 total_loss: 0.32858  loss:0.33636,stance loss: 0.32852 
Train step: 2450 acc:0.94345 total_loss: 0.30645  loss:0.14834,stance loss: 0.042206 
Train step: 2460 acc:0.94758 total_loss: 0.30086  loss:0.16796,stance loss: 0.093225 
Train step: 2470 acc:0.9436 total_loss: 0.30897  loss:0.46371,stance loss: 0.38199 
Train step: 2480 acc:0.9424 total_loss: 0.32868  loss:0.1674,stance loss: 0.13499 
Train step: 2490 acc:0.9457 total_loss: 0.32287  loss:0.14204,stance loss: 0.068435 
Train step: 2500 acc:0.94454 total_loss: 0.33339  loss:0.19113,stance loss: 0.1306 
Train step: 2510 acc:0.9429 total_loss: 0.33811  loss:0.24271,stance loss: 0.073359 
Train step: 2520 acc:0.94025 total_loss: 0.34526  loss:0.27412,stance loss: 0.22874 
Train step: 2530 acc:0.93936 total_loss: 0.35793  loss:0.069465,stance loss: 0.021929 
Train step: 2540 acc:0.93863 total_loss: 0.37052  loss:0.18305,stance loss: 0.12215 
Train step: 2550 acc:0.93905 total_loss: 0.36533  loss:0.24221,stance loss: 0.19633 
Train step: 2560 acc:0.93607 total_loss: 0.37205  loss:0.52064,stance loss: 0.35916 
Train step: 2570 acc:0.93573 total_loss: 0.37438  loss:0.42372,stance loss: 0.4607 
Train step: 2580 acc:0.93543 total_loss: 0.37357  loss:0.24445,stance loss: 0.19447 
Train step: 2590 acc:0.93634 total_loss: 0.36591  loss:0.074892,stance loss: 0.016604 
Train step: 2600 acc:0.93531 total_loss: 0.37346  loss:0.68896,stance loss: 0.55437 
Train step: 2610 acc:0.93508 total_loss: 0.37133  loss:0.79346,stance loss: 0.69234 
Train step: 2620 acc:0.93717 total_loss: 0.3666  loss:0.16622,stance loss: 0.054691 
Train step: 2630 acc:0.93595 total_loss: 0.37175  loss:0.16557,stance loss: 0.060847 
Train step: 2640 acc:0.93454 total_loss: 0.37317  loss:0.39278,stance loss: 0.28209 
Train step: 2650 acc:0.93269 total_loss: 0.37795  loss:0.68276,stance loss: 0.57496 
Train step: 2660 acc:0.9329 total_loss: 0.37442  loss:0.53642,stance loss: 0.52627 
Train step: 2670 acc:0.93257 total_loss: 0.37579  loss:0.30587,stance loss: 0.23715 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.95312 total_loss: 0.3506  loss:0.68117,stance loss: 0.65089 
Train step: 2690 acc:0.95486 total_loss: 0.32202  loss:0.10295,stance loss: 0.034698 
Train step: 2700 acc:0.96205 total_loss: 0.29342  loss:0.054223,stance loss: 0.011194 
Train step: 2710 acc:0.96053 total_loss: 0.27605  loss:0.63808,stance loss: 0.55148 
Train step: 2720 acc:0.95833 total_loss: 0.30591  loss:0.09347,stance loss: 0.03162 
Train step: 2730 acc:0.95797 total_loss: 0.2961  loss:0.32808,stance loss: 0.22956 
Train step: 2740 acc:0.95588 total_loss: 0.29734  loss:0.17412,stance loss: 0.12346 
Better F1! Saving model!
Saving model of best f1: 0.5519563008130082
              precision    recall  f1-score   support

           0   0.664395  0.690265  0.677083       565
           1   0.568966  0.515625  0.540984       256
           2   0.424242  0.429448  0.426829       163

    accuracy                       0.601626       984
   macro avg   0.552534  0.545113  0.548299       984
weighted avg   0.599787  0.601626  0.600221       984

Test Acc: 0.6016260162601627 F1_ma:0.5519563008130082
Train step: 2750 acc:0.95513 total_loss: 0.29698  loss:0.38645,stance loss: 0.30941 
Train step: 2760 acc:0.95384 total_loss: 0.29787  loss:0.85125,stance loss: 1.1889 
Train step: 2770 acc:0.95408 total_loss: 0.29678  loss:0.14856,stance loss: 0.11258 
Train step: 2780 acc:0.95312 total_loss: 0.3003  loss:0.055331,stance loss: 0.0046801 
Train step: 2790 acc:0.9518 total_loss: 0.29943  loss:0.071935,stance loss: 0.02609 
Train step: 2800 acc:0.95117 total_loss: 0.29819  loss:0.35231,stance loss: 0.29643 
Train step: 2810 acc:0.95199 total_loss: 0.29469  loss:0.30063,stance loss: 0.25611 
Train step: 2820 acc:0.94806 total_loss: 0.31447  loss:0.52818,stance loss: 0.43792 
Train step: 2830 acc:0.94818 total_loss: 0.30862  loss:0.13642,stance loss: 0.084687 
Train step: 2840 acc:0.94792 total_loss: 0.3034  loss:0.090079,stance loss: 0.048692 
Train step: 2850 acc:0.94803 total_loss: 0.3089  loss:0.31105,stance loss: 0.23334 
Train step: 2860 acc:0.94847 total_loss: 0.30663  loss:0.20122,stance loss: 0.15784 
Train step: 2870 acc:0.94697 total_loss: 0.30858  loss:0.49806,stance loss: 0.46258 
Train step: 2880 acc:0.94621 total_loss: 0.31371  loss:0.36905,stance loss: 0.19802 
Better F1! Saving model!
Saving model of best f1: 0.5604752770673486
              precision    recall  f1-score   support

           0   0.666048  0.635398  0.650362       565
           1   0.580645  0.492188  0.532770       256
           2   0.403509  0.564417  0.470588       163

    accuracy                       0.586382       984
   macro avg   0.550067  0.564001  0.551240       984
weighted avg   0.600340  0.586382  0.589989       984

Test Acc: 0.5863821138211383 F1_ma:0.5604752770673486
Train step: 2890 acc:0.94667 total_loss: 0.31466  loss:0.15382,stance loss: 0.086202 
Train step: 2900 acc:0.94655 total_loss: 0.31333  loss:0.071167,stance loss: 0.016593 
Train step: 2910 acc:0.94695 total_loss: 0.31697  loss:0.67081,stance loss: 1.0237 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.9625 total_loss: 0.34527  loss:0.22335,stance loss: 0.16709 
Train step: 2930 acc:0.95833 total_loss: 0.28723  loss:0.55152,stance loss: 0.54776 
Train step: 2940 acc:0.935 total_loss: 0.32263  loss:0.040071,stance loss: 0.0026672 
Train step: 2950 acc:0.9375 total_loss: 0.29271  loss:0.060927,stance loss: 0.02525 
Train step: 2960 acc:0.94167 total_loss: 0.27917  loss:0.27393,stance loss: 0.27251 
Train step: 2970 acc:0.94545 total_loss: 0.26157  loss:0.24143,stance loss: 0.10848 
Train step: 2980 acc:0.94808 total_loss: 0.26278  loss:0.83411,stance loss: 1.3465 
Train step: 2990 acc:0.94583 total_loss: 0.2708  loss:0.20384,stance loss: 0.048721 
Train step: 3000 acc:0.94559 total_loss: 0.27549  loss:0.65442,stance loss: 0.5613 
Train step: 3010 acc:0.94671 total_loss: 0.27136  loss:0.083531,stance loss: 0.052816 
Train step: 3020 acc:0.94702 total_loss: 0.27516  loss:0.62517,stance loss: 0.42708 
Train step: 3030 acc:0.95 total_loss: 0.26738  loss:0.044961,stance loss: 0.0059619 
Train step: 3040 acc:0.949 total_loss: 0.2695  loss:0.07637,stance loss: 0.0095795 
Train step: 3050 acc:0.95 total_loss: 0.27003  loss:0.13198,stance loss: 0.076656 
Train step: 3060 acc:0.95 total_loss: 0.26653  loss:0.080465,stance loss: 0.04657 
Train step: 3070 acc:0.9504 total_loss: 0.26953  loss:0.41836,stance loss: 0.42101 
Train step: 3080 acc:0.95189 total_loss: 0.26446  loss:0.042907,stance loss: 0.014978 
Train step: 3090 acc:0.95143 total_loss: 0.27083  loss:0.72364,stance loss: 0.45716 
Train step: 3100 acc:0.95304 total_loss: 0.26643  loss:0.64575,stance loss: 1.0617 
Train step: 3110 acc:0.95353 total_loss: 0.26723  loss:0.075762,stance loss: 0.031908 
Train step: 3120 acc:0.95396 total_loss: 0.26891  loss:0.79417,stance loss: 0.47463 
Train step: 3130 acc:0.95349 total_loss: 0.26848  loss:0.21945,stance loss: 0.23431 
Train step: 3140 acc:0.95333 total_loss: 0.26615  loss:0.034353,stance loss: 0.010503 
Train step: 3150 acc:0.95239 total_loss: 0.26975  loss:0.35605,stance loss: 0.22219 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:0.90625 total_loss: 0.31005  loss:0.21807,stance loss: 0.18219 
Train step: 3170 acc:0.95312 total_loss: 0.31824  loss:0.044774,stance loss: 0.009211 
Train step: 3180 acc:0.95739 total_loss: 0.28463  loss:0.16606,stance loss: 0.19637 
Train step: 3190 acc:0.96484 total_loss: 0.26318  loss:0.16582,stance loss: 0.1686 
Train step: 3200 acc:0.96577 total_loss: 0.23445  loss:0.083536,stance loss: 0.027304 
Train step: 3210 acc:0.96635 total_loss: 0.22373  loss:0.11404,stance loss: 0.069499 
Train step: 3220 acc:0.96673 total_loss: 0.22616  loss:0.099087,stance loss: 0.087627 
Train step: 3230 acc:0.96701 total_loss: 0.21212  loss:0.043824,stance loss: 0.0038048 
Train step: 3240 acc:0.96723 total_loss: 0.20514  loss:0.15515,stance loss: 0.13256 
Train step: 3250 acc:0.96807 total_loss: 0.20463  loss:0.25784,stance loss: 0.30301 
Train step: 3260 acc:0.9663 total_loss: 0.21305  loss:0.13059,stance loss: 0.037286 
Train step: 3270 acc:0.96819 total_loss: 0.20876  loss:0.068135,stance loss: 0.041447 
Train step: 3280 acc:0.96721 total_loss: 0.20682  loss:0.19434,stance loss: 0.19292 
Train step: 3290 acc:0.96496 total_loss: 0.2224  loss:0.44429,stance loss: 0.41694 
Train step: 3300 acc:0.96523 total_loss: 0.21741  loss:0.35326,stance loss: 0.22535 
Train step: 3310 acc:0.96546 total_loss: 0.2181  loss:0.071062,stance loss: 0.013893 
Train step: 3320 acc:0.96528 total_loss: 0.22354  loss:0.28516,stance loss: 0.25722 
Train step: 3330 acc:0.96657 total_loss: 0.22428  loss:0.025627,stance loss: 0.0055849 
Train step: 3340 acc:0.96703 total_loss: 0.22147  loss:0.24274,stance loss: 0.16333 
Train step: 3350 acc:0.96745 total_loss: 0.22273  loss:0.27674,stance loss: 0.32923 
Train step: 3360 acc:0.96751 total_loss: 0.21882  loss:0.052767,stance loss: 0.022136 
Train step: 3370 acc:0.9658 total_loss: 0.2246  loss:0.068443,stance loss: 0.033252 
Train step: 3380 acc:0.96565 total_loss: 0.22741  loss:0.067078,stance loss: 0.012348 
Train step: 3390 acc:0.96633 total_loss: 0.23218  loss:0.12885,stance loss: 0.12083 
Train step: 3400 acc:0.96668 total_loss: 0.22874  loss:0.050859,stance loss: 0.026408 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.97917 total_loss: 0.10144  loss:0.094303,stance loss: 0.021984 
Train step: 3420 acc:0.98684 total_loss: 0.12131  loss:0.023469,stance loss: 0.0041642 
Train step: 3430 acc:0.98276 total_loss: 0.152  loss:0.074168,stance loss: 0.024546 
Train step: 3440 acc:0.98237 total_loss: 0.15655  loss:0.18542,stance loss: 0.16169 
Train step: 3450 acc:0.98214 total_loss: 0.14516  loss:0.060862,stance loss: 0.019218 
Train step: 3460 acc:0.98199 total_loss: 0.13688  loss:0.045575,stance loss: 0.022527 
Train step: 3470 acc:0.97645 total_loss: 0.17173  loss:0.040509,stance loss: 0.023018 
Train step: 3480 acc:0.97389 total_loss: 0.1923  loss:0.59977,stance loss: 1.0529 
Train step: 3490 acc:0.97402 total_loss: 0.18996  loss:0.14799,stance loss: 0.0338 
Train step: 3500 acc:0.97475 total_loss: 0.18336  loss:0.02823,stance loss: 0.004237 
Train step: 3510 acc:0.9742 total_loss: 0.18597  loss:0.033158,stance loss: 0.0026172 
Train step: 3520 acc:0.97479 total_loss: 0.19311  loss:0.14778,stance loss: 0.090158 
Train step: 3530 acc:0.97384 total_loss: 0.19281  loss:0.4,stance loss: 0.33292 
Train step: 3540 acc:0.97212 total_loss: 0.20086  loss:0.69479,stance loss: 1.1419 
Train step: 3550 acc:0.97106 total_loss: 0.20177  loss:0.39128,stance loss: 0.27127 
Train step: 3560 acc:0.9717 total_loss: 0.20011  loss:0.027717,stance loss: 0.0070928 
Train step: 3570 acc:0.97115 total_loss: 0.20398  loss:0.067903,stance loss: 0.049577 
Train step: 3580 acc:0.97102 total_loss: 0.20667  loss:0.38927,stance loss: 0.43939 
Better F1! Saving model!
Saving model of best f1: 0.564662870322179
              precision    recall  f1-score   support

           0   0.680970  0.646018  0.663034       565
           1   0.564706  0.562500  0.563601       256
           2   0.430052  0.509202  0.466292       163

    accuracy                       0.601626       984
   macro avg   0.558576  0.572573  0.564309       984
weighted avg   0.609158  0.601626  0.604575       984

Test Acc: 0.6016260162601627 F1_ma:0.564662870322179
Train step: 3590 acc:0.97156 total_loss: 0.20347  loss:0.021486,stance loss: 0.0024204 
Train step: 3600 acc:0.97079 total_loss: 0.205  loss:0.13146,stance loss: 0.11371 
Train step: 3610 acc:0.97099 total_loss: 0.2052  loss:0.11517,stance loss: 0.036794 
Train step: 3620 acc:0.97118 total_loss: 0.2028  loss:0.079873,stance loss: 0.047347 
Train step: 3630 acc:0.97162 total_loss: 0.20403  loss:0.098718,stance loss: 0.084853 
Train step: 3640 acc:0.97071 total_loss: 0.20315  loss:0.47841,stance loss: 0.24472 
Training finished.


Reload the best model with best f1 0.564662870322179 from path test_outputs/bert-cross-topic/hc/2023-08-16 13-03-59/state_dict


              precision    recall  f1-score   support

           0   0.680970  0.646018  0.663034       565
           1   0.564706  0.562500  0.563601       256
           2   0.430052  0.509202  0.466292       163

    accuracy                       0.601626       984
   macro avg   0.558576  0.572573  0.564309       984
weighted avg   0.609158  0.601626  0.604575       984

Test Acc: 0.6016260162601627 F1_ma:0.564662870322179
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.564662870322179
acc: 0.6016260162601627, f1 :0.5643088411410743
classification report: 
              precision    recall  f1-score   support

         Con     0.6810    0.6460    0.6630       565
        None     0.5647    0.5625    0.5636       256
         Pro     0.4301    0.5092    0.4663       163

    accuracy                         0.6016       984
   macro avg     0.5586    0.5726    0.5643       984
weighted avg     0.6092    0.6016    0.6046       984

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 13-24-22', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 13-24-22
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.8073  loss:1.8073,stance loss: 1.173 
Train step: 10 acc:0.36932 total_loss: 1.7305  loss:1.586,stance loss: 1.0351 
Better F1! Saving model!
Saving model of best f1: 0.29465648854961835
              precision    recall  f1-score   support

           0   0.518121  0.683186  0.589313       565
           1   0.008368  0.007812  0.008081       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.394309       984
   macro avg   0.175496  0.230333  0.199131       984
weighted avg   0.299675  0.394309  0.340478       984

Test Acc: 0.3943089430894309 F1_ma:0.29465648854961835
Train step: 20 acc:0.42262 total_loss: 1.6946  loss:1.9069,stance loss: 1.7983 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 30 acc:0.42339 total_loss: 1.6932  loss:1.6902,stance loss: 1.3112 
Train step: 40 acc:0.4314 total_loss: 1.6921  loss:1.6116,stance loss: 1.153 
Train step: 50 acc:0.4326 total_loss: 1.6916  loss:1.7191,stance loss: 1.256 
Train step: 60 acc:0.44877 total_loss: 1.6763  loss:1.5388,stance loss: 1.0868 
Train step: 70 acc:0.45246 total_loss: 1.6686  loss:1.8271,stance loss: 1.3464 
Train step: 80 acc:0.45448 total_loss: 1.6678  loss:1.2042,stance loss: 0.56217 
Train step: 90 acc:0.45604 total_loss: 1.6637  loss:1.6454,stance loss: 1.0542 
Train step: 100 acc:0.46163 total_loss: 1.6596  loss:1.7648,stance loss: 1.3208 
Train step: 110 acc:0.46453 total_loss: 1.6556  loss:1.5084,stance loss: 1.1229 
Train step: 120 acc:0.46333 total_loss: 1.6527  loss:1.6174,stance loss: 1.1759 
Train step: 130 acc:0.47042 total_loss: 1.651  loss:1.4584,stance loss: 1.0594 
Train step: 140 acc:0.47473 total_loss: 1.6488  loss:1.5399,stance loss: 1.1641 
Train step: 150 acc:0.4793 total_loss: 1.6485  loss:1.5125,stance loss: 1.0975 
Train step: 160 acc:0.48447 total_loss: 1.6451  loss:1.5343,stance loss: 1.1518 
Better F1! Saving model!
Saving model of best f1: 0.36498708010335923
              precision    recall  f1-score   support

           0   0.574771  1.000000  0.729974       565
           1   1.000000  0.003906  0.007782       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.575203       984
   macro avg   0.524924  0.334635  0.245919       984
weighted avg   0.590189  0.575203  0.421166       984

Test Acc: 0.5752032520325203 F1_ma:0.36498708010335923
Train step: 170 acc:0.48538 total_loss: 1.6432  loss:1.4955,stance loss: 1.0987 
Train step: 180 acc:0.4893 total_loss: 1.6404  loss:1.7832,stance loss: 1.7433 
Better F1! Saving model!
Saving model of best f1: 0.36505867014341586
              precision    recall  f1-score   support

           0   0.577915  0.991150  0.730117       565
           1   0.600000  0.035156  0.066421       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.578252       984
   macro avg   0.392638  0.342102  0.265513       984
weighted avg   0.487929  0.578252  0.436504       984

Test Acc: 0.5782520325203252 F1_ma:0.36505867014341586
Train step: 190 acc:0.49247 total_loss: 1.635  loss:1.4089,stance loss: 1.0628 
Train step: 200 acc:0.49627 total_loss: 1.6314  loss:1.4918,stance loss: 1.1723 
Train step: 210 acc:0.49911 total_loss: 1.6332  loss:1.7301,stance loss: 1.6569 
Train step: 220 acc:0.49802 total_loss: 1.6324  loss:1.5494,stance loss: 1.1441 
Train step: 230 acc:0.49729 total_loss: 1.6339  loss:1.4036,stance loss: 1.0105 
Train step: 240 acc:0.49689 total_loss: 1.6333  loss:1.474,stance loss: 1.0763 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.50781 total_loss: 1.5323  loss:1.6732,stance loss: 1.2098 
Train step: 260 acc:0.47917 total_loss: 1.6124  loss:1.4786,stance loss: 1.0285 
Train step: 270 acc:0.52232 total_loss: 1.5799  loss:1.3224,stance loss: 0.9646 
Better F1! Saving model!
Saving model of best f1: 0.3656126482213439
              precision    recall  f1-score   support

           0   0.582371  0.982301  0.731225       565
           1   0.645161  0.078125  0.139373       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.584350       984
   macro avg   0.409178  0.353475  0.290199       984
weighted avg   0.502237  0.584350  0.456120       984

Test Acc: 0.584349593495935 F1_ma:0.3656126482213439
Train step: 280 acc:0.51316 total_loss: 1.593  loss:1.5078,stance loss: 1.0862 
Train step: 290 acc:0.51562 total_loss: 1.5929  loss:1.6484,stance loss: 1.6121 
Train step: 300 acc:0.52047 total_loss: 1.5765  loss:1.6447,stance loss: 1.2118 
Better F1! Saving model!
Saving model of best f1: 0.3673469387755102
              precision    recall  f1-score   support

           0   0.584906  0.987611  0.734694       565
           1   0.733333  0.085938  0.153846       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.589431       984
   macro avg   0.439413  0.357849  0.296180       984
weighted avg   0.526631  0.589431  0.461877       984

Test Acc: 0.5894308943089431 F1_ma:0.3673469387755102
Train step: 310 acc:0.52206 total_loss: 1.5666  loss:1.6166,stance loss: 1.283 
Train step: 320 acc:0.52404 total_loss: 1.563  loss:1.4495,stance loss: 1.0488 
Train step: 330 acc:0.52344 total_loss: 1.5623  loss:1.6184,stance loss: 1.0731 
Train step: 340 acc:0.52551 total_loss: 1.563  loss:1.5291,stance loss: 1.2411 
Train step: 350 acc:0.52373 total_loss: 1.5638  loss:1.5874,stance loss: 1.1293 
Train step: 360 acc:0.51854 total_loss: 1.571  loss:1.5931,stance loss: 1.2097 
Train step: 370 acc:0.521 total_loss: 1.5655  loss:1.5214,stance loss: 1.1181 
Train step: 380 acc:0.52219 total_loss: 1.5628  loss:1.4254,stance loss: 0.91367 
Train step: 390 acc:0.52069 total_loss: 1.5675  loss:1.3292,stance loss: 0.97278 
Train step: 400 acc:0.52255 total_loss: 1.5688  loss:1.7999,stance loss: 1.7368 
Train step: 410 acc:0.52641 total_loss: 1.566  loss:1.5917,stance loss: 1.1913 
Train step: 420 acc:0.52704 total_loss: 1.5648  loss:1.578,stance loss: 1.2166 
Train step: 430 acc:0.52892 total_loss: 1.5629  loss:1.7397,stance loss: 1.2956 
Train step: 440 acc:0.52967 total_loss: 1.5589  loss:1.5253,stance loss: 1.2171 
Train step: 450 acc:0.53365 total_loss: 1.5541  loss:1.4828,stance loss: 1.5456 
Train step: 460 acc:0.53383 total_loss: 1.5545  loss:1.4512,stance loss: 1.113 
Train step: 470 acc:0.53728 total_loss: 1.5505  loss:1.1459,stance loss: 0.79638 
Train step: 480 acc:0.5365 total_loss: 1.5508  loss:1.5604,stance loss: 1.1428 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.5125 total_loss: 1.5759  loss:1.6113,stance loss: 1.2849 
Train step: 500 acc:0.5875 total_loss: 1.4269  loss:1.0272,stance loss: 0.75182 
Train step: 510 acc:0.5975 total_loss: 1.4504  loss:1.506,stance loss: 1.0495 
Train step: 520 acc:0.57857 total_loss: 1.5008  loss:1.8075,stance loss: 1.8197 
Train step: 530 acc:0.57917 total_loss: 1.5096  loss:1.8341,stance loss: 1.7508 
Train step: 540 acc:0.57386 total_loss: 1.5039  loss:1.6585,stance loss: 1.1335 
Train step: 550 acc:0.57788 total_loss: 1.4974  loss:1.2764,stance loss: 0.92198 
Train step: 560 acc:0.58417 total_loss: 1.4922  loss:1.304,stance loss: 0.84454 
Train step: 570 acc:0.58603 total_loss: 1.4876  loss:1.5108,stance loss: 1.2027 
Train step: 580 acc:0.59276 total_loss: 1.4785  loss:1.3894,stance loss: 1.004 
Train step: 590 acc:0.58929 total_loss: 1.4821  loss:1.3109,stance loss: 0.95576 
Train step: 600 acc:0.59076 total_loss: 1.4755  loss:1.2926,stance loss: 1.0294 
Train step: 610 acc:0.5965 total_loss: 1.4678  loss:1.5022,stance loss: 1.1547 
Train step: 620 acc:0.59537 total_loss: 1.4678  loss:1.6929,stance loss: 1.1973 
Train step: 630 acc:0.59483 total_loss: 1.4634  loss:1.2731,stance loss: 1.0021 
Train step: 640 acc:0.59395 total_loss: 1.4637  loss:1.5484,stance loss: 1.1314 
Train step: 650 acc:0.58902 total_loss: 1.4644  loss:1.1358,stance loss: 0.89728 
Train step: 660 acc:0.59393 total_loss: 1.4564  loss:1.1595,stance loss: 0.93201 
Train step: 670 acc:0.59426 total_loss: 1.4545  loss:1.3562,stance loss: 0.99701 
Train step: 680 acc:0.59231 total_loss: 1.4534  loss:1.5428,stance loss: 1.0314 
Train step: 690 acc:0.59207 total_loss: 1.4522  loss:1.4176,stance loss: 1.4972 
Train step: 700 acc:0.59215 total_loss: 1.4457  loss:1.3233,stance loss: 1.0185 
Train step: 710 acc:0.59028 total_loss: 1.443  loss:1.0846,stance loss: 0.71649 
Train step: 720 acc:0.59043 total_loss: 1.4432  loss:1.1928,stance loss: 0.96563 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.75 total_loss: 1.1381  loss:1.1633,stance loss: 1.0856 
Train step: 740 acc:0.64062 total_loss: 1.3162  loss:1.798,stance loss: 1.3727 
Train step: 750 acc:0.61364 total_loss: 1.3281  loss:1.1871,stance loss: 0.96299 
Train step: 760 acc:0.63477 total_loss: 1.3188  loss:1.451,stance loss: 1.2463 
Better F1! Saving model!
Saving model of best f1: 0.37101063829787234
              precision    recall  f1-score   support

           0   0.594249  0.987611  0.742021       565
           1   0.777778  0.136719  0.232558       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.602642       984
   macro avg   0.457342  0.374776  0.324860       984
weighted avg   0.543559  0.602642  0.486562       984

Test Acc: 0.6026422764227642 F1_ma:0.37101063829787234
Train step: 770 acc:0.64881 total_loss: 1.3106  loss:1.4246,stance loss: 1.1631 
Train step: 780 acc:0.63702 total_loss: 1.3241  loss:1.1785,stance loss: 0.93078 
Train step: 790 acc:0.63004 total_loss: 1.3494  loss:1.3387,stance loss: 1.019 
Better F1! Saving model!
Saving model of best f1: 0.4050248816603957
              precision    recall  f1-score   support

           0   0.693069  0.619469  0.654206       565
           1   0.530414  0.851562  0.653673       256
           2   0.264706  0.110429  0.155844       163

    accuracy                       0.595528       984
   macro avg   0.496063  0.527154  0.487908       984
weighted avg   0.579794  0.595528  0.571513       984

Test Acc: 0.5955284552845529 F1_ma:0.4050248816603957
Train step: 800 acc:0.63715 total_loss: 1.3394  loss:0.927,stance loss: 0.63428 
Train step: 810 acc:0.62805 total_loss: 1.3528  loss:0.89927,stance loss: 0.55087 
Train step: 820 acc:0.63247 total_loss: 1.3485  loss:1.7556,stance loss: 1.7843 
Train step: 830 acc:0.6348 total_loss: 1.3335  loss:1.4152,stance loss: 1.1359 
Train step: 840 acc:0.63504 total_loss: 1.3302  loss:1.2239,stance loss: 0.97522 
Train step: 850 acc:0.63781 total_loss: 1.3245  loss:1.096,stance loss: 0.91034 
Train step: 860 acc:0.64062 total_loss: 1.319  loss:1.3415,stance loss: 1.1333 
Train step: 870 acc:0.63996 total_loss: 1.3116  loss:1.2202,stance loss: 0.97141 
Train step: 880 acc:0.64145 total_loss: 1.3048  loss:1.063,stance loss: 0.94432 
Train step: 890 acc:0.63735 total_loss: 1.3084  loss:1.2535,stance loss: 0.90692 
Better F1! Saving model!
Saving model of best f1: 0.4668858297376892
              precision    recall  f1-score   support

           0   0.642468  0.626549  0.634409       565
           1   0.531915  0.585938  0.557621       256
           2   0.311258  0.288344  0.299363       163

    accuracy                       0.559959       984
   macro avg   0.495214  0.500277  0.497131       984
weighted avg   0.558841  0.559959  0.558931       984

Test Acc: 0.5599593495934959 F1_ma:0.4668858297376892
Train step: 900 acc:0.64172 total_loss: 1.3025  loss:1.2234,stance loss: 0.97536 
Train step: 910 acc:0.64286 total_loss: 1.2999  loss:1.6159,stance loss: 1.1793 
Train step: 920 acc:0.639 total_loss: 1.3011  loss:1.5579,stance loss: 1.2687 
Train step: 930 acc:0.64016 total_loss: 1.2996  loss:1.1756,stance loss: 0.91628 
Train step: 940 acc:0.64151 total_loss: 1.2978  loss:1.1058,stance loss: 0.89466 
Train step: 950 acc:0.64302 total_loss: 1.2914  loss:0.99222,stance loss: 0.85182 
Train step: 960 acc:0.64467 total_loss: 1.2876  loss:1.0376,stance loss: 0.81816 
Train step: 970 acc:0.64411 total_loss: 1.2904  loss:1.5155,stance loss: 1.334 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.65972 total_loss: 1.2416  loss:0.87854,stance loss: 0.68604 
Train step: 990 acc:0.6875 total_loss: 1.1555  loss:1.3712,stance loss: 1.021 
Better F1! Saving model!
Saving model of best f1: 0.47499090464302296
              precision    recall  f1-score   support

           0   0.734234  0.576991  0.646184       565
           1   0.512876  0.933594  0.662050       256
           2   0.486486  0.220859  0.303797       163

    accuracy                       0.610772       984
   macro avg   0.577865  0.577148  0.537344       984
weighted avg   0.635605  0.610772  0.593595       984

Test Acc: 0.6107723577235772 F1_ma:0.47499090464302296
Train step: 1000 acc:0.6875 total_loss: 1.187  loss:1.5381,stance loss: 1.1839 
Train step: 1010 acc:0.6859 total_loss: 1.1753  loss:0.87766,stance loss: 0.70975 
Train step: 1020 acc:0.68112 total_loss: 1.1924  loss:1.21,stance loss: 0.96398 
Train step: 1030 acc:0.68432 total_loss: 1.1899  loss:1.1932,stance loss: 1.1081 
Better F1! Saving model!
Saving model of best f1: 0.5017885220125786
              precision    recall  f1-score   support

           0   0.726582  0.507965  0.597917       565
           1   0.533537  0.683594  0.599315       256
           2   0.329502  0.527607  0.405660       163

    accuracy                       0.556911       984
   macro avg   0.529874  0.573055  0.534297       984
weighted avg   0.610582  0.556911  0.566433       984

Test Acc: 0.556910569105691 F1_ma:0.5017885220125786
Train step: 1040 acc:0.68388 total_loss: 1.198  loss:1.6402,stance loss: 1.6267 
Train step: 1050 acc:0.67959 total_loss: 1.2082  loss:1.3368,stance loss: 0.92795 
Train step: 1060 acc:0.68469 total_loss: 1.1928  loss:1.26,stance loss: 0.89124 
Train step: 1070 acc:0.67866 total_loss: 1.2111  loss:1.4691,stance loss: 1.2112 
Train step: 1080 acc:0.67833 total_loss: 1.2083  loss:1.1819,stance loss: 0.97125 
Train step: 1090 acc:0.67489 total_loss: 1.2161  loss:1.0992,stance loss: 0.94016 
Train step: 1100 acc:0.67781 total_loss: 1.2038  loss:1.1824,stance loss: 0.9352 
Train step: 1110 acc:0.68165 total_loss: 1.1901  loss:1.4159,stance loss: 1.0075 
Train step: 1120 acc:0.68121 total_loss: 1.1844  loss:0.86877,stance loss: 0.69013 
Train step: 1130 acc:0.68239 total_loss: 1.1813  loss:1.66,stance loss: 1.2411 
Train step: 1140 acc:0.68269 total_loss: 1.182  loss:1.2408,stance loss: 1.018 
Train step: 1150 acc:0.68366 total_loss: 1.1842  loss:1.2199,stance loss: 0.95584 
Train step: 1160 acc:0.68452 total_loss: 1.1804  loss:1.4476,stance loss: 1.1139 
Better F1! Saving model!
Saving model of best f1: 0.5046376299419885
              precision    recall  f1-score   support

           0   0.781646  0.437168  0.560726       565
           1   0.519912  0.917969  0.663842       256
           2   0.393519  0.521472  0.448549       163

    accuracy                       0.576220       984
   macro avg   0.565025  0.625536  0.557706       984
weighted avg   0.649259  0.576220  0.568971       984

Test Acc: 0.5762195121951219 F1_ma:0.5046376299419885
Train step: 1170 acc:0.68499 total_loss: 1.1772  loss:0.87688,stance loss: 0.70934 
Train step: 1180 acc:0.68541 total_loss: 1.1751  loss:1.2811,stance loss: 1.062 
Train step: 1190 acc:0.6855 total_loss: 1.1718  loss:1.3912,stance loss: 1.0173 
Train step: 1200 acc:0.68532 total_loss: 1.1685  loss:0.74115,stance loss: 0.62448 
Train step: 1210 acc:0.68515 total_loss: 1.1704  loss:0.92298,stance loss: 0.75947 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.6875 total_loss: 1.1381  loss:1.4964,stance loss: 1.6096 
Train step: 1230 acc:0.75391 total_loss: 1.0373  loss:0.65762,stance loss: 0.58816 
Better F1! Saving model!
Saving model of best f1: 0.5271332782217323
              precision    recall  f1-score   support

           0   0.679862  0.699115  0.689354       565
           1   0.548043  0.601562  0.573557       256
           2   0.426230  0.319018  0.364912       163

    accuracy                       0.610772       984
   macro avg   0.551378  0.539899  0.542608       984
weighted avg   0.603553  0.610772  0.605484       984

Test Acc: 0.6107723577235772 F1_ma:0.5271332782217323
Train step: 1240 acc:0.76202 total_loss: 1.0237  loss:1.1871,stance loss: 1.0252 
Train step: 1250 acc:0.76215 total_loss: 1.0268  loss:1.2735,stance loss: 0.86436 
Train step: 1260 acc:0.75408 total_loss: 1.0367  loss:0.6027,stance loss: 0.24 
Train step: 1270 acc:0.74665 total_loss: 1.0235  loss:0.8245,stance loss: 0.65034 
Train step: 1280 acc:0.73674 total_loss: 1.0289  loss:1.1212,stance loss: 0.7495 
Train step: 1290 acc:0.73931 total_loss: 1.0169  loss:0.99757,stance loss: 0.82244 
Train step: 1300 acc:0.7391 total_loss: 1.024  loss:1.5255,stance loss: 1.6133 
Train step: 1310 acc:0.73633 total_loss: 1.0437  loss:1.1237,stance loss: 0.80535 
Train step: 1320 acc:0.73762 total_loss: 1.0361  loss:1.0107,stance loss: 0.84536 
Better F1! Saving model!
Saving model of best f1: 0.5339375674703131
              precision    recall  f1-score   support

           0   0.797583  0.467257  0.589286       565
           1   0.525060  0.859375  0.651852       256
           2   0.405983  0.582822  0.478589       163

    accuracy                       0.588415       984
   macro avg   0.576209  0.636485  0.573242       984
weighted avg   0.661814  0.588415  0.587226       984

Test Acc: 0.5884146341463414 F1_ma:0.5339375674703131
Train step: 1330 acc:0.73815 total_loss: 1.0338  loss:0.78383,stance loss: 0.53283 
Train step: 1340 acc:0.73859 total_loss: 1.0449  loss:1.0392,stance loss: 0.9269 
Train step: 1350 acc:0.73621 total_loss: 1.0437  loss:0.79625,stance loss: 0.52629 
Train step: 1360 acc:0.73202 total_loss: 1.046  loss:1.2331,stance loss: 0.81769 
Train step: 1370 acc:0.73357 total_loss: 1.0483  loss:0.86513,stance loss: 0.6652 
Better F1! Saving model!
Saving model of best f1: 0.5343106004582762
              precision    recall  f1-score   support

           0   0.755869  0.569912  0.649849       565
           1   0.522523  0.906250  0.662857       256
           2   0.508772  0.355828  0.418773       163

    accuracy                       0.621951       984
   macro avg   0.595721  0.610663  0.577159       984
weighted avg   0.654229  0.621951  0.614955       984

Test Acc: 0.6219512195121951 F1_ma:0.5343106004582762
Train step: 1380 acc:0.7323 total_loss: 1.0499  loss:1.2547,stance loss: 1.0908 
Better F1! Saving model!
Saving model of best f1: 0.5471830451350408
              precision    recall  f1-score   support

           0   0.748837  0.569912  0.647236       565
           1   0.520725  0.785156  0.626168       256
           2   0.440476  0.453988  0.447130       163

    accuracy                       0.606707       984
   macro avg   0.570013  0.603018  0.573511       984
weighted avg   0.638411  0.606707  0.608607       984

Test Acc: 0.6067073170731707 F1_ma:0.5471830451350408
Train step: 1390 acc:0.73153 total_loss: 1.0554  loss:0.95233,stance loss: 0.71402 
Train step: 1400 acc:0.73085 total_loss: 1.055  loss:0.88934,stance loss: 0.6771 
Train step: 1410 acc:0.73182 total_loss: 1.0469  loss:0.70369,stance loss: 0.57344 
Better F1! Saving model!
Saving model of best f1: 0.5528016598500567
              precision    recall  f1-score   support

           0   0.782258  0.515044  0.621131       565
           1   0.518764  0.917969  0.662906       256
           2   0.490566  0.478528  0.484472       163

    accuracy                       0.613821       984
   macro avg   0.597196  0.637180  0.589503       984
weighted avg   0.665388  0.613821  0.609362       984

Test Acc: 0.6138211382113821 F1_ma:0.5528016598500567
Train step: 1420 acc:0.7321 total_loss: 1.0458  loss:1.2518,stance loss: 1.5794 
Better F1! Saving model!
Saving model of best f1: 0.5542302955665024
              precision    recall  f1-score   support

           0   0.774105  0.497345  0.605603       565
           1   0.513825  0.871094  0.646377       256
           2   0.470588  0.539877  0.502857       163

    accuracy                       0.601626       984
   macro avg   0.586173  0.636105  0.584946       984
weighted avg   0.656112  0.601626  0.599191       984

Test Acc: 0.6016260162601627 F1_ma:0.5542302955665024
Train step: 1430 acc:0.73003 total_loss: 1.0529  loss:0.98272,stance loss: 0.76507 
Train step: 1440 acc:0.72843 total_loss: 1.0609  loss:1.3378,stance loss: 0.90483 
Train step: 1450 acc:0.72669 total_loss: 1.0668  loss:1.2018,stance loss: 0.92857 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.6875 total_loss: 0.87091  loss:0.7562,stance loss: 0.53304 
Better F1! Saving model!
Saving model of best f1: 0.5557340831492268
              precision    recall  f1-score   support

           0   0.731707  0.530973  0.615385       565
           1   0.531073  0.734375  0.616393       256
           2   0.431818  0.582822  0.496084       163

    accuracy                       0.592480       984
   macro avg   0.564866  0.616057  0.575954       984
weighted avg   0.629833  0.592480  0.595885       984

Test Acc: 0.592479674796748 F1_ma:0.5557340831492268
Train step: 1470 acc:0.72115 total_loss: 1.0157  loss:0.98517,stance loss: 0.82269 
Train step: 1480 acc:0.75543 total_loss: 0.98316  loss:0.74157,stance loss: 0.53753 
Train step: 1490 acc:0.76894 total_loss: 0.96947  loss:1.393,stance loss: 1.5153 
Train step: 1500 acc:0.77035 total_loss: 0.95543  loss:0.83006,stance loss: 0.64454 
Train step: 1510 acc:0.76061 total_loss: 0.97935  loss:1.0148,stance loss: 0.79405 
Train step: 1520 acc:0.76587 total_loss: 0.965  loss:0.7151,stance loss: 0.54338 
Train step: 1530 acc:0.76199 total_loss: 0.96454  loss:0.69982,stance loss: 0.5312 
Train step: 1540 acc:0.76732 total_loss: 0.95629  loss:0.88957,stance loss: 0.64218 
Train step: 1550 acc:0.7668 total_loss: 0.95755  loss:0.73834,stance loss: 0.61964 
Train step: 1560 acc:0.76517 total_loss: 0.95955  loss:1.1121,stance loss: 1.0252 
Train step: 1570 acc:0.7677 total_loss: 0.96077  loss:1.1583,stance loss: 1.1177 
Train step: 1580 acc:0.75711 total_loss: 0.98496  loss:0.70455,stance loss: 0.49847 
Train step: 1590 acc:0.75517 total_loss: 0.98775  loss:0.98853,stance loss: 0.81288 
Train step: 1600 acc:0.75175 total_loss: 0.99237  loss:0.85138,stance loss: 0.63018 
Train step: 1610 acc:0.75204 total_loss: 0.9944  loss:1.1575,stance loss: 0.95307 
Train step: 1620 acc:0.7546 total_loss: 0.99372  loss:0.76274,stance loss: 0.62088 
Train step: 1630 acc:0.7547 total_loss: 0.99254  loss:1.0526,stance loss: 0.78721 
Train step: 1640 acc:0.75615 total_loss: 0.99339  loss:1.0168,stance loss: 0.69793 
Train step: 1650 acc:0.75745 total_loss: 0.98615  loss:0.98378,stance loss: 0.74554 
Train step: 1660 acc:0.75893 total_loss: 0.98225  loss:0.8675,stance loss: 0.75807 
Train step: 1670 acc:0.75998 total_loss: 0.98206  loss:0.90428,stance loss: 0.67909 
Train step: 1680 acc:0.76037 total_loss: 0.97741  loss:1.0627,stance loss: 0.81908 
Train step: 1690 acc:0.76073 total_loss: 0.97706  loss:0.95867,stance loss: 0.72474 
Train step: 1700 acc:0.76222 total_loss: 0.97331  loss:0.60625,stance loss: 0.55765 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.78125 total_loss: 0.93536  loss:0.81307,stance loss: 0.73009 
Train step: 1720 acc:0.80937 total_loss: 0.84486  loss:0.44112,stance loss: 0.27856 
Train step: 1730 acc:0.80208 total_loss: 0.85961  loss:0.79649,stance loss: 0.61641 
Train step: 1740 acc:0.80937 total_loss: 0.84215  loss:0.8207,stance loss: 0.71955 
Train step: 1750 acc:0.81625 total_loss: 0.83529  loss:0.95493,stance loss: 0.85964 
Train step: 1760 acc:0.81563 total_loss: 0.82058  loss:0.80309,stance loss: 0.67443 
Train step: 1770 acc:0.82143 total_loss: 0.7958  loss:0.85937,stance loss: 0.71192 
Train step: 1780 acc:0.82031 total_loss: 0.79536  loss:1.2259,stance loss: 1.5106 
Train step: 1790 acc:0.81597 total_loss: 0.80407  loss:0.99385,stance loss: 0.74658 
Train step: 1800 acc:0.82 total_loss: 0.79329  loss:0.64505,stance loss: 0.48291 
Train step: 1810 acc:0.8142 total_loss: 0.8047  loss:0.87643,stance loss: 1.0797 
Train step: 1820 acc:0.8125 total_loss: 0.80619  loss:1.3699,stance loss: 0.90574 
Train step: 1830 acc:0.80913 total_loss: 0.81155  loss:1.0288,stance loss: 0.83694 
Train step: 1840 acc:0.80937 total_loss: 0.81585  loss:0.53958,stance loss: 0.43139 
Train step: 1850 acc:0.80667 total_loss: 0.82536  loss:0.80825,stance loss: 0.56445 
Train step: 1860 acc:0.80547 total_loss: 0.82851  loss:1.0761,stance loss: 0.9058 
Train step: 1870 acc:0.80735 total_loss: 0.82457  loss:0.2619,stance loss: 0.1528 
Train step: 1880 acc:0.80417 total_loss: 0.82938  loss:0.77751,stance loss: 0.65921 
Train step: 1890 acc:0.80428 total_loss: 0.82617  loss:0.51669,stance loss: 0.35792 
Train step: 1900 acc:0.8025 total_loss: 0.83357  loss:1.7514,stance loss: 1.4304 
Train step: 1910 acc:0.80208 total_loss: 0.83674  loss:1.046,stance loss: 0.84459 
Train step: 1920 acc:0.80114 total_loss: 0.84062  loss:1.2139,stance loss: 1.5056 
Train step: 1930 acc:0.80163 total_loss: 0.83855  loss:0.75604,stance loss: 0.65712 
Train step: 1940 acc:0.80182 total_loss: 0.83727  loss:0.68142,stance loss: 0.44277 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.83929 total_loss: 0.70472  loss:0.65098,stance loss: 0.44667 
Train step: 1960 acc:0.84191 total_loss: 0.73949  loss:0.49436,stance loss: 0.46168 
Train step: 1970 acc:0.84722 total_loss: 0.748  loss:0.74575,stance loss: 0.4155 
Train step: 1980 acc:0.84966 total_loss: 0.7269  loss:0.85468,stance loss: 1.0954 
Train step: 1990 acc:0.84441 total_loss: 0.74374  loss:0.6778,stance loss: 0.53226 
Train step: 2000 acc:0.8443 total_loss: 0.73753  loss:0.52314,stance loss: 0.35367 
Train step: 2010 acc:0.85168 total_loss: 0.71965  loss:0.58877,stance loss: 0.45858 
Train step: 2020 acc:0.85633 total_loss: 0.71389  loss:0.43099,stance loss: 0.37075 
Train step: 2030 acc:0.8556 total_loss: 0.71141  loss:0.34019,stance loss: 0.20809 
Train step: 2040 acc:0.85245 total_loss: 0.71338  loss:0.55665,stance loss: 0.46567 
Train step: 2050 acc:0.85105 total_loss: 0.71246  loss:0.90065,stance loss: 0.84492 
Train step: 2060 acc:0.84882 total_loss: 0.70202  loss:0.44204,stance loss: 0.31347 
Train step: 2070 acc:0.84843 total_loss: 0.70663  loss:0.53241,stance loss: 0.4197 
Train step: 2080 acc:0.84854 total_loss: 0.7064  loss:0.53192,stance loss: 0.41901 
Train step: 2090 acc:0.84821 total_loss: 0.71387  loss:0.51486,stance loss: 0.45703 
Train step: 2100 acc:0.84912 total_loss: 0.71638  loss:0.7974,stance loss: 0.63463 
Train step: 2110 acc:0.84319 total_loss: 0.72633  loss:0.8148,stance loss: 0.81871 
Train step: 2120 acc:0.84428 total_loss: 0.72011  loss:0.16383,stance loss: 0.063207 
Train step: 2130 acc:0.84492 total_loss: 0.71381  loss:0.51618,stance loss: 0.37042 
Train step: 2140 acc:0.84549 total_loss: 0.71227  loss:0.54581,stance loss: 0.41915 
Train step: 2150 acc:0.84481 total_loss: 0.713  loss:0.46678,stance loss: 0.3702 
Train step: 2160 acc:0.8462 total_loss: 0.71163  loss:0.30049,stance loss: 0.17968 
Train step: 2170 acc:0.84609 total_loss: 0.7071  loss:0.32828,stance loss: 0.24716 
Train step: 2180 acc:0.8452 total_loss: 0.71315  loss:1.5131,stance loss: 1.0838 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.875 total_loss: 0.59474  loss:0.49299,stance loss: 0.42872 
Train step: 2200 acc:0.875 total_loss: 0.73455  loss:0.53323,stance loss: 0.5735 
Train step: 2210 acc:0.8724 total_loss: 0.67745  loss:0.36559,stance loss: 0.26202 
Train step: 2220 acc:0.87868 total_loss: 0.62932  loss:0.49469,stance loss: 0.54444 
Train step: 2230 acc:0.87358 total_loss: 0.653  loss:0.98227,stance loss: 1.217 
Train step: 2240 acc:0.87153 total_loss: 0.66868  loss:0.2577,stance loss: 0.18228 
Train step: 2250 acc:0.87305 total_loss: 0.64684  loss:0.37908,stance loss: 0.29181 
Train step: 2260 acc:0.875 total_loss: 0.63447  loss:0.22959,stance loss: 0.081731 
Train step: 2270 acc:0.87723 total_loss: 0.63086  loss:0.30454,stance loss: 0.18031 
Train step: 2280 acc:0.87899 total_loss: 0.6278  loss:0.99958,stance loss: 0.89238 
Train step: 2290 acc:0.88281 total_loss: 0.61387  loss:0.47304,stance loss: 0.42367 
Train step: 2300 acc:0.88432 total_loss: 0.61135  loss:0.95816,stance loss: 1.2374 
Train step: 2310 acc:0.88206 total_loss: 0.61242  loss:0.59615,stance loss: 0.65293 
Train step: 2320 acc:0.87547 total_loss: 0.63191  loss:0.56644,stance loss: 0.54468 
Train step: 2330 acc:0.87457 total_loss: 0.63416  loss:0.86821,stance loss: 0.73724 
Train step: 2340 acc:0.875 total_loss: 0.63252  loss:0.483,stance loss: 0.3861 
Train step: 2350 acc:0.87424 total_loss: 0.63301  loss:0.65526,stance loss: 0.53526 
Train step: 2360 acc:0.875 total_loss: 0.63145  loss:0.17406,stance loss: 0.093745 
Train step: 2370 acc:0.8733 total_loss: 0.62693  loss:0.79649,stance loss: 1.103 
Train step: 2380 acc:0.87403 total_loss: 0.62719  loss:0.34932,stance loss: 0.30685 
Train step: 2390 acc:0.87347 total_loss: 0.62896  loss:0.48131,stance loss: 0.26711 
Train step: 2400 acc:0.87558 total_loss: 0.61651  loss:0.43593,stance loss: 0.35338 
Train step: 2410 acc:0.87584 total_loss: 0.61203  loss:0.17834,stance loss: 0.14412 
Train step: 2420 acc:0.87393 total_loss: 0.6156  loss:0.75347,stance loss: 0.60097 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.26679  loss:0.26679,stance loss: 0.18264 
Train step: 2440 acc:0.89205 total_loss: 0.4887  loss:0.52694,stance loss: 0.47528 
Train step: 2450 acc:0.90476 total_loss: 0.43908  loss:0.35174,stance loss: 0.30999 
Train step: 2460 acc:0.90726 total_loss: 0.44594  loss:1.0465,stance loss: 0.94613 
Train step: 2470 acc:0.90396 total_loss: 0.46957  loss:1.1941,stance loss: 1.5055 
Train step: 2480 acc:0.90931 total_loss: 0.47328  loss:0.37928,stance loss: 0.32285 
Train step: 2490 acc:0.89754 total_loss: 0.51528  loss:0.82059,stance loss: 0.80614 
Better F1! Saving model!
Saving model of best f1: 0.5638821215768
              precision    recall  f1-score   support

           0   0.689139  0.651327  0.669700       565
           1   0.534653  0.632812  0.579606       256
           2   0.482993  0.435583  0.458065       163

    accuracy                       0.610772       984
   macro avg   0.568928  0.573241  0.569124       984
weighted avg   0.614799  0.610772  0.611203       984

Test Acc: 0.6107723577235772 F1_ma:0.5638821215768
Train step: 2500 acc:0.89613 total_loss: 0.51655  loss:0.36125,stance loss: 0.29029 
Train step: 2510 acc:0.89429 total_loss: 0.54397  loss:0.91509,stance loss: 1.0559 
Train step: 2520 acc:0.89492 total_loss: 0.53685  loss:0.75598,stance loss: 0.55376 
Train step: 2530 acc:0.89604 total_loss: 0.52967  loss:0.36468,stance loss: 0.38581 
Train step: 2540 acc:0.89865 total_loss: 0.51767  loss:0.26622,stance loss: 0.20916 
Train step: 2550 acc:0.89721 total_loss: 0.51494  loss:0.47621,stance loss: 0.42774 
Train step: 2560 acc:0.89933 total_loss: 0.51032  loss:0.38965,stance loss: 0.35289 
Train step: 2570 acc:0.90248 total_loss: 0.49549  loss:0.50123,stance loss: 0.48422 
Train step: 2580 acc:0.90232 total_loss: 0.49603  loss:0.56226,stance loss: 1.0093 
Train step: 2590 acc:0.9014 total_loss: 0.50036  loss:0.85193,stance loss: 0.69066 
Train step: 2600 acc:0.90095 total_loss: 0.50169  loss:0.60212,stance loss: 0.52559 
Train step: 2610 acc:0.89883 total_loss: 0.51346  loss:0.45603,stance loss: 0.22402 
Train step: 2620 acc:0.89823 total_loss: 0.51213  loss:0.13555,stance loss: 0.063799 
Train step: 2630 acc:0.89956 total_loss: 0.51227  loss:1.1707,stance loss: 0.82576 
Train step: 2640 acc:0.89899 total_loss: 0.51423  loss:0.48019,stance loss: 0.4197 
Train step: 2650 acc:0.9013 total_loss: 0.51035  loss:0.69258,stance loss: 0.71724 
Train step: 2660 acc:0.90179 total_loss: 0.50859  loss:0.32868,stance loss: 0.23315 
Train step: 2670 acc:0.90171 total_loss: 0.51307  loss:1.0443,stance loss: 0.73559 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.94531 total_loss: 0.32908  loss:0.89446,stance loss: 0.77856 
Train step: 2690 acc:0.92361 total_loss: 0.35774  loss:0.6303,stance loss: 0.55435 
Train step: 2700 acc:0.92857 total_loss: 0.34021  loss:0.54701,stance loss: 0.48042 
Train step: 2710 acc:0.93914 total_loss: 0.32469  loss:0.079369,stance loss: 0.03292 
Train step: 2720 acc:0.93229 total_loss: 0.36082  loss:0.54809,stance loss: 0.49674 
Train step: 2730 acc:0.93103 total_loss: 0.36163  loss:0.41407,stance loss: 0.28069 
Train step: 2740 acc:0.93199 total_loss: 0.37425  loss:0.48367,stance loss: 0.47508 
Train step: 2750 acc:0.92949 total_loss: 0.37613  loss:0.33069,stance loss: 0.1093 
Train step: 2760 acc:0.93253 total_loss: 0.36668  loss:0.3914,stance loss: 0.47203 
Train step: 2770 acc:0.92985 total_loss: 0.37278  loss:0.67088,stance loss: 1.0245 
Train step: 2780 acc:0.92708 total_loss: 0.37849  loss:0.32616,stance loss: 0.34183 
Train step: 2790 acc:0.9285 total_loss: 0.37455  loss:0.6314,stance loss: 0.57434 
Train step: 2800 acc:0.92773 total_loss: 0.38303  loss:1.1914,stance loss: 1.4517 
Train step: 2810 acc:0.92708 total_loss: 0.39527  loss:0.56469,stance loss: 0.5497 
Train step: 2820 acc:0.92652 total_loss: 0.3936  loss:0.17816,stance loss: 0.13143 
Train step: 2830 acc:0.92642 total_loss: 0.39769  loss:0.098643,stance loss: 0.061521 
Train step: 2840 acc:0.92671 total_loss: 0.39689  loss:0.27194,stance loss: 0.2345 
Train step: 2850 acc:0.92662 total_loss: 0.39807  loss:0.8077,stance loss: 0.736 
Train step: 2860 acc:0.92786 total_loss: 0.39374  loss:0.61364,stance loss: 0.42458 
Train step: 2870 acc:0.92866 total_loss: 0.39318  loss:0.10952,stance loss: 0.064474 
Train step: 2880 acc:0.92969 total_loss: 0.38932  loss:0.82235,stance loss: 0.5231 
Train step: 2890 acc:0.92947 total_loss: 0.39095  loss:0.28806,stance loss: 0.26537 
Train step: 2900 acc:0.92763 total_loss: 0.40305  loss:1.4736,stance loss: 1.3611 
Train step: 2910 acc:0.92857 total_loss: 0.40098  loss:0.23926,stance loss: 0.26968 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.875 total_loss: 0.62036  loss:1.3872,stance loss: 1.3365 
Train step: 2930 acc:0.92083 total_loss: 0.36123  loss:0.32364,stance loss: 0.21623 
Train step: 2940 acc:0.92 total_loss: 0.36114  loss:0.26862,stance loss: 0.21753 
Train step: 2950 acc:0.925 total_loss: 0.34842  loss:0.25661,stance loss: 0.1868 
Train step: 2960 acc:0.92778 total_loss: 0.37113  loss:0.7864,stance loss: 1.0372 
Train step: 2970 acc:0.93409 total_loss: 0.34152  loss:0.30453,stance loss: 0.32515 
Train step: 2980 acc:0.9375 total_loss: 0.34616  loss:0.37092,stance loss: 0.3334 
Train step: 2990 acc:0.9375 total_loss: 0.35673  loss:0.76348,stance loss: 1.1586 
Train step: 3000 acc:0.93897 total_loss: 0.3655  loss:0.28319,stance loss: 0.14322 
Train step: 3010 acc:0.93882 total_loss: 0.3512  loss:0.83689,stance loss: 1.2906 
Train step: 3020 acc:0.94048 total_loss: 0.34301  loss:0.51865,stance loss: 0.25055 
Train step: 3030 acc:0.9413 total_loss: 0.33349  loss:0.59397,stance loss: 0.42079 
Train step: 3040 acc:0.9415 total_loss: 0.32899  loss:0.36699,stance loss: 0.2979 
Train step: 3050 acc:0.94259 total_loss: 0.32381  loss:0.37919,stance loss: 0.34134 
Train step: 3060 acc:0.94224 total_loss: 0.32476  loss:0.10881,stance loss: 0.017117 
Train step: 3070 acc:0.94274 total_loss: 0.32509  loss:0.47516,stance loss: 0.28975 
Train step: 3080 acc:0.94129 total_loss: 0.32561  loss:0.67756,stance loss: 0.28374 
Train step: 3090 acc:0.94071 total_loss: 0.32796  loss:0.096379,stance loss: 0.018693 
Train step: 3100 acc:0.94257 total_loss: 0.32112  loss:0.30079,stance loss: 0.29457 
Train step: 3110 acc:0.94135 total_loss: 0.3223  loss:0.73455,stance loss: 0.64007 
Train step: 3120 acc:0.94207 total_loss: 0.32726  loss:0.69603,stance loss: 0.69246 
Train step: 3130 acc:0.94273 total_loss: 0.32257  loss:0.27839,stance loss: 0.22709 
Train step: 3140 acc:0.94361 total_loss: 0.3263  loss:0.15194,stance loss: 0.12517 
Train step: 3150 acc:0.94468 total_loss: 0.33299  loss:0.091101,stance loss: 0.050792 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.12416  loss:0.15245,stance loss: 0.15513 
Train step: 3170 acc:0.97396 total_loss: 0.25172  loss:0.091061,stance loss: 0.048715 
Train step: 3180 acc:0.96875 total_loss: 0.24066  loss:0.2051,stance loss: 0.1758 
Train step: 3190 acc:0.96875 total_loss: 0.23393  loss:0.20409,stance loss: 0.085446 
Train step: 3200 acc:0.96577 total_loss: 0.22807  loss:0.11168,stance loss: 0.043095 
Train step: 3210 acc:0.96394 total_loss: 0.22963  loss:0.18343,stance loss: 0.12377 
Train step: 3220 acc:0.96169 total_loss: 0.24052  loss:0.45813,stance loss: 0.39845 
Train step: 3230 acc:0.96354 total_loss: 0.23478  loss:0.21099,stance loss: 0.1741 
Train step: 3240 acc:0.96189 total_loss: 0.23133  loss:0.028332,stance loss: 0.0094513 
Train step: 3250 acc:0.9606 total_loss: 0.23496  loss:0.12473,stance loss: 0.074165 
Train step: 3260 acc:0.9614 total_loss: 0.2317  loss:0.24155,stance loss: 0.3382 
Train step: 3270 acc:0.96261 total_loss: 0.23  loss:0.072928,stance loss: 0.047729 
Train step: 3280 acc:0.96363 total_loss: 0.22784  loss:0.03086,stance loss: 0.0089779 
Train step: 3290 acc:0.96402 total_loss: 0.22513  loss:0.11699,stance loss: 0.021207 
Train step: 3300 acc:0.96259 total_loss: 0.23228  loss:0.54376,stance loss: 0.1763 
Train step: 3310 acc:0.96299 total_loss: 0.23755  loss:0.62377,stance loss: 0.57467 
Train step: 3320 acc:0.96258 total_loss: 0.23891  loss:0.097706,stance loss: 0.018614 
Train step: 3330 acc:0.96257 total_loss: 0.2383  loss:0.0438,stance loss: 0.0074132 
Train step: 3340 acc:0.96291 total_loss: 0.2386  loss:0.15978,stance loss: 0.10209 
Train step: 3350 acc:0.96257 total_loss: 0.24093  loss:0.098931,stance loss: 0.05548 
Train step: 3360 acc:0.96287 total_loss: 0.23589  loss:0.041594,stance loss: 0.013195 
Train step: 3370 acc:0.96197 total_loss: 0.23637  loss:0.085283,stance loss: 0.050402 
Train step: 3380 acc:0.96143 total_loss: 0.23857  loss:0.064017,stance loss: 0.030855 
Train step: 3390 acc:0.96255 total_loss: 0.23546  loss:0.087617,stance loss: 0.035877 
Train step: 3400 acc:0.96358 total_loss: 0.23686  loss:0.061288,stance loss: 0.017265 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.94444 total_loss: 0.17816  loss:0.021547,stance loss: 0.0021371 
Train step: 3420 acc:0.94737 total_loss: 0.1931  loss:0.18426,stance loss: 0.091052 
Train step: 3430 acc:0.95043 total_loss: 0.2139  loss:0.036465,stance loss: 0.0045291 
Train step: 3440 acc:0.95994 total_loss: 0.18391  loss:0.076555,stance loss: 0.01712 
Train step: 3450 acc:0.96173 total_loss: 0.19351  loss:0.1032,stance loss: 0.050513 
Train step: 3460 acc:0.96716 total_loss: 0.17161  loss:0.10209,stance loss: 0.13412 
Train step: 3470 acc:0.96558 total_loss: 0.17559  loss:0.017165,stance loss: 0.0010399 
Train step: 3480 acc:0.96361 total_loss: 0.19425  loss:0.055517,stance loss: 0.0037251 
Train step: 3490 acc:0.96348 total_loss: 0.2062  loss:0.135,stance loss: 0.068 
Train step: 3500 acc:0.96528 total_loss: 0.2048  loss:0.030716,stance loss: 0.013486 
Train step: 3510 acc:0.96445 total_loss: 0.21011  loss:0.040422,stance loss: 0.0057376 
Train step: 3520 acc:0.96324 total_loss: 0.21363  loss:1.111,stance loss: 1.3519 
Train step: 3530 acc:0.96221 total_loss: 0.21503  loss:0.066948,stance loss: 0.033941 
Train step: 3540 acc:0.96043 total_loss: 0.2207  loss:0.10763,stance loss: 0.060578 
Train step: 3550 acc:0.95889 total_loss: 0.22775  loss:0.019868,stance loss: 0.0023516 
Train step: 3560 acc:0.96069 total_loss: 0.22681  loss:0.095831,stance loss: 0.053169 
Train step: 3570 acc:0.96117 total_loss: 0.22093  loss:0.054785,stance loss: 0.0079794 
Train step: 3580 acc:0.96299 total_loss: 0.21908  loss:0.52562,stance loss: 1.008 
Train step: 3590 acc:0.96362 total_loss: 0.22616  loss:0.37566,stance loss: 0.24867 
Train step: 3600 acc:0.96388 total_loss: 0.23062  loss:0.097428,stance loss: 0.050882 
Train step: 3610 acc:0.96382 total_loss: 0.22824  loss:0.060971,stance loss: 0.042181 
Train step: 3620 acc:0.96433 total_loss: 0.22557  loss:0.027741,stance loss: 0.012116 
Train step: 3630 acc:0.96479 total_loss: 0.22426  loss:0.17184,stance loss: 0.14465 
Train step: 3640 acc:0.9647 total_loss: 0.22248  loss:0.15143,stance loss: 0.083132 
Training finished.


Reload the best model with best f1 0.5638821215768 from path test_outputs/bert-cross-topic/hc/2023-08-16 13-24-22/state_dict


              precision    recall  f1-score   support

           0   0.689139  0.651327  0.669700       565
           1   0.534653  0.632812  0.579606       256
           2   0.482993  0.435583  0.458065       163

    accuracy                       0.610772       984
   macro avg   0.568928  0.573241  0.569124       984
weighted avg   0.614799  0.610772  0.611203       984

Test Acc: 0.6107723577235772 F1_ma:0.5638821215768
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5638821215768
acc: 0.6107723577235772, f1 :0.5691235610750521
classification report: 
              precision    recall  f1-score   support

         Con     0.6891    0.6513    0.6697       565
        None     0.5347    0.6328    0.5796       256
         Pro     0.4830    0.4356    0.4581       163

    accuracy                         0.6108       984
   macro avg     0.5689    0.5732    0.5691       984
weighted avg     0.6148    0.6108    0.6112       984

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 13-45-09', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 13-45-09
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.7693  loss:1.7693,stance loss: 1.2579 
Train step: 10 acc:0.30682 total_loss: 1.7625  loss:1.637,stance loss: 1.1079 
Better F1! Saving model!
Saving model of best f1: 0.22066558602666314
              precision    recall  f1-score   support

           0   0.408730  0.182301  0.252142       565
           1   0.006601  0.007812  0.007156       256
           2   0.130536  0.343558  0.189189       163

    accuracy                       0.163618       984
   macro avg   0.181956  0.177891  0.149496       984
weighted avg   0.258028  0.163618  0.177978       984

Test Acc: 0.16361788617886178 F1_ma:0.22066558602666314
Train step: 20 acc:0.36905 total_loss: 1.7407  loss:1.5523,stance loss: 1.0287 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 30 acc:0.39919 total_loss: 1.7164  loss:1.6231,stance loss: 1.1925 
Train step: 40 acc:0.4253 total_loss: 1.6953  loss:1.5802,stance loss: 1.1257 
Train step: 50 acc:0.44363 total_loss: 1.671  loss:1.5197,stance loss: 1.0701 
Train step: 60 acc:0.45082 total_loss: 1.6607  loss:1.3371,stance loss: 0.67467 
Train step: 70 acc:0.46567 total_loss: 1.6534  loss:1.5154,stance loss: 1.1202 
Train step: 80 acc:0.46759 total_loss: 1.6489  loss:1.4017,stance loss: 0.90668 
Train step: 90 acc:0.48146 total_loss: 1.6463  loss:1.7732,stance loss: 1.6564 
Train step: 100 acc:0.48329 total_loss: 1.6434  loss:1.3207,stance loss: 0.83815 
Train step: 110 acc:0.48818 total_loss: 1.641  loss:1.3871,stance loss: 0.93971 
Train step: 120 acc:0.49019 total_loss: 1.6399  loss:1.5873,stance loss: 1.2492 
Train step: 130 acc:0.48569 total_loss: 1.6445  loss:1.6803,stance loss: 1.2482 
Train step: 140 acc:0.49113 total_loss: 1.6387  loss:1.7126,stance loss: 1.2495 
Train step: 150 acc:0.49503 total_loss: 1.637  loss:1.4657,stance loss: 1.1362 
Train step: 160 acc:0.49922 total_loss: 1.6341  loss:1.4962,stance loss: 1.1013 
Train step: 170 acc:0.49781 total_loss: 1.6359  loss:1.5918,stance loss: 1.0668 
Train step: 180 acc:0.50104 total_loss: 1.6345  loss:1.665,stance loss: 1.2128 
Better F1! Saving model!
Saving model of best f1: 0.36622516556291385
              precision    recall  f1-score   support

           0   0.585185  0.978761  0.732450       565
           1   0.684211  0.101562  0.176871       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.588415       984
   macro avg   0.423132  0.360108  0.303107       984
weighted avg   0.514012  0.588415  0.466579       984

Test Acc: 0.5884146341463414 F1_ma:0.36622516556291385
Train step: 190 acc:0.50393 total_loss: 1.63  loss:1.6417,stance loss: 1.241 
Better F1! Saving model!
Saving model of best f1: 0.3662714097496706
              precision    recall  f1-score   support

           0   0.583421  0.984071  0.732543       565
           1   0.677419  0.082031  0.146341       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.586382       984
   macro avg   0.420280  0.355367  0.292961       984
weighted avg   0.511232  0.586382  0.458689       984

Test Acc: 0.5863821138211383 F1_ma:0.3662714097496706
Train step: 200 acc:0.50684 total_loss: 1.6283  loss:1.556,stance loss: 1.1041 
Train step: 210 acc:0.50741 total_loss: 1.6281  loss:1.6501,stance loss: 1.2522 
Train step: 220 acc:0.51046 total_loss: 1.6227  loss:1.5768,stance loss: 1.1929 
Train step: 230 acc:0.51488 total_loss: 1.619  loss:1.6979,stance loss: 1.5427 
Train step: 240 acc:0.51426 total_loss: 1.6178  loss:1.59,stance loss: 1.5437 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.47656 total_loss: 1.64  loss:1.8339,stance loss: 1.8564 
Train step: 260 acc:0.52778 total_loss: 1.5831  loss:1.2741,stance loss: 0.75247 
Train step: 270 acc:0.5558 total_loss: 1.5285  loss:1.4048,stance loss: 0.95956 
Train step: 280 acc:0.55757 total_loss: 1.5177  loss:1.6149,stance loss: 1.1316 
Train step: 290 acc:0.5651 total_loss: 1.5054  loss:1.2746,stance loss: 0.95666 
Train step: 300 acc:0.56573 total_loss: 1.5041  loss:1.3637,stance loss: 0.8891 
Train step: 310 acc:0.57721 total_loss: 1.4866  loss:1.4554,stance loss: 1.1621 
Train step: 320 acc:0.58013 total_loss: 1.4853  loss:1.6833,stance loss: 0.9962 
Train step: 330 acc:0.58523 total_loss: 1.4772  loss:1.4255,stance loss: 0.92027 
Train step: 340 acc:0.58546 total_loss: 1.4781  loss:1.473,stance loss: 0.94063 
Train step: 350 acc:0.58565 total_loss: 1.473  loss:1.4474,stance loss: 0.90193 
Train step: 360 acc:0.58898 total_loss: 1.4636  loss:1.221,stance loss: 0.84618 
Better F1! Saving model!
Saving model of best f1: 0.44679030311047907
              precision    recall  f1-score   support

           0   0.670139  0.683186  0.676599       565
           1   0.529248  0.742188  0.617886       256
           2   0.469388  0.141104  0.216981       163

    accuracy                       0.608740       984
   macro avg   0.556258  0.522159  0.503822       984
weighted avg   0.600230  0.608740  0.585189       984

Test Acc: 0.608739837398374 F1_ma:0.44679030311047907
Train step: 370 acc:0.59131 total_loss: 1.4602  loss:1.2867,stance loss: 0.94912 
Train step: 380 acc:0.59103 total_loss: 1.4581  loss:1.49,stance loss: 1.1001 
Train step: 390 acc:0.59628 total_loss: 1.4487  loss:1.4352,stance loss: 1.0447 
Train step: 400 acc:0.59691 total_loss: 1.4434  loss:1.1449,stance loss: 0.85843 
Train step: 410 acc:0.59784 total_loss: 1.4405  loss:1.6631,stance loss: 1.3594 
Train step: 420 acc:0.60042 total_loss: 1.4373  loss:1.0167,stance loss: 0.55609 
Train step: 430 acc:0.60073 total_loss: 1.4397  loss:1.4285,stance loss: 1.1912 
Train step: 440 acc:0.60322 total_loss: 1.436  loss:1.415,stance loss: 1.0774 
Train step: 450 acc:0.60337 total_loss: 1.4304  loss:1.2751,stance loss: 0.75393 
Train step: 460 acc:0.60436 total_loss: 1.4283  loss:1.6292,stance loss: 1.2815 
Train step: 470 acc:0.60526 total_loss: 1.424  loss:1.5398,stance loss: 1.1374 
Train step: 480 acc:0.60819 total_loss: 1.418  loss:0.75894,stance loss: 0.30077 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.625 total_loss: 1.2884  loss:1.6277,stance loss: 1.1739 
Train step: 500 acc:0.64583 total_loss: 1.2439  loss:1.2784,stance loss: 1.0468 
Train step: 510 acc:0.665 total_loss: 1.2342  loss:1.722,stance loss: 1.2792 
Train step: 520 acc:0.66071 total_loss: 1.2851  loss:1.6356,stance loss: 1.5265 
Train step: 530 acc:0.65833 total_loss: 1.2929  loss:1.3179,stance loss: 0.89752 
Train step: 540 acc:0.67273 total_loss: 1.268  loss:1.337,stance loss: 0.93516 
Train step: 550 acc:0.67404 total_loss: 1.2668  loss:1.3553,stance loss: 1.0407 
Train step: 560 acc:0.67083 total_loss: 1.2746  loss:1.6768,stance loss: 1.7042 
Train step: 570 acc:0.67794 total_loss: 1.2613  loss:1.2827,stance loss: 0.91039 
Train step: 580 acc:0.67105 total_loss: 1.2594  loss:0.92434,stance loss: 0.47189 
Train step: 590 acc:0.675 total_loss: 1.2511  loss:1.3435,stance loss: 1.2424 
Train step: 600 acc:0.67337 total_loss: 1.2479  loss:0.98608,stance loss: 0.6262 
Train step: 610 acc:0.6725 total_loss: 1.2485  loss:1.183,stance loss: 1.0581 
Train step: 620 acc:0.67454 total_loss: 1.2406  loss:1.1905,stance loss: 0.805 
Train step: 630 acc:0.67155 total_loss: 1.2366  loss:1.054,stance loss: 0.75744 
Better F1! Saving model!
Saving model of best f1: 0.5187308439456076
              precision    recall  f1-score   support

           0   0.682609  0.555752  0.612683       565
           1   0.531609  0.722656  0.612583       256
           2   0.409091  0.441718  0.424779       163

    accuracy                       0.580285       984
   macro avg   0.541103  0.573375  0.550015       984
weighted avg   0.598016  0.580285  0.581530       984

Test Acc: 0.5802845528455285 F1_ma:0.5187308439456076
Train step: 640 acc:0.67056 total_loss: 1.2426  loss:1.5233,stance loss: 1.2772 
Train step: 650 acc:0.67083 total_loss: 1.2423  loss:1.2796,stance loss: 1.0106 
Train step: 660 acc:0.6725 total_loss: 1.2356  loss:1.4434,stance loss: 1.1001 
Better F1! Saving model!
Saving model of best f1: 0.5230103078325503
              precision    recall  f1-score   support

           0   0.689850  0.649558  0.669098       565
           1   0.538028  0.746094  0.625205       256
           2   0.505155  0.300613  0.376923       163

    accuracy                       0.616870       984
   macro avg   0.577677  0.565422  0.557075       984
weighted avg   0.619757  0.616870  0.609279       984

Test Acc: 0.616869918699187 F1_ma:0.5230103078325503
Train step: 670 acc:0.67568 total_loss: 1.2318  loss:1.0117,stance loss: 0.90222 
Better F1! Saving model!
Saving model of best f1: 0.5358908715334242
              precision    recall  f1-score   support

           0   0.725061  0.527434  0.610656       565
           1   0.531680  0.753906  0.623586       256
           2   0.409524  0.527607  0.461126       163

    accuracy                       0.586382       984
   macro avg   0.555422  0.602982  0.565123       984
weighted avg   0.622482  0.586382  0.589250       984

Test Acc: 0.5863821138211383 F1_ma:0.5358908715334242
Train step: 680 acc:0.67468 total_loss: 1.2413  loss:1.5271,stance loss: 1.3885 
Train step: 690 acc:0.67287 total_loss: 1.2452  loss:1.0168,stance loss: 0.76012 
Better F1! Saving model!
Saving model of best f1: 0.5455549653523915
              precision    recall  f1-score   support

           0   0.722864  0.553982  0.627255       565
           1   0.531414  0.792969  0.636364       256
           2   0.455621  0.472393  0.463855       163

    accuracy                       0.602642       984
   macro avg   0.569966  0.606448  0.575825       984
weighted avg   0.628787  0.602642  0.602557       984

Test Acc: 0.6026422764227642 F1_ma:0.5455549653523915
Train step: 700 acc:0.67238 total_loss: 1.2452  loss:0.90956,stance loss: 0.6182 
Train step: 710 acc:0.67056 total_loss: 1.248  loss:1.3399,stance loss: 1.1117 
Train step: 720 acc:0.67021 total_loss: 1.2475  loss:1.348,stance loss: 1.2699 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.71875 total_loss: 1.0729  loss:1.3626,stance loss: 1.1308 
Train step: 740 acc:0.70312 total_loss: 1.1038  loss:0.99235,stance loss: 0.67485 
Train step: 750 acc:0.69034 total_loss: 1.1512  loss:1.6016,stance loss: 1.7344 
Train step: 760 acc:0.70703 total_loss: 1.1426  loss:0.51019,stance loss: 0.22084 
Train step: 770 acc:0.70387 total_loss: 1.1318  loss:1.067,stance loss: 0.68045 
Train step: 780 acc:0.71514 total_loss: 1.0963  loss:1.1177,stance loss: 0.64573 
Train step: 790 acc:0.71069 total_loss: 1.0973  loss:0.86321,stance loss: 0.54198 
Train step: 800 acc:0.7092 total_loss: 1.1092  loss:0.73604,stance loss: 0.58791 
Train step: 810 acc:0.71265 total_loss: 1.1105  loss:1.1999,stance loss: 0.85696 
Train step: 820 acc:0.71332 total_loss: 1.1131  loss:0.87557,stance loss: 0.65915 
Train step: 830 acc:0.70833 total_loss: 1.1233  loss:1.0633,stance loss: 0.84921 
Train step: 840 acc:0.71038 total_loss: 1.1272  loss:0.73119,stance loss: 0.49315 
Train step: 850 acc:0.70902 total_loss: 1.1276  loss:1.5869,stance loss: 1.0285 
Train step: 860 acc:0.70455 total_loss: 1.1286  loss:0.88536,stance loss: 0.54707 
Train step: 870 acc:0.70819 total_loss: 1.1292  loss:0.97305,stance loss: 0.80944 
Train step: 880 acc:0.70888 total_loss: 1.1316  loss:0.70259,stance loss: 0.40154 
Train step: 890 acc:0.70679 total_loss: 1.129  loss:0.97533,stance loss: 0.67796 
Train step: 900 acc:0.70531 total_loss: 1.1315  loss:1.0019,stance loss: 0.79513 
Train step: 910 acc:0.7057 total_loss: 1.129  loss:1.0413,stance loss: 0.84059 
Train step: 920 acc:0.70573 total_loss: 1.1314  loss:1.3814,stance loss: 1.0019 
Train step: 930 acc:0.70452 total_loss: 1.1332  loss:1.2201,stance loss: 1.2896 
Train step: 940 acc:0.70342 total_loss: 1.1376  loss:1.3336,stance loss: 1.1897 
Train step: 950 acc:0.7027 total_loss: 1.14  loss:1.6251,stance loss: 1.3621 
Train step: 960 acc:0.70178 total_loss: 1.1384  loss:0.95414,stance loss: 0.6502 
Train step: 970 acc:0.70274 total_loss: 1.1381  loss:1.4442,stance loss: 1.6116 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.70833 total_loss: 1.1115  loss:0.76841,stance loss: 0.54587 
Train step: 990 acc:0.69079 total_loss: 1.1026  loss:1.1153,stance loss: 0.95531 
Train step: 1000 acc:0.69828 total_loss: 1.1051  loss:1.3495,stance loss: 1.1242 
Train step: 1010 acc:0.70673 total_loss: 1.0799  loss:1.0865,stance loss: 0.73852 
Train step: 1020 acc:0.70536 total_loss: 1.063  loss:0.77714,stance loss: 0.48542 
Train step: 1030 acc:0.71716 total_loss: 1.0444  loss:0.82679,stance loss: 0.67435 
Train step: 1040 acc:0.70562 total_loss: 1.0465  loss:0.86112,stance loss: 0.63539 
Train step: 1050 acc:0.71123 total_loss: 1.0419  loss:0.72163,stance loss: 0.5179 
Train step: 1060 acc:0.71699 total_loss: 1.0341  loss:0.94652,stance loss: 0.77921 
Train step: 1070 acc:0.72033 total_loss: 1.0267  loss:1.2613,stance loss: 1.3786 
Train step: 1080 acc:0.71904 total_loss: 1.0302  loss:1.0658,stance loss: 0.81129 
Train step: 1090 acc:0.72006 total_loss: 1.0374  loss:0.94548,stance loss: 0.72815 
Train step: 1100 acc:0.7219 total_loss: 1.0351  loss:0.75175,stance loss: 0.49608 
Train step: 1110 acc:0.72662 total_loss: 1.0319  loss:0.72551,stance loss: 0.53802 
Train step: 1120 acc:0.72777 total_loss: 1.0344  loss:0.84008,stance loss: 0.52035 
Train step: 1130 acc:0.72759 total_loss: 1.0383  loss:0.9162,stance loss: 0.57279 
Train step: 1140 acc:0.72818 total_loss: 1.0355  loss:1.2003,stance loss: 0.72946 
Train step: 1150 acc:0.73219 total_loss: 1.0263  loss:0.66986,stance loss: 0.563 
Train step: 1160 acc:0.7328 total_loss: 1.0271  loss:1.1044,stance loss: 0.82447 
Train step: 1170 acc:0.73147 total_loss: 1.0301  loss:1.2949,stance loss: 1.2015 
Train step: 1180 acc:0.72967 total_loss: 1.0346  loss:0.74993,stance loss: 0.47939 
Train step: 1190 acc:0.73288 total_loss: 1.0281  loss:1.1589,stance loss: 1.5986 
Train step: 1200 acc:0.73253 total_loss: 1.0271  loss:1.0338,stance loss: 0.84171 
Train step: 1210 acc:0.73222 total_loss: 1.0246  loss:1.0175,stance loss: 0.79287 
Better F1! Saving model!
Saving model of best f1: 0.5707807866071676
              precision    recall  f1-score   support

           0   0.689524  0.640708  0.664220       565
           1   0.553265  0.628906  0.588665       256
           2   0.470238  0.484663  0.477341       163

    accuracy                       0.611789       984
   macro avg   0.571009  0.584759  0.576742       984
weighted avg   0.617749  0.611789  0.613607       984

Test Acc: 0.6117886178861789 F1_ma:0.5707807866071676
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.83333 total_loss: 0.85052  loss:0.9686,stance loss: 0.65957 
Train step: 1230 acc:0.75 total_loss: 0.96371  loss:1.002,stance loss: 0.8127 
Train step: 1240 acc:0.76202 total_loss: 0.98078  loss:0.6982,stance loss: 0.46402 
Train step: 1250 acc:0.78299 total_loss: 0.9214  loss:0.47853,stance loss: 0.36553 
Train step: 1260 acc:0.78533 total_loss: 0.88811  loss:0.77779,stance loss: 0.6143 
Train step: 1270 acc:0.7846 total_loss: 0.87713  loss:0.89719,stance loss: 0.64762 
Train step: 1280 acc:0.7803 total_loss: 0.88824  loss:0.9867,stance loss: 0.87406 
Train step: 1290 acc:0.78536 total_loss: 0.87254  loss:0.44032,stance loss: 0.35427 
Train step: 1300 acc:0.78852 total_loss: 0.85242  loss:0.80282,stance loss: 0.60232 
Train step: 1310 acc:0.79036 total_loss: 0.85431  loss:0.94636,stance loss: 0.71806 
Train step: 1320 acc:0.78361 total_loss: 0.87609  loss:0.63359,stance loss: 0.4916 
Train step: 1330 acc:0.78017 total_loss: 0.87943  loss:1.3718,stance loss: 1.1292 
Train step: 1340 acc:0.7748 total_loss: 0.88774  loss:1.5516,stance loss: 1.17 
Train step: 1350 acc:0.77574 total_loss: 0.88488  loss:0.71499,stance loss: 0.52321 
Train step: 1360 acc:0.77055 total_loss: 0.89142  loss:0.76584,stance loss: 0.69002 
Train step: 1370 acc:0.77123 total_loss: 0.88727  loss:0.70533,stance loss: 0.5859 
Train step: 1380 acc:0.7741 total_loss: 0.88584  loss:0.51288,stance loss: 0.31761 
Train step: 1390 acc:0.77699 total_loss: 0.8802  loss:0.77179,stance loss: 0.70905 
Train step: 1400 acc:0.77722 total_loss: 0.87989  loss:1.0035,stance loss: 0.82322 
Train step: 1410 acc:0.77519 total_loss: 0.88176  loss:1.128,stance loss: 0.87393 
Train step: 1420 acc:0.77336 total_loss: 0.88574  loss:0.85744,stance loss: 0.59491 
Train step: 1430 acc:0.77402 total_loss: 0.88635  loss:1.1996,stance loss: 0.97387 
Train step: 1440 acc:0.77406 total_loss: 0.88515  loss:0.64169,stance loss: 0.53443 
Train step: 1450 acc:0.77172 total_loss: 0.89212  loss:1.2639,stance loss: 1.4822 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.85417 total_loss: 1.0548  loss:1.2611,stance loss: 1.539 
Train step: 1470 acc:0.8125 total_loss: 0.91111  loss:1.65,stance loss: 1.3553 
Train step: 1480 acc:0.8288 total_loss: 0.85418  loss:0.92901,stance loss: 0.8542 
Train step: 1490 acc:0.81439 total_loss: 0.85581  loss:1.3813,stance loss: 1.4336 
Train step: 1500 acc:0.81686 total_loss: 0.82482  loss:0.98454,stance loss: 0.87893 
Train step: 1510 acc:0.8066 total_loss: 0.84415  loss:0.63389,stance loss: 0.54449 
Train step: 1520 acc:0.8125 total_loss: 0.83491  loss:0.55818,stance loss: 0.50235 
Train step: 1530 acc:0.80822 total_loss: 0.82886  loss:0.71931,stance loss: 0.62358 
Train step: 1540 acc:0.81024 total_loss: 0.81859  loss:0.28818,stance loss: 0.098834 
Train step: 1550 acc:0.8125 total_loss: 0.804  loss:1.0938,stance loss: 0.95346 
Train step: 1560 acc:0.80825 total_loss: 0.823  loss:0.88446,stance loss: 0.74548 
Train step: 1570 acc:0.80808 total_loss: 0.81874  loss:0.75784,stance loss: 0.65018 
Train step: 1580 acc:0.81199 total_loss: 0.80289  loss:0.55966,stance loss: 0.303 
Train step: 1590 acc:0.80686 total_loss: 0.81237  loss:0.64631,stance loss: 0.47135 
Train step: 1600 acc:0.80245 total_loss: 0.81976  loss:0.82378,stance loss: 0.67148 
Train step: 1610 acc:0.80678 total_loss: 0.8089  loss:0.67645,stance loss: 0.5937 
Train step: 1620 acc:0.80445 total_loss: 0.81426  loss:1.2463,stance loss: 0.96792 
Train step: 1630 acc:0.80419 total_loss: 0.82339  loss:1.0603,stance loss: 0.88731 
Train step: 1640 acc:0.80396 total_loss: 0.81742  loss:0.51764,stance loss: 0.34752 
Train step: 1650 acc:0.80311 total_loss: 0.81553  loss:0.72494,stance loss: 0.48252 
Train step: 1660 acc:0.80357 total_loss: 0.81748  loss:1.0119,stance loss: 0.86402 
Train step: 1670 acc:0.8034 total_loss: 0.81645  loss:0.7128,stance loss: 0.53563 
Train step: 1680 acc:0.80297 total_loss: 0.81534  loss:1.2483,stance loss: 1.5556 
Train step: 1690 acc:0.80284 total_loss: 0.81271  loss:0.69903,stance loss: 0.57363 
Train step: 1700 acc:0.80314 total_loss: 0.8149  loss:1.2412,stance loss: 0.85202 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.81875 total_loss: 0.77733  loss:0.77145,stance loss: 0.64728 
Train step: 1720 acc:0.81875 total_loss: 0.79194  loss:0.75158,stance loss: 0.62549 
Train step: 1730 acc:0.82292 total_loss: 0.79975  loss:0.76984,stance loss: 0.69684 
Train step: 1740 acc:0.81719 total_loss: 0.79476  loss:0.60175,stance loss: 0.4861 
Train step: 1750 acc:0.82625 total_loss: 0.76965  loss:0.4836,stance loss: 0.28143 
Train step: 1760 acc:0.82604 total_loss: 0.76245  loss:0.56258,stance loss: 0.42845 
Train step: 1770 acc:0.82857 total_loss: 0.74183  loss:0.86538,stance loss: 0.66394 
Train step: 1780 acc:0.82734 total_loss: 0.75559  loss:0.5851,stance loss: 0.48061 
Train step: 1790 acc:0.82986 total_loss: 0.75267  loss:0.94873,stance loss: 0.93496 
Train step: 1800 acc:0.83 total_loss: 0.75349  loss:0.61738,stance loss: 0.44531 
Train step: 1810 acc:0.82841 total_loss: 0.75029  loss:0.52352,stance loss: 0.40349 
Train step: 1820 acc:0.83073 total_loss: 0.74655  loss:1.0237,stance loss: 0.99178 
Train step: 1830 acc:0.83029 total_loss: 0.74485  loss:0.94678,stance loss: 0.74293 
Train step: 1840 acc:0.83437 total_loss: 0.74016  loss:0.73585,stance loss: 0.54984 
Train step: 1850 acc:0.835 total_loss: 0.73886  loss:1.2704,stance loss: 1.5156 
Train step: 1860 acc:0.83242 total_loss: 0.73705  loss:0.81089,stance loss: 0.65949 
Train step: 1870 acc:0.83162 total_loss: 0.73686  loss:0.82382,stance loss: 0.69213 
Train step: 1880 acc:0.8316 total_loss: 0.7377  loss:0.42275,stance loss: 0.26683 
Train step: 1890 acc:0.83388 total_loss: 0.73326  loss:0.53506,stance loss: 0.35982 
Train step: 1900 acc:0.83531 total_loss: 0.73042  loss:0.59254,stance loss: 0.51256 
Train step: 1910 acc:0.83512 total_loss: 0.73  loss:0.82555,stance loss: 0.69683 
Train step: 1920 acc:0.83636 total_loss: 0.73028  loss:0.34851,stance loss: 0.10631 
Train step: 1930 acc:0.83451 total_loss: 0.7319  loss:0.6566,stance loss: 0.39619 
Train step: 1940 acc:0.83776 total_loss: 0.72355  loss:0.4735,stance loss: 0.35222 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.875 total_loss: 0.59466  loss:0.70805,stance loss: 1.0605 
Train step: 1960 acc:0.87868 total_loss: 0.59283  loss:0.69017,stance loss: 0.53943 
Train step: 1970 acc:0.87963 total_loss: 0.64223  loss:0.56969,stance loss: 0.55462 
Train step: 1980 acc:0.87331 total_loss: 0.63504  loss:0.59908,stance loss: 0.5134 
Train step: 1990 acc:0.86835 total_loss: 0.64193  loss:0.54401,stance loss: 0.44164 
Train step: 2000 acc:0.86294 total_loss: 0.64561  loss:0.84997,stance loss: 0.73528 
Train step: 2010 acc:0.86194 total_loss: 0.65242  loss:0.40717,stance loss: 0.27955 
Train step: 2020 acc:0.86282 total_loss: 0.64441  loss:0.71496,stance loss: 0.67767 
Train step: 2030 acc:0.86351 total_loss: 0.64081  loss:0.95922,stance loss: 0.84191 
Train step: 2040 acc:0.86211 total_loss: 0.64349  loss:0.25801,stance loss: 0.11439 
Train step: 2050 acc:0.86449 total_loss: 0.64823  loss:0.31951,stance loss: 0.18925 
Train step: 2060 acc:0.86592 total_loss: 0.65136  loss:0.81025,stance loss: 1.2214 
Better F1! Saving model!
Saving model of best f1: 0.5793553293553294
              precision    recall  f1-score   support

           0   0.697248  0.672566  0.684685       565
           1   0.568027  0.652344  0.607273       256
           2   0.503448  0.447853  0.474026       163

    accuracy                       0.630081       984
   macro avg   0.589574  0.590921  0.588661       984
weighted avg   0.631526  0.630081  0.629649       984

Test Acc: 0.6300813008130082 F1_ma:0.5793553293553294
Train step: 2070 acc:0.8686 total_loss: 0.6367  loss:0.44288,stance loss: 0.24137 
Better F1! Saving model!
Saving model of best f1: 0.5809392419175028
              precision    recall  f1-score   support

           0   0.692022  0.660177  0.675725       565
           1   0.561837  0.621094  0.589981       256
           2   0.487654  0.484663  0.486154       163

    accuracy                       0.620935       984
   macro avg   0.580505  0.588644  0.583953       984
weighted avg   0.624299  0.620935  0.622015       984

Test Acc: 0.6209349593495935 F1_ma:0.5809392419175028
Train step: 2080 acc:0.87181 total_loss: 0.62866  loss:0.68722,stance loss: 0.4546 
Train step: 2090 acc:0.87075 total_loss: 0.62913  loss:0.77399,stance loss: 0.62381 
Train step: 2100 acc:0.87102 total_loss: 0.62833  loss:0.64152,stance loss: 0.62205 
Train step: 2110 acc:0.87088 total_loss: 0.62587  loss:0.7402,stance loss: 0.72365 
Train step: 2120 acc:0.87041 total_loss: 0.62717  loss:0.53155,stance loss: 0.41159 
Train step: 2130 acc:0.86999 total_loss: 0.62863  loss:0.45258,stance loss: 0.17929 
Train step: 2140 acc:0.86834 total_loss: 0.63346  loss:0.79089,stance loss: 0.80401 
Train step: 2150 acc:0.86806 total_loss: 0.62978  loss:0.38027,stance loss: 0.3111 
Train step: 2160 acc:0.86521 total_loss: 0.63615  loss:1.1097,stance loss: 0.77074 
Train step: 2170 acc:0.86619 total_loss: 0.63681  loss:0.80462,stance loss: 0.61464 
Train step: 2180 acc:0.86735 total_loss: 0.62966  loss:0.65929,stance loss: 0.51342 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.89062 total_loss: 0.45136  loss:0.62817,stance loss: 0.39537 
Train step: 2200 acc:0.85268 total_loss: 0.57551  loss:0.60439,stance loss: 0.45268 
Train step: 2210 acc:0.86979 total_loss: 0.56148  loss:0.80776,stance loss: 1.1911 
Train step: 2220 acc:0.86949 total_loss: 0.54235  loss:0.52045,stance loss: 0.38425 
Train step: 2230 acc:0.86932 total_loss: 0.57113  loss:0.60891,stance loss: 0.52119 
Train step: 2240 acc:0.87616 total_loss: 0.55817  loss:0.34377,stance loss: 0.34428 
Train step: 2250 acc:0.87793 total_loss: 0.55601  loss:0.40966,stance loss: 0.3271 
Train step: 2260 acc:0.8826 total_loss: 0.55358  loss:0.63319,stance loss: 1.0222 
Train step: 2270 acc:0.8869 total_loss: 0.53472  loss:0.17337,stance loss: 0.073525 
Train step: 2280 acc:0.88963 total_loss: 0.52408  loss:0.41147,stance loss: 0.27834 
Train step: 2290 acc:0.89183 total_loss: 0.51511  loss:0.19235,stance loss: 0.032604 
Train step: 2300 acc:0.88651 total_loss: 0.53044  loss:0.89749,stance loss: 0.82226 
Train step: 2310 acc:0.88861 total_loss: 0.52895  loss:0.31963,stance loss: 0.22998 
Train step: 2320 acc:0.88759 total_loss: 0.53871  loss:0.39576,stance loss: 0.36174 
Better F1! Saving model!
Saving model of best f1: 0.5885066407515387
              precision    recall  f1-score   support

           0   0.678571  0.672566  0.675556       565
           1   0.545082  0.519531  0.532000       256
           2   0.477778  0.527607  0.501458       163

    accuracy                       0.608740       984
   macro avg   0.567144  0.573235  0.569671       984
weighted avg   0.610581  0.608740  0.609368       984

Test Acc: 0.608739837398374 F1_ma:0.5885066407515387
Train step: 2330 acc:0.89019 total_loss: 0.53419  loss:0.45102,stance loss: 0.37267 
Train step: 2340 acc:0.89123 total_loss: 0.52982  loss:0.34229,stance loss: 0.19222 
Train step: 2350 acc:0.89177 total_loss: 0.53082  loss:0.46394,stance loss: 0.25961 
Train step: 2360 acc:0.89152 total_loss: 0.52841  loss:0.52044,stance loss: 0.34225 
Train step: 2370 acc:0.88893 total_loss: 0.53634  loss:0.54696,stance loss: 0.37564 
Train step: 2380 acc:0.88724 total_loss: 0.53632  loss:0.5055,stance loss: 0.42212 
Train step: 2390 acc:0.88817 total_loss: 0.52987  loss:0.79396,stance loss: 0.72568 
Train step: 2400 acc:0.88843 total_loss: 0.53223  loss:0.50811,stance loss: 0.39643 
Train step: 2410 acc:0.88756 total_loss: 0.53594  loss:0.94836,stance loss: 0.77848 
Train step: 2420 acc:0.88889 total_loss: 0.53825  loss:1.0279,stance loss: 1.2819 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.30302  loss:0.30302,stance loss: 0.20331 
Train step: 2440 acc:0.875 total_loss: 0.5748  loss:0.43517,stance loss: 0.26352 
Train step: 2450 acc:0.89583 total_loss: 0.53392  loss:0.65273,stance loss: 0.64738 
Train step: 2460 acc:0.90726 total_loss: 0.48259  loss:0.34099,stance loss: 0.1846 
Train step: 2470 acc:0.89939 total_loss: 0.47796  loss:0.47828,stance loss: 0.3463 
Train step: 2480 acc:0.90686 total_loss: 0.44031  loss:0.41917,stance loss: 0.23117 
Train step: 2490 acc:0.90676 total_loss: 0.46949  loss:0.27696,stance loss: 0.18016 
Train step: 2500 acc:0.90053 total_loss: 0.4892  loss:0.30684,stance loss: 0.21652 
Train step: 2510 acc:0.90355 total_loss: 0.48624  loss:0.26152,stance loss: 0.17961 
Train step: 2520 acc:0.90041 total_loss: 0.48568  loss:0.34358,stance loss: 0.30321 
Train step: 2530 acc:0.90037 total_loss: 0.48696  loss:0.7491,stance loss: 0.62537 
Train step: 2540 acc:0.89865 total_loss: 0.49197  loss:0.41875,stance loss: 0.30237 
Train step: 2550 acc:0.90186 total_loss: 0.47705  loss:0.19792,stance loss: 0.13745 
Train step: 2560 acc:0.90315 total_loss: 0.47554  loss:0.49864,stance loss: 0.46891 
Train step: 2570 acc:0.9047 total_loss: 0.47463  loss:0.3778,stance loss: 0.31965 
Train step: 2580 acc:0.9048 total_loss: 0.47965  loss:0.56821,stance loss: 0.53756 
Train step: 2590 acc:0.90606 total_loss: 0.47512  loss:0.2766,stance loss: 0.17353 
Train step: 2600 acc:0.9057 total_loss: 0.47555  loss:0.51158,stance loss: 0.40609 
Train step: 2610 acc:0.9047 total_loss: 0.47726  loss:0.55533,stance loss: 0.44313 
Train step: 2620 acc:0.90609 total_loss: 0.47336  loss:0.32243,stance loss: 0.18874 
Train step: 2630 acc:0.90734 total_loss: 0.46717  loss:0.19473,stance loss: 0.057768 
Train step: 2640 acc:0.90788 total_loss: 0.46233  loss:0.1954,stance loss: 0.069857 
Train step: 2650 acc:0.90752 total_loss: 0.46184  loss:0.34085,stance loss: 0.31977 
Train step: 2660 acc:0.90909 total_loss: 0.45617  loss:0.21425,stance loss: 0.10919 
Train step: 2670 acc:0.91001 total_loss: 0.45355  loss:0.075638,stance loss: 0.010768 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.9375 total_loss: 0.39547  loss:0.64385,stance loss: 1.0342 
Train step: 2690 acc:0.93403 total_loss: 0.38865  loss:0.29834,stance loss: 0.14559 
Train step: 2700 acc:0.9375 total_loss: 0.3828  loss:0.29279,stance loss: 0.24818 
Train step: 2710 acc:0.94243 total_loss: 0.35837  loss:0.41919,stance loss: 0.29653 
Train step: 2720 acc:0.94141 total_loss: 0.3785  loss:0.71383,stance loss: 1.0732 
Train step: 2730 acc:0.94181 total_loss: 0.3955  loss:0.17673,stance loss: 0.10596 
Train step: 2740 acc:0.94301 total_loss: 0.39658  loss:0.12528,stance loss: 0.0045834 
Train step: 2750 acc:0.94311 total_loss: 0.38877  loss:0.10807,stance loss: 0.039115 
Train step: 2760 acc:0.94247 total_loss: 0.37885  loss:0.49359,stance loss: 0.27803 
Train step: 2770 acc:0.94005 total_loss: 0.37308  loss:0.34832,stance loss: 0.32263 
Train step: 2780 acc:0.93692 total_loss: 0.37846  loss:0.4088,stance loss: 0.36846 
Train step: 2790 acc:0.93485 total_loss: 0.37944  loss:0.62139,stance loss: 1.027 
Train step: 2800 acc:0.9375 total_loss: 0.36299  loss:0.27603,stance loss: 0.247 
Train step: 2810 acc:0.9375 total_loss: 0.36387  loss:0.91283,stance loss: 1.0965 
Train step: 2820 acc:0.93708 total_loss: 0.37729  loss:0.24731,stance loss: 0.16507 
Train step: 2830 acc:0.93394 total_loss: 0.38803  loss:0.47261,stance loss: 0.26336 
Train step: 2840 acc:0.9349 total_loss: 0.387  loss:0.27569,stance loss: 0.23179 
Train step: 2850 acc:0.93504 total_loss: 0.38587  loss:0.57752,stance loss: 0.4498 
Train step: 2860 acc:0.93517 total_loss: 0.38117  loss:0.189,stance loss: 0.086426 
Train step: 2870 acc:0.93497 total_loss: 0.38689  loss:0.30622,stance loss: 0.26823 
Train step: 2880 acc:0.93359 total_loss: 0.38884  loss:0.18857,stance loss: 0.09224 
Train step: 2890 acc:0.9332 total_loss: 0.38698  loss:0.27634,stance loss: 0.21975 
Train step: 2900 acc:0.93421 total_loss: 0.38985  loss:0.15768,stance loss: 0.053025 
Train step: 2910 acc:0.93277 total_loss: 0.39601  loss:0.46336,stance loss: 0.27683 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.95 total_loss: 0.23707  loss:0.14797,stance loss: 0.084846 
Train step: 2930 acc:0.93333 total_loss: 0.32744  loss:0.26176,stance loss: 0.16151 
Train step: 2940 acc:0.9475 total_loss: 0.29339  loss:0.37636,stance loss: 0.38127 
Train step: 2950 acc:0.94821 total_loss: 0.29329  loss:0.069789,stance loss: 0.014746 
Train step: 2960 acc:0.94861 total_loss: 0.28591  loss:0.061483,stance loss: 0.0062211 
Train step: 2970 acc:0.94886 total_loss: 0.29751  loss:0.34555,stance loss: 0.23001 
Train step: 2980 acc:0.94519 total_loss: 0.30426  loss:0.1838,stance loss: 0.17386 
Train step: 2990 acc:0.94333 total_loss: 0.31434  loss:0.63502,stance loss: 1.0471 
Train step: 3000 acc:0.94191 total_loss: 0.31492  loss:0.19455,stance loss: 0.14239 
Train step: 3010 acc:0.94276 total_loss: 0.31215  loss:0.17964,stance loss: 0.022466 
Train step: 3020 acc:0.94405 total_loss: 0.30754  loss:0.1318,stance loss: 0.028524 
Train step: 3030 acc:0.94239 total_loss: 0.31573  loss:0.52247,stance loss: 0.27925 
Train step: 3040 acc:0.9435 total_loss: 0.31613  loss:0.56599,stance loss: 0.49554 
Train step: 3050 acc:0.94259 total_loss: 0.31454  loss:0.1097,stance loss: 0.035372 
Train step: 3060 acc:0.94224 total_loss: 0.31128  loss:0.6537,stance loss: 0.32414 
Train step: 3070 acc:0.94274 total_loss: 0.30979  loss:0.098565,stance loss: 0.031353 
Train step: 3080 acc:0.94167 total_loss: 0.31279  loss:0.13662,stance loss: 0.066896 
Train step: 3090 acc:0.94286 total_loss: 0.31034  loss:0.60949,stance loss: 1.0134 
Train step: 3100 acc:0.94493 total_loss: 0.31086  loss:0.067033,stance loss: 0.020622 
Train step: 3110 acc:0.94455 total_loss: 0.31992  loss:0.047638,stance loss: 0.017633 
Train step: 3120 acc:0.94238 total_loss: 0.32315  loss:0.23839,stance loss: 0.07719 
Train step: 3130 acc:0.94244 total_loss: 0.32759  loss:0.91737,stance loss: 1.4235 
Train step: 3140 acc:0.94306 total_loss: 0.32767  loss:0.57762,stance loss: 1.0186 
Train step: 3150 acc:0.94309 total_loss: 0.33068  loss:0.1505,stance loss: 0.088801 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.085138  loss:0.10587,stance loss: 0.063302 
Train step: 3170 acc:0.96875 total_loss: 0.1585  loss:0.50254,stance loss: 0.43564 
Train step: 3180 acc:0.97159 total_loss: 0.21132  loss:0.59811,stance loss: 1.0082 
Train step: 3190 acc:0.9668 total_loss: 0.23024  loss:0.64665,stance loss: 0.52294 
Train step: 3200 acc:0.96131 total_loss: 0.25919  loss:1.6054,stance loss: 1.6621 
Train step: 3210 acc:0.95913 total_loss: 0.26649  loss:0.23948,stance loss: 0.11198 
Train step: 3220 acc:0.95565 total_loss: 0.28608  loss:0.09157,stance loss: 0.079094 
Train step: 3230 acc:0.95399 total_loss: 0.30075  loss:0.14552,stance loss: 0.099808 
Train step: 3240 acc:0.95655 total_loss: 0.2868  loss:0.058103,stance loss: 0.0015134 
Train step: 3250 acc:0.95856 total_loss: 0.27925  loss:0.068122,stance loss: 0.036115 
Train step: 3260 acc:0.95895 total_loss: 0.27379  loss:0.54744,stance loss: 0.47408 
Train step: 3270 acc:0.95815 total_loss: 0.27063  loss:0.25914,stance loss: 0.06664 
Train step: 3280 acc:0.9585 total_loss: 0.26976  loss:0.10022,stance loss: 0.034675 
Train step: 3290 acc:0.95833 total_loss: 0.26784  loss:0.15094,stance loss: 0.1171 
Train step: 3300 acc:0.95555 total_loss: 0.26744  loss:0.4079,stance loss: 0.42025 
Train step: 3310 acc:0.956 total_loss: 0.26973  loss:0.10433,stance loss: 0.061353 
Train step: 3320 acc:0.95795 total_loss: 0.2629  loss:0.19866,stance loss: 0.14575 
Train step: 3330 acc:0.95785 total_loss: 0.26416  loss:0.2412,stance loss: 0.20507 
Train step: 3340 acc:0.95845 total_loss: 0.26676  loss:1.1468,stance loss: 1.0731 
Train step: 3350 acc:0.95898 total_loss: 0.26987  loss:0.33003,stance loss: 0.375 
Train step: 3360 acc:0.95885 total_loss: 0.26867  loss:0.069193,stance loss: 0.0219 
Train step: 3370 acc:0.95755 total_loss: 0.27349  loss:0.15443,stance loss: 0.032854 
Train step: 3380 acc:0.95805 total_loss: 0.26975  loss:0.72387,stance loss: 0.72818 
Train step: 3390 acc:0.95797 total_loss: 0.26915  loss:0.18695,stance loss: 0.093899 
Train step: 3400 acc:0.9579 total_loss: 0.2677  loss:0.68321,stance loss: 0.33902 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.95833 total_loss: 0.17604  loss:0.37638,stance loss: 0.38779 
Train step: 3420 acc:0.96711 total_loss: 0.15678  loss:0.067398,stance loss: 0.039377 
Train step: 3430 acc:0.96336 total_loss: 0.20449  loss:0.058028,stance loss: 0.0018128 
Train step: 3440 acc:0.96314 total_loss: 0.21953  loss:0.59781,stance loss: 0.47219 
Train step: 3450 acc:0.96301 total_loss: 0.23195  loss:0.24768,stance loss: 0.11808 
Train step: 3460 acc:0.96292 total_loss: 0.2288  loss:0.037204,stance loss: 0.0082844 
Train step: 3470 acc:0.96014 total_loss: 0.23848  loss:0.24897,stance loss: 0.15991 
Train step: 3480 acc:0.95886 total_loss: 0.239  loss:0.2591,stance loss: 0.1828 
Train step: 3490 acc:0.96138 total_loss: 0.22647  loss:0.19888,stance loss: 0.11418 
Train step: 3500 acc:0.96338 total_loss: 0.21981  loss:0.1154,stance loss: 0.10091 
Train step: 3510 acc:0.96502 total_loss: 0.2099  loss:0.15338,stance loss: 0.027268 
Train step: 3520 acc:0.96639 total_loss: 0.2061  loss:0.067523,stance loss: 0.037535 
Train step: 3530 acc:0.96657 total_loss: 0.20854  loss:0.1015,stance loss: 0.076166 
Train step: 3540 acc:0.96628 total_loss: 0.20713  loss:0.24574,stance loss: 0.22182 
Train step: 3550 acc:0.96728 total_loss: 0.20784  loss:0.31786,stance loss: 0.21714 
Train step: 3560 acc:0.96895 total_loss: 0.20316  loss:0.026691,stance loss: 0.0035305 
Train step: 3570 acc:0.9682 total_loss: 0.21195  loss:0.082085,stance loss: 0.057825 
Train step: 3580 acc:0.96753 total_loss: 0.21719  loss:0.1046,stance loss: 0.032952 
Train step: 3590 acc:0.96825 total_loss: 0.21844  loss:0.072992,stance loss: 0.018346 
Train step: 3600 acc:0.96765 total_loss: 0.2176  loss:0.10565,stance loss: 0.090794 
Train step: 3610 acc:0.96681 total_loss: 0.2187  loss:0.1589,stance loss: 0.020057 
Train step: 3620 acc:0.96661 total_loss: 0.21988  loss:0.26138,stance loss: 0.21685 
Train step: 3630 acc:0.9667 total_loss: 0.21842  loss:0.087959,stance loss: 0.0081377 
Train step: 3640 acc:0.96574 total_loss: 0.22317  loss:0.23487,stance loss: 0.1629 
Training finished.


Reload the best model with best f1 0.5885066407515387 from path test_outputs/bert-cross-topic/hc/2023-08-16 13-45-09/state_dict


              precision    recall  f1-score   support

           0   0.678571  0.672566  0.675556       565
           1   0.545082  0.519531  0.532000       256
           2   0.477778  0.527607  0.501458       163

    accuracy                       0.608740       984
   macro avg   0.567144  0.573235  0.569671       984
weighted avg   0.610581  0.608740  0.609368       984

Test Acc: 0.608739837398374 F1_ma:0.5885066407515387
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5885066407515387
acc: 0.608739837398374, f1 :0.5696710938343593
classification report: 
              precision    recall  f1-score   support

         Con     0.6786    0.6726    0.6756       565
        None     0.5451    0.5195    0.5320       256
         Pro     0.4778    0.5276    0.5015       163

    accuracy                         0.6087       984
   macro avg     0.5671    0.5732    0.5697       984
weighted avg     0.6106    0.6087    0.6094       984

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 14-05-36', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 14-05-36
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5 total_loss: 1.7299  loss:1.7299,stance loss: 1.3115 
Train step: 10 acc:0.44318 total_loss: 1.6664  loss:1.6213,stance loss: 1.1681 
Better F1! Saving model!
Saving model of best f1: 0.36387264457439894
              precision    recall  f1-score   support

           0   0.574949  0.991150  0.727745       565
           1   0.400000  0.015625  0.030075       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.573171       984
   macro avg   0.324983  0.335592  0.252607       984
weighted avg   0.434193  0.573171  0.425686       984

Test Acc: 0.573170731707317 F1_ma:0.36387264457439894
Train step: 20 acc:0.49702 total_loss: 1.6485  loss:1.4682,stance loss: 1.0562 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 30 acc:0.4879 total_loss: 1.654  loss:1.6112,stance loss: 1.1796 
Train step: 40 acc:0.4939 total_loss: 1.6427  loss:1.5241,stance loss: 1.1124 
Train step: 50 acc:0.49387 total_loss: 1.6252  loss:1.2685,stance loss: 0.91729 
Train step: 60 acc:0.50205 total_loss: 1.6292  loss:1.7403,stance loss: 1.3057 
Train step: 70 acc:0.5044 total_loss: 1.626  loss:1.6446,stance loss: 1.2731 
Train step: 80 acc:0.50617 total_loss: 1.6185  loss:1.3573,stance loss: 0.95715 
Train step: 90 acc:0.50893 total_loss: 1.6065  loss:1.5927,stance loss: 1.0632 
Train step: 100 acc:0.5099 total_loss: 1.6014  loss:1.4339,stance loss: 0.94737 
Train step: 110 acc:0.49944 total_loss: 1.603  loss:1.458,stance loss: 1.0412 
Train step: 120 acc:0.49638 total_loss: 1.6005  loss:1.4879,stance loss: 1.0533 
Train step: 130 acc:0.50239 total_loss: 1.5963  loss:1.4511,stance loss: 0.98559 
Train step: 140 acc:0.50887 total_loss: 1.5857  loss:1.2633,stance loss: 0.92248 
Train step: 150 acc:0.5149 total_loss: 1.5703  loss:1.3408,stance loss: 0.77232 
Train step: 160 acc:0.51863 total_loss: 1.5643  loss:1.524,stance loss: 1.1138 
Train step: 170 acc:0.51681 total_loss: 1.5649  loss:1.5404,stance loss: 1.1282 
Train step: 180 acc:0.51588 total_loss: 1.5618  loss:1.4336,stance loss: 0.89754 
Train step: 190 acc:0.51832 total_loss: 1.5564  loss:1.7737,stance loss: 1.3562 
Train step: 200 acc:0.52114 total_loss: 1.5538  loss:1.3507,stance loss: 0.89481 
Train step: 210 acc:0.5237 total_loss: 1.5467  loss:1.4244,stance loss: 1.0901 
Train step: 220 acc:0.52376 total_loss: 1.5451  loss:1.4711,stance loss: 1.0206 
Train step: 230 acc:0.52624 total_loss: 1.5403  loss:1.3319,stance loss: 0.88294 
Train step: 240 acc:0.52516 total_loss: 1.5377  loss:1.5118,stance loss: 1.1 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.51562 total_loss: 1.4704  loss:1.6792,stance loss: 1.1422 
Train step: 260 acc:0.59028 total_loss: 1.4182  loss:1.7157,stance loss: 1.2846 
Train step: 270 acc:0.58705 total_loss: 1.4115  loss:1.3193,stance loss: 0.94623 
Train step: 280 acc:0.59046 total_loss: 1.4225  loss:1.2133,stance loss: 0.8971 
Train step: 290 acc:0.59115 total_loss: 1.418  loss:1.4969,stance loss: 1.0289 
Train step: 300 acc:0.59052 total_loss: 1.4057  loss:1.093,stance loss: 0.69898 
Train step: 310 acc:0.60478 total_loss: 1.3834  loss:1.4285,stance loss: 1.1363 
Train step: 320 acc:0.61779 total_loss: 1.3674  loss:1.1096,stance loss: 0.70418 
Train step: 330 acc:0.62642 total_loss: 1.3552  loss:0.98602,stance loss: 0.61605 
Train step: 340 acc:0.62755 total_loss: 1.356  loss:1.2497,stance loss: 0.83444 
Train step: 350 acc:0.62442 total_loss: 1.3594  loss:1.2057,stance loss: 0.7864 
Train step: 360 acc:0.62553 total_loss: 1.3591  loss:1.5062,stance loss: 1.2413 
Train step: 370 acc:0.63184 total_loss: 1.3551  loss:1.5438,stance loss: 1.2529 
Train step: 380 acc:0.62726 total_loss: 1.3605  loss:1.4663,stance loss: 1.0698 
Train step: 390 acc:0.62627 total_loss: 1.3579  loss:1.3608,stance loss: 0.98303 
Train step: 400 acc:0.62619 total_loss: 1.3573  loss:1.3095,stance loss: 1.0084 
Train step: 410 acc:0.63095 total_loss: 1.3491  loss:1.413,stance loss: 1.1365 
Train step: 420 acc:0.62921 total_loss: 1.3487  loss:1.2892,stance loss: 1.0694 
Train step: 430 acc:0.63265 total_loss: 1.3463  loss:1.2125,stance loss: 0.88934 
Train step: 440 acc:0.63321 total_loss: 1.3458  loss:1.5133,stance loss: 1.1934 
Train step: 450 acc:0.63161 total_loss: 1.3481  loss:1.03,stance loss: 0.7379 
Train step: 460 acc:0.63245 total_loss: 1.3457  loss:1.3101,stance loss: 0.87008 
Train step: 470 acc:0.63459 total_loss: 1.3378  loss:0.89565,stance loss: 0.53909 
Train step: 480 acc:0.63734 total_loss: 1.3314  loss:1.2331,stance loss: 0.94731 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.7 total_loss: 1.3139  loss:1.6982,stance loss: 1.5544 
Train step: 500 acc:0.69583 total_loss: 1.2498  loss:1.0299,stance loss: 0.67414 
Train step: 510 acc:0.6725 total_loss: 1.2269  loss:1.2122,stance loss: 0.76037 
Train step: 520 acc:0.67679 total_loss: 1.216  loss:1.7266,stance loss: 1.6473 
Train step: 530 acc:0.68056 total_loss: 1.2152  loss:1.6816,stance loss: 1.397 
Train step: 540 acc:0.68864 total_loss: 1.2236  loss:0.93238,stance loss: 0.76433 
Train step: 550 acc:0.68942 total_loss: 1.2162  loss:1.3639,stance loss: 1.1147 
Train step: 560 acc:0.68417 total_loss: 1.2242  loss:1.1828,stance loss: 0.90211 
Train step: 570 acc:0.67941 total_loss: 1.2305  loss:0.85482,stance loss: 0.5536 
Train step: 580 acc:0.67368 total_loss: 1.2423  loss:1.1189,stance loss: 0.84132 
Train step: 590 acc:0.67262 total_loss: 1.2419  loss:1.2595,stance loss: 1.0254 
Train step: 600 acc:0.67663 total_loss: 1.2335  loss:1.6718,stance loss: 1.2959 
Train step: 610 acc:0.677 total_loss: 1.2298  loss:1.1029,stance loss: 0.69236 
Train step: 620 acc:0.67824 total_loss: 1.2256  loss:1.1641,stance loss: 0.86144 
Train step: 630 acc:0.67629 total_loss: 1.2242  loss:1.0611,stance loss: 0.80811 
Train step: 640 acc:0.67379 total_loss: 1.2268  loss:1.26,stance loss: 0.93671 
Train step: 650 acc:0.67689 total_loss: 1.2165  loss:0.94813,stance loss: 0.70009 
Train step: 660 acc:0.67821 total_loss: 1.2197  loss:1.0396,stance loss: 0.81232 
Train step: 670 acc:0.67703 total_loss: 1.2169  loss:0.92319,stance loss: 0.59927 
Train step: 680 acc:0.67853 total_loss: 1.2143  loss:0.72022,stance loss: 0.49428 
Train step: 690 acc:0.67896 total_loss: 1.207  loss:1.2905,stance loss: 0.94935 
Train step: 700 acc:0.67674 total_loss: 1.2096  loss:1.4791,stance loss: 1.2055 
Train step: 710 acc:0.67917 total_loss: 1.2056  loss:1.0661,stance loss: 0.88859 
Train step: 720 acc:0.67899 total_loss: 1.2134  loss:1.5078,stance loss: 1.2956 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.6875 total_loss: 1.1132  loss:0.87438,stance loss: 0.6593 
Train step: 740 acc:0.69271 total_loss: 1.1202  loss:1.6529,stance loss: 1.6998 
Better F1! Saving model!
Saving model of best f1: 0.3995465046633011
              precision    recall  f1-score   support

           0   0.680212  0.681416  0.680813       565
           1   0.534177  0.824219  0.648233       256
           2   0.478261  0.067485  0.118280       163

    accuracy                       0.616870       984
   macro avg   0.564217  0.524373  0.482442       984
weighted avg   0.608766  0.616870  0.579153       984

Test Acc: 0.616869918699187 F1_ma:0.3995465046633011
Train step: 750 acc:0.66761 total_loss: 1.155  loss:1.1804,stance loss: 0.87398 
Better F1! Saving model!
Saving model of best f1: 0.4223188450291276
              precision    recall  f1-score   support

           0   0.663265  0.690265  0.676496       565
           1   0.546547  0.710938  0.617997       256
           2   0.301587  0.116564  0.168142       163

    accuracy                       0.600610       984
   macro avg   0.503800  0.505922  0.487545       984
weighted avg   0.572987  0.600610  0.577068       984

Test Acc: 0.600609756097561 F1_ma:0.4223188450291276
Train step: 760 acc:0.67773 total_loss: 1.1159  loss:0.86171,stance loss: 0.52907 
Train step: 770 acc:0.67708 total_loss: 1.123  loss:0.95238,stance loss: 0.66766 
Train step: 780 acc:0.6875 total_loss: 1.1113  loss:0.6914,stance loss: 0.38836 
Train step: 790 acc:0.69153 total_loss: 1.1119  loss:1.1276,stance loss: 1.2223 
Train step: 800 acc:0.68056 total_loss: 1.1386  loss:0.93491,stance loss: 0.62893 
Better F1! Saving model!
Saving model of best f1: 0.49076986188978533
              precision    recall  f1-score   support

           0   0.680000  0.601770  0.638498       565
           1   0.550296  0.726562  0.626263       256
           2   0.363014  0.325153  0.343042       163

    accuracy                       0.588415       984
   macro avg   0.531103  0.551162  0.535934       984
weighted avg   0.593747  0.588415  0.586372       984

Test Acc: 0.5884146341463414 F1_ma:0.49076986188978533
Train step: 810 acc:0.68598 total_loss: 1.1178  loss:1.168,stance loss: 0.84714 
Train step: 820 acc:0.6909 total_loss: 1.1145  loss:0.99035,stance loss: 0.54728 
Train step: 830 acc:0.69363 total_loss: 1.1143  loss:1.1788,stance loss: 0.89555 
Train step: 840 acc:0.69978 total_loss: 1.1002  loss:0.71365,stance loss: 0.57733 
Train step: 850 acc:0.70338 total_loss: 1.1049  loss:1.5049,stance loss: 1.3217 
Train step: 860 acc:0.70502 total_loss: 1.1045  loss:0.82908,stance loss: 0.62993 
Train step: 870 acc:0.70158 total_loss: 1.1115  loss:1.6474,stance loss: 1.1382 
Train step: 880 acc:0.6986 total_loss: 1.1195  loss:1.3418,stance loss: 1.0915 
Train step: 890 acc:0.69329 total_loss: 1.1304  loss:1.2109,stance loss: 0.91262 
Train step: 900 acc:0.69477 total_loss: 1.1273  loss:0.93134,stance loss: 0.84377 
Train step: 910 acc:0.69505 total_loss: 1.1271  loss:1.031,stance loss: 1.2282 
Train step: 920 acc:0.69466 total_loss: 1.1254  loss:1.7686,stance loss: 1.7818 
Train step: 930 acc:0.6974 total_loss: 1.1258  loss:0.89803,stance loss: 0.74312 
Train step: 940 acc:0.69929 total_loss: 1.1228  loss:1.3448,stance loss: 1.0986 
Train step: 950 acc:0.70214 total_loss: 1.1205  loss:1.1023,stance loss: 0.86441 
Train step: 960 acc:0.70151 total_loss: 1.1218  loss:1.0177,stance loss: 0.78847 
Train step: 970 acc:0.69912 total_loss: 1.1257  loss:1.2302,stance loss: 0.9856 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.66667 total_loss: 1.1082  loss:0.65613,stance loss: 0.47793 
Train step: 990 acc:0.68421 total_loss: 1.0919  loss:1.0659,stance loss: 0.8003 
Train step: 1000 acc:0.71983 total_loss: 1.073  loss:0.69302,stance loss: 0.43828 
Train step: 1010 acc:0.71635 total_loss: 1.053  loss:1.0199,stance loss: 0.70723 
Train step: 1020 acc:0.71811 total_loss: 1.0412  loss:0.72039,stance loss: 0.62749 
Train step: 1030 acc:0.72458 total_loss: 1.015  loss:0.99998,stance loss: 0.80969 
Train step: 1040 acc:0.71377 total_loss: 1.0281  loss:1.3297,stance loss: 0.89431 
Train step: 1050 acc:0.71598 total_loss: 1.0179  loss:1.1499,stance loss: 1.0346 
Train step: 1060 acc:0.71489 total_loss: 1.0194  loss:0.87249,stance loss: 0.75585 
Train step: 1070 acc:0.71149 total_loss: 1.0258  loss:0.75435,stance loss: 0.57091 
Train step: 1080 acc:0.71044 total_loss: 1.0286  loss:1.1747,stance loss: 0.83931 
Train step: 1090 acc:0.71376 total_loss: 1.0335  loss:1.9082,stance loss: 1.7904 
Train step: 1100 acc:0.7156 total_loss: 1.0405  loss:0.63349,stance loss: 0.47762 
Train step: 1110 acc:0.72077 total_loss: 1.0365  loss:0.7329,stance loss: 0.60603 
Train step: 1120 acc:0.7198 total_loss: 1.0289  loss:1.1149,stance loss: 0.81325 
Train step: 1130 acc:0.71777 total_loss: 1.0254  loss:1.0827,stance loss: 0.68793 
Train step: 1140 acc:0.71746 total_loss: 1.03  loss:0.94004,stance loss: 0.73642 
Train step: 1150 acc:0.72032 total_loss: 1.024  loss:0.68091,stance loss: 0.41331 
Train step: 1160 acc:0.72123 total_loss: 1.0257  loss:1.1385,stance loss: 1.2987 
Train step: 1170 acc:0.72393 total_loss: 1.0177  loss:1.0965,stance loss: 0.91669 
Train step: 1180 acc:0.72339 total_loss: 1.0161  loss:1.4068,stance loss: 1.015 
Train step: 1190 acc:0.72232 total_loss: 1.0172  loss:0.96811,stance loss: 0.77873 
Train step: 1200 acc:0.72353 total_loss: 1.0158  loss:0.96134,stance loss: 0.76783 
Train step: 1210 acc:0.72359 total_loss: 1.0147  loss:0.62281,stance loss: 0.49066 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.6875 total_loss: 1.0312  loss:0.81719,stance loss: 0.64943 
Train step: 1230 acc:0.70703 total_loss: 0.97728  loss:1.078,stance loss: 0.73736 
Train step: 1240 acc:0.74038 total_loss: 0.91831  loss:0.96588,stance loss: 1.2986 
Train step: 1250 acc:0.72743 total_loss: 0.94601  loss:0.74863,stance loss: 0.55662 
Train step: 1260 acc:0.7337 total_loss: 0.93738  loss:0.84736,stance loss: 0.50517 
Train step: 1270 acc:0.73884 total_loss: 0.93881  loss:0.61621,stance loss: 0.44718 
Train step: 1280 acc:0.74053 total_loss: 0.9367  loss:1.1164,stance loss: 1.4291 
Better F1! Saving model!
Saving model of best f1: 0.5023023415303223
              precision    recall  f1-score   support

           0   0.680761  0.569912  0.620424       565
           1   0.556250  0.695312  0.618056       256
           2   0.356021  0.417178  0.384181       163

    accuracy                       0.577236       984
   macro avg   0.531011  0.560801  0.540887       984
weighted avg   0.594575  0.577236  0.580674       984

Test Acc: 0.5772357723577236 F1_ma:0.5023023415303223
Train step: 1290 acc:0.74095 total_loss: 0.93175  loss:0.75034,stance loss: 0.68032 
Train step: 1300 acc:0.73983 total_loss: 0.92506  loss:0.63076,stance loss: 0.43049 
Train step: 1310 acc:0.74154 total_loss: 0.93013  loss:1.3083,stance loss: 0.82471 
Train step: 1320 acc:0.74351 total_loss: 0.93081  loss:1.3037,stance loss: 1.1625 
Train step: 1330 acc:0.743 total_loss: 0.93947  loss:1.1561,stance loss: 0.95717 
Train step: 1340 acc:0.74306 total_loss: 0.94647  loss:1.2093,stance loss: 1.3649 
Train step: 1350 acc:0.74173 total_loss: 0.96044  loss:0.77477,stance loss: 0.51761 
Train step: 1360 acc:0.74229 total_loss: 0.95991  loss:0.60929,stance loss: 0.47571 
Better F1! Saving model!
Saving model of best f1: 0.5089061254522043
              precision    recall  f1-score   support

           0   0.650089  0.647788  0.648936       565
           1   0.611814  0.566406  0.588235       256
           2   0.347826  0.392638  0.368876       163

    accuracy                       0.584350       984
   macro avg   0.536576  0.535611  0.535349       984
weighted avg   0.590061  0.584350  0.586752       984

Test Acc: 0.584349593495935 F1_ma:0.5089061254522043
Train step: 1370 acc:0.74599 total_loss: 0.95389  loss:0.92193,stance loss: 0.62343 
Train step: 1380 acc:0.74849 total_loss: 0.95088  loss:1.3656,stance loss: 1.5761 
Train step: 1390 acc:0.74893 total_loss: 0.94683  loss:0.98203,stance loss: 0.80575 
Better F1! Saving model!
Saving model of best f1: 0.5175048299279902
              precision    recall  f1-score   support

           0   0.664804  0.631858  0.647913       565
           1   0.579926  0.609375  0.594286       256
           2   0.370787  0.404908  0.387097       163

    accuracy                       0.588415       984
   macro avg   0.538506  0.548714  0.543098       984
weighted avg   0.594018  0.588415  0.590757       984

Test Acc: 0.5884146341463414 F1_ma:0.5175048299279902
Train step: 1400 acc:0.75168 total_loss: 0.93735  loss:1.1974,stance loss: 1.4126 
Train step: 1410 acc:0.75319 total_loss: 0.93165  loss:0.99225,stance loss: 0.74772 
Train step: 1420 acc:0.75364 total_loss: 0.93353  loss:1.1039,stance loss: 0.85208 
Train step: 1430 acc:0.75434 total_loss: 0.93328  loss:1.7579,stance loss: 1.7286 
Train step: 1440 acc:0.7536 total_loss: 0.93115  loss:0.88531,stance loss: 0.74528 
Train step: 1450 acc:0.75609 total_loss: 0.92399  loss:0.76367,stance loss: 0.69365 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.79167 total_loss: 1.0182  loss:0.67404,stance loss: 0.58672 
Train step: 1470 acc:0.78365 total_loss: 0.98686  loss:0.92229,stance loss: 0.68311 
Train step: 1480 acc:0.78261 total_loss: 0.93717  loss:1.0681,stance loss: 1.4797 
Train step: 1490 acc:0.78788 total_loss: 0.88612  loss:0.64171,stance loss: 0.46417 
Train step: 1500 acc:0.78343 total_loss: 0.87078  loss:1.5247,stance loss: 1.4951 
Train step: 1510 acc:0.79481 total_loss: 0.86529  loss:1.0611,stance loss: 0.89561 
Train step: 1520 acc:0.79067 total_loss: 0.85413  loss:0.9716,stance loss: 0.69024 
Train step: 1530 acc:0.79195 total_loss: 0.8507  loss:0.8385,stance loss: 0.75298 
Train step: 1540 acc:0.79292 total_loss: 0.85158  loss:0.99716,stance loss: 0.72182 
Better F1! Saving model!
Saving model of best f1: 0.5279405410076916
              precision    recall  f1-score   support

           0   0.693333  0.552212  0.614778       565
           1   0.567114  0.660156  0.610108       256
           2   0.372881  0.539877  0.441103       163

    accuracy                       0.578252       984
   macro avg   0.544443  0.584082  0.555330       984
weighted avg   0.607413  0.578252  0.584794       984

Test Acc: 0.5782520325203252 F1_ma:0.5279405410076916
Train step: 1550 acc:0.79435 total_loss: 0.84646  loss:1.017,stance loss: 1.1456 
Train step: 1560 acc:0.79308 total_loss: 0.8464  loss:1.0871,stance loss: 0.9549 
Train step: 1570 acc:0.78872 total_loss: 0.85582  loss:0.94178,stance loss: 0.64703 
Better F1! Saving model!
Saving model of best f1: 0.5314678344910904
              precision    recall  f1-score   support

           0   0.689720  0.653097  0.670909       565
           1   0.549839  0.667969  0.603175       256
           2   0.427536  0.361963  0.392027       163

    accuracy                       0.608740       984
   macro avg   0.555698  0.561010  0.555370       984
weighted avg   0.609897  0.608740  0.607090       984

Test Acc: 0.608739837398374 F1_ma:0.5314678344910904
Train step: 1580 acc:0.78862 total_loss: 0.85124  loss:0.65961,stance loss: 0.58256 
Train step: 1590 acc:0.79088 total_loss: 0.84427  loss:0.86384,stance loss: 0.50343 
Better F1! Saving model!
Saving model of best f1: 0.543055727102258
              precision    recall  f1-score   support

           0   0.688976  0.619469  0.652377       565
           1   0.550489  0.660156  0.600355       256
           2   0.426036  0.441718  0.433735       163

    accuracy                       0.600610       984
   macro avg   0.555167  0.573781  0.562156       984
weighted avg   0.609391  0.600610  0.602624       984

Test Acc: 0.600609756097561 F1_ma:0.543055727102258
Train step: 1600 acc:0.79283 total_loss: 0.83325  loss:1.0331,stance loss: 1.169 
Train step: 1610 acc:0.79453 total_loss: 0.83377  loss:1.1205,stance loss: 1.3993 
Train step: 1620 acc:0.79448 total_loss: 0.83812  loss:0.73863,stance loss: 0.64119 
Train step: 1630 acc:0.79227 total_loss: 0.84308  loss:0.66344,stance loss: 0.62039 
Train step: 1640 acc:0.79303 total_loss: 0.84156  loss:0.85469,stance loss: 0.65341 
Train step: 1650 acc:0.79372 total_loss: 0.84455  loss:0.67442,stance loss: 0.45214 
Train step: 1660 acc:0.79464 total_loss: 0.83781  loss:1.201,stance loss: 1.0717 
Train step: 1670 acc:0.79167 total_loss: 0.83848  loss:1.2958,stance loss: 1.1194 
Train step: 1680 acc:0.78924 total_loss: 0.84483  loss:1.3344,stance loss: 1.0758 
Train step: 1690 acc:0.7897 total_loss: 0.84154  loss:0.64269,stance loss: 0.41466 
Train step: 1700 acc:0.78847 total_loss: 0.84833  loss:1.1551,stance loss: 1.3368 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.83125 total_loss: 0.77672  loss:0.45294,stance loss: 0.30021 
Train step: 1720 acc:0.84062 total_loss: 0.76585  loss:1.4063,stance loss: 1.7026 
Train step: 1730 acc:0.82708 total_loss: 0.76823  loss:1.0058,stance loss: 0.86625 
Train step: 1740 acc:0.84062 total_loss: 0.72523  loss:1.1215,stance loss: 1.1044 
Train step: 1750 acc:0.83375 total_loss: 0.73013  loss:0.55173,stance loss: 0.43466 
Train step: 1760 acc:0.82396 total_loss: 0.74693  loss:0.67263,stance loss: 0.45238 
Train step: 1770 acc:0.82589 total_loss: 0.75141  loss:0.69111,stance loss: 0.55373 
Train step: 1780 acc:0.81563 total_loss: 0.77649  loss:0.716,stance loss: 0.54075 
Train step: 1790 acc:0.8125 total_loss: 0.77907  loss:0.70564,stance loss: 0.47004 
Train step: 1800 acc:0.81 total_loss: 0.78738  loss:0.56122,stance loss: 0.44833 
Train step: 1810 acc:0.80909 total_loss: 0.78764  loss:1.2106,stance loss: 1.1175 
Train step: 1820 acc:0.80677 total_loss: 0.78964  loss:0.83858,stance loss: 0.6779 
Train step: 1830 acc:0.80817 total_loss: 0.78452  loss:0.59876,stance loss: 0.41726 
Train step: 1840 acc:0.81027 total_loss: 0.77788  loss:0.44902,stance loss: 0.41818 
Train step: 1850 acc:0.81167 total_loss: 0.7796  loss:0.66794,stance loss: 0.5876 
Train step: 1860 acc:0.81172 total_loss: 0.77514  loss:0.86811,stance loss: 0.74296 
Train step: 1870 acc:0.80846 total_loss: 0.77416  loss:0.69196,stance loss: 0.56404 
Better F1! Saving model!
Saving model of best f1: 0.5551281548062958
              precision    recall  f1-score   support

           0   0.679245  0.637168  0.657534       565
           1   0.570896  0.597656  0.583969       256
           2   0.424731  0.484663  0.452722       163

    accuracy                       0.601626       984
   macro avg   0.558291  0.573162  0.564742       984
weighted avg   0.608896  0.601626  0.604468       984

Test Acc: 0.6016260162601627 F1_ma:0.5551281548062958
Train step: 1880 acc:0.80833 total_loss: 0.77191  loss:1.2184,stance loss: 1.3411 
Train step: 1890 acc:0.8102 total_loss: 0.76435  loss:0.66653,stance loss: 0.53268 
Train step: 1900 acc:0.8125 total_loss: 0.759  loss:0.23519,stance loss: 0.085628 
Train step: 1910 acc:0.8119 total_loss: 0.75309  loss:0.48608,stance loss: 0.34049 
Train step: 1920 acc:0.8125 total_loss: 0.75228  loss:0.25887,stance loss: 0.087206 
Train step: 1930 acc:0.81141 total_loss: 0.75739  loss:0.98147,stance loss: 1.369 
Train step: 1940 acc:0.81328 total_loss: 0.75298  loss:0.62894,stance loss: 0.49333 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.82143 total_loss: 0.79215  loss:1.1116,stance loss: 0.963 
Train step: 1960 acc:0.84926 total_loss: 0.64743  loss:0.78127,stance loss: 0.66051 
Train step: 1970 acc:0.84491 total_loss: 0.62573  loss:0.49383,stance loss: 0.38968 
Train step: 1980 acc:0.84966 total_loss: 0.62086  loss:0.67655,stance loss: 0.53439 
Train step: 1990 acc:0.85638 total_loss: 0.61601  loss:0.65816,stance loss: 0.53424 
Train step: 2000 acc:0.86294 total_loss: 0.59357  loss:0.33479,stance loss: 0.26738 
Train step: 2010 acc:0.85634 total_loss: 0.62713  loss:1.5019,stance loss: 1.4613 
Train step: 2020 acc:0.85958 total_loss: 0.61867  loss:1.0083,stance loss: 0.72765 
Train step: 2030 acc:0.8556 total_loss: 0.63219  loss:0.73211,stance loss: 0.46941 
Train step: 2040 acc:0.85245 total_loss: 0.6448  loss:1.0841,stance loss: 1.0065 
Train step: 2050 acc:0.85222 total_loss: 0.63157  loss:0.42347,stance loss: 0.15198 
Train step: 2060 acc:0.84829 total_loss: 0.65249  loss:1.1718,stance loss: 1.533 
Train step: 2070 acc:0.84646 total_loss: 0.66557  loss:0.57101,stance loss: 0.5181 
Train step: 2080 acc:0.84763 total_loss: 0.67233  loss:0.27493,stance loss: 0.16758 
Train step: 2090 acc:0.84609 total_loss: 0.68069  loss:0.63249,stance loss: 0.44865 
Train step: 2100 acc:0.84634 total_loss: 0.68062  loss:0.55791,stance loss: 0.42301 
Train step: 2110 acc:0.8488 total_loss: 0.66887  loss:0.11538,stance loss: 0.030931 
Train step: 2120 acc:0.84675 total_loss: 0.67245  loss:0.58332,stance loss: 0.46772 
Train step: 2130 acc:0.84626 total_loss: 0.67498  loss:1.0951,stance loss: 0.91778 
Train step: 2140 acc:0.84645 total_loss: 0.67184  loss:0.93603,stance loss: 0.76128 
Train step: 2150 acc:0.84511 total_loss: 0.67346  loss:0.84858,stance loss: 0.80942 
Train step: 2160 acc:0.84533 total_loss: 0.67363  loss:0.86814,stance loss: 0.74338 
Train step: 2170 acc:0.84581 total_loss: 0.67274  loss:1.1475,stance loss: 1.2746 
Train step: 2180 acc:0.84441 total_loss: 0.67765  loss:0.67292,stance loss: 0.44134 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.89062 total_loss: 0.48692  loss:0.35394,stance loss: 0.035793 
Train step: 2200 acc:0.89286 total_loss: 0.58739  loss:0.50715,stance loss: 0.39924 
Train step: 2210 acc:0.875 total_loss: 0.63245  loss:0.47348,stance loss: 0.38222 
Train step: 2220 acc:0.87868 total_loss: 0.60522  loss:0.47375,stance loss: 0.41166 
Train step: 2230 acc:0.86932 total_loss: 0.60322  loss:0.69574,stance loss: 0.52291 
Train step: 2240 acc:0.86111 total_loss: 0.62885  loss:0.93868,stance loss: 0.89951 
Train step: 2250 acc:0.85645 total_loss: 0.63765  loss:0.40411,stance loss: 0.35935 
Train step: 2260 acc:0.85895 total_loss: 0.62648  loss:0.51227,stance loss: 0.38173 
Train step: 2270 acc:0.8564 total_loss: 0.62411  loss:0.4592,stance loss: 0.15356 
Train step: 2280 acc:0.86303 total_loss: 0.60398  loss:0.38534,stance loss: 0.31279 
Train step: 2290 acc:0.86238 total_loss: 0.60408  loss:0.61072,stance loss: 0.41849 
Train step: 2300 acc:0.86075 total_loss: 0.6036  loss:0.54556,stance loss: 0.44484 
Train step: 2310 acc:0.86089 total_loss: 0.60156  loss:0.57331,stance loss: 0.4527 
Train step: 2320 acc:0.86101 total_loss: 0.59452  loss:0.37142,stance loss: 0.22009 
Train step: 2330 acc:0.85981 total_loss: 0.59734  loss:1.009,stance loss: 1.3915 
Train step: 2340 acc:0.85917 total_loss: 0.59409  loss:0.39866,stance loss: 0.35708 
Train step: 2350 acc:0.86052 total_loss: 0.58751  loss:0.77577,stance loss: 0.62074 
Train step: 2360 acc:0.86386 total_loss: 0.57824  loss:0.40259,stance loss: 0.35009 
Train step: 2370 acc:0.86379 total_loss: 0.57916  loss:0.54322,stance loss: 0.34217 
Train step: 2380 acc:0.86534 total_loss: 0.57746  loss:0.648,stance loss: 1.0904 
Train step: 2390 acc:0.86581 total_loss: 0.57183  loss:0.45338,stance loss: 0.467 
Train step: 2400 acc:0.86536 total_loss: 0.5728  loss:0.4572,stance loss: 0.43154 
Train step: 2410 acc:0.86579 total_loss: 0.57604  loss:0.61565,stance loss: 0.62359 
Train step: 2420 acc:0.86538 total_loss: 0.58174  loss:1.9608,stance loss: 2.121 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.43233  loss:0.43233,stance loss: 0.36305 
Train step: 2440 acc:0.86932 total_loss: 0.57481  loss:1.0609,stance loss: 0.94063 
Train step: 2450 acc:0.8631 total_loss: 0.56532  loss:0.84995,stance loss: 1.1553 
Train step: 2460 acc:0.86895 total_loss: 0.59782  loss:0.28381,stance loss: 0.23531 
Train step: 2470 acc:0.88415 total_loss: 0.5327  loss:0.34284,stance loss: 0.28347 
Train step: 2480 acc:0.89093 total_loss: 0.51294  loss:0.50312,stance loss: 0.25389 
Train step: 2490 acc:0.89652 total_loss: 0.49918  loss:0.38606,stance loss: 0.33629 
Train step: 2500 acc:0.89965 total_loss: 0.49975  loss:0.23595,stance loss: 0.077862 
Train step: 2510 acc:0.8966 total_loss: 0.50494  loss:0.30715,stance loss: 0.22505 
Train step: 2520 acc:0.89423 total_loss: 0.51294  loss:0.77568,stance loss: 1.236 
Train step: 2530 acc:0.89171 total_loss: 0.51051  loss:0.97135,stance loss: 0.66 
Train step: 2540 acc:0.89414 total_loss: 0.51965  loss:0.71661,stance loss: 0.6603 
Train step: 2550 acc:0.89566 total_loss: 0.50944  loss:0.55297,stance loss: 0.47309 
Train step: 2560 acc:0.89742 total_loss: 0.51093  loss:0.75195,stance loss: 0.69002 
Train step: 2570 acc:0.89761 total_loss: 0.50975  loss:0.36102,stance loss: 0.34995 
Train step: 2580 acc:0.89487 total_loss: 0.51572  loss:1.2185,stance loss: 1.2356 
Train step: 2590 acc:0.89596 total_loss: 0.51105  loss:0.61401,stance loss: 0.42399 
Train step: 2600 acc:0.89474 total_loss: 0.5138  loss:0.92043,stance loss: 1.3049 
Train step: 2610 acc:0.89675 total_loss: 0.50816  loss:0.326,stance loss: 0.24237 
Train step: 2620 acc:0.89692 total_loss: 0.50283  loss:0.46108,stance loss: 0.35838 
Train step: 2630 acc:0.89832 total_loss: 0.49995  loss:0.1894,stance loss: 0.085858 
Train step: 2640 acc:0.8984 total_loss: 0.4987  loss:0.37813,stance loss: 0.35206 
Train step: 2650 acc:0.89819 total_loss: 0.50094  loss:1.0354,stance loss: 0.85708 
Train step: 2660 acc:0.89746 total_loss: 0.50468  loss:0.67512,stance loss: 0.51034 
Train step: 2670 acc:0.89678 total_loss: 0.50314  loss:0.54122,stance loss: 0.42534 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.90625 total_loss: 0.47419  loss:0.64492,stance loss: 0.56695 
Train step: 2690 acc:0.89236 total_loss: 0.54197  loss:0.74588,stance loss: 0.69722 
Train step: 2700 acc:0.89062 total_loss: 0.50324  loss:0.33649,stance loss: 0.21637 
Train step: 2710 acc:0.89309 total_loss: 0.50556  loss:0.46255,stance loss: 0.35186 
Train step: 2720 acc:0.90104 total_loss: 0.47617  loss:0.1717,stance loss: 0.12328 
Train step: 2730 acc:0.90194 total_loss: 0.47226  loss:0.66398,stance loss: 0.5271 
Train step: 2740 acc:0.90533 total_loss: 0.45495  loss:0.19468,stance loss: 0.14373 
Train step: 2750 acc:0.90385 total_loss: 0.4561  loss:0.54243,stance loss: 0.42592 
Train step: 2760 acc:0.90554 total_loss: 0.45322  loss:0.24411,stance loss: 0.097383 
Train step: 2770 acc:0.90434 total_loss: 0.45072  loss:0.30093,stance loss: 0.20227 
Train step: 2780 acc:0.90683 total_loss: 0.44612  loss:0.46325,stance loss: 0.35747 
Train step: 2790 acc:0.90837 total_loss: 0.43826  loss:0.2263,stance loss: 0.15728 
Train step: 2800 acc:0.9082 total_loss: 0.44232  loss:0.15811,stance loss: 0.086203 
Train step: 2810 acc:0.90942 total_loss: 0.43249  loss:0.24735,stance loss: 0.18606 
Train step: 2820 acc:0.90921 total_loss: 0.43555  loss:1.15,stance loss: 0.8332 
Train step: 2830 acc:0.90941 total_loss: 0.44446  loss:0.74752,stance loss: 0.51277 
Train step: 2840 acc:0.90997 total_loss: 0.44141  loss:0.7211,stance loss: 0.46231 
Train step: 2850 acc:0.90906 total_loss: 0.4451  loss:0.49079,stance loss: 0.48108 
Train step: 2860 acc:0.90858 total_loss: 0.44667  loss:0.61225,stance loss: 0.52598 
Train step: 2870 acc:0.90972 total_loss: 0.4438  loss:0.088357,stance loss: 0.046448 
Train step: 2880 acc:0.91016 total_loss: 0.44451  loss:0.91912,stance loss: 0.83822 
Train step: 2890 acc:0.90998 total_loss: 0.44667  loss:0.5086,stance loss: 0.31213 
Train step: 2900 acc:0.90927 total_loss: 0.44606  loss:0.25745,stance loss: 0.23359 
Train step: 2910 acc:0.90861 total_loss: 0.44781  loss:0.16191,stance loss: 0.09432 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.9125 total_loss: 0.43179  loss:0.67283,stance loss: 0.51967 
Train step: 2930 acc:0.90833 total_loss: 0.36656  loss:0.25211,stance loss: 0.18122 
Train step: 2940 acc:0.9075 total_loss: 0.42793  loss:1.3864,stance loss: 1.1269 
Train step: 2950 acc:0.90179 total_loss: 0.43448  loss:0.34476,stance loss: 0.26227 
Train step: 2960 acc:0.91111 total_loss: 0.40808  loss:0.39269,stance loss: 0.33441 
Train step: 2970 acc:0.91136 total_loss: 0.43122  loss:0.19382,stance loss: 0.15046 
Train step: 2980 acc:0.91058 total_loss: 0.4362  loss:0.3173,stance loss: 0.23085 
Train step: 2990 acc:0.91083 total_loss: 0.4452  loss:0.90849,stance loss: 0.37707 
Train step: 3000 acc:0.91324 total_loss: 0.43076  loss:0.44859,stance loss: 0.2627 
Train step: 3010 acc:0.91579 total_loss: 0.42732  loss:0.11468,stance loss: 0.069582 
Train step: 3020 acc:0.91726 total_loss: 0.42512  loss:0.43515,stance loss: 0.37349 
Train step: 3030 acc:0.91902 total_loss: 0.41564  loss:0.36856,stance loss: 0.3157 
Train step: 3040 acc:0.919 total_loss: 0.40912  loss:0.32555,stance loss: 0.35193 
Train step: 3050 acc:0.91944 total_loss: 0.4028  loss:0.49266,stance loss: 0.39541 
Train step: 3060 acc:0.91983 total_loss: 0.40997  loss:0.5847,stance loss: 0.50768 
Train step: 3070 acc:0.91976 total_loss: 0.41168  loss:0.14901,stance loss: 0.10168 
Train step: 3080 acc:0.91932 total_loss: 0.41253  loss:0.13644,stance loss: 0.074643 
Train step: 3090 acc:0.92107 total_loss: 0.40476  loss:0.16994,stance loss: 0.10119 
Train step: 3100 acc:0.92027 total_loss: 0.40705  loss:0.51395,stance loss: 0.50532 
Train step: 3110 acc:0.92051 total_loss: 0.40257  loss:0.25027,stance loss: 0.17923 
Train step: 3120 acc:0.92256 total_loss: 0.39578  loss:0.073492,stance loss: 0.022763 
Train step: 3130 acc:0.92326 total_loss: 0.39562  loss:0.48339,stance loss: 0.41001 
Train step: 3140 acc:0.92444 total_loss: 0.38737  loss:0.54446,stance loss: 0.76355 
Train step: 3150 acc:0.92527 total_loss: 0.3848  loss:0.08072,stance loss: 0.014193 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:0.9375 total_loss: 0.22914  loss:0.13275,stance loss: 0.071123 
Train step: 3170 acc:0.95312 total_loss: 0.3513  loss:0.96751,stance loss: 0.85669 
Train step: 3180 acc:0.94602 total_loss: 0.37418  loss:0.10164,stance loss: 0.047199 
Train step: 3190 acc:0.94727 total_loss: 0.35769  loss:0.29275,stance loss: 0.22202 
Train step: 3200 acc:0.9375 total_loss: 0.36639  loss:0.49644,stance loss: 0.45981 
Train step: 3210 acc:0.9363 total_loss: 0.36432  loss:0.20209,stance loss: 0.13586 
Train step: 3220 acc:0.93649 total_loss: 0.36687  loss:0.28923,stance loss: 0.26886 
Train step: 3230 acc:0.93403 total_loss: 0.36848  loss:0.30478,stance loss: 0.25453 
Train step: 3240 acc:0.93826 total_loss: 0.34475  loss:0.068839,stance loss: 0.0098258 
Train step: 3250 acc:0.93614 total_loss: 0.33822  loss:0.20677,stance loss: 0.14725 
Train step: 3260 acc:0.93566 total_loss: 0.3376  loss:0.52207,stance loss: 0.37504 
Train step: 3270 acc:0.93638 total_loss: 0.33119  loss:0.38653,stance loss: 0.37397 
Train step: 3280 acc:0.93545 total_loss: 0.33342  loss:0.42976,stance loss: 0.3775 
Train step: 3290 acc:0.93655 total_loss: 0.33345  loss:0.46671,stance loss: 0.30677 
Train step: 3300 acc:0.93882 total_loss: 0.32711  loss:0.059369,stance loss: 0.023212 
Train step: 3310 acc:0.9375 total_loss: 0.32667  loss:0.40337,stance loss: 0.4521 
Train step: 3320 acc:0.93866 total_loss: 0.32469  loss:0.16964,stance loss: 0.13321 
Train step: 3330 acc:0.93859 total_loss: 0.32845  loss:0.66336,stance loss: 1.046 
Train step: 3340 acc:0.93716 total_loss: 0.33492  loss:0.21773,stance loss: 0.10694 
Train step: 3350 acc:0.93652 total_loss: 0.33523  loss:0.48789,stance loss: 0.37743 
Train step: 3360 acc:0.93626 total_loss: 0.34172  loss:0.064701,stance loss: 0.021645 
Train step: 3370 acc:0.93691 total_loss: 0.3419  loss:0.24339,stance loss: 0.28189 
Train step: 3380 acc:0.93806 total_loss: 0.33976  loss:0.30761,stance loss: 0.21851 
Train step: 3390 acc:0.93831 total_loss: 0.33737  loss:0.23249,stance loss: 0.19279 
Train step: 3400 acc:0.93853 total_loss: 0.33438  loss:0.12132,stance loss: 0.063957 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.98611 total_loss: 0.19985  loss:0.030386,stance loss: 0.0065895 
Train step: 3420 acc:0.96382 total_loss: 0.27209  loss:0.39206,stance loss: 0.26296 
Train step: 3430 acc:0.96121 total_loss: 0.27289  loss:0.15176,stance loss: 0.10562 
Train step: 3440 acc:0.95994 total_loss: 0.27564  loss:0.091145,stance loss: 0.070291 
Train step: 3450 acc:0.96046 total_loss: 0.27883  loss:0.58553,stance loss: 0.45235 
Train step: 3460 acc:0.96186 total_loss: 0.26294  loss:0.10717,stance loss: 0.040791 
Train step: 3470 acc:0.96105 total_loss: 0.25587  loss:0.35564,stance loss: 0.24806 
Train step: 3480 acc:0.9644 total_loss: 0.24909  loss:0.087408,stance loss: 0.049755 
Train step: 3490 acc:0.96208 total_loss: 0.2489  loss:0.13705,stance loss: 0.12626 
Train step: 3500 acc:0.96338 total_loss: 0.24594  loss:0.091548,stance loss: 0.042234 
Train step: 3510 acc:0.96502 total_loss: 0.24677  loss:0.099547,stance loss: 0.06041 
Train step: 3520 acc:0.96481 total_loss: 0.24502  loss:0.18054,stance loss: 0.13199 
Train step: 3530 acc:0.96366 total_loss: 0.25041  loss:0.028133,stance loss: 0.0061902 
Train step: 3540 acc:0.96448 total_loss: 0.26355  loss:0.5544,stance loss: 0.52117 
Train step: 3550 acc:0.96393 total_loss: 0.27132  loss:0.14717,stance loss: 0.10763 
Train step: 3560 acc:0.96423 total_loss: 0.27345  loss:0.080593,stance loss: 0.013775 
Train step: 3570 acc:0.96339 total_loss: 0.27546  loss:0.55572,stance loss: 1.0106 
Train step: 3580 acc:0.96194 total_loss: 0.27672  loss:0.87561,stance loss: 0.80467 
Train step: 3590 acc:0.96065 total_loss: 0.28314  loss:0.56279,stance loss: 0.59733 
Train step: 3600 acc:0.96043 total_loss: 0.28437  loss:0.12055,stance loss: 0.040781 
Train step: 3610 acc:0.96083 total_loss: 0.2831  loss:0.84362,stance loss: 0.72217 
Train step: 3620 acc:0.96062 total_loss: 0.28083  loss:0.23128,stance loss: 0.18897 
Train step: 3630 acc:0.95852 total_loss: 0.28367  loss:0.19826,stance loss: 0.1689 
Train step: 3640 acc:0.95842 total_loss: 0.28436  loss:0.5707,stance loss: 0.53175 
Training finished.


Reload the best model with best f1 0.5551281548062958 from path test_outputs/bert-cross-topic/hc/2023-08-16 14-05-36/state_dict


              precision    recall  f1-score   support

           0   0.679245  0.637168  0.657534       565
           1   0.570896  0.597656  0.583969       256
           2   0.424731  0.484663  0.452722       163

    accuracy                       0.601626       984
   macro avg   0.558291  0.573162  0.564742       984
weighted avg   0.608896  0.601626  0.604468       984

Test Acc: 0.6016260162601627 F1_ma:0.5551281548062958
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5551281548062958
acc: 0.6016260162601627, f1 :0.5647419250871489
classification report: 
              precision    recall  f1-score   support

         Con     0.6792    0.6372    0.6575       565
        None     0.5709    0.5977    0.5840       256
         Pro     0.4247    0.4847    0.4527       163

    accuracy                         0.6016       984
   macro avg     0.5583    0.5732    0.5647       984
weighted avg     0.6089    0.6016    0.6045       984

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 14-26-00', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 14-26-00
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.8482  loss:1.8482,stance loss: 1.2558 
Train step: 10 acc:0.35795 total_loss: 1.6878  loss:1.6811,stance loss: 1.1697 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 20 acc:0.38988 total_loss: 1.6673  loss:1.5452,stance loss: 0.9454 
Train step: 30 acc:0.41532 total_loss: 1.6753  loss:1.799,stance loss: 1.4535 
Train step: 40 acc:0.4314 total_loss: 1.6621  loss:1.4767,stance loss: 1.0493 
Train step: 50 acc:0.43382 total_loss: 1.6605  loss:1.5669,stance loss: 1.0617 
Train step: 60 acc:0.4416 total_loss: 1.6529  loss:1.7219,stance loss: 1.0685 
Train step: 70 acc:0.44278 total_loss: 1.6511  loss:1.5354,stance loss: 0.9061 
Train step: 80 acc:0.44985 total_loss: 1.6417  loss:1.6216,stance loss: 1.1123 
Better F1! Saving model!
Saving model of best f1: 0.36660013306719896
              precision    recall  f1-score   support

           0   0.587420  0.975221  0.733200       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.559959       984
   macro avg   0.195807  0.325074  0.244400       984
weighted avg   0.337289  0.559959  0.420994       984

Test Acc: 0.5599593495934959 F1_ma:0.36660013306719896
Train step: 90 acc:0.44986 total_loss: 1.6363  loss:1.5949,stance loss: 1.1238 
Train step: 100 acc:0.45483 total_loss: 1.6249  loss:1.4622,stance loss: 0.80183 
Train step: 110 acc:0.46115 total_loss: 1.6231  loss:1.3258,stance loss: 0.93382 
Train step: 120 acc:0.47004 total_loss: 1.62  loss:1.629,stance loss: 1.111 
Train step: 130 acc:0.4771 total_loss: 1.6134  loss:1.3882,stance loss: 0.96398 
Train step: 140 acc:0.47872 total_loss: 1.6093  loss:1.6212,stance loss: 1.0494 
Train step: 150 acc:0.4851 total_loss: 1.6033  loss:1.4376,stance loss: 1.0544 
Train step: 160 acc:0.48447 total_loss: 1.604  loss:1.5356,stance loss: 1.1638 
Train step: 170 acc:0.48794 total_loss: 1.5998  loss:1.6481,stance loss: 1.238 
Train step: 180 acc:0.49344 total_loss: 1.5923  loss:1.1863,stance loss: 0.83273 
Train step: 190 acc:0.49935 total_loss: 1.5891  loss:1.686,stance loss: 1.5421 
Train step: 200 acc:0.5056 total_loss: 1.584  loss:1.2936,stance loss: 1.2851 
Train step: 210 acc:0.50444 total_loss: 1.5822  loss:1.5675,stance loss: 1.1858 
Train step: 220 acc:0.50764 total_loss: 1.5767  loss:1.5356,stance loss: 1.5481 
Train step: 230 acc:0.5092 total_loss: 1.5739  loss:1.461,stance loss: 1.1186 
Better F1! Saving model!
Saving model of best f1: 0.36690140845070424
              precision    recall  f1-score   support

           0   0.609357  0.922124  0.733803       565
           1   0.627907  0.316406  0.420779       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.611789       984
   macro avg   0.412421  0.412843  0.384861       984
weighted avg   0.513243  0.611789  0.530811       984

Test Acc: 0.6117886178861789 F1_ma:0.36690140845070424
Train step: 240 acc:0.51374 total_loss: 1.5681  loss:1.5293,stance loss: 1.1657 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.59375 total_loss: 1.427  loss:1.4047,stance loss: 1.0795 
Train step: 260 acc:0.62153 total_loss: 1.4225  loss:1.1847,stance loss: 0.90084 
Train step: 270 acc:0.61607 total_loss: 1.4119  loss:1.4617,stance loss: 1.0059 
Train step: 280 acc:0.64803 total_loss: 1.392  loss:1.6544,stance loss: 1.714 
Train step: 290 acc:0.65625 total_loss: 1.3847  loss:1.4226,stance loss: 1.387 
Train step: 300 acc:0.65625 total_loss: 1.3869  loss:1.3407,stance loss: 0.89836 
Train step: 310 acc:0.65809 total_loss: 1.3903  loss:1.0654,stance loss: 0.73094 
Train step: 320 acc:0.65865 total_loss: 1.3797  loss:1.2326,stance loss: 1.0646 
Train step: 330 acc:0.65625 total_loss: 1.3697  loss:1.445,stance loss: 0.94661 
Train step: 340 acc:0.65689 total_loss: 1.3618  loss:1.4928,stance loss: 1.4878 
Train step: 350 acc:0.65741 total_loss: 1.3609  loss:1.2349,stance loss: 0.84632 
Train step: 360 acc:0.65784 total_loss: 1.3684  loss:1.6371,stance loss: 1.7661 
Better F1! Saving model!
Saving model of best f1: 0.36820859902300784
              precision    recall  f1-score   support

           0   0.639045  0.805310  0.712608       565
           1   0.569288  0.593750  0.581262       256
           2   0.400000  0.012270  0.023810       163

    accuracy                       0.618902       984
   macro avg   0.536111  0.470443  0.439226       984
weighted avg   0.581299  0.618902  0.564337       984

Test Acc: 0.6189024390243902 F1_ma:0.36820859902300784
Train step: 370 acc:0.65527 total_loss: 1.3717  loss:1.7554,stance loss: 1.6451 
Better F1! Saving model!
Saving model of best f1: 0.38538128841338487
              precision    recall  f1-score   support

           0   0.664957  0.688496  0.676522       565
           1   0.536388  0.777344  0.634769       256
           2   0.321429  0.055215  0.094241       163

    accuracy                       0.606707       984
   macro avg   0.507591  0.507018  0.468510       984
weighted avg   0.574603  0.606707  0.569204       984

Test Acc: 0.6067073170731707 F1_ma:0.38538128841338487
Train step: 380 acc:0.65399 total_loss: 1.3677  loss:1.2163,stance loss: 0.89805 
Train step: 390 acc:0.65287 total_loss: 1.362  loss:1.1182,stance loss: 0.75343 
Train step: 400 acc:0.65467 total_loss: 1.3598  loss:1.2228,stance loss: 0.81021 
Train step: 410 acc:0.65327 total_loss: 1.3641  loss:1.5671,stance loss: 1.2394 
Train step: 420 acc:0.65309 total_loss: 1.3647  loss:1.1573,stance loss: 0.83755 
Train step: 430 acc:0.65326 total_loss: 1.3615  loss:1.1914,stance loss: 0.75188 
Train step: 440 acc:0.65688 total_loss: 1.353  loss:1.0083,stance loss: 0.85641 
Train step: 450 acc:0.65415 total_loss: 1.3537  loss:1.2779,stance loss: 0.90592 
Train step: 460 acc:0.65367 total_loss: 1.3483  loss:1.2847,stance loss: 0.91877 
Train step: 470 acc:0.65132 total_loss: 1.3499  loss:1.2777,stance loss: 0.86864 
Better F1! Saving model!
Saving model of best f1: 0.3902530694061639
              precision    recall  f1-score   support

           0   0.651584  0.764602  0.703583       565
           1   0.559603  0.660156  0.605735       256
           2   0.368421  0.042945  0.076923       163

    accuracy                       0.617886       984
   macro avg   0.526536  0.489234  0.462080       984
weighted avg   0.580748  0.617886  0.574320       984

Test Acc: 0.6178861788617886 F1_ma:0.3902530694061639
Train step: 480 acc:0.65179 total_loss: 1.3474  loss:1.1375,stance loss: 0.75599 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.7375 total_loss: 1.1741  loss:1.2739,stance loss: 0.93909 
Train step: 500 acc:0.75833 total_loss: 1.2352  loss:0.81551,stance loss: 0.49523 
Train step: 510 acc:0.725 total_loss: 1.2705  loss:1.4567,stance loss: 1.0391 
Train step: 520 acc:0.71429 total_loss: 1.2507  loss:1.1418,stance loss: 0.83256 
Train step: 530 acc:0.71806 total_loss: 1.235  loss:1.4005,stance loss: 1.2612 
Train step: 540 acc:0.72841 total_loss: 1.2068  loss:1.1712,stance loss: 0.89251 
Train step: 550 acc:0.7125 total_loss: 1.232  loss:1.2752,stance loss: 0.95924 
Train step: 560 acc:0.71333 total_loss: 1.2178  loss:1.6817,stance loss: 1.3287 
Train step: 570 acc:0.71324 total_loss: 1.211  loss:0.7104,stance loss: 0.35901 
Train step: 580 acc:0.70526 total_loss: 1.2175  loss:1.3156,stance loss: 0.89504 
Train step: 590 acc:0.70119 total_loss: 1.22  loss:1.0768,stance loss: 0.95617 
Train step: 600 acc:0.69783 total_loss: 1.2186  loss:1.0232,stance loss: 0.83361 
Train step: 610 acc:0.696 total_loss: 1.2104  loss:1.5242,stance loss: 1.2676 
Train step: 620 acc:0.69167 total_loss: 1.215  loss:1.2285,stance loss: 0.98066 
Train step: 630 acc:0.69052 total_loss: 1.2153  loss:1.1782,stance loss: 1.1027 
Train step: 640 acc:0.68871 total_loss: 1.2165  loss:1.1399,stance loss: 0.82659 
Train step: 650 acc:0.69318 total_loss: 1.2063  loss:1.2799,stance loss: 1.3068 
Train step: 660 acc:0.68929 total_loss: 1.2101  loss:1.5874,stance loss: 1.2751 
Train step: 670 acc:0.6875 total_loss: 1.2133  loss:1.0501,stance loss: 0.82586 
Train step: 680 acc:0.6891 total_loss: 1.2085  loss:1.3865,stance loss: 1.1459 
Train step: 690 acc:0.68994 total_loss: 1.2067  loss:1.1899,stance loss: 0.85 
Train step: 700 acc:0.68576 total_loss: 1.2124  loss:1.0051,stance loss: 0.70745 
Train step: 710 acc:0.6875 total_loss: 1.208  loss:1.0523,stance loss: 0.80553 
Train step: 720 acc:0.68617 total_loss: 1.2091  loss:1.2663,stance loss: 1.4239 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.65625 total_loss: 1.072  loss:1.1174,stance loss: 0.82068 
Train step: 740 acc:0.70312 total_loss: 1.1159  loss:1.2717,stance loss: 0.89198 
Train step: 750 acc:0.72443 total_loss: 1.1193  loss:1.4207,stance loss: 1.6301 
Train step: 760 acc:0.73047 total_loss: 1.0877  loss:0.91378,stance loss: 0.74117 
Better F1! Saving model!
Saving model of best f1: 0.41897122485357785
              precision    recall  f1-score   support

           0   0.647458  0.676106  0.661472       565
           1   0.557994  0.695312  0.619130       256
           2   0.280000  0.128834  0.176471       163

    accuracy                       0.590447       984
   macro avg   0.495150  0.500084  0.485691       984
weighted avg   0.563313  0.590447  0.570116       984

Test Acc: 0.5904471544715447 F1_ma:0.41897122485357785
Train step: 770 acc:0.7381 total_loss: 1.0932  loss:1.3143,stance loss: 0.99314 
Train step: 780 acc:0.72115 total_loss: 1.104  loss:1.3266,stance loss: 1.0553 
Train step: 790 acc:0.72782 total_loss: 1.0967  loss:1.3744,stance loss: 1.5778 
Train step: 800 acc:0.72049 total_loss: 1.1158  loss:1.1256,stance loss: 0.73201 
Train step: 810 acc:0.72027 total_loss: 1.1083  loss:1.1047,stance loss: 1.1822 
Train step: 820 acc:0.72011 total_loss: 1.1011  loss:0.7645,stance loss: 0.56746 
Train step: 830 acc:0.72304 total_loss: 1.0902  loss:0.6815,stance loss: 0.54096 
Train step: 840 acc:0.72433 total_loss: 1.0915  loss:1.3869,stance loss: 1.1389 
Train step: 850 acc:0.72695 total_loss: 1.0815  loss:0.70903,stance loss: 0.55704 
Train step: 860 acc:0.72254 total_loss: 1.0839  loss:1.219,stance loss: 0.8013 
Train step: 870 acc:0.72403 total_loss: 1.084  loss:1.1237,stance loss: 0.91826 
Train step: 880 acc:0.72245 total_loss: 1.0881  loss:0.94181,stance loss: 0.6844 
Train step: 890 acc:0.71991 total_loss: 1.0921  loss:1.1848,stance loss: 0.86332 
Train step: 900 acc:0.71693 total_loss: 1.1008  loss:1.1907,stance loss: 0.82273 
Train step: 910 acc:0.71703 total_loss: 1.099  loss:0.86283,stance loss: 0.70964 
Better F1! Saving model!
Saving model of best f1: 0.4259691697191697
              precision    recall  f1-score   support

           0   0.661261  0.649558  0.655357       565
           1   0.541899  0.757812  0.631922       256
           2   0.323944  0.141104  0.196581       163

    accuracy                       0.593496       984
   macro avg   0.509035  0.516158  0.494620       984
weighted avg   0.574331  0.593496  0.573264       984

Test Acc: 0.5934959349593496 F1_ma:0.4259691697191697
Train step: 920 acc:0.71842 total_loss: 1.0963  loss:0.86509,stance loss: 0.62246 
Train step: 930 acc:0.72123 total_loss: 1.0905  loss:0.74044,stance loss: 0.57311 
Better F1! Saving model!
Saving model of best f1: 0.43611999183729
              precision    recall  f1-score   support

           0   0.635938  0.720354  0.675519       565
           1   0.577947  0.593750  0.585742       256
           2   0.296296  0.147239  0.196721       163

    accuracy                       0.592480       984
   macro avg   0.503394  0.487114  0.485994       984
weighted avg   0.564589  0.592480  0.572849       984

Test Acc: 0.592479674796748 F1_ma:0.43611999183729
Train step: 940 acc:0.72022 total_loss: 1.091  loss:1.146,stance loss: 0.90574 
Better F1! Saving model!
Saving model of best f1: 0.470929087576313
              precision    recall  f1-score   support

           0   0.625506  0.546903  0.583569       565
           1   0.555556  0.605469  0.579439       256
           2   0.317536  0.411043  0.358289       163

    accuracy                       0.539634       984
   macro avg   0.499532  0.521138  0.507099       984
weighted avg   0.556292  0.539634  0.545177       984

Test Acc: 0.5396341463414634 F1_ma:0.470929087576313
Train step: 950 acc:0.71734 total_loss: 1.0968  loss:0.99778,stance loss: 0.76993 
Better F1! Saving model!
Saving model of best f1: 0.48504259443918585
              precision    recall  f1-score   support

           0   0.613269  0.670796  0.640744       565
           1   0.600000  0.457031  0.518847       256
           2   0.321637  0.337423  0.329341       163

    accuracy                       0.559959       984
   macro avg   0.511635  0.488417  0.496311       984
weighted avg   0.561508  0.559959  0.557447       984

Test Acc: 0.5599593495934959 F1_ma:0.48504259443918585
Train step: 960 acc:0.71579 total_loss: 1.0946  loss:1.1623,stance loss: 0.72721 
Train step: 970 acc:0.71694 total_loss: 1.0887  loss:1.0139,stance loss: 0.74733 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.75694 total_loss: 0.98591  loss:1.3168,stance loss: 1.1387 
Train step: 990 acc:0.78618 total_loss: 0.93653  loss:0.97015,stance loss: 0.74879 
Train step: 1000 acc:0.77371 total_loss: 0.96028  loss:0.68435,stance loss: 0.54196 
Better F1! Saving model!
Saving model of best f1: 0.4865470010925579
              precision    recall  f1-score   support

           0   0.631048  0.553982  0.590009       565
           1   0.586345  0.570312  0.578218       256
           2   0.322176  0.472393  0.383085       163

    accuracy                       0.544715       984
   macro avg   0.513190  0.532229  0.517104       984
weighted avg   0.568253  0.544715  0.552665       984

Test Acc: 0.5447154471544715 F1_ma:0.4865470010925579
Train step: 1010 acc:0.76923 total_loss: 0.97234  loss:1.0105,stance loss: 0.86607 
Train step: 1020 acc:0.77168 total_loss: 0.96088  loss:0.60456,stance loss: 0.49183 
Train step: 1030 acc:0.77119 total_loss: 0.95129  loss:0.86234,stance loss: 0.61931 
Train step: 1040 acc:0.76812 total_loss: 0.9421  loss:0.76969,stance loss: 0.72004 
Train step: 1050 acc:0.76345 total_loss: 0.95991  loss:0.93968,stance loss: 0.72014 
Train step: 1060 acc:0.75702 total_loss: 0.96934  loss:1.3819,stance loss: 0.97253 
Train step: 1070 acc:0.75884 total_loss: 0.97089  loss:1.2917,stance loss: 1.5621 
Train step: 1080 acc:0.75516 total_loss: 0.98506  loss:1.2416,stance loss: 0.8515 
Train step: 1090 acc:0.7584 total_loss: 0.98218  loss:0.99104,stance loss: 0.78681 
Train step: 1100 acc:0.7563 total_loss: 0.98361  loss:1.0214,stance loss: 0.81988 
Train step: 1110 acc:0.7536 total_loss: 0.98644  loss:0.92834,stance loss: 0.58991 
Train step: 1120 acc:0.75503 total_loss: 0.9821  loss:0.74614,stance loss: 0.57753 
Train step: 1130 acc:0.75354 total_loss: 0.98762  loss:1.4843,stance loss: 1.7298 
Train step: 1140 acc:0.75074 total_loss: 0.98612  loss:0.86133,stance loss: 0.5619 
Train step: 1150 acc:0.74825 total_loss: 0.9895  loss:0.95224,stance loss: 0.85939 
Train step: 1160 acc:0.74934 total_loss: 0.98648  loss:1.0311,stance loss: 0.82472 
Train step: 1170 acc:0.75063 total_loss: 0.98254  loss:0.63745,stance loss: 0.47234 
Train step: 1180 acc:0.74791 total_loss: 0.98618  loss:0.82713,stance loss: 0.62453 
Train step: 1190 acc:0.74572 total_loss: 0.99213  loss:0.86609,stance loss: 0.62788 
Train step: 1200 acc:0.74563 total_loss: 0.99184  loss:0.8299,stance loss: 0.50607 
Train step: 1210 acc:0.74372 total_loss: 0.9923  loss:1.1914,stance loss: 0.88629 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.79167 total_loss: 0.74265  loss:0.46674,stance loss: 0.2778 
Train step: 1230 acc:0.79297 total_loss: 0.81252  loss:0.61939,stance loss: 0.49995 
Train step: 1240 acc:0.80288 total_loss: 0.79983  loss:0.44612,stance loss: 0.2825 
Train step: 1250 acc:0.80382 total_loss: 0.80204  loss:0.60947,stance loss: 0.44666 
Train step: 1260 acc:0.79348 total_loss: 0.84701  loss:0.81494,stance loss: 0.64176 
Train step: 1270 acc:0.78906 total_loss: 0.84934  loss:0.41236,stance loss: 0.25203 
Train step: 1280 acc:0.79261 total_loss: 0.83927  loss:0.72879,stance loss: 0.49599 
Train step: 1290 acc:0.79852 total_loss: 0.82506  loss:1.0742,stance loss: 0.99825 
Train step: 1300 acc:0.79942 total_loss: 0.82204  loss:1.1014,stance loss: 1.1679 
Train step: 1310 acc:0.79883 total_loss: 0.8357  loss:0.6439,stance loss: 0.48524 
Train step: 1320 acc:0.79304 total_loss: 0.85248  loss:0.89912,stance loss: 0.70837 
Train step: 1330 acc:0.7931 total_loss: 0.85231  loss:0.84409,stance loss: 0.74201 
Train step: 1340 acc:0.79067 total_loss: 0.85068  loss:0.65674,stance loss: 0.58824 
Train step: 1350 acc:0.79136 total_loss: 0.85136  loss:0.74618,stance loss: 0.64559 
Train step: 1360 acc:0.78938 total_loss: 0.85133  loss:0.54008,stance loss: 0.39372 
Train step: 1370 acc:0.78846 total_loss: 0.86066  loss:0.99359,stance loss: 1.0031 
Train step: 1380 acc:0.78539 total_loss: 0.86668  loss:0.60693,stance loss: 0.53646 
Train step: 1390 acc:0.78374 total_loss: 0.87084  loss:1.412,stance loss: 1.0448 
Train step: 1400 acc:0.78327 total_loss: 0.87801  loss:0.87493,stance loss: 0.74035 
Train step: 1410 acc:0.78667 total_loss: 0.88067  loss:0.54526,stance loss: 0.40189 
Train step: 1420 acc:0.78762 total_loss: 0.87913  loss:0.72539,stance loss: 1.0696 
Train step: 1430 acc:0.78588 total_loss: 0.88483  loss:0.81954,stance loss: 0.65153 
Train step: 1440 acc:0.78512 total_loss: 0.88632  loss:0.93461,stance loss: 0.85822 
Train step: 1450 acc:0.78178 total_loss: 0.89154  loss:0.90262,stance loss: 0.70172 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.8125 total_loss: 0.737  loss:0.64967,stance loss: 0.48813 
Train step: 1470 acc:0.83654 total_loss: 0.80479  loss:1.2072,stance loss: 1.5183 
Train step: 1480 acc:0.80707 total_loss: 0.85255  loss:1.2208,stance loss: 1.1128 
Train step: 1490 acc:0.82576 total_loss: 0.78727  loss:0.50772,stance loss: 0.3538 
Train step: 1500 acc:0.8314 total_loss: 0.77926  loss:1.0172,stance loss: 0.82095 
Better F1! Saving model!
Saving model of best f1: 0.5382351462752588
              precision    recall  f1-score   support

           0   0.657143  0.692035  0.674138       565
           1   0.641148  0.523438  0.576344       256
           2   0.383333  0.423313  0.402332       163

    accuracy                       0.603659       984
   macro avg   0.560542  0.546262  0.550938       984
weighted avg   0.607625  0.603659  0.603671       984

Test Acc: 0.6036585365853658 F1_ma:0.5382351462752588
Train step: 1510 acc:0.82075 total_loss: 0.79491  loss:0.46408,stance loss: 0.31927 
Train step: 1520 acc:0.80853 total_loss: 0.78462  loss:0.36531,stance loss: 0.26421 
Train step: 1530 acc:0.8125 total_loss: 0.76464  loss:0.57166,stance loss: 0.41408 
Train step: 1540 acc:0.80873 total_loss: 0.75474  loss:0.72024,stance loss: 0.70365 
Train step: 1550 acc:0.8078 total_loss: 0.76386  loss:0.95734,stance loss: 0.78892 
Train step: 1560 acc:0.81129 total_loss: 0.75683  loss:0.78593,stance loss: 0.57689 
Train step: 1570 acc:0.81416 total_loss: 0.75472  loss:0.52942,stance loss: 0.26983 
Train step: 1580 acc:0.81098 total_loss: 0.75891  loss:1.2404,stance loss: 1.11 
Train step: 1590 acc:0.81485 total_loss: 0.75409  loss:0.79268,stance loss: 0.58043 
Train step: 1600 acc:0.81469 total_loss: 0.75509  loss:1.0867,stance loss: 0.89838 
Train step: 1610 acc:0.81454 total_loss: 0.754  loss:0.57192,stance loss: 0.45282 
Train step: 1620 acc:0.81595 total_loss: 0.75533  loss:0.61461,stance loss: 0.49518 
Train step: 1630 acc:0.81575 total_loss: 0.75477  loss:0.53559,stance loss: 0.36579 
Train step: 1640 acc:0.8125 total_loss: 0.76308  loss:1.1571,stance loss: 1.1604 
Train step: 1650 acc:0.81218 total_loss: 0.7639  loss:0.5492,stance loss: 0.45395 
Train step: 1660 acc:0.81096 total_loss: 0.76862  loss:0.49181,stance loss: 0.44316 
Train step: 1670 acc:0.81074 total_loss: 0.77655  loss:0.92471,stance loss: 0.70282 
Train step: 1680 acc:0.80914 total_loss: 0.77936  loss:0.51472,stance loss: 0.408 
Train step: 1690 acc:0.81009 total_loss: 0.77602  loss:1.0359,stance loss: 1.2504 
Train step: 1700 acc:0.81137 total_loss: 0.77217  loss:0.53179,stance loss: 0.47453 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.85625 total_loss: 0.57487  loss:0.59075,stance loss: 0.43583 
Train step: 1720 acc:0.86875 total_loss: 0.57211  loss:0.55834,stance loss: 0.47436 
Train step: 1730 acc:0.875 total_loss: 0.54396  loss:0.30393,stance loss: 0.16519 
Train step: 1740 acc:0.86562 total_loss: 0.56672  loss:0.61072,stance loss: 0.45855 
Train step: 1750 acc:0.86 total_loss: 0.56738  loss:0.58934,stance loss: 0.334 
Train step: 1760 acc:0.85208 total_loss: 0.6148  loss:0.76699,stance loss: 0.67917 
Train step: 1770 acc:0.84732 total_loss: 0.6342  loss:0.65817,stance loss: 0.51316 
Train step: 1780 acc:0.84453 total_loss: 0.6331  loss:0.52635,stance loss: 0.35015 
Train step: 1790 acc:0.84028 total_loss: 0.63763  loss:0.48663,stance loss: 0.375 
Train step: 1800 acc:0.84188 total_loss: 0.63639  loss:0.70694,stance loss: 0.52331 
Train step: 1810 acc:0.83977 total_loss: 0.63629  loss:0.60611,stance loss: 0.4044 
Train step: 1820 acc:0.83958 total_loss: 0.64083  loss:0.8256,stance loss: 0.87143 
Train step: 1830 acc:0.83894 total_loss: 0.64991  loss:0.49897,stance loss: 0.40417 
Train step: 1840 acc:0.83884 total_loss: 0.65136  loss:0.56464,stance loss: 0.43193 
Train step: 1850 acc:0.84167 total_loss: 0.65119  loss:1.0638,stance loss: 0.9294 
Train step: 1860 acc:0.84141 total_loss: 0.65473  loss:0.83061,stance loss: 0.69617 
Train step: 1870 acc:0.84118 total_loss: 0.65754  loss:0.59836,stance loss: 0.47202 
Train step: 1880 acc:0.83785 total_loss: 0.66329  loss:1.2214,stance loss: 1.6023 
Train step: 1890 acc:0.83651 total_loss: 0.66525  loss:0.61507,stance loss: 0.46953 
Train step: 1900 acc:0.83469 total_loss: 0.67154  loss:0.93007,stance loss: 1.3069 
Train step: 1910 acc:0.83452 total_loss: 0.67398  loss:0.59171,stance loss: 0.5605 
Train step: 1920 acc:0.83608 total_loss: 0.66827  loss:0.2868,stance loss: 0.1725 
Train step: 1930 acc:0.83505 total_loss: 0.67823  loss:0.87313,stance loss: 0.62224 
Train step: 1940 acc:0.83437 total_loss: 0.68075  loss:0.43194,stance loss: 0.35657 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.83036 total_loss: 0.63983  loss:0.32741,stance loss: 0.21477 
Train step: 1960 acc:0.875 total_loss: 0.5516  loss:1.4106,stance loss: 1.7452 
Train step: 1970 acc:0.875 total_loss: 0.54795  loss:0.29208,stance loss: 0.17847 
Train step: 1980 acc:0.86149 total_loss: 0.55631  loss:0.95642,stance loss: 0.76788 
Train step: 1990 acc:0.86569 total_loss: 0.55387  loss:0.23999,stance loss: 0.17097 
Train step: 2000 acc:0.85965 total_loss: 0.58139  loss:0.97351,stance loss: 1.1404 
Train step: 2010 acc:0.86567 total_loss: 0.58051  loss:0.53974,stance loss: 0.51933 
Train step: 2020 acc:0.86201 total_loss: 0.59818  loss:0.48872,stance loss: 0.36258 
Train step: 2030 acc:0.86063 total_loss: 0.58904  loss:0.61984,stance loss: 0.42875 
Train step: 2040 acc:0.86276 total_loss: 0.58317  loss:0.53036,stance loss: 0.40923 
Train step: 2050 acc:0.86215 total_loss: 0.59105  loss:1.0423,stance loss: 1.3481 
Train step: 2060 acc:0.86538 total_loss: 0.58554  loss:0.29309,stance loss: 0.29013 
Train step: 2070 acc:0.86909 total_loss: 0.58681  loss:0.55677,stance loss: 0.53239 
Train step: 2080 acc:0.86816 total_loss: 0.595  loss:0.64146,stance loss: 0.52088 
Train step: 2090 acc:0.8682 total_loss: 0.5952  loss:0.52361,stance loss: 0.31319 
Train step: 2100 acc:0.86346 total_loss: 0.61215  loss:0.7827,stance loss: 0.647 
Train step: 2110 acc:0.8649 total_loss: 0.60653  loss:0.37523,stance loss: 0.32027 
Train step: 2120 acc:0.86299 total_loss: 0.6092  loss:0.53016,stance loss: 0.46732 
Train step: 2130 acc:0.86397 total_loss: 0.60242  loss:0.46222,stance loss: 0.36804 
Train step: 2140 acc:0.86263 total_loss: 0.60981  loss:0.58337,stance loss: 0.48628 
Train step: 2150 acc:0.86141 total_loss: 0.61885  loss:0.33565,stance loss: 0.21146 
Train step: 2160 acc:0.86118 total_loss: 0.61959  loss:0.29881,stance loss: 0.23855 
Train step: 2170 acc:0.86068 total_loss: 0.62052  loss:0.42448,stance loss: 0.34631 
Train step: 2180 acc:0.86129 total_loss: 0.61797  loss:0.41669,stance loss: 0.33267 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.9375 total_loss: 0.4482  loss:0.45142,stance loss: 0.36105 
Train step: 2200 acc:0.91518 total_loss: 0.52036  loss:0.6004,stance loss: 0.47079 
Train step: 2210 acc:0.91667 total_loss: 0.52244  loss:0.171,stance loss: 0.066093 
Train step: 2220 acc:0.89706 total_loss: 0.5551  loss:0.85625,stance loss: 0.78065 
Train step: 2230 acc:0.89347 total_loss: 0.5185  loss:0.26073,stance loss: 0.17733 
Train step: 2240 acc:0.89005 total_loss: 0.50742  loss:0.67427,stance loss: 0.58662 
Train step: 2250 acc:0.88672 total_loss: 0.52131  loss:0.6868,stance loss: 0.57072 
Train step: 2260 acc:0.88598 total_loss: 0.52636  loss:0.35097,stance loss: 0.28132 
Train step: 2270 acc:0.8869 total_loss: 0.52319  loss:0.22885,stance loss: 0.11119 
Train step: 2280 acc:0.8863 total_loss: 0.52813  loss:0.65803,stance loss: 0.53507 
Train step: 2290 acc:0.88041 total_loss: 0.54392  loss:0.74372,stance loss: 0.53883 
Train step: 2300 acc:0.87939 total_loss: 0.53795  loss:0.33855,stance loss: 0.26011 
Train step: 2310 acc:0.87853 total_loss: 0.54484  loss:0.5994,stance loss: 0.37146 
Train step: 2320 acc:0.8792 total_loss: 0.53695  loss:0.322,stance loss: 0.24481 
Train step: 2330 acc:0.87891 total_loss: 0.52998  loss:0.31672,stance loss: 0.18691 
Train step: 2340 acc:0.87987 total_loss: 0.53085  loss:0.42048,stance loss: 0.32208 
Train step: 2350 acc:0.8811 total_loss: 0.52319  loss:0.50709,stance loss: 0.3844 
Train step: 2360 acc:0.88147 total_loss: 0.52082  loss:0.3891,stance loss: 0.32416 
Train step: 2370 acc:0.87976 total_loss: 0.52416  loss:0.64206,stance loss: 1.0577 
Train step: 2380 acc:0.87887 total_loss: 0.53194  loss:0.8616,stance loss: 0.66731 
Train step: 2390 acc:0.87929 total_loss: 0.53074  loss:0.37578,stance loss: 0.24221 
Train step: 2400 acc:0.8785 total_loss: 0.53272  loss:0.46254,stance loss: 0.49668 
Train step: 2410 acc:0.87807 total_loss: 0.53483  loss:0.40605,stance loss: 0.38706 
Train step: 2420 acc:0.87794 total_loss: 0.53481  loss:0.60857,stance loss: 0.44898 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.34215  loss:0.34215,stance loss: 0.26912 
Train step: 2440 acc:0.88636 total_loss: 0.42411  loss:0.7367,stance loss: 0.69553 
Train step: 2450 acc:0.88095 total_loss: 0.49138  loss:0.27947,stance loss: 0.23071 
Train step: 2460 acc:0.88911 total_loss: 0.44081  loss:0.33793,stance loss: 0.27279 
Train step: 2470 acc:0.89939 total_loss: 0.45737  loss:0.21594,stance loss: 0.18998 
Train step: 2480 acc:0.88725 total_loss: 0.49105  loss:0.76495,stance loss: 0.72796 
Train step: 2490 acc:0.89344 total_loss: 0.47364  loss:0.39778,stance loss: 0.38357 
Train step: 2500 acc:0.89349 total_loss: 0.47462  loss:0.50736,stance loss: 0.50737 
Train step: 2510 acc:0.89429 total_loss: 0.46694  loss:0.45866,stance loss: 0.46682 
Train step: 2520 acc:0.89423 total_loss: 0.47044  loss:0.84853,stance loss: 1.2934 
Train step: 2530 acc:0.8948 total_loss: 0.4728  loss:0.55639,stance loss: 0.59444 
Train step: 2540 acc:0.89752 total_loss: 0.4661  loss:0.096432,stance loss: 0.047971 
Train step: 2550 acc:0.89514 total_loss: 0.47162  loss:0.25208,stance loss: 0.18725 
Train step: 2560 acc:0.89647 total_loss: 0.46215  loss:0.72657,stance loss: 0.54821 
Train step: 2570 acc:0.89672 total_loss: 0.46059  loss:0.24649,stance loss: 0.18272 
Train step: 2580 acc:0.89818 total_loss: 0.46605  loss:0.56978,stance loss: 1.0126 
Train step: 2590 acc:0.8948 total_loss: 0.47237  loss:0.61694,stance loss: 0.44153 
Train step: 2600 acc:0.89693 total_loss: 0.47029  loss:0.12385,stance loss: 0.023323 
Train step: 2610 acc:0.89572 total_loss: 0.47383  loss:0.15786,stance loss: 0.060841 
Train step: 2620 acc:0.89594 total_loss: 0.4783  loss:0.88893,stance loss: 0.8894 
Train step: 2630 acc:0.89521 total_loss: 0.48289  loss:0.11814,stance loss: 0.057593 
Train step: 2640 acc:0.89722 total_loss: 0.47719  loss:0.47103,stance loss: 0.41663 
Train step: 2650 acc:0.89791 total_loss: 0.4747  loss:0.48017,stance loss: 0.30971 
Train step: 2660 acc:0.89854 total_loss: 0.47395  loss:0.48952,stance loss: 0.39999 
Train step: 2670 acc:0.89886 total_loss: 0.47324  loss:0.40049,stance loss: 0.26678 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.92188 total_loss: 0.38759  loss:0.64931,stance loss: 0.58936 
Train step: 2690 acc:0.92361 total_loss: 0.38789  loss:0.35011,stance loss: 0.2851 
Train step: 2700 acc:0.91964 total_loss: 0.45802  loss:0.92022,stance loss: 1.422 
Train step: 2710 acc:0.9227 total_loss: 0.43693  loss:0.28464,stance loss: 0.20282 
Train step: 2720 acc:0.92188 total_loss: 0.42504  loss:0.48056,stance loss: 0.34483 
Train step: 2730 acc:0.92026 total_loss: 0.42977  loss:0.77565,stance loss: 0.7203 
Train step: 2740 acc:0.92279 total_loss: 0.42096  loss:0.28728,stance loss: 0.19838 
Train step: 2750 acc:0.92147 total_loss: 0.41363  loss:0.80071,stance loss: 0.73193 
Train step: 2760 acc:0.92259 total_loss: 0.40821  loss:0.36217,stance loss: 0.38007 
Train step: 2770 acc:0.92474 total_loss: 0.4034  loss:0.151,stance loss: 0.10221 
Train step: 2780 acc:0.92708 total_loss: 0.39063  loss:0.097072,stance loss: 0.056719 
Train step: 2790 acc:0.92585 total_loss: 0.40106  loss:0.14127,stance loss: 0.089895 
Train step: 2800 acc:0.92578 total_loss: 0.39368  loss:0.23667,stance loss: 0.15611 
Train step: 2810 acc:0.92437 total_loss: 0.38757  loss:0.47683,stance loss: 0.44455 
Train step: 2820 acc:0.92441 total_loss: 0.38827  loss:0.29015,stance loss: 0.1647 
Train step: 2830 acc:0.92207 total_loss: 0.39951  loss:0.35423,stance loss: 0.24797 
Train step: 2840 acc:0.92299 total_loss: 0.39179  loss:0.34423,stance loss: 0.2121 
Train step: 2850 acc:0.92346 total_loss: 0.39103  loss:0.28322,stance loss: 0.29198 
Train step: 2860 acc:0.92221 total_loss: 0.39616  loss:0.362,stance loss: 0.30873 
Train step: 2870 acc:0.9214 total_loss: 0.39367  loss:0.39495,stance loss: 0.35759 
Train step: 2880 acc:0.92097 total_loss: 0.39564  loss:0.77557,stance loss: 1.0524 
Train step: 2890 acc:0.92231 total_loss: 0.39125  loss:0.2735,stance loss: 0.16725 
Train step: 2900 acc:0.9216 total_loss: 0.39326  loss:0.24222,stance loss: 0.20607 
Train step: 2910 acc:0.92174 total_loss: 0.39603  loss:0.38229,stance loss: 0.38018 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.95 total_loss: 0.28586  loss:0.17688,stance loss: 0.066183 
Train step: 2930 acc:0.93333 total_loss: 0.3057  loss:0.063159,stance loss: 0.015197 
Train step: 2940 acc:0.9325 total_loss: 0.29373  loss:0.056095,stance loss: 0.021876 
Train step: 2950 acc:0.93393 total_loss: 0.33334  loss:0.78349,stance loss: 1.299 
Train step: 2960 acc:0.9375 total_loss: 0.31296  loss:0.49859,stance loss: 0.40008 
Train step: 2970 acc:0.93636 total_loss: 0.31521  loss:0.34373,stance loss: 0.31545 
Train step: 2980 acc:0.93846 total_loss: 0.32836  loss:0.20876,stance loss: 0.092479 
Train step: 2990 acc:0.935 total_loss: 0.34078  loss:0.42116,stance loss: 0.3649 
Train step: 3000 acc:0.93529 total_loss: 0.34836  loss:1.4136,stance loss: 1.3283 
Train step: 3010 acc:0.93355 total_loss: 0.3568  loss:0.47917,stance loss: 0.39079 
Train step: 3020 acc:0.93333 total_loss: 0.3627  loss:0.8105,stance loss: 1.2394 
Train step: 3030 acc:0.93641 total_loss: 0.34755  loss:0.09638,stance loss: 0.058546 
Train step: 3040 acc:0.9355 total_loss: 0.35482  loss:0.71452,stance loss: 0.6167 
Train step: 3050 acc:0.93519 total_loss: 0.35211  loss:0.26602,stance loss: 0.15054 
Train step: 3060 acc:0.93534 total_loss: 0.35206  loss:0.25741,stance loss: 0.18504 
Train step: 3070 acc:0.93427 total_loss: 0.35205  loss:0.33298,stance loss: 0.17726 
Train step: 3080 acc:0.93409 total_loss: 0.35248  loss:0.20453,stance loss: 0.14646 
Train step: 3090 acc:0.93214 total_loss: 0.36091  loss:0.38312,stance loss: 0.31877 
Train step: 3100 acc:0.93311 total_loss: 0.35978  loss:0.4759,stance loss: 0.38653 
Train step: 3110 acc:0.93333 total_loss: 0.35445  loss:0.15001,stance loss: 0.10848 
Train step: 3120 acc:0.93293 total_loss: 0.35338  loss:0.29868,stance loss: 0.29565 
Train step: 3130 acc:0.93459 total_loss: 0.34509  loss:0.31969,stance loss: 0.24158 
Train step: 3140 acc:0.93306 total_loss: 0.3516  loss:0.63278,stance loss: 0.41532 
Train step: 3150 acc:0.93298 total_loss: 0.34805  loss:0.078873,stance loss: 0.030406 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:0.9375 total_loss: 0.19403  loss:0.21568,stance loss: 0.082682 
Train step: 3170 acc:0.95312 total_loss: 0.26503  loss:0.21764,stance loss: 0.13972 
Train step: 3180 acc:0.94318 total_loss: 0.31948  loss:0.72423,stance loss: 0.52961 
Train step: 3190 acc:0.94141 total_loss: 0.33232  loss:0.83255,stance loss: 0.65124 
Train step: 3200 acc:0.94196 total_loss: 0.31216  loss:0.29035,stance loss: 0.31535 
Train step: 3210 acc:0.94351 total_loss: 0.32633  loss:0.065871,stance loss: 0.020199 
Train step: 3220 acc:0.94657 total_loss: 0.30266  loss:0.057093,stance loss: 0.020905 
Train step: 3230 acc:0.94705 total_loss: 0.29368  loss:0.4053,stance loss: 0.34789 
Train step: 3240 acc:0.94741 total_loss: 0.28776  loss:0.53305,stance loss: 1.0083 
Train step: 3250 acc:0.94837 total_loss: 0.27826  loss:0.3708,stance loss: 0.27143 
Train step: 3260 acc:0.95037 total_loss: 0.27375  loss:0.034742,stance loss: 0.00085914 
Train step: 3270 acc:0.94978 total_loss: 0.27741  loss:0.26424,stance loss: 0.29562 
Train step: 3280 acc:0.94877 total_loss: 0.27813  loss:0.68725,stance loss: 0.50541 
Train step: 3290 acc:0.94981 total_loss: 0.27342  loss:0.46917,stance loss: 0.30995 
Train step: 3300 acc:0.95026 total_loss: 0.27543  loss:0.045146,stance loss: 0.011956 
Train step: 3310 acc:0.9523 total_loss: 0.27403  loss:1.1247,stance loss: 1.5006 
Train step: 3320 acc:0.9537 total_loss: 0.27019  loss:0.13351,stance loss: 0.095968 
Train step: 3330 acc:0.95131 total_loss: 0.2741  loss:0.26547,stance loss: 0.21334 
Train step: 3340 acc:0.95021 total_loss: 0.27997  loss:0.20565,stance loss: 0.1969 
Train step: 3350 acc:0.9502 total_loss: 0.27711  loss:0.067648,stance loss: 0.033573 
Train step: 3360 acc:0.9505 total_loss: 0.27333  loss:0.42081,stance loss: 0.38546 
Train step: 3370 acc:0.95077 total_loss: 0.27531  loss:0.12936,stance loss: 0.13843 
Train step: 3380 acc:0.95158 total_loss: 0.2784  loss:0.064242,stance loss: 0.0084168 
Train step: 3390 acc:0.95178 total_loss: 0.28237  loss:0.083184,stance loss: 0.069861 
Train step: 3400 acc:0.95093 total_loss: 0.28232  loss:0.26678,stance loss: 0.19506 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.94444 total_loss: 0.23885  loss:0.091929,stance loss: 0.067408 
Train step: 3420 acc:0.95395 total_loss: 0.21899  loss:0.15547,stance loss: 0.16109 
Train step: 3430 acc:0.94397 total_loss: 0.26592  loss:0.23346,stance loss: 0.21173 
Train step: 3440 acc:0.94712 total_loss: 0.26131  loss:0.054397,stance loss: 0.0038904 
Train step: 3450 acc:0.94898 total_loss: 0.27741  loss:0.32634,stance loss: 0.30764 
Train step: 3460 acc:0.95233 total_loss: 0.2647  loss:0.34535,stance loss: 0.30323 
Train step: 3470 acc:0.9538 total_loss: 0.25632  loss:0.43972,stance loss: 0.31227 
Train step: 3480 acc:0.95649 total_loss: 0.24973  loss:0.22767,stance loss: 0.21828 
Train step: 3490 acc:0.95506 total_loss: 0.25267  loss:0.31789,stance loss: 0.30162 
Train step: 3500 acc:0.95455 total_loss: 0.2494  loss:0.43119,stance loss: 0.34069 
Train step: 3510 acc:0.95585 total_loss: 0.24061  loss:0.17923,stance loss: 0.11511 
Train step: 3520 acc:0.95641 total_loss: 0.23656  loss:0.053779,stance loss: 0.050308 
Train step: 3530 acc:0.95736 total_loss: 0.23336  loss:0.151,stance loss: 0.1348 
Train step: 3540 acc:0.95683 total_loss: 0.23196  loss:0.022887,stance loss: 0.0025611 
Train step: 3550 acc:0.95805 total_loss: 0.22958  loss:0.59296,stance loss: 1.1002 
Train step: 3560 acc:0.95873 total_loss: 0.22816  loss:0.5262,stance loss: 0.3403 
Train step: 3570 acc:0.95858 total_loss: 0.22858  loss:0.041747,stance loss: 0.008736 
Train step: 3580 acc:0.95705 total_loss: 0.2312  loss:0.57446,stance loss: 0.46987 
Train step: 3590 acc:0.95536 total_loss: 0.24707  loss:0.57835,stance loss: 1.0368 
Train step: 3600 acc:0.9554 total_loss: 0.24689  loss:0.33603,stance loss: 0.31331 
Train step: 3610 acc:0.95574 total_loss: 0.24695  loss:0.14819,stance loss: 0.061756 
Train step: 3620 acc:0.95576 total_loss: 0.24755  loss:0.059404,stance loss: 0.02186 
Train step: 3630 acc:0.95633 total_loss: 0.24531  loss:0.28624,stance loss: 0.27001 
Train step: 3640 acc:0.95659 total_loss: 0.24225  loss:0.050511,stance loss: 0.015415 
Training finished.


Reload the best model with best f1 0.5382351462752588 from path test_outputs/bert-cross-topic/hc/2023-08-16 14-26-00/state_dict


              precision    recall  f1-score   support

           0   0.657143  0.692035  0.674138       565
           1   0.641148  0.523438  0.576344       256
           2   0.383333  0.423313  0.402332       163

    accuracy                       0.603659       984
   macro avg   0.560542  0.546262  0.550938       984
weighted avg   0.607625  0.603659  0.603671       984

Test Acc: 0.6036585365853658 F1_ma:0.5382351462752588
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5382351462752588
acc: 0.6036585365853658, f1 :0.5509381261906744
classification report: 
              precision    recall  f1-score   support

         Con     0.6571    0.6920    0.6741       565
        None     0.6411    0.5234    0.5763       256
         Pro     0.3833    0.4233    0.4023       163

    accuracy                         0.6037       984
   macro avg     0.5605    0.5463    0.5509       984
weighted avg     0.6076    0.6037    0.6037       984

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 14-46-23', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 14-46-23
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.7528  loss:1.7528,stance loss: 1.2141 
Train step: 10 acc:0.51705 total_loss: 1.6867  loss:1.7766,stance loss: 1.7354 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 20 acc:0.47321 total_loss: 1.7228  loss:1.6956,stance loss: 1.1301 
Train step: 30 acc:0.46371 total_loss: 1.7015  loss:1.6363,stance loss: 1.2033 
Better F1! Saving model!
Saving model of best f1: 0.36490066225165557
              precision    recall  f1-score   support

           0   0.583069  0.975221  0.729801       565
           1   0.512821  0.078125  0.135593       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.580285       984
   macro avg   0.365296  0.351115  0.288465       984
weighted avg   0.468207  0.580285  0.454319       984

Test Acc: 0.5802845528455285 F1_ma:0.36490066225165557
Train step: 40 acc:0.48476 total_loss: 1.6838  loss:1.6065,stance loss: 1.2323 
Train step: 50 acc:0.49755 total_loss: 1.6662  loss:1.7609,stance loss: 1.1947 
Train step: 60 acc:0.49385 total_loss: 1.6649  loss:1.7392,stance loss: 1.6268 
Train step: 70 acc:0.5 total_loss: 1.6615  loss:1.6111,stance loss: 1.1585 
Train step: 80 acc:0.50077 total_loss: 1.6551  loss:1.8483,stance loss: 1.7566 
Better F1! Saving model!
Saving model of best f1: 0.36725375081539463
              precision    recall  f1-score   support

           0   0.581612  0.996460  0.734508       565
           1   0.750000  0.046875  0.088235       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.584350       984
   macro avg   0.443871  0.347778  0.274248       984
weighted avg   0.529076  0.584350  0.444700       984

Test Acc: 0.584349593495935 F1_ma:0.36725375081539463
Train step: 90 acc:0.49657 total_loss: 1.6481  loss:1.5468,stance loss: 1.1353 
Train step: 100 acc:0.50062 total_loss: 1.6392  loss:1.5776,stance loss: 1.1144 
Train step: 110 acc:0.5045 total_loss: 1.6316  loss:1.8408,stance loss: 1.764 
Train step: 120 acc:0.50517 total_loss: 1.6224  loss:1.5351,stance loss: 1.2295 
Train step: 130 acc:0.51145 total_loss: 1.6134  loss:1.616,stance loss: 1.0863 
Train step: 140 acc:0.51596 total_loss: 1.6043  loss:1.5532,stance loss: 1.1636 
Train step: 150 acc:0.52359 total_loss: 1.5945  loss:1.4909,stance loss: 1.0781 
Train step: 160 acc:0.52679 total_loss: 1.5881  loss:1.6805,stance loss: 1.3591 
Train step: 170 acc:0.53253 total_loss: 1.5803  loss:1.1842,stance loss: 0.77324 
Train step: 180 acc:0.53833 total_loss: 1.5718  loss:1.4709,stance loss: 1.1706 
Train step: 190 acc:0.54319 total_loss: 1.5687  loss:1.5213,stance loss: 1.1062 
Train step: 200 acc:0.54136 total_loss: 1.564  loss:1.3513,stance loss: 0.95747 
Train step: 210 acc:0.54147 total_loss: 1.5613  loss:1.6088,stance loss: 1.2621 
Train step: 220 acc:0.54072 total_loss: 1.5621  loss:1.5283,stance loss: 1.1468 
Train step: 230 acc:0.54113 total_loss: 1.5597  loss:1.4383,stance loss: 0.87893 
Train step: 240 acc:0.54253 total_loss: 1.5571  loss:1.7304,stance loss: 1.6711 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.59375 total_loss: 1.4175  loss:1.5099,stance loss: 1.0201 
Train step: 260 acc:0.61458 total_loss: 1.4096  loss:1.1576,stance loss: 0.60015 
Train step: 270 acc:0.6317 total_loss: 1.3934  loss:1.35,stance loss: 0.94244 
Train step: 280 acc:0.63651 total_loss: 1.3888  loss:1.6556,stance loss: 1.5811 
Train step: 290 acc:0.63021 total_loss: 1.3907  loss:1.6964,stance loss: 1.2875 
Train step: 300 acc:0.64224 total_loss: 1.4014  loss:1.0019,stance loss: 0.6386 
Train step: 310 acc:0.64706 total_loss: 1.3984  loss:1.1184,stance loss: 0.69928 
Train step: 320 acc:0.65224 total_loss: 1.3868  loss:1.3176,stance loss: 0.89294 
Train step: 330 acc:0.64986 total_loss: 1.3876  loss:1.6901,stance loss: 1.2713 
Train step: 340 acc:0.65115 total_loss: 1.3784  loss:1.3292,stance loss: 1.0265 
Train step: 350 acc:0.64699 total_loss: 1.3861  loss:1.3689,stance loss: 1.08 
Train step: 360 acc:0.64883 total_loss: 1.3834  loss:1.153,stance loss: 0.75248 
Train step: 370 acc:0.64551 total_loss: 1.3862  loss:1.5753,stance loss: 0.98532 
Train step: 380 acc:0.649 total_loss: 1.3771  loss:1.244,stance loss: 0.93936 
Train step: 390 acc:0.64865 total_loss: 1.3791  loss:1.1405,stance loss: 0.85631 
Train step: 400 acc:0.65388 total_loss: 1.3757  loss:1.5415,stance loss: 1.1418 
Train step: 410 acc:0.6596 total_loss: 1.3672  loss:1.1305,stance loss: 1.2085 
Train step: 420 acc:0.66292 total_loss: 1.3609  loss:1.6599,stance loss: 1.2225 
Train step: 430 acc:0.66157 total_loss: 1.3595  loss:2.0272,stance loss: 1.6581 
Train step: 440 acc:0.66035 total_loss: 1.3567  loss:1.552,stance loss: 1.2725 
Train step: 450 acc:0.65925 total_loss: 1.3552  loss:1.6235,stance loss: 1.7181 
Train step: 460 acc:0.65854 total_loss: 1.3567  loss:1.4757,stance loss: 1.1195 
Train step: 470 acc:0.65762 total_loss: 1.3583  loss:1.3328,stance loss: 1.0866 
Train step: 480 acc:0.65861 total_loss: 1.3535  loss:1.3698,stance loss: 0.99925 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.7375 total_loss: 1.1669  loss:0.63323,stance loss: 0.24775 
Train step: 500 acc:0.68333 total_loss: 1.2426  loss:1.39,stance loss: 1.1768 
Train step: 510 acc:0.6825 total_loss: 1.2278  loss:1.1303,stance loss: 0.77745 
Train step: 520 acc:0.68214 total_loss: 1.2273  loss:1.4614,stance loss: 1.0475 
Train step: 530 acc:0.67083 total_loss: 1.2457  loss:1.8241,stance loss: 1.4177 
Train step: 540 acc:0.67727 total_loss: 1.21  loss:1.2566,stance loss: 1.0455 
Train step: 550 acc:0.67788 total_loss: 1.2151  loss:1.1247,stance loss: 0.78164 
Train step: 560 acc:0.68083 total_loss: 1.2327  loss:1.397,stance loss: 0.9835 
Train step: 570 acc:0.66985 total_loss: 1.2574  loss:1.545,stance loss: 1.19 
Train step: 580 acc:0.67763 total_loss: 1.2506  loss:1.4237,stance loss: 1.3308 
Train step: 590 acc:0.68155 total_loss: 1.2408  loss:0.94188,stance loss: 0.60528 
Train step: 600 acc:0.67717 total_loss: 1.2472  loss:1.163,stance loss: 0.87806 
Train step: 610 acc:0.6765 total_loss: 1.2453  loss:1.5181,stance loss: 0.98899 
Train step: 620 acc:0.68056 total_loss: 1.2328  loss:0.91314,stance loss: 0.60269 
Train step: 630 acc:0.6806 total_loss: 1.2337  loss:1.0359,stance loss: 0.67759 
Train step: 640 acc:0.67863 total_loss: 1.2331  loss:1.013,stance loss: 0.76385 
Train step: 650 acc:0.67879 total_loss: 1.227  loss:1.2068,stance loss: 1.0598 
Train step: 660 acc:0.68179 total_loss: 1.2185  loss:1.2637,stance loss: 0.94148 
Train step: 670 acc:0.68716 total_loss: 1.2115  loss:1.0653,stance loss: 0.84618 
Train step: 680 acc:0.68814 total_loss: 1.2107  loss:1.1943,stance loss: 0.91457 
Train step: 690 acc:0.69024 total_loss: 1.207  loss:1.6211,stance loss: 1.1851 
Train step: 700 acc:0.69128 total_loss: 1.203  loss:1.2905,stance loss: 0.90005 
Train step: 710 acc:0.69083 total_loss: 1.2006  loss:0.96003,stance loss: 0.74796 
Train step: 720 acc:0.69202 total_loss: 1.1972  loss:1.5682,stance loss: 1.7857 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.71875 total_loss: 1.3111  loss:1.227,stance loss: 1.0455 
Train step: 740 acc:0.6875 total_loss: 1.1709  loss:1.1344,stance loss: 0.69557 
Train step: 750 acc:0.7358 total_loss: 1.096  loss:0.68058,stance loss: 0.44812 
Train step: 760 acc:0.70703 total_loss: 1.139  loss:1.1333,stance loss: 0.87041 
Train step: 770 acc:0.70982 total_loss: 1.141  loss:1.1382,stance loss: 0.88166 
Train step: 780 acc:0.71635 total_loss: 1.1186  loss:1.6491,stance loss: 1.4236 
Train step: 790 acc:0.71169 total_loss: 1.1068  loss:0.88548,stance loss: 0.57974 
Train step: 800 acc:0.71701 total_loss: 1.1148  loss:1.164,stance loss: 0.93588 
Train step: 810 acc:0.72409 total_loss: 1.1012  loss:0.66591,stance loss: 0.45163 
Train step: 820 acc:0.72351 total_loss: 1.1078  loss:1.3491,stance loss: 1.5976 
Better F1! Saving model!
Saving model of best f1: 0.3767913121361397
              precision    recall  f1-score   support

           0   0.644163  0.810619  0.717868       565
           1   0.589552  0.617188  0.603053       256
           2   0.600000  0.018405  0.035714       163

    accuracy                       0.629065       984
   macro avg   0.611238  0.482071  0.452212       984
weighted avg   0.622640  0.629065  0.574999       984

Test Acc: 0.6290650406504065 F1_ma:0.3767913121361397
Train step: 830 acc:0.72855 total_loss: 1.0932  loss:1.011,stance loss: 0.97927 
Train step: 840 acc:0.72935 total_loss: 1.0912  loss:1.0826,stance loss: 0.78722 
Train step: 850 acc:0.73207 total_loss: 1.0908  loss:0.98682,stance loss: 0.78265 
Train step: 860 acc:0.72775 total_loss: 1.0987  loss:0.90224,stance loss: 0.73851 
Better F1! Saving model!
Saving model of best f1: 0.404031185507911
              precision    recall  f1-score   support

           0   0.656061  0.766372  0.706939       565
           1   0.559871  0.675781  0.612389       256
           2   0.600000  0.055215  0.101124       163

    accuracy                       0.625000       984
   macro avg   0.605310  0.499123  0.473484       984
weighted avg   0.621749  0.625000  0.581987       984

Test Acc: 0.625 F1_ma:0.404031185507911
Train step: 870 acc:0.72931 total_loss: 1.0967  loss:1.2834,stance loss: 1.2046 
Better F1! Saving model!
Saving model of best f1: 0.4084844141250586
              precision    recall  f1-score   support

           0   0.675090  0.661947  0.668454       565
           1   0.531969  0.812500  0.642968       256
           2   0.384615  0.092025  0.148515       163

    accuracy                       0.606707       984
   macro avg   0.530558  0.522157  0.486645       984
weighted avg   0.589738  0.606707  0.575695       984

Test Acc: 0.6067073170731707 F1_ma:0.4084844141250586
Train step: 880 acc:0.7241 total_loss: 1.1002  loss:1.16,stance loss: 0.94911 
Train step: 890 acc:0.72569 total_loss: 1.0939  loss:1.281,stance loss: 0.99418 
Train step: 900 acc:0.72493 total_loss: 1.094  loss:0.76412,stance loss: 0.59814 
Train step: 910 acc:0.72802 total_loss: 1.0915  loss:0.77678,stance loss: 0.63082 
Train step: 920 acc:0.72526 total_loss: 1.0951  loss:1.3688,stance loss: 1.1636 
Train step: 930 acc:0.72772 total_loss: 1.0885  loss:0.48888,stance loss: 0.31239 
Train step: 940 acc:0.72376 total_loss: 1.0951  loss:1.0164,stance loss: 0.85428 
Train step: 950 acc:0.72438 total_loss: 1.0919  loss:1.2786,stance loss: 1.0986 
Train step: 960 acc:0.72279 total_loss: 1.0957  loss:1.0543,stance loss: 0.77838 
Train step: 970 acc:0.72237 total_loss: 1.0915  loss:0.64162,stance loss: 0.39948 
Better F1! Saving model!
Saving model of best f1: 0.45047368778302477
              precision    recall  f1-score   support

           0   0.654851  0.621239  0.637602       565
           1   0.557576  0.718750  0.627986       256
           2   0.313559  0.226994  0.263345       163

    accuracy                       0.581301       984
   macro avg   0.508662  0.522328  0.509645       984
weighted avg   0.573008  0.581301  0.573105       984

Test Acc: 0.5813008130081301 F1_ma:0.45047368778302477
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.72917 total_loss: 1.0755  loss:1.5606,stance loss: 1.603 
Train step: 990 acc:0.78289 total_loss: 0.93267  loss:1.2036,stance loss: 1.4478 
Train step: 1000 acc:0.74569 total_loss: 0.99575  loss:1.6616,stance loss: 1.7577 
Train step: 1010 acc:0.74359 total_loss: 0.99277  loss:1.2056,stance loss: 0.73679 
Better F1! Saving model!
Saving model of best f1: 0.45995777937477544
              precision    recall  f1-score   support

           0   0.667494  0.476106  0.555785       565
           1   0.523936  0.769531  0.623418       256
           2   0.326829  0.411043  0.364130       163

    accuracy                       0.541667       984
   macro avg   0.506086  0.552227  0.514444       984
weighted avg   0.573714  0.541667  0.541633       984

Test Acc: 0.5416666666666666 F1_ma:0.45995777937477544
Train step: 1020 acc:0.73852 total_loss: 1.0099  loss:1.0861,stance loss: 0.88802 
Train step: 1030 acc:0.74047 total_loss: 1.0116  loss:0.73668,stance loss: 0.54614 
Train step: 1040 acc:0.74094 total_loss: 1.0012  loss:1.1155,stance loss: 0.90004 
Train step: 1050 acc:0.74288 total_loss: 0.99718  loss:0.96823,stance loss: 0.80591 
Train step: 1060 acc:0.74508 total_loss: 0.99506  loss:1.1297,stance loss: 1.0753 
Train step: 1070 acc:0.7399 total_loss: 1.0008  loss:1.2857,stance loss: 1.5439 
Train step: 1080 acc:0.74255 total_loss: 0.99078  loss:1.0549,stance loss: 0.80542 
Train step: 1090 acc:0.74107 total_loss: 0.99309  loss:1.0784,stance loss: 0.86448 
Train step: 1100 acc:0.73934 total_loss: 0.99822  loss:1.4451,stance loss: 1.2012 
Train step: 1110 acc:0.74011 total_loss: 0.99677  loss:1.1949,stance loss: 0.99237 
Train step: 1120 acc:0.74413 total_loss: 0.99365  loss:1.1349,stance loss: 0.99454 
Better F1! Saving model!
Saving model of best f1: 0.4616477272727273
              precision    recall  f1-score   support

           0   0.662309  0.538053  0.593750       565
           1   0.571429  0.750000  0.648649       256
           2   0.306878  0.355828  0.329545       163

    accuracy                       0.563008       984
   macro avg   0.513539  0.547960  0.523981       984
weighted avg   0.579788  0.563008  0.564267       984

Test Acc: 0.5630081300813008 F1_ma:0.4616477272727273
Train step: 1130 acc:0.7441 total_loss: 0.99358  loss:1.1213,stance loss: 0.79299 
Better F1! Saving model!
Saving model of best f1: 0.46646903820816865
              precision    recall  f1-score   support

           0   0.668904  0.529204  0.590909       565
           1   0.554930  0.769531  0.644845       256
           2   0.324176  0.361963  0.342029       163

    accuracy                       0.564024       984
   macro avg   0.516003  0.553566  0.525928       984
weighted avg   0.582148  0.564024  0.563714       984

Test Acc: 0.5640243902439024 F1_ma:0.46646903820816865
Train step: 1140 acc:0.74223 total_loss: 1.0026  loss:1.0377,stance loss: 0.97209 
Train step: 1150 acc:0.74406 total_loss: 1.0008  loss:0.98488,stance loss: 0.7328 
Train step: 1160 acc:0.74339 total_loss: 1.0011  loss:1.3025,stance loss: 0.98126 
Train step: 1170 acc:0.74843 total_loss: 0.99388  loss:1.3029,stance loss: 1.1226 
Train step: 1180 acc:0.7485 total_loss: 0.99713  loss:0.89079,stance loss: 0.58196 
Train step: 1190 acc:0.74914 total_loss: 0.99461  loss:1.3437,stance loss: 1.5807 
Train step: 1200 acc:0.74945 total_loss: 0.99259  loss:1.3568,stance loss: 1.603 
Train step: 1210 acc:0.74869 total_loss: 0.9982  loss:1.4552,stance loss: 1.0541 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.83333 total_loss: 0.74585  loss:0.71254,stance loss: 0.5473 
Train step: 1230 acc:0.80078 total_loss: 0.81326  loss:0.73421,stance loss: 0.61461 
Train step: 1240 acc:0.8101 total_loss: 0.84205  loss:0.4428,stance loss: 0.27074 
Train step: 1250 acc:0.78472 total_loss: 0.87279  loss:0.69103,stance loss: 0.53374 
Train step: 1260 acc:0.77446 total_loss: 0.90591  loss:0.6883,stance loss: 0.5131 
Train step: 1270 acc:0.78237 total_loss: 0.88547  loss:0.91077,stance loss: 0.73294 
Train step: 1280 acc:0.78504 total_loss: 0.89109  loss:0.69511,stance loss: 0.44443 
Train step: 1290 acc:0.78125 total_loss: 0.8876  loss:0.91641,stance loss: 1.1232 
Train step: 1300 acc:0.77762 total_loss: 0.8934  loss:1.0343,stance loss: 0.8875 
Train step: 1310 acc:0.77734 total_loss: 0.90163  loss:0.62662,stance loss: 0.42919 
Train step: 1320 acc:0.7783 total_loss: 0.8952  loss:0.54445,stance loss: 0.40926 
Train step: 1330 acc:0.77748 total_loss: 0.89092  loss:0.67076,stance loss: 0.51193 
Train step: 1340 acc:0.77728 total_loss: 0.89498  loss:1.0071,stance loss: 0.83813 
Train step: 1350 acc:0.77665 total_loss: 0.89968  loss:1.0806,stance loss: 1.4333 
Train step: 1360 acc:0.77526 total_loss: 0.89729  loss:0.48673,stance loss: 0.27667 
Train step: 1370 acc:0.77364 total_loss: 0.90337  loss:1.0612,stance loss: 0.80757 
Train step: 1380 acc:0.7741 total_loss: 0.90108  loss:1.1424,stance loss: 0.92566 
Train step: 1390 acc:0.77592 total_loss: 0.89753  loss:0.72737,stance loss: 0.60537 
Train step: 1400 acc:0.77755 total_loss: 0.89425  loss:0.86894,stance loss: 0.75512 
Train step: 1410 acc:0.77997 total_loss: 0.89325  loss:1.0296,stance loss: 0.82784 
Train step: 1420 acc:0.77852 total_loss: 0.89195  loss:0.72568,stance loss: 0.58021 
Train step: 1430 acc:0.78009 total_loss: 0.887  loss:0.81356,stance loss: 0.70442 
Train step: 1440 acc:0.78125 total_loss: 0.88453  loss:0.72035,stance loss: 0.50524 
Train step: 1450 acc:0.78125 total_loss: 0.88652  loss:1.1236,stance loss: 0.88519 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.83333 total_loss: 0.72825  loss:0.5849,stance loss: 0.36517 
Train step: 1470 acc:0.80769 total_loss: 0.76863  loss:0.87296,stance loss: 0.85304 
Train step: 1480 acc:0.82609 total_loss: 0.73187  loss:0.7549,stance loss: 0.50809 
Train step: 1490 acc:0.82955 total_loss: 0.75593  loss:0.25991,stance loss: 0.15847 
Train step: 1500 acc:0.82558 total_loss: 0.73386  loss:0.69489,stance loss: 0.57666 
Train step: 1510 acc:0.83373 total_loss: 0.72274  loss:0.9432,stance loss: 1.2524 
Train step: 1520 acc:0.83036 total_loss: 0.72915  loss:0.44197,stance loss: 0.3269 
Train step: 1530 acc:0.81849 total_loss: 0.74609  loss:0.61365,stance loss: 0.44644 
Train step: 1540 acc:0.81325 total_loss: 0.76198  loss:0.49374,stance loss: 0.31842 
Train step: 1550 acc:0.81183 total_loss: 0.77325  loss:0.84129,stance loss: 0.57111 
Train step: 1560 acc:0.81311 total_loss: 0.77526  loss:1.1838,stance loss: 0.93732 
Train step: 1570 acc:0.81471 total_loss: 0.77842  loss:0.51738,stance loss: 0.34637 
Train step: 1580 acc:0.81453 total_loss: 0.77199  loss:0.51784,stance loss: 0.41465 
Train step: 1590 acc:0.81626 total_loss: 0.77323  loss:0.562,stance loss: 0.48209 
Train step: 1600 acc:0.81556 total_loss: 0.7701  loss:0.61291,stance loss: 0.39656 
Train step: 1610 acc:0.81373 total_loss: 0.77085  loss:0.65858,stance loss: 0.56105 
Train step: 1620 acc:0.81403 total_loss: 0.77127  loss:0.50324,stance loss: 0.37682 
Train step: 1630 acc:0.81539 total_loss: 0.77021  loss:0.65595,stance loss: 0.54932 
Train step: 1640 acc:0.81592 total_loss: 0.76763  loss:0.53171,stance loss: 0.46846 
Train step: 1650 acc:0.81347 total_loss: 0.77425  loss:0.71856,stance loss: 0.71882 
Train step: 1660 acc:0.81281 total_loss: 0.77445  loss:1.1056,stance loss: 0.71804 
Train step: 1670 acc:0.81191 total_loss: 0.77436  loss:0.8949,stance loss: 0.76446 
Train step: 1680 acc:0.81502 total_loss: 0.76602  loss:0.49106,stance loss: 0.25768 
Train step: 1690 acc:0.81491 total_loss: 0.76847  loss:0.70914,stance loss: 1.06 
Train step: 1700 acc:0.81498 total_loss: 0.76646  loss:1.1098,stance loss: 0.81419 
Better F1! Saving model!
Saving model of best f1: 0.4741399327833792
              precision    recall  f1-score   support

           0   0.665399  0.619469  0.641613       565
           1   0.563863  0.707031  0.627383       256
           2   0.335766  0.282209  0.306667       163

    accuracy                       0.586382       984
   macro avg   0.521676  0.536236  0.525221       984
weighted avg   0.584379  0.586382  0.582427       984

Test Acc: 0.5863821138211383 F1_ma:0.4741399327833792
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.875 total_loss: 0.5696  loss:0.45903,stance loss: 0.27085 
Better F1! Saving model!
Saving model of best f1: 0.4834637162121606
              precision    recall  f1-score   support

           0   0.668699  0.582301  0.622517       565
           1   0.561728  0.710938  0.627586       256
           2   0.339286  0.349693  0.344411       163

    accuracy                       0.577236       984
   macro avg   0.523238  0.547644  0.531505       984
weighted avg   0.586302  0.577236  0.577767       984

Test Acc: 0.5772357723577236 F1_ma:0.4834637162121606
Train step: 1720 acc:0.83437 total_loss: 0.64672  loss:0.5373,stance loss: 0.32525 
Train step: 1730 acc:0.8375 total_loss: 0.65954  loss:0.63758,stance loss: 0.5438 
Train step: 1740 acc:0.84062 total_loss: 0.6446  loss:0.70761,stance loss: 0.46 
Train step: 1750 acc:0.83875 total_loss: 0.64408  loss:0.51434,stance loss: 0.35893 
Train step: 1760 acc:0.83021 total_loss: 0.65526  loss:0.70216,stance loss: 0.42652 
Train step: 1770 acc:0.83304 total_loss: 0.66078  loss:0.50258,stance loss: 0.43261 
Train step: 1780 acc:0.83594 total_loss: 0.6602  loss:0.60531,stance loss: 0.56128 
Train step: 1790 acc:0.83611 total_loss: 0.66607  loss:0.72797,stance loss: 1.0775 
Train step: 1800 acc:0.84188 total_loss: 0.65188  loss:0.78546,stance loss: 0.63771 
Train step: 1810 acc:0.84205 total_loss: 0.65045  loss:0.475,stance loss: 0.35589 
Train step: 1820 acc:0.84635 total_loss: 0.64436  loss:0.63683,stance loss: 0.48403 
Train step: 1830 acc:0.84519 total_loss: 0.6519  loss:0.91786,stance loss: 1.2834 
Better F1! Saving model!
Saving model of best f1: 0.4838270469181233
              precision    recall  f1-score   support

           0   0.674330  0.623009  0.647654       565
           1   0.542857  0.742188  0.627063       256
           2   0.392857  0.269939  0.320000       163

    accuracy                       0.595528       984
   macro avg   0.536681  0.545045  0.531572       984
weighted avg   0.593499  0.595528  0.588021       984

Test Acc: 0.5955284552845529 F1_ma:0.4838270469181233
Train step: 1840 acc:0.84643 total_loss: 0.65129  loss:0.63337,stance loss: 0.50279 
Train step: 1850 acc:0.84667 total_loss: 0.65232  loss:0.57325,stance loss: 0.41084 
Train step: 1860 acc:0.84648 total_loss: 0.65598  loss:0.89946,stance loss: 0.75534 
Train step: 1870 acc:0.84228 total_loss: 0.66746  loss:0.51991,stance loss: 0.41555 
Train step: 1880 acc:0.84132 total_loss: 0.67065  loss:0.50883,stance loss: 0.39654 
Train step: 1890 acc:0.8398 total_loss: 0.67245  loss:0.932,stance loss: 0.84447 
Train step: 1900 acc:0.84 total_loss: 0.67135  loss:0.46839,stance loss: 0.35915 
Train step: 1910 acc:0.83631 total_loss: 0.67926  loss:0.71825,stance loss: 0.45448 
Train step: 1920 acc:0.8358 total_loss: 0.67906  loss:0.38029,stance loss: 0.2491 
Better F1! Saving model!
Saving model of best f1: 0.5017820317403389
              precision    recall  f1-score   support

           0   0.650246  0.700885  0.674617       565
           1   0.623932  0.570312  0.595918       256
           2   0.354610  0.306748  0.328947       163

    accuracy                       0.601626       984
   macro avg   0.542929  0.525982  0.533161       984
weighted avg   0.594428  0.601626  0.596882       984

Test Acc: 0.6016260162601627 F1_ma:0.5017820317403389
Train step: 1930 acc:0.83451 total_loss: 0.67629  loss:0.40718,stance loss: 0.32668 
Train step: 1940 acc:0.8362 total_loss: 0.67796  loss:0.69308,stance loss: 0.73632 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.91071 total_loss: 0.51126  loss:0.68562,stance loss: 0.78023 
Train step: 1960 acc:0.83456 total_loss: 0.5882  loss:0.6895,stance loss: 0.53603 
Train step: 1970 acc:0.86806 total_loss: 0.53682  loss:0.44346,stance loss: 0.3431 
Train step: 1980 acc:0.86486 total_loss: 0.53231  loss:0.23312,stance loss: 0.14821 
Train step: 1990 acc:0.85904 total_loss: 0.56656  loss:0.42382,stance loss: 0.30245 
Train step: 2000 acc:0.86184 total_loss: 0.5715  loss:0.7622,stance loss: 0.55099 
Train step: 2010 acc:0.86474 total_loss: 0.56951  loss:0.59601,stance loss: 0.43317 
Train step: 2020 acc:0.86932 total_loss: 0.55896  loss:0.49831,stance loss: 0.38638 
Train step: 2030 acc:0.86638 total_loss: 0.5845  loss:0.71929,stance loss: 0.59675 
Train step: 2040 acc:0.86662 total_loss: 0.58759  loss:1.0572,stance loss: 0.84611 
Train step: 2050 acc:0.87033 total_loss: 0.5852  loss:0.44495,stance loss: 0.40753 
Train step: 2060 acc:0.87179 total_loss: 0.58553  loss:0.66763,stance loss: 0.53627 
Train step: 2070 acc:0.87451 total_loss: 0.57363  loss:0.41969,stance loss: 0.31988 
Train step: 2080 acc:0.87546 total_loss: 0.56931  loss:0.30509,stance loss: 0.27274 
Train step: 2090 acc:0.87457 total_loss: 0.56652  loss:0.77664,stance loss: 0.59842 
Train step: 2100 acc:0.8746 total_loss: 0.56493  loss:0.21988,stance loss: 0.10582 
Train step: 2110 acc:0.87575 total_loss: 0.56738  loss:0.62259,stance loss: 0.59029 
Train step: 2120 acc:0.87782 total_loss: 0.55883  loss:0.52542,stance loss: 0.42333 
Train step: 2130 acc:0.87634 total_loss: 0.56703  loss:1.052,stance loss: 1.0735 
Train step: 2140 acc:0.87563 total_loss: 0.56745  loss:0.53795,stance loss: 0.39856 
Train step: 2150 acc:0.8744 total_loss: 0.57165  loss:0.9098,stance loss: 1.3391 
Train step: 2160 acc:0.87327 total_loss: 0.57327  loss:0.99374,stance loss: 0.87785 
Train step: 2170 acc:0.8728 total_loss: 0.5727  loss:0.76002,stance loss: 0.54978 
Train step: 2180 acc:0.87289 total_loss: 0.57475  loss:0.55436,stance loss: 0.45884 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.9375 total_loss: 0.43028  loss:0.21051,stance loss: 0.14048 
Train step: 2200 acc:0.92857 total_loss: 0.39285  loss:0.24298,stance loss: 0.21422 
Train step: 2210 acc:0.91146 total_loss: 0.42377  loss:0.35695,stance loss: 0.23284 
Train step: 2220 acc:0.90441 total_loss: 0.4556  loss:1.0061,stance loss: 1.3202 
Train step: 2230 acc:0.90625 total_loss: 0.45546  loss:0.60203,stance loss: 0.43107 
Train step: 2240 acc:0.90046 total_loss: 0.47564  loss:0.69998,stance loss: 1.0237 
Train step: 2250 acc:0.89746 total_loss: 0.48308  loss:0.7694,stance loss: 0.6276 
Train step: 2260 acc:0.8978 total_loss: 0.48109  loss:0.27737,stance loss: 0.21906 
Train step: 2270 acc:0.88988 total_loss: 0.49461  loss:0.92354,stance loss: 0.70213 
Train step: 2280 acc:0.88963 total_loss: 0.49628  loss:0.21928,stance loss: 0.15551 
Train step: 2290 acc:0.88882 total_loss: 0.4971  loss:0.50197,stance loss: 0.38401 
Train step: 2300 acc:0.88596 total_loss: 0.51715  loss:0.69498,stance loss: 0.5327 
Train step: 2310 acc:0.88508 total_loss: 0.52043  loss:0.59194,stance loss: 0.52089 
Train step: 2320 acc:0.88853 total_loss: 0.5153  loss:0.33132,stance loss: 0.21972 
Train step: 2330 acc:0.88889 total_loss: 0.51367  loss:0.46579,stance loss: 0.19703 
Train step: 2340 acc:0.88961 total_loss: 0.50802  loss:0.23859,stance loss: 0.12193 
Train step: 2350 acc:0.89139 total_loss: 0.49937  loss:0.20054,stance loss: 0.088226 
Train step: 2360 acc:0.89116 total_loss: 0.49627  loss:0.41334,stance loss: 0.34346 
Train step: 2370 acc:0.88961 total_loss: 0.50089  loss:0.59021,stance loss: 0.41069 
Train step: 2380 acc:0.88724 total_loss: 0.50252  loss:0.45732,stance loss: 0.32055 
Train step: 2390 acc:0.88695 total_loss: 0.5079  loss:0.44802,stance loss: 0.36234 
Train step: 2400 acc:0.88668 total_loss: 0.50998  loss:0.7552,stance loss: 1.1645 
Train step: 2410 acc:0.88588 total_loss: 0.5091  loss:0.26684,stance loss: 0.1514 
Train step: 2420 acc:0.88542 total_loss: 0.51531  loss:0.7462,stance loss: 1.0983 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:1.0 total_loss: 0.61283  loss:0.61283,stance loss: 1.0222 
Train step: 2440 acc:0.94886 total_loss: 0.37128  loss:0.38415,stance loss: 0.32892 
Train step: 2450 acc:0.93452 total_loss: 0.3853  loss:0.31434,stance loss: 0.19296 
Train step: 2460 acc:0.93145 total_loss: 0.39389  loss:0.077108,stance loss: 0.025351 
Better F1! Saving model!
Saving model of best f1: 0.5180344261124206
              precision    recall  f1-score   support

           0   0.658203  0.596460  0.625812       565
           1   0.620408  0.593750  0.606786       256
           2   0.352423  0.490798  0.410256       163

    accuracy                       0.578252       984
   macro avg   0.543678  0.560336  0.547618       984
weighted avg   0.597718  0.578252  0.585156       984

Test Acc: 0.5782520325203252 F1_ma:0.5180344261124206
Train step: 2470 acc:0.93445 total_loss: 0.39268  loss:0.70577,stance loss: 0.6392 
Train step: 2480 acc:0.93627 total_loss: 0.39576  loss:0.68147,stance loss: 0.54976 
Train step: 2490 acc:0.92623 total_loss: 0.41457  loss:0.95541,stance loss: 1.2821 
Train step: 2500 acc:0.92518 total_loss: 0.4266  loss:0.30716,stance loss: 0.3342 
Train step: 2510 acc:0.92361 total_loss: 0.43991  loss:0.1043,stance loss: 0.018044 
Train step: 2520 acc:0.92033 total_loss: 0.4345  loss:0.26662,stance loss: 0.19601 
Train step: 2530 acc:0.91955 total_loss: 0.43125  loss:0.2027,stance loss: 0.16594 
Train step: 2540 acc:0.91948 total_loss: 0.44153  loss:0.21643,stance loss: 0.21243 
Train step: 2550 acc:0.91994 total_loss: 0.43946  loss:0.30652,stance loss: 0.27865 
Train step: 2560 acc:0.91985 total_loss: 0.43256  loss:0.12266,stance loss: 0.078808 
Train step: 2570 acc:0.918 total_loss: 0.42984  loss:0.23699,stance loss: 0.21682 
Train step: 2580 acc:0.91846 total_loss: 0.42628  loss:0.21858,stance loss: 0.13511 
Train step: 2590 acc:0.91925 total_loss: 0.42575  loss:0.089051,stance loss: 0.042109 
Train step: 2600 acc:0.91813 total_loss: 0.4279  loss:0.34479,stance loss: 0.29596 
Train step: 2610 acc:0.91747 total_loss: 0.43392  loss:1.1493,stance loss: 1.5398 
Train step: 2620 acc:0.91623 total_loss: 0.4382  loss:0.86602,stance loss: 0.527 
Train step: 2630 acc:0.91573 total_loss: 0.438  loss:0.48241,stance loss: 0.19683 
Train step: 2640 acc:0.91499 total_loss: 0.43492  loss:0.081102,stance loss: 0.028872 
Train step: 2650 acc:0.91431 total_loss: 0.43544  loss:0.65319,stance loss: 1.032 
Train step: 2660 acc:0.9145 total_loss: 0.43285  loss:0.46115,stance loss: 0.39853 
Train step: 2670 acc:0.91468 total_loss: 0.42932  loss:0.10779,stance loss: 0.016395 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.90625 total_loss: 0.425  loss:0.20111,stance loss: 0.047977 
Train step: 2690 acc:0.92361 total_loss: 0.34574  loss:0.70193,stance loss: 1.1303 
Train step: 2700 acc:0.92188 total_loss: 0.3494  loss:0.19305,stance loss: 0.11054 
Train step: 2710 acc:0.92599 total_loss: 0.3738  loss:0.4719,stance loss: 0.4168 
Train step: 2720 acc:0.92708 total_loss: 0.34815  loss:0.08588,stance loss: 0.044856 
Train step: 2730 acc:0.9278 total_loss: 0.35719  loss:0.83834,stance loss: 1.2938 
Train step: 2740 acc:0.92923 total_loss: 0.34791  loss:0.11101,stance loss: 0.06149 
Train step: 2750 acc:0.92788 total_loss: 0.35067  loss:0.57916,stance loss: 1.0183 
Train step: 2760 acc:0.9304 total_loss: 0.33946  loss:0.091431,stance loss: 0.033883 
Train step: 2770 acc:0.9324 total_loss: 0.34535  loss:0.6707,stance loss: 1.0541 
Train step: 2780 acc:0.93229 total_loss: 0.35521  loss:0.45218,stance loss: 0.38076 
Train step: 2790 acc:0.93432 total_loss: 0.34533  loss:0.411,stance loss: 0.33412 
Train step: 2800 acc:0.93604 total_loss: 0.33689  loss:0.42187,stance loss: 0.35798 
Train step: 2810 acc:0.93569 total_loss: 0.33843  loss:0.48034,stance loss: 0.31689 
Train step: 2820 acc:0.93539 total_loss: 0.34743  loss:0.14081,stance loss: 0.096115 
Train step: 2830 acc:0.9375 total_loss: 0.34179  loss:0.35358,stance loss: 0.26785 
Train step: 2840 acc:0.93713 total_loss: 0.3444  loss:0.051488,stance loss: 0.02013 
Train step: 2850 acc:0.9368 total_loss: 0.33943  loss:0.2081,stance loss: 0.18599 
Train step: 2860 acc:0.93551 total_loss: 0.34694  loss:0.67703,stance loss: 0.41434 
Train step: 2870 acc:0.93371 total_loss: 0.34812  loss:0.31195,stance loss: 0.25756 
Train step: 2880 acc:0.93299 total_loss: 0.35266  loss:0.48925,stance loss: 0.41279 
Train step: 2890 acc:0.93263 total_loss: 0.35409  loss:0.15394,stance loss: 0.13009 
Train step: 2900 acc:0.93147 total_loss: 0.35387  loss:0.059694,stance loss: 0.014808 
Train step: 2910 acc:0.93172 total_loss: 0.3533  loss:0.30047,stance loss: 0.21081 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.925 total_loss: 0.26853  loss:0.49773,stance loss: 0.29074 
Train step: 2930 acc:0.92917 total_loss: 0.35706  loss:0.16692,stance loss: 0.14603 
Train step: 2940 acc:0.92 total_loss: 0.3353  loss:0.31576,stance loss: 0.19203 
Train step: 2950 acc:0.92321 total_loss: 0.30956  loss:0.38425,stance loss: 0.2638 
Train step: 2960 acc:0.93472 total_loss: 0.29814  loss:0.16469,stance loss: 0.11193 
Train step: 2970 acc:0.9375 total_loss: 0.29259  loss:0.12052,stance loss: 0.11183 
Train step: 2980 acc:0.9375 total_loss: 0.28767  loss:0.14581,stance loss: 0.10953 
Train step: 2990 acc:0.9425 total_loss: 0.2841  loss:0.69476,stance loss: 1.1991 
Train step: 3000 acc:0.94412 total_loss: 0.27297  loss:0.19594,stance loss: 0.18321 
Train step: 3010 acc:0.94539 total_loss: 0.27476  loss:0.57629,stance loss: 1.0208 
Train step: 3020 acc:0.94524 total_loss: 0.27881  loss:0.17693,stance loss: 0.061355 
Train step: 3030 acc:0.94457 total_loss: 0.2827  loss:0.35003,stance loss: 0.3106 
Train step: 3040 acc:0.9425 total_loss: 0.29268  loss:0.24476,stance loss: 0.18146 
Train step: 3050 acc:0.9412 total_loss: 0.30722  loss:0.55161,stance loss: 1.0181 
Train step: 3060 acc:0.94052 total_loss: 0.31417  loss:0.12929,stance loss: 0.064809 
Train step: 3070 acc:0.94073 total_loss: 0.30973  loss:0.099606,stance loss: 0.050884 
Train step: 3080 acc:0.94053 total_loss: 0.30602  loss:0.41164,stance loss: 0.35021 
Train step: 3090 acc:0.93964 total_loss: 0.31106  loss:0.32754,stance loss: 0.21957 
Train step: 3100 acc:0.94122 total_loss: 0.30402  loss:0.34429,stance loss: 0.3046 
Train step: 3110 acc:0.94199 total_loss: 0.30094  loss:0.57277,stance loss: 1.0137 
Train step: 3120 acc:0.94268 total_loss: 0.29768  loss:0.19734,stance loss: 0.14873 
Train step: 3130 acc:0.94302 total_loss: 0.29249  loss:0.17563,stance loss: 0.14578 
Train step: 3140 acc:0.94194 total_loss: 0.29364  loss:0.055333,stance loss: 0.016788 
Train step: 3150 acc:0.94202 total_loss: 0.29713  loss:0.18892,stance loss: 0.19018 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.076468  loss:0.048971,stance loss: 0.015636 
Train step: 3170 acc:0.97396 total_loss: 0.11855  loss:0.14666,stance loss: 0.14323 
Train step: 3180 acc:0.96591 total_loss: 0.16204  loss:0.034352,stance loss: 0.0047416 
Train step: 3190 acc:0.96289 total_loss: 0.17951  loss:0.060928,stance loss: 0.0082121 
Train step: 3200 acc:0.9628 total_loss: 0.22609  loss:0.74325,stance loss: 0.72842 
Train step: 3210 acc:0.95913 total_loss: 0.24138  loss:0.021497,stance loss: 0.0040198 
Train step: 3220 acc:0.96169 total_loss: 0.23398  loss:0.13081,stance loss: 0.055203 
Train step: 3230 acc:0.96094 total_loss: 0.22459  loss:0.22783,stance loss: 0.12866 
Train step: 3240 acc:0.9596 total_loss: 0.22208  loss:0.1196,stance loss: 0.040541 
Train step: 3250 acc:0.96128 total_loss: 0.22065  loss:0.022238,stance loss: 0.00017445 
Train step: 3260 acc:0.96262 total_loss: 0.22605  loss:0.36592,stance loss: 0.21032 
Train step: 3270 acc:0.96094 total_loss: 0.22475  loss:0.055029,stance loss: 0.0052292 
Train step: 3280 acc:0.95953 total_loss: 0.23945  loss:0.22453,stance loss: 0.27232 
Train step: 3290 acc:0.9607 total_loss: 0.24636  loss:0.075381,stance loss: 0.015729 
Train step: 3300 acc:0.96039 total_loss: 0.2404  loss:0.33588,stance loss: 0.21674 
Train step: 3310 acc:0.95929 total_loss: 0.24739  loss:0.32953,stance loss: 0.38998 
Train step: 3320 acc:0.9591 total_loss: 0.24678  loss:0.066831,stance loss: 0.014459 
Train step: 3330 acc:0.9593 total_loss: 0.24685  loss:0.053988,stance loss: 0.018299 
Train step: 3340 acc:0.95913 total_loss: 0.24796  loss:0.2725,stance loss: 0.30477 
Train step: 3350 acc:0.95833 total_loss: 0.24645  loss:0.0884,stance loss: 0.08536 
Train step: 3360 acc:0.95761 total_loss: 0.25099  loss:0.11308,stance loss: 0.057142 
Train step: 3370 acc:0.95784 total_loss: 0.25026  loss:0.026108,stance loss: 0.0029498 
Train step: 3380 acc:0.95777 total_loss: 0.25095  loss:0.043936,stance loss: 0.012178 
Train step: 3390 acc:0.95744 total_loss: 0.25307  loss:0.11152,stance loss: 0.0070952 
Train step: 3400 acc:0.95687 total_loss: 0.2574  loss:0.97214,stance loss: 0.99183 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.96528 total_loss: 0.26813  loss:0.35993,stance loss: 0.34346 
Train step: 3420 acc:0.96711 total_loss: 0.24145  loss:0.14565,stance loss: 0.12378 
Train step: 3430 acc:0.96983 total_loss: 0.20082  loss:0.084915,stance loss: 0.021115 
Train step: 3440 acc:0.97115 total_loss: 0.2029  loss:0.083452,stance loss: 0.051908 
Train step: 3450 acc:0.96429 total_loss: 0.22148  loss:0.47053,stance loss: 0.49407 
Train step: 3460 acc:0.96822 total_loss: 0.2151  loss:0.016278,stance loss: 0.00029777 
Train step: 3470 acc:0.9692 total_loss: 0.20722  loss:0.066056,stance loss: 0.045522 
Train step: 3480 acc:0.97073 total_loss: 0.19698  loss:0.064519,stance loss: 0.040795 
Train step: 3490 acc:0.9698 total_loss: 0.19015  loss:0.073339,stance loss: 0.016591 
Train step: 3500 acc:0.9697 total_loss: 0.20182  loss:0.14921,stance loss: 0.1377 
Train step: 3510 acc:0.96961 total_loss: 0.20223  loss:0.15116,stance loss: 0.14981 
Train step: 3520 acc:0.97059 total_loss: 0.19168  loss:0.16603,stance loss: 0.15411 
Train step: 3530 acc:0.96851 total_loss: 0.19267  loss:0.38603,stance loss: 0.17412 
Train step: 3540 acc:0.96448 total_loss: 0.2035  loss:0.21841,stance loss: 0.19114 
Train step: 3550 acc:0.96267 total_loss: 0.21481  loss:0.45597,stance loss: 0.32327 
Train step: 3560 acc:0.96305 total_loss: 0.21895  loss:0.47769,stance loss: 0.36166 
Train step: 3570 acc:0.96265 total_loss: 0.22198  loss:0.91066,stance loss: 1.2531 
Train step: 3580 acc:0.96299 total_loss: 0.21953  loss:0.03301,stance loss: 0.0055386 
Train step: 3590 acc:0.96396 total_loss: 0.21746  loss:0.20768,stance loss: 0.29017 
Train step: 3600 acc:0.96357 total_loss: 0.21746  loss:0.26679,stance loss: 0.1994 
Train step: 3610 acc:0.96441 total_loss: 0.21378  loss:0.048738,stance loss: 0.037426 
Train step: 3620 acc:0.96404 total_loss: 0.21638  loss:0.024636,stance loss: 0.0057259 
Train step: 3630 acc:0.96479 total_loss: 0.21935  loss:0.044777,stance loss: 0.0069711 
Train step: 3640 acc:0.96365 total_loss: 0.21804  loss:0.089336,stance loss: 0.041979 
Training finished.


Reload the best model with best f1 0.5180344261124206 from path test_outputs/bert-cross-topic/hc/2023-08-16 14-46-23/state_dict


              precision    recall  f1-score   support

           0   0.658203  0.596460  0.625812       565
           1   0.620408  0.593750  0.606786       256
           2   0.352423  0.490798  0.410256       163

    accuracy                       0.578252       984
   macro avg   0.543678  0.560336  0.547618       984
weighted avg   0.597718  0.578252  0.585156       984

Test Acc: 0.5782520325203252 F1_ma:0.5180344261124206
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5180344261124206
acc: 0.5782520325203252, f1 :0.5476184264568499
classification report: 
              precision    recall  f1-score   support

         Con     0.6582    0.5965    0.6258       565
        None     0.6204    0.5938    0.6068       256
         Pro     0.3524    0.4908    0.4103       163

    accuracy                         0.5783       984
   macro avg     0.5437    0.5603    0.5476       984
weighted avg     0.5977    0.5783    0.5852       984

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 15-06-57', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 15-06-57
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.727  loss:1.727,stance loss: 1.1921 
Train step: 10 acc:0.39205 total_loss: 1.6851  loss:1.7553,stance loss: 1.2136 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 20 acc:0.42262 total_loss: 1.7191  loss:1.7499,stance loss: 1.1869 
Train step: 30 acc:0.43347 total_loss: 1.6954  loss:1.5727,stance loss: 1.1293 
Train step: 40 acc:0.44055 total_loss: 1.6831  loss:1.7177,stance loss: 1.2142 
Train step: 50 acc:0.44118 total_loss: 1.6733  loss:1.5282,stance loss: 1.0244 
Train step: 60 acc:0.45389 total_loss: 1.66  loss:1.6095,stance loss: 1.1231 
Train step: 70 acc:0.46567 total_loss: 1.6529  loss:1.5603,stance loss: 0.92763 
Train step: 80 acc:0.46373 total_loss: 1.6586  loss:1.5424,stance loss: 0.95173 
Train step: 90 acc:0.46841 total_loss: 1.6603  loss:1.5517,stance loss: 1.1453 
Train step: 100 acc:0.4672 total_loss: 1.6615  loss:1.5736,stance loss: 1.0313 
Train step: 110 acc:0.46565 total_loss: 1.6619  loss:1.4677,stance loss: 0.92543 
Train step: 120 acc:0.47159 total_loss: 1.6531  loss:1.48,stance loss: 1.024 
Train step: 130 acc:0.47376 total_loss: 1.6475  loss:1.3583,stance loss: 1.0613 
Train step: 140 acc:0.47473 total_loss: 1.6428  loss:1.5627,stance loss: 1.1774 
Train step: 150 acc:0.4731 total_loss: 1.639  loss:1.5306,stance loss: 0.85593 
Train step: 160 acc:0.47748 total_loss: 1.6276  loss:1.4674,stance loss: 0.78939 
Train step: 170 acc:0.4788 total_loss: 1.631  loss:1.6414,stance loss: 1.1648 
Train step: 180 acc:0.48377 total_loss: 1.6239  loss:1.6881,stance loss: 1.2591 
Train step: 190 acc:0.48397 total_loss: 1.6215  loss:1.4875,stance loss: 1.0459 
Train step: 200 acc:0.48725 total_loss: 1.6158  loss:1.6299,stance loss: 1.2439 
Train step: 210 acc:0.49052 total_loss: 1.6104  loss:0.96519,stance loss: 0.3335 
Train step: 220 acc:0.49293 total_loss: 1.6067  loss:1.3199,stance loss: 0.92676 
Train step: 230 acc:0.49486 total_loss: 1.6012  loss:1.2692,stance loss: 0.89534 
Train step: 240 acc:0.50026 total_loss: 1.5962  loss:1.4704,stance loss: 0.9473 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.53906 total_loss: 1.5329  loss:1.5558,stance loss: 1.1275 
Train step: 260 acc:0.56597 total_loss: 1.4687  loss:1.5882,stance loss: 1.2257 
Train step: 270 acc:0.58259 total_loss: 1.4763  loss:1.4759,stance loss: 1.2069 
Train step: 280 acc:0.55921 total_loss: 1.5015  loss:1.4343,stance loss: 0.9582 
Train step: 290 acc:0.57292 total_loss: 1.4808  loss:1.5585,stance loss: 1.363 
Train step: 300 acc:0.57866 total_loss: 1.4649  loss:1.4414,stance loss: 1.1969 
Train step: 310 acc:0.57812 total_loss: 1.4704  loss:1.5214,stance loss: 1.0313 
Train step: 320 acc:0.58574 total_loss: 1.4543  loss:1.4247,stance loss: 1.1435 
Train step: 330 acc:0.5831 total_loss: 1.4517  loss:1.4761,stance loss: 0.94751 
Train step: 340 acc:0.59056 total_loss: 1.4452  loss:1.3206,stance loss: 0.97155 
Train step: 350 acc:0.59433 total_loss: 1.4402  loss:1.204,stance loss: 0.89632 
Train step: 360 acc:0.59799 total_loss: 1.4343  loss:1.2659,stance loss: 0.76703 
Train step: 370 acc:0.59863 total_loss: 1.4327  loss:1.4766,stance loss: 1.1176 
Train step: 380 acc:0.60371 total_loss: 1.4225  loss:1.1669,stance loss: 0.63751 
Train step: 390 acc:0.60684 total_loss: 1.4202  loss:1.4852,stance loss: 1.0307 
Train step: 400 acc:0.61313 total_loss: 1.4116  loss:1.2503,stance loss: 1.2769 
Train step: 410 acc:0.61272 total_loss: 1.4121  loss:1.4262,stance loss: 0.84382 
Train step: 420 acc:0.61517 total_loss: 1.404  loss:1.1892,stance loss: 1.0105 
Train step: 430 acc:0.61902 total_loss: 1.401  loss:1.7927,stance loss: 1.7725 
Train step: 440 acc:0.62184 total_loss: 1.3934  loss:1.1606,stance loss: 0.71361 
Train step: 450 acc:0.6229 total_loss: 1.396  loss:1.8442,stance loss: 1.8611 
Train step: 460 acc:0.62299 total_loss: 1.3886  loss:1.0324,stance loss: 0.69892 
Train step: 470 acc:0.62308 total_loss: 1.3896  loss:1.5957,stance loss: 1.1602 
Train step: 480 acc:0.62553 total_loss: 1.3831  loss:1.293,stance loss: 0.99558 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.625 total_loss: 1.2993  loss:1.2688,stance loss: 1.1531 
Train step: 500 acc:0.64583 total_loss: 1.2886  loss:1.2537,stance loss: 1.0303 
Train step: 510 acc:0.645 total_loss: 1.3384  loss:1.0862,stance loss: 0.88268 
Train step: 520 acc:0.64107 total_loss: 1.3176  loss:1.3624,stance loss: 1.1287 
Train step: 530 acc:0.64306 total_loss: 1.3041  loss:1.0855,stance loss: 0.7117 
Train step: 540 acc:0.65 total_loss: 1.295  loss:1.3288,stance loss: 1.0269 
Train step: 550 acc:0.65 total_loss: 1.2926  loss:1.3318,stance loss: 0.86382 
Train step: 560 acc:0.6525 total_loss: 1.2913  loss:1.2553,stance loss: 0.96277 
Train step: 570 acc:0.65662 total_loss: 1.2934  loss:1.1823,stance loss: 0.96394 
Train step: 580 acc:0.65921 total_loss: 1.2806  loss:1.0884,stance loss: 0.81579 
Train step: 590 acc:0.6619 total_loss: 1.2681  loss:1.21,stance loss: 0.91107 
Train step: 600 acc:0.66576 total_loss: 1.2629  loss:1.0492,stance loss: 0.77902 
Train step: 610 acc:0.671 total_loss: 1.254  loss:1.1768,stance loss: 0.81415 
Train step: 620 acc:0.67407 total_loss: 1.2515  loss:0.95879,stance loss: 0.70083 
Train step: 630 acc:0.67457 total_loss: 1.2449  loss:1.3675,stance loss: 1.066 
Train step: 640 acc:0.675 total_loss: 1.2396  loss:1.1746,stance loss: 0.9103 
Train step: 650 acc:0.67386 total_loss: 1.2416  loss:0.99851,stance loss: 0.67239 
Train step: 660 acc:0.67714 total_loss: 1.2353  loss:1.4485,stance loss: 1.2002 
Train step: 670 acc:0.6777 total_loss: 1.2336  loss:1.186,stance loss: 0.92638 
Train step: 680 acc:0.6766 total_loss: 1.2345  loss:1.0541,stance loss: 0.85108 
Better F1! Saving model!
Saving model of best f1: 0.45355455976747006
              precision    recall  f1-score   support

           0   0.679688  0.615929  0.646240       565
           1   0.541885  0.808594  0.648903       256
           2   0.366667  0.202454  0.260870       163

    accuracy                       0.597561       984
   macro avg   0.529413  0.542326  0.518671       984
weighted avg   0.591984  0.597561  0.583096       984

Test Acc: 0.5975609756097561 F1_ma:0.45355455976747006
Train step: 690 acc:0.6753 total_loss: 1.2308  loss:1.1043,stance loss: 0.90639 
Train step: 700 acc:0.67529 total_loss: 1.2302  loss:1.1522,stance loss: 0.8172 
Train step: 710 acc:0.67417 total_loss: 1.2314  loss:1.1542,stance loss: 0.93703 
Train step: 720 acc:0.67633 total_loss: 1.2317  loss:1.1107,stance loss: 0.82923 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.78125 total_loss: 1.0849  loss:1.3728,stance loss: 1.0596 
Train step: 740 acc:0.76042 total_loss: 1.0357  loss:0.96665,stance loss: 0.65558 
Train step: 750 acc:0.74432 total_loss: 1.073  loss:1.2953,stance loss: 1.0495 
Train step: 760 acc:0.73633 total_loss: 1.1027  loss:1.1996,stance loss: 0.99262 
Train step: 770 acc:0.71726 total_loss: 1.1216  loss:1.324,stance loss: 0.96313 
Train step: 780 acc:0.71514 total_loss: 1.1171  loss:1.4074,stance loss: 1.1804 
Train step: 790 acc:0.71875 total_loss: 1.1102  loss:1.1887,stance loss: 1.3944 
Train step: 800 acc:0.72917 total_loss: 1.0966  loss:1.0562,stance loss: 1.0344 
Train step: 810 acc:0.72942 total_loss: 1.0897  loss:0.94106,stance loss: 0.80882 
Train step: 820 acc:0.71807 total_loss: 1.1091  loss:1.6707,stance loss: 1.4333 
Train step: 830 acc:0.71814 total_loss: 1.1029  loss:1.1444,stance loss: 0.85577 
Train step: 840 acc:0.71987 total_loss: 1.0969  loss:1.0852,stance loss: 0.7924 
Better F1! Saving model!
Saving model of best f1: 0.4793040787202434
              precision    recall  f1-score   support

           0   0.674330  0.623009  0.647654       565
           1   0.552632  0.738281  0.632107       256
           2   0.366667  0.269939  0.310954       163

    accuracy                       0.594512       984
   macro avg   0.531209  0.543743  0.530238       984
weighted avg   0.591704  0.594512  0.587835       984

Test Acc: 0.5945121951219512 F1_ma:0.4793040787202434
Train step: 850 acc:0.71311 total_loss: 1.1092  loss:1.0785,stance loss: 0.9553 
Train step: 860 acc:0.70928 total_loss: 1.113  loss:1.1837,stance loss: 0.99851 
Train step: 870 acc:0.70863 total_loss: 1.1184  loss:1.5418,stance loss: 1.7444 
Train step: 880 acc:0.70683 total_loss: 1.126  loss:1.083,stance loss: 0.82079 
Train step: 890 acc:0.70679 total_loss: 1.1229  loss:1.3728,stance loss: 1.2465 
Train step: 900 acc:0.70603 total_loss: 1.1196  loss:0.85451,stance loss: 0.72009 
Train step: 910 acc:0.70398 total_loss: 1.1281  loss:1.1456,stance loss: 0.89415 
Train step: 920 acc:0.70703 total_loss: 1.1177  loss:0.87723,stance loss: 0.69217 
Train step: 930 acc:0.70792 total_loss: 1.1146  loss:1.1181,stance loss: 0.93734 
Train step: 940 acc:0.70637 total_loss: 1.1178  loss:1.0147,stance loss: 0.76781 
Train step: 950 acc:0.70552 total_loss: 1.1201  loss:1.6976,stance loss: 1.316 
Train step: 960 acc:0.7069 total_loss: 1.1169  loss:1.33,stance loss: 1.0326 
Train step: 970 acc:0.70532 total_loss: 1.121  loss:0.90035,stance loss: 0.71729 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.70833 total_loss: 1.1387  loss:1.1002,stance loss: 1.2886 
Train step: 990 acc:0.72039 total_loss: 1.0834  loss:1.0232,stance loss: 0.83109 
Train step: 1000 acc:0.71552 total_loss: 1.0178  loss:1.2311,stance loss: 1.0959 
Train step: 1010 acc:0.72436 total_loss: 1.0195  loss:0.88365,stance loss: 0.65901 
Train step: 1020 acc:0.72321 total_loss: 1.0339  loss:1.1238,stance loss: 0.88913 
Train step: 1030 acc:0.7214 total_loss: 1.0316  loss:1.1387,stance loss: 0.74825 
Train step: 1040 acc:0.73188 total_loss: 1.0194  loss:0.62707,stance loss: 0.47897 
Train step: 1050 acc:0.73339 total_loss: 1.0202  loss:0.82853,stance loss: 0.63583 
Train step: 1060 acc:0.73806 total_loss: 1.0034  loss:0.8948,stance loss: 0.57426 
Better F1! Saving model!
Saving model of best f1: 0.48687197139248484
              precision    recall  f1-score   support

           0   0.637795  0.573451  0.603914       565
           1   0.583333  0.519531  0.549587       256
           2   0.306452  0.466258  0.369830       163

    accuracy                       0.541667       984
   macro avg   0.509193  0.519747  0.507777       984
weighted avg   0.568739  0.541667  0.551004       984

Test Acc: 0.5416666666666666 F1_ma:0.48687197139248484
Train step: 1070 acc:0.73548 total_loss: 1.0061  loss:0.86571,stance loss: 0.44941 
Train step: 1080 acc:0.73222 total_loss: 0.9996  loss:0.79232,stance loss: 0.48787 
Train step: 1090 acc:0.73109 total_loss: 1.0051  loss:0.93248,stance loss: 0.67905 
Train step: 1100 acc:0.7282 total_loss: 1.0167  loss:0.87023,stance loss: 0.73579 
Train step: 1110 acc:0.73381 total_loss: 1.0154  loss:1.6811,stance loss: 1.3307 
Train step: 1120 acc:0.73238 total_loss: 1.0133  loss:0.98712,stance loss: 0.67359 
Train step: 1130 acc:0.73153 total_loss: 1.0139  loss:0.98753,stance loss: 0.74525 
Train step: 1140 acc:0.73336 total_loss: 1.0114  loss:0.84962,stance loss: 0.52158 
Train step: 1150 acc:0.73219 total_loss: 1.0067  loss:0.7215,stance loss: 0.55817 
Train step: 1160 acc:0.73313 total_loss: 1.0027  loss:1.1039,stance loss: 0.79768 
Train step: 1170 acc:0.72927 total_loss: 1.0021  loss:0.6756,stance loss: 0.53983 
Train step: 1180 acc:0.73026 total_loss: 1.0003  loss:0.89814,stance loss: 0.69706 
Train step: 1190 acc:0.72774 total_loss: 1.0027  loss:0.91383,stance loss: 0.74713 
Better F1! Saving model!
Saving model of best f1: 0.4872393972958271
              precision    recall  f1-score   support

           0   0.706294  0.536283  0.609658       565
           1   0.532847  0.855469  0.656672       256
           2   0.388889  0.343558  0.364821       163

    accuracy                       0.587398       984
   macro avg   0.542676  0.578437  0.543717       984
weighted avg   0.608591  0.587398  0.581332       984

Test Acc: 0.5873983739837398 F1_ma:0.4872393972958271
Train step: 1200 acc:0.72789 total_loss: 1.0051  loss:0.92524,stance loss: 0.71255 
Train step: 1210 acc:0.72908 total_loss: 1.0072  loss:0.97046,stance loss: 1.2091 
Better F1! Saving model!
Saving model of best f1: 0.5284090909090909
              precision    recall  f1-score   support

           0   0.629685  0.743363  0.681818       565
           1   0.613636  0.421875  0.500000       256
           2   0.404255  0.349693  0.375000       163

    accuracy                       0.594512       984
   macro avg   0.549192  0.504977  0.518939       984
weighted avg   0.588167  0.594512  0.583691       984

Test Acc: 0.5945121951219512 F1_ma:0.5284090909090909
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.78125 total_loss: 0.90216  loss:0.67502,stance loss: 0.59604 
Train step: 1230 acc:0.79297 total_loss: 0.85614  loss:0.97944,stance loss: 0.71877 
Train step: 1240 acc:0.79087 total_loss: 0.86084  loss:0.62723,stance loss: 0.45576 
Better F1! Saving model!
Saving model of best f1: 0.5347740167017275
              precision    recall  f1-score   support

           0   0.669596  0.674336  0.671958       565
           1   0.626016  0.601562  0.613546       256
           2   0.390533  0.404908  0.397590       163

    accuracy                       0.610772       984
   macro avg   0.562048  0.560269  0.561031       984
weighted avg   0.612031  0.610772  0.611312       984

Test Acc: 0.6107723577235772 F1_ma:0.5347740167017275
Train step: 1250 acc:0.7691 total_loss: 0.87893  loss:0.85366,stance loss: 0.62671 
Train step: 1260 acc:0.76359 total_loss: 0.88373  loss:1.4103,stance loss: 1.265 
Train step: 1270 acc:0.75112 total_loss: 0.88892  loss:1.2397,stance loss: 1.0261 
Train step: 1280 acc:0.76231 total_loss: 0.86985  loss:0.48907,stance loss: 0.40134 
Train step: 1290 acc:0.75493 total_loss: 0.89563  loss:1.1853,stance loss: 1.0849 
Train step: 1300 acc:0.75654 total_loss: 0.8966  loss:1.0003,stance loss: 0.85705 
Train step: 1310 acc:0.7513 total_loss: 0.91634  loss:1.1246,stance loss: 0.78587 
Train step: 1320 acc:0.75413 total_loss: 0.90837  loss:0.65235,stance loss: 0.56355 
Train step: 1330 acc:0.74892 total_loss: 0.92402  loss:0.64731,stance loss: 0.45179 
Train step: 1340 acc:0.74603 total_loss: 0.9194  loss:0.97064,stance loss: 0.81853 
Train step: 1350 acc:0.7477 total_loss: 0.91433  loss:0.79007,stance loss: 0.62572 
Train step: 1360 acc:0.747 total_loss: 0.9141  loss:0.81917,stance loss: 0.60209 
Train step: 1370 acc:0.74319 total_loss: 0.93065  loss:0.87302,stance loss: 0.73209 
Train step: 1380 acc:0.74699 total_loss: 0.92516  loss:0.77853,stance loss: 0.64606 
Train step: 1390 acc:0.75 total_loss: 0.92163  loss:1.0072,stance loss: 0.76813 
Train step: 1400 acc:0.75134 total_loss: 0.9127  loss:0.75886,stance loss: 0.50474 
Train step: 1410 acc:0.75 total_loss: 0.91271  loss:1.0396,stance loss: 0.99191 
Train step: 1420 acc:0.75061 total_loss: 0.9182  loss:1.0572,stance loss: 0.846 
Train step: 1430 acc:0.75087 total_loss: 0.92315  loss:1.1774,stance loss: 1.0779 
Train step: 1440 acc:0.75304 total_loss: 0.91934  loss:0.58491,stance loss: 0.50975 
Train step: 1450 acc:0.75503 total_loss: 0.91713  loss:1.1468,stance loss: 1.3901 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.875 total_loss: 0.43265  loss:0.49388,stance loss: 0.38947 
Train step: 1470 acc:0.80769 total_loss: 0.86358  loss:0.9432,stance loss: 1.3244 
Better F1! Saving model!
Saving model of best f1: 0.540816055006812
              precision    recall  f1-score   support

           0   0.708061  0.575221  0.634766       565
           1   0.588785  0.738281  0.655113       256
           2   0.401961  0.503067  0.446866       163

    accuracy                       0.605691       984
   macro avg   0.566269  0.605523  0.578915       984
weighted avg   0.626324  0.605691  0.608934       984

Test Acc: 0.6056910569105691 F1_ma:0.540816055006812
Train step: 1480 acc:0.81522 total_loss: 0.83817  loss:0.54899,stance loss: 0.38088 
Train step: 1490 acc:0.81629 total_loss: 0.81075  loss:1.0745,stance loss: 0.88208 
Train step: 1500 acc:0.80233 total_loss: 0.81842  loss:0.9438,stance loss: 0.79405 
Train step: 1510 acc:0.79599 total_loss: 0.82343  loss:1.0652,stance loss: 1.025 
Train step: 1520 acc:0.78869 total_loss: 0.8294  loss:0.99133,stance loss: 0.8083 
Train step: 1530 acc:0.7911 total_loss: 0.81555  loss:0.69724,stance loss: 0.46252 
Train step: 1540 acc:0.79443 total_loss: 0.80995  loss:0.43807,stance loss: 0.32167 
Train step: 1550 acc:0.79503 total_loss: 0.80941  loss:1.1338,stance loss: 1.0344 
Train step: 1560 acc:0.79612 total_loss: 0.81377  loss:0.42967,stance loss: 0.17393 
Train step: 1570 acc:0.79535 total_loss: 0.82561  loss:1.1046,stance loss: 0.9984 
Train step: 1580 acc:0.7998 total_loss: 0.8175  loss:1.0355,stance loss: 0.9242 
Train step: 1590 acc:0.79652 total_loss: 0.82579  loss:0.61583,stance loss: 0.50884 
Train step: 1600 acc:0.80026 total_loss: 0.80984  loss:0.57467,stance loss: 0.43021 
Train step: 1610 acc:0.80147 total_loss: 0.80659  loss:0.58031,stance loss: 0.55094 
Train step: 1620 acc:0.80138 total_loss: 0.80726  loss:0.76598,stance loss: 0.62997 
Train step: 1630 acc:0.80238 total_loss: 0.80331  loss:0.71012,stance loss: 0.63363 
Train step: 1640 acc:0.8026 total_loss: 0.79874  loss:0.50963,stance loss: 0.27006 
Train step: 1650 acc:0.80149 total_loss: 0.80055  loss:1.2729,stance loss: 1.0291 
Train step: 1660 acc:0.80234 total_loss: 0.79997  loss:0.7987,stance loss: 0.73961 
Train step: 1670 acc:0.80252 total_loss: 0.79957  loss:0.95013,stance loss: 0.77642 
Train step: 1680 acc:0.80129 total_loss: 0.80304  loss:1.4017,stance loss: 1.2501 
Train step: 1690 acc:0.79694 total_loss: 0.81094  loss:0.88716,stance loss: 0.72453 
Train step: 1700 acc:0.79696 total_loss: 0.81173  loss:1.3235,stance loss: 1.6544 
Better F1! Saving model!
Saving model of best f1: 0.5499934768427919
              precision    recall  f1-score   support

           0   0.678337  0.548673  0.606654       565
           1   0.608333  0.570312  0.588710       256
           2   0.386760  0.680982  0.493333       163

    accuracy                       0.576220       984
   macro avg   0.557810  0.599989  0.562899       984
weighted avg   0.611825  0.576220  0.583214       984

Test Acc: 0.5762195121951219 F1_ma:0.5499934768427919
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.80625 total_loss: 0.82844  loss:1.0646,stance loss: 0.75787 
Train step: 1720 acc:0.83125 total_loss: 0.76868  loss:0.49926,stance loss: 0.34437 
Train step: 1730 acc:0.83958 total_loss: 0.70551  loss:0.92545,stance loss: 0.66445 
Train step: 1740 acc:0.82656 total_loss: 0.71214  loss:0.95277,stance loss: 0.77037 
Train step: 1750 acc:0.825 total_loss: 0.72429  loss:0.65443,stance loss: 0.55142 
Train step: 1760 acc:0.82812 total_loss: 0.71176  loss:0.89328,stance loss: 1.203 
Better F1! Saving model!
Saving model of best f1: 0.5738532842405614
              precision    recall  f1-score   support

           0   0.650165  0.697345  0.672929       565
           1   0.573529  0.457031  0.508696       256
           2   0.459770  0.490798  0.474777       163

    accuracy                       0.600610       984
   macro avg   0.561155  0.548391  0.552134       984
weighted avg   0.598688  0.600610  0.597378       984

Test Acc: 0.600609756097561 F1_ma:0.5738532842405614
Train step: 1770 acc:0.82679 total_loss: 0.71946  loss:0.53798,stance loss: 0.38781 
Train step: 1780 acc:0.82891 total_loss: 0.7181  loss:0.8027,stance loss: 0.66121 
Train step: 1790 acc:0.82847 total_loss: 0.71345  loss:0.18313,stance loss: 0.1024 
Train step: 1800 acc:0.82437 total_loss: 0.73117  loss:0.80448,stance loss: 0.63557 
Train step: 1810 acc:0.8233 total_loss: 0.73675  loss:0.70629,stance loss: 0.62062 
Train step: 1820 acc:0.81771 total_loss: 0.74025  loss:0.73029,stance loss: 0.50713 
Train step: 1830 acc:0.8149 total_loss: 0.75472  loss:0.87071,stance loss: 0.81202 
Train step: 1840 acc:0.81473 total_loss: 0.75182  loss:0.76362,stance loss: 0.54458 
Train step: 1850 acc:0.81458 total_loss: 0.75812  loss:0.7131,stance loss: 0.47952 
Train step: 1860 acc:0.81484 total_loss: 0.75559  loss:0.88287,stance loss: 0.6562 
Train step: 1870 acc:0.81544 total_loss: 0.75163  loss:0.42225,stance loss: 0.35243 
Train step: 1880 acc:0.8184 total_loss: 0.73916  loss:0.78786,stance loss: 0.54766 
Train step: 1890 acc:0.81875 total_loss: 0.73675  loss:0.40992,stance loss: 0.34472 
Train step: 1900 acc:0.82031 total_loss: 0.73071  loss:0.5254,stance loss: 0.43729 
Train step: 1910 acc:0.82083 total_loss: 0.73226  loss:0.80092,stance loss: 0.55463 
Train step: 1920 acc:0.82102 total_loss: 0.72931  loss:1.0151,stance loss: 1.2046 
Train step: 1930 acc:0.82255 total_loss: 0.72813  loss:0.82649,stance loss: 0.62012 
Train step: 1940 acc:0.8224 total_loss: 0.729  loss:0.98176,stance loss: 0.73313 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.86607 total_loss: 0.857  loss:0.99314,stance loss: 1.3734 
Train step: 1960 acc:0.84926 total_loss: 0.75183  loss:0.70659,stance loss: 0.59859 
Better F1! Saving model!
Saving model of best f1: 0.584881121723227
              precision    recall  f1-score   support

           0   0.705411  0.623009  0.661654       565
           1   0.593525  0.644531  0.617978       256
           2   0.454106  0.576687  0.508108       163

    accuracy                       0.620935       984
   macro avg   0.584347  0.614742  0.595913       984
weighted avg   0.634674  0.620935  0.624856       984

Test Acc: 0.6209349593495935 F1_ma:0.584881121723227
Train step: 1970 acc:0.84028 total_loss: 0.72515  loss:0.42768,stance loss: 0.32688 
Train step: 1980 acc:0.84966 total_loss: 0.68235  loss:0.31307,stance loss: 0.20769 
Train step: 1990 acc:0.85505 total_loss: 0.66138  loss:0.53175,stance loss: 0.4513 
Train step: 2000 acc:0.85746 total_loss: 0.64911  loss:1.0872,stance loss: 0.8533 
Train step: 2010 acc:0.85914 total_loss: 0.62847  loss:0.44316,stance loss: 0.35923 
Train step: 2020 acc:0.85552 total_loss: 0.63869  loss:0.36294,stance loss: 0.23163 
Train step: 2030 acc:0.85129 total_loss: 0.6454  loss:0.59927,stance loss: 0.49516 
Train step: 2040 acc:0.8518 total_loss: 0.64225  loss:0.73365,stance loss: 0.42409 
Train step: 2050 acc:0.85397 total_loss: 0.63285  loss:0.27011,stance loss: 0.23619 
Train step: 2060 acc:0.8547 total_loss: 0.63568  loss:0.92101,stance loss: 1.2547 
Train step: 2070 acc:0.85335 total_loss: 0.64046  loss:0.70437,stance loss: 0.44654 
Train step: 2080 acc:0.85265 total_loss: 0.64142  loss:0.42051,stance loss: 0.3306 
Train step: 2090 acc:0.85162 total_loss: 0.65053  loss:1.3789,stance loss: 1.4995 
Train step: 2100 acc:0.85191 total_loss: 0.63788  loss:0.35905,stance loss: 0.073351 
Train step: 2110 acc:0.85217 total_loss: 0.63479  loss:0.30776,stance loss: 0.23505 
Train step: 2120 acc:0.85134 total_loss: 0.63814  loss:0.88987,stance loss: 0.59153 
Train step: 2130 acc:0.85194 total_loss: 0.63961  loss:1.0702,stance loss: 1.4242 
Train step: 2140 acc:0.85216 total_loss: 0.64809  loss:1.239,stance loss: 1.5456 
Train step: 2150 acc:0.85417 total_loss: 0.64265  loss:0.72432,stance loss: 0.81773 
Train step: 2160 acc:0.85397 total_loss: 0.65011  loss:0.67624,stance loss: 0.53706 
Train step: 2170 acc:0.8527 total_loss: 0.65208  loss:0.58442,stance loss: 0.42637 
Train step: 2180 acc:0.84942 total_loss: 0.65379  loss:0.80086,stance loss: 0.60219 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.875 total_loss: 0.51794  loss:0.63471,stance loss: 0.577 
Train step: 2200 acc:0.875 total_loss: 0.5531  loss:0.71241,stance loss: 0.57267 
Train step: 2210 acc:0.88802 total_loss: 0.54919  loss:0.67273,stance loss: 1.0801 
Train step: 2220 acc:0.88235 total_loss: 0.54415  loss:0.49618,stance loss: 0.46868 
Train step: 2230 acc:0.87784 total_loss: 0.5383  loss:0.5871,stance loss: 0.58205 
Train step: 2240 acc:0.87037 total_loss: 0.57638  loss:0.26922,stance loss: 0.16652 
Train step: 2250 acc:0.87598 total_loss: 0.55147  loss:0.30471,stance loss: 0.26966 
Train step: 2260 acc:0.875 total_loss: 0.55182  loss:0.73664,stance loss: 0.78378 
Train step: 2270 acc:0.87351 total_loss: 0.56019  loss:0.54576,stance loss: 0.5036 
Train step: 2280 acc:0.87101 total_loss: 0.56343  loss:1.2317,stance loss: 1.5444 
Train step: 2290 acc:0.8744 total_loss: 0.55169  loss:0.50289,stance loss: 0.37048 
Train step: 2300 acc:0.87336 total_loss: 0.54995  loss:0.17829,stance loss: 0.072108 
Train step: 2310 acc:0.8755 total_loss: 0.5468  loss:0.57668,stance loss: 0.43062 
Train step: 2320 acc:0.87733 total_loss: 0.54042  loss:0.36283,stance loss: 0.32155 
Train step: 2330 acc:0.8776 total_loss: 0.54477  loss:0.3624,stance loss: 0.30191 
Train step: 2340 acc:0.87946 total_loss: 0.53675  loss:0.30353,stance loss: 0.18088 
Train step: 2350 acc:0.87995 total_loss: 0.541  loss:0.67873,stance loss: 1.0583 
Train step: 2360 acc:0.87895 total_loss: 0.53983  loss:0.20145,stance loss: 0.0951 
Train step: 2370 acc:0.8767 total_loss: 0.55153  loss:0.72744,stance loss: 0.66695 
Train step: 2380 acc:0.87661 total_loss: 0.55095  loss:0.29247,stance loss: 0.12807 
Train step: 2390 acc:0.87745 total_loss: 0.54932  loss:0.28567,stance loss: 0.18724 
Train step: 2400 acc:0.87588 total_loss: 0.55274  loss:0.58186,stance loss: 0.43574 
Train step: 2410 acc:0.87667 total_loss: 0.55733  loss:0.97814,stance loss: 0.56467 
Train step: 2420 acc:0.87634 total_loss: 0.55982  loss:1.2102,stance loss: 1.335 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.39385  loss:0.39385,stance loss: 0.32822 
Train step: 2440 acc:0.90909 total_loss: 0.4963  loss:0.56963,stance loss: 0.4869 
Train step: 2450 acc:0.91071 total_loss: 0.45483  loss:0.37784,stance loss: 0.32496 
Train step: 2460 acc:0.91734 total_loss: 0.43957  loss:0.22167,stance loss: 0.15195 
Train step: 2470 acc:0.91463 total_loss: 0.44925  loss:0.58463,stance loss: 0.67058 
Train step: 2480 acc:0.91176 total_loss: 0.46371  loss:0.26524,stance loss: 0.18072 
Train step: 2490 acc:0.91086 total_loss: 0.46731  loss:0.9718,stance loss: 0.87994 
Train step: 2500 acc:0.90845 total_loss: 0.47462  loss:0.5172,stance loss: 0.44346 
Train step: 2510 acc:0.91049 total_loss: 0.47136  loss:0.41239,stance loss: 0.3385 
Train step: 2520 acc:0.90797 total_loss: 0.47048  loss:0.61742,stance loss: 0.57538 
Train step: 2530 acc:0.90718 total_loss: 0.47202  loss:0.40401,stance loss: 0.28485 
Train step: 2540 acc:0.90878 total_loss: 0.45761  loss:0.684,stance loss: 0.62053 
Train step: 2550 acc:0.91167 total_loss: 0.44608  loss:0.17286,stance loss: 0.13474 
Train step: 2560 acc:0.90935 total_loss: 0.44211  loss:0.58106,stance loss: 0.49303 
Train step: 2570 acc:0.90559 total_loss: 0.45391  loss:0.59922,stance loss: 0.44168 
Train step: 2580 acc:0.90397 total_loss: 0.46149  loss:0.66143,stance loss: 0.53315 
Train step: 2590 acc:0.90217 total_loss: 0.47666  loss:0.68837,stance loss: 0.61305 
Train step: 2600 acc:0.90058 total_loss: 0.47993  loss:0.80892,stance loss: 0.70342 
Train step: 2610 acc:0.89744 total_loss: 0.48215  loss:0.49509,stance loss: 0.49267 
Train step: 2620 acc:0.89725 total_loss: 0.48153  loss:0.549,stance loss: 0.41892 
Train step: 2630 acc:0.89956 total_loss: 0.47763  loss:0.12592,stance loss: 0.065481 
Train step: 2640 acc:0.90047 total_loss: 0.4818  loss:1.1272,stance loss: 0.87552 
Train step: 2650 acc:0.89734 total_loss: 0.48399  loss:1.1607,stance loss: 0.97642 
Train step: 2660 acc:0.89854 total_loss: 0.48313  loss:0.36507,stance loss: 0.30715 
Train step: 2670 acc:0.89756 total_loss: 0.48318  loss:1.1206,stance loss: 0.85463 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.89844 total_loss: 0.40654  loss:0.21851,stance loss: 0.22859 
Train step: 2690 acc:0.91667 total_loss: 0.39379  loss:0.11312,stance loss: 0.094527 
Train step: 2700 acc:0.92188 total_loss: 0.38216  loss:0.56955,stance loss: 0.56557 
Train step: 2710 acc:0.93257 total_loss: 0.35724  loss:0.45947,stance loss: 0.44437 
Train step: 2720 acc:0.92188 total_loss: 0.37247  loss:0.5479,stance loss: 0.28653 
Train step: 2730 acc:0.91487 total_loss: 0.38945  loss:0.21915,stance loss: 0.090043 
Train step: 2740 acc:0.91268 total_loss: 0.41387  loss:0.29732,stance loss: 0.19003 
Train step: 2750 acc:0.91266 total_loss: 0.42084  loss:0.73508,stance loss: 1.1145 
Train step: 2760 acc:0.91477 total_loss: 0.42179  loss:0.54594,stance loss: 0.39508 
Train step: 2770 acc:0.91327 total_loss: 0.42008  loss:1.1816,stance loss: 1.5952 
Train step: 2780 acc:0.91667 total_loss: 0.41043  loss:0.48731,stance loss: 0.30337 
Train step: 2790 acc:0.91896 total_loss: 0.40542  loss:0.24685,stance loss: 0.20314 
Train step: 2800 acc:0.91943 total_loss: 0.4002  loss:0.63146,stance loss: 0.55084 
Train step: 2810 acc:0.92029 total_loss: 0.39609  loss:0.4015,stance loss: 0.13551 
Train step: 2820 acc:0.92145 total_loss: 0.39956  loss:0.17929,stance loss: 0.13132 
Train step: 2830 acc:0.92049 total_loss: 0.40055  loss:0.097239,stance loss: 0.051611 
Train step: 2840 acc:0.92076 total_loss: 0.39467  loss:0.10973,stance loss: 0.050666 
Train step: 2850 acc:0.91889 total_loss: 0.40421  loss:0.72089,stance loss: 0.52552 
Train step: 2860 acc:0.91855 total_loss: 0.40849  loss:0.062546,stance loss: 0.016237 
Train step: 2870 acc:0.91793 total_loss: 0.41636  loss:0.45837,stance loss: 0.23324 
Train step: 2880 acc:0.91947 total_loss: 0.41094  loss:0.25446,stance loss: 0.091788 
Train step: 2890 acc:0.91944 total_loss: 0.41526  loss:0.54227,stance loss: 0.34778 
Train step: 2900 acc:0.9205 total_loss: 0.41157  loss:0.21017,stance loss: 0.095379 
Train step: 2910 acc:0.92043 total_loss: 0.41333  loss:0.57261,stance loss: 0.56 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.95 total_loss: 0.25414  loss:0.37169,stance loss: 0.37129 
Train step: 2930 acc:0.95833 total_loss: 0.25966  loss:0.51789,stance loss: 0.44182 
Train step: 2940 acc:0.9475 total_loss: 0.29571  loss:0.18469,stance loss: 0.096957 
Train step: 2950 acc:0.94107 total_loss: 0.31132  loss:0.24226,stance loss: 0.16584 
Train step: 2960 acc:0.94444 total_loss: 0.29688  loss:0.1619,stance loss: 0.1473 
Train step: 2970 acc:0.94318 total_loss: 0.30623  loss:0.64899,stance loss: 1.1161 
Train step: 2980 acc:0.9375 total_loss: 0.33781  loss:0.19912,stance loss: 0.16284 
Train step: 2990 acc:0.93167 total_loss: 0.367  loss:0.56989,stance loss: 0.41768 
Train step: 3000 acc:0.93235 total_loss: 0.37521  loss:0.6715,stance loss: 1.039 
Train step: 3010 acc:0.93355 total_loss: 0.36863  loss:0.5478,stance loss: 0.40074 
Train step: 3020 acc:0.93512 total_loss: 0.36289  loss:0.12646,stance loss: 0.077584 
Train step: 3030 acc:0.9375 total_loss: 0.35461  loss:0.28773,stance loss: 0.19785 
Train step: 3040 acc:0.9385 total_loss: 0.3492  loss:0.07445,stance loss: 0.030333 
Train step: 3050 acc:0.94028 total_loss: 0.34156  loss:0.64092,stance loss: 1.0468 
Train step: 3060 acc:0.94052 total_loss: 0.33498  loss:0.53134,stance loss: 0.39933 
Train step: 3070 acc:0.93911 total_loss: 0.33888  loss:0.89554,stance loss: 1.3509 
Train step: 3080 acc:0.94015 total_loss: 0.3346  loss:0.16896,stance loss: 0.16644 
Train step: 3090 acc:0.94071 total_loss: 0.32796  loss:0.14072,stance loss: 0.058223 
Train step: 3100 acc:0.93818 total_loss: 0.33417  loss:0.23554,stance loss: 0.14304 
Train step: 3110 acc:0.93782 total_loss: 0.33418  loss:0.31839,stance loss: 0.23703 
Train step: 3120 acc:0.93841 total_loss: 0.33201  loss:0.069568,stance loss: 0.035789 
Train step: 3130 acc:0.9375 total_loss: 0.33744  loss:0.27,stance loss: 0.10694 
Train step: 3140 acc:0.93583 total_loss: 0.33714  loss:0.31902,stance loss: 0.25417 
Train step: 3150 acc:0.93511 total_loss: 0.34194  loss:0.61253,stance loss: 1.0874 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:0.96875 total_loss: 0.43097  loss:0.53868,stance loss: 1.0086 
Train step: 3170 acc:0.94792 total_loss: 0.27593  loss:0.058375,stance loss: 0.011388 
Train step: 3180 acc:0.94602 total_loss: 0.32479  loss:0.22161,stance loss: 0.17574 
Train step: 3190 acc:0.95312 total_loss: 0.31747  loss:0.52795,stance loss: 0.40358 
Train step: 3200 acc:0.95238 total_loss: 0.32128  loss:0.11553,stance loss: 0.076703 
Train step: 3210 acc:0.95072 total_loss: 0.30444  loss:0.16019,stance loss: 0.059075 
Train step: 3220 acc:0.94657 total_loss: 0.32549  loss:0.13285,stance loss: 0.10579 
Train step: 3230 acc:0.94531 total_loss: 0.34039  loss:0.66885,stance loss: 1.044 
Train step: 3240 acc:0.94741 total_loss: 0.32941  loss:0.65124,stance loss: 1.0892 
Train step: 3250 acc:0.94837 total_loss: 0.32309  loss:0.16087,stance loss: 0.079405 
Train step: 3260 acc:0.94608 total_loss: 0.31879  loss:0.088913,stance loss: 0.053397 
Train step: 3270 acc:0.9481 total_loss: 0.31633  loss:0.39125,stance loss: 0.27197 
Train step: 3280 acc:0.94877 total_loss: 0.32039  loss:0.23432,stance loss: 0.13814 
Train step: 3290 acc:0.94792 total_loss: 0.31946  loss:0.15302,stance loss: 0.12311 
Train step: 3300 acc:0.94982 total_loss: 0.30791  loss:0.32749,stance loss: 0.29424 
Train step: 3310 acc:0.95066 total_loss: 0.30493  loss:0.031571,stance loss: 0.0011519 
Train step: 3320 acc:0.94869 total_loss: 0.30929  loss:0.51509,stance loss: 0.43197 
Train step: 3330 acc:0.94913 total_loss: 0.3034  loss:0.58141,stance loss: 0.46724 
Train step: 3340 acc:0.94815 total_loss: 0.30412  loss:0.52082,stance loss: 0.44346 
Train step: 3350 acc:0.94922 total_loss: 0.30364  loss:0.062942,stance loss: 0.031936 
Train step: 3360 acc:0.94926 total_loss: 0.30668  loss:0.43818,stance loss: 0.37158 
Train step: 3370 acc:0.95018 total_loss: 0.30678  loss:0.047202,stance loss: 0.013392 
Train step: 3380 acc:0.94932 total_loss: 0.31083  loss:0.26977,stance loss: 0.24356 
Train step: 3390 acc:0.94855 total_loss: 0.31271  loss:0.3483,stance loss: 0.29784 
Train step: 3400 acc:0.94912 total_loss: 0.3165  loss:0.14581,stance loss: 0.12128 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.97917 total_loss: 0.18907  loss:0.40579,stance loss: 0.33351 
Train step: 3420 acc:0.96382 total_loss: 0.24472  loss:0.080784,stance loss: 0.043727 
Train step: 3430 acc:0.95905 total_loss: 0.27546  loss:0.34004,stance loss: 0.28404 
Train step: 3440 acc:0.95673 total_loss: 0.26301  loss:0.21049,stance loss: 0.14523 
Train step: 3450 acc:0.95918 total_loss: 0.27556  loss:0.68213,stance loss: 1.1751 
Train step: 3460 acc:0.96186 total_loss: 0.27042  loss:0.54462,stance loss: 1.0087 
Train step: 3470 acc:0.96196 total_loss: 0.2876  loss:0.054258,stance loss: 0.018818 
Train step: 3480 acc:0.96044 total_loss: 0.2993  loss:0.083108,stance loss: 0.01961 
Train step: 3490 acc:0.95857 total_loss: 0.29952  loss:0.1503,stance loss: 0.17329 
Train step: 3500 acc:0.95518 total_loss: 0.30832  loss:0.2741,stance loss: 0.25352 
Train step: 3510 acc:0.95241 total_loss: 0.31222  loss:0.093494,stance loss: 0.063134 
Train step: 3520 acc:0.95378 total_loss: 0.30329  loss:0.27175,stance loss: 0.2081 
Train step: 3530 acc:0.95543 total_loss: 0.29746  loss:0.78887,stance loss: 1.2147 
Train step: 3540 acc:0.95638 total_loss: 0.29103  loss:0.10581,stance loss: 0.078597 
Train step: 3550 acc:0.95638 total_loss: 0.29185  loss:0.27773,stance loss: 0.28531 
Train step: 3560 acc:0.95637 total_loss: 0.29138  loss:0.16518,stance loss: 0.12546 
Train step: 3570 acc:0.95673 total_loss: 0.29012  loss:0.30465,stance loss: 0.30965 
Train step: 3580 acc:0.9581 total_loss: 0.28231  loss:0.067802,stance loss: 0.019226 
Train step: 3590 acc:0.958 total_loss: 0.27975  loss:0.048223,stance loss: 0.011141 
Train step: 3600 acc:0.95886 total_loss: 0.27861  loss:0.47719,stance loss: 0.45106 
Train step: 3610 acc:0.95664 total_loss: 0.27999  loss:0.16859,stance loss: 0.11024 
Train step: 3620 acc:0.95691 total_loss: 0.27999  loss:0.54137,stance loss: 0.57684 
Train step: 3630 acc:0.95633 total_loss: 0.2768  loss:0.15826,stance loss: 0.1419 
Train step: 3640 acc:0.95581 total_loss: 0.27642  loss:0.51718,stance loss: 0.23668 
Training finished.


Reload the best model with best f1 0.584881121723227 from path test_outputs/bert-cross-topic/hc/2023-08-16 15-06-57/state_dict


              precision    recall  f1-score   support

           0   0.705411  0.623009  0.661654       565
           1   0.593525  0.644531  0.617978       256
           2   0.454106  0.576687  0.508108       163

    accuracy                       0.620935       984
   macro avg   0.584347  0.614742  0.595913       984
weighted avg   0.634674  0.620935  0.624856       984

Test Acc: 0.6209349593495935 F1_ma:0.584881121723227
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.584881121723227
acc: 0.6209349593495935, f1 :0.5959132571787805
classification report: 
              precision    recall  f1-score   support

         Con     0.7054    0.6230    0.6617       565
        None     0.5935    0.6445    0.6180       256
         Pro     0.4541    0.5767    0.5081       163

    accuracy                         0.6209       984
   macro avg     0.5843    0.6147    0.5959       984
weighted avg     0.6347    0.6209    0.6249       984

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 15-27-15', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 15-27-15
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.375 total_loss: 1.8613  loss:1.8613,stance loss: 1.4309 
Train step: 10 acc:0.39773 total_loss: 1.7919  loss:1.7023,stance loss: 1.1648 
Better F1! Saving model!
Saving model of best f1: 0.33910098184411164
              precision    recall  f1-score   support

           0   0.434375  0.246018  0.314124       565
           1   0.000000  0.000000  0.000000       256
           2   0.226929  0.920245  0.364078       163

    accuracy                       0.293699       984
   macro avg   0.220435  0.388754  0.226067       984
weighted avg   0.287003  0.293699  0.240676       984

Test Acc: 0.2936991869918699 F1_ma:0.33910098184411164
Train step: 20 acc:0.41071 total_loss: 1.725  loss:1.6144,stance loss: 1.276 
Better F1! Saving model!
Saving model of best f1: 0.4219829430129156
              precision    recall  f1-score   support

           0   0.460653  0.424779  0.441989       565
           1   0.526316  0.039062  0.072727       256
           2   0.274775  0.748466  0.401977       163

    accuracy                       0.378049       984
   macro avg   0.420581  0.404103  0.305564       984
weighted avg   0.446945  0.378049  0.339293       984

Test Acc: 0.3780487804878049 F1_ma:0.4219829430129156
Train step: 30 acc:0.42339 total_loss: 1.7066  loss:1.7162,stance loss: 1.2874 
Better F1! Saving model!
Saving model of best f1: 0.43029596806754467
              precision    recall  f1-score   support

           0   0.501767  0.502655  0.502210       565
           1   0.629032  0.152344  0.245283       256
           2   0.261236  0.570552  0.358382       163

    accuracy                       0.422764       984
   macro avg   0.464012  0.408517  0.368625       984
weighted avg   0.495032  0.422764  0.411542       984

Test Acc: 0.42276422764227645 F1_ma:0.43029596806754467
Train step: 40 acc:0.42378 total_loss: 1.7014  loss:1.6154,stance loss: 1.1438 
Better F1! Saving model!
Saving model of best f1: 0.4330648457599
              precision    recall  f1-score   support

           0   0.483333  0.410619  0.444019       565
           1   0.571429  0.156250  0.245399       256
           2   0.290323  0.773006  0.422111       163

    accuracy                       0.404472       984
   macro avg   0.448361  0.446625  0.370509       984
weighted avg   0.474280  0.404472  0.388716       984

Test Acc: 0.40447154471544716 F1_ma:0.4330648457599
Train step: 50 acc:0.4277 total_loss: 1.6765  loss:1.6097,stance loss: 1.0705 
Better F1! Saving model!
Saving model of best f1: 0.4500582011274016
              precision    recall  f1-score   support

           0   0.537453  0.507965  0.522293       565
           1   0.595238  0.292969  0.392670       256
           2   0.283951  0.564417  0.377823       163

    accuracy                       0.461382       984
   macro avg   0.472214  0.455117  0.430929       984
weighted avg   0.510494  0.461382  0.464639       984

Test Acc: 0.4613821138211382 F1_ma:0.4500582011274016
Train step: 60 acc:0.44365 total_loss: 1.6653  loss:1.4582,stance loss: 1.0965 
Better F1! Saving model!
Saving model of best f1: 0.4508601014645852
              precision    recall  f1-score   support

           0   0.586705  0.718584  0.645982       565
           1   0.600000  0.351562  0.443350       256
           2   0.274648  0.239264  0.255738       163

    accuracy                       0.543699       984
   macro avg   0.487118  0.436470  0.448357       984
weighted avg   0.538472  0.543699  0.528621       984

Test Acc: 0.5436991869918699 F1_ma:0.4508601014645852
Train step: 70 acc:0.45775 total_loss: 1.6572  loss:1.4916,stance loss: 1.1598 
Better F1! Saving model!
Saving model of best f1: 0.48362397911366983
              precision    recall  f1-score   support

           0   0.546028  0.766372  0.637703       565
           1   0.000000  0.000000  0.000000       256
           2   0.306878  0.355828  0.329545       163

    accuracy                       0.498984       984
   macro avg   0.284302  0.374067  0.322416       984
weighted avg   0.364357  0.498984  0.420750       984

Test Acc: 0.49898373983739835 F1_ma:0.48362397911366983
Train step: 80 acc:0.45833 total_loss: 1.6542  loss:1.6055,stance loss: 1.0144 
Train step: 90 acc:0.45604 total_loss: 1.6503  loss:1.6488,stance loss: 1.0827 
Train step: 100 acc:0.46101 total_loss: 1.638  loss:1.7403,stance loss: 1.3346 
Train step: 110 acc:0.4634 total_loss: 1.6279  loss:1.6106,stance loss: 1.22 
Train step: 120 acc:0.46746 total_loss: 1.6203  loss:1.7833,stance loss: 1.7567 
Train step: 130 acc:0.47281 total_loss: 1.6099  loss:1.2362,stance loss: 0.72859 
Train step: 140 acc:0.47606 total_loss: 1.6005  loss:1.3985,stance loss: 0.87544 
Train step: 150 acc:0.47806 total_loss: 1.5944  loss:1.4758,stance loss: 0.98707 
Train step: 160 acc:0.48408 total_loss: 1.5933  loss:1.6598,stance loss: 1.3613 
Train step: 170 acc:0.48575 total_loss: 1.5921  loss:1.2874,stance loss: 0.88847 
Train step: 180 acc:0.48757 total_loss: 1.5858  loss:1.4268,stance loss: 0.96615 
Train step: 190 acc:0.48986 total_loss: 1.5815  loss:1.5446,stance loss: 1.1293 
Train step: 200 acc:0.49223 total_loss: 1.5795  loss:1.5743,stance loss: 1.2136 
Better F1! Saving model!
Saving model of best f1: 0.48941890622903905
              precision    recall  f1-score   support

           0   0.549020  0.594690  0.570943       565
           1   0.607595  0.187500  0.286567       256
           2   0.317406  0.570552  0.407895       163

    accuracy                       0.484756       984
   macro avg   0.491340  0.450914  0.421802       984
weighted avg   0.525892  0.484756  0.469950       984

Test Acc: 0.4847560975609756 F1_ma:0.48941890622903905
Train step: 210 acc:0.49467 total_loss: 1.5746  loss:1.2785,stance loss: 0.85392 
Train step: 220 acc:0.50085 total_loss: 1.5688  loss:1.2247,stance loss: 0.79783 
Train step: 230 acc:0.50541 total_loss: 1.5603  loss:1.1479,stance loss: 0.65049 
Better F1! Saving model!
Saving model of best f1: 0.49265467056387763
              precision    recall  f1-score   support

           0   0.634387  0.568142  0.599440       565
           1   0.564103  0.601562  0.582231       256
           2   0.346341  0.435583  0.385870       163

    accuracy                       0.554878       984
   macro avg   0.514944  0.535096  0.522513       984
weighted avg   0.568387  0.554878  0.559585       984

Test Acc: 0.5548780487804879 F1_ma:0.49265467056387763
Train step: 240 acc:0.51037 total_loss: 1.5507  loss:1.2286,stance loss: 0.87052 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.51562 total_loss: 1.4  loss:1.3701,stance loss: 0.94701 
Train step: 260 acc:0.5625 total_loss: 1.34  loss:1.1305,stance loss: 0.57405 
Train step: 270 acc:0.59375 total_loss: 1.3308  loss:0.94944,stance loss: 0.55921 
Train step: 280 acc:0.60033 total_loss: 1.3494  loss:1.2739,stance loss: 0.72774 
Train step: 290 acc:0.60286 total_loss: 1.3478  loss:1.2397,stance loss: 0.93801 
Train step: 300 acc:0.60453 total_loss: 1.3573  loss:1.5465,stance loss: 1.2854 
Train step: 310 acc:0.6011 total_loss: 1.35  loss:1.5221,stance loss: 1.3285 
Train step: 320 acc:0.60016 total_loss: 1.3539  loss:1.5766,stance loss: 1.6865 
Train step: 330 acc:0.60298 total_loss: 1.3597  loss:1.5205,stance loss: 1.0541 
Better F1! Saving model!
Saving model of best f1: 0.5226584590746441
              precision    recall  f1-score   support

           0   0.627119  0.654867  0.640693       565
           1   0.578199  0.476562  0.522484       256
           2   0.382514  0.429448  0.404624       163

    accuracy                       0.571138       984
   macro avg   0.529277  0.520293  0.522600       984
weighted avg   0.573873  0.571138  0.570834       984

Test Acc: 0.5711382113821138 F1_ma:0.5226584590746441
Train step: 340 acc:0.60651 total_loss: 1.3528  loss:1.2462,stance loss: 0.73973 
Train step: 350 acc:0.61169 total_loss: 1.3461  loss:1.2049,stance loss: 0.84042 
Train step: 360 acc:0.61811 total_loss: 1.3373  loss:1.1498,stance loss: 0.71289 
Train step: 370 acc:0.62207 total_loss: 1.3398  loss:1.7176,stance loss: 1.7622 
Train step: 380 acc:0.62319 total_loss: 1.3441  loss:1.8068,stance loss: 1.8345 
Train step: 390 acc:0.62753 total_loss: 1.3406  loss:1.3118,stance loss: 1.0117 
Train step: 400 acc:0.6337 total_loss: 1.3278  loss:1.0538,stance loss: 0.8728 
Train step: 410 acc:0.63653 total_loss: 1.3209  loss:1.0071,stance loss: 0.72896 
Train step: 420 acc:0.63694 total_loss: 1.3203  loss:1.1747,stance loss: 0.89545 
Train step: 430 acc:0.63863 total_loss: 1.3156  loss:1.3928,stance loss: 0.89814 
Train step: 440 acc:0.64015 total_loss: 1.3182  loss:0.98278,stance loss: 0.69386 
Train step: 450 acc:0.64093 total_loss: 1.3134  loss:1.5123,stance loss: 1.0955 
Train step: 460 acc:0.64278 total_loss: 1.3094  loss:1.2613,stance loss: 0.8846 
Train step: 470 acc:0.64419 total_loss: 1.3049  loss:0.83699,stance loss: 0.62847 
Train step: 480 acc:0.64496 total_loss: 1.2987  loss:1.4855,stance loss: 1.3213 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.675 total_loss: 1.2113  loss:1.18,stance loss: 0.84772 
Train step: 500 acc:0.6875 total_loss: 1.1467  loss:1.4033,stance loss: 1.0825 
Train step: 510 acc:0.66 total_loss: 1.245  loss:1.4264,stance loss: 1.5038 
Train step: 520 acc:0.67857 total_loss: 1.2259  loss:1.3408,stance loss: 0.91045 
Train step: 530 acc:0.69306 total_loss: 1.1886  loss:0.77545,stance loss: 0.50671 
Train step: 540 acc:0.69773 total_loss: 1.1843  loss:1.1179,stance loss: 0.91659 
Train step: 550 acc:0.69038 total_loss: 1.2002  loss:1.2473,stance loss: 1.045 
Train step: 560 acc:0.69333 total_loss: 1.19  loss:1.0013,stance loss: 0.70861 
Train step: 570 acc:0.6875 total_loss: 1.1866  loss:1.1296,stance loss: 0.84932 
Train step: 580 acc:0.68882 total_loss: 1.1743  loss:1.0169,stance loss: 0.80617 
Train step: 590 acc:0.69167 total_loss: 1.1654  loss:0.99689,stance loss: 0.83692 
Train step: 600 acc:0.6913 total_loss: 1.1649  loss:1.1992,stance loss: 0.93834 
Train step: 610 acc:0.689 total_loss: 1.1666  loss:1.2344,stance loss: 1.0264 
Train step: 620 acc:0.69213 total_loss: 1.1674  loss:1.569,stance loss: 1.3042 
Train step: 630 acc:0.6931 total_loss: 1.1699  loss:1.1379,stance loss: 0.81736 
Train step: 640 acc:0.69234 total_loss: 1.1675  loss:1.2082,stance loss: 0.96588 
Train step: 650 acc:0.68674 total_loss: 1.1793  loss:0.87727,stance loss: 0.49458 
Train step: 660 acc:0.68821 total_loss: 1.1784  loss:1.0451,stance loss: 0.74813 
Train step: 670 acc:0.6875 total_loss: 1.1842  loss:1.0793,stance loss: 0.66185 
Train step: 680 acc:0.68429 total_loss: 1.1875  loss:1.2027,stance loss: 0.90605 
Train step: 690 acc:0.68445 total_loss: 1.1867  loss:1.0633,stance loss: 0.75522 
Train step: 700 acc:0.68547 total_loss: 1.1847  loss:1.6303,stance loss: 1.3755 
Train step: 710 acc:0.68556 total_loss: 1.183  loss:1.2727,stance loss: 1.0725 
Better F1! Saving model!
Saving model of best f1: 0.5233782819989716
              precision    recall  f1-score   support

           0   0.643234  0.647788  0.645503       565
           1   0.548263  0.554688  0.551456       256
           2   0.410256  0.392638  0.401254       163

    accuracy                       0.581301       984
   macro avg   0.533918  0.531704  0.532738       984
weighted avg   0.579933  0.581301  0.580575       984

Test Acc: 0.5813008130081301 F1_ma:0.5233782819989716
Train step: 720 acc:0.6859 total_loss: 1.1832  loss:0.97538,stance loss: 0.78894 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.625 total_loss: 1.2256  loss:1.1273,stance loss: 0.81857 
Train step: 740 acc:0.72917 total_loss: 1.0686  loss:0.58758,stance loss: 0.32246 
Train step: 750 acc:0.72443 total_loss: 1.0772  loss:1.0589,stance loss: 0.84576 
Train step: 760 acc:0.73828 total_loss: 1.0424  loss:0.68382,stance loss: 0.36697 
Train step: 770 acc:0.72768 total_loss: 1.0684  loss:1.5007,stance loss: 1.2268 
Train step: 780 acc:0.72596 total_loss: 1.0681  loss:1.1693,stance loss: 0.98586 
Train step: 790 acc:0.72379 total_loss: 1.0738  loss:1.3896,stance loss: 1.5366 
Train step: 800 acc:0.7309 total_loss: 1.0511  loss:0.95207,stance loss: 0.73857 
Train step: 810 acc:0.73399 total_loss: 1.044  loss:0.54441,stance loss: 0.35028 
Train step: 820 acc:0.73234 total_loss: 1.0354  loss:0.98037,stance loss: 0.64596 
Train step: 830 acc:0.72672 total_loss: 1.048  loss:1.0964,stance loss: 0.83548 
Train step: 840 acc:0.72098 total_loss: 1.062  loss:0.96117,stance loss: 0.92123 
Train step: 850 acc:0.7208 total_loss: 1.0573  loss:1.038,stance loss: 0.82134 
Train step: 860 acc:0.71875 total_loss: 1.0632  loss:1.2335,stance loss: 0.95401 
Better F1! Saving model!
Saving model of best f1: 0.5244406843391615
              precision    recall  f1-score   support

           0   0.649919  0.709735  0.678511       565
           1   0.542308  0.550781  0.546512       256
           2   0.467290  0.306748  0.370370       163

    accuracy                       0.601626       984
   macro avg   0.553172  0.522421  0.531798       984
weighted avg   0.591670  0.601626  0.593126       984

Test Acc: 0.6016260162601627 F1_ma:0.5244406843391615
Train step: 870 acc:0.71919 total_loss: 1.0575  loss:0.89668,stance loss: 0.70486 
Train step: 880 acc:0.71998 total_loss: 1.0564  loss:1.2685,stance loss: 1.1218 
Train step: 890 acc:0.72068 total_loss: 1.0557  loss:0.90299,stance loss: 0.77131 
Train step: 900 acc:0.72347 total_loss: 1.0562  loss:1.0328,stance loss: 1.0166 
Train step: 910 acc:0.72184 total_loss: 1.0631  loss:1.1733,stance loss: 0.94097 
Train step: 920 acc:0.72331 total_loss: 1.0611  loss:0.90579,stance loss: 0.70531 
Train step: 930 acc:0.72092 total_loss: 1.0619  loss:1.0875,stance loss: 0.86645 
Train step: 940 acc:0.72229 total_loss: 1.0621  loss:1.2577,stance loss: 1.5307 
Train step: 950 acc:0.721 total_loss: 1.0669  loss:1.2593,stance loss: 1.0364 
Train step: 960 acc:0.72091 total_loss: 1.0664  loss:1.2879,stance loss: 0.9883 
Train step: 970 acc:0.71875 total_loss: 1.076  loss:0.69878,stance loss: 0.52419 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.69444 total_loss: 1.1741  loss:0.90705,stance loss: 0.63271 
Better F1! Saving model!
Saving model of best f1: 0.5276880344010404
              precision    recall  f1-score   support

           0   0.625000  0.601770  0.613165       565
           1   0.575610  0.460938  0.511931       256
           2   0.374468  0.539877  0.442211       163

    accuracy                       0.554878       984
   macro avg   0.525026  0.534195  0.522436       984
weighted avg   0.570650  0.554878  0.558509       984

Test Acc: 0.5548780487804879 F1_ma:0.5276880344010404
Train step: 990 acc:0.74013 total_loss: 1.0652  loss:1.0055,stance loss: 0.64778 
Train step: 1000 acc:0.71983 total_loss: 1.0845  loss:0.87312,stance loss: 0.5584 
Train step: 1010 acc:0.73718 total_loss: 1.041  loss:0.77199,stance loss: 0.43141 
Train step: 1020 acc:0.74617 total_loss: 1.0358  loss:1.0833,stance loss: 0.75681 
Train step: 1030 acc:0.74788 total_loss: 1.0387  loss:0.97766,stance loss: 0.46887 
Train step: 1040 acc:0.73732 total_loss: 1.0366  loss:1.1844,stance loss: 1.0045 
Train step: 1050 acc:0.74051 total_loss: 1.0197  loss:1.1761,stance loss: 1.078 
Train step: 1060 acc:0.74087 total_loss: 1.0129  loss:1.0413,stance loss: 0.83012 
Train step: 1070 acc:0.74369 total_loss: 1.0072  loss:1.0842,stance loss: 1.162 
Train step: 1080 acc:0.74025 total_loss: 1.0211  loss:1.2192,stance loss: 0.89235 
Train step: 1090 acc:0.73897 total_loss: 1.0149  loss:0.95398,stance loss: 0.81935 
Train step: 1100 acc:0.74079 total_loss: 1.0088  loss:0.85387,stance loss: 0.64069 
Train step: 1110 acc:0.74281 total_loss: 0.99867  loss:0.92419,stance loss: 0.76663 
Train step: 1120 acc:0.74497 total_loss: 0.99066  loss:1.3234,stance loss: 1.637 
Train step: 1130 acc:0.74175 total_loss: 0.98864  loss:0.93251,stance loss: 0.7138 
Train step: 1140 acc:0.74186 total_loss: 0.98817  loss:0.48917,stance loss: 0.24939 
Train step: 1150 acc:0.74092 total_loss: 0.99318  loss:1.2244,stance loss: 0.99815 
Train step: 1160 acc:0.7414 total_loss: 0.99104  loss:0.73702,stance loss: 0.57656 
Train step: 1170 acc:0.74121 total_loss: 0.98987  loss:1.125,stance loss: 0.90316 
Train step: 1180 acc:0.74163 total_loss: 0.98409  loss:0.69197,stance loss: 0.57245 
Train step: 1190 acc:0.74315 total_loss: 0.9841  loss:1.412,stance loss: 1.133 
Train step: 1200 acc:0.74127 total_loss: 0.98597  loss:1.0586,stance loss: 0.77727 
Train step: 1210 acc:0.74032 total_loss: 0.98224  loss:0.96976,stance loss: 0.71968 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.78125 total_loss: 0.79053  loss:0.44824,stance loss: 0.23784 
Train step: 1230 acc:0.79297 total_loss: 0.77963  loss:0.88854,stance loss: 0.65907 
Train step: 1240 acc:0.77885 total_loss: 0.83283  loss:0.81753,stance loss: 0.73591 
Train step: 1250 acc:0.76736 total_loss: 0.86173  loss:1.0328,stance loss: 1.0602 
Train step: 1260 acc:0.76223 total_loss: 0.86958  loss:0.82513,stance loss: 0.53823 
Train step: 1270 acc:0.77121 total_loss: 0.88106  loss:0.55179,stance loss: 0.39373 
Train step: 1280 acc:0.77746 total_loss: 0.8692  loss:0.88277,stance loss: 0.82073 
Train step: 1290 acc:0.77549 total_loss: 0.88245  loss:0.55381,stance loss: 0.3471 
Train step: 1300 acc:0.77398 total_loss: 0.88591  loss:0.59317,stance loss: 0.44463 
Train step: 1310 acc:0.77799 total_loss: 0.87988  loss:0.5736,stance loss: 0.34573 
Train step: 1320 acc:0.78007 total_loss: 0.87574  loss:0.95379,stance loss: 0.72415 
Train step: 1330 acc:0.78448 total_loss: 0.87392  loss:1.0378,stance loss: 0.78821 
Train step: 1340 acc:0.78075 total_loss: 0.88001  loss:1.4266,stance loss: 0.95483 
Train step: 1350 acc:0.78171 total_loss: 0.87157  loss:0.66123,stance loss: 0.44585 
Train step: 1360 acc:0.78039 total_loss: 0.86612  loss:0.43608,stance loss: 0.18707 
Train step: 1370 acc:0.78125 total_loss: 0.86208  loss:1.0993,stance loss: 1.0921 
Train step: 1380 acc:0.77974 total_loss: 0.87249  loss:0.96881,stance loss: 0.89852 
Train step: 1390 acc:0.78018 total_loss: 0.86568  loss:0.86335,stance loss: 0.62991 
Train step: 1400 acc:0.7789 total_loss: 0.86707  loss:1.0791,stance loss: 0.98006 
Train step: 1410 acc:0.77934 total_loss: 0.87299  loss:0.93715,stance loss: 0.72419 
Train step: 1420 acc:0.77609 total_loss: 0.87389  loss:0.69862,stance loss: 0.47617 
Train step: 1430 acc:0.77633 total_loss: 0.87461  loss:0.79825,stance loss: 0.6638 
Train step: 1440 acc:0.77295 total_loss: 0.87866  loss:1.4781,stance loss: 1.6522 
Train step: 1450 acc:0.77225 total_loss: 0.88326  loss:0.85019,stance loss: 0.66109 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.875 total_loss: 0.53042  loss:0.52677,stance loss: 0.22644 
Train step: 1470 acc:0.8125 total_loss: 0.71993  loss:0.72812,stance loss: 0.62603 
Train step: 1480 acc:0.7962 total_loss: 0.80593  loss:0.89647,stance loss: 0.74559 
Train step: 1490 acc:0.79924 total_loss: 0.80813  loss:0.62151,stance loss: 0.42578 
Train step: 1500 acc:0.7936 total_loss: 0.80525  loss:0.7015,stance loss: 0.58019 
Train step: 1510 acc:0.79717 total_loss: 0.79647  loss:1.2068,stance loss: 1.5228 
Train step: 1520 acc:0.80159 total_loss: 0.79778  loss:0.85479,stance loss: 0.69473 
Train step: 1530 acc:0.80394 total_loss: 0.7804  loss:0.56291,stance loss: 0.42934 
Train step: 1540 acc:0.8012 total_loss: 0.77724  loss:0.4537,stance loss: 0.3277 
Train step: 1550 acc:0.79637 total_loss: 0.79087  loss:1.0202,stance loss: 0.72731 
Train step: 1560 acc:0.7943 total_loss: 0.81173  loss:1.0219,stance loss: 0.90479 
Train step: 1570 acc:0.79867 total_loss: 0.80409  loss:0.7012,stance loss: 0.55929 
Train step: 1580 acc:0.79675 total_loss: 0.79951  loss:0.60242,stance loss: 0.45765 
Train step: 1590 acc:0.79464 total_loss: 0.79698  loss:0.78951,stance loss: 0.65376 
Train step: 1600 acc:0.7972 total_loss: 0.79079  loss:0.53616,stance loss: 0.38774 
Train step: 1610 acc:0.79616 total_loss: 0.78904  loss:0.77009,stance loss: 0.56913 
Train step: 1620 acc:0.80138 total_loss: 0.77387  loss:0.41606,stance loss: 0.30465 
Train step: 1630 acc:0.80455 total_loss: 0.76991  loss:0.98766,stance loss: 1.3844 
Train step: 1640 acc:0.80464 total_loss: 0.76917  loss:0.517,stance loss: 0.36249 
Train step: 1650 acc:0.80181 total_loss: 0.77654  loss:0.89286,stance loss: 0.71411 
Train step: 1660 acc:0.80234 total_loss: 0.7827  loss:1.011,stance loss: 0.81078 
Train step: 1670 acc:0.80282 total_loss: 0.78429  loss:1.1232,stance loss: 1.3851 
Train step: 1680 acc:0.80325 total_loss: 0.78156  loss:1.2749,stance loss: 1.5119 
Train step: 1690 acc:0.80043 total_loss: 0.78855  loss:1.0463,stance loss: 0.75228 
Train step: 1700 acc:0.79954 total_loss: 0.78952  loss:1.1869,stance loss: 1.6671 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.85625 total_loss: 0.73517  loss:1.2925,stance loss: 1.097 
Train step: 1720 acc:0.8375 total_loss: 0.73566  loss:0.69528,stance loss: 0.51997 
Train step: 1730 acc:0.84375 total_loss: 0.7002  loss:0.55926,stance loss: 0.4431 
Train step: 1740 acc:0.8375 total_loss: 0.69614  loss:0.68022,stance loss: 0.5089 
Train step: 1750 acc:0.84 total_loss: 0.70082  loss:0.50997,stance loss: 0.37011 
Train step: 1760 acc:0.83854 total_loss: 0.70833  loss:0.69955,stance loss: 0.50767 
Train step: 1770 acc:0.83661 total_loss: 0.71479  loss:0.82916,stance loss: 0.62245 
Train step: 1780 acc:0.83437 total_loss: 0.7198  loss:1.0997,stance loss: 1.4594 
Train step: 1790 acc:0.83472 total_loss: 0.70226  loss:0.6575,stance loss: 0.56103 
Train step: 1800 acc:0.83625 total_loss: 0.70118  loss:0.70986,stance loss: 0.6435 
Train step: 1810 acc:0.83807 total_loss: 0.69014  loss:0.35875,stance loss: 0.22358 
Train step: 1820 acc:0.84062 total_loss: 0.69628  loss:0.74917,stance loss: 1.0572 
Train step: 1830 acc:0.84279 total_loss: 0.69705  loss:0.71044,stance loss: 0.61369 
Train step: 1840 acc:0.84152 total_loss: 0.69575  loss:0.71982,stance loss: 0.65038 
Train step: 1850 acc:0.83958 total_loss: 0.69764  loss:0.53975,stance loss: 0.41285 
Train step: 1860 acc:0.84102 total_loss: 0.69158  loss:0.4654,stance loss: 0.35592 
Train step: 1870 acc:0.83934 total_loss: 0.69599  loss:0.68863,stance loss: 0.58531 
Train step: 1880 acc:0.83993 total_loss: 0.69246  loss:0.56912,stance loss: 0.52226 
Train step: 1890 acc:0.8375 total_loss: 0.69357  loss:0.94074,stance loss: 0.73754 
Train step: 1900 acc:0.83844 total_loss: 0.68985  loss:0.38752,stance loss: 0.26901 
Train step: 1910 acc:0.83958 total_loss: 0.68736  loss:0.47001,stance loss: 0.39167 
Train step: 1920 acc:0.84205 total_loss: 0.6819  loss:0.73539,stance loss: 0.63604 
Train step: 1930 acc:0.84511 total_loss: 0.67791  loss:0.30448,stance loss: 0.1904 
Train step: 1940 acc:0.84427 total_loss: 0.6807  loss:0.36952,stance loss: 0.23036 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.85714 total_loss: 0.67266  loss:0.92359,stance loss: 1.3096 
Train step: 1960 acc:0.87132 total_loss: 0.6181  loss:0.58766,stance loss: 0.45832 
Train step: 1970 acc:0.86343 total_loss: 0.63459  loss:0.86799,stance loss: 0.71677 
Train step: 1980 acc:0.8598 total_loss: 0.62518  loss:0.51617,stance loss: 0.37717 
Train step: 1990 acc:0.86968 total_loss: 0.61431  loss:0.28646,stance loss: 0.22345 
Train step: 2000 acc:0.8739 total_loss: 0.60165  loss:0.47297,stance loss: 0.46986 
Train step: 2010 acc:0.8694 total_loss: 0.60771  loss:0.22667,stance loss: 0.13642 
Train step: 2020 acc:0.87256 total_loss: 0.59632  loss:0.20431,stance loss: 0.12423 
Train step: 2030 acc:0.86638 total_loss: 0.60897  loss:0.53352,stance loss: 0.41914 
Train step: 2040 acc:0.86791 total_loss: 0.61015  loss:0.46291,stance loss: 0.39093 
Train step: 2050 acc:0.86624 total_loss: 0.6188  loss:0.55178,stance loss: 0.38741 
Train step: 2060 acc:0.86592 total_loss: 0.61226  loss:0.38053,stance loss: 0.27423 
Train step: 2070 acc:0.86516 total_loss: 0.60832  loss:0.65876,stance loss: 0.46159 
Train step: 2080 acc:0.86451 total_loss: 0.60944  loss:0.30948,stance loss: 0.21489 
Train step: 2090 acc:0.86437 total_loss: 0.60653  loss:0.39081,stance loss: 0.29953 
Train step: 2100 acc:0.86385 total_loss: 0.60569  loss:0.57002,stance loss: 0.29959 
Train step: 2110 acc:0.86078 total_loss: 0.61322  loss:0.96458,stance loss: 0.66308 
Train step: 2120 acc:0.86194 total_loss: 0.61413  loss:0.45012,stance loss: 0.3079 
Train step: 2130 acc:0.86197 total_loss: 0.61273  loss:0.78016,stance loss: 0.65594 
Train step: 2140 acc:0.86168 total_loss: 0.61211  loss:0.36176,stance loss: 0.29237 
Train step: 2150 acc:0.86262 total_loss: 0.6087  loss:0.44979,stance loss: 0.17567 
Train step: 2160 acc:0.86262 total_loss: 0.60491  loss:0.48927,stance loss: 0.27133 
Train step: 2170 acc:0.86233 total_loss: 0.60609  loss:0.54179,stance loss: 0.3831 
Train step: 2180 acc:0.86208 total_loss: 0.60421  loss:0.51165,stance loss: 0.46224 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.95312 total_loss: 0.27918  loss:0.22244,stance loss: 0.080288 
Train step: 2200 acc:0.86607 total_loss: 0.57289  loss:0.36947,stance loss: 0.32631 
Train step: 2210 acc:0.88021 total_loss: 0.5464  loss:0.88661,stance loss: 1.268 
Train step: 2220 acc:0.88051 total_loss: 0.52578  loss:0.69386,stance loss: 1.049 
Train step: 2230 acc:0.8892 total_loss: 0.51028  loss:0.92127,stance loss: 1.346 
Train step: 2240 acc:0.88542 total_loss: 0.53075  loss:0.46009,stance loss: 0.46303 
Train step: 2250 acc:0.88184 total_loss: 0.53718  loss:0.28296,stance loss: 0.17939 
Train step: 2260 acc:0.88429 total_loss: 0.54124  loss:1.0522,stance loss: 1.4282 
Train step: 2270 acc:0.88914 total_loss: 0.5299  loss:1.0835,stance loss: 1.4869 
Train step: 2280 acc:0.88497 total_loss: 0.54012  loss:1.2353,stance loss: 1.3274 
Train step: 2290 acc:0.88341 total_loss: 0.54142  loss:0.27744,stance loss: 0.17016 
Train step: 2300 acc:0.88213 total_loss: 0.54731  loss:0.80113,stance loss: 1.1028 
Train step: 2310 acc:0.88508 total_loss: 0.53699  loss:0.23808,stance loss: 0.12484 
Train step: 2320 acc:0.88666 total_loss: 0.53164  loss:0.32382,stance loss: 0.22581 
Train step: 2330 acc:0.88151 total_loss: 0.5491  loss:0.92223,stance loss: 0.60082 
Train step: 2340 acc:0.88271 total_loss: 0.54387  loss:0.47236,stance loss: 0.33384 
Train step: 2350 acc:0.88338 total_loss: 0.54134  loss:0.50218,stance loss: 0.43287 
Train step: 2360 acc:0.88326 total_loss: 0.53846  loss:0.44063,stance loss: 0.35721 
Train step: 2370 acc:0.88417 total_loss: 0.53899  loss:0.56486,stance loss: 0.58248 
Train step: 2380 acc:0.88563 total_loss: 0.53643  loss:0.8032,stance loss: 0.55773 
Train step: 2390 acc:0.8845 total_loss: 0.53249  loss:0.47841,stance loss: 0.43954 
Train step: 2400 acc:0.88464 total_loss: 0.53496  loss:0.91336,stance loss: 0.94143 
Train step: 2410 acc:0.88449 total_loss: 0.53553  loss:0.54085,stance loss: 0.50015 
Train step: 2420 acc:0.88435 total_loss: 0.53273  loss:0.38147,stance loss: 0.31415 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.57667  loss:0.57667,stance loss: 0.52143 
Train step: 2440 acc:0.91477 total_loss: 0.50058  loss:0.42923,stance loss: 0.4722 
Train step: 2450 acc:0.91369 total_loss: 0.41766  loss:0.51033,stance loss: 0.32546 
Train step: 2460 acc:0.90927 total_loss: 0.45505  loss:0.98958,stance loss: 0.99678 
Train step: 2470 acc:0.91159 total_loss: 0.44403  loss:0.28913,stance loss: 0.28499 
Train step: 2480 acc:0.91544 total_loss: 0.4473  loss:0.1383,stance loss: 0.099194 
Train step: 2490 acc:0.91189 total_loss: 0.44799  loss:0.2383,stance loss: 0.068367 
Train step: 2500 acc:0.91285 total_loss: 0.44393  loss:0.20033,stance loss: 0.14845 
Train step: 2510 acc:0.90818 total_loss: 0.4433  loss:0.43816,stance loss: 0.37858 
Train step: 2520 acc:0.90591 total_loss: 0.45267  loss:0.3292,stance loss: 0.29711 
Train step: 2530 acc:0.90656 total_loss: 0.44485  loss:0.54873,stance loss: 0.42793 
Train step: 2540 acc:0.90541 total_loss: 0.44496  loss:0.10422,stance loss: 0.059717 
Train step: 2550 acc:0.90651 total_loss: 0.44976  loss:0.049681,stance loss: 0.0038611 
Train step: 2560 acc:0.90458 total_loss: 0.44793  loss:0.45342,stance loss: 0.32077 
Train step: 2570 acc:0.90559 total_loss: 0.44742  loss:0.31331,stance loss: 0.37469 
Train step: 2580 acc:0.90439 total_loss: 0.44452  loss:0.45801,stance loss: 0.44345 
Train step: 2590 acc:0.90489 total_loss: 0.44444  loss:0.22361,stance loss: 0.1246 
Train step: 2600 acc:0.90497 total_loss: 0.44719  loss:0.30536,stance loss: 0.2701 
Train step: 2610 acc:0.90608 total_loss: 0.45143  loss:0.5627,stance loss: 0.38588 
Train step: 2620 acc:0.90609 total_loss: 0.45066  loss:0.18489,stance loss: 0.13893 
Train step: 2630 acc:0.90641 total_loss: 0.45353  loss:0.36594,stance loss: 0.33136 
Train step: 2640 acc:0.90551 total_loss: 0.45179  loss:0.34025,stance loss: 0.23654 
Train step: 2650 acc:0.90469 total_loss: 0.45863  loss:0.45702,stance loss: 0.49072 
Train step: 2660 acc:0.90341 total_loss: 0.46046  loss:0.2704,stance loss: 0.20328 
Train step: 2670 acc:0.90327 total_loss: 0.4669  loss:0.75384,stance loss: 1.219 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.89062 total_loss: 0.47948  loss:0.20716,stance loss: 0.12634 
Train step: 2690 acc:0.91319 total_loss: 0.36288  loss:0.4365,stance loss: 0.30964 
Train step: 2700 acc:0.92188 total_loss: 0.3499  loss:0.10443,stance loss: 0.039533 
Train step: 2710 acc:0.9227 total_loss: 0.36816  loss:1.1706,stance loss: 1.5275 
Train step: 2720 acc:0.92318 total_loss: 0.37558  loss:0.21624,stance loss: 0.040731 
Train step: 2730 acc:0.92134 total_loss: 0.37431  loss:0.74302,stance loss: 0.5341 
Train step: 2740 acc:0.92004 total_loss: 0.37365  loss:0.25887,stance loss: 0.21058 
Train step: 2750 acc:0.91587 total_loss: 0.39013  loss:0.77304,stance loss: 0.56144 
Train step: 2760 acc:0.91619 total_loss: 0.39383  loss:0.57641,stance loss: 0.40934 
Train step: 2770 acc:0.92092 total_loss: 0.38111  loss:0.22666,stance loss: 0.20322 
Train step: 2780 acc:0.91956 total_loss: 0.38039  loss:0.062375,stance loss: 0.0088654 
Train step: 2790 acc:0.92055 total_loss: 0.38371  loss:0.75028,stance loss: 1.0905 
Train step: 2800 acc:0.91797 total_loss: 0.39367  loss:0.16497,stance loss: 0.094747 
Train step: 2810 acc:0.91938 total_loss: 0.39641  loss:0.32216,stance loss: 0.24977 
Train step: 2820 acc:0.91512 total_loss: 0.41127  loss:0.66715,stance loss: 0.45831 
Train step: 2830 acc:0.91614 total_loss: 0.40986  loss:0.71998,stance loss: 1.0913 
Train step: 2840 acc:0.91853 total_loss: 0.40194  loss:0.24799,stance loss: 0.2449 
Train step: 2850 acc:0.91713 total_loss: 0.40503  loss:0.27698,stance loss: 0.23458 
Train step: 2860 acc:0.91722 total_loss: 0.41524  loss:1.1407,stance loss: 1.4978 
Train step: 2870 acc:0.91604 total_loss: 0.41699  loss:0.18267,stance loss: 0.1514 
Train step: 2880 acc:0.91526 total_loss: 0.41636  loss:0.36098,stance loss: 0.33476 
Train step: 2890 acc:0.9137 total_loss: 0.41633  loss:0.09882,stance loss: 0.029564 
Train step: 2900 acc:0.91447 total_loss: 0.40976  loss:0.2278,stance loss: 0.14672 
Train step: 2910 acc:0.91334 total_loss: 0.40903  loss:0.11465,stance loss: 0.030614 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.925 total_loss: 0.36944  loss:0.40479,stance loss: 0.29817 
Train step: 2930 acc:0.925 total_loss: 0.3033  loss:0.50296,stance loss: 0.37607 
Train step: 2940 acc:0.94 total_loss: 0.30562  loss:0.23163,stance loss: 0.18281 
Train step: 2950 acc:0.94821 total_loss: 0.2667  loss:0.59763,stance loss: 0.60767 
Train step: 2960 acc:0.95 total_loss: 0.28017  loss:0.43419,stance loss: 0.3408 
Train step: 2970 acc:0.94886 total_loss: 0.28463  loss:0.34586,stance loss: 0.30563 
Train step: 2980 acc:0.95288 total_loss: 0.27911  loss:0.12621,stance loss: 0.11005 
Train step: 2990 acc:0.9475 total_loss: 0.2975  loss:0.5573,stance loss: 0.44462 
Train step: 3000 acc:0.94926 total_loss: 0.30382  loss:0.077782,stance loss: 0.012664 
Train step: 3010 acc:0.94803 total_loss: 0.30819  loss:0.1406,stance loss: 0.039887 
Train step: 3020 acc:0.94702 total_loss: 0.30224  loss:0.27537,stance loss: 0.26499 
Train step: 3030 acc:0.94783 total_loss: 0.3042  loss:0.070416,stance loss: 0.020845 
Train step: 3040 acc:0.945 total_loss: 0.32253  loss:0.56656,stance loss: 0.42667 
Train step: 3050 acc:0.94537 total_loss: 0.32396  loss:0.48077,stance loss: 0.26234 
Train step: 3060 acc:0.94483 total_loss: 0.32741  loss:0.24948,stance loss: 0.070103 
Train step: 3070 acc:0.94476 total_loss: 0.3333  loss:0.25941,stance loss: 0.17405 
Train step: 3080 acc:0.94394 total_loss: 0.3391  loss:0.11786,stance loss: 0.064663 
Train step: 3090 acc:0.94536 total_loss: 0.33176  loss:0.12672,stance loss: 0.086591 
Train step: 3100 acc:0.94459 total_loss: 0.32843  loss:0.42205,stance loss: 0.47781 
Train step: 3110 acc:0.94551 total_loss: 0.32473  loss:0.084133,stance loss: 0.015333 
Train step: 3120 acc:0.94299 total_loss: 0.33459  loss:0.14744,stance loss: 0.12586 
Train step: 3130 acc:0.94302 total_loss: 0.33315  loss:0.13136,stance loss: 0.038276 
Train step: 3140 acc:0.94222 total_loss: 0.3331  loss:0.27099,stance loss: 0.15819 
Train step: 3150 acc:0.94122 total_loss: 0.3374  loss:0.41789,stance loss: 0.36466 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.11826  loss:0.20109,stance loss: 0.10201 
Train step: 3170 acc:0.98958 total_loss: 0.18232  loss:0.11994,stance loss: 0.053536 
Train step: 3180 acc:0.96307 total_loss: 0.30233  loss:0.88751,stance loss: 0.84255 
Train step: 3190 acc:0.95898 total_loss: 0.29159  loss:0.67494,stance loss: 1.1355 
Train step: 3200 acc:0.9628 total_loss: 0.27451  loss:0.045765,stance loss: 0.0079467 
Train step: 3210 acc:0.95913 total_loss: 0.28217  loss:0.43401,stance loss: 0.34283 
Train step: 3220 acc:0.95565 total_loss: 0.28584  loss:0.59835,stance loss: 0.32729 
Train step: 3230 acc:0.95399 total_loss: 0.30078  loss:0.0496,stance loss: 0.0090712 
Train step: 3240 acc:0.95351 total_loss: 0.29048  loss:0.064362,stance loss: 0.029585 
Train step: 3250 acc:0.95448 total_loss: 0.28664  loss:0.44357,stance loss: 0.3602 
Train step: 3260 acc:0.95404 total_loss: 0.28657  loss:0.39158,stance loss: 0.11849 
Train step: 3270 acc:0.95424 total_loss: 0.27945  loss:0.49735,stance loss: 0.49329 
Train step: 3280 acc:0.95543 total_loss: 0.27528  loss:0.12976,stance loss: 0.10807 
Train step: 3290 acc:0.95407 total_loss: 0.27673  loss:0.14849,stance loss: 0.14532 
Train step: 3300 acc:0.95423 total_loss: 0.28363  loss:0.26688,stance loss: 0.24698 
Train step: 3310 acc:0.95436 total_loss: 0.28647  loss:0.3509,stance loss: 0.32387 
Train step: 3320 acc:0.95486 total_loss: 0.28851  loss:0.044481,stance loss: 0.0036005 
Train step: 3330 acc:0.9564 total_loss: 0.28456  loss:0.04943,stance loss: 0.014137 
Train step: 3340 acc:0.95639 total_loss: 0.28241  loss:0.50714,stance loss: 0.38928 
Train step: 3350 acc:0.95378 total_loss: 0.28751  loss:0.38431,stance loss: 0.3202 
Train step: 3360 acc:0.95359 total_loss: 0.29058  loss:0.69101,stance loss: 0.58693 
Train step: 3370 acc:0.95312 total_loss: 0.29253  loss:0.089874,stance loss: 0.056617 
Train step: 3380 acc:0.95186 total_loss: 0.29782  loss:0.0411,stance loss: 0.017224 
Train step: 3390 acc:0.95232 total_loss: 0.29499  loss:0.45949,stance loss: 0.4251 
Train step: 3400 acc:0.95222 total_loss: 0.2925  loss:0.1376,stance loss: 0.050233 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.94444 total_loss: 0.34021  loss:0.85534,stance loss: 1.373 
Train step: 3420 acc:0.96711 total_loss: 0.29021  loss:0.079884,stance loss: 0.024609 
Train step: 3430 acc:0.96121 total_loss: 0.29197  loss:0.50401,stance loss: 0.42057 
Train step: 3440 acc:0.95353 total_loss: 0.29657  loss:0.36872,stance loss: 0.19669 
Train step: 3450 acc:0.95153 total_loss: 0.30515  loss:0.1578,stance loss: 0.13431 
Train step: 3460 acc:0.95021 total_loss: 0.31253  loss:0.60025,stance loss: 1.0537 
Train step: 3470 acc:0.95199 total_loss: 0.29148  loss:0.072324,stance loss: 0.046086 
Train step: 3480 acc:0.95174 total_loss: 0.2855  loss:0.314,stance loss: 0.37543 
Train step: 3490 acc:0.95084 total_loss: 0.28179  loss:0.23635,stance loss: 0.1244 
Train step: 3500 acc:0.95139 total_loss: 0.27251  loss:0.47961,stance loss: 0.34748 
Train step: 3510 acc:0.95126 total_loss: 0.28048  loss:0.659,stance loss: 1.1047 
Train step: 3520 acc:0.95431 total_loss: 0.2734  loss:0.074411,stance loss: 0.011781 
Train step: 3530 acc:0.95446 total_loss: 0.27037  loss:0.60683,stance loss: 0.35835 
Train step: 3540 acc:0.95369 total_loss: 0.27096  loss:0.035151,stance loss: 0.0071886 
Train step: 3550 acc:0.9526 total_loss: 0.28638  loss:0.05903,stance loss: 0.003674 
Better F1! Saving model!
Saving model of best f1: 0.5322096822096822
              precision    recall  f1-score   support

           0   0.657831  0.483186  0.557143       565
           1   0.557769  0.546875  0.552268       256
           2   0.383648  0.748466  0.507277       163

    accuracy                       0.543699       984
   macro avg   0.533083  0.592842  0.538896       984
weighted avg   0.586380  0.543699  0.547614       984

Test Acc: 0.5436991869918699 F1_ma:0.5322096822096822
Train step: 3560 acc:0.95322 total_loss: 0.28337  loss:0.038195,stance loss: 0.013523 
Train step: 3570 acc:0.95414 total_loss: 0.28709  loss:0.072326,stance loss: 0.019974 
Train step: 3580 acc:0.95566 total_loss: 0.28309  loss:0.098275,stance loss: 0.0099734 
Better F1! Saving model!
Saving model of best f1: 0.5478140260920203
              precision    recall  f1-score   support

           0   0.696172  0.515044  0.592065       565
           1   0.542208  0.652344  0.592199       256
           2   0.410853  0.650307  0.503563       163

    accuracy                       0.573171       984
   macro avg   0.549744  0.605898  0.562609       984
weighted avg   0.608853  0.573171  0.577439       984

Test Acc: 0.573170731707317 F1_ma:0.5478140260920203
Train step: 3590 acc:0.95602 total_loss: 0.28154  loss:0.10857,stance loss: 0.068536 
Train step: 3600 acc:0.95634 total_loss: 0.27498  loss:0.20377,stance loss: 0.14932 
Train step: 3610 acc:0.95724 total_loss: 0.27117  loss:0.13182,stance loss: 0.11501 
Train step: 3620 acc:0.95776 total_loss: 0.27019  loss:0.067042,stance loss: 0.047145 
Train step: 3630 acc:0.95742 total_loss: 0.27154  loss:0.53781,stance loss: 0.53846 
Train step: 3640 acc:0.95737 total_loss: 0.27263  loss:0.59184,stance loss: 1.0555 
Training finished.


Reload the best model with best f1 0.5478140260920203 from path test_outputs/bert-cross-topic/hc/2023-08-16 15-27-15/state_dict


              precision    recall  f1-score   support

           0   0.696172  0.515044  0.592065       565
           1   0.542208  0.652344  0.592199       256
           2   0.410853  0.650307  0.503563       163

    accuracy                       0.573171       984
   macro avg   0.549744  0.605898  0.562609       984
weighted avg   0.608853  0.573171  0.577439       984

Test Acc: 0.573170731707317 F1_ma:0.5478140260920203
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5478140260920203
acc: 0.573170731707317, f1 :0.5626088779147748
classification report: 
              precision    recall  f1-score   support

         Con     0.6962    0.5150    0.5921       565
        None     0.5422    0.6523    0.5922       256
         Pro     0.4109    0.6503    0.5036       163

    accuracy                         0.5732       984
   macro avg     0.5497    0.6059    0.5626       984
weighted avg     0.6089    0.5732    0.5774       984

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 15-47-46', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 15-47-46
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 1.9215  loss:1.9215,stance loss: 1.4229 
Train step: 10 acc:0.20455 total_loss: 1.8166  loss:1.6757,stance loss: 1.1864 
Better F1! Saving model!
Saving model of best f1: 0.2046556741028128
              precision    recall  f1-score   support

           0   0.452790  0.373451  0.409311       565
           1   0.054159  0.109375  0.072445       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.242886       984
   macro avg   0.168983  0.160942  0.160585       984
weighted avg   0.274076  0.242886  0.253869       984

Test Acc: 0.24288617886178862 F1_ma:0.2046556741028128
Train step: 20 acc:0.3244 total_loss: 1.7455  loss:1.5173,stance loss: 1.0288 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 30 acc:0.35484 total_loss: 1.7244  loss:1.7157,stance loss: 1.214 
Train step: 40 acc:0.37043 total_loss: 1.7138  loss:1.7226,stance loss: 1.2372 
Train step: 50 acc:0.38848 total_loss: 1.7051  loss:1.7111,stance loss: 1.2521 
Train step: 60 acc:0.41291 total_loss: 1.6868  loss:1.7751,stance loss: 1.2566 
Train step: 70 acc:0.41901 total_loss: 1.6824  loss:1.5351,stance loss: 1.0667 
Train step: 80 acc:0.42052 total_loss: 1.6827  loss:1.6813,stance loss: 1.0745 
Better F1! Saving model!
Saving model of best f1: 0.36498708010335923
              precision    recall  f1-score   support

           0   0.574771  1.000000  0.729974       565
           1   1.000000  0.003906  0.007782       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.575203       984
   macro avg   0.524924  0.334635  0.245919       984
weighted avg   0.590189  0.575203  0.421166       984

Test Acc: 0.5752032520325203 F1_ma:0.36498708010335923
Train step: 90 acc:0.43269 total_loss: 1.6729  loss:1.4991,stance loss: 1.1646 
Train step: 100 acc:0.44059 total_loss: 1.6756  loss:1.6363,stance loss: 1.0934 
Train step: 110 acc:0.44707 total_loss: 1.6683  loss:1.6465,stance loss: 1.1625 
Train step: 120 acc:0.45506 total_loss: 1.6601  loss:1.8788,stance loss: 1.2308 
Train step: 130 acc:0.45706 total_loss: 1.6596  loss:1.7015,stance loss: 1.1054 
Train step: 140 acc:0.46188 total_loss: 1.662  loss:1.7895,stance loss: 1.7293 
Train step: 150 acc:0.46606 total_loss: 1.6563  loss:1.2083,stance loss: 0.8787 
Train step: 160 acc:0.47593 total_loss: 1.6498  loss:1.6443,stance loss: 1.237 
Train step: 170 acc:0.48209 total_loss: 1.6392  loss:1.6611,stance loss: 1.2056 
Train step: 180 acc:0.48412 total_loss: 1.6365  loss:1.4879,stance loss: 1.0928 
Train step: 190 acc:0.48495 total_loss: 1.6359  loss:1.6694,stance loss: 1.2669 
Train step: 200 acc:0.49067 total_loss: 1.6308  loss:1.4369,stance loss: 1.1932 
Train step: 210 acc:0.49319 total_loss: 1.6283  loss:1.4728,stance loss: 1.0293 
Train step: 220 acc:0.49632 total_loss: 1.6261  loss:1.6343,stance loss: 1.2155 
Train step: 230 acc:0.49865 total_loss: 1.6233  loss:1.4509,stance loss: 1.0598 
Better F1! Saving model!
Saving model of best f1: 0.37272727272727274
              precision    recall  f1-score   support

           0   0.583696  0.950442  0.723232       565
           1   0.531915  0.097656  0.165017       256
           2   0.117647  0.012270  0.022222       163

    accuracy                       0.573171       984
   macro avg   0.411086  0.353456  0.303490       984
weighted avg   0.493023  0.573171  0.461883       984

Test Acc: 0.573170731707317 F1_ma:0.37272727272727274
Train step: 240 acc:0.50259 total_loss: 1.6196  loss:1.4416,stance loss: 0.96334 
Better F1! Saving model!
Saving model of best f1: 0.4097630315322343
              precision    recall  f1-score   support

           0   0.597387  0.890265  0.714996       565
           1   0.500000  0.035156  0.065693       256
           2   0.120968  0.092025  0.104530       163

    accuracy                       0.535569       984
   macro avg   0.406118  0.339149  0.295073       984
weighted avg   0.493132  0.535569  0.444948       984

Test Acc: 0.5355691056910569 F1_ma:0.4097630315322343
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.57812 total_loss: 1.5273  loss:1.5341,stance loss: 1.1029 
Train step: 260 acc:0.51736 total_loss: 1.5907  loss:1.8058,stance loss: 1.2236 
Train step: 270 acc:0.5558 total_loss: 1.5618  loss:1.6169,stance loss: 1.1431 
Train step: 280 acc:0.55757 total_loss: 1.5575  loss:1.4188,stance loss: 1.0251 
Train step: 290 acc:0.55078 total_loss: 1.5767  loss:1.9639,stance loss: 1.2953 
Train step: 300 acc:0.53664 total_loss: 1.5918  loss:1.6941,stance loss: 1.161 
Train step: 310 acc:0.53952 total_loss: 1.5793  loss:1.3116,stance loss: 0.88881 
Train step: 320 acc:0.54167 total_loss: 1.5765  loss:1.3519,stance loss: 0.95071 
Train step: 330 acc:0.54688 total_loss: 1.5682  loss:1.3907,stance loss: 0.99725 
Train step: 340 acc:0.54464 total_loss: 1.5705  loss:1.7836,stance loss: 1.0879 
Train step: 350 acc:0.54745 total_loss: 1.5717  loss:1.8596,stance loss: 1.7235 
Train step: 360 acc:0.54502 total_loss: 1.5696  loss:1.498,stance loss: 1.1359 
Train step: 370 acc:0.54248 total_loss: 1.5676  loss:1.5204,stance loss: 1.1676 
Train step: 380 acc:0.54574 total_loss: 1.5615  loss:1.4161,stance loss: 1.0417 
Train step: 390 acc:0.54434 total_loss: 1.5606  loss:1.1827,stance loss: 0.8698 
Train step: 400 acc:0.54747 total_loss: 1.5513  loss:1.3365,stance loss: 1.1293 
Train step: 410 acc:0.54613 total_loss: 1.5473  loss:1.3356,stance loss: 1.0568 
Train step: 420 acc:0.5474 total_loss: 1.544  loss:1.606,stance loss: 1.2107 
Train step: 430 acc:0.54854 total_loss: 1.5386  loss:1.4098,stance loss: 0.99767 
Train step: 440 acc:0.54703 total_loss: 1.539  loss:1.6466,stance loss: 1.2958 
Train step: 450 acc:0.54627 total_loss: 1.5392  loss:1.6535,stance loss: 1.2589 
Train step: 460 acc:0.54817 total_loss: 1.5357  loss:1.9424,stance loss: 1.32 
Train step: 470 acc:0.54962 total_loss: 1.5321  loss:1.5592,stance loss: 1.011 
Train step: 480 acc:0.54989 total_loss: 1.53  loss:1.5242,stance loss: 1.1199 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.5125 total_loss: 1.5774  loss:1.6,stance loss: 1.1929 
Train step: 500 acc:0.5375 total_loss: 1.5123  loss:1.6084,stance loss: 1.1819 
Train step: 510 acc:0.565 total_loss: 1.4938  loss:1.5019,stance loss: 1.3265 
Train step: 520 acc:0.56786 total_loss: 1.4759  loss:1.5372,stance loss: 1.1989 
Train step: 530 acc:0.57222 total_loss: 1.4594  loss:1.3508,stance loss: 1.2397 
Train step: 540 acc:0.58409 total_loss: 1.4324  loss:1.4105,stance loss: 1.1 
Train step: 550 acc:0.59327 total_loss: 1.4073  loss:0.86959,stance loss: 0.45014 
Train step: 560 acc:0.58417 total_loss: 1.4177  loss:1.6558,stance loss: 1.3291 
Train step: 570 acc:0.59044 total_loss: 1.4134  loss:1.4673,stance loss: 1.106 
Train step: 580 acc:0.58684 total_loss: 1.418  loss:1.2763,stance loss: 0.93767 
Train step: 590 acc:0.57976 total_loss: 1.4293  loss:1.3543,stance loss: 0.87801 
Train step: 600 acc:0.58152 total_loss: 1.434  loss:1.2484,stance loss: 0.99875 
Train step: 610 acc:0.583 total_loss: 1.4293  loss:1.456,stance loss: 1.1682 
Train step: 620 acc:0.58889 total_loss: 1.4176  loss:1.2162,stance loss: 0.937 
Train step: 630 acc:0.58966 total_loss: 1.4172  loss:1.4655,stance loss: 1.0142 
Train step: 640 acc:0.59073 total_loss: 1.4158  loss:1.3751,stance loss: 1.0924 
Train step: 650 acc:0.59053 total_loss: 1.4162  loss:1.2833,stance loss: 0.97864 
Train step: 660 acc:0.59357 total_loss: 1.4121  loss:1.4265,stance loss: 0.98444 
Train step: 670 acc:0.59426 total_loss: 1.4127  loss:1.5388,stance loss: 1.247 
Train step: 680 acc:0.59551 total_loss: 1.4168  loss:1.7061,stance loss: 1.6187 
Train step: 690 acc:0.59756 total_loss: 1.4162  loss:1.2448,stance loss: 0.93735 
Train step: 700 acc:0.59913 total_loss: 1.4153  loss:1.314,stance loss: 0.95311 
Train step: 710 acc:0.60222 total_loss: 1.4128  loss:0.96611,stance loss: 0.72753 
Train step: 720 acc:0.60452 total_loss: 1.4079  loss:1.5615,stance loss: 1.1421 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.5625 total_loss: 1.2871  loss:1.1717,stance loss: 0.81624 
Train step: 740 acc:0.63542 total_loss: 1.2624  loss:1.3893,stance loss: 1.3441 
Train step: 750 acc:0.66477 total_loss: 1.259  loss:1.2483,stance loss: 1.3205 
Train step: 760 acc:0.66016 total_loss: 1.2528  loss:1.2575,stance loss: 0.95474 
Train step: 770 acc:0.65327 total_loss: 1.2678  loss:1.0438,stance loss: 0.87341 
Train step: 780 acc:0.65505 total_loss: 1.2655  loss:1.4513,stance loss: 1.5129 
Train step: 790 acc:0.65121 total_loss: 1.2677  loss:1.3021,stance loss: 0.95724 
Train step: 800 acc:0.65104 total_loss: 1.266  loss:1.1088,stance loss: 0.79363 
Train step: 810 acc:0.65625 total_loss: 1.2489  loss:1.1494,stance loss: 0.81467 
Train step: 820 acc:0.65625 total_loss: 1.26  loss:1.787,stance loss: 1.778 
Train step: 830 acc:0.65319 total_loss: 1.2733  loss:1.4398,stance loss: 1.0821 
Train step: 840 acc:0.65458 total_loss: 1.2725  loss:1.0667,stance loss: 0.86449 
Train step: 850 acc:0.65984 total_loss: 1.2634  loss:1.1974,stance loss: 0.94736 
Train step: 860 acc:0.65814 total_loss: 1.2747  loss:0.98608,stance loss: 0.72859 
Train step: 870 acc:0.65757 total_loss: 1.2817  loss:0.93157,stance loss: 0.68726 
Train step: 880 acc:0.65625 total_loss: 1.2817  loss:1.3423,stance loss: 1.0995 
Train step: 890 acc:0.65972 total_loss: 1.2757  loss:0.7092,stance loss: 0.44795 
Train step: 900 acc:0.65552 total_loss: 1.2812  loss:1.2397,stance loss: 0.92591 
Train step: 910 acc:0.65282 total_loss: 1.2827  loss:0.98903,stance loss: 0.74224 
Train step: 920 acc:0.65072 total_loss: 1.2873  loss:1.3582,stance loss: 1.1263 
Better F1! Saving model!
Saving model of best f1: 0.4361665470208184
              precision    recall  f1-score   support

           0   0.672093  0.511504  0.580905       565
           1   0.542234  0.777344  0.638844       256
           2   0.272727  0.312883  0.291429       163

    accuracy                       0.547764       984
   macro avg   0.495685  0.533911  0.503726       984
weighted avg   0.572154  0.547764  0.548026       984

Test Acc: 0.5477642276422764 F1_ma:0.4361665470208184
Train step: 930 acc:0.65254 total_loss: 1.2862  loss:0.94729,stance loss: 0.73989 
Train step: 940 acc:0.64976 total_loss: 1.2905  loss:1.2672,stance loss: 1.1248 
Train step: 950 acc:0.64949 total_loss: 1.2843  loss:1.5035,stance loss: 1.0252 
Train step: 960 acc:0.65113 total_loss: 1.2783  loss:1.0734,stance loss: 0.76562 
Train step: 970 acc:0.65186 total_loss: 1.2784  loss:1.0924,stance loss: 0.85295 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.75694 total_loss: 1.2632  loss:1.0454,stance loss: 0.89582 
Train step: 990 acc:0.68092 total_loss: 1.317  loss:1.2975,stance loss: 1.0458 
Train step: 1000 acc:0.67457 total_loss: 1.2902  loss:1.2399,stance loss: 0.96695 
Better F1! Saving model!
Saving model of best f1: 0.45365897298264446
              precision    recall  f1-score   support

           0   0.699797  0.610619  0.652174       565
           1   0.535280  0.859375  0.659670       256
           2   0.387500  0.190184  0.255144       163

    accuracy                       0.605691       984
   macro avg   0.540859  0.553393  0.522329       984
weighted avg   0.605264  0.605691  0.588356       984

Test Acc: 0.6056910569105691 F1_ma:0.45365897298264446
Train step: 1010 acc:0.67949 total_loss: 1.2794  loss:0.8648,stance loss: 0.63663 
Train step: 1020 acc:0.67602 total_loss: 1.2639  loss:1.3745,stance loss: 1.2256 
Train step: 1030 acc:0.67585 total_loss: 1.2466  loss:1.2763,stance loss: 0.81199 
Train step: 1040 acc:0.67935 total_loss: 1.2199  loss:0.57692,stance loss: 0.29593 
Train step: 1050 acc:0.68434 total_loss: 1.1999  loss:1.0569,stance loss: 0.88828 
Train step: 1060 acc:0.68329 total_loss: 1.2025  loss:1.1736,stance loss: 1.1519 
Train step: 1070 acc:0.69066 total_loss: 1.1862  loss:1.4053,stance loss: 1.5378 
Train step: 1080 acc:0.69151 total_loss: 1.1798  loss:1.255,stance loss: 0.92703 
Train step: 1090 acc:0.69118 total_loss: 1.1734  loss:0.99072,stance loss: 0.73714 
Train step: 1100 acc:0.68992 total_loss: 1.1765  loss:1.0456,stance loss: 0.82778 
Train step: 1110 acc:0.69379 total_loss: 1.1594  loss:0.68326,stance loss: 0.42109 
Train step: 1120 acc:0.69002 total_loss: 1.1743  loss:1.7591,stance loss: 1.879 
Train step: 1130 acc:0.69182 total_loss: 1.1736  loss:0.83012,stance loss: 0.63117 
Train step: 1140 acc:0.69194 total_loss: 1.1735  loss:1.0918,stance loss: 1.2238 
Train step: 1150 acc:0.69099 total_loss: 1.1796  loss:1.6703,stance loss: 1.2543 
Train step: 1160 acc:0.69279 total_loss: 1.1754  loss:1.3322,stance loss: 0.97165 
Train step: 1170 acc:0.69001 total_loss: 1.1776  loss:0.6888,stance loss: 0.25533 
Train step: 1180 acc:0.69258 total_loss: 1.1734  loss:0.9346,stance loss: 0.76007 
Train step: 1190 acc:0.69235 total_loss: 1.1683  loss:1.3594,stance loss: 1.5888 
Train step: 1200 acc:0.68996 total_loss: 1.1708  loss:1.2661,stance loss: 0.96946 
Train step: 1210 acc:0.68828 total_loss: 1.1722  loss:1.027,stance loss: 0.73516 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.69792 total_loss: 0.9908  loss:0.91688,stance loss: 0.84133 
Train step: 1230 acc:0.73047 total_loss: 1.0187  loss:1.0322,stance loss: 0.80847 
Train step: 1240 acc:0.72115 total_loss: 1.0284  loss:1.3488,stance loss: 0.90983 
Train step: 1250 acc:0.72743 total_loss: 1.0462  loss:1.2775,stance loss: 1.0688 
Train step: 1260 acc:0.72962 total_loss: 1.0454  loss:1.2547,stance loss: 0.91978 
Train step: 1270 acc:0.72656 total_loss: 1.0434  loss:1.2858,stance loss: 1.0205 
Train step: 1280 acc:0.72443 total_loss: 1.049  loss:1.0068,stance loss: 0.71409 
Train step: 1290 acc:0.72615 total_loss: 1.0621  loss:1.4453,stance loss: 1.2504 
Better F1! Saving model!
Saving model of best f1: 0.4598223809726988
              precision    recall  f1-score   support

           0   0.669604  0.538053  0.596663       565
           1   0.525606  0.761719  0.622010       256
           2   0.327044  0.319018  0.322981       163

    accuracy                       0.559959       984
   macro avg   0.507418  0.539597  0.513885       984
weighted avg   0.575396  0.559959  0.557922       984

Test Acc: 0.5599593495934959 F1_ma:0.4598223809726988
Train step: 1300 acc:0.72238 total_loss: 1.07  loss:1.0568,stance loss: 1.3846 
Train step: 1310 acc:0.7194 total_loss: 1.0704  loss:0.90977,stance loss: 0.59874 
Train step: 1320 acc:0.72583 total_loss: 1.0628  loss:1.326,stance loss: 0.91833 
Train step: 1330 acc:0.72144 total_loss: 1.0703  loss:1.2711,stance loss: 1.2048 
Train step: 1340 acc:0.72073 total_loss: 1.0635  loss:0.95695,stance loss: 0.79816 
Train step: 1350 acc:0.71737 total_loss: 1.0663  loss:1.5333,stance loss: 1.1135 
Train step: 1360 acc:0.72089 total_loss: 1.0586  loss:0.94947,stance loss: 0.77776 
Train step: 1370 acc:0.71835 total_loss: 1.0596  loss:1.0824,stance loss: 0.92379 
Train step: 1380 acc:0.71762 total_loss: 1.0635  loss:0.90493,stance loss: 0.67782 
Train step: 1390 acc:0.71768 total_loss: 1.065  loss:0.82853,stance loss: 0.68573 
Better F1! Saving model!
Saving model of best f1: 0.4692814462999847
              precision    recall  f1-score   support

           0   0.685930  0.483186  0.566978       565
           1   0.524804  0.785156  0.629108       256
           2   0.334975  0.417178  0.371585       163

    accuracy                       0.550813       984
   macro avg   0.515236  0.561840  0.522557       984
weighted avg   0.585875  0.550813  0.550775       984

Test Acc: 0.5508130081300813 F1_ma:0.4692814462999847
Train step: 1400 acc:0.71472 total_loss: 1.0739  loss:1.1249,stance loss: 0.82235 
Train step: 1410 acc:0.71429 total_loss: 1.079  loss:1.9079,stance loss: 1.8446 
Train step: 1420 acc:0.71511 total_loss: 1.0767  loss:1.2272,stance loss: 0.97542 
Train step: 1430 acc:0.71557 total_loss: 1.0738  loss:1.4346,stance loss: 1.3388 
Train step: 1440 acc:0.71681 total_loss: 1.0694  loss:1.1311,stance loss: 1.1044 
Train step: 1450 acc:0.71796 total_loss: 1.0641  loss:0.75846,stance loss: 0.46482 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.8125 total_loss: 1.0123  loss:0.86102,stance loss: 0.72157 
Train step: 1470 acc:0.76442 total_loss: 0.99936  loss:1.1625,stance loss: 0.93992 
Train step: 1480 acc:0.74728 total_loss: 0.97586  loss:0.71164,stance loss: 0.48493 
Train step: 1490 acc:0.74053 total_loss: 0.97888  loss:0.78923,stance loss: 0.6293 
Better F1! Saving model!
Saving model of best f1: 0.47671333776578406
              precision    recall  f1-score   support

           0   0.730366  0.493805  0.589229       565
           1   0.530612  0.914062  0.671449       256
           2   0.366460  0.361963  0.364198       163

    accuracy                       0.581301       984
   macro avg   0.542479  0.589944  0.541625       984
weighted avg   0.618117  0.581301  0.573343       984

Test Acc: 0.5813008130081301 F1_ma:0.47671333776578406
Train step: 1500 acc:0.74128 total_loss: 0.97302  loss:1.1249,stance loss: 0.9087 
Train step: 1510 acc:0.74292 total_loss: 0.99092  loss:0.93341,stance loss: 0.82648 
Train step: 1520 acc:0.74405 total_loss: 0.99469  loss:0.83486,stance loss: 0.63851 
Train step: 1530 acc:0.73973 total_loss: 1.0027  loss:0.56969,stance loss: 0.43106 
Train step: 1540 acc:0.75 total_loss: 0.98842  loss:0.74953,stance loss: 0.6218 
Train step: 1550 acc:0.75134 total_loss: 0.98362  loss:0.80285,stance loss: 0.56541 
Train step: 1560 acc:0.74939 total_loss: 0.98255  loss:0.97953,stance loss: 0.59069 
Train step: 1570 acc:0.74945 total_loss: 0.98263  loss:0.92044,stance loss: 0.71687 
Better F1! Saving model!
Saving model of best f1: 0.4771469489683562
              precision    recall  f1-score   support

           0   0.724221  0.534513  0.615071       565
           1   0.519016  0.906250  0.660028       256
           2   0.400000  0.294479  0.339223       163

    accuracy                       0.591463       984
   macro avg   0.547745  0.578414  0.538107       984
weighted avg   0.617127  0.591463  0.581073       984

Test Acc: 0.5914634146341463 F1_ma:0.4771469489683562
Train step: 1580 acc:0.74543 total_loss: 0.99086  loss:0.826,stance loss: 0.67132 
Train step: 1590 acc:0.74248 total_loss: 0.99422  loss:1.1313,stance loss: 0.92116 
Train step: 1600 acc:0.74388 total_loss: 0.99589  loss:0.89671,stance loss: 1.1598 
Train step: 1610 acc:0.7406 total_loss: 0.99891  loss:0.99148,stance loss: 0.81604 
Train step: 1620 acc:0.73926 total_loss: 0.99562  loss:0.69583,stance loss: 0.4579 
Better F1! Saving model!
Saving model of best f1: 0.4985462784728907
              precision    recall  f1-score   support

           0   0.704641  0.591150  0.642926       565
           1   0.537662  0.808594  0.645866       256
           2   0.408000  0.312883  0.354167       163

    accuracy                       0.601626       984
   macro avg   0.550101  0.570876  0.547653       984
weighted avg   0.612061  0.601626  0.595858       984

Test Acc: 0.6016260162601627 F1_ma:0.4985462784728907
Train step: 1630 acc:0.73808 total_loss: 0.98975  loss:0.94597,stance loss: 0.72048 
Train step: 1640 acc:0.73702 total_loss: 0.98837  loss:0.79844,stance loss: 0.5866 
Train step: 1650 acc:0.73964 total_loss: 0.9888  loss:0.98484,stance loss: 1.338 
Train step: 1660 acc:0.73861 total_loss: 0.98915  loss:1.0954,stance loss: 0.96586 
Train step: 1670 acc:0.74061 total_loss: 0.98287  loss:0.9166,stance loss: 0.75636 
Train step: 1680 acc:0.74159 total_loss: 0.9818  loss:0.84604,stance loss: 0.71985 
Train step: 1690 acc:0.74249 total_loss: 0.97563  loss:0.68975,stance loss: 0.4648 
Train step: 1700 acc:0.74267 total_loss: 0.97927  loss:0.99725,stance loss: 0.84826 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.75 total_loss: 0.90047  loss:0.78096,stance loss: 0.61502 
Train step: 1720 acc:0.8 total_loss: 0.79938  loss:0.71541,stance loss: 0.68922 
Train step: 1730 acc:0.82083 total_loss: 0.77725  loss:0.9246,stance loss: 0.74204 
Train step: 1740 acc:0.82812 total_loss: 0.74135  loss:0.5276,stance loss: 0.26991 
Train step: 1750 acc:0.8175 total_loss: 0.761  loss:0.99226,stance loss: 0.84811 
Train step: 1760 acc:0.81146 total_loss: 0.78676  loss:1.3198,stance loss: 1.5305 
Train step: 1770 acc:0.80089 total_loss: 0.82118  loss:0.9087,stance loss: 0.71123 
Train step: 1780 acc:0.80156 total_loss: 0.83577  loss:1.1006,stance loss: 1.4566 
Train step: 1790 acc:0.79653 total_loss: 0.84385  loss:1.0752,stance loss: 0.87021 
Train step: 1800 acc:0.7975 total_loss: 0.83715  loss:0.53743,stance loss: 0.42807 
Train step: 1810 acc:0.79716 total_loss: 0.83789  loss:0.45519,stance loss: 0.26926 
Train step: 1820 acc:0.79427 total_loss: 0.84513  loss:0.72042,stance loss: 0.64125 
Train step: 1830 acc:0.79327 total_loss: 0.84956  loss:1.0308,stance loss: 0.87463 
Train step: 1840 acc:0.78884 total_loss: 0.85998  loss:0.91012,stance loss: 0.81664 
Train step: 1850 acc:0.7925 total_loss: 0.85145  loss:0.90947,stance loss: 1.1071 
Train step: 1860 acc:0.7918 total_loss: 0.85057  loss:1.0373,stance loss: 0.7852 
Train step: 1870 acc:0.79632 total_loss: 0.83851  loss:1.1192,stance loss: 1.1797 
Train step: 1880 acc:0.79792 total_loss: 0.83705  loss:0.34899,stance loss: 0.19092 
Train step: 1890 acc:0.79474 total_loss: 0.84546  loss:1.2367,stance loss: 0.90772 
Train step: 1900 acc:0.79281 total_loss: 0.85006  loss:0.58857,stance loss: 0.49668 
Train step: 1910 acc:0.79345 total_loss: 0.85133  loss:1.1757,stance loss: 1.0413 
Train step: 1920 acc:0.79034 total_loss: 0.85372  loss:0.69951,stance loss: 0.52927 
Train step: 1930 acc:0.79022 total_loss: 0.86217  loss:0.61313,stance loss: 0.48886 
Train step: 1940 acc:0.78802 total_loss: 0.8667  loss:1.2446,stance loss: 0.88005 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.83036 total_loss: 0.69366  loss:0.85536,stance loss: 0.69126 
Train step: 1960 acc:0.79779 total_loss: 0.72122  loss:0.75603,stance loss: 0.5318 
Better F1! Saving model!
Saving model of best f1: 0.502420968387355
              precision    recall  f1-score   support

           0   0.677108  0.497345  0.573469       565
           1   0.540123  0.683594  0.603448       256
           2   0.359184  0.539877  0.431373       163

    accuracy                       0.552846       984
   macro avg   0.525472  0.573605  0.536097       984
weighted avg   0.588806  0.552846  0.557730       984

Test Acc: 0.5528455284552846 F1_ma:0.502420968387355
Train step: 1970 acc:0.7963 total_loss: 0.76749  loss:1.0999,stance loss: 0.69312 
Train step: 1980 acc:0.79899 total_loss: 0.75727  loss:0.79551,stance loss: 0.51414 
Train step: 1990 acc:0.80319 total_loss: 0.74765  loss:0.79854,stance loss: 0.68256 
Train step: 2000 acc:0.81031 total_loss: 0.73686  loss:0.63363,stance loss: 0.49173 
Train step: 2010 acc:0.81437 total_loss: 0.74098  loss:1.1001,stance loss: 1.4117 
Train step: 2020 acc:0.81494 total_loss: 0.73814  loss:0.38364,stance loss: 0.30256 
Train step: 2030 acc:0.8125 total_loss: 0.75072  loss:0.62625,stance loss: 0.62202 
Train step: 2040 acc:0.80863 total_loss: 0.76436  loss:0.6895,stance loss: 0.58406 
Train step: 2050 acc:0.809 total_loss: 0.7644  loss:0.6986,stance loss: 0.55446 
Train step: 2060 acc:0.80769 total_loss: 0.7782  loss:1.5241,stance loss: 1.729 
Train step: 2070 acc:0.81152 total_loss: 0.76949  loss:0.56096,stance loss: 0.48417 
Train step: 2080 acc:0.81432 total_loss: 0.76427  loss:0.76185,stance loss: 0.78694 
Train step: 2090 acc:0.81335 total_loss: 0.77345  loss:1.3283,stance loss: 1.1164 
Train step: 2100 acc:0.81489 total_loss: 0.76841  loss:0.90865,stance loss: 0.49139 
Train step: 2110 acc:0.81138 total_loss: 0.77433  loss:0.78652,stance loss: 0.56523 
Train step: 2120 acc:0.80897 total_loss: 0.77196  loss:0.89148,stance loss: 0.84027 
Train step: 2130 acc:0.81116 total_loss: 0.7646  loss:0.91119,stance loss: 0.60949 
Train step: 2140 acc:0.81218 total_loss: 0.7637  loss:1.0315,stance loss: 0.82299 
Train step: 2150 acc:0.81159 total_loss: 0.76172  loss:0.6757,stance loss: 0.58957 
Train step: 2160 acc:0.81164 total_loss: 0.76118  loss:0.65633,stance loss: 0.48342 
Train step: 2170 acc:0.8103 total_loss: 0.76024  loss:0.79394,stance loss: 0.69859 
Train step: 2180 acc:0.81118 total_loss: 0.75691  loss:0.77556,stance loss: 0.62065 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.875 total_loss: 0.71136  loss:0.96962,stance loss: 1.2194 
Train step: 2200 acc:0.85714 total_loss: 0.59083  loss:0.34071,stance loss: 0.2374 
Train step: 2210 acc:0.85156 total_loss: 0.63297  loss:0.80822,stance loss: 0.61194 
Train step: 2220 acc:0.85294 total_loss: 0.64363  loss:0.35213,stance loss: 0.26835 
Train step: 2230 acc:0.86222 total_loss: 0.61571  loss:0.32643,stance loss: 0.19002 
Train step: 2240 acc:0.86111 total_loss: 0.64225  loss:0.58151,stance loss: 0.44067 
Train step: 2250 acc:0.8623 total_loss: 0.62162  loss:0.59905,stance loss: 0.57527 
Train step: 2260 acc:0.85895 total_loss: 0.62038  loss:0.96365,stance loss: 0.662 
Train step: 2270 acc:0.85863 total_loss: 0.63516  loss:1.047,stance loss: 0.68356 
Train step: 2280 acc:0.85771 total_loss: 0.64506  loss:0.5082,stance loss: 0.43833 
Train step: 2290 acc:0.85877 total_loss: 0.65589  loss:0.82899,stance loss: 1.1208 
Train step: 2300 acc:0.85691 total_loss: 0.65631  loss:0.63472,stance loss: 0.4692 
Train step: 2310 acc:0.85685 total_loss: 0.65461  loss:0.54499,stance loss: 0.37953 
Train step: 2320 acc:0.85494 total_loss: 0.66159  loss:0.98532,stance loss: 1.0088 
Train step: 2330 acc:0.85634 total_loss: 0.66095  loss:0.81453,stance loss: 1.0764 
Train step: 2340 acc:0.85795 total_loss: 0.66145  loss:1.0017,stance loss: 1.084 
Train step: 2350 acc:0.86014 total_loss: 0.65273  loss:0.47248,stance loss: 0.32531 
Train step: 2360 acc:0.8592 total_loss: 0.65487  loss:1.1749,stance loss: 1.4535 
Train step: 2370 acc:0.85938 total_loss: 0.65531  loss:0.89147,stance loss: 0.7741 
Train step: 2380 acc:0.85793 total_loss: 0.65677  loss:1.0864,stance loss: 0.96307 
Train step: 2390 acc:0.85876 total_loss: 0.65382  loss:0.39608,stance loss: 0.26179 
Train step: 2400 acc:0.85981 total_loss: 0.65184  loss:0.18679,stance loss: 0.035971 
Train step: 2410 acc:0.85826 total_loss: 0.6547  loss:0.38829,stance loss: 0.30606 
Train step: 2420 acc:0.85844 total_loss: 0.6537  loss:0.54514,stance loss: 0.54874 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.34797  loss:0.34797,stance loss: 0.25471 
Train step: 2440 acc:0.91477 total_loss: 0.5463  loss:0.34835,stance loss: 0.20523 
Train step: 2450 acc:0.92262 total_loss: 0.51062  loss:0.32787,stance loss: 0.20732 
Train step: 2460 acc:0.91129 total_loss: 0.51245  loss:0.54276,stance loss: 0.43918 
Train step: 2470 acc:0.91768 total_loss: 0.48746  loss:0.22268,stance loss: 0.098836 
Train step: 2480 acc:0.91544 total_loss: 0.4876  loss:0.45422,stance loss: 0.3756 
Train step: 2490 acc:0.91598 total_loss: 0.46578  loss:0.20072,stance loss: 0.1226 
Train step: 2500 acc:0.91197 total_loss: 0.47172  loss:0.54137,stance loss: 0.41897 
Train step: 2510 acc:0.90741 total_loss: 0.48265  loss:0.38072,stance loss: 0.25864 
Train step: 2520 acc:0.90797 total_loss: 0.48342  loss:0.5609,stance loss: 0.4019 
Train step: 2530 acc:0.90347 total_loss: 0.50532  loss:0.26131,stance loss: 0.15689 
Train step: 2540 acc:0.89977 total_loss: 0.5042  loss:0.79685,stance loss: 0.6492 
Train step: 2550 acc:0.89773 total_loss: 0.51118  loss:0.22869,stance loss: 0.096296 
Train step: 2560 acc:0.89838 total_loss: 0.50098  loss:0.61481,stance loss: 0.36255 
Train step: 2570 acc:0.89628 total_loss: 0.5091  loss:0.53952,stance loss: 0.5274 
Train step: 2580 acc:0.89652 total_loss: 0.51055  loss:0.65563,stance loss: 0.55405 
Train step: 2590 acc:0.89286 total_loss: 0.52086  loss:1.1295,stance loss: 0.91175 
Train step: 2600 acc:0.89474 total_loss: 0.51215  loss:0.29223,stance loss: 0.21149 
Train step: 2610 acc:0.89434 total_loss: 0.51521  loss:0.86739,stance loss: 0.75359 
Train step: 2620 acc:0.89103 total_loss: 0.52489  loss:1.0441,stance loss: 0.81983 
Train step: 2630 acc:0.89086 total_loss: 0.52301  loss:0.37449,stance loss: 0.2035 
Train step: 2640 acc:0.88892 total_loss: 0.52485  loss:0.7312,stance loss: 0.59869 
Train step: 2650 acc:0.88603 total_loss: 0.53063  loss:0.25701,stance loss: 0.0035757 
Train step: 2660 acc:0.8842 total_loss: 0.53691  loss:0.4749,stance loss: 0.378 
Train step: 2670 acc:0.88278 total_loss: 0.54023  loss:1.0473,stance loss: 0.77788 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.9375 total_loss: 0.27027  loss:0.14783,stance loss: 0.083367 
Train step: 2690 acc:0.90972 total_loss: 0.39043  loss:0.48275,stance loss: 0.46765 
Train step: 2700 acc:0.91518 total_loss: 0.41295  loss:0.32965,stance loss: 0.36666 
Train step: 2710 acc:0.91447 total_loss: 0.42457  loss:1.447,stance loss: 0.94303 
Train step: 2720 acc:0.91536 total_loss: 0.41864  loss:1.0099,stance loss: 1.3267 
Train step: 2730 acc:0.91918 total_loss: 0.41546  loss:0.62432,stance loss: 0.56699 
Train step: 2740 acc:0.91268 total_loss: 0.44317  loss:0.79138,stance loss: 0.82942 
Train step: 2750 acc:0.91506 total_loss: 0.44857  loss:0.53661,stance loss: 0.42681 
Train step: 2760 acc:0.91477 total_loss: 0.44526  loss:0.1617,stance loss: 0.093515 
Train step: 2770 acc:0.9139 total_loss: 0.45131  loss:0.29923,stance loss: 0.26641 
Train step: 2780 acc:0.91262 total_loss: 0.4534  loss:0.12077,stance loss: 0.08341 
Train step: 2790 acc:0.91102 total_loss: 0.45305  loss:0.19205,stance loss: 0.16178 
Better F1! Saving model!
Saving model of best f1: 0.5104794156274082
              precision    recall  f1-score   support

           0   0.668058  0.566372  0.613027       565
           1   0.530159  0.652344  0.584939       256
           2   0.378947  0.441718  0.407932       163

    accuracy                       0.568089       984
   macro avg   0.525722  0.553478  0.535299       984
weighted avg   0.584291  0.568089  0.571745       984

Test Acc: 0.568089430894309 F1_ma:0.5104794156274082
Train step: 2800 acc:0.91016 total_loss: 0.45284  loss:0.32893,stance loss: 0.23922 
Train step: 2810 acc:0.91078 total_loss: 0.44685  loss:0.25974,stance loss: 0.17807 
Train step: 2820 acc:0.91047 total_loss: 0.44896  loss:0.11646,stance loss: 0.053514 
Train step: 2830 acc:0.90981 total_loss: 0.4581  loss:0.36181,stance loss: 0.33496 
Train step: 2840 acc:0.90625 total_loss: 0.47108  loss:0.8961,stance loss: 0.71151 
Train step: 2850 acc:0.9059 total_loss: 0.47183  loss:0.33364,stance loss: 0.22372 
Train step: 2860 acc:0.90791 total_loss: 0.46355  loss:0.39871,stance loss: 0.44319 
Train step: 2870 acc:0.90783 total_loss: 0.46726  loss:0.75776,stance loss: 0.57213 
Train step: 2880 acc:0.90715 total_loss: 0.46659  loss:0.59451,stance loss: 0.60293 
Train step: 2890 acc:0.90854 total_loss: 0.46616  loss:0.63384,stance loss: 1.0419 
Train step: 2900 acc:0.90899 total_loss: 0.47045  loss:0.14679,stance loss: 0.090259 
Train step: 2910 acc:0.90914 total_loss: 0.46704  loss:0.20301,stance loss: 0.075172 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.8875 total_loss: 0.59947  loss:0.38357,stance loss: 0.18507 
Train step: 2930 acc:0.925 total_loss: 0.41567  loss:0.31696,stance loss: 0.25064 
Train step: 2940 acc:0.935 total_loss: 0.3993  loss:0.53876,stance loss: 0.50758 
Train step: 2950 acc:0.92857 total_loss: 0.39035  loss:0.22947,stance loss: 0.12219 
Train step: 2960 acc:0.92361 total_loss: 0.39659  loss:1.0627,stance loss: 1.5447 
Train step: 2970 acc:0.92273 total_loss: 0.40243  loss:0.11151,stance loss: 0.072614 
Train step: 2980 acc:0.92308 total_loss: 0.39653  loss:0.30852,stance loss: 0.22912 
Train step: 2990 acc:0.92417 total_loss: 0.39716  loss:0.19402,stance loss: 0.11513 
Train step: 3000 acc:0.92279 total_loss: 0.42204  loss:0.61281,stance loss: 0.56974 
Train step: 3010 acc:0.92632 total_loss: 0.40941  loss:0.76216,stance loss: 1.1984 
Train step: 3020 acc:0.92679 total_loss: 0.40964  loss:0.2064,stance loss: 0.059048 
Train step: 3030 acc:0.9288 total_loss: 0.39478  loss:0.26644,stance loss: 0.16343 
Train step: 3040 acc:0.928 total_loss: 0.39114  loss:0.31091,stance loss: 0.16978 
Train step: 3050 acc:0.92778 total_loss: 0.39155  loss:0.065204,stance loss: 0.030161 
Train step: 3060 acc:0.92802 total_loss: 0.39319  loss:0.31976,stance loss: 0.32325 
Train step: 3070 acc:0.92782 total_loss: 0.38751  loss:0.29099,stance loss: 0.24936 
Train step: 3080 acc:0.92576 total_loss: 0.39709  loss:0.19746,stance loss: 0.13879 
Train step: 3090 acc:0.92393 total_loss: 0.40357  loss:0.17922,stance loss: 0.10125 
Train step: 3100 acc:0.925 total_loss: 0.39943  loss:0.3976,stance loss: 0.37365 
Train step: 3110 acc:0.92564 total_loss: 0.39323  loss:0.66274,stance loss: 0.60522 
Train step: 3120 acc:0.92683 total_loss: 0.38947  loss:0.59746,stance loss: 0.56033 
Train step: 3130 acc:0.92587 total_loss: 0.39418  loss:0.39366,stance loss: 0.31214 
Train step: 3140 acc:0.9275 total_loss: 0.38651  loss:0.43657,stance loss: 0.29821 
Train step: 3150 acc:0.92739 total_loss: 0.38434  loss:0.33698,stance loss: 0.13783 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.34913  loss:0.069674,stance loss: 0.018682 
Train step: 3170 acc:0.95833 total_loss: 0.28074  loss:0.07352,stance loss: 0.021015 
Train step: 3180 acc:0.96023 total_loss: 0.31738  loss:0.89108,stance loss: 1.3376 
Train step: 3190 acc:0.95117 total_loss: 0.33451  loss:0.18055,stance loss: 0.10478 
Train step: 3200 acc:0.95833 total_loss: 0.29851  loss:0.094662,stance loss: 0.030204 
Train step: 3210 acc:0.95553 total_loss: 0.31611  loss:0.088353,stance loss: 0.1038 
Train step: 3220 acc:0.95161 total_loss: 0.32614  loss:0.54545,stance loss: 1.0081 
Train step: 3230 acc:0.94792 total_loss: 0.33669  loss:0.37956,stance loss: 0.27762 
Train step: 3240 acc:0.94893 total_loss: 0.34145  loss:0.61948,stance loss: 0.54901 
Train step: 3250 acc:0.94905 total_loss: 0.32587  loss:0.27951,stance loss: 0.33344 
Train step: 3260 acc:0.94608 total_loss: 0.33644  loss:0.77805,stance loss: 0.66885 
Train step: 3270 acc:0.94587 total_loss: 0.32911  loss:0.048707,stance loss: 0.012097 
Train step: 3280 acc:0.94621 total_loss: 0.3292  loss:0.62491,stance loss: 0.50571 
Train step: 3290 acc:0.94697 total_loss: 0.32618  loss:0.06406,stance loss: 0.028399 
Train step: 3300 acc:0.94674 total_loss: 0.32367  loss:0.081106,stance loss: 0.039679 
Train step: 3310 acc:0.94655 total_loss: 0.32503  loss:0.36345,stance loss: 0.42773 
Train step: 3320 acc:0.94637 total_loss: 0.32401  loss:0.66533,stance loss: 1.0182 
Train step: 3330 acc:0.94658 total_loss: 0.32407  loss:0.52415,stance loss: 0.42517 
Train step: 3340 acc:0.94643 total_loss: 0.32493  loss:0.3596,stance loss: 0.32409 
Train step: 3350 acc:0.94629 total_loss: 0.32566  loss:0.21709,stance loss: 0.16551 
Train step: 3360 acc:0.94493 total_loss: 0.3296  loss:0.16279,stance loss: 0.10283 
Train step: 3370 acc:0.94517 total_loss: 0.32655  loss:0.20118,stance loss: 0.085923 
Train step: 3380 acc:0.9451 total_loss: 0.32459  loss:0.73773,stance loss: 1.1764 
Train step: 3390 acc:0.94531 total_loss: 0.32188  loss:0.059273,stance loss: 0.011386 
Train step: 3400 acc:0.94447 total_loss: 0.32128  loss:0.31732,stance loss: 0.34557 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.94444 total_loss: 0.23374  loss:0.085739,stance loss: 0.0061895 
Train step: 3420 acc:0.96382 total_loss: 0.19569  loss:0.093403,stance loss: 0.018038 
Train step: 3430 acc:0.95905 total_loss: 0.21098  loss:0.79805,stance loss: 0.78875 
Train step: 3440 acc:0.95513 total_loss: 0.24023  loss:0.42755,stance loss: 0.29409 
Train step: 3450 acc:0.94898 total_loss: 0.26345  loss:0.96236,stance loss: 0.84504 
Train step: 3460 acc:0.95127 total_loss: 0.25841  loss:0.18096,stance loss: 0.20037 
Train step: 3470 acc:0.95471 total_loss: 0.26343  loss:0.073282,stance loss: 0.02059 
Train step: 3480 acc:0.9557 total_loss: 0.2676  loss:0.047198,stance loss: 0.01311 
Train step: 3490 acc:0.95506 total_loss: 0.26636  loss:0.083921,stance loss: 0.036539 
Train step: 3500 acc:0.95139 total_loss: 0.27332  loss:0.18671,stance loss: 0.090481 
Train step: 3510 acc:0.95069 total_loss: 0.27144  loss:0.22164,stance loss: 0.158 
Train step: 3520 acc:0.95011 total_loss: 0.26939  loss:0.16717,stance loss: 0.1042 
Train step: 3530 acc:0.95252 total_loss: 0.26335  loss:0.041676,stance loss: 0.014474 
Train step: 3540 acc:0.95414 total_loss: 0.2538  loss:0.2556,stance loss: 0.29294 
Train step: 3550 acc:0.95386 total_loss: 0.26497  loss:0.47642,stance loss: 0.43433 
Train step: 3560 acc:0.95362 total_loss: 0.26447  loss:0.029418,stance loss: 0.00304 
Train step: 3570 acc:0.9534 total_loss: 0.26734  loss:0.074364,stance loss: 0.022243 
Train step: 3580 acc:0.95391 total_loss: 0.26775  loss:0.57198,stance loss: 1.0178 
Train step: 3590 acc:0.95503 total_loss: 0.26248  loss:0.029968,stance loss: 0.002749 
Train step: 3600 acc:0.95509 total_loss: 0.26221  loss:0.099705,stance loss: 0.033469 
Train step: 3610 acc:0.95544 total_loss: 0.25732  loss:0.053682,stance loss: 0.010673 
Train step: 3620 acc:0.95576 total_loss: 0.25972  loss:0.41437,stance loss: 0.365 
Train step: 3630 acc:0.95415 total_loss: 0.26592  loss:0.67672,stance loss: 0.62962 
Train step: 3640 acc:0.95319 total_loss: 0.27077  loss:0.90486,stance loss: 1.2408 
Training finished.


Reload the best model with best f1 0.5104794156274082 from path test_outputs/bert-cross-topic/hc/2023-08-16 15-47-46/state_dict


              precision    recall  f1-score   support

           0   0.668058  0.566372  0.613027       565
           1   0.530159  0.652344  0.584939       256
           2   0.378947  0.441718  0.407932       163

    accuracy                       0.568089       984
   macro avg   0.525722  0.553478  0.535299       984
weighted avg   0.584291  0.568089  0.571745       984

Test Acc: 0.568089430894309 F1_ma:0.5104794156274082
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5104794156274082
acc: 0.568089430894309, f1 :0.5352991784276125
classification report: 
              precision    recall  f1-score   support

         Con     0.6681    0.5664    0.6130       565
        None     0.5302    0.6523    0.5849       256
         Pro     0.3789    0.4417    0.4079       163

    accuracy                         0.5681       984
   macro avg     0.5257    0.5535    0.5353       984
weighted avg     0.5843    0.5681    0.5717       984

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 16-08-20', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 16-08-20
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.744  loss:1.744,stance loss: 1.2547 
Train step: 10 acc:0.24432 total_loss: 1.8416  loss:1.7966,stance loss: 1.1713 
Train step: 20 acc:0.29167 total_loss: 1.7931  loss:1.7369,stance loss: 1.2389 
Better F1! Saving model!
Saving model of best f1: 0.2847222222222222
              precision    recall  f1-score   support

           0   0.504788  0.653097  0.569444       565
           1   0.019763  0.019531  0.019646       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.380081       984
   macro avg   0.174850  0.224210  0.196364       984
weighted avg   0.294984  0.380081  0.332079       984

Test Acc: 0.3800813008130081 F1_ma:0.2847222222222222
Train step: 30 acc:0.3629 total_loss: 1.7475  loss:1.4876,stance loss: 1.0468 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 40 acc:0.40549 total_loss: 1.7043  loss:1.34,stance loss: 0.93575 
Train step: 50 acc:0.42647 total_loss: 1.6941  loss:1.9191,stance loss: 1.2663 
Train step: 60 acc:0.43648 total_loss: 1.6867  loss:1.6204,stance loss: 1.1795 
Train step: 70 acc:0.43838 total_loss: 1.6832  loss:1.6499,stance loss: 1.1377 
Train step: 80 acc:0.44676 total_loss: 1.6771  loss:1.6834,stance loss: 1.1268 
Train step: 90 acc:0.45192 total_loss: 1.6703  loss:1.5985,stance loss: 1.1625 
Train step: 100 acc:0.4573 total_loss: 1.6661  loss:1.5749,stance loss: 1.1278 
Train step: 110 acc:0.4589 total_loss: 1.6649  loss:1.6432,stance loss: 1.2435 
Train step: 120 acc:0.46333 total_loss: 1.6653  loss:1.6202,stance loss: 1.1803 
Train step: 130 acc:0.46708 total_loss: 1.6609  loss:1.9215,stance loss: 1.7134 
Train step: 140 acc:0.47163 total_loss: 1.6554  loss:1.6495,stance loss: 1.1928 
Train step: 150 acc:0.47558 total_loss: 1.6498  loss:1.4741,stance loss: 1.0692 
Train step: 160 acc:0.47981 total_loss: 1.6486  loss:1.6962,stance loss: 1.2284 
Train step: 170 acc:0.48026 total_loss: 1.6482  loss:1.6106,stance loss: 1.1427 
Train step: 180 acc:0.48101 total_loss: 1.6445  loss:1.7123,stance loss: 1.1209 
Better F1! Saving model!
Saving model of best f1: 0.3651208360548661
              precision    recall  f1-score   support

           0   0.578675  0.989381  0.730242       565
           1   0.555556  0.039062  0.072993       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.578252       984
   macro avg   0.378077  0.342814  0.267745       984
weighted avg   0.476802  0.578252  0.438285       984

Test Acc: 0.5782520325203252 F1_ma:0.3651208360548661
Train step: 190 acc:0.48298 total_loss: 1.6414  loss:1.5683,stance loss: 1.2365 
Train step: 200 acc:0.48445 total_loss: 1.6405  loss:1.3876,stance loss: 1.0124 
Train step: 210 acc:0.48845 total_loss: 1.636  loss:1.7313,stance loss: 1.1327 
Train step: 220 acc:0.4901 total_loss: 1.6324  loss:1.4674,stance loss: 0.97214 
Better F1! Saving model!
Saving model of best f1: 0.378291840296328
              precision    recall  f1-score   support

           0   0.588950  0.943363  0.725170       565
           1   0.588235  0.117188  0.195440       256
           2   0.107143  0.018405  0.031414       163

    accuracy                       0.575203       984
   macro avg   0.428109  0.359652  0.317341       984
weighted avg   0.508953  0.575203  0.472433       984

Test Acc: 0.5752032520325203 F1_ma:0.378291840296328
Train step: 230 acc:0.49297 total_loss: 1.6319  loss:1.4207,stance loss: 1.0032 
Train step: 240 acc:0.49637 total_loss: 1.6262  loss:1.52,stance loss: 0.98401 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.55469 total_loss: 1.5241  loss:1.7541,stance loss: 1.2662 
Train step: 260 acc:0.5625 total_loss: 1.5384  loss:1.1594,stance loss: 0.83475 
Train step: 270 acc:0.56473 total_loss: 1.5379  loss:1.6353,stance loss: 1.07 
Train step: 280 acc:0.55263 total_loss: 1.5563  loss:1.6536,stance loss: 1.1538 
Train step: 290 acc:0.53385 total_loss: 1.5715  loss:1.361,stance loss: 0.8852 
Better F1! Saving model!
Saving model of best f1: 0.3896131805157593
              precision    recall  f1-score   support

           0   0.712676  0.447788  0.550000       565
           1   0.487585  0.843750  0.618026       256
           2   0.215054  0.245399  0.229226       163

    accuracy                       0.517276       984
   macro avg   0.471771  0.512312  0.465751       984
weighted avg   0.571684  0.517276  0.514561       984

Test Acc: 0.5172764227642277 F1_ma:0.3896131805157593
Train step: 300 acc:0.53556 total_loss: 1.5675  loss:1.1619,stance loss: 0.7341 
Train step: 310 acc:0.54136 total_loss: 1.5614  loss:1.5119,stance loss: 1.151 
Train step: 320 acc:0.54167 total_loss: 1.5623  loss:1.7302,stance loss: 1.2041 
Train step: 330 acc:0.54332 total_loss: 1.5632  loss:1.6486,stance loss: 1.1344 
Train step: 340 acc:0.54273 total_loss: 1.5632  loss:1.6407,stance loss: 1.2429 
Train step: 350 acc:0.54745 total_loss: 1.5614  loss:1.3999,stance loss: 1.1098 
Train step: 360 acc:0.54608 total_loss: 1.5594  loss:1.3856,stance loss: 0.86857 
Train step: 370 acc:0.54248 total_loss: 1.5627  loss:1.5767,stance loss: 1.142 
Train step: 380 acc:0.54212 total_loss: 1.5597  loss:1.4428,stance loss: 1.0416 
Train step: 390 acc:0.54223 total_loss: 1.5596  loss:1.6791,stance loss: 1.2325 
Train step: 400 acc:0.54272 total_loss: 1.5585  loss:1.5105,stance loss: 1.1532 
Train step: 410 acc:0.54576 total_loss: 1.5539  loss:1.5551,stance loss: 1.2632 
Train step: 420 acc:0.54846 total_loss: 1.5484  loss:1.7604,stance loss: 1.3759 
Train step: 430 acc:0.5512 total_loss: 1.5439  loss:1.4434,stance loss: 1.0868 
Train step: 440 acc:0.55335 total_loss: 1.5428  loss:1.7404,stance loss: 1.1765 
Train step: 450 acc:0.55288 total_loss: 1.5419  loss:1.5222,stance loss: 1.1571 
Train step: 460 acc:0.55218 total_loss: 1.5395  loss:1.5154,stance loss: 1.1157 
Train step: 470 acc:0.54989 total_loss: 1.5389  loss:1.3243,stance loss: 0.89333 
Train step: 480 acc:0.55252 total_loss: 1.5363  loss:1.3879,stance loss: 0.91193 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.5125 total_loss: 1.4889  loss:1.7341,stance loss: 0.92095 
Train step: 500 acc:0.54167 total_loss: 1.5273  loss:1.6289,stance loss: 1.2371 
Train step: 510 acc:0.5625 total_loss: 1.4967  loss:1.252,stance loss: 0.96971 
Train step: 520 acc:0.59464 total_loss: 1.4568  loss:1.216,stance loss: 0.89502 
Train step: 530 acc:0.58611 total_loss: 1.4577  loss:1.6497,stance loss: 1.1878 
Train step: 540 acc:0.57727 total_loss: 1.4612  loss:1.6745,stance loss: 1.2271 
Train step: 550 acc:0.57788 total_loss: 1.4544  loss:1.5227,stance loss: 1.2145 
Train step: 560 acc:0.58583 total_loss: 1.4505  loss:1.3824,stance loss: 0.9704 
Train step: 570 acc:0.57941 total_loss: 1.4494  loss:1.3286,stance loss: 1.0481 
Train step: 580 acc:0.58289 total_loss: 1.453  loss:1.1987,stance loss: 0.92702 
Train step: 590 acc:0.58929 total_loss: 1.4507  loss:1.4088,stance loss: 1.1243 
Train step: 600 acc:0.58804 total_loss: 1.4593  loss:1.5211,stance loss: 1.2375 
Train step: 610 acc:0.59 total_loss: 1.4555  loss:1.2133,stance loss: 0.902 
Train step: 620 acc:0.58796 total_loss: 1.457  loss:1.3503,stance loss: 0.9576 
Train step: 630 acc:0.59181 total_loss: 1.4467  loss:1.2195,stance loss: 1.0045 
Train step: 640 acc:0.58911 total_loss: 1.4486  loss:1.4281,stance loss: 1.1332 
Train step: 650 acc:0.59053 total_loss: 1.4432  loss:1.5858,stance loss: 1.1801 
Train step: 660 acc:0.59464 total_loss: 1.4364  loss:1.4342,stance loss: 1.128 
Train step: 670 acc:0.59493 total_loss: 1.4325  loss:1.3944,stance loss: 1.0163 
Train step: 680 acc:0.59487 total_loss: 1.4305  loss:1.5211,stance loss: 1.1802 
Train step: 690 acc:0.5939 total_loss: 1.4351  loss:1.4185,stance loss: 1.0336 
Train step: 700 acc:0.59448 total_loss: 1.4327  loss:0.91018,stance loss: 0.68471 
Train step: 710 acc:0.595 total_loss: 1.4314  loss:1.5507,stance loss: 1.1195 
Train step: 720 acc:0.59601 total_loss: 1.4302  loss:1.3007,stance loss: 1.05 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.71875 total_loss: 1.1663  loss:1.2674,stance loss: 0.98774 
Train step: 740 acc:0.70312 total_loss: 1.2126  loss:1.3166,stance loss: 0.80439 
Train step: 750 acc:0.69886 total_loss: 1.2518  loss:1.0278,stance loss: 0.60215 
Better F1! Saving model!
Saving model of best f1: 0.4180505599346956
              precision    recall  f1-score   support

           0   0.679764  0.612389  0.644320       565
           1   0.515513  0.843750  0.640000       256
           2   0.375000  0.128834  0.191781       163

    accuracy                       0.592480       984
   macro avg   0.523426  0.528325  0.492034       984
weighted avg   0.586548  0.592480  0.568233       984

Test Acc: 0.592479674796748 F1_ma:0.4180505599346956
Train step: 760 acc:0.6875 total_loss: 1.2596  loss:0.87006,stance loss: 0.47459 
Train step: 770 acc:0.67857 total_loss: 1.2591  loss:1.2302,stance loss: 0.93011 
Train step: 780 acc:0.67067 total_loss: 1.2666  loss:1.3854,stance loss: 1.1602 
Train step: 790 acc:0.66734 total_loss: 1.2859  loss:1.4012,stance loss: 1.1275 
Train step: 800 acc:0.65625 total_loss: 1.289  loss:1.2213,stance loss: 0.87635 
Train step: 810 acc:0.66006 total_loss: 1.2827  loss:1.4943,stance loss: 1.0232 
Train step: 820 acc:0.65693 total_loss: 1.2867  loss:0.97768,stance loss: 0.71844 
Train step: 830 acc:0.65625 total_loss: 1.2839  loss:1.6407,stance loss: 1.2462 
Train step: 840 acc:0.65737 total_loss: 1.2753  loss:1.1123,stance loss: 0.89183 
Better F1! Saving model!
Saving model of best f1: 0.42130286230015473
              precision    recall  f1-score   support

           0   0.744361  0.350442  0.476534       565
           1   0.528868  0.894531  0.664731       256
           2   0.287719  0.503067  0.366071       163

    accuracy                       0.517276       984
   macro avg   0.520316  0.582680  0.502446       984
weighted avg   0.612655  0.517276  0.507198       984

Test Acc: 0.5172764227642277 F1_ma:0.42130286230015473
Train step: 850 acc:0.65266 total_loss: 1.2857  loss:1.5158,stance loss: 1.0646 
Better F1! Saving model!
Saving model of best f1: 0.4342516753536858
              precision    recall  f1-score   support

           0   0.713514  0.467257  0.564706       565
           1   0.514100  0.925781  0.661088       256
           2   0.313725  0.294479  0.303797       163

    accuracy                       0.557927       984
   macro avg   0.513780  0.562505  0.509864       984
weighted avg   0.595408  0.557927  0.546561       984

Test Acc: 0.5579268292682927 F1_ma:0.4342516753536858
Train step: 860 acc:0.65483 total_loss: 1.2817  loss:1.5765,stance loss: 1.1608 
Train step: 870 acc:0.65449 total_loss: 1.2827  loss:0.91149,stance loss: 0.6291 
Train step: 880 acc:0.65214 total_loss: 1.2843  loss:1.399,stance loss: 0.9831 
Train step: 890 acc:0.64853 total_loss: 1.2935  loss:1.603,stance loss: 1.7232 
Train step: 900 acc:0.64971 total_loss: 1.2956  loss:1.8002,stance loss: 1.8058 
Train step: 910 acc:0.64938 total_loss: 1.2927  loss:1.3771,stance loss: 1.1498 
Train step: 920 acc:0.65104 total_loss: 1.2894  loss:0.99116,stance loss: 0.71563 
Train step: 930 acc:0.6513 total_loss: 1.2878  loss:1.2993,stance loss: 1.2917 
Train step: 940 acc:0.65094 total_loss: 1.2937  loss:1.0333,stance loss: 0.7274 
Train step: 950 acc:0.64921 total_loss: 1.2961  loss:1.353,stance loss: 1.1301 
Train step: 960 acc:0.64844 total_loss: 1.2969  loss:1.2588,stance loss: 0.90302 
Better F1! Saving model!
Saving model of best f1: 0.4396313364055299
              precision    recall  f1-score   support

           0   0.686469  0.368142  0.479263       565
           1   0.533835  0.832031  0.650382       256
           2   0.315603  0.546012  0.400000       163

    accuracy                       0.518293       984
   macro avg   0.511969  0.582062  0.509881       984
weighted avg   0.585325  0.518293  0.510652       984

Test Acc: 0.5182926829268293 F1_ma:0.4396313364055299
Train step: 970 acc:0.64799 total_loss: 1.2964  loss:1.6569,stance loss: 1.4347 
Better F1! Saving model!
Saving model of best f1: 0.48311199510403924
              precision    recall  f1-score   support

           0   0.664706  0.600000  0.630698       565
           1   0.540541  0.703125  0.611205       256
           2   0.361702  0.312883  0.335526       163

    accuracy                       0.579268       984
   macro avg   0.522316  0.538669  0.525810       984
weighted avg   0.582210  0.579268  0.576731       984

Test Acc: 0.5792682926829268 F1_ma:0.48311199510403924
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.70139 total_loss: 1.2332  loss:1.0247,stance loss: 0.74006 
Train step: 990 acc:0.69079 total_loss: 1.2513  loss:1.2699,stance loss: 1.4588 
Train step: 1000 acc:0.67241 total_loss: 1.2561  loss:1.4262,stance loss: 1.0353 
Train step: 1010 acc:0.68109 total_loss: 1.2289  loss:1.5698,stance loss: 1.6802 
Train step: 1020 acc:0.66582 total_loss: 1.2453  loss:1.4773,stance loss: 1.0193 
Train step: 1030 acc:0.67055 total_loss: 1.2263  loss:1.5952,stance loss: 1.3785 
Train step: 1040 acc:0.67301 total_loss: 1.2306  loss:1.1887,stance loss: 1.0825 
Train step: 1050 acc:0.67089 total_loss: 1.2192  loss:0.99429,stance loss: 0.89406 
Train step: 1060 acc:0.66924 total_loss: 1.2187  loss:0.87711,stance loss: 0.64223 
Train step: 1070 acc:0.67109 total_loss: 1.2217  loss:1.2092,stance loss: 0.87515 
Train step: 1080 acc:0.66227 total_loss: 1.2377  loss:1.3025,stance loss: 0.96686 
Train step: 1090 acc:0.66492 total_loss: 1.2284  loss:1.4153,stance loss: 1.0205 
Train step: 1100 acc:0.66182 total_loss: 1.2238  loss:1.2012,stance loss: 0.82831 
Train step: 1110 acc:0.66457 total_loss: 1.2133  loss:0.92354,stance loss: 0.83072 
Train step: 1120 acc:0.66443 total_loss: 1.2093  loss:0.84556,stance loss: 0.62186 
Train step: 1130 acc:0.66785 total_loss: 1.2041  loss:1.2308,stance loss: 1.1113 
Train step: 1140 acc:0.67049 total_loss: 1.2031  loss:1.3279,stance loss: 1.1768 
Train step: 1150 acc:0.66934 total_loss: 1.207  loss:1.473,stance loss: 1.1998 
Train step: 1160 acc:0.66997 total_loss: 1.2039  loss:1.0048,stance loss: 0.76325 
Train step: 1170 acc:0.67117 total_loss: 1.1981  loss:0.85153,stance loss: 0.52444 
Better F1! Saving model!
Saving model of best f1: 0.504276048026048
              precision    recall  f1-score   support

           0   0.632432  0.621239  0.626786       565
           1   0.547718  0.515625  0.531187       256
           2   0.356383  0.411043  0.381766       163

    accuracy                       0.558943       984
   macro avg   0.512178  0.515969  0.513246       984
weighted avg   0.564665  0.558943  0.561327       984

Test Acc: 0.5589430894308943 F1_ma:0.504276048026048
Train step: 1180 acc:0.67344 total_loss: 1.1927  loss:0.98672,stance loss: 0.78316 
Train step: 1190 acc:0.67409 total_loss: 1.19  loss:1.0951,stance loss: 0.7908 
Train step: 1200 acc:0.67576 total_loss: 1.1878  loss:1.0085,stance loss: 0.61839 
Train step: 1210 acc:0.67364 total_loss: 1.1866  loss:1.5711,stance loss: 1.1912 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.69792 total_loss: 1.1992  loss:1.2366,stance loss: 1.3022 
Train step: 1230 acc:0.72656 total_loss: 1.0775  loss:0.79627,stance loss: 0.65557 
Train step: 1240 acc:0.68029 total_loss: 1.1364  loss:1.4011,stance loss: 1.3171 
Train step: 1250 acc:0.69097 total_loss: 1.1231  loss:0.82884,stance loss: 0.52714 
Train step: 1260 acc:0.70652 total_loss: 1.1218  loss:1.0298,stance loss: 1.4373 
Train step: 1270 acc:0.70201 total_loss: 1.1181  loss:1.004,stance loss: 0.70882 
Train step: 1280 acc:0.70265 total_loss: 1.1178  loss:0.73631,stance loss: 0.49206 
Train step: 1290 acc:0.70477 total_loss: 1.1098  loss:1.0971,stance loss: 0.90546 
Train step: 1300 acc:0.70567 total_loss: 1.1022  loss:1.4138,stance loss: 1.0475 
Train step: 1310 acc:0.70638 total_loss: 1.1004  loss:1.0128,stance loss: 0.83497 
Train step: 1320 acc:0.70519 total_loss: 1.104  loss:1.0098,stance loss: 0.88447 
Train step: 1330 acc:0.70474 total_loss: 1.0999  loss:1.1915,stance loss: 0.78638 
Train step: 1340 acc:0.70883 total_loss: 1.0942  loss:1.0898,stance loss: 0.98223 
Train step: 1350 acc:0.70404 total_loss: 1.1017  loss:1.3345,stance loss: 1.0766 
Train step: 1360 acc:0.70762 total_loss: 1.0915  loss:1.0788,stance loss: 0.73468 
Train step: 1370 acc:0.70513 total_loss: 1.0909  loss:1.1556,stance loss: 0.79365 
Train step: 1380 acc:0.71273 total_loss: 1.0741  loss:0.54714,stance loss: 0.28035 
Train step: 1390 acc:0.71129 total_loss: 1.0755  loss:0.52146,stance loss: 0.29083 
Train step: 1400 acc:0.71001 total_loss: 1.0779  loss:1.5076,stance loss: 1.2009 
Train step: 1410 acc:0.71269 total_loss: 1.0779  loss:0.87461,stance loss: 0.67159 
Train step: 1420 acc:0.71238 total_loss: 1.0794  loss:1.0176,stance loss: 0.83912 
Train step: 1430 acc:0.71094 total_loss: 1.0821  loss:1.0212,stance loss: 0.68163 
Train step: 1440 acc:0.71101 total_loss: 1.0868  loss:1.2846,stance loss: 1.5128 
Train step: 1450 acc:0.71107 total_loss: 1.088  loss:1.0785,stance loss: 0.93398 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.625 total_loss: 1.387  loss:1.5553,stance loss: 1.5939 
Train step: 1470 acc:0.71154 total_loss: 1.0731  loss:0.97923,stance loss: 0.77686 
Train step: 1480 acc:0.72011 total_loss: 1.0449  loss:1.0155,stance loss: 0.8722 
Train step: 1490 acc:0.71591 total_loss: 1.0673  loss:0.50821,stance loss: 0.34634 
Train step: 1500 acc:0.71948 total_loss: 1.0519  loss:0.81157,stance loss: 0.6946 
Train step: 1510 acc:0.70991 total_loss: 1.0553  loss:0.60031,stance loss: 0.48365 
Train step: 1520 acc:0.7252 total_loss: 1.0305  loss:1.2534,stance loss: 1.3826 
Train step: 1530 acc:0.72774 total_loss: 1.0289  loss:1.2738,stance loss: 0.98801 
Train step: 1540 acc:0.7244 total_loss: 1.0355  loss:1.1431,stance loss: 1.0068 
Train step: 1550 acc:0.72513 total_loss: 1.0377  loss:0.83925,stance loss: 0.72888 
Train step: 1560 acc:0.72573 total_loss: 1.0401  loss:1.312,stance loss: 1.0255 
Train step: 1570 acc:0.72622 total_loss: 1.0363  loss:1.1274,stance loss: 0.93988 
Train step: 1580 acc:0.72663 total_loss: 1.0396  loss:0.86402,stance loss: 0.67352 
Train step: 1590 acc:0.7265 total_loss: 1.033  loss:0.87428,stance loss: 0.68329 
Train step: 1600 acc:0.72771 total_loss: 1.032  loss:1.5879,stance loss: 1.7632 
Train step: 1610 acc:0.72835 total_loss: 1.0274  loss:1.3223,stance loss: 1.1136 
Train step: 1620 acc:0.73236 total_loss: 1.0216  loss:0.91315,stance loss: 0.79751 
Train step: 1630 acc:0.73519 total_loss: 1.0154  loss:0.90644,stance loss: 0.6459 
Train step: 1640 acc:0.73531 total_loss: 1.0153  loss:0.96559,stance loss: 0.71482 
Train step: 1650 acc:0.73608 total_loss: 1.0125  loss:1.4593,stance loss: 1.3532 
Train step: 1660 acc:0.73307 total_loss: 1.0205  loss:0.6849,stance loss: 0.54896 
Train step: 1670 acc:0.73357 total_loss: 1.0218  loss:1.1052,stance loss: 0.96781 
Train step: 1680 acc:0.73543 total_loss: 1.0201  loss:1.3195,stance loss: 1.0868 
Train step: 1690 acc:0.73525 total_loss: 1.0235  loss:1.4388,stance loss: 1.68 
Train step: 1700 acc:0.73649 total_loss: 1.023  loss:1.0438,stance loss: 0.8833 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.8375 total_loss: 0.74073  loss:0.77458,stance loss: 0.717 
Train step: 1720 acc:0.82188 total_loss: 0.75786  loss:0.49766,stance loss: 0.43611 
Train step: 1730 acc:0.80208 total_loss: 0.80727  loss:0.92228,stance loss: 0.735 
Train step: 1740 acc:0.79375 total_loss: 0.84951  loss:0.85298,stance loss: 0.59568 
Train step: 1750 acc:0.79125 total_loss: 0.86633  loss:1.0422,stance loss: 0.74256 
Train step: 1760 acc:0.79271 total_loss: 0.85536  loss:0.58981,stance loss: 0.46805 
Train step: 1770 acc:0.78839 total_loss: 0.86033  loss:0.81151,stance loss: 0.56658 
Train step: 1780 acc:0.78828 total_loss: 0.86597  loss:0.8504,stance loss: 0.65399 
Better F1! Saving model!
Saving model of best f1: 0.5201532230517738
              precision    recall  f1-score   support

           0   0.702461  0.555752  0.620553       565
           1   0.526596  0.773438  0.626582       256
           2   0.422360  0.417178  0.419753       163

    accuracy                       0.589431       984
   macro avg   0.550472  0.582123  0.555630       984
weighted avg   0.610309  0.589431  0.588859       984

Test Acc: 0.5894308943089431 F1_ma:0.5201532230517738
Train step: 1790 acc:0.7875 total_loss: 0.86515  loss:0.98202,stance loss: 0.71597 
Train step: 1800 acc:0.78563 total_loss: 0.86693  loss:0.96892,stance loss: 0.74879 
Train step: 1810 acc:0.77557 total_loss: 0.88736  loss:0.6988,stance loss: 0.53961 
Train step: 1820 acc:0.77344 total_loss: 0.88506  loss:0.60392,stance loss: 0.42524 
Train step: 1830 acc:0.76635 total_loss: 0.89361  loss:0.82967,stance loss: 0.66485 
Train step: 1840 acc:0.7692 total_loss: 0.89619  loss:0.6895,stance loss: 0.60218 
Train step: 1850 acc:0.76792 total_loss: 0.89428  loss:0.94807,stance loss: 0.85063 
Train step: 1860 acc:0.76523 total_loss: 0.90129  loss:0.55357,stance loss: 0.21403 
Train step: 1870 acc:0.76765 total_loss: 0.9012  loss:0.89501,stance loss: 0.79358 
Train step: 1880 acc:0.76979 total_loss: 0.89527  loss:0.572,stance loss: 0.35431 
Train step: 1890 acc:0.77039 total_loss: 0.89622  loss:0.74093,stance loss: 0.65235 
Train step: 1900 acc:0.76656 total_loss: 0.90115  loss:0.98139,stance loss: 0.70929 
Train step: 1910 acc:0.76399 total_loss: 0.90027  loss:0.79325,stance loss: 0.67577 
Train step: 1920 acc:0.76477 total_loss: 0.903  loss:0.65689,stance loss: 0.50634 
Train step: 1930 acc:0.7644 total_loss: 0.90614  loss:0.93579,stance loss: 0.69731 
Train step: 1940 acc:0.76615 total_loss: 0.90743  loss:0.99341,stance loss: 0.76324 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.76786 total_loss: 0.77799  loss:0.61537,stance loss: 0.3744 
Train step: 1960 acc:0.77206 total_loss: 0.81748  loss:0.59809,stance loss: 0.42365 
Train step: 1970 acc:0.78472 total_loss: 0.79063  loss:0.8343,stance loss: 0.86383 
Train step: 1980 acc:0.7973 total_loss: 0.7668  loss:0.61329,stance loss: 0.53953 
Train step: 1990 acc:0.79787 total_loss: 0.7761  loss:0.9338,stance loss: 0.6475 
Train step: 2000 acc:0.79496 total_loss: 0.78143  loss:0.60126,stance loss: 0.53966 
Train step: 2010 acc:0.79291 total_loss: 0.79826  loss:0.85314,stance loss: 0.67609 
Train step: 2020 acc:0.7987 total_loss: 0.78953  loss:0.98891,stance loss: 1.1173 
Train step: 2030 acc:0.79454 total_loss: 0.79022  loss:0.86716,stance loss: 0.65946 
Train step: 2040 acc:0.79059 total_loss: 0.80628  loss:0.90252,stance loss: 0.68882 
Train step: 2050 acc:0.79556 total_loss: 0.7905  loss:0.48543,stance loss: 0.41965 
Train step: 2060 acc:0.79487 total_loss: 0.8022  loss:0.42448,stance loss: 0.29637 
Train step: 2070 acc:0.79774 total_loss: 0.79711  loss:0.93068,stance loss: 0.6307 
Train step: 2080 acc:0.80338 total_loss: 0.78283  loss:0.35068,stance loss: 0.18489 
Train step: 2090 acc:0.79974 total_loss: 0.79462  loss:1.3455,stance loss: 0.85056 
Train step: 2100 acc:0.80135 total_loss: 0.80071  loss:1.1511,stance loss: 1.4118 
Train step: 2110 acc:0.80127 total_loss: 0.79943  loss:0.64989,stance loss: 0.58643 
Train step: 2120 acc:0.80261 total_loss: 0.79573  loss:0.39629,stance loss: 0.30954 
Train step: 2130 acc:0.79813 total_loss: 0.80576  loss:0.97365,stance loss: 0.6388 
Train step: 2140 acc:0.79727 total_loss: 0.8092  loss:0.84592,stance loss: 0.73546 
Train step: 2150 acc:0.79589 total_loss: 0.81213  loss:0.87551,stance loss: 0.70361 
Train step: 2160 acc:0.79752 total_loss: 0.80863  loss:0.89179,stance loss: 0.62475 
Train step: 2170 acc:0.79873 total_loss: 0.80208  loss:0.18903,stance loss: 0.12239 
Train step: 2180 acc:0.798 total_loss: 0.80411  loss:0.86225,stance loss: 0.55508 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.78125 total_loss: 0.79013  loss:0.75946,stance loss: 0.52745 
Train step: 2200 acc:0.82589 total_loss: 0.72815  loss:0.91231,stance loss: 0.85399 
Train step: 2210 acc:0.85417 total_loss: 0.64449  loss:0.60139,stance loss: 0.59311 
Train step: 2220 acc:0.85478 total_loss: 0.61799  loss:0.24878,stance loss: 0.13763 
Train step: 2230 acc:0.85795 total_loss: 0.66095  loss:0.46476,stance loss: 0.37667 
Train step: 2240 acc:0.85417 total_loss: 0.69644  loss:1.0324,stance loss: 1.393 
Train step: 2250 acc:0.85059 total_loss: 0.72202  loss:0.54514,stance loss: 0.46037 
Train step: 2260 acc:0.84291 total_loss: 0.72643  loss:0.59885,stance loss: 0.33814 
Train step: 2270 acc:0.84301 total_loss: 0.71976  loss:0.46188,stance loss: 0.33924 
Train step: 2280 acc:0.84309 total_loss: 0.71492  loss:1.1395,stance loss: 1.076 
Train step: 2290 acc:0.84315 total_loss: 0.71299  loss:0.57482,stance loss: 0.57485 
Train step: 2300 acc:0.84485 total_loss: 0.71027  loss:0.27822,stance loss: 0.17917 
Train step: 2310 acc:0.84577 total_loss: 0.7079  loss:0.39073,stance loss: 0.26042 
Train step: 2320 acc:0.84701 total_loss: 0.71227  loss:0.84603,stance loss: 0.76879 
Train step: 2330 acc:0.84462 total_loss: 0.71816  loss:1.2065,stance loss: 1.3136 
Train step: 2340 acc:0.84334 total_loss: 0.72253  loss:0.96167,stance loss: 0.89241 
Train step: 2350 acc:0.83803 total_loss: 0.73047  loss:1.045,stance loss: 0.72946 
Train step: 2360 acc:0.83908 total_loss: 0.72744  loss:0.84865,stance loss: 1.1403 
Train step: 2370 acc:0.84069 total_loss: 0.72555  loss:0.60077,stance loss: 0.4709 
Train step: 2380 acc:0.83924 total_loss: 0.72732  loss:0.56419,stance loss: 0.43318 
Train step: 2390 acc:0.84161 total_loss: 0.72434  loss:0.94681,stance loss: 1.3702 
Train step: 2400 acc:0.84112 total_loss: 0.72502  loss:0.9576,stance loss: 0.86758 
Train step: 2410 acc:0.8418 total_loss: 0.72618  loss:0.63001,stance loss: 0.53911 
Train step: 2420 acc:0.84241 total_loss: 0.72061  loss:0.8218,stance loss: 0.60327 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.875 total_loss: 0.98481  loss:0.98481,stance loss: 1.4667 
Train step: 2440 acc:0.88636 total_loss: 0.5592  loss:0.44533,stance loss: 0.33247 
Train step: 2450 acc:0.88988 total_loss: 0.52796  loss:0.22365,stance loss: 0.13825 
Train step: 2460 acc:0.86895 total_loss: 0.58997  loss:0.46681,stance loss: 0.35706 
Train step: 2470 acc:0.87043 total_loss: 0.58757  loss:0.79492,stance loss: 0.75422 
Train step: 2480 acc:0.8701 total_loss: 0.57757  loss:0.57837,stance loss: 0.49439 
Train step: 2490 acc:0.87398 total_loss: 0.562  loss:0.37573,stance loss: 0.19337 
Train step: 2500 acc:0.87148 total_loss: 0.56038  loss:0.41423,stance loss: 0.3264 
Train step: 2510 acc:0.87731 total_loss: 0.54242  loss:0.28584,stance loss: 0.18919 
Train step: 2520 acc:0.87775 total_loss: 0.54934  loss:0.22521,stance loss: 0.17782 
Train step: 2530 acc:0.87562 total_loss: 0.56555  loss:1.0134,stance loss: 0.85373 
Train step: 2540 acc:0.875 total_loss: 0.56536  loss:0.45841,stance loss: 0.39389 
Train step: 2550 acc:0.87552 total_loss: 0.56339  loss:0.84728,stance loss: 0.71387 
Train step: 2560 acc:0.87452 total_loss: 0.56314  loss:0.377,stance loss: 0.18396 
Train step: 2570 acc:0.87323 total_loss: 0.55641  loss:0.65283,stance loss: 0.49647 
Train step: 2580 acc:0.87045 total_loss: 0.57116  loss:0.81928,stance loss: 1.0701 
Train step: 2590 acc:0.87034 total_loss: 0.5758  loss:0.55871,stance loss: 0.3937 
Train step: 2600 acc:0.86696 total_loss: 0.5934  loss:0.25034,stance loss: 0.10836 
Train step: 2610 acc:0.86775 total_loss: 0.59875  loss:0.61154,stance loss: 0.64283 
Train step: 2620 acc:0.86878 total_loss: 0.59747  loss:0.83409,stance loss: 0.69774 
Train step: 2630 acc:0.8694 total_loss: 0.59524  loss:0.52821,stance loss: 0.41118 
Train step: 2640 acc:0.87115 total_loss: 0.59094  loss:0.79348,stance loss: 0.63667 
Train step: 2650 acc:0.87415 total_loss: 0.58404  loss:0.7644,stance loss: 0.68761 
Train step: 2660 acc:0.87365 total_loss: 0.58463  loss:0.47197,stance loss: 0.26277 
Train step: 2670 acc:0.87448 total_loss: 0.58206  loss:0.97174,stance loss: 0.82959 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.89062 total_loss: 0.44117  loss:0.61993,stance loss: 0.64872 
Train step: 2690 acc:0.90625 total_loss: 0.45001  loss:0.54783,stance loss: 0.50149 
Train step: 2700 acc:0.89509 total_loss: 0.49435  loss:0.52583,stance loss: 0.32155 
Train step: 2710 acc:0.89638 total_loss: 0.49238  loss:0.62283,stance loss: 0.48082 
Train step: 2720 acc:0.89974 total_loss: 0.48869  loss:0.29132,stance loss: 0.23118 
Train step: 2730 acc:0.90302 total_loss: 0.47829  loss:0.29065,stance loss: 0.13436 
Train step: 2740 acc:0.90717 total_loss: 0.45203  loss:0.27568,stance loss: 0.14488 
Train step: 2750 acc:0.90545 total_loss: 0.46407  loss:0.80255,stance loss: 0.84389 
Train step: 2760 acc:0.90199 total_loss: 0.4737  loss:0.64715,stance loss: 0.42754 
Train step: 2770 acc:0.90753 total_loss: 0.46824  loss:0.47876,stance loss: 0.47023 
Train step: 2780 acc:0.90972 total_loss: 0.46307  loss:0.2813,stance loss: 0.1821 
Train step: 2790 acc:0.91261 total_loss: 0.46549  loss:0.39695,stance loss: 0.26226 
Train step: 2800 acc:0.91162 total_loss: 0.46732  loss:0.33801,stance loss: 0.28485 
Train step: 2810 acc:0.91304 total_loss: 0.45944  loss:0.13119,stance loss: 0.094983 
Train step: 2820 acc:0.91427 total_loss: 0.45059  loss:0.11462,stance loss: 0.095258 
Train step: 2830 acc:0.91456 total_loss: 0.44742  loss:0.099304,stance loss: 0.043878 
Train step: 2840 acc:0.91555 total_loss: 0.45201  loss:0.18562,stance loss: 0.13804 
Train step: 2850 acc:0.91362 total_loss: 0.45777  loss:0.090994,stance loss: 0.024464 
Train step: 2860 acc:0.91223 total_loss: 0.45873  loss:0.22622,stance loss: 0.16192 
Train step: 2870 acc:0.91067 total_loss: 0.46402  loss:0.32611,stance loss: 0.22414 
Train step: 2880 acc:0.91076 total_loss: 0.46526  loss:0.61573,stance loss: 0.49109 
Train step: 2890 acc:0.90912 total_loss: 0.47144  loss:1.0135,stance loss: 0.98559 
Train step: 2900 acc:0.90844 total_loss: 0.46923  loss:0.22005,stance loss: 0.19728 
Train step: 2910 acc:0.90625 total_loss: 0.47907  loss:0.38191,stance loss: 0.36826 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.9 total_loss: 0.37316  loss:0.27305,stance loss: 0.1601 
Train step: 2930 acc:0.9 total_loss: 0.39596  loss:0.82199,stance loss: 1.1855 
Train step: 2940 acc:0.9225 total_loss: 0.35327  loss:0.30731,stance loss: 0.28159 
Train step: 2950 acc:0.92857 total_loss: 0.32219  loss:0.41937,stance loss: 0.32522 
Train step: 2960 acc:0.92778 total_loss: 0.34607  loss:0.42968,stance loss: 0.49875 
Train step: 2970 acc:0.92614 total_loss: 0.369  loss:0.25001,stance loss: 0.11999 
Train step: 2980 acc:0.92885 total_loss: 0.3749  loss:1.0046,stance loss: 0.9875 
Train step: 2990 acc:0.93 total_loss: 0.3902  loss:0.24438,stance loss: 0.090315 
Train step: 3000 acc:0.92941 total_loss: 0.39336  loss:0.23505,stance loss: 0.14486 
Train step: 3010 acc:0.93421 total_loss: 0.37928  loss:0.4741,stance loss: 0.3891 
Train step: 3020 acc:0.93393 total_loss: 0.38113  loss:0.23129,stance loss: 0.13406 
Train step: 3030 acc:0.93315 total_loss: 0.38321  loss:0.40763,stance loss: 0.23811 
Train step: 3040 acc:0.932 total_loss: 0.38208  loss:0.29556,stance loss: 0.28639 
Train step: 3050 acc:0.9338 total_loss: 0.37253  loss:0.11248,stance loss: 0.036195 
Train step: 3060 acc:0.93319 total_loss: 0.37731  loss:0.094256,stance loss: 0.060298 
Train step: 3070 acc:0.93427 total_loss: 0.37414  loss:0.15137,stance loss: 0.11256 
Train step: 3080 acc:0.93447 total_loss: 0.37396  loss:0.22381,stance loss: 0.12199 
Train step: 3090 acc:0.9325 total_loss: 0.37868  loss:0.71159,stance loss: 0.60767 
Train step: 3100 acc:0.93378 total_loss: 0.37042  loss:0.50696,stance loss: 0.41987 
Train step: 3110 acc:0.93462 total_loss: 0.37083  loss:0.17807,stance loss: 0.1469 
Train step: 3120 acc:0.93415 total_loss: 0.37048  loss:0.6266,stance loss: 0.60432 
Train step: 3130 acc:0.93634 total_loss: 0.36382  loss:0.42257,stance loss: 0.37469 
Train step: 3140 acc:0.93472 total_loss: 0.36933  loss:0.80415,stance loss: 0.63366 
Train step: 3150 acc:0.93431 total_loss: 0.36701  loss:0.068591,stance loss: 0.009133 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:1.0 total_loss: 0.16543  loss:0.14326,stance loss: 0.12455 
Train step: 3170 acc:0.95312 total_loss: 0.3505  loss:0.60959,stance loss: 0.23405 
Train step: 3180 acc:0.9517 total_loss: 0.30588  loss:0.65993,stance loss: 0.53852 
Train step: 3190 acc:0.95117 total_loss: 0.28105  loss:0.072257,stance loss: 0.03445 
Train step: 3200 acc:0.95536 total_loss: 0.26821  loss:0.039683,stance loss: 0.0060163 
Train step: 3210 acc:0.95553 total_loss: 0.26205  loss:0.095947,stance loss: 0.054344 
Train step: 3220 acc:0.95363 total_loss: 0.26805  loss:0.3909,stance loss: 0.36683 
Train step: 3230 acc:0.95573 total_loss: 0.26931  loss:0.18151,stance loss: 0.20122 
Train step: 3240 acc:0.95808 total_loss: 0.25533  loss:0.26225,stance loss: 0.17889 
Train step: 3250 acc:0.95652 total_loss: 0.26957  loss:0.54086,stance loss: 0.56045 
Train step: 3260 acc:0.95404 total_loss: 0.27915  loss:0.22502,stance loss: 0.10952 
Train step: 3270 acc:0.95647 total_loss: 0.26946  loss:0.025489,stance loss: 0.00018649 
Train step: 3280 acc:0.95441 total_loss: 0.27744  loss:0.35837,stance loss: 0.31568 
Train step: 3290 acc:0.95265 total_loss: 0.28392  loss:0.45819,stance loss: 0.37316 
Train step: 3300 acc:0.9529 total_loss: 0.28546  loss:0.19155,stance loss: 0.17919 
Train step: 3310 acc:0.94942 total_loss: 0.29364  loss:0.33114,stance loss: 0.31548 
Train step: 3320 acc:0.94985 total_loss: 0.29244  loss:0.43328,stance loss: 0.38288 
Train step: 3330 acc:0.94876 total_loss: 0.29751  loss:0.31697,stance loss: 0.22286 
Train step: 3340 acc:0.94815 total_loss: 0.30501  loss:0.24827,stance loss: 0.17895 
Train step: 3350 acc:0.94824 total_loss: 0.30558  loss:0.81244,stance loss: 1.1135 
Train step: 3360 acc:0.94864 total_loss: 0.30772  loss:0.75849,stance loss: 0.69411 
Train step: 3370 acc:0.9487 total_loss: 0.30454  loss:0.20057,stance loss: 0.13694 
Train step: 3380 acc:0.94848 total_loss: 0.3057  loss:0.84953,stance loss: 0.74998 
Train step: 3390 acc:0.94881 total_loss: 0.3031  loss:0.18606,stance loss: 0.13943 
Train step: 3400 acc:0.94835 total_loss: 0.30404  loss:0.42547,stance loss: 0.43063 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.88889 total_loss: 0.48071  loss:0.3695,stance loss: 0.28509 
Train step: 3420 acc:0.90461 total_loss: 0.42532  loss:0.84992,stance loss: 0.44085 
Train step: 3430 acc:0.90517 total_loss: 0.41324  loss:0.71859,stance loss: 0.60986 
Train step: 3440 acc:0.91506 total_loss: 0.36645  loss:0.41201,stance loss: 0.40786 
Train step: 3450 acc:0.9273 total_loss: 0.33814  loss:0.21148,stance loss: 0.03163 
Train step: 3460 acc:0.92797 total_loss: 0.32792  loss:0.2098,stance loss: 0.15411 
Train step: 3470 acc:0.93025 total_loss: 0.31503  loss:0.072657,stance loss: 0.047197 
Train step: 3480 acc:0.93434 total_loss: 0.3048  loss:0.061451,stance loss: 0.02022 
Train step: 3490 acc:0.9368 total_loss: 0.29831  loss:0.8125,stance loss: 1.161 
Train step: 3500 acc:0.93813 total_loss: 0.29285  loss:0.062688,stance loss: 0.029363 
Train step: 3510 acc:0.94094 total_loss: 0.29435  loss:0.64776,stance loss: 0.57329 
Train step: 3520 acc:0.94328 total_loss: 0.28215  loss:0.033646,stance loss: 0.0016626 
Train step: 3530 acc:0.94525 total_loss: 0.27701  loss:0.058502,stance loss: 0.035407 
Train step: 3540 acc:0.94469 total_loss: 0.27527  loss:0.031322,stance loss: 0.0090837 
Train step: 3550 acc:0.94505 total_loss: 0.2772  loss:0.49506,stance loss: 0.47305 
Train step: 3560 acc:0.94458 total_loss: 0.28437  loss:0.43413,stance loss: 0.34487 
Better F1! Saving model!
Saving model of best f1: 0.5230365435089845
              precision    recall  f1-score   support

           0   0.719512  0.522124  0.605128       565
           1   0.550562  0.765625  0.640523       256
           2   0.385321  0.515337  0.440945       163

    accuracy                       0.584350       984
   macro avg   0.551798  0.601029  0.562199       984
weighted avg   0.620199  0.584350  0.587140       984

Test Acc: 0.584349593495935 F1_ma:0.5230365435089845
Train step: 3570 acc:0.94601 total_loss: 0.27586  loss:0.092984,stance loss: 0.0092213 
Train step: 3580 acc:0.94693 total_loss: 0.27383  loss:0.57401,stance loss: 0.49142 
Train step: 3590 acc:0.94808 total_loss: 0.26932  loss:0.13589,stance loss: 0.086413 
Train step: 3600 acc:0.94849 total_loss: 0.26645  loss:0.47223,stance loss: 0.52467 
Train step: 3610 acc:0.94946 total_loss: 0.26105  loss:0.45467,stance loss: 0.49985 
Train step: 3620 acc:0.95006 total_loss: 0.26063  loss:0.056668,stance loss: 0.032912 
Train step: 3630 acc:0.9506 total_loss: 0.26177  loss:0.043684,stance loss: 0.021496 
Train step: 3640 acc:0.9511 total_loss: 0.26602  loss:0.2077,stance loss: 0.089518 
Training finished.


Reload the best model with best f1 0.5230365435089845 from path test_outputs/bert-cross-topic/hc/2023-08-16 16-08-20/state_dict


              precision    recall  f1-score   support

           0   0.719512  0.522124  0.605128       565
           1   0.550562  0.765625  0.640523       256
           2   0.385321  0.515337  0.440945       163

    accuracy                       0.584350       984
   macro avg   0.551798  0.601029  0.562199       984
weighted avg   0.620199  0.584350  0.587140       984

Test Acc: 0.584349593495935 F1_ma:0.5230365435089845
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5230365435089845
acc: 0.584349593495935, f1 :0.5621986542783208
classification report: 
              precision    recall  f1-score   support

         Con     0.7195    0.5221    0.6051       565
        None     0.5506    0.7656    0.6405       256
         Pro     0.3853    0.5153    0.4409       163

    accuracy                         0.5843       984
   macro avg     0.5518    0.6010    0.5622       984
weighted avg     0.6202    0.5843    0.5871       984

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='hc', dataset_files={'train': './datasets/o_hc', 'test': './datasets/hc'}, dev_dir='./datasets/hc', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/hc/2023-08-16 16-28-44', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/hc', train_dir='./datasets/o_hc', type=0)
using model:  bert-cross-topic
running dataset:  hc
output_dir:  test_outputs/bert-cross-topic/hc/2023-08-16 16-28-44
Train loader length: 243
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 2.2985  loss:2.2985,stance loss: 2.1663 
Train step: 10 acc:0.31818 total_loss: 1.7934  loss:1.723,stance loss: 1.2284 
Better F1! Saving model!
Saving model of best f1: 0.3647514525500323
              precision    recall  f1-score   support

           0   0.574187  1.000000  0.729503       565
           1   0.000000  0.000000  0.000000       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.574187       984
   macro avg   0.191396  0.333333  0.243168       984
weighted avg   0.329691  0.574187  0.418871       984

Test Acc: 0.5741869918699187 F1_ma:0.3647514525500323
Train step: 20 acc:0.3631 total_loss: 1.7401  loss:1.7132,stance loss: 1.2351 
Train step: 30 acc:0.38105 total_loss: 1.73  loss:1.7081,stance loss: 1.2289 
Train step: 40 acc:0.39634 total_loss: 1.7103  loss:1.5667,stance loss: 1.0814 
Train step: 50 acc:0.42034 total_loss: 1.6983  loss:1.7234,stance loss: 1.2221 
Train step: 60 acc:0.43443 total_loss: 1.6752  loss:1.5735,stance loss: 1.0693 
Train step: 70 acc:0.44366 total_loss: 1.6639  loss:1.7062,stance loss: 1.4545 
Train step: 80 acc:0.45216 total_loss: 1.6584  loss:1.6484,stance loss: 1.2091 
Train step: 90 acc:0.45604 total_loss: 1.6561  loss:1.5377,stance loss: 1.0277 
Train step: 100 acc:0.46163 total_loss: 1.6501  loss:1.4412,stance loss: 0.95947 
Train step: 110 acc:0.46678 total_loss: 1.6466  loss:1.6445,stance loss: 1.1404 
Train step: 120 acc:0.46746 total_loss: 1.6452  loss:1.5712,stance loss: 0.98669 
Train step: 130 acc:0.47376 total_loss: 1.6329  loss:1.3515,stance loss: 0.83396 
Train step: 140 acc:0.4734 total_loss: 1.6289  loss:1.7426,stance loss: 1.2298 
Train step: 150 acc:0.47392 total_loss: 1.6244  loss:1.6568,stance loss: 1.2625 
Train step: 160 acc:0.47632 total_loss: 1.6141  loss:1.3071,stance loss: 0.82099 
Train step: 170 acc:0.47442 total_loss: 1.6085  loss:1.5448,stance loss: 0.94159 
Better F1! Saving model!
Saving model of best f1: 0.3648124191461837
              precision    recall  f1-score   support

           0   0.574924  0.998230  0.729625       565
           1   0.666667  0.007812  0.015444       256
           2   0.000000  0.000000  0.000000       163

    accuracy                       0.575203       984
   macro avg   0.413863  0.335348  0.248356       984
weighted avg   0.503555  0.575203  0.422959       984

Test Acc: 0.5752032520325203 F1_ma:0.3648124191461837
Train step: 180 acc:0.47479 total_loss: 1.6014  loss:1.5007,stance loss: 1.1304 
Train step: 190 acc:0.48266 total_loss: 1.5929  loss:1.4272,stance loss: 1.1741 
Train step: 200 acc:0.48725 total_loss: 1.5864  loss:1.7875,stance loss: 1.8215 
Train step: 210 acc:0.48845 total_loss: 1.5849  loss:1.7023,stance loss: 1.2364 
Train step: 220 acc:0.49038 total_loss: 1.5803  loss:1.2326,stance loss: 0.80147 
Train step: 230 acc:0.49188 total_loss: 1.5762  loss:1.5212,stance loss: 1.0256 
Train step: 240 acc:0.49481 total_loss: 1.5691  loss:1.4466,stance loss: 1.0043 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.58594 total_loss: 1.3861  loss:1.4398,stance loss: 1.1385 
Train step: 260 acc:0.59722 total_loss: 1.3845  loss:1.4186,stance loss: 0.99018 
Train step: 270 acc:0.61607 total_loss: 1.3786  loss:1.1249,stance loss: 0.74627 
Train step: 280 acc:0.63158 total_loss: 1.3484  loss:1.2416,stance loss: 0.88663 
Train step: 290 acc:0.6263 total_loss: 1.3491  loss:1.2373,stance loss: 0.83322 
Train step: 300 acc:0.62069 total_loss: 1.3666  loss:1.3299,stance loss: 0.92506 
Train step: 310 acc:0.61029 total_loss: 1.3744  loss:1.268,stance loss: 0.85533 
Train step: 320 acc:0.60497 total_loss: 1.3877  loss:1.7104,stance loss: 1.3177 
Train step: 330 acc:0.61506 total_loss: 1.3745  loss:1.5872,stance loss: 1.2632 
Train step: 340 acc:0.62691 total_loss: 1.3585  loss:1.2422,stance loss: 0.99099 
Train step: 350 acc:0.63368 total_loss: 1.3506  loss:1.1089,stance loss: 0.71178 
Train step: 360 acc:0.63506 total_loss: 1.345  loss:1.3905,stance loss: 1.1443 
Train step: 370 acc:0.63672 total_loss: 1.3449  loss:1.3336,stance loss: 1.1097 
Train step: 380 acc:0.64221 total_loss: 1.3374  loss:1.093,stance loss: 0.75628 
Train step: 390 acc:0.64274 total_loss: 1.3339  loss:1.1829,stance loss: 0.84625 
Train step: 400 acc:0.64597 total_loss: 1.3305  loss:0.90132,stance loss: 0.64857 
Train step: 410 acc:0.64509 total_loss: 1.3262  loss:1.4016,stance loss: 1.0659 
Train step: 420 acc:0.64291 total_loss: 1.3255  loss:1.3629,stance loss: 0.87642 
Train step: 430 acc:0.64561 total_loss: 1.3189  loss:0.99658,stance loss: 0.6121 
Train step: 440 acc:0.64867 total_loss: 1.3145  loss:1.0839,stance loss: 0.72482 
Train step: 450 acc:0.64904 total_loss: 1.3133  loss:1.3301,stance loss: 1.1793 
Train step: 460 acc:0.65138 total_loss: 1.3058  loss:1.383,stance loss: 0.91876 
Better F1! Saving model!
Saving model of best f1: 0.4133117282684498
              precision    recall  f1-score   support

           0   0.635097  0.807080  0.710834       565
           1   0.577406  0.539062  0.557576       256
           2   0.407407  0.067485  0.115789       163

    accuracy                       0.614837       984
   macro avg   0.539970  0.471209  0.461400       984
weighted avg   0.582371  0.614837  0.572393       984

Test Acc: 0.6148373983739838 F1_ma:0.4133117282684498
Train step: 470 acc:0.65323 total_loss: 1.3005  loss:1.0954,stance loss: 0.68751 
Train step: 480 acc:0.65336 total_loss: 1.2975  loss:1.1004,stance loss: 0.89435 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.75 total_loss: 1.1458  loss:1.1067,stance loss: 0.84695 
Train step: 500 acc:0.71667 total_loss: 1.1453  loss:1.4078,stance loss: 1.0536 
Train step: 510 acc:0.705 total_loss: 1.1592  loss:1.0044,stance loss: 0.76296 
Better F1! Saving model!
Saving model of best f1: 0.4788294171230396
              precision    recall  f1-score   support

           0   0.645570  0.631858  0.638640       565
           1   0.582090  0.609375  0.595420       256
           2   0.319018  0.319018  0.319018       163

    accuracy                       0.574187       984
   macro avg   0.515559  0.520084  0.517693       984
weighted avg   0.574961  0.574187  0.574451       984

Test Acc: 0.5741869918699187 F1_ma:0.4788294171230396
Train step: 520 acc:0.70714 total_loss: 1.1525  loss:0.88563,stance loss: 0.58947 
Train step: 530 acc:0.69583 total_loss: 1.1542  loss:1.1664,stance loss: 0.83453 
Train step: 540 acc:0.69773 total_loss: 1.16  loss:0.91813,stance loss: 0.57092 
Train step: 550 acc:0.69519 total_loss: 1.1595  loss:1.3099,stance loss: 1.1317 
Train step: 560 acc:0.695 total_loss: 1.1601  loss:0.94291,stance loss: 0.69262 
Train step: 570 acc:0.69706 total_loss: 1.1504  loss:0.95723,stance loss: 0.76503 
Train step: 580 acc:0.69605 total_loss: 1.1497  loss:1.2927,stance loss: 1.0483 
Train step: 590 acc:0.69524 total_loss: 1.1577  loss:1.0657,stance loss: 0.91436 
Better F1! Saving model!
Saving model of best f1: 0.48829252981795357
              precision    recall  f1-score   support

           0   0.645528  0.702655  0.672881       565
           1   0.568702  0.582031  0.575290       256
           2   0.383178  0.251534  0.303704       163

    accuracy                       0.596545       984
   macro avg   0.532469  0.512073  0.517292       984
weighted avg   0.582083  0.596545  0.586337       984

Test Acc: 0.5965447154471545 F1_ma:0.48829252981795357
Train step: 600 acc:0.69837 total_loss: 1.1604  loss:1.1742,stance loss: 0.89363 
Train step: 610 acc:0.6965 total_loss: 1.1601  loss:1.1586,stance loss: 1.052 
Better F1! Saving model!
Saving model of best f1: 0.5008949209120507
              precision    recall  f1-score   support

           0   0.650273  0.631858  0.640934       565
           1   0.583026  0.617188  0.599620       256
           2   0.359756  0.361963  0.360856       163

    accuracy                       0.583333       984
   macro avg   0.531018  0.537003  0.533803       984
weighted avg   0.584654  0.583333  0.583791       984

Test Acc: 0.5833333333333334 F1_ma:0.5008949209120507
Train step: 620 acc:0.69769 total_loss: 1.1591  loss:1.0571,stance loss: 0.90352 
Train step: 630 acc:0.69353 total_loss: 1.1659  loss:1.2453,stance loss: 0.92796 
Train step: 640 acc:0.69556 total_loss: 1.163  loss:1.0432,stance loss: 0.86147 
Train step: 650 acc:0.69659 total_loss: 1.1601  loss:1.774,stance loss: 1.695 
Train step: 660 acc:0.69357 total_loss: 1.1646  loss:1.1013,stance loss: 0.77384 
Train step: 670 acc:0.68885 total_loss: 1.1697  loss:1.5087,stance loss: 1.0804 
Train step: 680 acc:0.69038 total_loss: 1.1745  loss:1.339,stance loss: 1.5652 
Train step: 690 acc:0.69238 total_loss: 1.1695  loss:1.2126,stance loss: 0.91628 
Train step: 700 acc:0.69448 total_loss: 1.1669  loss:0.61759,stance loss: 0.36631 
Train step: 710 acc:0.69083 total_loss: 1.1728  loss:1.8489,stance loss: 1.3972 
Train step: 720 acc:0.69176 total_loss: 1.1703  loss:0.79015,stance loss: 0.64615 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 730 acc:0.78125 total_loss: 0.96449  loss:1.0122,stance loss: 0.72359 
Train step: 740 acc:0.78125 total_loss: 0.97954  loss:0.98628,stance loss: 0.65812 
Train step: 750 acc:0.7642 total_loss: 1.0394  loss:1.0354,stance loss: 0.89939 
Train step: 760 acc:0.74023 total_loss: 1.0555  loss:1.3831,stance loss: 0.98914 
Train step: 770 acc:0.72917 total_loss: 1.0712  loss:1.0263,stance loss: 0.80275 
Train step: 780 acc:0.73438 total_loss: 1.0626  loss:0.93712,stance loss: 0.76832 
Train step: 790 acc:0.72883 total_loss: 1.0918  loss:0.97578,stance loss: 1.2012 
Train step: 800 acc:0.72396 total_loss: 1.0981  loss:1.0418,stance loss: 0.81143 
Better F1! Saving model!
Saving model of best f1: 0.51871615164065
              precision    recall  f1-score   support

           0   0.635368  0.718584  0.674419       565
           1   0.583333  0.492188  0.533898       256
           2   0.410853  0.325153  0.363014       163

    accuracy                       0.594512       984
   macro avg   0.543185  0.511975  0.523777       984
weighted avg   0.584639  0.594512  0.586276       984

Test Acc: 0.5945121951219512 F1_ma:0.51871615164065
Train step: 810 acc:0.72485 total_loss: 1.104  loss:1.0816,stance loss: 0.85487 
Train step: 820 acc:0.72283 total_loss: 1.1063  loss:0.93089,stance loss: 0.67585 
Train step: 830 acc:0.72059 total_loss: 1.1128  loss:1.8229,stance loss: 1.8839 
Train step: 840 acc:0.71931 total_loss: 1.1028  loss:0.85728,stance loss: 0.7021 
Better F1! Saving model!
Saving model of best f1: 0.5254610024638128
              precision    recall  f1-score   support

           0   0.652008  0.603540  0.626838       565
           1   0.599174  0.566406  0.582329       256
           2   0.369863  0.496933  0.424084       163

    accuracy                       0.576220       984
   macro avg   0.540348  0.555626  0.544417       984
weighted avg   0.591525  0.576220  0.581672       984

Test Acc: 0.5762195121951219 F1_ma:0.5254610024638128
Train step: 850 acc:0.71363 total_loss: 1.1071  loss:0.94997,stance loss: 0.73732 
Train step: 860 acc:0.71638 total_loss: 1.0951  loss:0.93304,stance loss: 0.72913 
Train step: 870 acc:0.71435 total_loss: 1.0906  loss:1.0668,stance loss: 0.82434 
Train step: 880 acc:0.7134 total_loss: 1.0865  loss:1.0436,stance loss: 0.78405 
Better F1! Saving model!
Saving model of best f1: 0.5261208218337934
              precision    recall  f1-score   support

           0   0.651341  0.601770  0.625575       565
           1   0.592000  0.578125  0.584980       256
           2   0.377358  0.490798  0.426667       163

    accuracy                       0.577236       984
   macro avg   0.540233  0.556897  0.545741       984
weighted avg   0.590517  0.577236  0.582065       984

Test Acc: 0.5772357723577236 F1_ma:0.5261208218337934
Train step: 890 acc:0.71605 total_loss: 1.0751  loss:0.73312,stance loss: 0.60884 
Train step: 900 acc:0.71657 total_loss: 1.0683  loss:0.80145,stance loss: 0.53236 
Train step: 910 acc:0.71635 total_loss: 1.0711  loss:0.89241,stance loss: 0.70644 
Train step: 920 acc:0.71712 total_loss: 1.0697  loss:0.86702,stance loss: 0.67112 
Train step: 930 acc:0.71813 total_loss: 1.0685  loss:0.99466,stance loss: 0.70678 
Train step: 940 acc:0.71728 total_loss: 1.0721  loss:0.99022,stance loss: 0.62957 
Train step: 950 acc:0.71593 total_loss: 1.073  loss:1.0144,stance loss: 0.7253 
Train step: 960 acc:0.71713 total_loss: 1.0696  loss:0.88968,stance loss: 0.64147 
Train step: 970 acc:0.71694 total_loss: 1.0649  loss:1.1025,stance loss: 0.83294 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.72222 total_loss: 1.0293  loss:0.84219,stance loss: 0.5755 
Train step: 990 acc:0.72697 total_loss: 1.0022  loss:0.86067,stance loss: 0.66049 
Train step: 1000 acc:0.73707 total_loss: 1.0152  loss:0.90932,stance loss: 0.67911 
Train step: 1010 acc:0.74038 total_loss: 0.98447  loss:0.81293,stance loss: 0.56286 
Train step: 1020 acc:0.74107 total_loss: 0.98522  loss:0.79592,stance loss: 0.64018 
Train step: 1030 acc:0.74788 total_loss: 0.98408  loss:1.3368,stance loss: 1.4756 
Train step: 1040 acc:0.74457 total_loss: 0.99689  loss:1.044,stance loss: 0.77471 
Train step: 1050 acc:0.73655 total_loss: 1.004  loss:1.3652,stance loss: 1.2968 
Train step: 1060 acc:0.74298 total_loss: 0.98978  loss:0.93651,stance loss: 0.80188 
Train step: 1070 acc:0.74432 total_loss: 0.96927  loss:0.71321,stance loss: 0.48469 
Train step: 1080 acc:0.74599 total_loss: 0.96128  loss:0.61521,stance loss: 0.46893 
Train step: 1090 acc:0.74475 total_loss: 0.9646  loss:1.4976,stance loss: 1.6648 
Train step: 1100 acc:0.74516 total_loss: 0.96003  loss:0.78145,stance loss: 0.57924 
Train step: 1110 acc:0.7455 total_loss: 0.95859  loss:0.85102,stance loss: 0.53397 
Train step: 1120 acc:0.74706 total_loss: 0.95445  loss:1.2062,stance loss: 0.92987 
Better F1! Saving model!
Saving model of best f1: 0.5265474797611074
              precision    recall  f1-score   support

           0   0.652027  0.683186  0.667243       565
           1   0.590164  0.562500  0.576000       256
           2   0.405405  0.368098  0.385852       163

    accuracy                       0.599593       984
   macro avg   0.549199  0.537928  0.543032       984
weighted avg   0.595080  0.599593  0.596892       984

Test Acc: 0.5995934959349594 F1_ma:0.5265474797611074
Train step: 1130 acc:0.74725 total_loss: 0.96092  loss:1.2155,stance loss: 1.11 
Train step: 1140 acc:0.74371 total_loss: 0.96762  loss:1.4514,stance loss: 1.5519 
Better F1! Saving model!
Saving model of best f1: 0.5380875440658048
              precision    recall  f1-score   support

           0   0.630048  0.690265  0.658784       565
           1   0.595628  0.425781  0.496583       256
           2   0.395604  0.441718  0.417391       163

    accuracy                       0.580285       984
   macro avg   0.540427  0.519255  0.524253       984
weighted avg   0.582258  0.580285  0.576598       984

Test Acc: 0.5802845528455285 F1_ma:0.5380875440658048
Train step: 1150 acc:0.74476 total_loss: 0.96524  loss:1.1562,stance loss: 1.3838 
Train step: 1160 acc:0.73975 total_loss: 0.97685  loss:0.84336,stance loss: 0.54941 
Train step: 1170 acc:0.73932 total_loss: 0.9754  loss:0.97019,stance loss: 0.68217 
Train step: 1180 acc:0.73774 total_loss: 0.98021  loss:1.1548,stance loss: 0.80375 
Train step: 1190 acc:0.73773 total_loss: 0.98064  loss:1.4014,stance loss: 1.2205 
Train step: 1200 acc:0.73854 total_loss: 0.98187  loss:0.8951,stance loss: 1.1233 
Train step: 1210 acc:0.74006 total_loss: 0.9773  loss:1.0652,stance loss: 0.78623 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1220 acc:0.80208 total_loss: 0.9799  loss:0.58863,stance loss: 0.4901 
Train step: 1230 acc:0.77344 total_loss: 0.97852  loss:1.1018,stance loss: 0.89798 
Train step: 1240 acc:0.75481 total_loss: 0.9835  loss:0.79595,stance loss: 0.71687 
Train step: 1250 acc:0.76562 total_loss: 0.93984  loss:0.78028,stance loss: 0.60648 
Train step: 1260 acc:0.75951 total_loss: 0.93209  loss:0.82233,stance loss: 0.61443 
Train step: 1270 acc:0.76786 total_loss: 0.93005  loss:0.78748,stance loss: 0.67639 
Train step: 1280 acc:0.76515 total_loss: 0.92495  loss:1.0678,stance loss: 0.82908 
Train step: 1290 acc:0.76562 total_loss: 0.90479  loss:0.66572,stance loss: 0.59479 
Train step: 1300 acc:0.7718 total_loss: 0.90113  loss:0.95766,stance loss: 0.68074 
Train step: 1310 acc:0.77083 total_loss: 0.89656  loss:1.0387,stance loss: 0.84254 
Train step: 1320 acc:0.77358 total_loss: 0.88924  loss:0.69221,stance loss: 0.53015 
Train step: 1330 acc:0.7764 total_loss: 0.8773  loss:0.98371,stance loss: 0.78582 
Train step: 1340 acc:0.77778 total_loss: 0.86743  loss:0.60123,stance loss: 0.40053 
Train step: 1350 acc:0.77619 total_loss: 0.87607  loss:1.0085,stance loss: 0.84804 
Train step: 1360 acc:0.77354 total_loss: 0.87396  loss:1.0773,stance loss: 0.84338 
Train step: 1370 acc:0.77244 total_loss: 0.88476  loss:1.0522,stance loss: 0.82318 
Train step: 1380 acc:0.77221 total_loss: 0.88314  loss:0.63323,stance loss: 0.43667 
Train step: 1390 acc:0.77344 total_loss: 0.87954  loss:1.0417,stance loss: 1.3989 
Train step: 1400 acc:0.77386 total_loss: 0.87937  loss:1.417,stance loss: 1.6762 
Train step: 1410 acc:0.77551 total_loss: 0.87498  loss:0.89594,stance loss: 1.2261 
Train step: 1420 acc:0.77488 total_loss: 0.87572  loss:1.3502,stance loss: 1.1857 
Train step: 1430 acc:0.77517 total_loss: 0.87643  loss:1.0555,stance loss: 0.89508 
Train step: 1440 acc:0.77406 total_loss: 0.87628  loss:0.73924,stance loss: 0.62262 
Train step: 1450 acc:0.7741 total_loss: 0.87312  loss:0.68508,stance loss: 0.47286 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1460 acc:0.6875 total_loss: 0.89034  loss:0.80096,stance loss: 0.53892 
Train step: 1470 acc:0.75962 total_loss: 0.78544  loss:0.7712,stance loss: 0.59608 
Train step: 1480 acc:0.77174 total_loss: 0.82506  loss:0.78074,stance loss: 0.56329 
Train step: 1490 acc:0.76515 total_loss: 0.83706  loss:0.78928,stance loss: 0.43683 
Train step: 1500 acc:0.7718 total_loss: 0.83955  loss:0.60642,stance loss: 0.34089 
Train step: 1510 acc:0.76415 total_loss: 0.84024  loss:0.98866,stance loss: 0.61699 
Train step: 1520 acc:0.76984 total_loss: 0.82303  loss:0.41376,stance loss: 0.31689 
Train step: 1530 acc:0.77825 total_loss: 0.80597  loss:0.55261,stance loss: 0.43497 
Train step: 1540 acc:0.78163 total_loss: 0.79711  loss:1.0755,stance loss: 0.94136 
Train step: 1550 acc:0.78562 total_loss: 0.79722  loss:0.49545,stance loss: 0.31783 
Train step: 1560 acc:0.79005 total_loss: 0.79382  loss:0.6189,stance loss: 0.42886 
Train step: 1570 acc:0.78816 total_loss: 0.79272  loss:0.44848,stance loss: 0.34644 
Train step: 1580 acc:0.79116 total_loss: 0.7853  loss:0.66687,stance loss: 0.46837 
Train step: 1590 acc:0.79229 total_loss: 0.78469  loss:0.69204,stance loss: 0.5159 
Train step: 1600 acc:0.79633 total_loss: 0.77689  loss:0.45414,stance loss: 0.38841 
Train step: 1610 acc:0.79453 total_loss: 0.77715  loss:0.90799,stance loss: 0.6974 
Train step: 1620 acc:0.79448 total_loss: 0.78101  loss:0.77142,stance loss: 0.58668 
Train step: 1630 acc:0.79769 total_loss: 0.77428  loss:0.77681,stance loss: 0.58043 
Better F1! Saving model!
Saving model of best f1: 0.5445665445665446
              precision    recall  f1-score   support

           0   0.667932  0.623009  0.644689       565
           1   0.607438  0.574219  0.590361       256
           2   0.390698  0.515337  0.444444       163

    accuracy                       0.592480       984
   macro avg   0.555356  0.570855  0.559832       984
weighted avg   0.606270  0.592480  0.597384       984

Test Acc: 0.592479674796748 F1_ma:0.5445665445665446
Train step: 1640 acc:0.80055 total_loss: 0.76319  loss:0.79533,stance loss: 0.67351 
Train step: 1650 acc:0.80214 total_loss: 0.76618  loss:0.55159,stance loss: 0.44044 
Train step: 1660 acc:0.8045 total_loss: 0.76176  loss:0.31127,stance loss: 0.22157 
Train step: 1670 acc:0.80575 total_loss: 0.76256  loss:0.77766,stance loss: 0.67369 
Train step: 1680 acc:0.80521 total_loss: 0.76512  loss:1.2884,stance loss: 1.5629 
Train step: 1690 acc:0.80526 total_loss: 0.76749  loss:0.78126,stance loss: 0.58116 
Train step: 1700 acc:0.80648 total_loss: 0.76454  loss:0.47695,stance loss: 0.36992 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1710 acc:0.88125 total_loss: 0.57902  loss:0.63335,stance loss: 0.53178 
Train step: 1720 acc:0.85938 total_loss: 0.68265  loss:1.5274,stance loss: 1.2739 
Train step: 1730 acc:0.86667 total_loss: 0.65086  loss:0.80271,stance loss: 0.64508 
Train step: 1740 acc:0.84219 total_loss: 0.70386  loss:1.1224,stance loss: 0.82337 
Train step: 1750 acc:0.84 total_loss: 0.7156  loss:0.43971,stance loss: 0.39523 
Train step: 1760 acc:0.83542 total_loss: 0.71114  loss:0.76178,stance loss: 0.61683 
Train step: 1770 acc:0.83214 total_loss: 0.71349  loss:0.43654,stance loss: 0.31155 
Train step: 1780 acc:0.83516 total_loss: 0.6964  loss:0.68969,stance loss: 0.61543 
Train step: 1790 acc:0.83542 total_loss: 0.68876  loss:0.68498,stance loss: 0.51292 
Train step: 1800 acc:0.84 total_loss: 0.67476  loss:0.32492,stance loss: 0.2048 
Train step: 1810 acc:0.84034 total_loss: 0.6769  loss:0.79664,stance loss: 0.50985 
Train step: 1820 acc:0.84062 total_loss: 0.68355  loss:0.54743,stance loss: 0.39332 
Train step: 1830 acc:0.84087 total_loss: 0.68461  loss:0.44762,stance loss: 0.37141 
Train step: 1840 acc:0.83839 total_loss: 0.69267  loss:1.023,stance loss: 0.80719 
Train step: 1850 acc:0.83833 total_loss: 0.69153  loss:0.98193,stance loss: 0.91894 
Train step: 1860 acc:0.83906 total_loss: 0.68334  loss:1.0287,stance loss: 1.1003 
Train step: 1870 acc:0.84081 total_loss: 0.67788  loss:0.3324,stance loss: 0.24456 
Train step: 1880 acc:0.84236 total_loss: 0.66965  loss:0.57502,stance loss: 0.48259 
Train step: 1890 acc:0.84145 total_loss: 0.66734  loss:0.5022,stance loss: 0.32341 
Train step: 1900 acc:0.84156 total_loss: 0.66624  loss:0.7616,stance loss: 0.5047 
Train step: 1910 acc:0.84226 total_loss: 0.66374  loss:0.65513,stance loss: 0.50797 
Train step: 1920 acc:0.84176 total_loss: 0.66464  loss:0.89621,stance loss: 1.1248 
Train step: 1930 acc:0.84239 total_loss: 0.66359  loss:0.75917,stance loss: 0.70462 
Train step: 1940 acc:0.83984 total_loss: 0.66401  loss:0.66544,stance loss: 0.48229 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1950 acc:0.88393 total_loss: 0.55495  loss:0.54662,stance loss: 0.36269 
Train step: 1960 acc:0.88235 total_loss: 0.55147  loss:0.27411,stance loss: 0.16083 
Train step: 1970 acc:0.88194 total_loss: 0.52092  loss:0.3625,stance loss: 0.2964 
Train step: 1980 acc:0.87838 total_loss: 0.55932  loss:0.98915,stance loss: 1.4086 
Better F1! Saving model!
Saving model of best f1: 0.5480246178280722
              precision    recall  f1-score   support

           0   0.663830  0.552212  0.602899       565
           1   0.594142  0.554688  0.573737       256
           2   0.392727  0.662577  0.493151       163

    accuracy                       0.571138       984
   macro avg   0.550233  0.589826  0.556596       984
weighted avg   0.600791  0.571138  0.577132       984

Test Acc: 0.5711382113821138 F1_ma:0.5480246178280722
Train step: 1990 acc:0.875 total_loss: 0.56912  loss:0.40381,stance loss: 0.27328 
Train step: 2000 acc:0.875 total_loss: 0.57895  loss:0.49635,stance loss: 0.4179 
Train step: 2010 acc:0.875 total_loss: 0.59471  loss:1.2515,stance loss: 1.5603 
Train step: 2020 acc:0.87419 total_loss: 0.58589  loss:0.60868,stance loss: 0.46458 
Better F1! Saving model!
Saving model of best f1: 0.5505114847264977
              precision    recall  f1-score   support

           0   0.680435  0.553982  0.610732       565
           1   0.574545  0.617188  0.595104       256
           2   0.405622  0.619632  0.490291       163

    accuracy                       0.581301       984
   macro avg   0.553534  0.596934  0.565376       984
weighted avg   0.607364  0.581301  0.586715       984

Test Acc: 0.5813008130081301 F1_ma:0.5505114847264977
Train step: 2030 acc:0.86853 total_loss: 0.59227  loss:0.36978,stance loss: 0.31723 
Train step: 2040 acc:0.87307 total_loss: 0.58209  loss:0.45198,stance loss: 0.35402 
Train step: 2050 acc:0.87033 total_loss: 0.59273  loss:0.84232,stance loss: 0.67894 
Train step: 2060 acc:0.86592 total_loss: 0.60143  loss:0.56446,stance loss: 0.39316 
Train step: 2070 acc:0.86319 total_loss: 0.60979  loss:0.55445,stance loss: 0.43864 
Train step: 2080 acc:0.86359 total_loss: 0.60648  loss:0.17724,stance loss: 0.11601 
Train step: 2090 acc:0.8631 total_loss: 0.60115  loss:0.94801,stance loss: 1.3035 
Train step: 2100 acc:0.86226 total_loss: 0.5975  loss:0.63355,stance loss: 0.47162 
Train step: 2110 acc:0.86153 total_loss: 0.59656  loss:0.39086,stance loss: 0.35849 
Train step: 2120 acc:0.86017 total_loss: 0.59993  loss:0.49949,stance loss: 0.39554 
Train step: 2130 acc:0.86263 total_loss: 0.5985  loss:0.49463,stance loss: 0.36457 
Train step: 2140 acc:0.86294 total_loss: 0.59464  loss:0.48934,stance loss: 0.43618 
Train step: 2150 acc:0.86413 total_loss: 0.59218  loss:0.38402,stance loss: 0.29104 
Train step: 2160 acc:0.86406 total_loss: 0.59279  loss:1.4092,stance loss: 1.4679 
Train step: 2170 acc:0.86454 total_loss: 0.59662  loss:1.4684,stance loss: 1.6998 
Train step: 2180 acc:0.86208 total_loss: 0.60059  loss:0.63827,stance loss: 0.47837 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2190 acc:0.875 total_loss: 0.47162  loss:0.37317,stance loss: 0.2499 
Train step: 2200 acc:0.89286 total_loss: 0.44755  loss:0.39486,stance loss: 0.34796 
Train step: 2210 acc:0.89323 total_loss: 0.51277  loss:0.44084,stance loss: 0.41061 
Better F1! Saving model!
Saving model of best f1: 0.5525924893875689
              precision    recall  f1-score   support

           0   0.666667  0.580531  0.620624       565
           1   0.611111  0.558594  0.583673       256
           2   0.395349  0.625767  0.484561       163

    accuracy                       0.582317       984
   macro avg   0.557709  0.588297  0.562953       984
weighted avg   0.607269  0.582317  0.588472       984

Test Acc: 0.5823170731707317 F1_ma:0.5525924893875689
Train step: 2220 acc:0.89154 total_loss: 0.52226  loss:0.24748,stance loss: 0.11038 
Train step: 2230 acc:0.89773 total_loss: 0.51197  loss:0.5182,stance loss: 0.42492 
Train step: 2240 acc:0.89815 total_loss: 0.49996  loss:0.64822,stance loss: 0.54903 
Train step: 2250 acc:0.89258 total_loss: 0.50192  loss:0.54881,stance loss: 0.62577 
Train step: 2260 acc:0.89189 total_loss: 0.49764  loss:0.35904,stance loss: 0.27873 
Train step: 2270 acc:0.89211 total_loss: 0.49761  loss:0.6072,stance loss: 0.43319 
Train step: 2280 acc:0.89761 total_loss: 0.48322  loss:0.24229,stance loss: 0.19027 
Train step: 2290 acc:0.89303 total_loss: 0.4858  loss:0.36442,stance loss: 0.28679 
Train step: 2300 acc:0.89529 total_loss: 0.48972  loss:0.28959,stance loss: 0.20842 
Train step: 2310 acc:0.89466 total_loss: 0.48412  loss:0.37929,stance loss: 0.21549 
Train step: 2320 acc:0.89506 total_loss: 0.48769  loss:0.16948,stance loss: 0.074123 
Train step: 2330 acc:0.89583 total_loss: 0.48607  loss:0.4771,stance loss: 0.3487 
Train step: 2340 acc:0.89367 total_loss: 0.49597  loss:0.63637,stance loss: 0.63044 
Train step: 2350 acc:0.89482 total_loss: 0.49185  loss:0.65053,stance loss: 0.53805 
Train step: 2360 acc:0.89619 total_loss: 0.49498  loss:0.99974,stance loss: 1.1497 
Train step: 2370 acc:0.89504 total_loss: 0.49369  loss:0.55267,stance loss: 0.4218 
Train step: 2380 acc:0.89433 total_loss: 0.49648  loss:0.5586,stance loss: 0.47937 
Train step: 2390 acc:0.89461 total_loss: 0.49839  loss:1.0949,stance loss: 1.2732 
Train step: 2400 acc:0.89398 total_loss: 0.4966  loss:0.30466,stance loss: 0.27634 
Train step: 2410 acc:0.89369 total_loss: 0.49698  loss:0.38588,stance loss: 0.3454 
Train step: 2420 acc:0.89156 total_loss: 0.50147  loss:0.58057,stance loss: 0.42765 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2430 acc:0.9375 total_loss: 0.14764  loss:0.14764,stance loss: 0.03983 
Train step: 2440 acc:0.92045 total_loss: 0.36139  loss:0.36035,stance loss: 0.3162 
Train step: 2450 acc:0.91964 total_loss: 0.41671  loss:0.64119,stance loss: 0.61268 
Train step: 2460 acc:0.90323 total_loss: 0.47624  loss:0.41672,stance loss: 0.34664 
Train step: 2470 acc:0.90549 total_loss: 0.46676  loss:0.56591,stance loss: 0.3659 
Train step: 2480 acc:0.91299 total_loss: 0.4613  loss:0.27889,stance loss: 0.15543 
Train step: 2490 acc:0.91496 total_loss: 0.44564  loss:0.25579,stance loss: 0.11296 
Train step: 2500 acc:0.91637 total_loss: 0.42498  loss:0.26093,stance loss: 0.17731 
Train step: 2510 acc:0.91204 total_loss: 0.44212  loss:0.15056,stance loss: 0.087703 
Train step: 2520 acc:0.90934 total_loss: 0.44667  loss:0.19621,stance loss: 0.14506 
Train step: 2530 acc:0.90965 total_loss: 0.43841  loss:0.1592,stance loss: 0.1143 
Train step: 2540 acc:0.90766 total_loss: 0.43817  loss:0.29729,stance loss: 0.2241 
Train step: 2550 acc:0.91012 total_loss: 0.43108  loss:0.31027,stance loss: 0.25218 
Train step: 2560 acc:0.91365 total_loss: 0.42866  loss:0.32177,stance loss: 0.33056 
Train step: 2570 acc:0.91534 total_loss: 0.42346  loss:0.16271,stance loss: 0.093993 
Train step: 2580 acc:0.91515 total_loss: 0.42169  loss:0.36018,stance loss: 0.24945 
Train step: 2590 acc:0.91731 total_loss: 0.41516  loss:0.43665,stance loss: 0.30178 
Train step: 2600 acc:0.9163 total_loss: 0.41995  loss:0.44651,stance loss: 0.36658 
Train step: 2610 acc:0.91747 total_loss: 0.42209  loss:0.085851,stance loss: 0.011115 
Train step: 2620 acc:0.91819 total_loss: 0.42192  loss:0.84645,stance loss: 1.2286 
Train step: 2630 acc:0.9176 total_loss: 0.42593  loss:0.14789,stance loss: 0.054217 
Train step: 2640 acc:0.91706 total_loss: 0.42538  loss:0.24022,stance loss: 0.18876 
Train step: 2650 acc:0.91714 total_loss: 0.42475  loss:0.10996,stance loss: 0.040306 
Train step: 2660 acc:0.91775 total_loss: 0.42773  loss:0.2498,stance loss: 0.16681 
Train step: 2670 acc:0.91598 total_loss: 0.43404  loss:0.44703,stance loss: 0.29187 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2680 acc:0.92969 total_loss: 0.3759  loss:0.58972,stance loss: 0.38077 
Train step: 2690 acc:0.94444 total_loss: 0.37618  loss:0.14048,stance loss: 0.098875 
Train step: 2700 acc:0.94196 total_loss: 0.38542  loss:0.066586,stance loss: 0.013791 
Train step: 2710 acc:0.93257 total_loss: 0.3864  loss:0.49073,stance loss: 0.4271 
Train step: 2720 acc:0.93229 total_loss: 0.38033  loss:0.30293,stance loss: 0.23778 
Train step: 2730 acc:0.93427 total_loss: 0.39697  loss:0.3205,stance loss: 0.2769 
Train step: 2740 acc:0.93199 total_loss: 0.40525  loss:0.24471,stance loss: 0.22119 
Train step: 2750 acc:0.92869 total_loss: 0.42334  loss:0.32859,stance loss: 0.22177 
Train step: 2760 acc:0.9233 total_loss: 0.42969  loss:0.29393,stance loss: 0.23472 
Train step: 2770 acc:0.92156 total_loss: 0.4262  loss:0.15528,stance loss: 0.092416 
Train step: 2780 acc:0.92072 total_loss: 0.41727  loss:0.23343,stance loss: 0.068668 
Better F1! Saving model!
Saving model of best f1: 0.5684521200432483
              precision    recall  f1-score   support

           0   0.669794  0.631858  0.650273       565
           1   0.587500  0.550781  0.568548       256
           2   0.431280  0.558282  0.486631       163

    accuracy                       0.598577       984
   macro avg   0.562858  0.580307  0.568484       984
weighted avg   0.608874  0.598577  0.601904       984

Test Acc: 0.5985772357723578 F1_ma:0.5684521200432483
Train step: 2790 acc:0.9179 total_loss: 0.42725  loss:0.56024,stance loss: 0.43365 
Train step: 2800 acc:0.91797 total_loss: 0.42322  loss:0.31813,stance loss: 0.26643 
Train step: 2810 acc:0.91848 total_loss: 0.4233  loss:0.31682,stance loss: 0.23577 
Train step: 2820 acc:0.92103 total_loss: 0.42302  loss:0.35627,stance loss: 0.30781 
Train step: 2830 acc:0.92168 total_loss: 0.422  loss:0.059394,stance loss: 0.015001 
Train step: 2840 acc:0.92076 total_loss: 0.42056  loss:0.39043,stance loss: 0.27524 
Train step: 2850 acc:0.92275 total_loss: 0.41594  loss:0.34133,stance loss: 0.26138 
Train step: 2860 acc:0.9232 total_loss: 0.41604  loss:0.52307,stance loss: 0.37073 
Train step: 2870 acc:0.92393 total_loss: 0.4173  loss:0.32372,stance loss: 0.3011 
Train step: 2880 acc:0.92368 total_loss: 0.41392  loss:0.17401,stance loss: 0.15542 
Train step: 2890 acc:0.92144 total_loss: 0.41608  loss:0.79277,stance loss: 0.58642 
Train step: 2900 acc:0.92105 total_loss: 0.41604  loss:0.32638,stance loss: 0.26397 
Train step: 2910 acc:0.92069 total_loss: 0.41417  loss:0.26244,stance loss: 0.14827 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2920 acc:0.95 total_loss: 0.2692  loss:0.14226,stance loss: 0.083623 
Train step: 2930 acc:0.9125 total_loss: 0.41979  loss:0.085082,stance loss: 0.024217 
Train step: 2940 acc:0.9375 total_loss: 0.3713  loss:0.11848,stance loss: 0.060976 
Train step: 2950 acc:0.94107 total_loss: 0.36601  loss:0.31979,stance loss: 0.23315 
Train step: 2960 acc:0.94306 total_loss: 0.34347  loss:0.60838,stance loss: 1.0241 
Train step: 2970 acc:0.93977 total_loss: 0.35132  loss:0.18997,stance loss: 0.065012 
Train step: 2980 acc:0.94423 total_loss: 0.34202  loss:0.8872,stance loss: 1.1029 
Train step: 2990 acc:0.94167 total_loss: 0.34403  loss:0.31271,stance loss: 0.28724 
Train step: 3000 acc:0.94118 total_loss: 0.34163  loss:0.72519,stance loss: 0.68069 
Train step: 3010 acc:0.94276 total_loss: 0.33484  loss:0.1291,stance loss: 0.038122 
Train step: 3020 acc:0.94048 total_loss: 0.33864  loss:0.76068,stance loss: 1.2013 
Train step: 3030 acc:0.93804 total_loss: 0.34605  loss:0.33562,stance loss: 0.38817 
Train step: 3040 acc:0.9365 total_loss: 0.34834  loss:0.23478,stance loss: 0.18536 
Train step: 3050 acc:0.93657 total_loss: 0.34946  loss:0.39501,stance loss: 0.29378 
Train step: 3060 acc:0.93707 total_loss: 0.34595  loss:0.11925,stance loss: 0.079375 
Train step: 3070 acc:0.9371 total_loss: 0.34919  loss:0.21553,stance loss: 0.061505 
Train step: 3080 acc:0.93788 total_loss: 0.35008  loss:0.15815,stance loss: 0.15283 
Train step: 3090 acc:0.93929 total_loss: 0.34659  loss:0.47227,stance loss: 0.40466 
Train step: 3100 acc:0.93919 total_loss: 0.34335  loss:0.28171,stance loss: 0.1938 
Train step: 3110 acc:0.93846 total_loss: 0.34874  loss:0.39927,stance loss: 0.32374 
Train step: 3120 acc:0.93872 total_loss: 0.34756  loss:0.073816,stance loss: 0.02966 
Train step: 3130 acc:0.93895 total_loss: 0.34417  loss:0.13885,stance loss: 0.077854 
Train step: 3140 acc:0.94056 total_loss: 0.33919  loss:0.89855,stance loss: 1.3698 
Train step: 3150 acc:0.94149 total_loss: 0.33677  loss:0.30382,stance loss: 0.27024 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3160 acc:0.90625 total_loss: 0.22978  loss:0.19101,stance loss: 0.042664 
Train step: 3170 acc:0.93229 total_loss: 0.27695  loss:0.37074,stance loss: 0.24491 
Train step: 3180 acc:0.9375 total_loss: 0.28574  loss:0.48298,stance loss: 0.42014 
Train step: 3190 acc:0.93359 total_loss: 0.32318  loss:0.41919,stance loss: 0.36096 
Train step: 3200 acc:0.9375 total_loss: 0.35548  loss:1.0608,stance loss: 2.0183 
Train step: 3210 acc:0.94231 total_loss: 0.32815  loss:0.63225,stance loss: 1.035 
Train step: 3220 acc:0.94556 total_loss: 0.31986  loss:0.048594,stance loss: 0.018412 
Train step: 3230 acc:0.94792 total_loss: 0.31187  loss:0.12455,stance loss: 0.093974 
Train step: 3240 acc:0.94893 total_loss: 0.31775  loss:0.085572,stance loss: 0.043077 
Train step: 3250 acc:0.95041 total_loss: 0.31023  loss:0.050467,stance loss: 0.016501 
Train step: 3260 acc:0.95098 total_loss: 0.3063  loss:0.52597,stance loss: 0.45753 
Train step: 3270 acc:0.95145 total_loss: 0.30289  loss:0.35178,stance loss: 0.33981 
Train step: 3280 acc:0.9498 total_loss: 0.30254  loss:0.36369,stance loss: 0.28691 
Train step: 3290 acc:0.95028 total_loss: 0.3008  loss:0.47824,stance loss: 0.33456 
Train step: 3300 acc:0.9507 total_loss: 0.30591  loss:0.11191,stance loss: 0.052616 
Train step: 3310 acc:0.95148 total_loss: 0.30252  loss:0.18412,stance loss: 0.028756 
Train step: 3320 acc:0.95177 total_loss: 0.29922  loss:0.19079,stance loss: 0.032338 
Train step: 3330 acc:0.95094 total_loss: 0.29603  loss:0.2424,stance loss: 0.16629 
Train step: 3340 acc:0.95124 total_loss: 0.29706  loss:0.28159,stance loss: 0.35576 
Train step: 3350 acc:0.95182 total_loss: 0.29536  loss:0.077994,stance loss: 0.02973 
Train step: 3360 acc:0.9508 total_loss: 0.29762  loss:0.051462,stance loss: 0.0046877 
Train step: 3370 acc:0.95136 total_loss: 0.30133  loss:0.99177,stance loss: 1.254 
Train step: 3380 acc:0.9513 total_loss: 0.30199  loss:0.060492,stance loss: 0.016589 
Train step: 3390 acc:0.95043 total_loss: 0.30049  loss:0.082154,stance loss: 0.041016 
Train step: 3400 acc:0.95093 total_loss: 0.29556  loss:0.12021,stance loss: 0.06623 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3410 acc:0.94444 total_loss: 0.29909  loss:0.27538,stance loss: 0.2652 
Train step: 3420 acc:0.95066 total_loss: 0.29876  loss:0.27468,stance loss: 0.17095 
Train step: 3430 acc:0.9569 total_loss: 0.26411  loss:0.14679,stance loss: 0.11699 
Train step: 3440 acc:0.96154 total_loss: 0.25681  loss:0.036965,stance loss: 0.0035567 
Train step: 3450 acc:0.95663 total_loss: 0.27664  loss:0.6053,stance loss: 0.37868 
Train step: 3460 acc:0.95869 total_loss: 0.27165  loss:0.48299,stance loss: 0.37458 
Train step: 3470 acc:0.96014 total_loss: 0.25643  loss:0.081706,stance loss: 0.02066 
Train step: 3480 acc:0.96282 total_loss: 0.24155  loss:0.065176,stance loss: 0.034438 
Train step: 3490 acc:0.96208 total_loss: 0.23115  loss:0.47914,stance loss: 0.56948 
Train step: 3500 acc:0.96528 total_loss: 0.22573  loss:0.090973,stance loss: 0.045412 
Train step: 3510 acc:0.96674 total_loss: 0.21554  loss:0.027545,stance loss: 0.00093306 
Train step: 3520 acc:0.96691 total_loss: 0.21119  loss:0.037993,stance loss: 0.0033796 
Train step: 3530 acc:0.96609 total_loss: 0.2151  loss:0.10545,stance loss: 0.085449 
Train step: 3540 acc:0.96493 total_loss: 0.22426  loss:0.086301,stance loss: 0.033232 
Train step: 3550 acc:0.96602 total_loss: 0.21861  loss:0.094863,stance loss: 0.042261 
Train step: 3560 acc:0.9658 total_loss: 0.2184  loss:0.079379,stance loss: 0.027873 
Train step: 3570 acc:0.96672 total_loss: 0.21879  loss:0.28186,stance loss: 0.12452 
Train step: 3580 acc:0.96683 total_loss: 0.21891  loss:0.2868,stance loss: 0.23595 
Train step: 3590 acc:0.96627 total_loss: 0.22144  loss:0.27065,stance loss: 0.23161 
Train step: 3600 acc:0.9642 total_loss: 0.22887  loss:1.3661,stance loss: 1.8737 
Train step: 3610 acc:0.96471 total_loss: 0.22779  loss:0.093754,stance loss: 0.074199 
Train step: 3620 acc:0.96376 total_loss: 0.23603  loss:1.0407,stance loss: 0.8082 
Train step: 3630 acc:0.96261 total_loss: 0.23556  loss:0.090348,stance loss: 0.054507 
Train step: 3640 acc:0.96182 total_loss: 0.23912  loss:0.099728,stance loss: 0.086168 
Training finished.


Reload the best model with best f1 0.5684521200432483 from path test_outputs/bert-cross-topic/hc/2023-08-16 16-28-44/state_dict


              precision    recall  f1-score   support

           0   0.669794  0.631858  0.650273       565
           1   0.587500  0.550781  0.568548       256
           2   0.431280  0.558282  0.486631       163

    accuracy                       0.598577       984
   macro avg   0.562858  0.580307  0.568484       984
weighted avg   0.608874  0.598577  0.601904       984

Test Acc: 0.5985772357723578 F1_ma:0.5684521200432483
Test dataset: hc
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5684521200432483
acc: 0.5985772357723578, f1 :0.5684842090610903
classification report: 
              precision    recall  f1-score   support

         Con     0.6698    0.6319    0.6503       565
        None     0.5875    0.5508    0.5685       256
         Pro     0.4313    0.5583    0.4866       163

    accuracy                         0.5986       984
   macro avg     0.5629    0.5803    0.5685       984
weighted avg     0.6089    0.5986    0.6019       984

