run_semeval with seed: 31546
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 13-46-56', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31546, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 13-46-56
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.8619  loss:1.8619,stance loss: 1.2168 
Train step: 10 acc:0.25568 total_loss: 1.8788  loss:1.8753,stance loss: 1.0582 
Train step: 20 acc:0.26488 total_loss: 1.8407  loss:1.6783,stance loss: 1.005 
Train step: 30 acc:0.30444 total_loss: 1.8099  loss:1.6981,stance loss: 1.1017 
Train step: 40 acc:0.28963 total_loss: 1.8018  loss:1.6436,stance loss: 1.1287 
Better F1! Saving model!
Saving model of best f1: 0.0019493177387914231
              precision    recall  f1-score   support

           0   0.500000  0.001957  0.003899       511
           1   0.178458  0.994118  0.302596       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.179136       949
   macro avg   0.226153  0.332025  0.102165       949
weighted avg   0.301199  0.179136  0.056305       949

Test Acc: 0.1791359325605901 F1_ma:0.0019493177387914231
Train step: 50 acc:0.28676 total_loss: 1.7796  loss:1.6683,stance loss: 1.1396 
Better F1! Saving model!
Saving model of best f1: 0.2682333873581848
              precision    recall  f1-score   support

           0   0.457815  0.647750  0.536467       511
           1   0.017699  0.023529  0.020202       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.353003       949
   macro avg   0.158505  0.223760  0.185556       949
weighted avg   0.249686  0.353003  0.292486       949

Test Acc: 0.3530031612223393 F1_ma:0.2682333873581848
Train step: 60 acc:0.30635 total_loss: 1.7621  loss:1.7702,stance loss: 1.1203 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 70 acc:0.32394 total_loss: 1.7463  loss:1.6704,stance loss: 1.5335 
Train step: 80 acc:0.3341 total_loss: 1.7294  loss:1.5997,stance loss: 1.1051 
Train step: 90 acc:0.3489 total_loss: 1.716  loss:1.6077,stance loss: 1.1425 
Train step: 100 acc:0.35829 total_loss: 1.7119  loss:1.7828,stance loss: 1.2327 
Train step: 110 acc:0.37444 total_loss: 1.7076  loss:1.3631,stance loss: 0.92656 
Train step: 120 acc:0.37965 total_loss: 1.7037  loss:1.6642,stance loss: 1.2216 
Train step: 130 acc:0.3874 total_loss: 1.7054  loss:1.6001,stance loss: 1.1635 
Train step: 140 acc:0.39628 total_loss: 1.7029  loss:1.5984,stance loss: 1.4095 
Train step: 150 acc:0.39901 total_loss: 1.7005  loss:1.7518,stance loss: 1.1528 
Train step: 160 acc:0.40839 total_loss: 1.6925  loss:1.5609,stance loss: 1.1335 
Train step: 170 acc:0.41192 total_loss: 1.6894  loss:1.6896,stance loss: 1.2636 
Train step: 180 acc:0.41747 total_loss: 1.681  loss:1.4517,stance loss: 0.96767 
Train step: 190 acc:0.41754 total_loss: 1.6771  loss:1.5171,stance loss: 0.93725 
Train step: 200 acc:0.42289 total_loss: 1.6681  loss:1.4364,stance loss: 0.92023 
Train step: 210 acc:0.42476 total_loss: 1.6665  loss:1.4503,stance loss: 0.98493 
Train step: 220 acc:0.42958 total_loss: 1.6626  loss:1.9449,stance loss: 1.855 
Train step: 230 acc:0.43561 total_loss: 1.6552  loss:1.3744,stance loss: 0.93431 
Train step: 240 acc:0.43828 total_loss: 1.6543  loss:1.7125,stance loss: 1.3422 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.47917 total_loss: 1.641  loss:1.6056,stance loss: 1.2185 
Train step: 260 acc:0.52734 total_loss: 1.6167  loss:1.7954,stance loss: 1.7429 
Train step: 270 acc:0.53606 total_loss: 1.5944  loss:1.615,stance loss: 1.1592 
Train step: 280 acc:0.52604 total_loss: 1.5779  loss:1.5851,stance loss: 1.1239 
Train step: 290 acc:0.53804 total_loss: 1.5635  loss:1.3715,stance loss: 0.9111 
Train step: 300 acc:0.54688 total_loss: 1.5461  loss:1.3415,stance loss: 0.92394 
Train step: 310 acc:0.55587 total_loss: 1.5321  loss:1.2165,stance loss: 0.89 
Train step: 320 acc:0.55345 total_loss: 1.5246  loss:1.4069,stance loss: 1.0148 
Train step: 330 acc:0.55814 total_loss: 1.5128  loss:1.5251,stance loss: 1.053 
Train step: 340 acc:0.55534 total_loss: 1.5084  loss:1.6372,stance loss: 1.2235 
Better F1! Saving model!
Saving model of best f1: 0.35003431708991073
              precision    recall  f1-score   support

           0   0.539112  0.998043  0.700069       511
           1   0.666667  0.011765  0.023121       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.539515       949
   macro avg   0.401926  0.336603  0.241063       949
weighted avg   0.409715  0.539515  0.381102       949

Test Acc: 0.5395152792413066 F1_ma:0.35003431708991073
Train step: 350 acc:0.55601 total_loss: 1.4997  loss:1.1805,stance loss: 0.79048 
Better F1! Saving model!
Saving model of best f1: 0.3500687757909216
              precision    recall  f1-score   support

           0   0.539767  0.996086  0.700138       511
           1   0.666667  0.023529  0.045455       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.540569       949
   macro avg   0.402144  0.339872  0.248531       949
weighted avg   0.410068  0.540569  0.385140       949

Test Acc: 0.5405690200210748 F1_ma:0.3500687757909216
Train step: 360 acc:0.56088 total_loss: 1.488  loss:1.4493,stance loss: 1.2162 
Train step: 370 acc:0.56002 total_loss: 1.482  loss:1.6407,stance loss: 1.71 
Train step: 380 acc:0.56066 total_loss: 1.4714  loss:1.1281,stance loss: 0.72834 
Train step: 390 acc:0.56464 total_loss: 1.4661  loss:1.5645,stance loss: 1.1375 
Better F1! Saving model!
Saving model of best f1: 0.35232067510548526
              precision    recall  f1-score   support

           0   0.549945  0.980431  0.704641       511
           1   0.578947  0.129412  0.211538       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.551106       949
   macro avg   0.376297  0.369947  0.305393       949
weighted avg   0.399835  0.551106  0.417316       949

Test Acc: 0.5511064278187566 F1_ma:0.35232067510548526
Train step: 400 acc:0.5649 total_loss: 1.4679  loss:1.5904,stance loss: 1.1757 
Train step: 410 acc:0.56589 total_loss: 1.4624  loss:1.5008,stance loss: 1.402 
Train step: 420 acc:0.56534 total_loss: 1.4565  loss:1.1562,stance loss: 0.82193 
Better F1! Saving model!
Saving model of best f1: 0.3553412462908012
              precision    recall  f1-score   support

           0   0.572282  0.937378  0.710682       511
           1   0.589286  0.388235  0.468085       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.574289       949
   macro avg   0.387189  0.441871  0.392923       949
weighted avg   0.413714  0.574289  0.466526       949

Test Acc: 0.5742887249736565 F1_ma:0.3553412462908012
Train step: 430 acc:0.56855 total_loss: 1.4555  loss:1.4128,stance loss: 1.1424 
Train step: 440 acc:0.57143 total_loss: 1.4535  loss:1.6658,stance loss: 1.3564 
Train step: 450 acc:0.57797 total_loss: 1.4464  loss:1.1345,stance loss: 0.79415 
Better F1! Saving model!
Saving model of best f1: 0.3555062823355506
              precision    recall  f1-score   support

           0   0.571259  0.941292  0.711013       511
           1   0.579439  0.364706  0.447653       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.572181       949
   macro avg   0.383566  0.435332  0.386222       949
weighted avg   0.411399  0.572181  0.463044       949

Test Acc: 0.5721812434141201 F1_ma:0.3555062823355506
Train step: 460 acc:0.58247 total_loss: 1.4411  loss:1.4862,stance loss: 1.5734 
Train step: 470 acc:0.58296 total_loss: 1.4385  loss:1.2919,stance loss: 1.0713 
Train step: 480 acc:0.58792 total_loss: 1.4294  loss:1.1753,stance loss: 0.68689 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.75 total_loss: 1.1736  loss:1.1736,stance loss: 0.9054 
Train step: 500 acc:0.63636 total_loss: 1.3805  loss:1.4854,stance loss: 1.5196 
Train step: 510 acc:0.63393 total_loss: 1.3541  loss:1.3097,stance loss: 0.91043 
Train step: 520 acc:0.65323 total_loss: 1.3354  loss:1.3875,stance loss: 0.9358 
Train step: 530 acc:0.62805 total_loss: 1.3694  loss:1.1494,stance loss: 0.80027 
Train step: 540 acc:0.62868 total_loss: 1.3611  loss:1.2377,stance loss: 0.76378 
Train step: 550 acc:0.63422 total_loss: 1.3517  loss:1.5205,stance loss: 1.5133 
Train step: 560 acc:0.64965 total_loss: 1.3279  loss:1.6631,stance loss: 1.6637 
Train step: 570 acc:0.65201 total_loss: 1.3278  loss:1.3244,stance loss: 1.2992 
Train step: 580 acc:0.65591 total_loss: 1.3059  loss:1.2444,stance loss: 0.91294 
Train step: 590 acc:0.65842 total_loss: 1.3035  loss:1.1119,stance loss: 0.72795 
Better F1! Saving model!
Saving model of best f1: 0.3566121842496285
              precision    recall  f1-score   support

           0   0.574850  0.939335  0.713224       511
           1   0.605263  0.405882  0.485915       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.578504       949
   macro avg   0.393371  0.448406  0.399713       949
weighted avg   0.417959  0.578504  0.471089       949

Test Acc: 0.5785036880927292 F1_ma:0.3566121842496285
Train step: 600 acc:0.65315 total_loss: 1.3017  loss:1.3323,stance loss: 0.93302 
Better F1! Saving model!
Saving model of best f1: 0.35724637681159416
              precision    recall  f1-score   support

           0   0.567319  0.964775  0.714493       511
           1   0.650000  0.305882  0.416000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.574289       949
   macro avg   0.405773  0.423552  0.376831       949
weighted avg   0.421918  0.574289  0.459247       949

Test Acc: 0.5742887249736565 F1_ma:0.35724637681159416
Train step: 610 acc:0.65444 total_loss: 1.2936  loss:1.664,stance loss: 1.441 
Train step: 620 acc:0.65744 total_loss: 1.2835  loss:0.95195,stance loss: 0.75744 
Train step: 630 acc:0.65824 total_loss: 1.2905  loss:1.2135,stance loss: 0.91377 
Train step: 640 acc:0.65811 total_loss: 1.296  loss:1.3539,stance loss: 1.2744 
Train step: 650 acc:0.6611 total_loss: 1.2906  loss:1.5018,stance loss: 1.1048 
Better F1! Saving model!
Saving model of best f1: 0.35855988243938275
              precision    recall  f1-score   support

           0   0.574118  0.954990  0.717120       511
           1   0.656566  0.382353  0.483271       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.582719       949
   macro avg   0.410228  0.445781  0.400130       949
weighted avg   0.426755  0.582719  0.472713       949

Test Acc: 0.5827186512118019 F1_ma:0.35855988243938275
Train step: 660 acc:0.66411 total_loss: 1.2802  loss:0.9672,stance loss: 0.69888 
Train step: 670 acc:0.66644 total_loss: 1.2727  loss:0.92312,stance loss: 0.77082 
Train step: 680 acc:0.66656 total_loss: 1.2707  loss:0.73202,stance loss: 0.37423 
Train step: 690 acc:0.6648 total_loss: 1.2696  loss:1.1663,stance loss: 0.88066 
Train step: 700 acc:0.6641 total_loss: 1.2685  loss:1.4728,stance loss: 1.1327 
Train step: 710 acc:0.66488 total_loss: 1.2671  loss:1.0758,stance loss: 0.82706 
Train step: 720 acc:0.66558 total_loss: 1.2636  loss:0.98737,stance loss: 0.77835 
Train step: 730 acc:0.66753 total_loss: 1.2612  loss:1.454,stance loss: 1.3038 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.65625 total_loss: 1.2066  loss:1.1475,stance loss: 0.76629 
Train step: 750 acc:0.68359 total_loss: 1.166  loss:1.1701,stance loss: 0.87763 
Train step: 760 acc:0.68269 total_loss: 1.1781  loss:1.486,stance loss: 1.5631 
Train step: 770 acc:0.67535 total_loss: 1.1897  loss:0.96554,stance loss: 0.63068 
Train step: 780 acc:0.69701 total_loss: 1.1754  loss:1.3332,stance loss: 1.027 
Train step: 790 acc:0.69643 total_loss: 1.16  loss:1.3787,stance loss: 1.1799 
Train step: 800 acc:0.69413 total_loss: 1.1637  loss:0.67322,stance loss: 0.388 
Train step: 810 acc:0.68997 total_loss: 1.1581  loss:1.5822,stance loss: 1.2277 
Train step: 820 acc:0.69331 total_loss: 1.1491  loss:1.3583,stance loss: 1.4033 
Train step: 830 acc:0.6888 total_loss: 1.166  loss:1.2881,stance loss: 1.0479 
Train step: 840 acc:0.6875 total_loss: 1.1697  loss:1.3873,stance loss: 1.1113 
Better F1! Saving model!
Saving model of best f1: 0.38432508068799287
              precision    recall  f1-score   support

           0   0.581259  0.776908  0.664992       511
           1   0.529126  0.641176  0.579787       170
           2   0.283333  0.063433  0.103659       268

    accuracy                       0.551106       949
   macro avg   0.464573  0.493839  0.449479       949
weighted avg   0.487785  0.551106  0.491207       949

Test Acc: 0.5511064278187566 F1_ma:0.38432508068799287
Train step: 850 acc:0.68912 total_loss: 1.1682  loss:0.78155,stance loss: 0.34495 
Train step: 860 acc:0.6875 total_loss: 1.1628  loss:1.2218,stance loss: 1.1559 
Train step: 870 acc:0.68842 total_loss: 1.1612  loss:1.4516,stance loss: 0.90339 
Train step: 880 acc:0.68964 total_loss: 1.1542  loss:0.95208,stance loss: 0.67743 
Train step: 890 acc:0.6847 total_loss: 1.159  loss:1.7321,stance loss: 1.8573 
Train step: 900 acc:0.68712 total_loss: 1.1555  loss:0.88052,stance loss: 0.64835 
Train step: 910 acc:0.68821 total_loss: 1.1569  loss:1.0756,stance loss: 0.87495 
Train step: 920 acc:0.68851 total_loss: 1.1601  loss:1.3077,stance loss: 1.0667 
Train step: 930 acc:0.68878 total_loss: 1.1581  loss:1.0029,stance loss: 0.75486 
Train step: 940 acc:0.68993 total_loss: 1.1562  loss:1.4471,stance loss: 1.1466 
Train step: 950 acc:0.68981 total_loss: 1.1602  loss:1.4785,stance loss: 1.3813 
Train step: 960 acc:0.69192 total_loss: 1.158  loss:1.0599,stance loss: 0.8984 
Better F1! Saving model!
Saving model of best f1: 0.38726941031873324
              precision    recall  f1-score   support

           0   0.596125  0.782779  0.676819       511
           1   0.502092  0.705882  0.586797       170
           2   0.384615  0.055970  0.097720       268

    accuracy                       0.563751       949
   macro avg   0.494278  0.514877  0.453779       949
weighted avg   0.519550  0.563751  0.497154       949

Test Acc: 0.5637513171759747 F1_ma:0.38726941031873324
Train step: 970 acc:0.69253 total_loss: 1.154  loss:1.256,stance loss: 1.0022 
Better F1! Saving model!
Saving model of best f1: 0.40740691443342053
              precision    recall  f1-score   support

           0   0.599693  0.765166  0.672399       511
           1   0.495868  0.705882  0.582524       170
           2   0.418182  0.085821  0.142415       268

    accuracy                       0.562698       949
   macro avg   0.504581  0.518957  0.465779       949
weighted avg   0.529835  0.562698  0.506630       949

Test Acc: 0.5626975763962065 F1_ma:0.40740691443342053
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.8125 total_loss: 0.67257  loss:0.67257,stance loss: 0.46059 
Train step: 990 acc:0.71591 total_loss: 1.0212  loss:0.84984,stance loss: 0.73459 
Train step: 1000 acc:0.71726 total_loss: 1.0793  loss:1.0696,stance loss: 1.0439 
Train step: 1010 acc:0.70565 total_loss: 1.0567  loss:0.94292,stance loss: 0.60217 
Train step: 1020 acc:0.71494 total_loss: 1.051  loss:1.5934,stance loss: 1.4823 
Train step: 1030 acc:0.71324 total_loss: 1.0701  loss:1.0102,stance loss: 0.77386 
Train step: 1040 acc:0.71619 total_loss: 1.0788  loss:1.0571,stance loss: 0.90696 
Better F1! Saving model!
Saving model of best f1: 0.42505043043441204
              precision    recall  f1-score   support

           0   0.586314  0.737769  0.653380       511
           1   0.519231  0.635294  0.571429       170
           2   0.367347  0.134328  0.196721       268

    accuracy                       0.548999       949
   macro avg   0.490964  0.502464  0.473843       949
weighted avg   0.512460  0.548999  0.509738       949

Test Acc: 0.5489989462592202 F1_ma:0.42505043043441204
Train step: 1050 acc:0.71127 total_loss: 1.0765  loss:1.2474,stance loss: 0.58429 
Better F1! Saving model!
Saving model of best f1: 0.44603925100379005
              precision    recall  f1-score   support

           0   0.566613  0.690802  0.622575       511
           1   0.508772  0.511765  0.510264       170
           2   0.367742  0.212687  0.269504       268

    accuracy                       0.523709       949
   macro avg   0.481042  0.471751  0.467447       949
weighted avg   0.500090  0.523709  0.502748       949

Test Acc: 0.523709167544784 F1_ma:0.44603925100379005
Train step: 1060 acc:0.71759 total_loss: 1.0666  loss:1.2962,stance loss: 0.99502 
Train step: 1070 acc:0.71223 total_loss: 1.0812  loss:1.0918,stance loss: 0.62302 
Train step: 1080 acc:0.71163 total_loss: 1.0799  loss:0.87099,stance loss: 0.76792 
Train step: 1090 acc:0.71678 total_loss: 1.0767  loss:1.0412,stance loss: 0.74909 
Train step: 1100 acc:0.71643 total_loss: 1.0869  loss:1.2969,stance loss: 1.6075 
Train step: 1110 acc:0.71279 total_loss: 1.0859  loss:0.91308,stance loss: 0.41653 
Train step: 1120 acc:0.7141 total_loss: 1.0798  loss:1.1417,stance loss: 0.89883 
Train step: 1130 acc:0.71068 total_loss: 1.0843  loss:0.93846,stance loss: 0.85154 
Train step: 1140 acc:0.71196 total_loss: 1.0814  loss:0.88984,stance loss: 0.73818 
Train step: 1150 acc:0.71418 total_loss: 1.0821  loss:1.1484,stance loss: 1.0223 
Train step: 1160 acc:0.71547 total_loss: 1.0752  loss:1.1993,stance loss: 0.89825 
Train step: 1170 acc:0.71826 total_loss: 1.0706  loss:1.1781,stance loss: 0.85169 
Train step: 1180 acc:0.71953 total_loss: 1.0678  loss:0.67359,stance loss: 0.53991 
Train step: 1190 acc:0.72393 total_loss: 1.0596  loss:0.78291,stance loss: 0.59052 
Train step: 1200 acc:0.72426 total_loss: 1.0594  loss:1.0465,stance loss: 0.73439 
Train step: 1210 acc:0.72348 total_loss: 1.0623  loss:0.59472,stance loss: 0.26947 
Train step: 1220 acc:0.72303 total_loss: 1.0565  loss:0.8274,stance loss: 0.64745 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 0.883  loss:1.2595,stance loss: 1.0668 
Train step: 1240 acc:0.77344 total_loss: 0.88775  loss:0.57663,stance loss: 0.38812 
Train step: 1250 acc:0.76442 total_loss: 0.90946  loss:0.93234,stance loss: 0.70525 
Train step: 1260 acc:0.75521 total_loss: 0.90765  loss:1.2506,stance loss: 1.0272 
Train step: 1270 acc:0.75 total_loss: 0.95039  loss:0.98623,stance loss: 1.0856 
Train step: 1280 acc:0.75893 total_loss: 0.93011  loss:1.1149,stance loss: 0.82288 
Train step: 1290 acc:0.75284 total_loss: 0.94833  loss:1.1674,stance loss: 0.87965 
Train step: 1300 acc:0.75493 total_loss: 0.95416  loss:0.58724,stance loss: 0.45113 
Train step: 1310 acc:0.7609 total_loss: 0.94683  loss:0.78951,stance loss: 0.62586 
Train step: 1320 acc:0.75781 total_loss: 0.952  loss:1.0654,stance loss: 1.3659 
Train step: 1330 acc:0.74764 total_loss: 0.9749  loss:1.2776,stance loss: 0.85294 
Train step: 1340 acc:0.75431 total_loss: 0.96788  loss:1.1466,stance loss: 0.88461 
Train step: 1350 acc:0.75496 total_loss: 0.96982  loss:1.1849,stance loss: 0.81117 
Train step: 1360 acc:0.75597 total_loss: 0.9643  loss:1.5572,stance loss: 1.4608 
Train step: 1370 acc:0.75685 total_loss: 0.96675  loss:0.76418,stance loss: 0.59313 
Better F1! Saving model!
Saving model of best f1: 0.4470306783000281
              precision    recall  f1-score   support

           0   0.612967  0.610568  0.611765       511
           1   0.479310  0.817647  0.604348       170
           2   0.393333  0.220149  0.282297       268

    accuracy                       0.537408       949
   macro avg   0.495203  0.549455  0.499470       949
weighted avg   0.526999  0.537408  0.517393       949

Test Acc: 0.5374077976817703 F1_ma:0.4470306783000281
Train step: 1380 acc:0.75881 total_loss: 0.96283  loss:0.84867,stance loss: 0.79318 
Train step: 1390 acc:0.75941 total_loss: 0.95361  loss:0.35228,stance loss: 0.22999 
Train step: 1400 acc:0.75852 total_loss: 0.95284  loss:1.3914,stance loss: 0.97863 
Train step: 1410 acc:0.75739 total_loss: 0.95034  loss:1.1356,stance loss: 0.7526 
Train step: 1420 acc:0.75925 total_loss: 0.95119  loss:1.065,stance loss: 0.95559 
Train step: 1430 acc:0.76183 total_loss: 0.94534  loss:1.1865,stance loss: 1.4037 
Train step: 1440 acc:0.76071 total_loss: 0.94509  loss:0.59407,stance loss: 0.28304 
Train step: 1450 acc:0.75857 total_loss: 0.94937  loss:1.0496,stance loss: 0.72794 
Train step: 1460 acc:0.75927 total_loss: 0.95109  loss:1.0532,stance loss: 0.9765 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:1.0 total_loss: 0.59102  loss:0.59102,stance loss: 0.46843 
Train step: 1480 acc:0.79545 total_loss: 0.88148  loss:1.6224,stance loss: 1.3942 
Train step: 1490 acc:0.78274 total_loss: 0.90418  loss:0.63315,stance loss: 0.61829 
Train step: 1500 acc:0.79435 total_loss: 0.87646  loss:0.83295,stance loss: 0.70252 
Train step: 1510 acc:0.79726 total_loss: 0.86508  loss:0.54824,stance loss: 0.23937 
Train step: 1520 acc:0.79289 total_loss: 0.84592  loss:0.62807,stance loss: 0.37193 
Train step: 1530 acc:0.8002 total_loss: 0.84145  loss:0.53157,stance loss: 0.34117 
Train step: 1540 acc:0.79049 total_loss: 0.86359  loss:0.82212,stance loss: 0.63084 
Train step: 1550 acc:0.79167 total_loss: 0.86555  loss:1.2076,stance loss: 1.0391 
Train step: 1560 acc:0.7864 total_loss: 0.86935  loss:1.0202,stance loss: 0.82955 
Better F1! Saving model!
Saving model of best f1: 0.462198360061293
              precision    recall  f1-score   support

           0   0.616412  0.632094  0.624155       511
           1   0.478571  0.788235  0.595556       170
           2   0.427586  0.231343  0.300242       268

    accuracy                       0.546891       949
   macro avg   0.507523  0.550558  0.506651       949
weighted avg   0.538395  0.546891  0.527558       949

Test Acc: 0.5468914646996839 F1_ma:0.462198360061293
Train step: 1570 acc:0.7828 total_loss: 0.87049  loss:0.82296,stance loss: 0.71523 
Train step: 1580 acc:0.78435 total_loss: 0.86364  loss:0.80251,stance loss: 0.70186 
Train step: 1590 acc:0.78512 total_loss: 0.86108  loss:0.61804,stance loss: 0.51352 
Train step: 1600 acc:0.78769 total_loss: 0.85586  loss:1.0814,stance loss: 1.4169 
Train step: 1610 acc:0.78369 total_loss: 0.86631  loss:0.87295,stance loss: 0.58813 
Train step: 1620 acc:0.78394 total_loss: 0.87024  loss:1.5739,stance loss: 1.7776 
Train step: 1630 acc:0.78727 total_loss: 0.86126  loss:0.56515,stance loss: 0.40373 
Train step: 1640 acc:0.78838 total_loss: 0.85964  loss:1.0422,stance loss: 0.91539 
Train step: 1650 acc:0.79006 total_loss: 0.8544  loss:0.79887,stance loss: 0.57795 
Train step: 1660 acc:0.78796 total_loss: 0.86198  loss:1.0117,stance loss: 0.91467 
Train step: 1670 acc:0.78825 total_loss: 0.85974  loss:0.69013,stance loss: 0.69951 
Train step: 1680 acc:0.78821 total_loss: 0.8617  loss:0.63646,stance loss: 0.53739 
Train step: 1690 acc:0.78648 total_loss: 0.8649  loss:1.1856,stance loss: 1.0325 
Train step: 1700 acc:0.78517 total_loss: 0.87092  loss:1.1996,stance loss: 1.4069 
Train step: 1710 acc:0.78475 total_loss: 0.87271  loss:0.74018,stance loss: 0.46332 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.83333 total_loss: 0.837  loss:0.65381,stance loss: 0.30966 
Train step: 1730 acc:0.85547 total_loss: 0.73696  loss:0.42171,stance loss: 0.36736 
Train step: 1740 acc:0.86298 total_loss: 0.68083  loss:0.61676,stance loss: 0.45018 
Train step: 1750 acc:0.85764 total_loss: 0.6786  loss:0.69222,stance loss: 0.5317 
Train step: 1760 acc:0.86549 total_loss: 0.66736  loss:0.2267,stance loss: 0.063153 
Train step: 1770 acc:0.85714 total_loss: 0.68861  loss:0.87327,stance loss: 0.9118 
Train step: 1780 acc:0.84943 total_loss: 0.68632  loss:0.56292,stance loss: 0.30623 
Train step: 1790 acc:0.84539 total_loss: 0.70622  loss:0.5942,stance loss: 0.37826 
Train step: 1800 acc:0.84084 total_loss: 0.72762  loss:0.83699,stance loss: 1.2284 
Train step: 1810 acc:0.83659 total_loss: 0.73826  loss:0.57316,stance loss: 0.39201 
Train step: 1820 acc:0.83608 total_loss: 0.74246  loss:1.0984,stance loss: 0.76236 
Train step: 1830 acc:0.83782 total_loss: 0.73641  loss:0.26723,stance loss: 0.13791 
Train step: 1840 acc:0.8378 total_loss: 0.73061  loss:0.7539,stance loss: 0.69482 
Train step: 1850 acc:0.83594 total_loss: 0.74174  loss:0.89634,stance loss: 0.8041 
Train step: 1860 acc:0.83348 total_loss: 0.74395  loss:0.6768,stance loss: 0.62906 
Train step: 1870 acc:0.83293 total_loss: 0.74832  loss:0.59772,stance loss: 0.43991 
Train step: 1880 acc:0.83095 total_loss: 0.75311  loss:0.53426,stance loss: 0.40587 
Train step: 1890 acc:0.83026 total_loss: 0.74873  loss:0.54998,stance loss: 0.49191 
Train step: 1900 acc:0.82997 total_loss: 0.74721  loss:0.38568,stance loss: 0.15782 
Train step: 1910 acc:0.83195 total_loss: 0.74052  loss:1.0691,stance loss: 0.94648 
Train step: 1920 acc:0.83252 total_loss: 0.73857  loss:0.69096,stance loss: 0.53253 
Train step: 1930 acc:0.83015 total_loss: 0.75282  loss:1.0338,stance loss: 0.95871 
Train step: 1940 acc:0.82854 total_loss: 0.75202  loss:0.78936,stance loss: 0.78191 
Train step: 1950 acc:0.82892 total_loss: 0.74935  loss:0.40976,stance loss: 0.30226 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.8125 total_loss: 0.69347  loss:0.69347,stance loss: 0.52367 
Train step: 1970 acc:0.82386 total_loss: 0.6618  loss:0.78967,stance loss: 0.58712 
Train step: 1980 acc:0.82738 total_loss: 0.62494  loss:0.64734,stance loss: 0.56352 
Train step: 1990 acc:0.83871 total_loss: 0.60121  loss:0.40936,stance loss: 0.28262 
Train step: 2000 acc:0.84756 total_loss: 0.60136  loss:0.41042,stance loss: 0.28914 
Train step: 2010 acc:0.84314 total_loss: 0.62933  loss:0.59687,stance loss: 0.56503 
Train step: 2020 acc:0.84734 total_loss: 0.62044  loss:0.46271,stance loss: 0.38625 
Train step: 2030 acc:0.85211 total_loss: 0.62459  loss:0.39401,stance loss: 0.3433 
Train step: 2040 acc:0.8534 total_loss: 0.62937  loss:0.96589,stance loss: 1.3358 
Train step: 2050 acc:0.84753 total_loss: 0.6434  loss:0.62469,stance loss: 0.54179 
Train step: 2060 acc:0.84592 total_loss: 0.64884  loss:0.95476,stance loss: 0.96107 
Train step: 2070 acc:0.84854 total_loss: 0.6527  loss:0.65271,stance loss: 0.68254 
Train step: 2080 acc:0.84814 total_loss: 0.64957  loss:0.32882,stance loss: 0.21381 
Train step: 2090 acc:0.85019 total_loss: 0.64153  loss:0.55139,stance loss: 0.37985 
Train step: 2100 acc:0.84707 total_loss: 0.647  loss:1.4175,stance loss: 1.3236 
Train step: 2110 acc:0.84644 total_loss: 0.6526  loss:0.53529,stance loss: 0.40254 
Train step: 2120 acc:0.84744 total_loss: 0.65316  loss:0.84571,stance loss: 0.76747 
Train step: 2130 acc:0.84795 total_loss: 0.65189  loss:0.72108,stance loss: 0.49604 
Train step: 2140 acc:0.84876 total_loss: 0.65399  loss:0.56482,stance loss: 0.43329 
Train step: 2150 acc:0.85275 total_loss: 0.64261  loss:0.24559,stance loss: 0.1474 
Train step: 2160 acc:0.85354 total_loss: 0.6481  loss:0.74295,stance loss: 0.692 
Train step: 2170 acc:0.85219 total_loss: 0.6558  loss:1.091,stance loss: 0.73011 
Train step: 2180 acc:0.85096 total_loss: 0.6618  loss:0.68738,stance loss: 0.50939 
Train step: 2190 acc:0.85417 total_loss: 0.65302  loss:0.41693,stance loss: 0.21244 
Train step: 2200 acc:0.85425 total_loss: 0.65006  loss:0.74169,stance loss: 0.63633 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.90625 total_loss: 0.43313  loss:0.64437,stance loss: 0.2932 
Train step: 2220 acc:0.92969 total_loss: 0.36823  loss:0.27774,stance loss: 0.17137 
Train step: 2230 acc:0.92308 total_loss: 0.37743  loss:0.34533,stance loss: 0.26538 
Train step: 2240 acc:0.90799 total_loss: 0.45772  loss:0.51146,stance loss: 0.47135 
Train step: 2250 acc:0.90082 total_loss: 0.49112  loss:1.2951,stance loss: 1.2602 
Train step: 2260 acc:0.90179 total_loss: 0.49754  loss:0.59291,stance loss: 0.44164 
Train step: 2270 acc:0.90057 total_loss: 0.51419  loss:0.28996,stance loss: 0.19903 
Train step: 2280 acc:0.90214 total_loss: 0.51503  loss:0.63085,stance loss: 1.0505 
Train step: 2290 acc:0.89462 total_loss: 0.52091  loss:0.47097,stance loss: 0.35886 
Train step: 2300 acc:0.89062 total_loss: 0.52369  loss:0.44704,stance loss: 0.18778 
Train step: 2310 acc:0.8921 total_loss: 0.51996  loss:0.54648,stance loss: 0.51956 
Train step: 2320 acc:0.89224 total_loss: 0.51814  loss:0.20083,stance loss: 0.074808 
Train step: 2330 acc:0.89137 total_loss: 0.51827  loss:0.26383,stance loss: 0.10931 
Train step: 2340 acc:0.88833 total_loss: 0.5224  loss:0.79381,stance loss: 0.66198 
Train step: 2350 acc:0.88784 total_loss: 0.52212  loss:0.97783,stance loss: 0.9721 
Train step: 2360 acc:0.88502 total_loss: 0.52841  loss:0.64926,stance loss: 0.5966 
Train step: 2370 acc:0.8863 total_loss: 0.5272  loss:0.73702,stance loss: 0.61876 
Train step: 2380 acc:0.8853 total_loss: 0.53269  loss:0.67299,stance loss: 0.75055 
Train step: 2390 acc:0.88441 total_loss: 0.53105  loss:0.49605,stance loss: 0.50167 
Train step: 2400 acc:0.8852 total_loss: 0.52767  loss:0.41536,stance loss: 0.33067 
Train step: 2410 acc:0.88471 total_loss: 0.53036  loss:1.1945,stance loss: 1.0298 
Train step: 2420 acc:0.88397 total_loss: 0.53377  loss:0.75883,stance loss: 0.6342 
Train step: 2430 acc:0.88413 total_loss: 0.53809  loss:0.30835,stance loss: 0.20236 
Train step: 2440 acc:0.88559 total_loss: 0.5342  loss:0.79183,stance loss: 1.0979 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.36923  loss:0.36923,stance loss: 0.23321 
Train step: 2460 acc:0.91477 total_loss: 0.42963  loss:0.23556,stance loss: 0.15069 
Train step: 2470 acc:0.93155 total_loss: 0.42506  loss:0.29806,stance loss: 0.14556 
Train step: 2480 acc:0.92944 total_loss: 0.43318  loss:0.4092,stance loss: 0.26213 
Train step: 2490 acc:0.92378 total_loss: 0.4527  loss:0.39506,stance loss: 0.21616 
Train step: 2500 acc:0.91667 total_loss: 0.47829  loss:0.68717,stance loss: 0.5926 
Train step: 2510 acc:0.90676 total_loss: 0.48597  loss:0.6187,stance loss: 0.36488 
Train step: 2520 acc:0.90757 total_loss: 0.48336  loss:0.26557,stance loss: 0.19238 
Train step: 2530 acc:0.90664 total_loss: 0.47649  loss:0.72084,stance loss: 0.48688 
Train step: 2540 acc:0.91209 total_loss: 0.46278  loss:0.091594,stance loss: 0.017595 
Train step: 2550 acc:0.91089 total_loss: 0.46892  loss:0.18287,stance loss: 0.082708 
Train step: 2560 acc:0.90991 total_loss: 0.46659  loss:0.66256,stance loss: 0.49878 
Train step: 2570 acc:0.90857 total_loss: 0.47619  loss:0.5411,stance loss: 0.55577 
Train step: 2580 acc:0.90887 total_loss: 0.47457  loss:1.0598,stance loss: 1.434 
Train step: 2590 acc:0.9078 total_loss: 0.47724  loss:0.78502,stance loss: 0.73936 
Train step: 2600 acc:0.90687 total_loss: 0.47821  loss:0.20403,stance loss: 0.034483 
Train step: 2610 acc:0.90606 total_loss: 0.48401  loss:0.65114,stance loss: 1.0403 
Train step: 2620 acc:0.90461 total_loss: 0.48819  loss:0.73656,stance loss: 0.50968 
Train step: 2630 acc:0.90608 total_loss: 0.48186  loss:0.26066,stance loss: 0.19879 
Train step: 2640 acc:0.9074 total_loss: 0.47554  loss:0.16126,stance loss: 0.12646 
Train step: 2650 acc:0.90672 total_loss: 0.47534  loss:0.4461,stance loss: 0.41426 
Train step: 2660 acc:0.90581 total_loss: 0.47379  loss:0.23067,stance loss: 0.10279 
Train step: 2670 acc:0.90611 total_loss: 0.47028  loss:0.10646,stance loss: 0.050742 
Train step: 2680 acc:0.90584 total_loss: 0.46612  loss:0.15739,stance loss: 0.082099 
Train step: 2690 acc:0.9056 total_loss: 0.46878  loss:0.22976,stance loss: 0.18357 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.92708 total_loss: 0.33525  loss:0.27165,stance loss: 0.17913 
Train step: 2710 acc:0.92969 total_loss: 0.33231  loss:0.49763,stance loss: 0.42689 
Train step: 2720 acc:0.94471 total_loss: 0.34624  loss:0.16983,stance loss: 0.13134 
Better F1! Saving model!
Saving model of best f1: 0.46882596013612055
              precision    recall  f1-score   support

           0   0.619256  0.553816  0.584711       511
           1   0.436620  0.729412  0.546256       170
           2   0.403846  0.313433  0.352941       268

    accuracy                       0.517387       949
   macro avg   0.486574  0.532220  0.494636       949
weighted avg   0.525707  0.517387  0.512370       949

Test Acc: 0.5173867228661749 F1_ma:0.46882596013612055
Train step: 2730 acc:0.93924 total_loss: 0.351  loss:0.43949,stance loss: 0.39755 
Train step: 2740 acc:0.93478 total_loss: 0.3678  loss:0.16708,stance loss: 0.051453 
Train step: 2750 acc:0.93192 total_loss: 0.36405  loss:0.27215,stance loss: 0.15939 
Train step: 2760 acc:0.93277 total_loss: 0.37017  loss:0.3595,stance loss: 0.27216 
Train step: 2770 acc:0.93339 total_loss: 0.38093  loss:0.58361,stance loss: 0.5146 
Train step: 2780 acc:0.93387 total_loss: 0.39056  loss:1.0295,stance loss: 1.2654 
Train step: 2790 acc:0.93424 total_loss: 0.37976  loss:0.44359,stance loss: 0.37248 
Train step: 2800 acc:0.93396 total_loss: 0.37529  loss:0.34478,stance loss: 0.26994 
Train step: 2810 acc:0.93265 total_loss: 0.38134  loss:0.12254,stance loss: 0.09264 
Train step: 2820 acc:0.93254 total_loss: 0.38417  loss:0.23247,stance loss: 0.12519 
Train step: 2830 acc:0.93107 total_loss: 0.38323  loss:0.23115,stance loss: 0.14992 
Train step: 2840 acc:0.93151 total_loss: 0.37626  loss:0.49857,stance loss: 0.38309 
Train step: 2850 acc:0.93029 total_loss: 0.38507  loss:0.98525,stance loss: 0.88519 
Train step: 2860 acc:0.93035 total_loss: 0.38364  loss:0.17572,stance loss: 0.019878 
Train step: 2870 acc:0.92969 total_loss: 0.38795  loss:0.34199,stance loss: 0.25352 
Train step: 2880 acc:0.93078 total_loss: 0.38297  loss:0.079746,stance loss: 0.02536 
Train step: 2890 acc:0.93017 total_loss: 0.38386  loss:0.20449,stance loss: 0.086809 
Train step: 2900 acc:0.92688 total_loss: 0.39144  loss:0.37774,stance loss: 0.20197 
Better F1! Saving model!
Saving model of best f1: 0.4774203753290626
              precision    recall  f1-score   support

           0   0.591006  0.540117  0.564417       511
           1   0.483092  0.588235  0.530504       170
           2   0.385455  0.395522  0.390424       268

    accuracy                       0.507903       949
   macro avg   0.486518  0.507958  0.495115       949
weighted avg   0.513627  0.507903  0.509206       949

Test Acc: 0.5079030558482613 F1_ma:0.4774203753290626
Train step: 2910 acc:0.92766 total_loss: 0.39011  loss:0.64872,stance loss: 1.0287 
Train step: 2920 acc:0.92948 total_loss: 0.38253  loss:0.15845,stance loss: 0.08441 
Train step: 2930 acc:0.93061 total_loss: 0.37881  loss:0.67765,stance loss: 1.1213 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.24693  loss:0.24693,stance loss: 0.31212 
Train step: 2950 acc:0.96591 total_loss: 0.31638  loss:0.10828,stance loss: 0.041268 
Train step: 2960 acc:0.96131 total_loss: 0.3163  loss:0.86493,stance loss: 0.47347 
Train step: 2970 acc:0.95968 total_loss: 0.30293  loss:0.70914,stance loss: 0.59234 
Train step: 2980 acc:0.95274 total_loss: 0.2903  loss:0.2561,stance loss: 0.19605 
Train step: 2990 acc:0.95466 total_loss: 0.31969  loss:0.099702,stance loss: 0.022561 
Train step: 3000 acc:0.9498 total_loss: 0.32943  loss:0.26388,stance loss: 0.11299 
Train step: 3010 acc:0.94982 total_loss: 0.32444  loss:0.14837,stance loss: 0.11257 
Train step: 3020 acc:0.95139 total_loss: 0.30932  loss:0.11112,stance loss: 0.088254 
Train step: 3030 acc:0.94574 total_loss: 0.32035  loss:0.5845,stance loss: 0.47917 
Train step: 3040 acc:0.94616 total_loss: 0.31497  loss:0.082953,stance loss: 0.0028314 
Train step: 3050 acc:0.94538 total_loss: 0.31616  loss:0.20743,stance loss: 0.14672 
Train step: 3060 acc:0.94421 total_loss: 0.31987  loss:0.12015,stance loss: 0.066693 
Train step: 3070 acc:0.94323 total_loss: 0.32253  loss:0.21782,stance loss: 0.16272 
Train step: 3080 acc:0.94282 total_loss: 0.3251  loss:0.12395,stance loss: 0.045234 
Train step: 3090 acc:0.94247 total_loss: 0.33028  loss:0.6244,stance loss: 1.0562 
Train step: 3100 acc:0.94255 total_loss: 0.33437  loss:0.12553,stance loss: 0.059128 
Train step: 3110 acc:0.94225 total_loss: 0.34041  loss:0.61544,stance loss: 1.0179 
Train step: 3120 acc:0.94337 total_loss: 0.3359  loss:0.2094,stance loss: 0.17262 
Train step: 3130 acc:0.94404 total_loss: 0.32917  loss:0.098124,stance loss: 0.042671 
Train step: 3140 acc:0.94434 total_loss: 0.3233  loss:0.082137,stance loss: 0.022496 
Train step: 3150 acc:0.94431 total_loss: 0.32342  loss:0.083374,stance loss: 0.04022 
Train step: 3160 acc:0.94429 total_loss: 0.31947  loss:0.48547,stance loss: 0.34913 
Train step: 3170 acc:0.94399 total_loss: 0.32177  loss:0.03544,stance loss: 0.0019816 
Train step: 3180 acc:0.94372 total_loss: 0.32433  loss:0.096445,stance loss: 0.023592 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.96875 total_loss: 0.24007  loss:0.35599,stance loss: 0.42561 
Train step: 3200 acc:0.96484 total_loss: 0.34903  loss:0.79454,stance loss: 1.2053 
Train step: 3210 acc:0.95433 total_loss: 0.33964  loss:0.14646,stance loss: 0.07571 
Train step: 3220 acc:0.95139 total_loss: 0.34093  loss:0.74775,stance loss: 1.0654 
Train step: 3230 acc:0.94973 total_loss: 0.34422  loss:0.45521,stance loss: 0.40018 
Train step: 3240 acc:0.95312 total_loss: 0.33115  loss:0.18063,stance loss: 0.16659 
Train step: 3250 acc:0.95455 total_loss: 0.31197  loss:0.1251,stance loss: 0.0665 
Train step: 3260 acc:0.95477 total_loss: 0.2995  loss:0.057227,stance loss: 0.017436 
Train step: 3270 acc:0.95712 total_loss: 0.29025  loss:0.14119,stance loss: 0.13676 
Train step: 3280 acc:0.95898 total_loss: 0.27938  loss:0.28457,stance loss: 0.23818 
Train step: 3290 acc:0.95637 total_loss: 0.28173  loss:0.88417,stance loss: 1.1891 
Train step: 3300 acc:0.9542 total_loss: 0.2811  loss:0.47163,stance loss: 0.37611 
Train step: 3310 acc:0.95387 total_loss: 0.27792  loss:0.055238,stance loss: 0.0098555 
Train step: 3320 acc:0.95267 total_loss: 0.28105  loss:0.35956,stance loss: 0.29631 
Train step: 3330 acc:0.95163 total_loss: 0.28419  loss:0.32875,stance loss: 0.19536 
Train step: 3340 acc:0.95152 total_loss: 0.2813  loss:0.57753,stance loss: 1.0403 
Train step: 3350 acc:0.95181 total_loss: 0.27926  loss:0.22127,stance loss: 0.2505 
Train step: 3360 acc:0.95348 total_loss: 0.27238  loss:0.052055,stance loss: 0.0070277 
Train step: 3370 acc:0.95296 total_loss: 0.27718  loss:0.58046,stance loss: 1.0122 
Train step: 3380 acc:0.9544 total_loss: 0.26849  loss:0.25778,stance loss: 0.26107 
Train step: 3390 acc:0.95358 total_loss: 0.27255  loss:0.29091,stance loss: 0.24342 
Train step: 3400 acc:0.95428 total_loss: 0.27206  loss:0.59848,stance loss: 0.62173 
Train step: 3410 acc:0.95575 total_loss: 0.26882  loss:0.08294,stance loss: 0.0095084 
Train step: 3420 acc:0.95551 total_loss: 0.26993  loss:0.34269,stance loss: 0.39842 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.875 total_loss: 0.66312  loss:0.66312,stance loss: 0.63295 
Train step: 3440 acc:0.97727 total_loss: 0.19529  loss:0.6328,stance loss: 1.0226 
Train step: 3450 acc:0.97619 total_loss: 0.17997  loss:0.16707,stance loss: 0.030939 
Train step: 3460 acc:0.97581 total_loss: 0.19638  loss:0.57006,stance loss: 1.0297 
Train step: 3470 acc:0.97104 total_loss: 0.19172  loss:0.089853,stance loss: 0.063111 
Train step: 3480 acc:0.97181 total_loss: 0.19377  loss:0.036245,stance loss: 0.0044093 
Train step: 3490 acc:0.96824 total_loss: 0.21108  loss:0.50608,stance loss: 0.37272 
Train step: 3500 acc:0.96655 total_loss: 0.20982  loss:0.068502,stance loss: 0.010303 
Train step: 3510 acc:0.96914 total_loss: 0.20023  loss:0.20407,stance loss: 0.15886 
Train step: 3520 acc:0.96841 total_loss: 0.20295  loss:0.074372,stance loss: 0.073169 
Train step: 3530 acc:0.96968 total_loss: 0.19501  loss:0.16089,stance loss: 0.069872 
Train step: 3540 acc:0.97072 total_loss: 0.18646  loss:0.26114,stance loss: 0.22754 
Train step: 3550 acc:0.97056 total_loss: 0.18682  loss:0.039219,stance loss: 0.0027562 
Train step: 3560 acc:0.97042 total_loss: 0.19368  loss:0.042831,stance loss: 0.0039359 
Train step: 3570 acc:0.97119 total_loss: 0.20301  loss:0.5402,stance loss: 1.0172 
Train step: 3580 acc:0.9702 total_loss: 0.20213  loss:0.078201,stance loss: 0.042366 
Train step: 3590 acc:0.96894 total_loss: 0.20344  loss:0.41317,stance loss: 0.59026 
Train step: 3600 acc:0.97003 total_loss: 0.20294  loss:0.044972,stance loss: 0.0057899 
Train step: 3610 acc:0.97134 total_loss: 0.20452  loss:0.080315,stance loss: 0.067652 
Train step: 3620 acc:0.9712 total_loss: 0.20486  loss:0.032848,stance loss: 0.0038253 
Train step: 3630 acc:0.97108 total_loss: 0.20436  loss:0.0433,stance loss: 0.012273 
Train step: 3640 acc:0.97068 total_loss: 0.20443  loss:0.04461,stance loss: 0.019209 
Train step: 3650 acc:0.97031 total_loss: 0.20181  loss:0.53485,stance loss: 0.73175 
Train step: 3660 acc:0.97051 total_loss: 0.20272  loss:0.092385,stance loss: 0.080057 
Train step: 3670 acc:0.9694 total_loss: 0.2076  loss:0.22806,stance loss: 0.14354 
Training finished.


Reload the best model with best f1 0.4774203753290626 from path test_outputs/bert-cross-topic/fm/2023-08-14 13-46-56/state_dict


              precision    recall  f1-score   support

           0   0.591006  0.540117  0.564417       511
           1   0.483092  0.588235  0.530504       170
           2   0.385455  0.395522  0.390424       268

    accuracy                       0.507903       949
   macro avg   0.486518  0.507958  0.495115       949
weighted avg   0.513627  0.507903  0.509206       949

Test Acc: 0.5079030558482613 F1_ma:0.4774203753290626
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4774203753290626
acc: 0.5079030558482613, f1 :0.4951149098126553
classification report: 
              precision    recall  f1-score   support

         Con     0.5910    0.5401    0.5644       511
        None     0.4831    0.5882    0.5305       170
         Pro     0.3855    0.3955    0.3904       268

    accuracy                         0.5079       949
   macro avg     0.4865    0.5080    0.4951       949
weighted avg     0.5136    0.5079    0.5092       949

run_semeval with seed: 31547
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 14-23-36', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31547, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 14-23-36
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.3125 total_loss: 1.7195  loss:1.7195,stance loss: 1.1974 
Train step: 10 acc:0.38636 total_loss: 1.7395  loss:1.5428,stance loss: 1.0306 
Better F1! Saving model!
Saving model of best f1: 0.3491083676268862
              precision    recall  f1-score   support

           0   0.537487  0.996086  0.698217       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.536354       949
   macro avg   0.179162  0.332029  0.232739       949
weighted avg   0.289416  0.536354  0.375963       949

Test Acc: 0.5363540569020021 F1_ma:0.3491083676268862
Train step: 20 acc:0.42857 total_loss: 1.6959  loss:1.2483,stance loss: 0.50267 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 30 acc:0.45565 total_loss: 1.6863  loss:1.5186,stance loss: 1.035 
Train step: 40 acc:0.46494 total_loss: 1.6796  loss:1.9112,stance loss: 1.7779 
Train step: 50 acc:0.46691 total_loss: 1.6745  loss:1.6575,stance loss: 1.0601 
Train step: 60 acc:0.46516 total_loss: 1.6687  loss:1.6361,stance loss: 1.0823 
Train step: 70 acc:0.45687 total_loss: 1.6666  loss:1.5774,stance loss: 1.0928 
Train step: 80 acc:0.47299 total_loss: 1.6571  loss:1.6232,stance loss: 1.0379 
Train step: 90 acc:0.47596 total_loss: 1.6499  loss:1.7468,stance loss: 1.2695 
Train step: 100 acc:0.48082 total_loss: 1.6395  loss:1.5499,stance loss: 1.1269 
Train step: 110 acc:0.48029 total_loss: 1.6351  loss:1.451,stance loss: 0.85629 
Better F1! Saving model!
Saving model of best f1: 0.350480109739369
              precision    recall  f1-score   support

           0   0.539599  1.000000  0.700960       511
           1   0.500000  0.005882  0.011628       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.539515       949
   macro avg   0.346533  0.335294  0.237529       949
weighted avg   0.380121  0.539515  0.379523       949

Test Acc: 0.5395152792413066 F1_ma:0.350480109739369
Train step: 120 acc:0.48399 total_loss: 1.6331  loss:1.6275,stance loss: 1.3149 
Train step: 130 acc:0.48712 total_loss: 1.6272  loss:1.5229,stance loss: 1.1483 
Train step: 140 acc:0.49291 total_loss: 1.6256  loss:1.4752,stance loss: 1.062 
Train step: 150 acc:0.48634 total_loss: 1.6271  loss:1.8663,stance loss: 1.7469 
Better F1! Saving model!
Saving model of best f1: 0.3512396694214876
              precision    recall  f1-score   support

           0   0.541977  0.998043  0.702479       511
           1   0.500000  0.023529  0.044944       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.541623       949
   macro avg   0.347326  0.340524  0.249141       949
weighted avg   0.381402  0.541623  0.386309       949

Test Acc: 0.541622760800843 F1_ma:0.3512396694214876
Train step: 160 acc:0.4934 total_loss: 1.6142  loss:1.5346,stance loss: 1.0771 
Train step: 170 acc:0.49781 total_loss: 1.6075  loss:1.4068,stance loss: 1.0367 
Train step: 180 acc:0.49724 total_loss: 1.6009  loss:1.4177,stance loss: 0.88485 
Train step: 190 acc:0.5 total_loss: 1.5943  loss:1.5254,stance loss: 1.0423 
Train step: 200 acc:0.50466 total_loss: 1.5887  loss:1.1685,stance loss: 0.70193 
Train step: 210 acc:0.50622 total_loss: 1.5787  loss:1.4314,stance loss: 0.96736 
Better F1! Saving model!
Saving model of best f1: 0.3540636042402827
              precision    recall  f1-score   support

           0   0.554204  0.980431  0.708127       511
           1   0.688889  0.182353  0.288372       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.560590       949
   macro avg   0.414364  0.387594  0.332166       949
weighted avg   0.421822  0.560590  0.432957       949

Test Acc: 0.5605900948366702 F1_ma:0.3540636042402827
Train step: 220 acc:0.50707 total_loss: 1.5721  loss:1.2451,stance loss: 0.79527 
Train step: 230 acc:0.51109 total_loss: 1.5673  loss:1.4359,stance loss: 0.93837 
Train step: 240 acc:0.51426 total_loss: 1.5622  loss:1.0405,stance loss: 0.47681 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.5625 total_loss: 1.5021  loss:1.4759,stance loss: 1.0553 
Train step: 260 acc:0.60156 total_loss: 1.402  loss:1.2157,stance loss: 0.81369 
Train step: 270 acc:0.60096 total_loss: 1.4202  loss:1.3457,stance loss: 0.80356 
Train step: 280 acc:0.59201 total_loss: 1.43  loss:1.5219,stance loss: 1.2633 
Train step: 290 acc:0.61685 total_loss: 1.4063  loss:1.0143,stance loss: 0.63249 
Train step: 300 acc:0.62277 total_loss: 1.3986  loss:1.5406,stance loss: 1.5003 
Train step: 310 acc:0.62879 total_loss: 1.385  loss:1.3896,stance loss: 1.0702 
Train step: 320 acc:0.63898 total_loss: 1.3741  loss:1.1246,stance loss: 0.85863 
Train step: 330 acc:0.64244 total_loss: 1.3653  loss:1.2848,stance loss: 0.92922 
Train step: 340 acc:0.63932 total_loss: 1.3661  loss:1.4835,stance loss: 1.0264 
Train step: 350 acc:0.64328 total_loss: 1.3629  loss:1.4353,stance loss: 1.2259 
Train step: 360 acc:0.6444 total_loss: 1.3577  loss:1.5033,stance loss: 1.463 
Train step: 370 acc:0.6503 total_loss: 1.3537  loss:1.1655,stance loss: 0.77101 
Train step: 380 acc:0.65028 total_loss: 1.3517  loss:1.0719,stance loss: 0.57535 
Train step: 390 acc:0.65411 total_loss: 1.346  loss:1.217,stance loss: 0.78502 
Train step: 400 acc:0.65745 total_loss: 1.34  loss:1.1736,stance loss: 0.94993 
Train step: 410 acc:0.65399 total_loss: 1.3394  loss:1.2584,stance loss: 0.84309 
Train step: 420 acc:0.65661 total_loss: 1.3347  loss:1.3421,stance loss: 0.95865 
Better F1! Saving model!
Saving model of best f1: 0.3543543543543543
              precision    recall  f1-score   support

           0   0.574909  0.923679  0.708709       511
           1   0.609375  0.458824  0.523490       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.579557       949
   macro avg   0.394761  0.460834  0.410733       949
weighted avg   0.418727  0.579557  0.475388       949

Test Acc: 0.5795574288724974 F1_ma:0.3543543543543543
Train step: 430 acc:0.65759 total_loss: 1.3286  loss:1.0483,stance loss: 0.72126 
Train step: 440 acc:0.65784 total_loss: 1.3245  loss:1.0151,stance loss: 0.83219 
Train step: 450 acc:0.65746 total_loss: 1.3253  loss:1.1447,stance loss: 0.90885 
Train step: 460 acc:0.66001 total_loss: 1.3205  loss:1.3185,stance loss: 0.86853 
Train step: 470 acc:0.66316 total_loss: 1.3136  loss:0.94189,stance loss: 0.58052 
Train step: 480 acc:0.66499 total_loss: 1.3109  loss:1.4947,stance loss: 1.3097 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.625 total_loss: 1.0698  loss:1.0698,stance loss: 0.68226 
Train step: 500 acc:0.70455 total_loss: 1.1313  loss:1.1661,stance loss: 0.71664 
Train step: 510 acc:0.70833 total_loss: 1.1863  loss:1.2846,stance loss: 1.0292 
Train step: 520 acc:0.6996 total_loss: 1.1928  loss:0.92041,stance loss: 0.62102 
Train step: 530 acc:0.71799 total_loss: 1.1731  loss:0.8967,stance loss: 0.58685 
Train step: 540 acc:0.70711 total_loss: 1.1817  loss:0.89486,stance loss: 0.59965 
Train step: 550 acc:0.71516 total_loss: 1.1838  loss:1.2799,stance loss: 0.96152 
Train step: 560 acc:0.71127 total_loss: 1.1816  loss:1.0409,stance loss: 0.76986 
Train step: 570 acc:0.7037 total_loss: 1.1902  loss:1.5016,stance loss: 1.1639 
Better F1! Saving model!
Saving model of best f1: 0.3552036199095023
              precision    recall  f1-score   support

           0   0.577914  0.921722  0.710407       511
           1   0.589552  0.464706  0.519737       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.579557       949
   macro avg   0.389155  0.462143  0.410048       949
weighted avg   0.416795  0.579557  0.475631       949

Test Acc: 0.5795574288724974 F1_ma:0.3552036199095023
Train step: 580 acc:0.70261 total_loss: 1.1752  loss:1.2339,stance loss: 0.93983 
Train step: 590 acc:0.70359 total_loss: 1.1703  loss:1.4005,stance loss: 1.2047 
Train step: 600 acc:0.70552 total_loss: 1.1692  loss:1.6527,stance loss: 1.5878 
Train step: 610 acc:0.69731 total_loss: 1.1762  loss:1.0558,stance loss: 0.54077 
Train step: 620 acc:0.70038 total_loss: 1.175  loss:1.3874,stance loss: 1.5562 
Train step: 630 acc:0.70301 total_loss: 1.1681  loss:1.3792,stance loss: 1.0216 
Train step: 640 acc:0.70157 total_loss: 1.1713  loss:1.0246,stance loss: 0.78729 
Train step: 650 acc:0.70303 total_loss: 1.1692  loss:1.4541,stance loss: 1.5512 
Train step: 660 acc:0.69956 total_loss: 1.1704  loss:1.215,stance loss: 0.78456 
Train step: 670 acc:0.70062 total_loss: 1.1755  loss:1.3692,stance loss: 1.2351 
Train step: 680 acc:0.70092 total_loss: 1.1699  loss:1.3731,stance loss: 1.0883 
Train step: 690 acc:0.70087 total_loss: 1.1721  loss:1.077,stance loss: 1.2106 
Train step: 700 acc:0.70201 total_loss: 1.1682  loss:1.3354,stance loss: 1.4048 
Train step: 710 acc:0.70305 total_loss: 1.1658  loss:0.90611,stance loss: 0.7655 
Train step: 720 acc:0.70022 total_loss: 1.1699  loss:1.3325,stance loss: 1.1605 
Train step: 730 acc:0.69839 total_loss: 1.1747  loss:0.92435,stance loss: 0.73781 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.69792 total_loss: 1.08  loss:1.4963,stance loss: 1.2351 
Train step: 750 acc:0.71484 total_loss: 1.1229  loss:1.1379,stance loss: 0.61194 
Train step: 760 acc:0.70913 total_loss: 1.1016  loss:1.0046,stance loss: 0.88044 
Train step: 770 acc:0.72569 total_loss: 1.0831  loss:0.66988,stance loss: 0.48921 
Train step: 780 acc:0.72418 total_loss: 1.0925  loss:1.0951,stance loss: 0.8072 
Train step: 790 acc:0.72545 total_loss: 1.075  loss:1.0345,stance loss: 0.95838 
Train step: 800 acc:0.72917 total_loss: 1.0766  loss:1.1202,stance loss: 1.3409 
Train step: 810 acc:0.72697 total_loss: 1.0794  loss:0.78104,stance loss: 0.51089 
Train step: 820 acc:0.7282 total_loss: 1.0748  loss:1.1553,stance loss: 1.0545 
Train step: 830 acc:0.72721 total_loss: 1.0817  loss:1.0003,stance loss: 0.79169 
Train step: 840 acc:0.72642 total_loss: 1.0809  loss:0.78322,stance loss: 0.5854 
Train step: 850 acc:0.72791 total_loss: 1.0686  loss:0.77239,stance loss: 0.58838 
Train step: 860 acc:0.73214 total_loss: 1.068  loss:0.8555,stance loss: 0.77724 
Train step: 870 acc:0.73483 total_loss: 1.0593  loss:0.71661,stance loss: 0.4441 
Train step: 880 acc:0.73502 total_loss: 1.0569  loss:0.95544,stance loss: 0.56741 
Train step: 890 acc:0.73438 total_loss: 1.0672  loss:0.83731,stance loss: 0.61467 
Train step: 900 acc:0.73193 total_loss: 1.0656  loss:0.91105,stance loss: 0.70194 
Train step: 910 acc:0.73295 total_loss: 1.0656  loss:1.2613,stance loss: 1.2246 
Train step: 920 acc:0.7332 total_loss: 1.063  loss:1.0834,stance loss: 0.89373 
Train step: 930 acc:0.73342 total_loss: 1.0639  loss:0.94116,stance loss: 0.70019 
Train step: 940 acc:0.73301 total_loss: 1.0664  loss:1.1164,stance loss: 0.78118 
Train step: 950 acc:0.72917 total_loss: 1.0713  loss:1.1767,stance loss: 0.92353 
Train step: 960 acc:0.73037 total_loss: 1.0681  loss:1.3041,stance loss: 1.0686 
Train step: 970 acc:0.72855 total_loss: 1.0727  loss:0.79099,stance loss: 0.66866 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.75 total_loss: 0.84193  loss:0.84193,stance loss: 0.67307 
Train step: 990 acc:0.76705 total_loss: 0.94275  loss:1.2194,stance loss: 1.5382 
Train step: 1000 acc:0.74107 total_loss: 1.0522  loss:1.5505,stance loss: 1.2402 
Train step: 1010 acc:0.74798 total_loss: 1.0047  loss:0.79171,stance loss: 0.75287 
Train step: 1020 acc:0.76372 total_loss: 0.96615  loss:1.0192,stance loss: 0.7124 
Train step: 1030 acc:0.77083 total_loss: 0.96348  loss:0.97261,stance loss: 0.78764 
Train step: 1040 acc:0.75922 total_loss: 0.94909  loss:0.79774,stance loss: 0.45381 
Train step: 1050 acc:0.76937 total_loss: 0.93629  loss:1.1294,stance loss: 0.74753 
Train step: 1060 acc:0.76466 total_loss: 0.9446  loss:0.3867,stance loss: 0.22089 
Train step: 1070 acc:0.76511 total_loss: 0.93755  loss:1.0748,stance loss: 0.66412 
Train step: 1080 acc:0.75495 total_loss: 0.94969  loss:0.95974,stance loss: 0.6997 
Train step: 1090 acc:0.75732 total_loss: 0.95154  loss:0.89808,stance loss: 0.77726 
Train step: 1100 acc:0.76085 total_loss: 0.94791  loss:0.84641,stance loss: 0.6439 
Train step: 1110 acc:0.76288 total_loss: 0.94568  loss:1.055,stance loss: 1.3336 
Train step: 1120 acc:0.75842 total_loss: 0.94884  loss:0.76081,stance loss: 0.61563 
Train step: 1130 acc:0.75952 total_loss: 0.94735  loss:0.57059,stance loss: 0.35195 
Train step: 1140 acc:0.75932 total_loss: 0.94207  loss:0.92447,stance loss: 0.73166 
Train step: 1150 acc:0.75987 total_loss: 0.94051  loss:0.95138,stance loss: 0.95422 
Train step: 1160 acc:0.75449 total_loss: 0.94628  loss:1.5374,stance loss: 1.7413 
Train step: 1170 acc:0.7536 total_loss: 0.95047  loss:1.2693,stance loss: 0.77165 
Better F1! Saving model!
Saving model of best f1: 0.35919098822324635
              precision    recall  f1-score   support

           0   0.621188  0.757339  0.682540       511
           1   0.450794  0.835294  0.585567       170
           2   0.454545  0.018657  0.035842       268

    accuracy                       0.562698       949
   macro avg   0.508842  0.537096  0.434650       949
weighted avg   0.543604  0.562698  0.482539       949

Test Acc: 0.5626975763962065 F1_ma:0.35919098822324635
Train step: 1180 acc:0.75498 total_loss: 0.95362  loss:1.1342,stance loss: 0.96408 
Train step: 1190 acc:0.75415 total_loss: 0.95027  loss:0.90944,stance loss: 0.77482 
Train step: 1200 acc:0.75594 total_loss: 0.95434  loss:0.631,stance loss: 0.53334 
Train step: 1210 acc:0.75649 total_loss: 0.95691  loss:1.2231,stance loss: 0.89337 
Train step: 1220 acc:0.75648 total_loss: 0.9528  loss:0.75246,stance loss: 0.50216 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.79167 total_loss: 0.86962  loss:0.87153,stance loss: 0.71515 
Train step: 1240 acc:0.80469 total_loss: 0.86066  loss:0.79116,stance loss: 0.64357 
Train step: 1250 acc:0.77163 total_loss: 0.94989  loss:1.1573,stance loss: 1.2457 
Train step: 1260 acc:0.77951 total_loss: 0.92084  loss:1.4474,stance loss: 1.2314 
Train step: 1270 acc:0.77717 total_loss: 0.90988  loss:0.38669,stance loss: 0.23378 
Train step: 1280 acc:0.77679 total_loss: 0.88621  loss:1.068,stance loss: 0.6231 
Better F1! Saving model!
Saving model of best f1: 0.37614638819458096
              precision    recall  f1-score   support

           0   0.625000  0.694716  0.658017       511
           1   0.403409  0.835294  0.544061       170
           2   0.482759  0.052239  0.094276       268

    accuracy                       0.538462       949
   macro avg   0.503723  0.527416  0.432118       949
weighted avg   0.545136  0.538462  0.478401       949

Test Acc: 0.5384615384615384 F1_ma:0.37614638819458096
Train step: 1290 acc:0.77557 total_loss: 0.88015  loss:1.1686,stance loss: 1.3214 
Better F1! Saving model!
Saving model of best f1: 0.3842169092169092
              precision    recall  f1-score   support

           0   0.611018  0.716243  0.659459       511
           1   0.444444  0.800000  0.571429       170
           2   0.386364  0.063433  0.108974       268

    accuracy                       0.546891       949
   macro avg   0.480609  0.526558  0.446621       949
weighted avg   0.517736  0.546891  0.488232       949

Test Acc: 0.5468914646996839 F1_ma:0.3842169092169092
Train step: 1300 acc:0.77796 total_loss: 0.87382  loss:0.55152,stance loss: 0.39804 
Train step: 1310 acc:0.77689 total_loss: 0.87374  loss:0.88782,stance loss: 0.74192 
Train step: 1320 acc:0.77604 total_loss: 0.8696  loss:1.0466,stance loss: 0.83103 
Train step: 1330 acc:0.78007 total_loss: 0.85851  loss:0.51952,stance loss: 0.47758 
Train step: 1340 acc:0.77909 total_loss: 0.85825  loss:1.2693,stance loss: 1.0414 
Train step: 1350 acc:0.78423 total_loss: 0.85063  loss:0.55261,stance loss: 0.43035 
Better F1! Saving model!
Saving model of best f1: 0.3856598774631561
              precision    recall  f1-score   support

           0   0.626917  0.720157  0.670310       511
           1   0.420420  0.823529  0.556660       170
           2   0.517241  0.055970  0.101010       268

    accuracy                       0.551106       949
   macro avg   0.521526  0.533219  0.442660       949
weighted avg   0.558953  0.551106  0.489179       949

Test Acc: 0.5511064278187566 F1_ma:0.3856598774631561
Train step: 1360 acc:0.77987 total_loss: 0.85748  loss:0.53775,stance loss: 0.30054 
Train step: 1370 acc:0.7851 total_loss: 0.85646  loss:0.89165,stance loss: 0.73765 
Train step: 1380 acc:0.78566 total_loss: 0.85968  loss:0.88137,stance loss: 1.122 
Train step: 1390 acc:0.78539 total_loss: 0.86233  loss:0.86855,stance loss: 0.68787 
Train step: 1400 acc:0.78409 total_loss: 0.86842  loss:0.74509,stance loss: 0.67679 
Train step: 1410 acc:0.78192 total_loss: 0.86886  loss:0.68786,stance loss: 0.47546 
Train step: 1420 acc:0.7854 total_loss: 0.8586  loss:1.0081,stance loss: 0.82429 
Train step: 1430 acc:0.78641 total_loss: 0.85677  loss:0.64474,stance loss: 0.52354 
Train step: 1440 acc:0.78704 total_loss: 0.85242  loss:1.0011,stance loss: 0.84068 
Train step: 1450 acc:0.78816 total_loss: 0.84754  loss:0.46517,stance loss: 0.33175 
Better F1! Saving model!
Saving model of best f1: 0.39200836265661576
              precision    recall  f1-score   support

           0   0.620209  0.696673  0.656221       511
           1   0.424242  0.823529  0.560000       170
           2   0.444444  0.074627  0.127796       268

    accuracy                       0.543730       949
   macro avg   0.496299  0.531610  0.448006       949
weighted avg   0.535468  0.543730  0.489756       949

Test Acc: 0.5437302423603794 F1_ma:0.39200836265661576
Train step: 1460 acc:0.78893 total_loss: 0.84748  loss:1.0047,stance loss: 1.2246 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.9375 total_loss: 0.52436  loss:0.52436,stance loss: 0.38172 
Train step: 1480 acc:0.83523 total_loss: 0.66764  loss:0.91106,stance loss: 0.82387 
Train step: 1490 acc:0.83036 total_loss: 0.69462  loss:0.42745,stance loss: 0.32018 
Train step: 1500 acc:0.84677 total_loss: 0.66137  loss:0.58404,stance loss: 0.44526 
Train step: 1510 acc:0.83994 total_loss: 0.70791  loss:0.43023,stance loss: 0.23863 
Train step: 1520 acc:0.83088 total_loss: 0.72168  loss:0.48753,stance loss: 0.4505 
Train step: 1530 acc:0.82787 total_loss: 0.71479  loss:0.73692,stance loss: 0.62456 
Train step: 1540 acc:0.83715 total_loss: 0.68862  loss:0.45003,stance loss: 0.36846 
Train step: 1550 acc:0.83565 total_loss: 0.69071  loss:1.2439,stance loss: 1.4343 
Train step: 1560 acc:0.82898 total_loss: 0.71027  loss:1.319,stance loss: 0.91009 
Train step: 1570 acc:0.8255 total_loss: 0.7201  loss:0.94142,stance loss: 0.7141 
Train step: 1580 acc:0.8277 total_loss: 0.71322  loss:0.43472,stance loss: 0.38464 
Train step: 1590 acc:0.82696 total_loss: 0.71698  loss:1.3592,stance loss: 1.6092 
Train step: 1600 acc:0.82872 total_loss: 0.71926  loss:0.7208,stance loss: 0.63262 
Train step: 1610 acc:0.82358 total_loss: 0.73204  loss:1.1804,stance loss: 1.4818 
Better F1! Saving model!
Saving model of best f1: 0.39754746239894007
              precision    recall  f1-score   support

           0   0.592523  0.620352  0.606119       511
           1   0.421927  0.747059  0.539278       170
           2   0.318584  0.134328  0.188976       268

    accuracy                       0.505796       949
   macro avg   0.444345  0.500580  0.444791       949
weighted avg   0.484602  0.505796  0.476343       949

Test Acc: 0.505795574288725 F1_ma:0.39754746239894007
Train step: 1620 acc:0.82368 total_loss: 0.73892  loss:0.78517,stance loss: 0.48401 
Train step: 1630 acc:0.8222 total_loss: 0.74377  loss:0.40789,stance loss: 0.24243 
Train step: 1640 acc:0.82273 total_loss: 0.74319  loss:0.61945,stance loss: 0.53872 
Train step: 1650 acc:0.82424 total_loss: 0.74244  loss:0.41239,stance loss: 0.23441 
Train step: 1660 acc:0.82559 total_loss: 0.74052  loss:0.73301,stance loss: 0.66126 
Train step: 1670 acc:0.82556 total_loss: 0.73851  loss:0.62301,stance loss: 0.44414 
Train step: 1680 acc:0.82405 total_loss: 0.7426  loss:0.2048,stance loss: 0.080634 
Train step: 1690 acc:0.82381 total_loss: 0.73999  loss:0.84644,stance loss: 0.70253 
Train step: 1700 acc:0.82143 total_loss: 0.74701  loss:1.1148,stance loss: 0.87822 
Train step: 1710 acc:0.8221 total_loss: 0.7497  loss:0.66637,stance loss: 0.5265 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.83333 total_loss: 0.74728  loss:0.94694,stance loss: 0.75464 
Train step: 1730 acc:0.83984 total_loss: 0.77181  loss:0.6316,stance loss: 0.55499 
Train step: 1740 acc:0.82933 total_loss: 0.74533  loss:0.33013,stance loss: 0.24234 
Train step: 1750 acc:0.82812 total_loss: 0.77755  loss:0.53272,stance loss: 0.411 
Train step: 1760 acc:0.83152 total_loss: 0.77086  loss:1.0121,stance loss: 1.33 
Better F1! Saving model!
Saving model of best f1: 0.3997107599983781
              precision    recall  f1-score   support

           0   0.592219  0.804305  0.682158       511
           1   0.495370  0.629412  0.554404       170
           2   0.461538  0.067164  0.117264       268

    accuracy                       0.564805       949
   macro avg   0.516376  0.500294  0.451275       949
weighted avg   0.537965  0.564805  0.499745       949

Test Acc: 0.5648050579557429 F1_ma:0.3997107599983781
Train step: 1770 acc:0.83371 total_loss: 0.75191  loss:0.53696,stance loss: 0.40042 
Train step: 1780 acc:0.83239 total_loss: 0.73625  loss:0.29755,stance loss: 0.13097 
Train step: 1790 acc:0.83141 total_loss: 0.71683  loss:0.45337,stance loss: 0.36429 
Train step: 1800 acc:0.8343 total_loss: 0.69923  loss:0.39564,stance loss: 0.26971 
Better F1! Saving model!
Saving model of best f1: 0.40217576636786223
              precision    recall  f1-score   support

           0   0.606013  0.749511  0.670166       511
           1   0.452206  0.723529  0.556561       170
           2   0.466667  0.078358  0.134185       268

    accuracy                       0.555321       949
   macro avg   0.508295  0.517133  0.453638       949
weighted avg   0.539109  0.555321  0.498453       949

Test Acc: 0.5553213909378293 F1_ma:0.40217576636786223
Train step: 1810 acc:0.83203 total_loss: 0.7009  loss:0.64769,stance loss: 0.49598 
Train step: 1820 acc:0.83667 total_loss: 0.6963  loss:0.71229,stance loss: 0.47738 
Train step: 1830 acc:0.83567 total_loss: 0.69155  loss:0.71094,stance loss: 0.67845 
Train step: 1840 acc:0.83631 total_loss: 0.68378  loss:0.21127,stance loss: 0.12542 
Train step: 1850 acc:0.84007 total_loss: 0.66757  loss:0.287,stance loss: 0.15902 
Train step: 1860 acc:0.84075 total_loss: 0.67801  loss:0.33216,stance loss: 0.23238 
Train step: 1870 acc:0.84335 total_loss: 0.67208  loss:0.32619,stance loss: 0.23081 
Train step: 1880 acc:0.84224 total_loss: 0.67727  loss:0.86851,stance loss: 0.56323 
Train step: 1890 acc:0.84339 total_loss: 0.66965  loss:0.29614,stance loss: 0.14882 
Train step: 1900 acc:0.84442 total_loss: 0.67285  loss:0.38173,stance loss: 0.20456 
Train step: 1910 acc:0.84471 total_loss: 0.67751  loss:0.87779,stance loss: 0.76552 
Train step: 1920 acc:0.84557 total_loss: 0.67211  loss:0.57196,stance loss: 0.43997 
Better F1! Saving model!
Saving model of best f1: 0.4076768807425027
              precision    recall  f1-score   support

           0   0.625490  0.624266  0.624878       511
           1   0.405714  0.835294  0.546154       170
           2   0.382022  0.126866  0.190476       268

    accuracy                       0.521602       949
   macro avg   0.471076  0.528809  0.453836       949
weighted avg   0.517365  0.521602  0.488099       949

Test Acc: 0.5216016859852476 F1_ma:0.4076768807425027
Train step: 1930 acc:0.8478 total_loss: 0.66449  loss:0.73457,stance loss: 0.42558 
Train step: 1940 acc:0.84845 total_loss: 0.66028  loss:0.93641,stance loss: 0.51106 
Train step: 1950 acc:0.84587 total_loss: 0.66221  loss:0.67894,stance loss: 0.47827 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.6875 total_loss: 0.72187  loss:0.72187,stance loss: 0.35761 
Train step: 1970 acc:0.86932 total_loss: 0.55772  loss:0.73909,stance loss: 0.55741 
Train step: 1980 acc:0.86905 total_loss: 0.5332  loss:0.49598,stance loss: 0.42018 
Train step: 1990 acc:0.87702 total_loss: 0.55225  loss:0.50896,stance loss: 0.40465 
Train step: 2000 acc:0.87805 total_loss: 0.56169  loss:0.4544,stance loss: 0.30784 
Train step: 2010 acc:0.88235 total_loss: 0.54483  loss:0.44916,stance loss: 0.37751 
Train step: 2020 acc:0.88012 total_loss: 0.54998  loss:0.63465,stance loss: 0.60077 
Train step: 2030 acc:0.88204 total_loss: 0.5471  loss:0.71689,stance loss: 0.64096 
Train step: 2040 acc:0.88194 total_loss: 0.55208  loss:0.44968,stance loss: 0.32699 
Train step: 2050 acc:0.88255 total_loss: 0.54466  loss:0.58924,stance loss: 0.4375 
Train step: 2060 acc:0.88181 total_loss: 0.54834  loss:0.53907,stance loss: 0.47375 
Train step: 2070 acc:0.88232 total_loss: 0.55085  loss:0.86588,stance loss: 0.72723 
Train step: 2080 acc:0.88378 total_loss: 0.55676  loss:0.19824,stance loss: 0.10418 
Train step: 2090 acc:0.88788 total_loss: 0.5527  loss:1.2788,stance loss: 1.5282 
Train step: 2100 acc:0.88741 total_loss: 0.54828  loss:0.81421,stance loss: 0.67196 
Train step: 2110 acc:0.88659 total_loss: 0.54491  loss:0.37488,stance loss: 0.1175 
Train step: 2120 acc:0.88665 total_loss: 0.54293  loss:0.89856,stance loss: 0.89369 
Train step: 2130 acc:0.88743 total_loss: 0.54022  loss:0.83734,stance loss: 0.72348 
Train step: 2140 acc:0.88812 total_loss: 0.53596  loss:0.4201,stance loss: 0.34053 
Train step: 2150 acc:0.88711 total_loss: 0.53706  loss:0.14751,stance loss: 0.072584 
Train step: 2160 acc:0.88526 total_loss: 0.53954  loss:0.46772,stance loss: 0.38175 
Train step: 2170 acc:0.88418 total_loss: 0.54635  loss:0.94084,stance loss: 1.3326 
Train step: 2180 acc:0.88433 total_loss: 0.54917  loss:0.96436,stance loss: 1.0764 
Train step: 2190 acc:0.88474 total_loss: 0.54352  loss:0.59781,stance loss: 0.57173 
Train step: 2200 acc:0.88511 total_loss: 0.53882  loss:0.54561,stance loss: 0.41251 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.90625 total_loss: 0.4916  loss:0.35266,stance loss: 0.26596 
Train step: 2220 acc:0.91016 total_loss: 0.47359  loss:0.67885,stance loss: 0.5034 
Train step: 2230 acc:0.90144 total_loss: 0.47761  loss:0.529,stance loss: 0.50703 
Train step: 2240 acc:0.89583 total_loss: 0.4838  loss:0.29822,stance loss: 0.23232 
Train step: 2250 acc:0.90217 total_loss: 0.47545  loss:0.41957,stance loss: 0.29726 
Train step: 2260 acc:0.90513 total_loss: 0.45228  loss:0.32455,stance loss: 0.2776 
Train step: 2270 acc:0.9053 total_loss: 0.44762  loss:0.3041,stance loss: 0.29414 
Train step: 2280 acc:0.90543 total_loss: 0.47151  loss:0.60711,stance loss: 0.44648 
Train step: 2290 acc:0.90698 total_loss: 0.47046  loss:0.35407,stance loss: 0.29032 
Better F1! Saving model!
Saving model of best f1: 0.4107953615076589
              precision    recall  f1-score   support

           0   0.597656  0.598826  0.598240       511
           1   0.418006  0.764706  0.540541       170
           2   0.349206  0.164179  0.223350       268

    accuracy                       0.505796       949
   macro avg   0.454956  0.509237  0.454044       949
weighted avg   0.495312  0.505796  0.482034       949

Test Acc: 0.505795574288725 F1_ma:0.4107953615076589
Train step: 2300 acc:0.91016 total_loss: 0.46197  loss:0.18008,stance loss: 0.12644 
Train step: 2310 acc:0.91038 total_loss: 0.46287  loss:0.25974,stance loss: 0.1855 
Train step: 2320 acc:0.91002 total_loss: 0.46431  loss:0.76438,stance loss: 0.54779 
Better F1! Saving model!
Saving model of best f1: 0.4121264380857292
              precision    recall  f1-score   support

           0   0.598113  0.620352  0.609030       511
           1   0.411765  0.741176  0.529412       170
           2   0.362832  0.152985  0.215223       268

    accuracy                       0.510011       949
   macro avg   0.457570  0.504838  0.451222       949
weighted avg   0.498287  0.510011  0.483555       949

Test Acc: 0.5100105374077977 F1_ma:0.4121264380857292
Train step: 2330 acc:0.90873 total_loss: 0.46595  loss:0.27843,stance loss: 0.22159 
Train step: 2340 acc:0.91176 total_loss: 0.45701  loss:0.43415,stance loss: 0.3823 
Train step: 2350 acc:0.91224 total_loss: 0.45512  loss:0.55276,stance loss: 0.44747 
Train step: 2360 acc:0.91066 total_loss: 0.45463  loss:0.19928,stance loss: 0.13505 
Train step: 2370 acc:0.90964 total_loss: 0.46428  loss:0.36865,stance loss: 0.32515 
Better F1! Saving model!
Saving model of best f1: 0.4182473638050949
              precision    recall  f1-score   support

           0   0.597990  0.698630  0.644404       511
           1   0.439850  0.688235  0.536697       170
           2   0.395349  0.126866  0.192090       268

    accuracy                       0.535300       949
   macro avg   0.477729  0.504577  0.457731       949
weighted avg   0.512435  0.535300  0.497376       949

Test Acc: 0.5353003161222339 F1_ma:0.4182473638050949
Train step: 2380 acc:0.90945 total_loss: 0.46873  loss:0.58239,stance loss: 0.3943 
Train step: 2390 acc:0.90995 total_loss: 0.47006  loss:0.44401,stance loss: 0.46078 
Train step: 2400 acc:0.91103 total_loss: 0.46371  loss:0.082688,stance loss: 0.015778 
Train step: 2410 acc:0.90898 total_loss: 0.47056  loss:0.43776,stance loss: 0.34536 
Train step: 2420 acc:0.90856 total_loss: 0.46731  loss:0.13808,stance loss: 0.06311 
Train step: 2430 acc:0.90985 total_loss: 0.46291  loss:0.33742,stance loss: 0.26498 
Train step: 2440 acc:0.91128 total_loss: 0.45568  loss:0.31459,stance loss: 0.24447 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.091218  loss:0.091218,stance loss: 0.010721 
Train step: 2460 acc:0.92614 total_loss: 0.36084  loss:0.52737,stance loss: 0.30362 
Train step: 2470 acc:0.91667 total_loss: 0.41469  loss:0.57458,stance loss: 0.58808 
Train step: 2480 acc:0.92742 total_loss: 0.39633  loss:0.49021,stance loss: 0.36763 
Train step: 2490 acc:0.92988 total_loss: 0.42298  loss:0.39661,stance loss: 0.36779 
Train step: 2500 acc:0.9277 total_loss: 0.41367  loss:0.070433,stance loss: 0.01024 
Train step: 2510 acc:0.92316 total_loss: 0.4227  loss:0.59735,stance loss: 0.51294 
Train step: 2520 acc:0.91989 total_loss: 0.41757  loss:0.25469,stance loss: 0.10788 
Train step: 2530 acc:0.92207 total_loss: 0.41082  loss:0.39504,stance loss: 0.36221 
Train step: 2540 acc:0.92033 total_loss: 0.40978  loss:0.42977,stance loss: 0.43412 
Train step: 2550 acc:0.92265 total_loss: 0.41452  loss:0.77812,stance loss: 0.62644 
Train step: 2560 acc:0.92568 total_loss: 0.39843  loss:0.11793,stance loss: 0.055918 
Train step: 2570 acc:0.92717 total_loss: 0.3917  loss:0.09317,stance loss: 0.041751 
Train step: 2580 acc:0.92557 total_loss: 0.39549  loss:0.33963,stance loss: 0.27063 
Train step: 2590 acc:0.9242 total_loss: 0.40133  loss:0.75478,stance loss: 0.68403 
Train step: 2600 acc:0.92467 total_loss: 0.39783  loss:0.16615,stance loss: 0.067701 
Train step: 2610 acc:0.92314 total_loss: 0.40204  loss:0.50937,stance loss: 0.48588 
Train step: 2620 acc:0.92251 total_loss: 0.40444  loss:0.45087,stance loss: 0.17822 
Train step: 2630 acc:0.91989 total_loss: 0.40686  loss:0.36248,stance loss: 0.35471 
Train step: 2640 acc:0.92114 total_loss: 0.40153  loss:0.5205,stance loss: 0.48793 
Better F1! Saving model!
Saving model of best f1: 0.4202577527184857
              precision    recall  f1-score   support

           0   0.620278  0.610568  0.615385       511
           1   0.403614  0.788235  0.533865       170
           2   0.377193  0.160448  0.225131       268

    accuracy                       0.515279       949
   macro avg   0.467029  0.519750  0.458127       949
weighted avg   0.512818  0.515279  0.490573       949

Test Acc: 0.5152792413066386 F1_ma:0.4202577527184857
Train step: 2650 acc:0.91978 total_loss: 0.40459  loss:0.21647,stance loss: 0.1717 
Train step: 2660 acc:0.92121 total_loss: 0.39803  loss:0.30241,stance loss: 0.26791 
Train step: 2670 acc:0.92336 total_loss: 0.39306  loss:0.59961,stance loss: 0.6067 
Train step: 2680 acc:0.92451 total_loss: 0.39072  loss:0.23933,stance loss: 0.20977 
Train step: 2690 acc:0.92427 total_loss: 0.39158  loss:0.19854,stance loss: 0.16573 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.92708 total_loss: 0.42554  loss:0.28443,stance loss: 0.32391 
Train step: 2710 acc:0.92969 total_loss: 0.43923  loss:0.1256,stance loss: 0.083389 
Train step: 2720 acc:0.9351 total_loss: 0.40121  loss:0.94893,stance loss: 1.1315 
Train step: 2730 acc:0.9375 total_loss: 0.38276  loss:0.21931,stance loss: 0.14573 
Train step: 2740 acc:0.94429 total_loss: 0.3926  loss:0.18322,stance loss: 0.16788 
Train step: 2750 acc:0.94308 total_loss: 0.38087  loss:0.20059,stance loss: 0.20189 
Train step: 2760 acc:0.93939 total_loss: 0.38091  loss:0.076409,stance loss: 0.024358 
Train step: 2770 acc:0.94243 total_loss: 0.385  loss:0.97938,stance loss: 1.083 
Train step: 2780 acc:0.93968 total_loss: 0.37768  loss:0.11207,stance loss: 0.088004 
Train step: 2790 acc:0.93945 total_loss: 0.37797  loss:0.35245,stance loss: 0.23379 
Train step: 2800 acc:0.93927 total_loss: 0.37053  loss:0.76474,stance loss: 0.65507 
Train step: 2810 acc:0.9375 total_loss: 0.3721  loss:0.25718,stance loss: 0.21029 
Train step: 2820 acc:0.938 total_loss: 0.3769  loss:0.6857,stance loss: 1.082 
Train step: 2830 acc:0.93796 total_loss: 0.38392  loss:0.32961,stance loss: 0.2709 
Train step: 2840 acc:0.93878 total_loss: 0.37396  loss:0.22386,stance loss: 0.20672 
Train step: 2850 acc:0.9391 total_loss: 0.37178  loss:0.1712,stance loss: 0.085378 
Train step: 2860 acc:0.94051 total_loss: 0.36652  loss:0.11198,stance loss: 0.043986 
Train step: 2870 acc:0.93999 total_loss: 0.36294  loss:0.36718,stance loss: 0.3606 
Train step: 2880 acc:0.93952 total_loss: 0.36485  loss:0.13043,stance loss: 0.092329 
Train step: 2890 acc:0.93941 total_loss: 0.36215  loss:0.62819,stance loss: 1.0899 
Train step: 2900 acc:0.93902 total_loss: 0.35958  loss:0.4505,stance loss: 0.44282 
Train step: 2910 acc:0.93895 total_loss: 0.35588  loss:0.23923,stance loss: 0.17359 
Train step: 2920 acc:0.93999 total_loss: 0.3532  loss:0.54735,stance loss: 1.0089 
Train step: 2930 acc:0.93776 total_loss: 0.35574  loss:0.31326,stance loss: 0.20682 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.28165  loss:0.28165,stance loss: 0.11305 
Train step: 2950 acc:0.97159 total_loss: 0.22605  loss:0.046163,stance loss: 0.0095116 
Train step: 2960 acc:0.96429 total_loss: 0.29367  loss:0.047594,stance loss: 0.0038402 
Train step: 2970 acc:0.95766 total_loss: 0.27294  loss:0.19807,stance loss: 0.037747 
Train step: 2980 acc:0.95884 total_loss: 0.26297  loss:0.070839,stance loss: 0.025803 
Train step: 2990 acc:0.95221 total_loss: 0.29067  loss:0.80022,stance loss: 1.049 
Train step: 3000 acc:0.9457 total_loss: 0.32511  loss:0.44941,stance loss: 0.19944 
Train step: 3010 acc:0.94366 total_loss: 0.32382  loss:0.044826,stance loss: 0.019021 
Train step: 3020 acc:0.94676 total_loss: 0.30991  loss:0.63831,stance loss: 1.061 
Train step: 3030 acc:0.94368 total_loss: 0.31451  loss:0.80114,stance loss: 0.56564 
Train step: 3040 acc:0.94431 total_loss: 0.30614  loss:0.40316,stance loss: 0.34168 
Train step: 3050 acc:0.94257 total_loss: 0.30128  loss:0.17947,stance loss: 0.082168 
Train step: 3060 acc:0.9437 total_loss: 0.30343  loss:0.27584,stance loss: 0.20475 
Train step: 3070 acc:0.94609 total_loss: 0.29199  loss:0.10118,stance loss: 0.030453 
Train step: 3080 acc:0.94592 total_loss: 0.29489  loss:0.59365,stance loss: 0.51187 
Train step: 3090 acc:0.94495 total_loss: 0.29905  loss:0.12713,stance loss: 0.10308 
Train step: 3100 acc:0.94526 total_loss: 0.30027  loss:0.1391,stance loss: 0.020729 
Train step: 3110 acc:0.94518 total_loss: 0.30503  loss:0.094911,stance loss: 0.038119 
Train step: 3120 acc:0.94475 total_loss: 0.30596  loss:0.037362,stance loss: 0.0061357 
Train step: 3130 acc:0.94503 total_loss: 0.3157  loss:0.62427,stance loss: 1.0704 
Train step: 3140 acc:0.94465 total_loss: 0.31357  loss:0.029611,stance loss: 0.0036998 
Train step: 3150 acc:0.94461 total_loss: 0.31475  loss:0.054584,stance loss: 0.0088895 
Train step: 3160 acc:0.94542 total_loss: 0.31205  loss:0.059108,stance loss: 0.0049245 
Train step: 3170 acc:0.94453 total_loss: 0.3179  loss:0.17731,stance loss: 0.059831 
Train step: 3180 acc:0.9445 total_loss: 0.32136  loss:0.17389,stance loss: 0.11027 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.95833 total_loss: 0.2218  loss:0.17249,stance loss: 0.1468 
Train step: 3200 acc:0.95703 total_loss: 0.29547  loss:0.079019,stance loss: 0.029786 
Train step: 3210 acc:0.95433 total_loss: 0.33554  loss:0.12806,stance loss: 0.054461 
Train step: 3220 acc:0.94965 total_loss: 0.33098  loss:0.49707,stance loss: 0.42812 
Train step: 3230 acc:0.94429 total_loss: 0.33405  loss:0.057906,stance loss: 0.025427 
Train step: 3240 acc:0.94643 total_loss: 0.30202  loss:0.30004,stance loss: 0.2709 
Train step: 3250 acc:0.95076 total_loss: 0.27038  loss:0.034176,stance loss: 0.0051437 
Train step: 3260 acc:0.94901 total_loss: 0.27311  loss:0.038297,stance loss: 0.01229 
Train step: 3270 acc:0.95058 total_loss: 0.27032  loss:0.056526,stance loss: 0.016659 
Train step: 3280 acc:0.95052 total_loss: 0.26616  loss:0.04335,stance loss: 0.0072168 
Train step: 3290 acc:0.95106 total_loss: 0.26662  loss:0.36237,stance loss: 0.30878 
Train step: 3300 acc:0.95097 total_loss: 0.27701  loss:0.24775,stance loss: 0.22657 
Train step: 3310 acc:0.95139 total_loss: 0.27831  loss:0.3987,stance loss: 0.40024 
Train step: 3320 acc:0.95221 total_loss: 0.27589  loss:0.20909,stance loss: 0.1871 
Train step: 3330 acc:0.94906 total_loss: 0.28243  loss:0.31415,stance loss: 0.22271 
Train step: 3340 acc:0.95032 total_loss: 0.27923  loss:0.54505,stance loss: 1.0174 
Train step: 3350 acc:0.95068 total_loss: 0.27369  loss:0.053461,stance loss: 0.0043436 
Train step: 3360 acc:0.94886 total_loss: 0.28693  loss:0.93164,stance loss: 1.0952 
Train step: 3370 acc:0.94993 total_loss: 0.28522  loss:0.41009,stance loss: 0.34211 
Train step: 3380 acc:0.95153 total_loss: 0.28228  loss:0.063738,stance loss: 0.034118 
Train step: 3390 acc:0.95237 total_loss: 0.27881  loss:0.030581,stance loss: 0.0062625 
Better F1! Saving model!
Saving model of best f1: 0.4214752977933997
              precision    recall  f1-score   support

           0   0.588517  0.722114  0.648506       511
           1   0.469565  0.635294  0.540000       170
           2   0.380435  0.130597  0.194444       268

    accuracy                       0.539515       949
   macro avg   0.479506  0.496002  0.460984       949
weighted avg   0.508445  0.539515  0.500841       949

Test Acc: 0.5395152792413066 F1_ma:0.4214752977933997
Train step: 3400 acc:0.9511 total_loss: 0.28723  loss:0.47704,stance loss: 0.46914 
Train step: 3410 acc:0.95133 total_loss: 0.28429  loss:0.30512,stance loss: 0.31502 
Train step: 3420 acc:0.95154 total_loss: 0.28315  loss:0.15662,stance loss: 0.060245 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:1.0 total_loss: 0.084816  loss:0.084816,stance loss: 0.017296 
Train step: 3440 acc:0.99432 total_loss: 0.23589  loss:0.079213,stance loss: 0.0019549 
Train step: 3450 acc:0.99107 total_loss: 0.17294  loss:0.10692,stance loss: 0.022921 
Train step: 3460 acc:0.98992 total_loss: 0.19369  loss:0.46184,stance loss: 0.38137 
Train step: 3470 acc:0.97713 total_loss: 0.21831  loss:0.24259,stance loss: 0.34053 
Train step: 3480 acc:0.96814 total_loss: 0.20886  loss:0.21674,stance loss: 0.10879 
Train step: 3490 acc:0.96619 total_loss: 0.22455  loss:0.12053,stance loss: 0.062514 
Train step: 3500 acc:0.96567 total_loss: 0.22338  loss:0.54969,stance loss: 1.0141 
Train step: 3510 acc:0.96682 total_loss: 0.21681  loss:0.34258,stance loss: 0.18277 
Train step: 3520 acc:0.9636 total_loss: 0.23677  loss:0.11327,stance loss: 0.015419 
Train step: 3530 acc:0.96101 total_loss: 0.24979  loss:0.027947,stance loss: 0.0083557 
Train step: 3540 acc:0.9634 total_loss: 0.23395  loss:0.037048,stance loss: 0.013414 
Train step: 3550 acc:0.96436 total_loss: 0.22867  loss:0.024803,stance loss: 0.0032527 
Train step: 3560 acc:0.96422 total_loss: 0.22707  loss:0.031189,stance loss: 0.0028999 
Train step: 3570 acc:0.96498 total_loss: 0.22222  loss:0.020836,stance loss: 0.0023158 
Train step: 3580 acc:0.96316 total_loss: 0.23655  loss:0.19266,stance loss: 0.13754 
Train step: 3590 acc:0.9639 total_loss: 0.23505  loss:0.058114,stance loss: 0.035275 
Train step: 3600 acc:0.96418 total_loss: 0.23164  loss:0.13642,stance loss: 0.067265 
Train step: 3610 acc:0.9634 total_loss: 0.23787  loss:0.23656,stance loss: 0.17773 
Train step: 3620 acc:0.96335 total_loss: 0.24124  loss:0.22198,stance loss: 0.15253 
Train step: 3630 acc:0.96331 total_loss: 0.24204  loss:0.12701,stance loss: 0.072931 
Train step: 3640 acc:0.96238 total_loss: 0.24535  loss:0.19603,stance loss: 0.11653 
Train step: 3650 acc:0.96239 total_loss: 0.24356  loss:0.31033,stance loss: 0.29707 
Train step: 3660 acc:0.96347 total_loss: 0.24452  loss:0.075658,stance loss: 0.058044 
Train step: 3670 acc:0.96291 total_loss: 0.24593  loss:0.28237,stance loss: 0.17519 
Training finished.


Reload the best model with best f1 0.4214752977933997 from path test_outputs/bert-cross-topic/fm/2023-08-14 14-23-36/state_dict


              precision    recall  f1-score   support

           0   0.588517  0.722114  0.648506       511
           1   0.469565  0.635294  0.540000       170
           2   0.380435  0.130597  0.194444       268

    accuracy                       0.539515       949
   macro avg   0.479506  0.496002  0.460984       949
weighted avg   0.508445  0.539515  0.500841       949

Test Acc: 0.5395152792413066 F1_ma:0.4214752977933997
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4214752977933997
acc: 0.5395152792413066, f1 :0.4609835318622664
classification report: 
              precision    recall  f1-score   support

         Con     0.5885    0.7221    0.6485       511
        None     0.4696    0.6353    0.5400       170
         Pro     0.3804    0.1306    0.1944       268

    accuracy                         0.5395       949
   macro avg     0.4795    0.4960    0.4610       949
weighted avg     0.5084    0.5395    0.5008       949

run_semeval with seed: 31548
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 15-03-08', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31548, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 15-03-08
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.1875 total_loss: 2.1282  loss:2.1282,stance loss: 1.8485 
Train step: 10 acc:0.29545 total_loss: 1.7877  loss:1.6496,stance loss: 1.1275 
Better F1! Saving model!
Saving model of best f1: 0.20921070740434902
              precision    recall  f1-score   support

           0   0.250000  0.003914  0.007707       511
           1   0.035144  0.064706  0.045549       170
           2   0.292994  0.686567  0.410714       268

    accuracy                       0.207587       949
   macro avg   0.192712  0.251729  0.154657       949
weighted avg   0.223653  0.207587  0.128296       949

Test Acc: 0.20758693361433087 F1_ma:0.20921070740434902
Train step: 20 acc:0.29762 total_loss: 1.7319  loss:1.722,stance loss: 1.2052 
Better F1! Saving model!
Saving model of best f1: 0.23669201520912547
              precision    recall  f1-score   support

           0   0.460259  0.487280  0.473384       511
           1   0.080882  0.194118  0.114187       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.297155       949
   macro avg   0.180380  0.227132  0.195857       949
weighted avg   0.262321  0.297155  0.275354       949

Test Acc: 0.2971548998946259 F1_ma:0.23669201520912547
Train step: 30 acc:0.33669 total_loss: 1.6956  loss:1.6921,stance loss: 1.1779 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 40 acc:0.3628 total_loss: 1.6782  loss:1.7774,stance loss: 1.2142 
Train step: 50 acc:0.37255 total_loss: 1.6737  loss:1.5285,stance loss: 1.0393 
Train step: 60 acc:0.39754 total_loss: 1.6481  loss:1.5037,stance loss: 0.98722 
Train step: 70 acc:0.40933 total_loss: 1.6357  loss:1.6103,stance loss: 1.1202 
Train step: 80 acc:0.41512 total_loss: 1.6352  loss:1.3198,stance loss: 0.76382 
Train step: 90 acc:0.42239 total_loss: 1.6326  loss:1.4531,stance loss: 1.0759 
Train step: 100 acc:0.43193 total_loss: 1.6232  loss:1.4511,stance loss: 1.0014 
Train step: 110 acc:0.44426 total_loss: 1.6165  loss:1.4871,stance loss: 1.065 
Train step: 120 acc:0.44835 total_loss: 1.6108  loss:1.5794,stance loss: 1.0876 
Train step: 130 acc:0.45468 total_loss: 1.6071  loss:1.3389,stance loss: 0.87947 
Train step: 140 acc:0.46099 total_loss: 1.6012  loss:1.7212,stance loss: 1.6391 
Train step: 150 acc:0.46896 total_loss: 1.5922  loss:1.2063,stance loss: 0.74576 
Train step: 160 acc:0.47438 total_loss: 1.5906  loss:1.7356,stance loss: 1.2029 
Train step: 170 acc:0.47588 total_loss: 1.5854  loss:1.6323,stance loss: 1.133 
Train step: 180 acc:0.47859 total_loss: 1.58  loss:1.4059,stance loss: 0.96237 
Train step: 190 acc:0.48168 total_loss: 1.5728  loss:1.2118,stance loss: 0.65755 
Train step: 200 acc:0.48476 total_loss: 1.5662  loss:1.3865,stance loss: 0.80824 
Train step: 210 acc:0.49052 total_loss: 1.5588  loss:1.3256,stance loss: 0.77157 
Train step: 220 acc:0.49293 total_loss: 1.5543  loss:1.2685,stance loss: 0.84283 
Train step: 230 acc:0.49242 total_loss: 1.5534  loss:1.4479,stance loss: 0.9139 
Better F1! Saving model!
Saving model of best f1: 0.3502398903358465
              precision    recall  f1-score   support

           0   0.539030  1.000000  0.700480       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179677  0.333333  0.233493       949
weighted avg   0.290247  0.538462  0.377181       949

Test Acc: 0.5384615384615384 F1_ma:0.3502398903358465
Train step: 240 acc:0.49793 total_loss: 1.5472  loss:1.3598,stance loss: 1.0508 
Better F1! Saving model!
Saving model of best f1: 0.35110163468372424
              precision    recall  f1-score   support

           0   0.551339  0.966732  0.702203       511
           1   0.471698  0.147059  0.224215       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.546891       949
   macro avg   0.341012  0.371264  0.308806       949
weighted avg   0.381373  0.546891  0.418274       949

Test Acc: 0.5468914646996839 F1_ma:0.35110163468372424
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.625 total_loss: 1.4581  loss:1.3675,stance loss: 0.92549 
Train step: 260 acc:0.61719 total_loss: 1.3622  loss:1.1229,stance loss: 0.69616 
Better F1! Saving model!
Saving model of best f1: 0.3514084507042254
              precision    recall  f1-score   support

           0   0.548955  0.976517  0.702817       511
           1   0.500000  0.117647  0.190476       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.546891       949
   macro avg   0.349652  0.364721  0.297764       949
weighted avg   0.385159  0.546891  0.412561       949

Test Acc: 0.5468914646996839 F1_ma:0.3514084507042254
Train step: 270 acc:0.61779 total_loss: 1.3706  loss:1.3238,stance loss: 0.9214 
Train step: 280 acc:0.62326 total_loss: 1.3683  loss:1.6704,stance loss: 1.6635 
Train step: 290 acc:0.62092 total_loss: 1.3788  loss:1.3457,stance loss: 0.83099 
Train step: 300 acc:0.60938 total_loss: 1.3608  loss:0.92378,stance loss: 0.49999 
Train step: 310 acc:0.61553 total_loss: 1.3606  loss:1.1478,stance loss: 0.81076 
Train step: 320 acc:0.60855 total_loss: 1.3868  loss:1.4032,stance loss: 0.96812 
Train step: 330 acc:0.61337 total_loss: 1.3725  loss:1.1358,stance loss: 0.85827 
Better F1! Saving model!
Saving model of best f1: 0.3549090909090909
              precision    recall  f1-score   support

           0   0.564815  0.954990  0.709818       511
           1   0.564706  0.282353  0.376471       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.564805       949
   macro avg   0.376507  0.412448  0.362096       949
weighted avg   0.405290  0.564805  0.449649       949

Test Acc: 0.5648050579557429 F1_ma:0.3549090909090909
Train step: 340 acc:0.6224 total_loss: 1.3646  loss:1.2022,stance loss: 0.93502 
Train step: 350 acc:0.62736 total_loss: 1.3541  loss:1.141,stance loss: 0.90412 
Train step: 360 acc:0.625 total_loss: 1.3575  loss:1.4656,stance loss: 1.1518 
Train step: 370 acc:0.62996 total_loss: 1.3486  loss:1.4211,stance loss: 1.6145 
Train step: 380 acc:0.63373 total_loss: 1.3408  loss:1.331,stance loss: 1.0574 
Train step: 390 acc:0.63613 total_loss: 1.3376  loss:1.3679,stance loss: 1.0528 
Train step: 400 acc:0.63742 total_loss: 1.3305  loss:1.3229,stance loss: 0.98703 
Train step: 410 acc:0.64006 total_loss: 1.321  loss:0.91931,stance loss: 0.60893 
Train step: 420 acc:0.64062 total_loss: 1.3214  loss:1.4773,stance loss: 1.0716 
Train step: 430 acc:0.64147 total_loss: 1.3147  loss:1.3329,stance loss: 0.9827 
Train step: 440 acc:0.64445 total_loss: 1.3097  loss:1.0837,stance loss: 0.9332 
Train step: 450 acc:0.64897 total_loss: 1.3018  loss:1.3617,stance loss: 1.2287 
Train step: 460 acc:0.65017 total_loss: 1.3003  loss:1.4546,stance loss: 1.2467 
Train step: 470 acc:0.65376 total_loss: 1.2963  loss:0.95606,stance loss: 0.70299 
Train step: 480 acc:0.65466 total_loss: 1.2949  loss:0.86548,stance loss: 0.50315 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.75 total_loss: 1.332  loss:1.332,stance loss: 1.1712 
Train step: 500 acc:0.71023 total_loss: 1.1507  loss:1.5279,stance loss: 1.2384 
Train step: 510 acc:0.71429 total_loss: 1.1444  loss:1.1744,stance loss: 1.0687 
Train step: 520 acc:0.69556 total_loss: 1.1854  loss:1.2115,stance loss: 0.90801 
Train step: 530 acc:0.69055 total_loss: 1.1736  loss:1.0847,stance loss: 0.83441 
Train step: 540 acc:0.68627 total_loss: 1.1874  loss:1.5758,stance loss: 1.4158 
Train step: 550 acc:0.70184 total_loss: 1.1806  loss:1.1183,stance loss: 0.89114 
Train step: 560 acc:0.69542 total_loss: 1.1877  loss:1.1763,stance loss: 0.88715 
Train step: 570 acc:0.69444 total_loss: 1.1869  loss:1.1183,stance loss: 0.88975 
Train step: 580 acc:0.68956 total_loss: 1.1878  loss:1.015,stance loss: 0.65178 
Train step: 590 acc:0.69369 total_loss: 1.1893  loss:1.1681,stance loss: 0.87068 
Train step: 600 acc:0.70101 total_loss: 1.1803  loss:0.8725,stance loss: 0.66882 
Train step: 610 acc:0.69783 total_loss: 1.197  loss:1.4945,stance loss: 0.95256 
Train step: 620 acc:0.70038 total_loss: 1.1916  loss:0.90457,stance loss: 0.65863 
Train step: 630 acc:0.69947 total_loss: 1.1942  loss:1.2043,stance loss: 0.75736 
Train step: 640 acc:0.69992 total_loss: 1.1898  loss:1.2165,stance loss: 0.82999 
Train step: 650 acc:0.70109 total_loss: 1.1848  loss:1.0516,stance loss: 0.77804 
Train step: 660 acc:0.70102 total_loss: 1.1832  loss:1.0988,stance loss: 0.77949 
Train step: 670 acc:0.70338 total_loss: 1.1747  loss:0.7521,stance loss: 0.60035 
Train step: 680 acc:0.70223 total_loss: 1.1753  loss:1.4493,stance loss: 1.2607 
Train step: 690 acc:0.70149 total_loss: 1.1758  loss:1.2871,stance loss: 1.4254 
Train step: 700 acc:0.7029 total_loss: 1.1712  loss:1.2317,stance loss: 0.9876 
Train step: 710 acc:0.70249 total_loss: 1.1708  loss:1.1871,stance loss: 0.95965 
Train step: 720 acc:0.70184 total_loss: 1.1722  loss:0.95529,stance loss: 0.66771 
Train step: 730 acc:0.7028 total_loss: 1.1642  loss:0.91751,stance loss: 0.73055 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.69792 total_loss: 1.1071  loss:1.1907,stance loss: 0.87651 
Train step: 750 acc:0.71094 total_loss: 1.1318  loss:1.2191,stance loss: 0.93095 
Train step: 760 acc:0.70673 total_loss: 1.0983  loss:0.77543,stance loss: 0.50947 
Train step: 770 acc:0.71007 total_loss: 1.0655  loss:0.96154,stance loss: 0.73485 
Train step: 780 acc:0.70924 total_loss: 1.1018  loss:1.5227,stance loss: 1.5509 
Train step: 790 acc:0.71094 total_loss: 1.1055  loss:1.2686,stance loss: 1.0843 
Train step: 800 acc:0.71117 total_loss: 1.095  loss:0.7191,stance loss: 0.51458 
Train step: 810 acc:0.71793 total_loss: 1.0735  loss:0.78954,stance loss: 0.58159 
Train step: 820 acc:0.71366 total_loss: 1.0855  loss:1.2463,stance loss: 1.4309 
Train step: 830 acc:0.7168 total_loss: 1.0722  loss:0.74196,stance loss: 0.58585 
Train step: 840 acc:0.71816 total_loss: 1.0716  loss:0.94664,stance loss: 0.744 
Train step: 850 acc:0.71821 total_loss: 1.0655  loss:0.60483,stance loss: 0.40497 
Train step: 860 acc:0.71825 total_loss: 1.0663  loss:1.0162,stance loss: 0.81956 
Train step: 870 acc:0.71691 total_loss: 1.0739  loss:1.1498,stance loss: 0.99764 
Train step: 880 acc:0.71147 total_loss: 1.0789  loss:1.1122,stance loss: 0.71261 
Train step: 890 acc:0.71554 total_loss: 1.0728  loss:0.98644,stance loss: 0.72602 
Train step: 900 acc:0.71197 total_loss: 1.0712  loss:1.1857,stance loss: 0.88576 
Train step: 910 acc:0.71378 total_loss: 1.0746  loss:1.0442,stance loss: 0.8853 
Train step: 920 acc:0.71539 total_loss: 1.0704  loss:0.88322,stance loss: 0.5537 
Train step: 930 acc:0.71811 total_loss: 1.0668  loss:0.63148,stance loss: 0.49226 
Train step: 940 acc:0.71814 total_loss: 1.0712  loss:1.1587,stance loss: 0.86524 
Train step: 950 acc:0.71817 total_loss: 1.0717  loss:1.2984,stance loss: 1.0215 
Train step: 960 acc:0.72207 total_loss: 1.063  loss:0.73036,stance loss: 0.50031 
Train step: 970 acc:0.72272 total_loss: 1.0671  loss:1.3399,stance loss: 1.1348 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.75 total_loss: 0.96335  loss:0.96335,stance loss: 0.8542 
Train step: 990 acc:0.77841 total_loss: 0.92919  loss:1.2849,stance loss: 1.1708 
Train step: 1000 acc:0.74702 total_loss: 0.98224  loss:1.0792,stance loss: 0.84357 
Better F1! Saving model!
Saving model of best f1: 0.3722673183108307
              precision    recall  f1-score   support

           0   0.615120  0.700587  0.655078       511
           1   0.431677  0.817647  0.565041       170
           2   0.311111  0.052239  0.089457       268

    accuracy                       0.538462       949
   macro avg   0.452636  0.523491  0.436525       949
weighted avg   0.496406  0.538462  0.479216       949

Test Acc: 0.5384615384615384 F1_ma:0.3722673183108307
Train step: 1010 acc:0.74194 total_loss: 0.99921  loss:0.6927,stance loss: 0.58394 
Train step: 1020 acc:0.74848 total_loss: 0.97806  loss:0.68218,stance loss: 0.56397 
Train step: 1030 acc:0.75 total_loss: 0.96965  loss:0.68685,stance loss: 0.55677 
Train step: 1040 acc:0.74898 total_loss: 0.96654  loss:0.55794,stance loss: 0.39866 
Train step: 1050 acc:0.75176 total_loss: 0.95337  loss:0.66924,stance loss: 0.48227 
Train step: 1060 acc:0.74923 total_loss: 0.9596  loss:0.82576,stance loss: 0.63451 
Train step: 1070 acc:0.75069 total_loss: 0.95242  loss:0.88855,stance loss: 0.64294 
Train step: 1080 acc:0.74752 total_loss: 0.96162  loss:0.80006,stance loss: 0.63716 
Train step: 1090 acc:0.74493 total_loss: 0.97361  loss:1.2909,stance loss: 1.1233 
Train step: 1100 acc:0.74483 total_loss: 0.97817  loss:1.0267,stance loss: 0.76877 
Train step: 1110 acc:0.74475 total_loss: 0.97943  loss:0.92264,stance loss: 0.7869 
Train step: 1120 acc:0.74512 total_loss: 0.98168  loss:0.88564,stance loss: 0.77011 
Better F1! Saving model!
Saving model of best f1: 0.3829092737510869
              precision    recall  f1-score   support

           0   0.612281  0.682975  0.645698       511
           1   0.429936  0.794118  0.557851       170
           2   0.307692  0.074627  0.120120       268

    accuracy                       0.531085       949
   macro avg   0.449970  0.517240  0.441223       949
weighted avg   0.493600  0.531085  0.481537       949

Test Acc: 0.5310853530031612 F1_ma:0.3829092737510869
Train step: 1130 acc:0.75 total_loss: 0.97186  loss:0.93172,stance loss: 0.67687 
Train step: 1140 acc:0.74961 total_loss: 0.98086  loss:0.99344,stance loss: 0.78647 
Train step: 1150 acc:0.74781 total_loss: 0.9866  loss:0.5605,stance loss: 0.42046 
Train step: 1160 acc:0.74793 total_loss: 0.98388  loss:0.82919,stance loss: 0.53517 
Train step: 1170 acc:0.74738 total_loss: 0.98302  loss:0.78918,stance loss: 0.5182 
Train step: 1180 acc:0.74658 total_loss: 0.98505  loss:0.73605,stance loss: 0.60341 
Train step: 1190 acc:0.74852 total_loss: 0.97853  loss:0.42319,stance loss: 0.25021 
Train step: 1200 acc:0.74887 total_loss: 0.98044  loss:1.1195,stance loss: 0.80069 
Train step: 1210 acc:0.74865 total_loss: 0.98345  loss:1.0575,stance loss: 0.82795 
Better F1! Saving model!
Saving model of best f1: 0.38942965779467686
              precision    recall  f1-score   support

           0   0.582255  0.616438  0.598859       511
           1   0.438406  0.711765  0.542601       170
           2   0.272727  0.134328  0.180000       268

    accuracy                       0.497366       949
   macro avg   0.431129  0.487510  0.440487       949
weighted avg   0.469075  0.497366  0.470494       949

Test Acc: 0.49736564805057953 F1_ma:0.38942965779467686
Train step: 1220 acc:0.74922 total_loss: 0.98206  loss:0.89531,stance loss: 0.66721 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.71875 total_loss: 0.94757  loss:1.0104,stance loss: 0.69959 
Train step: 1240 acc:0.69922 total_loss: 0.96076  loss:1.0201,stance loss: 0.76289 
Better F1! Saving model!
Saving model of best f1: 0.3909579395960719
              precision    recall  f1-score   support

           0   0.588008  0.594912  0.591440       511
           1   0.438538  0.776471  0.560510       170
           2   0.290076  0.141791  0.190476       268

    accuracy                       0.499473       949
   macro avg   0.438874  0.504391  0.447475       949
weighted avg   0.477096  0.499473  0.472666       949

Test Acc: 0.4994731296101159 F1_ma:0.3909579395960719
Train step: 1250 acc:0.73077 total_loss: 0.91302  loss:0.79168,stance loss: 0.69286 
Train step: 1260 acc:0.73958 total_loss: 0.90579  loss:0.91541,stance loss: 0.77676 
Train step: 1270 acc:0.74457 total_loss: 0.8991  loss:0.64976,stance loss: 0.50302 
Train step: 1280 acc:0.74888 total_loss: 0.89286  loss:0.67452,stance loss: 0.35731 
Train step: 1290 acc:0.76515 total_loss: 0.86825  loss:0.42505,stance loss: 0.19761 
Train step: 1300 acc:0.77138 total_loss: 0.85446  loss:0.91934,stance loss: 0.85468 
Train step: 1310 acc:0.77544 total_loss: 0.84985  loss:0.7887,stance loss: 0.61894 
Train step: 1320 acc:0.7819 total_loss: 0.84735  loss:0.8696,stance loss: 0.66133 
Train step: 1330 acc:0.77712 total_loss: 0.85499  loss:0.91271,stance loss: 0.84886 
Train step: 1340 acc:0.77963 total_loss: 0.8385  loss:0.58472,stance loss: 0.40214 
Train step: 1350 acc:0.77976 total_loss: 0.84231  loss:1.0975,stance loss: 0.93671 
Train step: 1360 acc:0.78079 total_loss: 0.83955  loss:0.69609,stance loss: 0.4828 
Train step: 1370 acc:0.78168 total_loss: 0.84266  loss:0.98095,stance loss: 0.78379 
Train step: 1380 acc:0.78205 total_loss: 0.84462  loss:1.1908,stance loss: 1.0756 
Train step: 1390 acc:0.78389 total_loss: 0.84066  loss:1.0495,stance loss: 0.91379 
Better F1! Saving model!
Saving model of best f1: 0.4057302058242792
              precision    recall  f1-score   support

           0   0.601449  0.649706  0.624647       511
           1   0.411960  0.729412  0.526539       170
           2   0.354167  0.126866  0.186813       268

    accuracy                       0.516333       949
   macro avg   0.455859  0.501995  0.446000       949
weighted avg   0.497672  0.516333  0.483427       949

Test Acc: 0.5163329820864068 F1_ma:0.4057302058242792
Train step: 1400 acc:0.78516 total_loss: 0.84037  loss:0.96467,stance loss: 0.68687 
Train step: 1410 acc:0.78562 total_loss: 0.84022  loss:0.30265,stance loss: 0.14755 
Train step: 1420 acc:0.78508 total_loss: 0.84783  loss:1.0009,stance loss: 0.78941 
Train step: 1430 acc:0.78459 total_loss: 0.84994  loss:0.7827,stance loss: 0.56468 
Train step: 1440 acc:0.78299 total_loss: 0.85422  loss:1.0633,stance loss: 0.62879 
Train step: 1450 acc:0.78374 total_loss: 0.85709  loss:0.5973,stance loss: 0.47586 
Train step: 1460 acc:0.78363 total_loss: 0.86434  loss:0.42163,stance loss: 0.34501 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.6875 total_loss: 1.6288  loss:1.6288,stance loss: 1.8405 
Train step: 1480 acc:0.83523 total_loss: 0.82857  loss:0.71986,stance loss: 0.65784 
Train step: 1490 acc:0.79464 total_loss: 0.86279  loss:1.159,stance loss: 0.95753 
Train step: 1500 acc:0.79637 total_loss: 0.83372  loss:0.52999,stance loss: 0.33357 
Train step: 1510 acc:0.8003 total_loss: 0.88062  loss:1.0666,stance loss: 0.76132 
Train step: 1520 acc:0.81495 total_loss: 0.83792  loss:0.59814,stance loss: 0.40925 
Train step: 1530 acc:0.82172 total_loss: 0.82128  loss:0.60156,stance loss: 0.46601 
Train step: 1540 acc:0.82482 total_loss: 0.8012  loss:0.64676,stance loss: 0.58574 
Train step: 1550 acc:0.81944 total_loss: 0.79873  loss:0.8186,stance loss: 0.65339 
Train step: 1560 acc:0.8228 total_loss: 0.77359  loss:0.34103,stance loss: 0.24548 
Train step: 1570 acc:0.81869 total_loss: 0.78168  loss:0.42746,stance loss: 0.24422 
Train step: 1580 acc:0.82432 total_loss: 0.75957  loss:1.0279,stance loss: 1.3457 
Train step: 1590 acc:0.82283 total_loss: 0.75932  loss:1.0254,stance loss: 0.92523 
Train step: 1600 acc:0.82252 total_loss: 0.7644  loss:1.0861,stance loss: 1.2214 
Train step: 1610 acc:0.82225 total_loss: 0.76433  loss:0.7551,stance loss: 0.60523 
Train step: 1620 acc:0.82202 total_loss: 0.76103  loss:0.49634,stance loss: 0.40496 
Train step: 1630 acc:0.82259 total_loss: 0.75534  loss:0.54623,stance loss: 0.30229 
Train step: 1640 acc:0.82237 total_loss: 0.75489  loss:0.61161,stance loss: 0.50408 
Train step: 1650 acc:0.82251 total_loss: 0.75308  loss:0.69152,stance loss: 0.42147 
Train step: 1660 acc:0.82134 total_loss: 0.75903  loss:0.69158,stance loss: 0.61682 
Train step: 1670 acc:0.82183 total_loss: 0.75813  loss:1.0349,stance loss: 1.0285 
Train step: 1680 acc:0.82168 total_loss: 0.76008  loss:0.50765,stance loss: 0.48399 
Train step: 1690 acc:0.82014 total_loss: 0.76481  loss:0.78637,stance loss: 0.63102 
Train step: 1700 acc:0.81926 total_loss: 0.76439  loss:1.1642,stance loss: 0.91705 
Train step: 1710 acc:0.82002 total_loss: 0.75946  loss:0.83016,stance loss: 0.74588 
Better F1! Saving model!
Saving model of best f1: 0.4101310233482364
              precision    recall  f1-score   support

           0   0.614679  0.655577  0.634470       511
           1   0.421569  0.758824  0.542017       170
           2   0.346939  0.126866  0.185792       268

    accuracy                       0.524763       949
   macro avg   0.461062  0.513756  0.454093       949
weighted avg   0.504475  0.524763  0.491200       949

Test Acc: 0.5247629083245522 F1_ma:0.4101310233482364
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.91667 total_loss: 0.56061  loss:0.8311,stance loss: 1.1286 
Train step: 1730 acc:0.89844 total_loss: 0.59576  loss:0.50306,stance loss: 0.48784 
Train step: 1740 acc:0.88221 total_loss: 0.5964  loss:0.66101,stance loss: 0.54553 
Train step: 1750 acc:0.88021 total_loss: 0.57893  loss:0.46129,stance loss: 0.51716 
Train step: 1760 acc:0.87092 total_loss: 0.60566  loss:0.76867,stance loss: 0.61873 
Train step: 1770 acc:0.86496 total_loss: 0.6111  loss:0.50304,stance loss: 0.33536 
Train step: 1780 acc:0.86837 total_loss: 0.60778  loss:0.87149,stance loss: 1.2273 
Train step: 1790 acc:0.87089 total_loss: 0.60332  loss:0.45551,stance loss: 0.3322 
Train step: 1800 acc:0.87282 total_loss: 0.59153  loss:0.94541,stance loss: 0.63237 
Train step: 1810 acc:0.875 total_loss: 0.58324  loss:0.80473,stance loss: 0.65861 
Train step: 1820 acc:0.87264 total_loss: 0.58866  loss:0.69989,stance loss: 0.67887 
Train step: 1830 acc:0.87069 total_loss: 0.59672  loss:0.64994,stance loss: 0.43127 
Train step: 1840 acc:0.86905 total_loss: 0.60092  loss:0.93669,stance loss: 1.2326 
Train step: 1850 acc:0.86949 total_loss: 0.6112  loss:0.93652,stance loss: 0.70983 
Train step: 1860 acc:0.86986 total_loss: 0.61697  loss:0.78599,stance loss: 1.12 
Train step: 1870 acc:0.86739 total_loss: 0.6214  loss:0.64845,stance loss: 0.49671 
Train step: 1880 acc:0.86747 total_loss: 0.61708  loss:0.53461,stance loss: 0.37368 
Better F1! Saving model!
Saving model of best f1: 0.4120727010110736
              precision    recall  f1-score   support

           0   0.602496  0.661448  0.630597       511
           1   0.422535  0.705882  0.528634       170
           2   0.346154  0.134328  0.193548       268

    accuracy                       0.520548       949
   macro avg   0.457062  0.500553  0.450927       949
weighted avg   0.497867  0.520548  0.488908       949

Test Acc: 0.5205479452054794 F1_ma:0.4120727010110736
Train step: 1890 acc:0.86754 total_loss: 0.61852  loss:0.64951,stance loss: 0.51007 
Better F1! Saving model!
Saving model of best f1: 0.42949130261273744
              precision    recall  f1-score   support

           0   0.600379  0.620352  0.610202       511
           1   0.426523  0.700000  0.530067       170
           2   0.359155  0.190299  0.248780       268

    accuracy                       0.513172       949
   macro avg   0.462019  0.503550  0.463016       949
weighted avg   0.501113  0.513172  0.493781       949

Test Acc: 0.5131717597471022 F1_ma:0.42949130261273744
Train step: 1900 acc:0.86727 total_loss: 0.6262  loss:0.77871,stance loss: 1.1243 
Train step: 1910 acc:0.86448 total_loss: 0.63245  loss:0.47738,stance loss: 0.39434 
Train step: 1920 acc:0.86529 total_loss: 0.63067  loss:0.52708,stance loss: 0.5372 
Train step: 1930 acc:0.86516 total_loss: 0.6306  loss:1.1772,stance loss: 1.3072 
Train step: 1940 acc:0.86532 total_loss: 0.63201  loss:0.4619,stance loss: 0.4088 
Train step: 1950 acc:0.86282 total_loss: 0.64516  loss:1.3506,stance loss: 1.2681 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.75 total_loss: 0.72153  loss:0.72153,stance loss: 0.44115 
Train step: 1970 acc:0.875 total_loss: 0.49676  loss:0.70099,stance loss: 0.67332 
Train step: 1980 acc:0.88393 total_loss: 0.45598  loss:0.39541,stance loss: 0.33125 
Train step: 1990 acc:0.88306 total_loss: 0.50571  loss:0.77334,stance loss: 0.54491 
Train step: 2000 acc:0.88872 total_loss: 0.51058  loss:0.80197,stance loss: 0.78162 
Train step: 2010 acc:0.88358 total_loss: 0.53134  loss:0.3926,stance loss: 0.29956 
Train step: 2020 acc:0.88525 total_loss: 0.52677  loss:0.53999,stance loss: 0.42625 
Train step: 2030 acc:0.88556 total_loss: 0.54091  loss:0.7315,stance loss: 1.0665 
Train step: 2040 acc:0.88426 total_loss: 0.55685  loss:1.5028,stance loss: 1.7457 
Train step: 2050 acc:0.88462 total_loss: 0.55958  loss:0.49982,stance loss: 0.45661 
Train step: 2060 acc:0.88861 total_loss: 0.56243  loss:0.24084,stance loss: 0.13089 
Train step: 2070 acc:0.89245 total_loss: 0.55933  loss:0.5452,stance loss: 0.56889 
Train step: 2080 acc:0.88998 total_loss: 0.5644  loss:0.4957,stance loss: 0.36609 
Train step: 2090 acc:0.89027 total_loss: 0.56266  loss:0.42086,stance loss: 0.34492 
Train step: 2100 acc:0.89229 total_loss: 0.55424  loss:0.15042,stance loss: 0.051115 
Train step: 2110 acc:0.89238 total_loss: 0.54294  loss:0.33164,stance loss: 0.1914 
Train step: 2120 acc:0.89363 total_loss: 0.53569  loss:0.30472,stance loss: 0.16102 
Train step: 2130 acc:0.89218 total_loss: 0.543  loss:0.85101,stance loss: 0.91162 
Train step: 2140 acc:0.89054 total_loss: 0.54226  loss:0.6645,stance loss: 0.60881 
Train step: 2150 acc:0.89005 total_loss: 0.54431  loss:0.14197,stance loss: 0.036397 
Train step: 2160 acc:0.88775 total_loss: 0.54914  loss:0.26294,stance loss: 0.18021 
Train step: 2170 acc:0.88803 total_loss: 0.54612  loss:0.62585,stance loss: 0.65545 
Train step: 2180 acc:0.88999 total_loss: 0.54585  loss:0.32343,stance loss: 0.28616 
Train step: 2190 acc:0.88826 total_loss: 0.55343  loss:1.1856,stance loss: 1.6235 
Train step: 2200 acc:0.88537 total_loss: 0.55807  loss:0.57852,stance loss: 0.43982 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.875 total_loss: 0.58157  loss:0.51842,stance loss: 0.3376 
Train step: 2220 acc:0.91406 total_loss: 0.46058  loss:0.32476,stance loss: 0.23082 
Train step: 2230 acc:0.91827 total_loss: 0.45449  loss:0.81792,stance loss: 1.1269 
Train step: 2240 acc:0.91319 total_loss: 0.45789  loss:0.55351,stance loss: 0.47783 
Train step: 2250 acc:0.90761 total_loss: 0.49399  loss:1.3244,stance loss: 0.87425 
Train step: 2260 acc:0.90737 total_loss: 0.48383  loss:0.36288,stance loss: 0.2601 
Train step: 2270 acc:0.90814 total_loss: 0.47317  loss:0.29194,stance loss: 0.12653 
Train step: 2280 acc:0.91447 total_loss: 0.46127  loss:0.28389,stance loss: 0.16354 
Train step: 2290 acc:0.91424 total_loss: 0.46955  loss:0.10011,stance loss: 0.0094373 
Train step: 2300 acc:0.91667 total_loss: 0.45354  loss:0.12885,stance loss: 0.053162 
Train step: 2310 acc:0.91804 total_loss: 0.45293  loss:0.64063,stance loss: 1.016 
Train step: 2320 acc:0.91918 total_loss: 0.45683  loss:0.82292,stance loss: 0.73383 
Train step: 2330 acc:0.91617 total_loss: 0.46069  loss:0.32957,stance loss: 0.24003 
Train step: 2340 acc:0.91498 total_loss: 0.45357  loss:0.56438,stance loss: 0.39197 
Train step: 2350 acc:0.91438 total_loss: 0.46274  loss:0.15322,stance loss: 0.066696 
Train step: 2360 acc:0.91346 total_loss: 0.46547  loss:0.94549,stance loss: 1.2978 
Train step: 2370 acc:0.91152 total_loss: 0.4655  loss:0.12893,stance loss: 0.033799 
Train step: 2380 acc:0.90945 total_loss: 0.46657  loss:0.22325,stance loss: 0.1271 
Train step: 2390 acc:0.9086 total_loss: 0.46769  loss:0.5554,stance loss: 0.42964 
Train step: 2400 acc:0.90561 total_loss: 0.47875  loss:0.29378,stance loss: 0.2423 
Train step: 2410 acc:0.90352 total_loss: 0.48843  loss:1.4822,stance loss: 0.91208 
Train step: 2420 acc:0.90278 total_loss: 0.49018  loss:0.63142,stance loss: 0.47219 
Train step: 2430 acc:0.90044 total_loss: 0.49561  loss:1.0749,stance loss: 0.92021 
Train step: 2440 acc:0.89989 total_loss: 0.50207  loss:0.63901,stance loss: 0.57815 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.26466  loss:0.26466,stance loss: 0.2019 
Train step: 2460 acc:0.92045 total_loss: 0.33686  loss:0.38475,stance loss: 0.28839 
Train step: 2470 acc:0.91071 total_loss: 0.36757  loss:1.059,stance loss: 1.3708 
Train step: 2480 acc:0.92742 total_loss: 0.32556  loss:0.24414,stance loss: 0.13901 
Train step: 2490 acc:0.92988 total_loss: 0.32829  loss:0.13055,stance loss: 0.055487 
Train step: 2500 acc:0.93627 total_loss: 0.31875  loss:0.36805,stance loss: 0.23831 
Train step: 2510 acc:0.93545 total_loss: 0.33604  loss:0.49951,stance loss: 0.43026 
Train step: 2520 acc:0.9331 total_loss: 0.34009  loss:0.12354,stance loss: 0.018544 
Train step: 2530 acc:0.93056 total_loss: 0.34833  loss:0.41612,stance loss: 0.38625 
Train step: 2540 acc:0.93063 total_loss: 0.35182  loss:0.37796,stance loss: 0.30069 
Train step: 2550 acc:0.9276 total_loss: 0.36882  loss:0.57961,stance loss: 0.50642 
Train step: 2560 acc:0.92905 total_loss: 0.36183  loss:0.31062,stance loss: 0.26859 
Train step: 2570 acc:0.92872 total_loss: 0.36511  loss:0.18397,stance loss: 0.06902 
Train step: 2580 acc:0.92987 total_loss: 0.36421  loss:0.6217,stance loss: 1.0349 
Train step: 2590 acc:0.93041 total_loss: 0.36671  loss:0.64058,stance loss: 1.0547 
Train step: 2600 acc:0.92715 total_loss: 0.37077  loss:0.29646,stance loss: 0.21948 
Train step: 2610 acc:0.92896 total_loss: 0.36539  loss:0.080238,stance loss: 0.047375 
Train step: 2620 acc:0.92873 total_loss: 0.36303  loss:0.26734,stance loss: 0.22812 
Train step: 2630 acc:0.92887 total_loss: 0.36549  loss:0.81279,stance loss: 1.1893 
Train step: 2640 acc:0.92801 total_loss: 0.36544  loss:0.15778,stance loss: 0.1088 
Train step: 2650 acc:0.92724 total_loss: 0.37139  loss:0.43858,stance loss: 0.30524 
Train step: 2660 acc:0.92713 total_loss: 0.37907  loss:0.10522,stance loss: 0.026365 
Train step: 2670 acc:0.92647 total_loss: 0.37856  loss:0.32912,stance loss: 0.22813 
Train step: 2680 acc:0.92695 total_loss: 0.37875  loss:0.1013,stance loss: 0.041046 
Train step: 2690 acc:0.92505 total_loss: 0.38165  loss:0.49102,stance loss: 0.35817 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.91667 total_loss: 0.29647  loss:0.23513,stance loss: 0.14237 
Train step: 2710 acc:0.91797 total_loss: 0.38249  loss:0.44304,stance loss: 0.41087 
Train step: 2720 acc:0.92788 total_loss: 0.35836  loss:0.16079,stance loss: 0.082718 
Train step: 2730 acc:0.93403 total_loss: 0.33098  loss:0.11408,stance loss: 0.043179 
Train step: 2740 acc:0.94158 total_loss: 0.31546  loss:0.18708,stance loss: 0.026767 
Train step: 2750 acc:0.93862 total_loss: 0.31704  loss:0.095988,stance loss: 0.022369 
Train step: 2760 acc:0.93845 total_loss: 0.30912  loss:0.19502,stance loss: 0.14888 
Train step: 2770 acc:0.93668 total_loss: 0.3209  loss:0.44855,stance loss: 0.4155 
Train step: 2780 acc:0.9375 total_loss: 0.32712  loss:0.20595,stance loss: 0.14779 
Train step: 2790 acc:0.93685 total_loss: 0.33022  loss:0.48061,stance loss: 0.3191 
Train step: 2800 acc:0.93632 total_loss: 0.33373  loss:0.09679,stance loss: 0.028069 
Train step: 2810 acc:0.93427 total_loss: 0.3463  loss:0.51826,stance loss: 0.35574 
Train step: 2820 acc:0.93651 total_loss: 0.33886  loss:0.39806,stance loss: 0.31996 
Train step: 2830 acc:0.93612 total_loss: 0.33469  loss:0.42912,stance loss: 0.41146 
Train step: 2840 acc:0.93622 total_loss: 0.33372  loss:0.87569,stance loss: 0.80937 
Train step: 2850 acc:0.9355 total_loss: 0.33173  loss:0.33532,stance loss: 0.24922 
Train step: 2860 acc:0.93637 total_loss: 0.33091  loss:0.22566,stance loss: 0.17381 
Train step: 2870 acc:0.9343 total_loss: 0.33975  loss:0.5289,stance loss: 0.47311 
Train step: 2880 acc:0.9328 total_loss: 0.3434  loss:0.28591,stance loss: 0.18159 
Train step: 2890 acc:0.93431 total_loss: 0.34835  loss:0.20522,stance loss: 0.15596 
Train step: 2900 acc:0.93356 total_loss: 0.3507  loss:0.37221,stance loss: 0.29491 
Train step: 2910 acc:0.93461 total_loss: 0.34922  loss:0.11078,stance loss: 0.041668 
Train step: 2920 acc:0.93529 total_loss: 0.34449  loss:0.11631,stance loss: 0.022687 
Train step: 2930 acc:0.93538 total_loss: 0.34315  loss:0.09842,stance loss: 0.038073 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.51909  loss:0.51909,stance loss: 0.51295 
Train step: 2950 acc:0.91477 total_loss: 0.31627  loss:0.7479,stance loss: 0.61287 
Train step: 2960 acc:0.91667 total_loss: 0.36654  loss:0.093683,stance loss: 0.044924 
Train step: 2970 acc:0.91935 total_loss: 0.36617  loss:0.37773,stance loss: 0.31294 
Train step: 2980 acc:0.92683 total_loss: 0.37059  loss:0.14788,stance loss: 0.095544 
Train step: 2990 acc:0.93382 total_loss: 0.35141  loss:0.10618,stance loss: 0.033104 
Train step: 3000 acc:0.93852 total_loss: 0.34162  loss:0.066624,stance loss: 0.018538 
Train step: 3010 acc:0.94366 total_loss: 0.32693  loss:0.40079,stance loss: 0.46996 
Train step: 3020 acc:0.94753 total_loss: 0.30291  loss:0.15396,stance loss: 0.11062 
Train step: 3030 acc:0.94712 total_loss: 0.29962  loss:0.068152,stance loss: 0.011375 
Train step: 3040 acc:0.94802 total_loss: 0.28908  loss:0.080821,stance loss: 0.036461 
Train step: 3050 acc:0.94764 total_loss: 0.29145  loss:0.061288,stance loss: 0.0048436 
Train step: 3060 acc:0.94886 total_loss: 0.29278  loss:0.20606,stance loss: 0.15636 
Train step: 3070 acc:0.94943 total_loss: 0.2861  loss:0.20854,stance loss: 0.18195 
Train step: 3080 acc:0.95035 total_loss: 0.2881  loss:0.22538,stance loss: 0.22207 
Train step: 3090 acc:0.94992 total_loss: 0.29043  loss:0.058525,stance loss: 0.012553 
Train step: 3100 acc:0.94759 total_loss: 0.29717  loss:0.76714,stance loss: 1.0935 
Train step: 3110 acc:0.94591 total_loss: 0.30729  loss:0.66355,stance loss: 0.5726 
Train step: 3120 acc:0.94579 total_loss: 0.30858  loss:0.30021,stance loss: 0.27039 
Train step: 3130 acc:0.94568 total_loss: 0.31293  loss:0.66865,stance loss: 1.169 
Train step: 3140 acc:0.9459 total_loss: 0.31913  loss:0.43553,stance loss: 0.45878 
Train step: 3150 acc:0.94609 total_loss: 0.31329  loss:0.090471,stance loss: 0.056975 
Train step: 3160 acc:0.94768 total_loss: 0.30804  loss:0.064522,stance loss: 0.020919 
Train step: 3170 acc:0.94832 total_loss: 0.30482  loss:0.081751,stance loss: 0.015103 
Train step: 3180 acc:0.94943 total_loss: 0.30013  loss:0.56299,stance loss: 0.64358 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.96875 total_loss: 0.18477  loss:0.075819,stance loss: 0.0062159 
Train step: 3200 acc:0.96875 total_loss: 0.18498  loss:0.12987,stance loss: 0.076555 
Train step: 3210 acc:0.96394 total_loss: 0.19529  loss:0.45195,stance loss: 0.43063 
Train step: 3220 acc:0.96701 total_loss: 0.18012  loss:0.17828,stance loss: 0.10217 
Train step: 3230 acc:0.96332 total_loss: 0.18115  loss:0.33468,stance loss: 0.32641 
Train step: 3240 acc:0.96094 total_loss: 0.20805  loss:0.076405,stance loss: 0.030637 
Train step: 3250 acc:0.95833 total_loss: 0.23029  loss:1.5166,stance loss: 2.0028 
Train step: 3260 acc:0.96217 total_loss: 0.23178  loss:0.14476,stance loss: 0.12653 
Train step: 3270 acc:0.96148 total_loss: 0.23686  loss:0.23459,stance loss: 0.19701 
Train step: 3280 acc:0.95898 total_loss: 0.24578  loss:0.30098,stance loss: 0.17296 
Train step: 3290 acc:0.95637 total_loss: 0.24993  loss:0.14256,stance loss: 0.075721 
Train step: 3300 acc:0.95797 total_loss: 0.24135  loss:0.044102,stance loss: 0.0089241 
Train step: 3310 acc:0.95685 total_loss: 0.24102  loss:0.031813,stance loss: 0.0042666 
Train step: 3320 acc:0.95496 total_loss: 0.24803  loss:0.34777,stance loss: 0.3038 
Train step: 3330 acc:0.95377 total_loss: 0.25598  loss:0.40933,stance loss: 0.45057 
Train step: 3340 acc:0.95353 total_loss: 0.25171  loss:0.056054,stance loss: 0.027763 
Train step: 3350 acc:0.95369 total_loss: 0.24804  loss:0.14698,stance loss: 0.15878 
Train step: 3360 acc:0.95384 total_loss: 0.24935  loss:0.11641,stance loss: 0.085664 
Train step: 3370 acc:0.9543 total_loss: 0.2468  loss:0.43167,stance loss: 0.28352 
Train step: 3380 acc:0.9544 total_loss: 0.24772  loss:0.04385,stance loss: 0.0081534 
Train step: 3390 acc:0.9557 total_loss: 0.24412  loss:0.094706,stance loss: 0.037675 
Train step: 3400 acc:0.95602 total_loss: 0.2424  loss:0.24592,stance loss: 0.20719 
Train step: 3410 acc:0.95575 total_loss: 0.24362  loss:0.17486,stance loss: 0.10243 
Train step: 3420 acc:0.95524 total_loss: 0.24579  loss:0.20678,stance loss: 0.24051 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:1.0 total_loss: 0.57053  loss:0.57053,stance loss: 1.0225 
Train step: 3440 acc:0.98864 total_loss: 0.2112  loss:0.084674,stance loss: 0.028654 
Train step: 3450 acc:0.97619 total_loss: 0.19247  loss:0.036555,stance loss: 0.0036045 
Train step: 3460 acc:0.97177 total_loss: 0.22173  loss:0.035746,stance loss: 0.013936 
Train step: 3470 acc:0.96951 total_loss: 0.20977  loss:0.18704,stance loss: 0.13064 
Train step: 3480 acc:0.97426 total_loss: 0.21877  loss:0.48986,stance loss: 0.37823 
Train step: 3490 acc:0.97234 total_loss: 0.22945  loss:0.14002,stance loss: 0.1202 
Train step: 3500 acc:0.96831 total_loss: 0.22792  loss:0.12678,stance loss: 0.093026 
Train step: 3510 acc:0.96759 total_loss: 0.22822  loss:0.026885,stance loss: 0.0030703 
Train step: 3520 acc:0.96772 total_loss: 0.22848  loss:0.07054,stance loss: 0.017162 
Train step: 3530 acc:0.96844 total_loss: 0.22153  loss:0.04068,stance loss: 0.0098445 
Train step: 3540 acc:0.96734 total_loss: 0.22893  loss:0.10315,stance loss: 0.002691 
Train step: 3550 acc:0.96901 total_loss: 0.22199  loss:0.039434,stance loss: 0.0056898 
Train step: 3560 acc:0.96756 total_loss: 0.21714  loss:0.19585,stance loss: 0.15188 
Train step: 3570 acc:0.96764 total_loss: 0.22109  loss:0.023986,stance loss: 0.001978 
Train step: 3580 acc:0.96813 total_loss: 0.2143  loss:0.043051,stance loss: 0.0053168 
Train step: 3590 acc:0.96739 total_loss: 0.21267  loss:0.13457,stance loss: 0.07187 
Train step: 3600 acc:0.9682 total_loss: 0.20789  loss:0.044789,stance loss: 0.0091492 
Train step: 3610 acc:0.96754 total_loss: 0.20843  loss:0.037091,stance loss: 0.017104 
Train step: 3620 acc:0.96793 total_loss: 0.20697  loss:0.035369,stance loss: 0.0096241 
Train step: 3630 acc:0.96704 total_loss: 0.21159  loss:0.38956,stance loss: 0.40751 
Train step: 3640 acc:0.96742 total_loss: 0.21596  loss:0.032848,stance loss: 0.0047697 
Train step: 3650 acc:0.9655 total_loss: 0.22061  loss:0.17281,stance loss: 0.075596 
Train step: 3660 acc:0.96537 total_loss: 0.21832  loss:0.19217,stance loss: 0.16567 
Train step: 3670 acc:0.96551 total_loss: 0.21869  loss:0.3675,stance loss: 0.29326 
Training finished.


Reload the best model with best f1 0.42949130261273744 from path test_outputs/bert-cross-topic/fm/2023-08-14 15-03-08/state_dict


              precision    recall  f1-score   support

           0   0.600379  0.620352  0.610202       511
           1   0.426523  0.700000  0.530067       170
           2   0.359155  0.190299  0.248780       268

    accuracy                       0.513172       949
   macro avg   0.462019  0.503550  0.463016       949
weighted avg   0.501113  0.513172  0.493781       949

Test Acc: 0.5131717597471022 F1_ma:0.42949130261273744
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.42949130261273744
acc: 0.5131717597471022, f1 :0.463016473456747
classification report: 
              precision    recall  f1-score   support

         Con     0.6004    0.6204    0.6102       511
        None     0.4265    0.7000    0.5301       170
         Pro     0.3592    0.1903    0.2488       268

    accuracy                         0.5132       949
   macro avg     0.4620    0.5036    0.4630       949
weighted avg     0.5011    0.5132    0.4938       949

run_semeval with seed: 31549
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 15-41-49', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31549, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 15-41-49
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.6395  loss:1.6395,stance loss: 1.1909 
Train step: 10 acc:0.50568 total_loss: 1.6757  loss:1.8131,stance loss: 1.7134 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 20 acc:0.5119 total_loss: 1.5917  loss:1.4811,stance loss: 0.97907 
Train step: 30 acc:0.52419 total_loss: 1.5895  loss:1.4028,stance loss: 0.96965 
Train step: 40 acc:0.50305 total_loss: 1.5855  loss:1.46,stance loss: 1.0026 
Better F1! Saving model!
Saving model of best f1: 0.3515193370165746
              precision    recall  f1-score   support

           0   0.543223  0.996086  0.703039       511
           1   0.583333  0.041176  0.076923       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.543730       949
   macro avg   0.375519  0.345754  0.259987       949
weighted avg   0.397001  0.543730  0.392339       949

Test Acc: 0.5437302423603794 F1_ma:0.3515193370165746
Train step: 50 acc:0.5 total_loss: 1.586  loss:1.8673,stance loss: 1.745 
Better F1! Saving model!
Saving model of best f1: 0.35472496473906906
              precision    recall  f1-score   support

           0   0.554576  0.984344  0.709450       511
           1   0.571429  0.141176  0.226415       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.555321       949
   macro avg   0.375335  0.375174  0.311955       949
weighted avg   0.400981  0.555321  0.422571       949

Test Acc: 0.5553213909378293 F1_ma:0.35472496473906906
Train step: 60 acc:0.50205 total_loss: 1.5733  loss:1.5614,stance loss: 1.0523 
Train step: 70 acc:0.51144 total_loss: 1.557  loss:1.6209,stance loss: 1.1945 
Train step: 80 acc:0.51466 total_loss: 1.5476  loss:1.645,stance loss: 1.2492 
Train step: 90 acc:0.5158 total_loss: 1.5399  loss:1.7248,stance loss: 1.5059 
Train step: 100 acc:0.51485 total_loss: 1.5441  loss:1.3885,stance loss: 1.0608 
Train step: 110 acc:0.52027 total_loss: 1.5407  loss:1.631,stance loss: 1.2414 
Better F1! Saving model!
Saving model of best f1: 0.35555555555555557
              precision    recall  f1-score   support

           0   0.561086  0.970646  0.711111       511
           1   0.584615  0.223529  0.323404       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.562698       949
   macro avg   0.381900  0.398058  0.344838       949
weighted avg   0.406849  0.562698  0.440839       949

Test Acc: 0.5626975763962065 F1_ma:0.35555555555555557
Train step: 120 acc:0.51601 total_loss: 1.5379  loss:1.3025,stance loss: 0.80515 
Better F1! Saving model!
Saving model of best f1: 0.35847647498132934
              precision    recall  f1-score   support

           0   0.579710  0.939335  0.716953       511
           1   0.595041  0.423529  0.494845       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.581665       949
   macro avg   0.391584  0.454288  0.403933       949
weighted avg   0.418745  0.581665  0.474696       949

Test Acc: 0.5816649104320337 F1_ma:0.35847647498132934
Train step: 130 acc:0.51908 total_loss: 1.5342  loss:1.4866,stance loss: 1.1948 
Train step: 140 acc:0.52527 total_loss: 1.5257  loss:1.6669,stance loss: 1.6357 
Train step: 150 acc:0.52566 total_loss: 1.5172  loss:1.3106,stance loss: 0.88565 
Train step: 160 acc:0.53183 total_loss: 1.5082  loss:1.1513,stance loss: 0.74822 
Train step: 170 acc:0.53545 total_loss: 1.5058  loss:1.524,stance loss: 1.2121 
Train step: 180 acc:0.53419 total_loss: 1.5051  loss:1.3631,stance loss: 0.98149 
Train step: 190 acc:0.5373 total_loss: 1.5014  loss:1.1781,stance loss: 0.76925 
Train step: 200 acc:0.53638 total_loss: 1.5014  loss:1.3473,stance loss: 0.86605 
Train step: 210 acc:0.53791 total_loss: 1.4956  loss:1.703,stance loss: 1.2996 
Train step: 220 acc:0.54072 total_loss: 1.4906  loss:1.4676,stance loss: 1.0134 
Train step: 230 acc:0.54545 total_loss: 1.4803  loss:1.0235,stance loss: 0.66276 
Train step: 240 acc:0.54953 total_loss: 1.4763  loss:1.2177,stance loss: 0.85542 
Better F1! Saving model!
Saving model of best f1: 0.35895465026902384
              precision    recall  f1-score   support

           0   0.591139  0.913894  0.717909       511
           1   0.616352  0.576471  0.595745       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.595364       949
   macro avg   0.402497  0.496788  0.437885       949
weighted avg   0.428717  0.595364  0.493286       949

Test Acc: 0.59536354056902 F1_ma:0.35895465026902384
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.61458 total_loss: 1.295  loss:1.3642,stance loss: 0.99224 
Train step: 260 acc:0.64844 total_loss: 1.2646  loss:0.86333,stance loss: 0.55797 
Train step: 270 acc:0.61779 total_loss: 1.2904  loss:1.2711,stance loss: 0.93195 
Train step: 280 acc:0.625 total_loss: 1.317  loss:1.5511,stance loss: 1.3237 
Train step: 290 acc:0.63723 total_loss: 1.2989  loss:1.4339,stance loss: 1.403 
Train step: 300 acc:0.63393 total_loss: 1.2941  loss:1.253,stance loss: 0.88957 
Train step: 310 acc:0.64583 total_loss: 1.2788  loss:1.1158,stance loss: 0.84429 
Train step: 320 acc:0.64062 total_loss: 1.2976  loss:1.5955,stance loss: 1.1832 
Train step: 330 acc:0.65189 total_loss: 1.2931  loss:1.2728,stance loss: 0.9919 
Train step: 340 acc:0.65104 total_loss: 1.2957  loss:1.4879,stance loss: 1.1198 
Train step: 350 acc:0.65212 total_loss: 1.3063  loss:1.2918,stance loss: 1.0531 
Train step: 360 acc:0.65625 total_loss: 1.2989  loss:1.3631,stance loss: 1.0523 
Train step: 370 acc:0.66071 total_loss: 1.2951  loss:1.2497,stance loss: 0.96404 
Train step: 380 acc:0.66222 total_loss: 1.2983  loss:1.3022,stance loss: 1.1348 
Train step: 390 acc:0.66909 total_loss: 1.2881  loss:1.2518,stance loss: 1.1549 
Train step: 400 acc:0.67107 total_loss: 1.2839  loss:1.487,stance loss: 1.5287 
Train step: 410 acc:0.67093 total_loss: 1.2823  loss:1.2446,stance loss: 1.0276 
Train step: 420 acc:0.6733 total_loss: 1.2787  loss:1.0674,stance loss: 0.85872 
Train step: 430 acc:0.67675 total_loss: 1.2714  loss:1.3584,stance loss: 1.5003 
Train step: 440 acc:0.67761 total_loss: 1.2697  loss:1.0437,stance loss: 0.69883 
Train step: 450 acc:0.6784 total_loss: 1.27  loss:1.2261,stance loss: 1.0134 
Train step: 460 acc:0.67795 total_loss: 1.2683  loss:1.2817,stance loss: 1.0512 
Train step: 470 acc:0.68142 total_loss: 1.2639  loss:0.89737,stance loss: 0.72019 
Train step: 480 acc:0.68061 total_loss: 1.2638  loss:1.3118,stance loss: 1.4169 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.6875 total_loss: 1.2365  loss:1.2365,stance loss: 0.97408 
Train step: 500 acc:0.64205 total_loss: 1.2184  loss:1.4251,stance loss: 1.0468 
Train step: 510 acc:0.65774 total_loss: 1.2349  loss:1.1721,stance loss: 0.84784 
Train step: 520 acc:0.68548 total_loss: 1.1644  loss:0.61213,stance loss: 0.42809 
Train step: 530 acc:0.69817 total_loss: 1.1588  loss:0.84756,stance loss: 0.69277 
Train step: 540 acc:0.70833 total_loss: 1.1524  loss:1.4432,stance loss: 1.1041 
Train step: 550 acc:0.71004 total_loss: 1.1572  loss:0.80677,stance loss: 0.64459 
Train step: 560 acc:0.70951 total_loss: 1.1516  loss:0.79458,stance loss: 0.5803 
Train step: 570 acc:0.71296 total_loss: 1.1423  loss:1.0498,stance loss: 0.83535 
Train step: 580 acc:0.70398 total_loss: 1.1561  loss:1.104,stance loss: 0.83855 
Train step: 590 acc:0.69926 total_loss: 1.1541  loss:1.6352,stance loss: 1.654 
Train step: 600 acc:0.6982 total_loss: 1.1552  loss:1.3201,stance loss: 0.93274 
Train step: 610 acc:0.70351 total_loss: 1.1484  loss:1.2599,stance loss: 1.0863 
Train step: 620 acc:0.70611 total_loss: 1.1563  loss:1.2613,stance loss: 0.75075 
Train step: 630 acc:0.70656 total_loss: 1.158  loss:1.2043,stance loss: 0.95043 
Train step: 640 acc:0.70406 total_loss: 1.1571  loss:1.1516,stance loss: 1.0136 
Train step: 650 acc:0.70691 total_loss: 1.16  loss:1.1476,stance loss: 0.93507 
Train step: 660 acc:0.70797 total_loss: 1.1564  loss:1.3677,stance loss: 0.98488 
Train step: 670 acc:0.70822 total_loss: 1.1547  loss:1.5075,stance loss: 1.5694 
Train step: 680 acc:0.70844 total_loss: 1.1524  loss:1.0278,stance loss: 0.7752 
Train step: 690 acc:0.70958 total_loss: 1.1535  loss:1.379,stance loss: 1.242 
Train step: 700 acc:0.70764 total_loss: 1.1558  loss:1.1735,stance loss: 0.89672 
Train step: 710 acc:0.70843 total_loss: 1.1573  loss:0.76938,stance loss: 0.64907 
Train step: 720 acc:0.70969 total_loss: 1.1582  loss:1.2607,stance loss: 1.1095 
Train step: 730 acc:0.70747 total_loss: 1.1594  loss:1.369,stance loss: 1.0344 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.6875 total_loss: 1.0864  loss:1.287,stance loss: 0.91366 
Train step: 750 acc:0.70312 total_loss: 1.0721  loss:0.86321,stance loss: 0.69383 
Train step: 760 acc:0.72837 total_loss: 1.0553  loss:1.1066,stance loss: 0.84621 
Train step: 770 acc:0.72396 total_loss: 1.0653  loss:1.2574,stance loss: 1.0738 
Train step: 780 acc:0.72554 total_loss: 1.081  loss:1.6979,stance loss: 1.7388 
Train step: 790 acc:0.72098 total_loss: 1.0687  loss:1.106,stance loss: 0.94109 
Train step: 800 acc:0.72633 total_loss: 1.0705  loss:0.99976,stance loss: 0.69474 
Train step: 810 acc:0.72368 total_loss: 1.0817  loss:1.6346,stance loss: 1.0512 
Train step: 820 acc:0.72166 total_loss: 1.0861  loss:1.0941,stance loss: 0.80943 
Train step: 830 acc:0.7168 total_loss: 1.1073  loss:1.5336,stance loss: 1.7116 
Train step: 840 acc:0.71285 total_loss: 1.1211  loss:1.7353,stance loss: 1.4278 
Train step: 850 acc:0.71498 total_loss: 1.1104  loss:0.70296,stance loss: 0.53183 
Train step: 860 acc:0.71925 total_loss: 1.0967  loss:1.3776,stance loss: 1.1405 
Train step: 870 acc:0.71691 total_loss: 1.094  loss:0.90331,stance loss: 0.71332 
Train step: 880 acc:0.72132 total_loss: 1.0814  loss:0.79647,stance loss: 0.621 
Train step: 890 acc:0.72196 total_loss: 1.0771  loss:1.0085,stance loss: 0.65671 
Train step: 900 acc:0.7195 total_loss: 1.08  loss:1.0644,stance loss: 0.79782 
Train step: 910 acc:0.72159 total_loss: 1.0707  loss:0.85978,stance loss: 0.75365 
Train step: 920 acc:0.72077 total_loss: 1.0712  loss:1.3576,stance loss: 1.2777 
Train step: 930 acc:0.72353 total_loss: 1.0682  loss:0.87865,stance loss: 0.69411 
Train step: 940 acc:0.72542 total_loss: 1.0632  loss:1.0644,stance loss: 0.60325 
Train step: 950 acc:0.72512 total_loss: 1.068  loss:1.0669,stance loss: 0.80759 
Train step: 960 acc:0.72345 total_loss: 1.0638  loss:0.64718,stance loss: 0.40844 
Train step: 970 acc:0.72246 total_loss: 1.0636  loss:0.9443,stance loss: 0.6171 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.5 total_loss: 1.2894  loss:1.2894,stance loss: 0.95666 
Train step: 990 acc:0.73295 total_loss: 0.88465  loss:0.95644,stance loss: 0.74191 
Train step: 1000 acc:0.74405 total_loss: 0.94375  loss:1.1729,stance loss: 1.1335 
Train step: 1010 acc:0.75605 total_loss: 0.93844  loss:1.1698,stance loss: 0.81602 
Train step: 1020 acc:0.74238 total_loss: 1.001  loss:1.3672,stance loss: 1.0456 
Train step: 1030 acc:0.74387 total_loss: 0.99789  loss:0.82795,stance loss: 0.68963 
Train step: 1040 acc:0.75102 total_loss: 0.97448  loss:0.81685,stance loss: 0.65617 
Train step: 1050 acc:0.75528 total_loss: 0.98107  loss:0.9398,stance loss: 0.67996 
Train step: 1060 acc:0.7608 total_loss: 0.97289  loss:1.0795,stance loss: 0.8817 
Train step: 1070 acc:0.76099 total_loss: 0.96649  loss:0.72993,stance loss: 0.5204 
Train step: 1080 acc:0.75804 total_loss: 0.98008  loss:0.81405,stance loss: 0.64085 
Train step: 1090 acc:0.75225 total_loss: 1.0013  loss:1.516,stance loss: 1.188 
Train step: 1100 acc:0.74793 total_loss: 1.0044  loss:0.91345,stance loss: 0.74537 
Train step: 1110 acc:0.74809 total_loss: 1.0056  loss:1.0444,stance loss: 0.77025 
Train step: 1120 acc:0.75222 total_loss: 1.0015  loss:0.65382,stance loss: 0.48297 
Train step: 1130 acc:0.75497 total_loss: 1.0051  loss:1.1167,stance loss: 0.89397 
Train step: 1140 acc:0.75272 total_loss: 1.0044  loss:0.85838,stance loss: 0.64918 
Train step: 1150 acc:0.75292 total_loss: 0.99707  loss:0.86359,stance loss: 0.66112 
Train step: 1160 acc:0.7462 total_loss: 1.0128  loss:1.7252,stance loss: 1.6611 
Train step: 1170 acc:0.74476 total_loss: 1.0117  loss:0.76053,stance loss: 0.54309 
Train step: 1180 acc:0.7444 total_loss: 1.0125  loss:1.1516,stance loss: 0.80847 
Train step: 1190 acc:0.74496 total_loss: 1.0093  loss:1.0899,stance loss: 0.73155 
Train step: 1200 acc:0.74519 total_loss: 1.005  loss:0.69247,stance loss: 0.53796 
Train step: 1210 acc:0.74892 total_loss: 0.99895  loss:0.82997,stance loss: 0.7943 
Train step: 1220 acc:0.74793 total_loss: 0.99533  loss:0.50613,stance loss: 0.36724 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.77083 total_loss: 0.7689  loss:0.89629,stance loss: 0.70716 
Train step: 1240 acc:0.80859 total_loss: 0.8405  loss:0.89662,stance loss: 0.6541 
Train step: 1250 acc:0.78125 total_loss: 0.90283  loss:0.67857,stance loss: 0.56468 
Train step: 1260 acc:0.78646 total_loss: 0.88343  loss:0.63725,stance loss: 0.56337 
Train step: 1270 acc:0.7894 total_loss: 0.86427  loss:0.44569,stance loss: 0.23197 
Train step: 1280 acc:0.79129 total_loss: 0.86477  loss:0.53804,stance loss: 0.41554 
Train step: 1290 acc:0.78314 total_loss: 0.88805  loss:0.96767,stance loss: 0.69158 
Train step: 1300 acc:0.78207 total_loss: 0.88362  loss:1.1133,stance loss: 0.77277 
Train step: 1310 acc:0.77689 total_loss: 0.89569  loss:0.91218,stance loss: 0.77519 
Train step: 1320 acc:0.77409 total_loss: 0.90549  loss:1.0412,stance loss: 0.9611 
Train step: 1330 acc:0.77005 total_loss: 0.90132  loss:0.86565,stance loss: 0.52161 
Train step: 1340 acc:0.77263 total_loss: 0.89323  loss:0.92506,stance loss: 0.69253 
Train step: 1350 acc:0.77431 total_loss: 0.89369  loss:1.2274,stance loss: 1.4348 
Train step: 1360 acc:0.77482 total_loss: 0.88733  loss:0.7654,stance loss: 0.48415 
Train step: 1370 acc:0.77783 total_loss: 0.88244  loss:0.58903,stance loss: 0.49503 
Train step: 1380 acc:0.77925 total_loss: 0.88658  loss:1.0734,stance loss: 1.1348 
Train step: 1390 acc:0.77899 total_loss: 0.88579  loss:1.1318,stance loss: 1.0248 
Train step: 1400 acc:0.7777 total_loss: 0.88053  loss:0.83759,stance loss: 0.67559 
Better F1! Saving model!
Saving model of best f1: 0.36007554354501903
              precision    recall  f1-score   support

           0   0.610429  0.778865  0.684437       511
           1   0.470175  0.788235  0.589011       170
           2   0.416667  0.018657  0.035714       268

    accuracy                       0.565859       949
   macro avg   0.499091  0.528586  0.436387       949
weighted avg   0.530586  0.565859  0.484142       949

Test Acc: 0.565858798735511 F1_ma:0.36007554354501903
Train step: 1410 acc:0.77722 total_loss: 0.88166  loss:1.5762,stance loss: 1.4486 
Train step: 1420 acc:0.77519 total_loss: 0.88501  loss:0.99191,stance loss: 0.94654 
Train step: 1430 acc:0.77579 total_loss: 0.88952  loss:0.69174,stance loss: 0.54927 
Train step: 1440 acc:0.77459 total_loss: 0.89536  loss:1.0705,stance loss: 0.88222 
Train step: 1450 acc:0.77461 total_loss: 0.89874  loss:1.021,stance loss: 1.0166 
Train step: 1460 acc:0.77489 total_loss: 0.89891  loss:1.0418,stance loss: 0.81207 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.75 total_loss: 0.80709  loss:0.80709,stance loss: 0.66186 
Better F1! Saving model!
Saving model of best f1: 0.3690075141263186
              precision    recall  f1-score   support

           0   0.607784  0.794521  0.688719       511
           1   0.479245  0.747059  0.583908       170
           2   0.437500  0.026119  0.049296       268

    accuracy                       0.569020       949
   macro avg   0.508177  0.522566  0.440641       949
weighted avg   0.536670  0.569020  0.489369       949

Test Acc: 0.5690200210748156 F1_ma:0.3690075141263186
Train step: 1480 acc:0.80114 total_loss: 0.79648  loss:0.57133,stance loss: 0.38375 
Train step: 1490 acc:0.8125 total_loss: 0.81512  loss:1.3269,stance loss: 1.5982 
Train step: 1500 acc:0.80444 total_loss: 0.81177  loss:0.66979,stance loss: 0.45875 
Train step: 1510 acc:0.79268 total_loss: 0.83809  loss:1.184,stance loss: 1.2556 
Better F1! Saving model!
Saving model of best f1: 0.3708630145621888
              precision    recall  f1-score   support

           0   0.631218  0.720157  0.672761       511
           1   0.430233  0.870588  0.575875       170
           2   0.454545  0.037313  0.068966       268

    accuracy                       0.554268       949
   macro avg   0.505332  0.542686  0.439201       949
weighted avg   0.545321  0.554268  0.484892       949

Test Acc: 0.5542676501580611 F1_ma:0.3708630145621888
Train step: 1520 acc:0.79534 total_loss: 0.8195  loss:0.75601,stance loss: 0.63933 
Train step: 1530 acc:0.78996 total_loss: 0.82378  loss:0.94902,stance loss: 0.84349 
Train step: 1540 acc:0.78873 total_loss: 0.81428  loss:0.73452,stance loss: 0.60604 
Better F1! Saving model!
Saving model of best f1: 0.3804184329276631
              precision    recall  f1-score   support

           0   0.631769  0.684932  0.657277       511
           1   0.420904  0.876471  0.568702       170
           2   0.390244  0.059701  0.103560       268

    accuracy                       0.542677       949
   macro avg   0.480972  0.540368  0.443180       949
weighted avg   0.525788  0.542677  0.485039       949

Test Acc: 0.5426765015806112 F1_ma:0.3804184329276631
Train step: 1550 acc:0.79784 total_loss: 0.79043  loss:0.43152,stance loss: 0.3605 
Train step: 1560 acc:0.79808 total_loss: 0.7831  loss:0.20012,stance loss: 0.071524 
Train step: 1570 acc:0.79703 total_loss: 0.78459  loss:0.52875,stance loss: 0.4343 
Train step: 1580 acc:0.79392 total_loss: 0.7933  loss:0.73154,stance loss: 0.55012 
Train step: 1590 acc:0.797 total_loss: 0.79585  loss:1.1033,stance loss: 0.9718 
Train step: 1600 acc:0.79389 total_loss: 0.8048  loss:0.73021,stance loss: 0.62276 
Better F1! Saving model!
Saving model of best f1: 0.4127804096142706
              precision    recall  f1-score   support

           0   0.616071  0.675147  0.644258       511
           1   0.450658  0.805882  0.578059       170
           2   0.376471  0.119403  0.181303       268

    accuracy                       0.541623       949
   macro avg   0.481067  0.533477  0.467873       949
weighted avg   0.518776  0.541623  0.501660       949

Test Acc: 0.541622760800843 F1_ma:0.4127804096142706
Train step: 1610 acc:0.79832 total_loss: 0.80811  loss:0.71255,stance loss: 0.52345 
Train step: 1620 acc:0.79801 total_loss: 0.80629  loss:0.95315,stance loss: 0.85716 
Train step: 1630 acc:0.79697 total_loss: 0.8065  loss:1.3314,stance loss: 1.4859 
Train step: 1640 acc:0.79532 total_loss: 0.80694  loss:0.24366,stance loss: 0.059863 
Train step: 1650 acc:0.79972 total_loss: 0.80593  loss:0.37995,stance loss: 0.26355 
Train step: 1660 acc:0.79941 total_loss: 0.80472  loss:0.48556,stance loss: 0.45792 
Train step: 1670 acc:0.80006 total_loss: 0.80263  loss:0.58956,stance loss: 0.47521 
Train step: 1680 acc:0.80036 total_loss: 0.79795  loss:0.83976,stance loss: 0.61661 
Train step: 1690 acc:0.79921 total_loss: 0.79677  loss:0.77494,stance loss: 0.70954 
Train step: 1700 acc:0.80032 total_loss: 0.79342  loss:0.82972,stance loss: 0.7256 
Train step: 1710 acc:0.80239 total_loss: 0.79008  loss:0.88147,stance loss: 1.2403 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.77083 total_loss: 0.7179  loss:0.44424,stance loss: 0.36603 
Train step: 1730 acc:0.8125 total_loss: 0.7433  loss:0.48282,stance loss: 0.37053 
Better F1! Saving model!
Saving model of best f1: 0.418984888855764
              precision    recall  f1-score   support

           0   0.607710  0.524462  0.563025       511
           1   0.436923  0.835294  0.573737       170
           2   0.338798  0.231343  0.274945       268

    accuracy                       0.497366       949
   macro avg   0.461144  0.530366  0.470569       949
weighted avg   0.501174  0.497366  0.483589       949

Test Acc: 0.49736564805057953 F1_ma:0.418984888855764
Train step: 1740 acc:0.82933 total_loss: 0.74277  loss:1.2264,stance loss: 1.51 
Train step: 1750 acc:0.84028 total_loss: 0.7074  loss:0.52553,stance loss: 0.38377 
Train step: 1760 acc:0.83832 total_loss: 0.72795  loss:0.60857,stance loss: 0.51347 
Train step: 1770 acc:0.8404 total_loss: 0.70689  loss:0.6748,stance loss: 0.57741 
Train step: 1780 acc:0.83996 total_loss: 0.70874  loss:0.65027,stance loss: 0.40521 
Train step: 1790 acc:0.8347 total_loss: 0.724  loss:1.2685,stance loss: 0.93392 
Better F1! Saving model!
Saving model of best f1: 0.432769400097582
              precision    recall  f1-score   support

           0   0.599602  0.589041  0.594274       511
           1   0.475000  0.782353  0.591111       170
           2   0.353293  0.220149  0.271264       268

    accuracy                       0.519494       949
   macro avg   0.475965  0.530514  0.485550       949
weighted avg   0.507723  0.519494  0.502489       949

Test Acc: 0.5194942044257113 F1_ma:0.432769400097582
Train step: 1800 acc:0.82994 total_loss: 0.72912  loss:1.1862,stance loss: 1.1957 
Train step: 1810 acc:0.83008 total_loss: 0.72618  loss:0.43436,stance loss: 0.28762 
Train step: 1820 acc:0.82901 total_loss: 0.72583  loss:0.82225,stance loss: 0.57357 
Train step: 1830 acc:0.82328 total_loss: 0.72308  loss:0.79903,stance loss: 0.46241 
Train step: 1840 acc:0.82391 total_loss: 0.7116  loss:0.49386,stance loss: 0.34874 
Train step: 1850 acc:0.82399 total_loss: 0.70943  loss:0.23902,stance loss: 0.10473 
Train step: 1860 acc:0.82534 total_loss: 0.71051  loss:0.552,stance loss: 0.45616 
Train step: 1870 acc:0.82692 total_loss: 0.70707  loss:0.48403,stance loss: 0.38561 
Train step: 1880 acc:0.82681 total_loss: 0.71326  loss:0.62745,stance loss: 0.46132 
Train step: 1890 acc:0.82457 total_loss: 0.71972  loss:0.77296,stance loss: 0.5259 
Train step: 1900 acc:0.82628 total_loss: 0.71457  loss:1.0065,stance loss: 0.73947 
Train step: 1910 acc:0.82589 total_loss: 0.7254  loss:0.49104,stance loss: 0.33437 
Train step: 1920 acc:0.82646 total_loss: 0.72577  loss:0.88085,stance loss: 0.68351 
Train step: 1930 acc:0.82292 total_loss: 0.73415  loss:0.83894,stance loss: 0.50794 
Train step: 1940 acc:0.82522 total_loss: 0.73413  loss:1.1774,stance loss: 1.5332 
Train step: 1950 acc:0.82548 total_loss: 0.7356  loss:0.82215,stance loss: 0.77663 
Better F1! Saving model!
Saving model of best f1: 0.4385682417453129
              precision    recall  f1-score   support

           0   0.600000  0.669276  0.632747       511
           1   0.479675  0.694118  0.567308       170
           2   0.368421  0.182836  0.244389       268

    accuracy                       0.536354       949
   macro avg   0.482699  0.515410  0.481481       949
weighted avg   0.513047  0.536354  0.511351       949

Test Acc: 0.5363540569020021 F1_ma:0.4385682417453129
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:1.0 total_loss: 0.28461  loss:0.28461,stance loss: 0.16827 
Train step: 1970 acc:0.81818 total_loss: 0.59453  loss:0.99202,stance loss: 0.76091 
Train step: 1980 acc:0.80952 total_loss: 0.65236  loss:0.64193,stance loss: 0.5715 
Train step: 1990 acc:0.8246 total_loss: 0.65902  loss:0.41364,stance loss: 0.34822 
Train step: 2000 acc:0.82927 total_loss: 0.6445  loss:0.72752,stance loss: 0.5447 
Train step: 2010 acc:0.83701 total_loss: 0.63735  loss:0.6553,stance loss: 0.53614 
Train step: 2020 acc:0.84016 total_loss: 0.64229  loss:0.62295,stance loss: 0.49986 
Train step: 2030 acc:0.85035 total_loss: 0.6177  loss:0.32171,stance loss: 0.2404 
Train step: 2040 acc:0.84259 total_loss: 0.62996  loss:0.47106,stance loss: 0.35588 
Better F1! Saving model!
Saving model of best f1: 0.43859127231935036
              precision    recall  f1-score   support

           0   0.598148  0.632094  0.614653       511
           1   0.484496  0.735294  0.584112       170
           2   0.364238  0.205224  0.262530       268

    accuracy                       0.530032       949
   macro avg   0.482294  0.524204  0.487098       949
weighted avg   0.511732  0.530032  0.509741       949

Test Acc: 0.530031612223393 F1_ma:0.43859127231935036
Train step: 2050 acc:0.84409 total_loss: 0.62499  loss:0.87038,stance loss: 1.1058 
Train step: 2060 acc:0.84963 total_loss: 0.61848  loss:0.65286,stance loss: 0.51337 
Train step: 2070 acc:0.84797 total_loss: 0.61688  loss:0.77488,stance loss: 0.71501 
Train step: 2080 acc:0.84814 total_loss: 0.61356  loss:1.0726,stance loss: 0.60718 
Train step: 2090 acc:0.84781 total_loss: 0.61987  loss:0.697,stance loss: 0.55405 
Train step: 2100 acc:0.85062 total_loss: 0.61183  loss:0.40465,stance loss: 0.35726 
Train step: 2110 acc:0.84975 total_loss: 0.60731  loss:0.5752,stance loss: 0.5344 
Train step: 2120 acc:0.8521 total_loss: 0.60769  loss:0.57983,stance loss: 0.39126 
Better F1! Saving model!
Saving model of best f1: 0.4415389427588363
              precision    recall  f1-score   support

           0   0.606870  0.622309  0.614493       511
           1   0.463768  0.752941  0.573991       170
           2   0.375839  0.208955  0.268585       268

    accuracy                       0.528978       949
   macro avg   0.482159  0.528069  0.485690       949
weighted avg   0.515992  0.528978  0.509552       949

Test Acc: 0.5289778714436248 F1_ma:0.4415389427588363
Train step: 2130 acc:0.85344 total_loss: 0.60776  loss:0.53262,stance loss: 0.37668 
Train step: 2140 acc:0.85428 total_loss: 0.61278  loss:0.39589,stance loss: 0.27113 
Train step: 2150 acc:0.85438 total_loss: 0.61209  loss:0.64534,stance loss: 0.50009 
Train step: 2160 acc:0.8551 total_loss: 0.61149  loss:0.53165,stance loss: 0.39593 
Train step: 2170 acc:0.85634 total_loss: 0.60831  loss:0.21442,stance loss: 0.19868 
Train step: 2180 acc:0.85662 total_loss: 0.61083  loss:1.203,stance loss: 0.91057 
Train step: 2190 acc:0.85687 total_loss: 0.61368  loss:0.70916,stance loss: 0.63385 
Train step: 2200 acc:0.85555 total_loss: 0.61613  loss:0.67428,stance loss: 0.57291 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.85417 total_loss: 0.60938  loss:0.9892,stance loss: 1.1733 
Train step: 2220 acc:0.85938 total_loss: 0.66478  loss:0.55837,stance loss: 0.55719 
Train step: 2230 acc:0.87019 total_loss: 0.61086  loss:0.28005,stance loss: 0.11211 
Train step: 2240 acc:0.88021 total_loss: 0.556  loss:0.37082,stance loss: 0.31778 
Train step: 2250 acc:0.875 total_loss: 0.5935  loss:0.59348,stance loss: 0.407 
Train step: 2260 acc:0.87612 total_loss: 0.58848  loss:1.2105,stance loss: 1.5166 
Train step: 2270 acc:0.87595 total_loss: 0.57223  loss:0.44649,stance loss: 0.35615 
Train step: 2280 acc:0.87582 total_loss: 0.58084  loss:0.56026,stance loss: 0.39245 
Train step: 2290 acc:0.88081 total_loss: 0.57144  loss:0.24926,stance loss: 0.15413 
Train step: 2300 acc:0.88216 total_loss: 0.56248  loss:0.69767,stance loss: 0.53693 
Train step: 2310 acc:0.88149 total_loss: 0.56483  loss:0.32445,stance loss: 0.26953 
Train step: 2320 acc:0.88308 total_loss: 0.55791  loss:0.77462,stance loss: 0.59073 
Train step: 2330 acc:0.87946 total_loss: 0.56367  loss:0.52323,stance loss: 0.44778 
Train step: 2340 acc:0.87914 total_loss: 0.56041  loss:0.83808,stance loss: 1.0694 
Train step: 2350 acc:0.875 total_loss: 0.56653  loss:0.72937,stance loss: 0.54459 
Train step: 2360 acc:0.8758 total_loss: 0.56243  loss:0.96051,stance loss: 0.51494 
Train step: 2370 acc:0.87312 total_loss: 0.56641  loss:0.62316,stance loss: 0.45346 
Train step: 2380 acc:0.87287 total_loss: 0.57238  loss:0.44476,stance loss: 0.38007 
Train step: 2390 acc:0.87265 total_loss: 0.57375  loss:0.31407,stance loss: 0.30138 
Train step: 2400 acc:0.87245 total_loss: 0.57193  loss:0.52889,stance loss: 0.51995 
Train step: 2410 acc:0.875 total_loss: 0.56416  loss:0.40242,stance loss: 0.34558 
Train step: 2420 acc:0.87616 total_loss: 0.55618  loss:0.33654,stance loss: 0.31344 
Train step: 2430 acc:0.87611 total_loss: 0.55591  loss:1.001,stance loss: 0.73221 
Train step: 2440 acc:0.87712 total_loss: 0.55415  loss:0.54116,stance loss: 0.45318 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:1.0 total_loss: 0.21048  loss:0.21048,stance loss: 0.14967 
Train step: 2460 acc:0.9375 total_loss: 0.47214  loss:0.30939,stance loss: 0.3089 
Train step: 2470 acc:0.90476 total_loss: 0.48541  loss:0.44019,stance loss: 0.3033 
Train step: 2480 acc:0.90121 total_loss: 0.50498  loss:0.95437,stance loss: 1.3257 
Train step: 2490 acc:0.89939 total_loss: 0.49414  loss:0.66613,stance loss: 0.49212 
Train step: 2500 acc:0.89216 total_loss: 0.50316  loss:0.41558,stance loss: 0.26165 
Train step: 2510 acc:0.89242 total_loss: 0.50517  loss:0.56839,stance loss: 0.36239 
Train step: 2520 acc:0.89525 total_loss: 0.48979  loss:0.28068,stance loss: 0.24444 
Train step: 2530 acc:0.89429 total_loss: 0.4993  loss:0.64561,stance loss: 1.0238 
Train step: 2540 acc:0.89766 total_loss: 0.4903  loss:0.12099,stance loss: 0.12317 
Train step: 2550 acc:0.89913 total_loss: 0.48944  loss:0.2676,stance loss: 0.19363 
Train step: 2560 acc:0.89809 total_loss: 0.48339  loss:0.29845,stance loss: 0.16139 
Train step: 2570 acc:0.90186 total_loss: 0.4696  loss:0.31184,stance loss: 0.22678 
Train step: 2580 acc:0.90315 total_loss: 0.46503  loss:0.2111,stance loss: 0.15859 
Train step: 2590 acc:0.90204 total_loss: 0.47292  loss:0.21771,stance loss: 0.15698 
Train step: 2600 acc:0.90315 total_loss: 0.47004  loss:0.5202,stance loss: 0.41444 
Train step: 2610 acc:0.90179 total_loss: 0.48004  loss:0.27238,stance loss: 0.2107 
Train step: 2620 acc:0.90132 total_loss: 0.4819  loss:0.44019,stance loss: 0.14817 
Train step: 2630 acc:0.90193 total_loss: 0.47901  loss:0.23003,stance loss: 0.1292 
Train step: 2640 acc:0.90118 total_loss: 0.4815  loss:0.17268,stance loss: 0.089079 
Train step: 2650 acc:0.90267 total_loss: 0.47495  loss:0.089033,stance loss: 0.041664 
Train step: 2660 acc:0.89959 total_loss: 0.48229  loss:1.0988,stance loss: 1.4748 
Train step: 2670 acc:0.89791 total_loss: 0.48659  loss:0.44565,stance loss: 0.40598 
Train step: 2680 acc:0.89746 total_loss: 0.48729  loss:0.65831,stance loss: 0.56232 
Train step: 2690 acc:0.89704 total_loss: 0.48568  loss:0.51881,stance loss: 0.42641 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.96875 total_loss: 0.54838  loss:0.18704,stance loss: 0.16891 
Train step: 2710 acc:0.93359 total_loss: 0.47279  loss:0.29153,stance loss: 0.16577 
Train step: 2720 acc:0.93029 total_loss: 0.45734  loss:0.30529,stance loss: 0.27251 
Train step: 2730 acc:0.92708 total_loss: 0.44974  loss:0.37799,stance loss: 0.28284 
Train step: 2740 acc:0.92663 total_loss: 0.43928  loss:0.35801,stance loss: 0.28603 
Train step: 2750 acc:0.91741 total_loss: 0.47366  loss:0.2273,stance loss: 0.18258 
Train step: 2760 acc:0.91761 total_loss: 0.44339  loss:0.20742,stance loss: 0.17306 
Train step: 2770 acc:0.91036 total_loss: 0.44333  loss:0.48581,stance loss: 0.35209 
Train step: 2780 acc:0.9048 total_loss: 0.45243  loss:0.40289,stance loss: 0.31753 
Train step: 2790 acc:0.90495 total_loss: 0.44581  loss:0.53475,stance loss: 0.40355 
Train step: 2800 acc:0.90684 total_loss: 0.44499  loss:0.17186,stance loss: 0.11579 
Train step: 2810 acc:0.91056 total_loss: 0.42933  loss:0.23118,stance loss: 0.18464 
Train step: 2820 acc:0.91171 total_loss: 0.42937  loss:0.14354,stance loss: 0.038247 
Train step: 2830 acc:0.9136 total_loss: 0.42947  loss:0.3518,stance loss: 0.23355 
Train step: 2840 acc:0.91182 total_loss: 0.43257  loss:0.39903,stance loss: 0.27789 
Train step: 2850 acc:0.91146 total_loss: 0.43439  loss:0.72261,stance loss: 1.0992 
Train step: 2860 acc:0.91378 total_loss: 0.42385  loss:0.16338,stance loss: 0.058911 
Train step: 2870 acc:0.91335 total_loss: 0.42257  loss:0.11179,stance loss: 0.048491 
Train step: 2880 acc:0.91196 total_loss: 0.43033  loss:0.78043,stance loss: 1.1611 
Train step: 2890 acc:0.91263 total_loss: 0.43024  loss:0.44685,stance loss: 0.24806 
Train step: 2900 acc:0.91292 total_loss: 0.43226  loss:1.4969,stance loss: 1.9128 
Train step: 2910 acc:0.91204 total_loss: 0.43719  loss:0.18107,stance loss: 0.066193 
Train step: 2920 acc:0.9115 total_loss: 0.43582  loss:0.22421,stance loss: 0.16607 
Train step: 2930 acc:0.91208 total_loss: 0.4387  loss:0.9568,stance loss: 0.72343 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.15815  loss:0.15815,stance loss: 0.14377 
Train step: 2950 acc:0.94886 total_loss: 0.28626  loss:0.41508,stance loss: 0.083365 
Train step: 2960 acc:0.92857 total_loss: 0.38173  loss:0.15548,stance loss: 0.12157 
Train step: 2970 acc:0.9254 total_loss: 0.41248  loss:0.29456,stance loss: 0.24823 
Train step: 2980 acc:0.9253 total_loss: 0.40381  loss:0.14172,stance loss: 0.072277 
Train step: 2990 acc:0.91912 total_loss: 0.40136  loss:0.63913,stance loss: 0.44637 
Train step: 3000 acc:0.91393 total_loss: 0.40628  loss:0.58564,stance loss: 0.63356 
Train step: 3010 acc:0.91461 total_loss: 0.39694  loss:0.12095,stance loss: 0.075645 
Train step: 3020 acc:0.91821 total_loss: 0.39193  loss:0.29067,stance loss: 0.2656 
Train step: 3030 acc:0.91896 total_loss: 0.39253  loss:0.24447,stance loss: 0.17406 
Train step: 3040 acc:0.91894 total_loss: 0.40984  loss:0.21043,stance loss: 0.1739 
Train step: 3050 acc:0.92005 total_loss: 0.40233  loss:0.29343,stance loss: 0.25086 
Train step: 3060 acc:0.91839 total_loss: 0.40998  loss:0.10633,stance loss: 0.078532 
Train step: 3070 acc:0.91889 total_loss: 0.42363  loss:0.1473,stance loss: 0.10519 
Train step: 3080 acc:0.91977 total_loss: 0.42173  loss:0.54445,stance loss: 0.43232 
Train step: 3090 acc:0.92053 total_loss: 0.41527  loss:0.089535,stance loss: 0.052215 
Train step: 3100 acc:0.9212 total_loss: 0.41511  loss:0.87922,stance loss: 0.70712 
Train step: 3110 acc:0.92288 total_loss: 0.40894  loss:0.090025,stance loss: 0.033667 
Train step: 3120 acc:0.92231 total_loss: 0.4038  loss:0.90829,stance loss: 1.221 
Train step: 3130 acc:0.92016 total_loss: 0.41208  loss:1.1894,stance loss: 1.5407 
Train step: 3140 acc:0.92102 total_loss: 0.41256  loss:0.072876,stance loss: 0.021927 
Train step: 3150 acc:0.92062 total_loss: 0.40948  loss:0.18576,stance loss: 0.047719 
Train step: 3160 acc:0.92053 total_loss: 0.40606  loss:0.55827,stance loss: 0.52771 
Train step: 3170 acc:0.92316 total_loss: 0.39873  loss:0.94654,stance loss: 1.3055 
Train step: 3180 acc:0.92427 total_loss: 0.39387  loss:0.13976,stance loss: 0.015893 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.95833 total_loss: 0.15621  loss:0.067405,stance loss: 0.040371 
Train step: 3200 acc:0.94922 total_loss: 0.31235  loss:0.14287,stance loss: 0.067329 
Train step: 3210 acc:0.94952 total_loss: 0.31859  loss:0.19505,stance loss: 0.26259 
Train step: 3220 acc:0.95486 total_loss: 0.30249  loss:0.66367,stance loss: 1.086 
Train step: 3230 acc:0.95516 total_loss: 0.29394  loss:0.58445,stance loss: 0.6165 
Train step: 3240 acc:0.94978 total_loss: 0.30608  loss:0.16,stance loss: 0.076084 
Train step: 3250 acc:0.94223 total_loss: 0.32738  loss:0.73113,stance loss: 1.0234 
Train step: 3260 acc:0.9449 total_loss: 0.30509  loss:0.083732,stance loss: 0.051871 
Train step: 3270 acc:0.94767 total_loss: 0.30301  loss:0.58734,stance loss: 1.0539 
Train step: 3280 acc:0.94661 total_loss: 0.30662  loss:0.04802,stance loss: 0.010069 
Train step: 3290 acc:0.94458 total_loss: 0.31707  loss:0.62627,stance loss: 0.4955 
Train step: 3300 acc:0.94235 total_loss: 0.32482  loss:0.82574,stance loss: 1.1833 
Train step: 3310 acc:0.94246 total_loss: 0.331  loss:0.19545,stance loss: 0.20416 
Train step: 3320 acc:0.94256 total_loss: 0.3282  loss:0.53116,stance loss: 0.48394 
Train step: 3330 acc:0.94264 total_loss: 0.33321  loss:0.40679,stance loss: 0.31241 
Train step: 3340 acc:0.94191 total_loss: 0.33379  loss:0.19792,stance loss: 0.13889 
Train step: 3350 acc:0.94428 total_loss: 0.32631  loss:0.18382,stance loss: 0.138 
Train step: 3360 acc:0.94354 total_loss: 0.33147  loss:0.22777,stance loss: 0.077098 
Train step: 3370 acc:0.9422 total_loss: 0.3414  loss:0.49873,stance loss: 0.41548 
Train step: 3380 acc:0.94133 total_loss: 0.34046  loss:0.27057,stance loss: 0.22741 
Train step: 3390 acc:0.93962 total_loss: 0.34095  loss:0.23853,stance loss: 0.22477 
Train step: 3400 acc:0.93924 total_loss: 0.34357  loss:0.098276,stance loss: 0.069076 
Train step: 3410 acc:0.93805 total_loss: 0.34083  loss:0.30105,stance loss: 0.25985 
Train step: 3420 acc:0.93697 total_loss: 0.34532  loss:0.51513,stance loss: 0.299 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:1.0 total_loss: 0.071408  loss:0.071408,stance loss: 0.040472 
Train step: 3440 acc:0.96023 total_loss: 0.22287  loss:0.19135,stance loss: 0.14111 
Train step: 3450 acc:0.95238 total_loss: 0.2741  loss:1.4846,stance loss: 1.2798 
Train step: 3460 acc:0.94758 total_loss: 0.26945  loss:0.25201,stance loss: 0.23519 
Train step: 3470 acc:0.94055 total_loss: 0.30378  loss:0.42589,stance loss: 0.40872 
Train step: 3480 acc:0.94485 total_loss: 0.30283  loss:0.088097,stance loss: 0.055761 
Train step: 3490 acc:0.94467 total_loss: 0.316  loss:0.56713,stance loss: 0.41535 
Train step: 3500 acc:0.94454 total_loss: 0.31033  loss:0.17188,stance loss: 0.13668 
Train step: 3510 acc:0.94676 total_loss: 0.30456  loss:0.054111,stance loss: 0.0065573 
Train step: 3520 acc:0.94574 total_loss: 0.30359  loss:0.18572,stance loss: 0.19181 
Train step: 3530 acc:0.94616 total_loss: 0.29781  loss:0.10805,stance loss: 0.029608 
Train step: 3540 acc:0.94764 total_loss: 0.29337  loss:0.10759,stance loss: 0.071111 
Train step: 3550 acc:0.94783 total_loss: 0.28407  loss:0.12874,stance loss: 0.098551 
Train step: 3560 acc:0.95038 total_loss: 0.2925  loss:0.16921,stance loss: 0.18229 
Train step: 3570 acc:0.94991 total_loss: 0.28814  loss:0.19774,stance loss: 0.19301 
Train step: 3580 acc:0.94702 total_loss: 0.2999  loss:0.44866,stance loss: 0.31715 
Train step: 3590 acc:0.94798 total_loss: 0.29756  loss:0.2208,stance loss: 0.21745 
Train step: 3600 acc:0.94773 total_loss: 0.29434  loss:0.3357,stance loss: 0.23708 
Train step: 3610 acc:0.9482 total_loss: 0.28858  loss:0.22767,stance loss: 0.23238 
Train step: 3620 acc:0.94764 total_loss: 0.28672  loss:0.10266,stance loss: 0.026613 
Train step: 3630 acc:0.94807 total_loss: 0.2907  loss:0.3233,stance loss: 0.3147 
Train step: 3640 acc:0.94698 total_loss: 0.29125  loss:0.2823,stance loss: 0.2867 
Train step: 3650 acc:0.94627 total_loss: 0.29711  loss:0.52438,stance loss: 1.0089 
Train step: 3660 acc:0.94751 total_loss: 0.29314  loss:0.11113,stance loss: 0.068789 
Train step: 3670 acc:0.94839 total_loss: 0.29118  loss:0.04957,stance loss: 0.024208 
Training finished.


Reload the best model with best f1 0.4415389427588363 from path test_outputs/bert-cross-topic/fm/2023-08-14 15-41-49/state_dict


              precision    recall  f1-score   support

           0   0.606870  0.622309  0.614493       511
           1   0.463768  0.752941  0.573991       170
           2   0.375839  0.208955  0.268585       268

    accuracy                       0.528978       949
   macro avg   0.482159  0.528069  0.485690       949
weighted avg   0.515992  0.528978  0.509552       949

Test Acc: 0.5289778714436248 F1_ma:0.4415389427588363
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4415389427588363
acc: 0.5289778714436248, f1 :0.4856896389692691
classification report: 
              precision    recall  f1-score   support

         Con     0.6069    0.6223    0.6145       511
        None     0.4638    0.7529    0.5740       170
         Pro     0.3758    0.2090    0.2686       268

    accuracy                         0.5290       949
   macro avg     0.4822    0.5281    0.4857       949
weighted avg     0.5160    0.5290    0.5096       949

run_semeval with seed: 31550
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 16-20-56', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31550, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 16-20-56
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.6453  loss:1.6453,stance loss: 1.181 
Train step: 10 acc:0.45455 total_loss: 1.6972  loss:1.8255,stance loss: 1.1743 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 20 acc:0.47024 total_loss: 1.6789  loss:1.5816,stance loss: 1.1025 
Train step: 30 acc:0.45161 total_loss: 1.6733  loss:1.5374,stance loss: 1.1262 
Train step: 40 acc:0.4497 total_loss: 1.6746  loss:1.6771,stance loss: 1.1695 
Train step: 50 acc:0.46078 total_loss: 1.6633  loss:1.5633,stance loss: 1.1423 
Train step: 60 acc:0.46311 total_loss: 1.6604  loss:1.8194,stance loss: 1.2399 
Train step: 70 acc:0.45863 total_loss: 1.6581  loss:1.7207,stance loss: 1.2385 
Train step: 80 acc:0.46759 total_loss: 1.656  loss:1.5187,stance loss: 1.1285 
Train step: 90 acc:0.46978 total_loss: 1.6553  loss:1.7178,stance loss: 1.2129 
Train step: 100 acc:0.46658 total_loss: 1.6551  loss:1.5269,stance loss: 1.1128 
Train step: 110 acc:0.47128 total_loss: 1.6569  loss:1.6628,stance loss: 1.1753 
Train step: 120 acc:0.46746 total_loss: 1.6574  loss:1.581,stance loss: 1.1023 
Train step: 130 acc:0.47471 total_loss: 1.6523  loss:1.4985,stance loss: 1.0869 
Train step: 140 acc:0.4805 total_loss: 1.6454  loss:1.5818,stance loss: 1.3255 
Train step: 150 acc:0.48758 total_loss: 1.6416  loss:1.5643,stance loss: 1.5687 
Train step: 160 acc:0.49185 total_loss: 1.6391  loss:1.5943,stance loss: 1.1496 
Train step: 170 acc:0.49671 total_loss: 1.632  loss:1.5944,stance loss: 1.3836 
Train step: 180 acc:0.50207 total_loss: 1.6253  loss:1.7082,stance loss: 1.1965 
Train step: 190 acc:0.50425 total_loss: 1.6174  loss:0.96167,stance loss: 0.40606 
Train step: 200 acc:0.50529 total_loss: 1.6148  loss:1.6546,stance loss: 1.2206 
Train step: 210 acc:0.50829 total_loss: 1.6112  loss:1.4292,stance loss: 1.1184 
Train step: 220 acc:0.51301 total_loss: 1.6045  loss:1.3581,stance loss: 1.0855 
Train step: 230 acc:0.51569 total_loss: 1.5961  loss:1.3574,stance loss: 0.9093 
Train step: 240 acc:0.52127 total_loss: 1.5878  loss:1.5246,stance loss: 1.1349 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.63542 total_loss: 1.449  loss:1.4973,stance loss: 1.4903 
Train step: 260 acc:0.55078 total_loss: 1.4698  loss:1.4508,stance loss: 1.1198 
Train step: 270 acc:0.5649 total_loss: 1.4537  loss:1.2655,stance loss: 0.83488 
Train step: 280 acc:0.57465 total_loss: 1.435  loss:1.4786,stance loss: 1.078 
Train step: 290 acc:0.57337 total_loss: 1.4574  loss:1.3497,stance loss: 1.0212 
Train step: 300 acc:0.58594 total_loss: 1.4451  loss:1.2174,stance loss: 0.94727 
Train step: 310 acc:0.58712 total_loss: 1.4518  loss:1.4843,stance loss: 1.0539 
Train step: 320 acc:0.59211 total_loss: 1.4438  loss:1.3155,stance loss: 0.85106 
Train step: 330 acc:0.58503 total_loss: 1.4404  loss:1.4264,stance loss: 0.97721 
Better F1! Saving model!
Saving model of best f1: 0.3532916157916158
              precision    recall  f1-score   support

           0   0.538624  0.996086  0.699176       511
           1   0.500000  0.005882  0.011628       170
           2   0.500000  0.003731  0.007407       268

    accuracy                       0.538462       949
   macro avg   0.512875  0.335233  0.239404       949
weighted avg   0.520798  0.538462  0.380654       949

Test Acc: 0.5384615384615384 F1_ma:0.3532916157916158
Train step: 340 acc:0.58789 total_loss: 1.432  loss:0.99807,stance loss: 0.38389 
Train step: 350 acc:0.58844 total_loss: 1.4233  loss:1.3689,stance loss: 1.1359 
Train step: 360 acc:0.58028 total_loss: 1.4267  loss:1.8598,stance loss: 1.5704 
Train step: 370 acc:0.58532 total_loss: 1.4228  loss:1.0648,stance loss: 0.65307 
Train step: 380 acc:0.59053 total_loss: 1.4142  loss:1.1656,stance loss: 0.84643 
Train step: 390 acc:0.58776 total_loss: 1.4216  loss:1.4965,stance loss: 1.0818 
Train step: 400 acc:0.58734 total_loss: 1.4196  loss:1.465,stance loss: 1.2163 
Train step: 410 acc:0.5881 total_loss: 1.4175  loss:1.3405,stance loss: 1.0431 
Train step: 420 acc:0.58771 total_loss: 1.4144  loss:1.5353,stance loss: 1.6076 
Train step: 430 acc:0.59173 total_loss: 1.4086  loss:1.2799,stance loss: 0.91791 
Train step: 440 acc:0.59343 total_loss: 1.4065  loss:1.5375,stance loss: 1.3275 
Train step: 450 acc:0.59678 total_loss: 1.4045  loss:1.432,stance loss: 1.0502 
Train step: 460 acc:0.59809 total_loss: 1.4009  loss:1.3005,stance loss: 0.90213 
Train step: 470 acc:0.59679 total_loss: 1.3973  loss:1.1868,stance loss: 0.8 
Train step: 480 acc:0.59931 total_loss: 1.3878  loss:1.066,stance loss: 0.52749 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.8125 total_loss: 1.1549  loss:1.1549,stance loss: 0.91782 
Train step: 500 acc:0.65909 total_loss: 1.2627  loss:1.4949,stance loss: 1.1952 
Train step: 510 acc:0.63988 total_loss: 1.2636  loss:1.2174,stance loss: 0.94549 
Better F1! Saving model!
Saving model of best f1: 0.3852313353812605
              precision    recall  f1-score   support

           0   0.579562  0.776908  0.663880       511
           1   0.488263  0.611765  0.543081       170
           2   0.333333  0.063433  0.106583       268

    accuracy                       0.545838       949
   macro avg   0.467053  0.484035  0.437848       949
weighted avg   0.493671  0.545838  0.484858       949

Test Acc: 0.5458377239199157 F1_ma:0.3852313353812605
Train step: 520 acc:0.62702 total_loss: 1.2772  loss:1.012,stance loss: 0.69534 
Better F1! Saving model!
Saving model of best f1: 0.39986833380470155
              precision    recall  f1-score   support

           0   0.560644  0.886497  0.686884       511
           1   0.577778  0.305882  0.400000       170
           2   0.352941  0.067164  0.112853       268

    accuracy                       0.551106       949
   macro avg   0.497121  0.419848  0.399912       949
weighted avg   0.505057  0.551106  0.473385       949

Test Acc: 0.5511064278187566 F1_ma:0.39986833380470155
Train step: 530 acc:0.62652 total_loss: 1.2975  loss:1.7409,stance loss: 1.7041 
Train step: 540 acc:0.64216 total_loss: 1.2726  loss:1.2351,stance loss: 0.81888 
Train step: 550 acc:0.64242 total_loss: 1.2685  loss:1.1363,stance loss: 0.9389 
Train step: 560 acc:0.65141 total_loss: 1.2603  loss:1.3204,stance loss: 1.0526 
Train step: 570 acc:0.65046 total_loss: 1.2513  loss:1.4257,stance loss: 0.7104 
Train step: 580 acc:0.6511 total_loss: 1.2488  loss:1.1328,stance loss: 0.75648 
Train step: 590 acc:0.65161 total_loss: 1.2516  loss:1.2098,stance loss: 0.87849 
Train step: 600 acc:0.65315 total_loss: 1.2511  loss:1.1721,stance loss: 0.90004 
Train step: 610 acc:0.65806 total_loss: 1.2391  loss:1.1112,stance loss: 0.96156 
Train step: 620 acc:0.65744 total_loss: 1.2374  loss:1.1094,stance loss: 0.80002 
Train step: 630 acc:0.66135 total_loss: 1.2331  loss:1.0363,stance loss: 0.76184 
Train step: 640 acc:0.66101 total_loss: 1.2319  loss:1.1599,stance loss: 0.92356 
Train step: 650 acc:0.66149 total_loss: 1.2305  loss:1.3523,stance loss: 1.1191 
Train step: 660 acc:0.66594 total_loss: 1.2319  loss:1.578,stance loss: 1.9593 
Train step: 670 acc:0.67093 total_loss: 1.2273  loss:1.1395,stance loss: 1.0136 
Train step: 680 acc:0.67016 total_loss: 1.2325  loss:1.2728,stance loss: 0.96241 
Train step: 690 acc:0.67226 total_loss: 1.2306  loss:1.0488,stance loss: 0.82042 
Train step: 700 acc:0.67328 total_loss: 1.2279  loss:0.90508,stance loss: 0.673 
Train step: 710 acc:0.67279 total_loss: 1.2324  loss:1.3215,stance loss: 1.5335 
Train step: 720 acc:0.67262 total_loss: 1.2287  loss:1.1239,stance loss: 0.78407 
Train step: 730 acc:0.67324 total_loss: 1.2313  loss:1.2967,stance loss: 1.492 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.80208 total_loss: 0.92128  loss:0.79958,stance loss: 0.57213 
Train step: 750 acc:0.77344 total_loss: 1.0133  loss:1.0767,stance loss: 0.83071 
Train step: 760 acc:0.72356 total_loss: 1.0848  loss:1.0741,stance loss: 0.87236 
Train step: 770 acc:0.72222 total_loss: 1.1009  loss:0.99779,stance loss: 0.61062 
Train step: 780 acc:0.71196 total_loss: 1.099  loss:1.231,stance loss: 1.0573 
Train step: 790 acc:0.71429 total_loss: 1.0995  loss:1.9492,stance loss: 1.9684 
Train step: 800 acc:0.7036 total_loss: 1.1173  loss:1.0486,stance loss: 0.73232 
Train step: 810 acc:0.69737 total_loss: 1.1362  loss:1.096,stance loss: 0.84594 
Train step: 820 acc:0.70203 total_loss: 1.1352  loss:0.8411,stance loss: 0.61994 
Train step: 830 acc:0.70443 total_loss: 1.1466  loss:1.5312,stance loss: 1.114 
Train step: 840 acc:0.70106 total_loss: 1.1486  loss:0.6989,stance loss: 0.47955 
Train step: 850 acc:0.70205 total_loss: 1.1473  loss:1.2788,stance loss: 1.0009 
Train step: 860 acc:0.70337 total_loss: 1.1548  loss:1.3143,stance loss: 0.95934 
Train step: 870 acc:0.70037 total_loss: 1.1614  loss:0.94895,stance loss: 0.79133 
Train step: 880 acc:0.69949 total_loss: 1.1619  loss:0.89469,stance loss: 0.67279 
Train step: 890 acc:0.70192 total_loss: 1.1534  loss:0.80357,stance loss: 0.53309 
Train step: 900 acc:0.70105 total_loss: 1.1558  loss:1.3233,stance loss: 1.2969 
Train step: 910 acc:0.70419 total_loss: 1.1491  loss:1.1645,stance loss: 0.9634 
Train step: 920 acc:0.70733 total_loss: 1.1415  loss:1.2041,stance loss: 0.99127 
Train step: 930 acc:0.70759 total_loss: 1.1412  loss:0.90034,stance loss: 0.71074 
Train step: 940 acc:0.70783 total_loss: 1.1414  loss:0.82696,stance loss: 0.55265 
Train step: 950 acc:0.70862 total_loss: 1.141  loss:1.4663,stance loss: 1.4829 
Train step: 960 acc:0.70796 total_loss: 1.137  loss:1.1491,stance loss: 1.0174 
Better F1! Saving model!
Saving model of best f1: 0.4044870571379704
              precision    recall  f1-score   support

           0   0.574526  0.829746  0.678943       511
           1   0.557692  0.511765  0.533742       170
           2   0.381818  0.078358  0.130031       268

    accuracy                       0.560590       949
   macro avg   0.504679  0.473290  0.447572       949
weighted avg   0.517089  0.560590  0.497918       949

Test Acc: 0.5605900948366702 F1_ma:0.4044870571379704
Train step: 970 acc:0.70869 total_loss: 1.1315  loss:1.3029,stance loss: 1.0034 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.6875 total_loss: 1.0196  loss:1.0196,stance loss: 0.69522 
Train step: 990 acc:0.77273 total_loss: 0.91302  loss:0.77684,stance loss: 0.43775 
Train step: 1000 acc:0.73512 total_loss: 0.98644  loss:1.2852,stance loss: 0.96781 
Train step: 1010 acc:0.72581 total_loss: 1.0063  loss:0.65709,stance loss: 0.49 
Train step: 1020 acc:0.74085 total_loss: 0.98958  loss:0.72602,stance loss: 0.56367 
Train step: 1030 acc:0.75 total_loss: 0.97704  loss:1.0084,stance loss: 0.81383 
Train step: 1040 acc:0.75205 total_loss: 1.0052  loss:1.5185,stance loss: 1.5493 
Train step: 1050 acc:0.74824 total_loss: 1.0076  loss:1.3574,stance loss: 1.112 
Train step: 1060 acc:0.74691 total_loss: 1.0038  loss:0.91548,stance loss: 0.71506 
Train step: 1070 acc:0.74725 total_loss: 1.0117  loss:1.003,stance loss: 0.84052 
Train step: 1080 acc:0.74752 total_loss: 1.0132  loss:1.3239,stance loss: 1.0584 
Train step: 1090 acc:0.74324 total_loss: 1.0129  loss:1.2195,stance loss: 0.95179 
Train step: 1100 acc:0.74535 total_loss: 1.0097  loss:0.82179,stance loss: 0.70216 
Train step: 1110 acc:0.74666 total_loss: 0.99658  loss:1.5398,stance loss: 1.1998 
Better F1! Saving model!
Saving model of best f1: 0.4117509214868401
              precision    recall  f1-score   support

           0   0.607843  0.727984  0.662511       511
           1   0.460993  0.764706  0.575221       170
           2   0.472727  0.097015  0.160991       268

    accuracy                       0.556375       949
   macro avg   0.513854  0.529902  0.466241       949
weighted avg   0.543380  0.556375  0.505244       949

Test Acc: 0.5563751317175974 F1_ma:0.4117509214868401
Train step: 1120 acc:0.74645 total_loss: 0.99838  loss:0.60771,stance loss: 0.40976 
Better F1! Saving model!
Saving model of best f1: 0.4175910128874774
              precision    recall  f1-score   support

           0   0.593315  0.833659  0.693247       511
           1   0.534392  0.594118  0.562674       170
           2   0.523810  0.082090  0.141935       268

    accuracy                       0.578504       949
   macro avg   0.550505  0.503289  0.465952       949
weighted avg   0.563131  0.578504  0.514165       949

Test Acc: 0.5785036880927292 F1_ma:0.4175910128874774
Train step: 1130 acc:0.74752 total_loss: 0.98932  loss:1.0465,stance loss: 0.84126 
Train step: 1140 acc:0.74767 total_loss: 0.98524  loss:0.85903,stance loss: 0.79415 
Better F1! Saving model!
Saving model of best f1: 0.4267784596767223
              precision    recall  f1-score   support

           0   0.575758  0.557730  0.566600       511
           1   0.473282  0.729412  0.574074       170
           2   0.343750  0.246269  0.286957       268

    accuracy                       0.500527       949
   macro avg   0.464263  0.511137  0.475877       949
weighted avg   0.491881  0.500527  0.488967       949

Test Acc: 0.5005268703898841 F1_ma:0.4267784596767223
Train step: 1150 acc:0.75037 total_loss: 0.97856  loss:0.46838,stance loss: 0.27808 
Train step: 1160 acc:0.75 total_loss: 0.98259  loss:1.1302,stance loss: 1.4226 
Train step: 1170 acc:0.74836 total_loss: 0.98945  loss:1.3706,stance loss: 1.1013 
Train step: 1180 acc:0.74689 total_loss: 0.99699  loss:1.2103,stance loss: 1.1807 
Train step: 1190 acc:0.74467 total_loss: 1.0015  loss:0.99354,stance loss: 0.895 
Train step: 1200 acc:0.74604 total_loss: 0.99385  loss:0.9939,stance loss: 0.75517 
Train step: 1210 acc:0.74269 total_loss: 1.0027  loss:1.2123,stance loss: 1.0271 
Train step: 1220 acc:0.74222 total_loss: 1.0023  loss:1.0233,stance loss: 0.83373 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.72917 total_loss: 1.1453  loss:0.8616,stance loss: 0.62482 
Train step: 1240 acc:0.75781 total_loss: 1.0305  loss:1.1374,stance loss: 0.86444 
Train step: 1250 acc:0.7524 total_loss: 1.0142  loss:1.2846,stance loss: 1.4753 
Train step: 1260 acc:0.74826 total_loss: 1.025  loss:0.86497,stance loss: 0.71248 
Train step: 1270 acc:0.74864 total_loss: 1.016  loss:1.235,stance loss: 1.044 
Train step: 1280 acc:0.75223 total_loss: 0.98766  loss:1.107,stance loss: 1.4199 
Train step: 1290 acc:0.76042 total_loss: 0.97226  loss:0.64974,stance loss: 0.45482 
Train step: 1300 acc:0.76562 total_loss: 0.95732  loss:1.2369,stance loss: 0.89483 
Train step: 1310 acc:0.76381 total_loss: 0.9536  loss:0.99918,stance loss: 1.2739 
Train step: 1320 acc:0.76497 total_loss: 0.9463  loss:0.67785,stance loss: 0.56242 
Train step: 1330 acc:0.77182 total_loss: 0.92307  loss:1.2097,stance loss: 1.3935 
Train step: 1340 acc:0.77155 total_loss: 0.93157  loss:0.81901,stance loss: 0.6682 
Train step: 1350 acc:0.76984 total_loss: 0.94208  loss:1.2567,stance loss: 1.0974 
Train step: 1360 acc:0.77206 total_loss: 0.93712  loss:0.72572,stance loss: 0.63906 
Train step: 1370 acc:0.77526 total_loss: 0.92825  loss:0.8561,stance loss: 0.7571 
Train step: 1380 acc:0.77564 total_loss: 0.92065  loss:1.1005,stance loss: 0.87308 
Train step: 1390 acc:0.77636 total_loss: 0.91448  loss:1.3286,stance loss: 1.137 
Train step: 1400 acc:0.7777 total_loss: 0.91337  loss:0.70188,stance loss: 0.47606 
Train step: 1410 acc:0.77923 total_loss: 0.90936  loss:0.96415,stance loss: 0.74276 
Train step: 1420 acc:0.78061 total_loss: 0.9027  loss:0.46067,stance loss: 0.34056 
Train step: 1430 acc:0.78004 total_loss: 0.90287  loss:0.82105,stance loss: 0.63967 
Train step: 1440 acc:0.77894 total_loss: 0.90373  loss:0.89226,stance loss: 0.70853 
Train step: 1450 acc:0.77655 total_loss: 0.90757  loss:1.1184,stance loss: 0.7935 
Train step: 1460 acc:0.77754 total_loss: 0.9042  loss:0.85711,stance loss: 0.63677 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.875 total_loss: 0.4667  loss:0.4667,stance loss: 0.30563 
Train step: 1480 acc:0.80114 total_loss: 0.81704  loss:0.48898,stance loss: 0.36914 
Train step: 1490 acc:0.79464 total_loss: 0.80774  loss:0.38929,stance loss: 0.1752 
Train step: 1500 acc:0.77823 total_loss: 0.85113  loss:1.1169,stance loss: 1.1926 
Train step: 1510 acc:0.78811 total_loss: 0.8271  loss:1.052,stance loss: 0.87587 
Train step: 1520 acc:0.80025 total_loss: 0.80157  loss:0.42116,stance loss: 0.37936 
Train step: 1530 acc:0.79406 total_loss: 0.81183  loss:0.47683,stance loss: 0.39802 
Better F1! Saving model!
Saving model of best f1: 0.43273615561571527
              precision    recall  f1-score   support

           0   0.592955  0.592955  0.592955       511
           1   0.461538  0.741176  0.568849       170
           2   0.357576  0.220149  0.272517       268

    accuracy                       0.514226       949
   macro avg   0.470690  0.518094  0.478107       949
weighted avg   0.502942  0.514226  0.498144       949

Test Acc: 0.5142255005268704 F1_ma:0.43273615561571527
Train step: 1540 acc:0.80106 total_loss: 0.78759  loss:0.96712,stance loss: 0.79612 
Train step: 1550 acc:0.80324 total_loss: 0.782  loss:0.90892,stance loss: 0.7231 
Train step: 1560 acc:0.80701 total_loss: 0.79137  loss:1.3503,stance loss: 1.331 
Train step: 1570 acc:0.80941 total_loss: 0.79194  loss:0.82804,stance loss: 0.53436 
Train step: 1580 acc:0.81025 total_loss: 0.79842  loss:1.4956,stance loss: 1.4714 
Train step: 1590 acc:0.81147 total_loss: 0.79316  loss:0.40732,stance loss: 0.3232 
Train step: 1600 acc:0.80534 total_loss: 0.80956  loss:1.2113,stance loss: 0.90321 
Train step: 1610 acc:0.80541 total_loss: 0.80812  loss:1.0648,stance loss: 0.93794 
Train step: 1620 acc:0.80753 total_loss: 0.79924  loss:0.55227,stance loss: 0.33512 
Train step: 1630 acc:0.80512 total_loss: 0.8069  loss:0.82429,stance loss: 0.73746 
Train step: 1640 acc:0.80482 total_loss: 0.81119  loss:1.4712,stance loss: 1.2433 
Train step: 1650 acc:0.80525 total_loss: 0.80669  loss:1.331,stance loss: 0.88865 
Train step: 1660 acc:0.8053 total_loss: 0.80474  loss:0.47574,stance loss: 0.34326 
Train step: 1670 acc:0.80659 total_loss: 0.80468  loss:0.38185,stance loss: 0.29529 
Train step: 1680 acc:0.80658 total_loss: 0.80954  loss:0.58069,stance loss: 0.43436 
Train step: 1690 acc:0.80769 total_loss: 0.80731  loss:0.78209,stance loss: 0.67446 
Train step: 1700 acc:0.80952 total_loss: 0.80317  loss:0.29949,stance loss: 0.17118 
Train step: 1710 acc:0.80965 total_loss: 0.80512  loss:1.1512,stance loss: 0.90709 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.76042 total_loss: 0.82861  loss:1.3463,stance loss: 0.96073 
Train step: 1730 acc:0.8125 total_loss: 0.68577  loss:0.85465,stance loss: 0.62348 
Train step: 1740 acc:0.83894 total_loss: 0.63774  loss:0.29367,stance loss: 0.19461 
Train step: 1750 acc:0.84201 total_loss: 0.63522  loss:0.86278,stance loss: 0.7186 
Train step: 1760 acc:0.84375 total_loss: 0.65014  loss:0.35164,stance loss: 0.27488 
Train step: 1770 acc:0.84598 total_loss: 0.64746  loss:0.67751,stance loss: 0.5732 
Train step: 1780 acc:0.85038 total_loss: 0.64865  loss:0.44341,stance loss: 0.33556 
Train step: 1790 acc:0.83964 total_loss: 0.68174  loss:0.41295,stance loss: 0.35396 
Train step: 1800 acc:0.83794 total_loss: 0.68808  loss:0.9343,stance loss: 1.306 
Train step: 1810 acc:0.84115 total_loss: 0.68421  loss:0.52066,stance loss: 0.42061 
Train step: 1820 acc:0.83726 total_loss: 0.69334  loss:0.88975,stance loss: 1.3336 
Train step: 1830 acc:0.83621 total_loss: 0.70374  loss:0.83739,stance loss: 0.55796 
Train step: 1840 acc:0.83631 total_loss: 0.70131  loss:0.41187,stance loss: 0.2793 
Train step: 1850 acc:0.83732 total_loss: 0.71239  loss:0.91263,stance loss: 1.2934 
Train step: 1860 acc:0.84033 total_loss: 0.71134  loss:0.85176,stance loss: 1.2413 
Train step: 1870 acc:0.84095 total_loss: 0.70092  loss:0.65817,stance loss: 0.48656 
Train step: 1880 acc:0.84187 total_loss: 0.69344  loss:0.93309,stance loss: 0.92078 
Train step: 1890 acc:0.83984 total_loss: 0.70128  loss:0.50939,stance loss: 0.38499 
Train step: 1900 acc:0.84073 total_loss: 0.69674  loss:0.91737,stance loss: 0.57341 
Better F1! Saving model!
Saving model of best f1: 0.437193016158538
              precision    recall  f1-score   support

           0   0.582329  0.567515  0.574827       511
           1   0.449057  0.700000  0.547126       170
           2   0.365591  0.253731  0.299559       268

    accuracy                       0.502634       949
   macro avg   0.465659  0.507082  0.473837       949
weighted avg   0.497248  0.502634  0.492128       949

Test Acc: 0.5026343519494204 F1_ma:0.437193016158538
Train step: 1910 acc:0.8412 total_loss: 0.69844  loss:1.4804,stance loss: 1.6066 
Train step: 1920 acc:0.84163 total_loss: 0.69482  loss:0.81925,stance loss: 0.55894 
Train step: 1930 acc:0.84288 total_loss: 0.69668  loss:0.46653,stance loss: 0.38461 
Train step: 1940 acc:0.84237 total_loss: 0.69896  loss:0.86793,stance loss: 0.70251 
Train step: 1950 acc:0.8411 total_loss: 0.69875  loss:0.76059,stance loss: 0.60545 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.8125 total_loss: 0.78774  loss:0.78774,stance loss: 0.72511 
Train step: 1970 acc:0.88636 total_loss: 0.54239  loss:0.2454,stance loss: 0.14304 
Better F1! Saving model!
Saving model of best f1: 0.44428048302018397
              precision    recall  f1-score   support

           0   0.587302  0.579256  0.583251       511
           1   0.436782  0.670588  0.529002       170
           2   0.375000  0.257463  0.305310       268

    accuracy                       0.504742       949
   macro avg   0.466361  0.502436  0.472521       949
weighted avg   0.500384  0.504742  0.495042       949

Test Acc: 0.5047418335089568 F1_ma:0.44428048302018397
Train step: 1980 acc:0.8869 total_loss: 0.57579  loss:0.73566,stance loss: 0.4562 
Train step: 1990 acc:0.89315 total_loss: 0.53497  loss:0.33434,stance loss: 0.24218 
Train step: 2000 acc:0.88262 total_loss: 0.53611  loss:0.38418,stance loss: 0.30239 
Train step: 2010 acc:0.87255 total_loss: 0.55723  loss:0.59474,stance loss: 0.46827 
Train step: 2020 acc:0.86885 total_loss: 0.59048  loss:0.51598,stance loss: 0.50997 
Train step: 2030 acc:0.86884 total_loss: 0.58594  loss:0.64058,stance loss: 0.47194 
Train step: 2040 acc:0.86806 total_loss: 0.59811  loss:0.56607,stance loss: 0.55513 
Train step: 2050 acc:0.86882 total_loss: 0.59713  loss:0.64579,stance loss: 0.55689 
Train step: 2060 acc:0.86696 total_loss: 0.6062  loss:0.42655,stance loss: 0.25247 
Train step: 2070 acc:0.86824 total_loss: 0.60015  loss:0.84772,stance loss: 0.89301 
Train step: 2080 acc:0.86467 total_loss: 0.60204  loss:0.99134,stance loss: 0.62209 
Train step: 2090 acc:0.8645 total_loss: 0.60234  loss:0.78208,stance loss: 0.61011 
Train step: 2100 acc:0.86348 total_loss: 0.60248  loss:0.69296,stance loss: 0.37942 
Train step: 2110 acc:0.86548 total_loss: 0.59865  loss:1.4846,stance loss: 1.7178 
Train step: 2120 acc:0.8653 total_loss: 0.60227  loss:0.89554,stance loss: 0.5408 
Train step: 2130 acc:0.86732 total_loss: 0.60263  loss:0.56086,stance loss: 0.33859 
Train step: 2140 acc:0.86844 total_loss: 0.59386  loss:0.88767,stance loss: 1.1004 
Train step: 2150 acc:0.86649 total_loss: 0.60036  loss:0.68133,stance loss: 0.32213 
Train step: 2160 acc:0.86847 total_loss: 0.5916  loss:0.77439,stance loss: 0.67155 
Train step: 2170 acc:0.86878 total_loss: 0.59553  loss:0.71135,stance loss: 0.56905 
Train step: 2180 acc:0.87019 total_loss: 0.59513  loss:0.6325,stance loss: 0.48657 
Train step: 2190 acc:0.87067 total_loss: 0.59552  loss:0.63756,stance loss: 0.43125 
Better F1! Saving model!
Saving model of best f1: 0.44593265648157127
              precision    recall  f1-score   support

           0   0.610879  0.571429  0.590495       511
           1   0.441860  0.782353  0.564756       170
           2   0.388235  0.246269  0.301370       268

    accuracy                       0.517387       949
   macro avg   0.480325  0.533350  0.485540       949
weighted avg   0.517726  0.517387  0.504235       949

Test Acc: 0.5173867228661749 F1_ma:0.44593265648157127
Train step: 2200 acc:0.86955 total_loss: 0.59844  loss:0.82325,stance loss: 0.78318 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.90625 total_loss: 0.47882  loss:0.61975,stance loss: 0.46661 
Train step: 2220 acc:0.88672 total_loss: 0.509  loss:0.48643,stance loss: 0.17998 
Train step: 2230 acc:0.84615 total_loss: 0.66565  loss:0.26214,stance loss: 0.1866 
Train step: 2240 acc:0.83681 total_loss: 0.70618  loss:0.85012,stance loss: 0.80129 
Train step: 2250 acc:0.84647 total_loss: 0.6882  loss:0.52587,stance loss: 0.55647 
Train step: 2260 acc:0.85156 total_loss: 0.69465  loss:1.0428,stance loss: 1.323 
Better F1! Saving model!
Saving model of best f1: 0.4523330778594292
              precision    recall  f1-score   support

           0   0.593695  0.663405  0.626617       511
           1   0.449153  0.623529  0.522167       170
           2   0.401408  0.212687  0.278049       268

    accuracy                       0.528978       949
   macro avg   0.481419  0.499874  0.475611       949
weighted avg   0.513500  0.528978  0.509470       949

Test Acc: 0.5289778714436248 F1_ma:0.4523330778594292
Train step: 2270 acc:0.86269 total_loss: 0.66123  loss:0.43147,stance loss: 0.34794 
Train step: 2280 acc:0.85938 total_loss: 0.68923  loss:0.65152,stance loss: 0.59266 
Train step: 2290 acc:0.86192 total_loss: 0.68802  loss:0.60813,stance loss: 0.54 
Train step: 2300 acc:0.86393 total_loss: 0.67426  loss:0.62312,stance loss: 0.4224 
Train step: 2310 acc:0.86675 total_loss: 0.66528  loss:0.69187,stance loss: 0.60183 
Train step: 2320 acc:0.86907 total_loss: 0.64862  loss:0.61638,stance loss: 0.48623 
Train step: 2330 acc:0.87202 total_loss: 0.64685  loss:0.22402,stance loss: 0.1157 
Train step: 2340 acc:0.87592 total_loss: 0.63784  loss:1.0627,stance loss: 0.91386 
Better F1! Saving model!
Saving model of best f1: 0.4543145094119607
              precision    recall  f1-score   support

           0   0.606004  0.632094  0.618774       511
           1   0.433333  0.688235  0.531818       170
           2   0.410959  0.223881  0.289855       268

    accuracy                       0.526870       949
   macro avg   0.483432  0.514737  0.480149       949
weighted avg   0.519991  0.526870  0.510310       949

Test Acc: 0.5268703898840885 F1_ma:0.4543145094119607
Train step: 2350 acc:0.87928 total_loss: 0.62341  loss:0.25457,stance loss: 0.11449 
Train step: 2360 acc:0.87941 total_loss: 0.6243  loss:0.92801,stance loss: 0.82028 
Train step: 2370 acc:0.8814 total_loss: 0.60974  loss:0.27557,stance loss: 0.18903 
Train step: 2380 acc:0.88388 total_loss: 0.60273  loss:0.27592,stance loss: 0.15529 
Train step: 2390 acc:0.88407 total_loss: 0.60304  loss:0.49119,stance loss: 0.48096 
Train step: 2400 acc:0.8852 total_loss: 0.60035  loss:0.49204,stance loss: 0.39947 
Train step: 2410 acc:0.88653 total_loss: 0.59734  loss:1.1084,stance loss: 1.4954 
Train step: 2420 acc:0.88628 total_loss: 0.59136  loss:0.68737,stance loss: 0.59706 
Train step: 2430 acc:0.88662 total_loss: 0.58824  loss:1.239,stance loss: 1.5208 
Train step: 2440 acc:0.88533 total_loss: 0.58572  loss:0.93071,stance loss: 0.80101 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.3527  loss:0.3527,stance loss: 0.32983 
Train step: 2460 acc:0.89205 total_loss: 0.62335  loss:1.0366,stance loss: 1.3759 
Train step: 2470 acc:0.90774 total_loss: 0.54931  loss:0.43747,stance loss: 0.32204 
Train step: 2480 acc:0.89516 total_loss: 0.56735  loss:0.61936,stance loss: 0.4804 
Train step: 2490 acc:0.90701 total_loss: 0.52241  loss:0.34495,stance loss: 0.247 
Train step: 2500 acc:0.90809 total_loss: 0.51943  loss:0.18573,stance loss: 0.088848 
Train step: 2510 acc:0.90779 total_loss: 0.50827  loss:0.18718,stance loss: 0.098303 
Train step: 2520 acc:0.90493 total_loss: 0.50923  loss:0.50993,stance loss: 0.47385 
Train step: 2530 acc:0.90818 total_loss: 0.49811  loss:0.33077,stance loss: 0.28601 
Train step: 2540 acc:0.90865 total_loss: 0.50409  loss:0.15693,stance loss: 0.11008 
Train step: 2550 acc:0.91213 total_loss: 0.48942  loss:0.88112,stance loss: 0.84814 
Train step: 2560 acc:0.91385 total_loss: 0.49137  loss:0.48884,stance loss: 0.41049 
Train step: 2570 acc:0.91529 total_loss: 0.49082  loss:0.23623,stance loss: 0.054663 
Train step: 2580 acc:0.91937 total_loss: 0.4743  loss:0.17001,stance loss: 0.10517 
Train step: 2590 acc:0.918 total_loss: 0.47637  loss:0.78696,stance loss: 1.0358 
Train step: 2600 acc:0.91763 total_loss: 0.47236  loss:0.68708,stance loss: 0.49611 
Train step: 2610 acc:0.92081 total_loss: 0.46524  loss:0.63498,stance loss: 1.0724 
Train step: 2620 acc:0.91667 total_loss: 0.47229  loss:0.80788,stance loss: 0.75973 
Train step: 2630 acc:0.91713 total_loss: 0.47087  loss:0.15012,stance loss: 0.037432 
Train step: 2640 acc:0.91688 total_loss: 0.47553  loss:0.94232,stance loss: 0.75932 
Train step: 2650 acc:0.91884 total_loss: 0.47033  loss:0.28697,stance loss: 0.20734 
Train step: 2660 acc:0.91884 total_loss: 0.47246  loss:0.60934,stance loss: 1.0534 
Train step: 2670 acc:0.91997 total_loss: 0.46947  loss:0.36249,stance loss: 0.31838 
Train step: 2680 acc:0.91991 total_loss: 0.46222  loss:0.27449,stance loss: 0.23795 
Train step: 2690 acc:0.9209 total_loss: 0.46068  loss:0.11895,stance loss: 0.070498 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.95833 total_loss: 0.2896  loss:0.069383,stance loss: 0.0094203 
Train step: 2710 acc:0.9375 total_loss: 0.42285  loss:0.66422,stance loss: 1.1077 
Train step: 2720 acc:0.93029 total_loss: 0.39977  loss:0.58435,stance loss: 1.0222 
Train step: 2730 acc:0.92882 total_loss: 0.40057  loss:1.0848,stance loss: 1.3967 
Train step: 2740 acc:0.93071 total_loss: 0.392  loss:0.9265,stance loss: 1.2335 
Train step: 2750 acc:0.9375 total_loss: 0.37012  loss:0.20771,stance loss: 0.15705 
Train step: 2760 acc:0.93087 total_loss: 0.39454  loss:0.445,stance loss: 0.51005 
Train step: 2770 acc:0.93503 total_loss: 0.38951  loss:0.070636,stance loss: 0.031332 
Train step: 2780 acc:0.93605 total_loss: 0.38812  loss:0.23931,stance loss: 0.12614 
Train step: 2790 acc:0.93685 total_loss: 0.38312  loss:0.36749,stance loss: 0.27051 
Train step: 2800 acc:0.9375 total_loss: 0.38022  loss:0.28397,stance loss: 0.15287 
Train step: 2810 acc:0.94073 total_loss: 0.37731  loss:0.16898,stance loss: 0.071615 
Train step: 2820 acc:0.94147 total_loss: 0.37385  loss:0.25453,stance loss: 0.10489 
Train step: 2830 acc:0.9398 total_loss: 0.37763  loss:0.15532,stance loss: 0.081571 
Train step: 2840 acc:0.93921 total_loss: 0.37935  loss:0.71318,stance loss: 0.59843 
Train step: 2850 acc:0.9391 total_loss: 0.38146  loss:1.0176,stance loss: 1.3778 
Train step: 2860 acc:0.93938 total_loss: 0.37598  loss:0.5208,stance loss: 0.47808 
Train step: 2870 acc:0.93963 total_loss: 0.36949  loss:0.32842,stance loss: 0.26988 
Train step: 2880 acc:0.94052 total_loss: 0.37702  loss:0.64094,stance loss: 1.0779 
Train step: 2890 acc:0.93909 total_loss: 0.37689  loss:0.11481,stance loss: 0.071637 
Train step: 2900 acc:0.93871 total_loss: 0.37861  loss:0.23718,stance loss: 0.22996 
Train step: 2910 acc:0.93924 total_loss: 0.37677  loss:0.22141,stance loss: 0.19814 
Train step: 2920 acc:0.93916 total_loss: 0.37836  loss:0.59446,stance loss: 0.56672 
Train step: 2930 acc:0.9375 total_loss: 0.37922  loss:1.2383,stance loss: 1.3034 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:1.0 total_loss: 0.16615  loss:0.16615,stance loss: 0.12196 
Train step: 2950 acc:0.92614 total_loss: 0.31961  loss:0.27939,stance loss: 0.28307 
Better F1! Saving model!
Saving model of best f1: 0.45538411897568276
              precision    recall  f1-score   support

           0   0.612293  0.506849  0.554604       511
           1   0.420495  0.700000  0.525386       170
           2   0.374486  0.339552  0.356164       268

    accuracy                       0.494204       949
   macro avg   0.469091  0.515467  0.478718       949
weighted avg   0.510778  0.494204  0.493330       949

Test Acc: 0.49420442571127504 F1_ma:0.45538411897568276
Train step: 2960 acc:0.9256 total_loss: 0.35237  loss:0.35692,stance loss: 0.22167 
Train step: 2970 acc:0.92944 total_loss: 0.34688  loss:0.33703,stance loss: 0.17537 
Train step: 2980 acc:0.93445 total_loss: 0.31548  loss:0.11187,stance loss: 0.10366 
Train step: 2990 acc:0.93995 total_loss: 0.30959  loss:0.17972,stance loss: 0.13481 
Train step: 3000 acc:0.94365 total_loss: 0.29651  loss:0.46307,stance loss: 0.37976 
Train step: 3010 acc:0.94366 total_loss: 0.29609  loss:0.24473,stance loss: 0.19366 
Train step: 3020 acc:0.94676 total_loss: 0.28495  loss:0.15732,stance loss: 0.054644 
Train step: 3030 acc:0.94849 total_loss: 0.28209  loss:0.38978,stance loss: 0.34163 
Train step: 3040 acc:0.9474 total_loss: 0.28413  loss:0.17449,stance loss: 0.13862 
Train step: 3050 acc:0.94932 total_loss: 0.29192  loss:0.19316,stance loss: 0.14775 
Train step: 3060 acc:0.94938 total_loss: 0.29465  loss:0.059441,stance loss: 0.028658 
Train step: 3070 acc:0.95038 total_loss: 0.29209  loss:0.17307,stance loss: 0.14311 
Train step: 3080 acc:0.94947 total_loss: 0.29078  loss:0.14335,stance loss: 0.11057 
Train step: 3090 acc:0.94868 total_loss: 0.29219  loss:0.57327,stance loss: 0.54922 
Train step: 3100 acc:0.94682 total_loss: 0.29521  loss:0.20004,stance loss: 0.068979 
Train step: 3110 acc:0.94737 total_loss: 0.28895  loss:0.070143,stance loss: 0.020961 
Train step: 3120 acc:0.94855 total_loss: 0.29043  loss:0.50206,stance loss: 0.56471 
Train step: 3130 acc:0.94961 total_loss: 0.29157  loss:0.098026,stance loss: 0.031123 
Train step: 3140 acc:0.95087 total_loss: 0.28763  loss:0.28344,stance loss: 0.2645 
Train step: 3150 acc:0.95142 total_loss: 0.28301  loss:0.28668,stance loss: 0.12004 
Train step: 3160 acc:0.95221 total_loss: 0.28691  loss:0.24582,stance loss: 0.22459 
Train step: 3170 acc:0.9513 total_loss: 0.29086  loss:0.45186,stance loss: 0.39608 
Train step: 3180 acc:0.95047 total_loss: 0.2911  loss:0.18459,stance loss: 0.10922 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.96875 total_loss: 0.19393  loss:0.26549,stance loss: 0.18782 
Train step: 3200 acc:0.96875 total_loss: 0.19522  loss:0.10963,stance loss: 0.0077913 
Train step: 3210 acc:0.96154 total_loss: 0.19425  loss:0.072413,stance loss: 0.024788 
Train step: 3220 acc:0.96007 total_loss: 0.21305  loss:0.54186,stance loss: 1.0148 
Train step: 3230 acc:0.95788 total_loss: 0.24799  loss:0.10132,stance loss: 0.094243 
Train step: 3240 acc:0.95871 total_loss: 0.25031  loss:0.090795,stance loss: 0.015133 
Train step: 3250 acc:0.96023 total_loss: 0.24917  loss:0.041098,stance loss: 0.0024867 
Train step: 3260 acc:0.95806 total_loss: 0.24935  loss:0.047128,stance loss: 0.017576 
Train step: 3270 acc:0.95567 total_loss: 0.25717  loss:0.46968,stance loss: 0.46964 
Train step: 3280 acc:0.95508 total_loss: 0.25487  loss:0.025552,stance loss: 0.0041833 
Train step: 3290 acc:0.95283 total_loss: 0.25758  loss:0.27951,stance loss: 0.14125 
Train step: 3300 acc:0.95366 total_loss: 0.25461  loss:0.05233,stance loss: 0.014608 
Train step: 3310 acc:0.95238 total_loss: 0.26498  loss:0.86896,stance loss: 0.63136 
Train step: 3320 acc:0.95221 total_loss: 0.26532  loss:0.048886,stance loss: 0.0044522 
Train step: 3330 acc:0.95248 total_loss: 0.26162  loss:0.16057,stance loss: 0.15089 
Train step: 3340 acc:0.95192 total_loss: 0.26431  loss:0.58411,stance loss: 0.50227 
Train step: 3350 acc:0.95218 total_loss: 0.26921  loss:0.1863,stance loss: 0.11964 
Train step: 3360 acc:0.95241 total_loss: 0.26747  loss:0.39516,stance loss: 0.30131 
Train step: 3370 acc:0.95363 total_loss: 0.26359  loss:0.64753,stance loss: 1.041 
Train step: 3380 acc:0.95472 total_loss: 0.25903  loss:0.030269,stance loss: 0.0074734 
Train step: 3390 acc:0.95479 total_loss: 0.2642  loss:0.040098,stance loss: 0.020703 
Train step: 3400 acc:0.9566 total_loss: 0.26154  loss:0.047985,stance loss: 0.021232 
Train step: 3410 acc:0.95658 total_loss: 0.26027  loss:0.23435,stance loss: 0.12299 
Train step: 3420 acc:0.95524 total_loss: 0.26495  loss:0.20848,stance loss: 0.23359 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.9375 total_loss: 0.30475  loss:0.30475,stance loss: 0.28761 
Train step: 3440 acc:0.97159 total_loss: 0.23214  loss:0.054014,stance loss: 0.024919 
Train step: 3450 acc:0.95536 total_loss: 0.24819  loss:0.050548,stance loss: 0.0080586 
Train step: 3460 acc:0.95565 total_loss: 0.25261  loss:0.62159,stance loss: 0.59866 
Train step: 3470 acc:0.96037 total_loss: 0.24136  loss:0.34277,stance loss: 0.21373 
Train step: 3480 acc:0.96201 total_loss: 0.24243  loss:0.23197,stance loss: 0.17658 
Train step: 3490 acc:0.96209 total_loss: 0.24793  loss:0.46156,stance loss: 0.43935 
Train step: 3500 acc:0.96215 total_loss: 0.23939  loss:0.45134,stance loss: 0.41295 
Train step: 3510 acc:0.96528 total_loss: 0.22754  loss:0.054689,stance loss: 0.032045 
Train step: 3520 acc:0.96566 total_loss: 0.22549  loss:0.97294,stance loss: 1.317 
Train step: 3530 acc:0.96535 total_loss: 0.22531  loss:0.077948,stance loss: 0.060485 
Train step: 3540 acc:0.96453 total_loss: 0.23502  loss:0.16296,stance loss: 0.059361 
Train step: 3550 acc:0.96694 total_loss: 0.22342  loss:0.029141,stance loss: 0.0024747 
Train step: 3560 acc:0.9666 total_loss: 0.23493  loss:0.56975,stance loss: 1.0281 
Train step: 3570 acc:0.9672 total_loss: 0.22843  loss:0.41304,stance loss: 0.34157 
Train step: 3580 acc:0.96813 total_loss: 0.23345  loss:0.043724,stance loss: 0.020682 
Train step: 3590 acc:0.96817 total_loss: 0.23088  loss:0.12103,stance loss: 0.11698 
Train step: 3600 acc:0.96674 total_loss: 0.24096  loss:0.35302,stance loss: 0.35239 
Train step: 3610 acc:0.9672 total_loss: 0.2365  loss:0.032692,stance loss: 0.013538 
Train step: 3620 acc:0.9676 total_loss: 0.23161  loss:0.071773,stance loss: 0.051952 
Train step: 3630 acc:0.96797 total_loss: 0.23141  loss:0.38649,stance loss: 0.41383 
Train step: 3640 acc:0.96831 total_loss: 0.23244  loss:0.060455,stance loss: 0.036242 
Train step: 3650 acc:0.96776 total_loss: 0.23508  loss:0.089344,stance loss: 0.075312 
Train step: 3660 acc:0.96672 total_loss: 0.23906  loss:0.17324,stance loss: 0.21025 
Train step: 3670 acc:0.96758 total_loss: 0.23826  loss:0.092328,stance loss: 0.038463 
Training finished.


Reload the best model with best f1 0.45538411897568276 from path test_outputs/bert-cross-topic/fm/2023-08-14 16-20-56/state_dict


              precision    recall  f1-score   support

           0   0.612293  0.506849  0.554604       511
           1   0.420495  0.700000  0.525386       170
           2   0.374486  0.339552  0.356164       268

    accuracy                       0.494204       949
   macro avg   0.469091  0.515467  0.478718       949
weighted avg   0.510778  0.494204  0.493330       949

Test Acc: 0.49420442571127504 F1_ma:0.45538411897568276
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.45538411897568276
acc: 0.49420442571127504, f1 :0.47871818380571635
classification report: 
              precision    recall  f1-score   support

         Con     0.6123    0.5068    0.5546       511
        None     0.4205    0.7000    0.5254       170
         Pro     0.3745    0.3396    0.3562       268

    accuracy                         0.4942       949
   macro avg     0.4691    0.5155    0.4787       949
weighted avg     0.5108    0.4942    0.4933       949

run_semeval with seed: 31551
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 16-59-29', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31551, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 16-59-29
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.5 total_loss: 1.56  loss:1.56,stance loss: 1.1271 
Train step: 10 acc:0.46023 total_loss: 1.6606  loss:1.7634,stance loss: 1.2341 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 20 acc:0.45536 total_loss: 1.6684  loss:1.714,stance loss: 1.2467 
Train step: 30 acc:0.47581 total_loss: 1.6331  loss:1.4233,stance loss: 0.99962 
Train step: 40 acc:0.47866 total_loss: 1.617  loss:1.6062,stance loss: 1.108 
Train step: 50 acc:0.48775 total_loss: 1.6087  loss:1.5744,stance loss: 1.1011 
Better F1! Saving model!
Saving model of best f1: 0.35133136094674555
              precision    recall  f1-score   support

           0   0.564804  0.929550  0.702663       511
           1   0.425926  0.270588  0.330935       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.548999       949
   macro avg   0.330243  0.400046  0.344533       949
weighted avg   0.380424  0.548999  0.437639       949

Test Acc: 0.5489989462592202 F1_ma:0.35133136094674555
Train step: 60 acc:0.47848 total_loss: 1.6273  loss:1.5212,stance loss: 1.1364 
Train step: 70 acc:0.4956 total_loss: 1.6191  loss:1.388,stance loss: 0.96492 
Train step: 80 acc:0.50463 total_loss: 1.6141  loss:1.3977,stance loss: 1.0426 
Better F1! Saving model!
Saving model of best f1: 0.3527777777777778
              precision    recall  f1-score   support

           0   0.546825  0.994129  0.705556       511
           1   0.600000  0.070588  0.126316       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.547945       949
   macro avg   0.382275  0.354906  0.277290       949
weighted avg   0.401926  0.547945  0.402542       949

Test Acc: 0.547945205479452 F1_ma:0.3527777777777778
Train step: 90 acc:0.50481 total_loss: 1.6161  loss:1.7223,stance loss: 1.2662 
Better F1! Saving model!
Saving model of best f1: 0.35294117647058826
              precision    recall  f1-score   support

           0   0.546039  0.998043  0.705882       511
           1   0.666667  0.058824  0.108108       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.547945       949
   macro avg   0.404235  0.352289  0.271330       949
weighted avg   0.413445  0.547945  0.399457       949

Test Acc: 0.547945205479452 F1_ma:0.35294117647058826
Train step: 100 acc:0.50866 total_loss: 1.6071  loss:1.7177,stance loss: 1.2578 
Train step: 110 acc:0.50845 total_loss: 1.6052  loss:1.6739,stance loss: 1.0872 
Train step: 120 acc:0.5186 total_loss: 1.5926  loss:1.5434,stance loss: 1.0612 
Better F1! Saving model!
Saving model of best f1: 0.35666418466120625
              precision    recall  f1-score   support

           0   0.575721  0.937378  0.713328       511
           1   0.487179  0.335294  0.397213       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.564805       949
   macro avg   0.354300  0.424224  0.370180       949
weighted avg   0.397275  0.564805  0.455255       949

Test Acc: 0.5648050579557429 F1_ma:0.35666418466120625
Train step: 130 acc:0.51813 total_loss: 1.592  loss:1.2763,stance loss: 0.85635 
Better F1! Saving model!
Saving model of best f1: 0.3567293777134588
              precision    recall  f1-score   support

           0   0.566016  0.964775  0.713459       511
           1   0.512821  0.235294  0.322581       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.561644       949
   macro avg   0.359612  0.400023  0.345346       949
weighted avg   0.396642  0.561644  0.441956       949

Test Acc: 0.5616438356164384 F1_ma:0.3567293777134588
Train step: 140 acc:0.52349 total_loss: 1.5798  loss:1.3304,stance loss: 0.90183 
Train step: 150 acc:0.52649 total_loss: 1.5734  loss:1.68,stance loss: 1.1856 
Train step: 160 acc:0.53416 total_loss: 1.5587  loss:1.255,stance loss: 0.92644 
Better F1! Saving model!
Saving model of best f1: 0.35693215339233036
              precision    recall  f1-score   support

           0   0.572781  0.947162  0.713864       511
           1   0.557692  0.341176  0.423358       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.571128       949
   macro avg   0.376824  0.429446  0.379074       949
weighted avg   0.408323  0.571128  0.460227       949

Test Acc: 0.571127502634352 F1_ma:0.35693215339233036
Train step: 170 acc:0.53363 total_loss: 1.5552  loss:1.6215,stance loss: 1.2231 
Train step: 180 acc:0.53695 total_loss: 1.548  loss:1.5854,stance loss: 1.6333 
Train step: 190 acc:0.53894 total_loss: 1.544  loss:1.5301,stance loss: 0.95274 
Better F1! Saving model!
Saving model of best f1: 0.3585329341317365
              precision    recall  f1-score   support

           0   0.580606  0.937378  0.717066       511
           1   0.548387  0.400000  0.462585       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.576396       949
   macro avg   0.376331  0.445793  0.393217       949
weighted avg   0.410870  0.576396  0.468978       949

Test Acc: 0.5763962065331928 F1_ma:0.3585329341317365
Train step: 200 acc:0.54291 total_loss: 1.5404  loss:1.3509,stance loss: 0.92283 
Train step: 210 acc:0.54769 total_loss: 1.5369  loss:1.0471,stance loss: 0.65808 
Train step: 220 acc:0.54977 total_loss: 1.5354  loss:1.5378,stance loss: 1.2572 
Train step: 230 acc:0.55276 total_loss: 1.5282  loss:0.8852,stance loss: 0.34137 
Train step: 240 acc:0.55654 total_loss: 1.5261  loss:1.2387,stance loss: 0.92086 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.64583 total_loss: 1.4319  loss:1.2662,stance loss: 0.85554 
Train step: 260 acc:0.67188 total_loss: 1.3291  loss:1.4007,stance loss: 1.1503 
Better F1! Saving model!
Saving model of best f1: 0.3597883597883598
              precision    recall  f1-score   support

           0   0.586207  0.931507  0.719577       511
           1   0.532847  0.429412  0.475570       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.578504       949
   macro avg   0.373018  0.453640  0.398382       949
weighted avg   0.411102  0.578504  0.472656       949

Test Acc: 0.5785036880927292 F1_ma:0.3597883597883598
Train step: 270 acc:0.69231 total_loss: 1.3386  loss:1.4508,stance loss: 1.1545 
Train step: 280 acc:0.70139 total_loss: 1.3132  loss:0.98609,stance loss: 0.54373 
Train step: 290 acc:0.68342 total_loss: 1.3596  loss:1.8167,stance loss: 1.6822 
Train step: 300 acc:0.67969 total_loss: 1.3536  loss:1.1062,stance loss: 0.86949 
Train step: 310 acc:0.68277 total_loss: 1.3391  loss:1.0426,stance loss: 0.65691 
Train step: 320 acc:0.67763 total_loss: 1.3448  loss:1.5407,stance loss: 1.3432 
Train step: 330 acc:0.67224 total_loss: 1.348  loss:1.5168,stance loss: 0.84666 
Train step: 340 acc:0.67122 total_loss: 1.344  loss:1.5138,stance loss: 1.2121 
Train step: 350 acc:0.66627 total_loss: 1.3463  loss:1.5115,stance loss: 1.2442 
Train step: 360 acc:0.66703 total_loss: 1.3375  loss:1.2792,stance loss: 0.96278 
Train step: 370 acc:0.66915 total_loss: 1.3319  loss:1.2002,stance loss: 0.81341 
Train step: 380 acc:0.67188 total_loss: 1.3298  loss:1.3918,stance loss: 1.0064 
Train step: 390 acc:0.67295 total_loss: 1.3217  loss:1.1353,stance loss: 0.73229 
Train step: 400 acc:0.67508 total_loss: 1.3163  loss:0.93951,stance loss: 0.69714 
Train step: 410 acc:0.67319 total_loss: 1.3168  loss:1.0643,stance loss: 0.7659 
Train step: 420 acc:0.67365 total_loss: 1.3184  loss:1.3954,stance loss: 1.1954 
Train step: 430 acc:0.67473 total_loss: 1.3143  loss:1.0179,stance loss: 0.72791 
Train step: 440 acc:0.67315 total_loss: 1.3103  loss:0.98746,stance loss: 0.61554 
Train step: 450 acc:0.67688 total_loss: 1.3026  loss:1.507,stance loss: 1.6505 
Train step: 460 acc:0.67622 total_loss: 1.3016  loss:1.0112,stance loss: 0.75557 
Train step: 470 acc:0.67754 total_loss: 1.297  loss:0.95036,stance loss: 0.84768 
Train step: 480 acc:0.68035 total_loss: 1.2942  loss:1.7444,stance loss: 1.8349 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.8125 total_loss: 0.98801  loss:0.98801,stance loss: 0.69419 
Train step: 500 acc:0.6875 total_loss: 1.2051  loss:1.1162,stance loss: 0.90077 
Train step: 510 acc:0.69345 total_loss: 1.202  loss:0.84356,stance loss: 0.69037 
Train step: 520 acc:0.68145 total_loss: 1.2556  loss:1.1233,stance loss: 0.87819 
Train step: 530 acc:0.67683 total_loss: 1.2701  loss:1.6627,stance loss: 1.3695 
Train step: 540 acc:0.69363 total_loss: 1.2517  loss:0.86671,stance loss: 0.55894 
Train step: 550 acc:0.71209 total_loss: 1.2134  loss:0.90037,stance loss: 0.64366 
Train step: 560 acc:0.70423 total_loss: 1.2113  loss:1.1844,stance loss: 0.89571 
Train step: 570 acc:0.7037 total_loss: 1.2125  loss:1.4088,stance loss: 1.2928 
Train step: 580 acc:0.70467 total_loss: 1.2148  loss:1.3137,stance loss: 1.1257 
Train step: 590 acc:0.70668 total_loss: 1.2052  loss:1.2292,stance loss: 0.78885 
Train step: 600 acc:0.70777 total_loss: 1.2038  loss:1.0326,stance loss: 0.90734 
Train step: 610 acc:0.703 total_loss: 1.2038  loss:1.1256,stance loss: 0.78531 
Train step: 620 acc:0.70754 total_loss: 1.1944  loss:1.3154,stance loss: 1.5668 
Train step: 630 acc:0.71232 total_loss: 1.1883  loss:1.3474,stance loss: 1.4818 
Train step: 640 acc:0.71109 total_loss: 1.193  loss:1.4172,stance loss: 0.97533 
Train step: 650 acc:0.71312 total_loss: 1.1925  loss:1.0912,stance loss: 0.89143 
Train step: 660 acc:0.71455 total_loss: 1.1821  loss:1.0718,stance loss: 0.73153 
Train step: 670 acc:0.71167 total_loss: 1.1805  loss:1.0674,stance loss: 0.8629 
Train step: 680 acc:0.70942 total_loss: 1.1798  loss:1.16,stance loss: 0.79027 
Train step: 690 acc:0.70678 total_loss: 1.1792  loss:1.1518,stance loss: 0.84901 
Train step: 700 acc:0.70853 total_loss: 1.1714  loss:0.98066,stance loss: 0.79118 
Train step: 710 acc:0.70814 total_loss: 1.1697  loss:1.1409,stance loss: 0.91698 
Train step: 720 acc:0.70671 total_loss: 1.1729  loss:1.1346,stance loss: 0.83674 
Train step: 730 acc:0.70851 total_loss: 1.1664  loss:0.73384,stance loss: 0.43122 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.72917 total_loss: 1.1337  loss:1.002,stance loss: 0.86619 
Train step: 750 acc:0.73047 total_loss: 1.0673  loss:1.1519,stance loss: 0.86058 
Train step: 760 acc:0.72115 total_loss: 1.0757  loss:1.4524,stance loss: 1.4687 
Train step: 770 acc:0.72396 total_loss: 1.084  loss:0.70996,stance loss: 0.50846 
Train step: 780 acc:0.71603 total_loss: 1.1083  loss:1.2811,stance loss: 0.88267 
Train step: 790 acc:0.7154 total_loss: 1.0916  loss:1.1554,stance loss: 1.3055 
Train step: 800 acc:0.71023 total_loss: 1.1028  loss:1.2675,stance loss: 0.90288 
Train step: 810 acc:0.71628 total_loss: 1.0996  loss:1.2353,stance loss: 1.1421 
Train step: 820 acc:0.71584 total_loss: 1.0974  loss:1.271,stance loss: 0.93349 
Train step: 830 acc:0.7181 total_loss: 1.0966  loss:1.3259,stance loss: 1.2043 
Train step: 840 acc:0.71698 total_loss: 1.1022  loss:1.004,stance loss: 0.91295 
Train step: 850 acc:0.71498 total_loss: 1.1042  loss:0.73789,stance loss: 0.52327 
Train step: 860 acc:0.71677 total_loss: 1.102  loss:0.93798,stance loss: 0.73473 
Train step: 870 acc:0.72151 total_loss: 1.095  loss:0.85626,stance loss: 0.73957 
Train step: 880 acc:0.7256 total_loss: 1.0907  loss:0.99275,stance loss: 0.81984 
Train step: 890 acc:0.72716 total_loss: 1.0892  loss:0.94551,stance loss: 0.78238 
Train step: 900 acc:0.72553 total_loss: 1.0904  loss:1.2561,stance loss: 1.0329 
Train step: 910 acc:0.73011 total_loss: 1.0852  loss:0.84964,stance loss: 0.691 
Train step: 920 acc:0.72984 total_loss: 1.0847  loss:1.1127,stance loss: 0.73075 
Train step: 930 acc:0.728 total_loss: 1.084  loss:1.2476,stance loss: 0.85345 
Train step: 940 acc:0.72785 total_loss: 1.0823  loss:0.45088,stance loss: 0.22136 
Train step: 950 acc:0.7283 total_loss: 1.0841  loss:1.8467,stance loss: 1.7472 
Train step: 960 acc:0.73009 total_loss: 1.0859  loss:1.5254,stance loss: 1.2717 
Train step: 970 acc:0.72934 total_loss: 1.0857  loss:1.0191,stance loss: 0.86988 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.6875 total_loss: 0.99002  loss:0.99002,stance loss: 0.60754 
Train step: 990 acc:0.70455 total_loss: 1.1655  loss:0.92941,stance loss: 0.76067 
Train step: 1000 acc:0.73512 total_loss: 1.0534  loss:0.89226,stance loss: 0.64567 
Train step: 1010 acc:0.72984 total_loss: 1.0385  loss:0.89397,stance loss: 0.6928 
Train step: 1020 acc:0.73476 total_loss: 1.0516  loss:1.3015,stance loss: 1.0616 
Train step: 1030 acc:0.73039 total_loss: 1.0587  loss:0.95637,stance loss: 0.73065 
Train step: 1040 acc:0.74795 total_loss: 1.0339  loss:1.0612,stance loss: 0.78213 
Train step: 1050 acc:0.75352 total_loss: 1.0067  loss:0.81377,stance loss: 0.69051 
Train step: 1060 acc:0.74769 total_loss: 1.0153  loss:0.92408,stance loss: 0.7223 
Train step: 1070 acc:0.74245 total_loss: 1.024  loss:0.74754,stance loss: 0.55962 
Train step: 1080 acc:0.73948 total_loss: 1.0372  loss:0.78486,stance loss: 0.49325 
Train step: 1090 acc:0.74268 total_loss: 1.0271  loss:0.84504,stance loss: 0.6107 
Train step: 1100 acc:0.74277 total_loss: 1.0254  loss:1.2596,stance loss: 0.88878 
Train step: 1110 acc:0.74427 total_loss: 1.0227  loss:1.5202,stance loss: 1.291 
Train step: 1120 acc:0.74246 total_loss: 1.0218  loss:0.98631,stance loss: 0.71227 
Train step: 1130 acc:0.74752 total_loss: 1.0104  loss:0.69765,stance loss: 0.57347 
Train step: 1140 acc:0.75078 total_loss: 1.0025  loss:0.94182,stance loss: 0.79419 
Train step: 1150 acc:0.75073 total_loss: 0.99565  loss:0.53387,stance loss: 0.33512 
Train step: 1160 acc:0.75242 total_loss: 0.995  loss:0.82477,stance loss: 0.56267 
Train step: 1170 acc:0.75229 total_loss: 0.99374  loss:1.1238,stance loss: 1.2951 
Train step: 1180 acc:0.75155 total_loss: 0.99397  loss:0.79116,stance loss: 0.62587 
Train step: 1190 acc:0.75237 total_loss: 0.99534  loss:0.64198,stance loss: 0.42914 
Train step: 1200 acc:0.75283 total_loss: 0.9941  loss:0.69708,stance loss: 0.51744 
Train step: 1210 acc:0.7546 total_loss: 0.98669  loss:0.63109,stance loss: 0.43833 
Train step: 1220 acc:0.75493 total_loss: 0.98705  loss:0.51785,stance loss: 0.28174 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.79167 total_loss: 0.83257  loss:1.0349,stance loss: 0.79749 
Train step: 1240 acc:0.78906 total_loss: 0.87432  loss:1.3289,stance loss: 1.391 
Train step: 1250 acc:0.77885 total_loss: 0.92541  loss:1.4121,stance loss: 1.6502 
Train step: 1260 acc:0.7691 total_loss: 0.97161  loss:1.4499,stance loss: 1.6414 
Train step: 1270 acc:0.7731 total_loss: 0.94116  loss:1.0436,stance loss: 0.87093 
Train step: 1280 acc:0.77679 total_loss: 0.92607  loss:0.53035,stance loss: 0.38209 
Train step: 1290 acc:0.77746 total_loss: 0.92095  loss:0.64541,stance loss: 0.48934 
Train step: 1300 acc:0.77961 total_loss: 0.9066  loss:0.76803,stance loss: 0.54248 
Train step: 1310 acc:0.77689 total_loss: 0.92271  loss:1.1979,stance loss: 1.5061 
Train step: 1320 acc:0.77604 total_loss: 0.91606  loss:0.61003,stance loss: 0.30344 
Train step: 1330 acc:0.7783 total_loss: 0.9113  loss:0.80054,stance loss: 0.57345 
Train step: 1340 acc:0.77317 total_loss: 0.92352  loss:1.3196,stance loss: 0.84244 
Train step: 1350 acc:0.77927 total_loss: 0.91438  loss:0.69099,stance loss: 0.48011 
Train step: 1360 acc:0.77849 total_loss: 0.91368  loss:0.6498,stance loss: 0.46154 
Train step: 1370 acc:0.77783 total_loss: 0.92116  loss:1.4122,stance loss: 1.6766 
Train step: 1380 acc:0.77524 total_loss: 0.92411  loss:1.1346,stance loss: 0.83477 
Train step: 1390 acc:0.77372 total_loss: 0.92327  loss:0.69396,stance loss: 0.57081 
Train step: 1400 acc:0.77237 total_loss: 0.9213  loss:0.74305,stance loss: 0.55376 
Better F1! Saving model!
Saving model of best f1: 0.3624525528226957
              precision    recall  f1-score   support

           0   0.607710  0.524462  0.563025       511
           1   0.363868  0.841176  0.507993       170
           2   0.269565  0.115672  0.161880       268

    accuracy                       0.465753       949
   macro avg   0.413714  0.493770  0.410966       949
weighted avg   0.468536  0.465753  0.439882       949

Test Acc: 0.4657534246575342 F1_ma:0.3624525528226957
Train step: 1410 acc:0.77184 total_loss: 0.91759  loss:0.87464,stance loss: 0.64531 
Train step: 1420 acc:0.77232 total_loss: 0.91232  loss:0.70442,stance loss: 0.55174 
Train step: 1430 acc:0.77063 total_loss: 0.91936  loss:0.69354,stance loss: 0.53616 
Train step: 1440 acc:0.76852 total_loss: 0.91638  loss:0.9009,stance loss: 0.74159 
Train step: 1450 acc:0.77102 total_loss: 0.91117  loss:0.37061,stance loss: 0.22835 
Train step: 1460 acc:0.77278 total_loss: 0.90236  loss:0.56024,stance loss: 0.43922 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.9375 total_loss: 0.59218  loss:0.59218,stance loss: 0.47763 
Train step: 1480 acc:0.78409 total_loss: 0.84831  loss:1.3358,stance loss: 1.2296 
Train step: 1490 acc:0.78869 total_loss: 0.85525  loss:0.36148,stance loss: 0.11549 
Train step: 1500 acc:0.79637 total_loss: 0.85391  loss:1.0373,stance loss: 0.91806 
Train step: 1510 acc:0.8125 total_loss: 0.8098  loss:0.52798,stance loss: 0.45212 
Train step: 1520 acc:0.82108 total_loss: 0.78964  loss:1.2521,stance loss: 1.2365 
Train step: 1530 acc:0.82275 total_loss: 0.79817  loss:0.856,stance loss: 0.71657 
Train step: 1540 acc:0.82658 total_loss: 0.77691  loss:0.67829,stance loss: 0.45462 
Train step: 1550 acc:0.82948 total_loss: 0.77039  loss:1.2662,stance loss: 1.4232 
Train step: 1560 acc:0.82761 total_loss: 0.76865  loss:0.96831,stance loss: 0.82635 
Train step: 1570 acc:0.82116 total_loss: 0.77918  loss:0.94787,stance loss: 0.69889 
Train step: 1580 acc:0.82095 total_loss: 0.78592  loss:0.74184,stance loss: 0.63004 
Train step: 1590 acc:0.81767 total_loss: 0.80156  loss:0.8158,stance loss: 0.68786 
Train step: 1600 acc:0.81632 total_loss: 0.8049  loss:0.45764,stance loss: 0.29763 
Train step: 1610 acc:0.81294 total_loss: 0.80916  loss:1.4378,stance loss: 1.6181 
Train step: 1620 acc:0.81084 total_loss: 0.80283  loss:0.79838,stance loss: 0.60407 
Better F1! Saving model!
Saving model of best f1: 0.3733204067079571
              precision    recall  f1-score   support

           0   0.617500  0.483366  0.542261       511
           1   0.354680  0.847059  0.500000       170
           2   0.293706  0.156716  0.204380       268

    accuracy                       0.456270       949
   macro avg   0.421962  0.495714  0.415547       949
weighted avg   0.478979  0.456270  0.439272       949

Test Acc: 0.45626975763962063 F1_ma:0.3733204067079571
Train step: 1630 acc:0.8125 total_loss: 0.79722  loss:0.61434,stance loss: 0.48979 
Train step: 1640 acc:0.81287 total_loss: 0.79731  loss:0.72966,stance loss: 0.60215 
Train step: 1650 acc:0.81354 total_loss: 0.79395  loss:0.93705,stance loss: 0.74213 
Train step: 1660 acc:0.81479 total_loss: 0.79095  loss:0.82905,stance loss: 0.68115 
Train step: 1670 acc:0.81405 total_loss: 0.79232  loss:0.499,stance loss: 0.45354 
Train step: 1680 acc:0.81428 total_loss: 0.79152  loss:1.0881,stance loss: 0.9223 
Better F1! Saving model!
Saving model of best f1: 0.3924669551994385
              precision    recall  f1-score   support

           0   0.578035  0.587084  0.582524       511
           1   0.413428  0.688235  0.516556       170
           2   0.285714  0.156716  0.202410       268

    accuracy                       0.483667       949
   macro avg   0.425726  0.477345  0.433830       949
weighted avg   0.465996  0.483667  0.463362       949

Test Acc: 0.48366701791359323 F1_ma:0.3924669551994385
Train step: 1690 acc:0.8142 total_loss: 0.78923  loss:0.43914,stance loss: 0.34336 
Train step: 1700 acc:0.81385 total_loss: 0.78911  loss:0.73247,stance loss: 0.63472 
Train step: 1710 acc:0.81406 total_loss: 0.79043  loss:0.99247,stance loss: 0.93018 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.83333 total_loss: 0.8715  loss:1.1813,stance loss: 1.5329 
Train step: 1730 acc:0.81641 total_loss: 0.77376  loss:0.63094,stance loss: 0.48673 
Train step: 1740 acc:0.83413 total_loss: 0.72377  loss:0.58634,stance loss: 0.53689 
Train step: 1750 acc:0.84201 total_loss: 0.69846  loss:0.72529,stance loss: 0.49586 
Better F1! Saving model!
Saving model of best f1: 0.39270855032400814
              precision    recall  f1-score   support

           0   0.620370  0.655577  0.637488       511
           1   0.377581  0.752941  0.502947       170
           2   0.357143  0.093284  0.147929       268

    accuracy                       0.514226       949
   macro avg   0.451698  0.500601  0.429455       949
weighted avg   0.502542  0.514226  0.475134       949

Test Acc: 0.5142255005268704 F1_ma:0.39270855032400814
Train step: 1760 acc:0.84647 total_loss: 0.71056  loss:0.9164,stance loss: 1.0917 
Train step: 1770 acc:0.85045 total_loss: 0.68038  loss:0.4378,stance loss: 0.29055 
Train step: 1780 acc:0.84659 total_loss: 0.68004  loss:0.72229,stance loss: 0.54175 
Train step: 1790 acc:0.83964 total_loss: 0.68691  loss:1.0666,stance loss: 0.77509 
Train step: 1800 acc:0.83358 total_loss: 0.69329  loss:1.0241,stance loss: 0.92163 
Train step: 1810 acc:0.83464 total_loss: 0.69412  loss:0.76941,stance loss: 0.60234 
Better F1! Saving model!
Saving model of best f1: 0.3986330789832735
              precision    recall  f1-score   support

           0   0.601547  0.608611  0.605058       511
           1   0.380952  0.705882  0.494845       170
           2   0.316239  0.138060  0.192208       268

    accuracy                       0.493151       949
   macro avg   0.432913  0.484184  0.430704       949
weighted avg   0.481459  0.493151  0.468725       949

Test Acc: 0.4931506849315068 F1_ma:0.3986330789832735
Train step: 1820 acc:0.83726 total_loss: 0.69437  loss:1.0655,stance loss: 0.92663 
Train step: 1830 acc:0.84052 total_loss: 0.68311  loss:0.76917,stance loss: 0.48585 
Train step: 1840 acc:0.84127 total_loss: 0.68893  loss:1.0203,stance loss: 0.90288 
Better F1! Saving model!
Saving model of best f1: 0.4055245129346
              precision    recall  f1-score   support

           0   0.600000  0.540117  0.568486       511
           1   0.390625  0.735294  0.510204       170
           2   0.313609  0.197761  0.242563       268

    accuracy                       0.478398       949
   macro avg   0.434745  0.491058  0.440418       949
weighted avg   0.481616  0.478398  0.466004       949

Test Acc: 0.47839831401475236 F1_ma:0.4055245129346
Train step: 1850 acc:0.84421 total_loss: 0.68375  loss:0.90234,stance loss: 0.81605 
Train step: 1860 acc:0.8399 total_loss: 0.68514  loss:0.65312,stance loss: 0.52064 
Train step: 1870 acc:0.83774 total_loss: 0.69067  loss:0.42625,stance loss: 0.31479 
Train step: 1880 acc:0.8366 total_loss: 0.69949  loss:0.68634,stance loss: 0.54745 
Train step: 1890 acc:0.83381 total_loss: 0.70559  loss:0.75043,stance loss: 0.52487 
Train step: 1900 acc:0.83401 total_loss: 0.70841  loss:0.38335,stance loss: 0.29391 
Train step: 1910 acc:0.83131 total_loss: 0.71208  loss:0.69247,stance loss: 0.57143 
Better F1! Saving model!
Saving model of best f1: 0.4117662537925736
              precision    recall  f1-score   support

           0   0.604918  0.722114  0.658341       511
           1   0.410448  0.647059  0.502283       170
           2   0.394366  0.104478  0.165192       268

    accuracy                       0.534247       949
   macro avg   0.469911  0.491217  0.441939       949
weighted avg   0.510621  0.534247  0.491119       949

Test Acc: 0.5342465753424658 F1_ma:0.4117662537925736
Train step: 1920 acc:0.83374 total_loss: 0.70762  loss:0.85709,stance loss: 0.76676 
Train step: 1930 acc:0.83304 total_loss: 0.70675  loss:0.45133,stance loss: 0.38581 
Train step: 1940 acc:0.8349 total_loss: 0.70522  loss:0.89361,stance loss: 1.1354 
Train step: 1950 acc:0.83528 total_loss: 0.7038  loss:0.59105,stance loss: 0.42024 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.8125 total_loss: 0.59049  loss:0.59049,stance loss: 0.44052 
Train step: 1970 acc:0.88636 total_loss: 0.4786  loss:0.48918,stance loss: 0.34679 
Train step: 1980 acc:0.85417 total_loss: 0.6012  loss:1.2538,stance loss: 1.0154 
Train step: 1990 acc:0.85887 total_loss: 0.60707  loss:0.4951,stance loss: 0.36918 
Train step: 2000 acc:0.8689 total_loss: 0.58584  loss:0.6225,stance loss: 0.55721 
Train step: 2010 acc:0.86887 total_loss: 0.58101  loss:0.57469,stance loss: 0.50454 
Train step: 2020 acc:0.86475 total_loss: 0.58447  loss:0.57315,stance loss: 0.5002 
Train step: 2030 acc:0.86092 total_loss: 0.58867  loss:0.46489,stance loss: 0.24002 
Better F1! Saving model!
Saving model of best f1: 0.41824104904016113
              precision    recall  f1-score   support

           0   0.576923  0.440313  0.499445       511
           1   0.376307  0.635294  0.472648       170
           2   0.334559  0.339552  0.337037       268

    accuracy                       0.446786       949
   macro avg   0.429263  0.471720  0.436377       949
weighted avg   0.472541  0.446786  0.448780       949

Test Acc: 0.44678609062170704 F1_ma:0.41824104904016113
Train step: 2040 acc:0.86651 total_loss: 0.59487  loss:0.91821,stance loss: 0.53996 
Train step: 2050 acc:0.8647 total_loss: 0.60471  loss:0.28461,stance loss: 0.18555 
Train step: 2060 acc:0.86943 total_loss: 0.58944  loss:0.30617,stance loss: 0.22642 
Train step: 2070 acc:0.8705 total_loss: 0.58132  loss:0.45345,stance loss: 0.40687 
Train step: 2080 acc:0.87035 total_loss: 0.58062  loss:0.75712,stance loss: 0.73917 
Train step: 2090 acc:0.86832 total_loss: 0.59668  loss:0.33138,stance loss: 0.1675 
Train step: 2100 acc:0.86968 total_loss: 0.5867  loss:0.75568,stance loss: 0.68375 
Train step: 2110 acc:0.87045 total_loss: 0.58732  loss:0.41009,stance loss: 0.2418 
Train step: 2120 acc:0.87228 total_loss: 0.58127  loss:0.66786,stance loss: 0.44967 
Train step: 2130 acc:0.8739 total_loss: 0.57813  loss:0.31558,stance loss: 0.17039 
Train step: 2140 acc:0.87465 total_loss: 0.58262  loss:0.63909,stance loss: 0.51283 
Train step: 2150 acc:0.87304 total_loss: 0.58446  loss:0.60705,stance loss: 0.51508 
Train step: 2160 acc:0.87313 total_loss: 0.58504  loss:0.39526,stance loss: 0.32311 
Train step: 2170 acc:0.87174 total_loss: 0.58739  loss:0.44325,stance loss: 0.31006 
Train step: 2180 acc:0.86934 total_loss: 0.59094  loss:0.35274,stance loss: 0.25243 
Train step: 2190 acc:0.86986 total_loss: 0.58932  loss:0.2388,stance loss: 0.17517 
Train step: 2200 acc:0.87085 total_loss: 0.59057  loss:0.56164,stance loss: 0.4634 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.80208 total_loss: 0.76081  loss:0.77042,stance loss: 0.56555 
Train step: 2220 acc:0.82812 total_loss: 0.68552  loss:0.579,stance loss: 0.48876 
Better F1! Saving model!
Saving model of best f1: 0.4220754641804128
              precision    recall  f1-score   support

           0   0.610413  0.665362  0.636704       511
           1   0.415493  0.694118  0.519824       170
           2   0.361111  0.145522  0.207447       268

    accuracy                       0.523709       949
   macro avg   0.462339  0.501667  0.454658       949
weighted avg   0.505092  0.523709  0.494543       949

Test Acc: 0.523709167544784 F1_ma:0.4220754641804128
Train step: 2230 acc:0.86058 total_loss: 0.60971  loss:0.50217,stance loss: 0.49263 
Better F1! Saving model!
Saving model of best f1: 0.4314812612719741
              precision    recall  f1-score   support

           0   0.634573  0.567515  0.599174       511
           1   0.379009  0.764706  0.506823       170
           2   0.369128  0.205224  0.263789       268

    accuracy                       0.500527       949
   macro avg   0.460903  0.512481  0.456595       949
weighted avg   0.513830  0.500527  0.487917       949

Test Acc: 0.5005268703898841 F1_ma:0.4314812612719741
Train step: 2240 acc:0.87326 total_loss: 0.58007  loss:1.0018,stance loss: 1.0991 
Train step: 2250 acc:0.87908 total_loss: 0.57227  loss:0.46076,stance loss: 0.33861 
Train step: 2260 acc:0.875 total_loss: 0.58313  loss:0.71451,stance loss: 0.45258 
Train step: 2270 acc:0.87311 total_loss: 0.57289  loss:0.24,stance loss: 0.18078 
Train step: 2280 acc:0.87418 total_loss: 0.55847  loss:0.80885,stance loss: 1.1057 
Train step: 2290 acc:0.87936 total_loss: 0.55223  loss:0.15338,stance loss: 0.097157 
Train step: 2300 acc:0.88281 total_loss: 0.54102  loss:0.19641,stance loss: 0.055746 
Train step: 2310 acc:0.88384 total_loss: 0.53993  loss:0.46116,stance loss: 0.37299 
Train step: 2320 acc:0.88631 total_loss: 0.5333  loss:0.51737,stance loss: 0.40908 
Train step: 2330 acc:0.88839 total_loss: 0.53386  loss:0.85296,stance loss: 1.2772 
Train step: 2340 acc:0.89017 total_loss: 0.5208  loss:0.40104,stance loss: 0.3269 
Train step: 2350 acc:0.89084 total_loss: 0.51831  loss:0.75757,stance loss: 1.0478 
Train step: 2360 acc:0.88902 total_loss: 0.51644  loss:0.39103,stance loss: 0.28857 
Better F1! Saving model!
Saving model of best f1: 0.43302875216904246
              precision    recall  f1-score   support

           0   0.626437  0.426614  0.507567       511
           1   0.386431  0.770588  0.514735       170
           2   0.362595  0.354478  0.358491       268

    accuracy                       0.467861       949
   macro avg   0.458488  0.517227  0.460264       949
weighted avg   0.508934  0.467861  0.466751       949

Test Acc: 0.4678609062170706 F1_ma:0.43302875216904246
Train step: 2370 acc:0.88893 total_loss: 0.51916  loss:0.58335,stance loss: 0.48155 
Train step: 2380 acc:0.88814 total_loss: 0.52168  loss:0.7867,stance loss: 0.71553 
Train step: 2390 acc:0.88777 total_loss: 0.5242  loss:0.69374,stance loss: 0.58251 
Train step: 2400 acc:0.88935 total_loss: 0.5208  loss:0.25249,stance loss: 0.19023 
Train step: 2410 acc:0.88744 total_loss: 0.52269  loss:1.1458,stance loss: 1.1063 
Train step: 2420 acc:0.88773 total_loss: 0.52114  loss:0.25492,stance loss: 0.16823 
Better F1! Saving model!
Saving model of best f1: 0.43565279532794765
              precision    recall  f1-score   support

           0   0.610000  0.596869  0.603363       511
           1   0.384615  0.676471  0.490405       170
           2   0.373333  0.208955  0.267943       268

    accuracy                       0.501581       949
   macro avg   0.455983  0.494098  0.453904       949
weighted avg   0.502790  0.501581  0.488405       949

Test Acc: 0.5015806111696522 F1_ma:0.43565279532794765
Train step: 2430 acc:0.88717 total_loss: 0.52147  loss:1.0377,stance loss: 1.0875 
Train step: 2440 acc:0.88665 total_loss: 0.52045  loss:0.61626,stance loss: 0.47717 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.40813  loss:0.40813,stance loss: 0.3722 
Train step: 2460 acc:0.91477 total_loss: 0.42669  loss:0.27299,stance loss: 0.19372 
Train step: 2470 acc:0.91964 total_loss: 0.43646  loss:0.48789,stance loss: 0.41556 
Train step: 2480 acc:0.90121 total_loss: 0.47723  loss:0.2013,stance loss: 0.11539 
Train step: 2490 acc:0.90549 total_loss: 0.45954  loss:0.49223,stance loss: 0.45633 
Train step: 2500 acc:0.89951 total_loss: 0.46731  loss:0.69512,stance loss: 1.1017 
Train step: 2510 acc:0.89344 total_loss: 0.48168  loss:0.45796,stance loss: 0.39896 
Train step: 2520 acc:0.89701 total_loss: 0.46604  loss:0.29734,stance loss: 0.20487 
Train step: 2530 acc:0.90046 total_loss: 0.45552  loss:0.068705,stance loss: 0.014473 
Train step: 2540 acc:0.90247 total_loss: 0.44245  loss:0.41901,stance loss: 0.45037 
Train step: 2550 acc:0.90161 total_loss: 0.44831  loss:0.083136,stance loss: 0.028953 
Train step: 2560 acc:0.90653 total_loss: 0.44208  loss:0.049521,stance loss: 0.002484 
Train step: 2570 acc:0.90702 total_loss: 0.43697  loss:0.21885,stance loss: 0.10673 
Train step: 2580 acc:0.90458 total_loss: 0.45382  loss:1.1077,stance loss: 1.434 
Train step: 2590 acc:0.90603 total_loss: 0.44795  loss:0.38209,stance loss: 0.19414 
Train step: 2600 acc:0.90604 total_loss: 0.44743  loss:0.82305,stance loss: 0.62072 
Train step: 2610 acc:0.908 total_loss: 0.44447  loss:0.70725,stance loss: 1.0718 
Train step: 2620 acc:0.90534 total_loss: 0.44807  loss:0.88507,stance loss: 0.60183 
Better F1! Saving model!
Saving model of best f1: 0.4410698882334032
              precision    recall  f1-score   support

           0   0.636598  0.483366  0.549499       511
           1   0.353448  0.723529  0.474903       170
           2   0.375587  0.298507  0.332640       268

    accuracy                       0.474183       949
   macro avg   0.455211  0.501801  0.452348       949
weighted avg   0.512165  0.474183  0.474895       949

Test Acc: 0.47418335089567965 F1_ma:0.4410698882334032
Train step: 2630 acc:0.90504 total_loss: 0.44833  loss:0.6705,stance loss: 1.051 
Better F1! Saving model!
Saving model of best f1: 0.4566955266955267
              precision    recall  f1-score   support

           0   0.628942  0.663405  0.645714       511
           1   0.400709  0.664706  0.500000       170
           2   0.414062  0.197761  0.267677       268

    accuracy                       0.532139       949
   macro avg   0.481238  0.508624  0.471130       949
weighted avg   0.527375  0.532139  0.512853       949

Test Acc: 0.5321390937829295 F1_ma:0.4566955266955267
Train step: 2640 acc:0.90478 total_loss: 0.45262  loss:0.42515,stance loss: 0.51338 
Train step: 2650 acc:0.90392 total_loss: 0.45375  loss:0.48743,stance loss: 0.37473 
Train step: 2660 acc:0.90551 total_loss: 0.44969  loss:0.26623,stance loss: 0.18634 
Train step: 2670 acc:0.90441 total_loss: 0.45494  loss:0.098382,stance loss: 0.05238 
Train step: 2680 acc:0.90422 total_loss: 0.45646  loss:0.65479,stance loss: 1.0228 
Train step: 2690 acc:0.9043 total_loss: 0.45596  loss:0.53342,stance loss: 0.44553 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.95833 total_loss: 0.34576  loss:0.53877,stance loss: 0.5967 
Train step: 2710 acc:0.92969 total_loss: 0.46803  loss:0.74284,stance loss: 1.0612 
Train step: 2720 acc:0.93269 total_loss: 0.42973  loss:0.17615,stance loss: 0.12425 
Train step: 2730 acc:0.93576 total_loss: 0.37917  loss:0.72849,stance loss: 0.4736 
Train step: 2740 acc:0.92935 total_loss: 0.39898  loss:0.18029,stance loss: 0.044362 
Train step: 2750 acc:0.92969 total_loss: 0.3971  loss:0.72828,stance loss: 1.0818 
Train step: 2760 acc:0.92803 total_loss: 0.38077  loss:0.20031,stance loss: 0.081717 
Train step: 2770 acc:0.92434 total_loss: 0.38345  loss:0.24873,stance loss: 0.072589 
Train step: 2780 acc:0.92442 total_loss: 0.38402  loss:0.057765,stance loss: 0.016165 
Train step: 2790 acc:0.92057 total_loss: 0.38688  loss:0.50833,stance loss: 0.36271 
Train step: 2800 acc:0.92158 total_loss: 0.4068  loss:0.59828,stance loss: 1.0393 
Train step: 2810 acc:0.91649 total_loss: 0.41998  loss:0.92921,stance loss: 1.3329 
Train step: 2820 acc:0.91667 total_loss: 0.41038  loss:0.41285,stance loss: 0.32384 
Train step: 2830 acc:0.9182 total_loss: 0.4071  loss:0.76347,stance loss: 1.0979 
Train step: 2840 acc:0.91952 total_loss: 0.40528  loss:0.15373,stance loss: 0.10245 
Train step: 2850 acc:0.92147 total_loss: 0.41014  loss:0.98419,stance loss: 1.4209 
Train step: 2860 acc:0.9198 total_loss: 0.41089  loss:0.49811,stance loss: 0.45809 
Train step: 2870 acc:0.9201 total_loss: 0.40768  loss:0.12787,stance loss: 0.088183 
Train step: 2880 acc:0.91767 total_loss: 0.40639  loss:0.25755,stance loss: 0.22436 
Train step: 2890 acc:0.91837 total_loss: 0.40245  loss:0.084138,stance loss: 0.014381 
Train step: 2900 acc:0.91839 total_loss: 0.40249  loss:0.83098,stance loss: 0.51001 
Train step: 2910 acc:0.91927 total_loss: 0.39511  loss:0.3126,stance loss: 0.27632 
Train step: 2920 acc:0.91925 total_loss: 0.39331  loss:0.38725,stance loss: 0.36929 
Train step: 2930 acc:0.92002 total_loss: 0.39591  loss:0.63472,stance loss: 0.57267 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:1.0 total_loss: 0.1437  loss:0.1437,stance loss: 0.058566 
Train step: 2950 acc:0.9375 total_loss: 0.29959  loss:0.31981,stance loss: 0.26833 
Train step: 2960 acc:0.91667 total_loss: 0.37253  loss:0.57647,stance loss: 1.009 
Train step: 2970 acc:0.91532 total_loss: 0.37234  loss:0.78454,stance loss: 1.1109 
Train step: 2980 acc:0.92073 total_loss: 0.36653  loss:0.30783,stance loss: 0.2128 
Train step: 2990 acc:0.92157 total_loss: 0.35741  loss:0.15478,stance loss: 0.12174 
Train step: 3000 acc:0.92828 total_loss: 0.34478  loss:0.40024,stance loss: 0.35253 
Train step: 3010 acc:0.92958 total_loss: 0.35132  loss:0.53636,stance loss: 0.46554 
Train step: 3020 acc:0.92747 total_loss: 0.35321  loss:0.34848,stance loss: 0.26526 
Train step: 3030 acc:0.92995 total_loss: 0.35044  loss:0.43952,stance loss: 0.30474 
Train step: 3040 acc:0.93007 total_loss: 0.35068  loss:0.42552,stance loss: 0.44095 
Train step: 3050 acc:0.93018 total_loss: 0.34988  loss:0.11364,stance loss: 0.047415 
Train step: 3060 acc:0.93182 total_loss: 0.3449  loss:0.48156,stance loss: 0.42439 
Train step: 3070 acc:0.93368 total_loss: 0.34385  loss:0.42707,stance loss: 0.31796 
Train step: 3080 acc:0.93307 total_loss: 0.3485  loss:0.24399,stance loss: 0.19539 
Train step: 3090 acc:0.93502 total_loss: 0.34948  loss:0.66115,stance loss: 1.0569 
Train step: 3100 acc:0.93439 total_loss: 0.34551  loss:0.36995,stance loss: 0.35339 
Train step: 3110 acc:0.93567 total_loss: 0.34465  loss:0.10074,stance loss: 0.038494 
Train step: 3120 acc:0.93405 total_loss: 0.34857  loss:0.18476,stance loss: 0.13072 
Train step: 3130 acc:0.93357 total_loss: 0.3477  loss:0.31362,stance loss: 0.32925 
Train step: 3140 acc:0.93315 total_loss: 0.35329  loss:0.60631,stance loss: 0.61951 
Train step: 3150 acc:0.93335 total_loss: 0.34956  loss:0.37997,stance loss: 0.21653 
Train step: 3160 acc:0.93298 total_loss: 0.3481  loss:0.52043,stance loss: 0.38873 
Better F1! Saving model!
Saving model of best f1: 0.46755898366606174
              precision    recall  f1-score   support

           0   0.604317  0.493151  0.543103       511
           1   0.401606  0.588235  0.477327       170
           2   0.381625  0.402985  0.392015       268

    accuracy                       0.484721       949
   macro avg   0.462516  0.494790  0.470815       949
weighted avg   0.505115  0.484721  0.488653       949

Test Acc: 0.48472075869336145 F1_ma:0.46755898366606174
Train step: 3170 acc:0.93263 total_loss: 0.35262  loss:0.29078,stance loss: 0.25162 
Train step: 3180 acc:0.93335 total_loss: 0.34947  loss:0.25484,stance loss: 0.20223 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.9375 total_loss: 0.41531  loss:0.066422,stance loss: 0.044281 
Train step: 3200 acc:0.95312 total_loss: 0.33846  loss:0.2079,stance loss: 0.18278 
Train step: 3210 acc:0.96154 total_loss: 0.27871  loss:0.30635,stance loss: 0.10473 
Train step: 3220 acc:0.96181 total_loss: 0.25855  loss:0.047244,stance loss: 0.0073544 
Train step: 3230 acc:0.95788 total_loss: 0.26122  loss:0.075851,stance loss: 0.044288 
Train step: 3240 acc:0.96205 total_loss: 0.25608  loss:0.52733,stance loss: 1.0081 
Train step: 3250 acc:0.96023 total_loss: 0.27008  loss:0.70659,stance loss: 1.0915 
Train step: 3260 acc:0.9597 total_loss: 0.26659  loss:0.64043,stance loss: 0.73545 
Train step: 3270 acc:0.96076 total_loss: 0.26963  loss:0.12138,stance loss: 0.11241 
Train step: 3280 acc:0.95964 total_loss: 0.28113  loss:0.75313,stance loss: 1.2494 
Train step: 3290 acc:0.95755 total_loss: 0.28268  loss:0.33779,stance loss: 0.25052 
Train step: 3300 acc:0.95744 total_loss: 0.28153  loss:1.1108,stance loss: 1.4762 
Train step: 3310 acc:0.95536 total_loss: 0.28522  loss:0.41421,stance loss: 0.35611 
Train step: 3320 acc:0.9545 total_loss: 0.28471  loss:0.092084,stance loss: 0.025574 
Train step: 3330 acc:0.95591 total_loss: 0.28259  loss:0.13455,stance loss: 0.070526 
Train step: 3340 acc:0.95753 total_loss: 0.2819  loss:0.55618,stance loss: 1.0113 
Train step: 3350 acc:0.95858 total_loss: 0.27762  loss:0.57317,stance loss: 1.0354 
Train step: 3360 acc:0.95774 total_loss: 0.27426  loss:0.089721,stance loss: 0.05326 
Train step: 3370 acc:0.95733 total_loss: 0.27142  loss:0.041852,stance loss: 0.0094542 
Train step: 3380 acc:0.95791 total_loss: 0.27352  loss:0.30573,stance loss: 0.24717 
Train step: 3390 acc:0.95661 total_loss: 0.27848  loss:0.27303,stance loss: 0.24042 
Train step: 3400 acc:0.95689 total_loss: 0.27565  loss:0.21551,stance loss: 0.16304 
Train step: 3410 acc:0.95769 total_loss: 0.27514  loss:0.15373,stance loss: 0.098606 
Train step: 3420 acc:0.95763 total_loss: 0.27408  loss:0.44466,stance loss: 0.34685 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.9375 total_loss: 0.18386  loss:0.18386,stance loss: 0.16756 
Train step: 3440 acc:0.93182 total_loss: 0.35578  loss:0.11205,stance loss: 0.10482 
Train step: 3450 acc:0.94345 total_loss: 0.29265  loss:0.24719,stance loss: 0.30491 
Train step: 3460 acc:0.94556 total_loss: 0.25833  loss:0.418,stance loss: 0.3447 
Train step: 3470 acc:0.95274 total_loss: 0.26046  loss:0.55793,stance loss: 1.0289 
Train step: 3480 acc:0.95711 total_loss: 0.24211  loss:0.23137,stance loss: 0.19671 
Train step: 3490 acc:0.95492 total_loss: 0.2539  loss:0.54895,stance loss: 0.50286 
Train step: 3500 acc:0.95599 total_loss: 0.25728  loss:0.21288,stance loss: 0.16162 
Train step: 3510 acc:0.95525 total_loss: 0.25413  loss:0.25607,stance loss: 0.19873 
Train step: 3520 acc:0.95467 total_loss: 0.24857  loss:0.1563,stance loss: 0.12675 
Train step: 3530 acc:0.95545 total_loss: 0.24564  loss:0.17095,stance loss: 0.14509 
Train step: 3540 acc:0.95608 total_loss: 0.24052  loss:0.080214,stance loss: 0.027657 
Train step: 3550 acc:0.95713 total_loss: 0.2457  loss:0.3073,stance loss: 0.10677 
Train step: 3560 acc:0.95849 total_loss: 0.24307  loss:0.11215,stance loss: 0.066148 
Train step: 3570 acc:0.95922 total_loss: 0.23587  loss:0.087028,stance loss: 0.018456 
Train step: 3580 acc:0.96026 total_loss: 0.23928  loss:0.048497,stance loss: 0.014758 
Train step: 3590 acc:0.96157 total_loss: 0.23781  loss:0.14299,stance loss: 0.086838 
Train step: 3600 acc:0.96199 total_loss: 0.23253  loss:0.034902,stance loss: 0.016055 
Train step: 3610 acc:0.96236 total_loss: 0.2314  loss:0.45869,stance loss: 0.3849 
Train step: 3620 acc:0.9627 total_loss: 0.23235  loss:0.15117,stance loss: 0.16242 
Train step: 3630 acc:0.96238 total_loss: 0.23133  loss:0.58255,stance loss: 0.5939 
Train step: 3640 acc:0.96238 total_loss: 0.22658  loss:0.13309,stance loss: 0.081525 
Train step: 3650 acc:0.96267 total_loss: 0.22375  loss:0.054699,stance loss: 0.029818 
Train step: 3660 acc:0.96185 total_loss: 0.22693  loss:0.77637,stance loss: 0.64269 
Train step: 3670 acc:0.96136 total_loss: 0.22639  loss:0.36611,stance loss: 0.22058 
Training finished.


Reload the best model with best f1 0.46755898366606174 from path test_outputs/bert-cross-topic/fm/2023-08-14 16-59-29/state_dict


              precision    recall  f1-score   support

           0   0.604317  0.493151  0.543103       511
           1   0.401606  0.588235  0.477327       170
           2   0.381625  0.402985  0.392015       268

    accuracy                       0.484721       949
   macro avg   0.462516  0.494790  0.470815       949
weighted avg   0.505115  0.484721  0.488653       949

Test Acc: 0.48472075869336145 F1_ma:0.46755898366606174
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.46755898366606174
acc: 0.48472075869336145, f1 :0.4708149787686235
classification report: 
              precision    recall  f1-score   support

         Con     0.6043    0.4932    0.5431       511
        None     0.4016    0.5882    0.4773       170
         Pro     0.3816    0.4030    0.3920       268

    accuracy                         0.4847       949
   macro avg     0.4625    0.4948    0.4708       949
weighted avg     0.5051    0.4847    0.4887       949

run_semeval with seed: 31552
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 17-38-50', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31552, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 17-38-50
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.4375 total_loss: 1.5139  loss:1.5139,stance loss: 0.95226 
Train step: 10 acc:0.42614 total_loss: 1.6885  loss:1.9084,stance loss: 1.7333 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 20 acc:0.44048 total_loss: 1.7072  loss:1.6509,stance loss: 1.159 
Train step: 30 acc:0.45968 total_loss: 1.6804  loss:1.6454,stance loss: 1.1537 
Train step: 40 acc:0.47713 total_loss: 1.6585  loss:1.563,stance loss: 1.1475 
Train step: 50 acc:0.48529 total_loss: 1.6468  loss:1.5523,stance loss: 1.1279 
Train step: 60 acc:0.48975 total_loss: 1.6333  loss:1.6474,stance loss: 1.1001 
Train step: 70 acc:0.49912 total_loss: 1.6347  loss:1.5447,stance loss: 1.037 
Train step: 80 acc:0.48997 total_loss: 1.6308  loss:1.8763,stance loss: 1.6744 
Train step: 90 acc:0.49451 total_loss: 1.615  loss:1.3149,stance loss: 0.89903 
Better F1! Saving model!
Saving model of best f1: 0.3514467184191955
              precision    recall  f1-score   support

           0   0.549669  0.974560  0.702893       511
           1   0.581395  0.147059  0.234742       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.551106       949
   macro avg   0.377021  0.373873  0.312545       949
weighted avg   0.400124  0.551106  0.420532       949

Test Acc: 0.5511064278187566 F1_ma:0.3514467184191955
Train step: 100 acc:0.48886 total_loss: 1.6122  loss:1.596,stance loss: 1.1261 
Train step: 110 acc:0.49212 total_loss: 1.6079  loss:1.7867,stance loss: 1.1475 
Train step: 120 acc:0.4938 total_loss: 1.6012  loss:1.3348,stance loss: 0.87304 
Train step: 130 acc:0.49666 total_loss: 1.5969  loss:1.5939,stance loss: 1.1732 
Train step: 140 acc:0.49911 total_loss: 1.5903  loss:1.3043,stance loss: 0.88049 
Better F1! Saving model!
Saving model of best f1: 0.35208181154127094
              precision    recall  f1-score   support

           0   0.561772  0.943249  0.704164       511
           1   0.538462  0.288235  0.375479       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.559536       949
   macro avg   0.366744  0.410495  0.359881       949
weighted avg   0.398950  0.559536  0.446427       949

Test Acc: 0.559536354056902 F1_ma:0.35208181154127094
Train step: 150 acc:0.50248 total_loss: 1.5872  loss:1.6294,stance loss: 1.3671 
Train step: 160 acc:0.50582 total_loss: 1.5821  loss:1.269,stance loss: 0.81244 
Train step: 170 acc:0.5117 total_loss: 1.573  loss:1.4375,stance loss: 0.98897 
Better F1! Saving model!
Saving model of best f1: 0.353405017921147
              precision    recall  f1-score   support

           0   0.557692  0.964775  0.706810       511
           1   0.507692  0.194118  0.280851       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.554268       949
   macro avg   0.355128  0.386298  0.329220       949
weighted avg   0.391242  0.554268  0.430901       949

Test Acc: 0.5542676501580611 F1_ma:0.353405017921147
Train step: 180 acc:0.51865 total_loss: 1.5641  loss:1.3414,stance loss: 0.88687 
Train step: 190 acc:0.52389 total_loss: 1.5536  loss:1.657,stance loss: 1.1687 
Train step: 200 acc:0.52954 total_loss: 1.5474  loss:1.0857,stance loss: 0.77329 
Better F1! Saving model!
Saving model of best f1: 0.3539568345323741
              precision    recall  f1-score   support

           0   0.559727  0.962818  0.707914       511
           1   0.585714  0.241176  0.341667       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.561644       949
   macro avg   0.381814  0.401331  0.349860       949
weighted avg   0.406314  0.561644  0.442389       949

Test Acc: 0.5616438356164384 F1_ma:0.3539568345323741
Train step: 210 acc:0.53406 total_loss: 1.5405  loss:1.1837,stance loss: 0.84716 
Train step: 220 acc:0.5362 total_loss: 1.5364  loss:1.4779,stance loss: 1.1294 
Train step: 230 acc:0.54085 total_loss: 1.5314  loss:1.2534,stance loss: 0.82166 
Train step: 240 acc:0.54435 total_loss: 1.5273  loss:1.4864,stance loss: 1.1999 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.58333 total_loss: 1.3398  loss:1.454,stance loss: 0.87404 
Better F1! Saving model!
Saving model of best f1: 0.3551873198847262
              precision    recall  f1-score   support

           0   0.562144  0.964775  0.710375       511
           1   0.625000  0.264706  0.371901       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.566913       949
   macro avg   0.395715  0.409827  0.360758       949
weighted avg   0.414653  0.566913  0.449130       949

Test Acc: 0.5669125395152792 F1_ma:0.3551873198847262
Train step: 260 acc:0.63672 total_loss: 1.3133  loss:1.7357,stance loss: 1.5471 
Better F1! Saving model!
Saving model of best f1: 0.35664873174481165
              precision    recall  f1-score   support

           0   0.587342  0.908023  0.713297       511
           1   0.540881  0.505882  0.522796       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.579557       949
   macro avg   0.376074  0.471302  0.412031       949
weighted avg   0.413152  0.579557  0.477735       949

Test Acc: 0.5795574288724974 F1_ma:0.35664873174481165
Train step: 270 acc:0.64183 total_loss: 1.3253  loss:0.98239,stance loss: 0.54385 
Train step: 280 acc:0.64236 total_loss: 1.3286  loss:1.3959,stance loss: 1.1567 
Train step: 290 acc:0.62364 total_loss: 1.331  loss:1.5627,stance loss: 1.184 
Train step: 300 acc:0.62612 total_loss: 1.3156  loss:1.4373,stance loss: 1.0993 
Train step: 310 acc:0.625 total_loss: 1.3347  loss:1.3922,stance loss: 1.1028 
Train step: 320 acc:0.62747 total_loss: 1.3351  loss:1.2895,stance loss: 0.97239 
Better F1! Saving model!
Saving model of best f1: 0.35673248635134447
              precision    recall  f1-score   support

           0   0.552901  0.951076  0.699281       511
           1   0.696429  0.229412  0.345133       170
           2   0.142857  0.007463  0.014184       268

    accuracy                       0.555321       949
   macro avg   0.464062  0.395984  0.352866       949
weighted avg   0.462815  0.555321  0.442367       949

Test Acc: 0.5553213909378293 F1_ma:0.35673248635134447
Train step: 330 acc:0.63227 total_loss: 1.3427  loss:1.3051,stance loss: 1.008 
Train step: 340 acc:0.63997 total_loss: 1.3318  loss:0.87108,stance loss: 0.42968 
Train step: 350 acc:0.63738 total_loss: 1.3388  loss:1.6154,stance loss: 1.2758 
Better F1! Saving model!
Saving model of best f1: 0.35766423357664234
              precision    recall  f1-score   support

           0   0.570431  0.958904  0.715328       511
           1   0.566667  0.300000  0.392308       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.570074       949
   macro avg   0.379032  0.419635  0.369212       949
weighted avg   0.408665  0.570074  0.455453       949

Test Acc: 0.5700737618545838 F1_ma:0.35766423357664234
Train step: 360 acc:0.64332 total_loss: 1.3355  loss:1.2756,stance loss: 0.84616 
Train step: 370 acc:0.64782 total_loss: 1.3217  loss:1.1909,stance loss: 0.92468 
Better F1! Saving model!
Saving model of best f1: 0.3578125
              precision    recall  f1-score   support

           0   0.595579  0.896282  0.715625       511
           1   0.522222  0.552941  0.537143       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.581665       949
   macro avg   0.372600  0.483074  0.417589       949
weighted avg   0.414245  0.581665  0.481558       949

Test Acc: 0.5816649104320337 F1_ma:0.3578125
Train step: 380 acc:0.65303 total_loss: 1.3114  loss:0.99756,stance loss: 0.72075 
Better F1! Saving model!
Saving model of best f1: 0.3725916453537937
              precision    recall  f1-score   support

           0   0.618861  0.616438  0.617647       511
           1   0.402204  0.858824  0.547842       170
           2   0.285714  0.082090  0.127536       268

    accuracy                       0.508957       949
   macro avg   0.435593  0.519117  0.431009       949
weighted avg   0.485968  0.508957  0.466734       949

Test Acc: 0.5089567966280295 F1_ma:0.3725916453537937
Train step: 390 acc:0.65454 total_loss: 1.3037  loss:1.3804,stance loss: 1.2204 
Train step: 400 acc:0.65905 total_loss: 1.2972  loss:1.081,stance loss: 0.81949 
Train step: 410 acc:0.66077 total_loss: 1.2911  loss:1.1793,stance loss: 0.84271 
Train step: 420 acc:0.66335 total_loss: 1.2853  loss:1.3881,stance loss: 1.1905 
Train step: 430 acc:0.66263 total_loss: 1.2847  loss:1.0466,stance loss: 0.79824 
Train step: 440 acc:0.66199 total_loss: 1.2868  loss:1.3662,stance loss: 1.4551 
Train step: 450 acc:0.6611 total_loss: 1.2851  loss:1.1232,stance loss: 0.71809 
Train step: 460 acc:0.66088 total_loss: 1.2817  loss:0.8821,stance loss: 0.60172 
Train step: 470 acc:0.66206 total_loss: 1.2806  loss:1.2607,stance loss: 1.0287 
Train step: 480 acc:0.66128 total_loss: 1.2787  loss:1.5073,stance loss: 1.3812 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.625 total_loss: 1.2356  loss:1.2356,stance loss: 0.94775 
Train step: 500 acc:0.67614 total_loss: 1.1839  loss:1.1324,stance loss: 0.82643 
Train step: 510 acc:0.70536 total_loss: 1.128  loss:0.95444,stance loss: 0.68131 
Train step: 520 acc:0.73185 total_loss: 1.0882  loss:0.91945,stance loss: 0.65 
Train step: 530 acc:0.71494 total_loss: 1.0927  loss:1.1954,stance loss: 0.8758 
Train step: 540 acc:0.72181 total_loss: 1.0823  loss:0.6831,stance loss: 0.40025 
Better F1! Saving model!
Saving model of best f1: 0.38596012018574155
              precision    recall  f1-score   support

           0   0.614953  0.643836  0.629063       511
           1   0.430723  0.841176  0.569721       170
           2   0.304878  0.093284  0.142857       268

    accuracy                       0.523709       949
   macro avg   0.450185  0.526099  0.447214       949
weighted avg   0.494385  0.523709  0.481127       949

Test Acc: 0.523709167544784 F1_ma:0.38596012018574155
Train step: 550 acc:0.71721 total_loss: 1.0996  loss:1.1018,stance loss: 0.94997 
Train step: 560 acc:0.71215 total_loss: 1.1061  loss:1.3342,stance loss: 0.96153 
Train step: 570 acc:0.70988 total_loss: 1.1138  loss:1.3649,stance loss: 1.0033 
Train step: 580 acc:0.70742 total_loss: 1.1137  loss:0.90687,stance loss: 0.78001 
Train step: 590 acc:0.70545 total_loss: 1.1148  loss:1.4124,stance loss: 1.4564 
Train step: 600 acc:0.7027 total_loss: 1.1318  loss:1.5686,stance loss: 1.3947 
Train step: 610 acc:0.70558 total_loss: 1.134  loss:1.5684,stance loss: 1.3588 
Train step: 620 acc:0.70277 total_loss: 1.1378  loss:1.028,stance loss: 0.84577 
Train step: 630 acc:0.7039 total_loss: 1.1354  loss:1.1147,stance loss: 0.89598 
Train step: 640 acc:0.70199 total_loss: 1.1395  loss:0.93025,stance loss: 0.75343 
Train step: 650 acc:0.70264 total_loss: 1.1396  loss:0.98752,stance loss: 0.73755 
Train step: 660 acc:0.69883 total_loss: 1.1415  loss:1.0378,stance loss: 0.78791 
Train step: 670 acc:0.70062 total_loss: 1.1429  loss:1.0976,stance loss: 0.89035 
Better F1! Saving model!
Saving model of best f1: 0.4228293467924804
              precision    recall  f1-score   support

           0   0.591736  0.700587  0.641577       511
           1   0.522727  0.676471  0.589744       170
           2   0.322581  0.149254  0.204082       268

    accuracy                       0.540569       949
   macro avg   0.479014  0.508770  0.478467       949
weighted avg   0.503364  0.540569  0.508742       949

Test Acc: 0.5405690200210748 F1_ma:0.4228293467924804
Train step: 680 acc:0.69961 total_loss: 1.1456  loss:1.1251,stance loss: 0.79339 
Train step: 690 acc:0.69994 total_loss: 1.1447  loss:1.1562,stance loss: 0.90324 
Train step: 700 acc:0.69994 total_loss: 1.145  loss:1.1225,stance loss: 0.93537 
Train step: 710 acc:0.70051 total_loss: 1.1406  loss:0.93689,stance loss: 0.61884 
Train step: 720 acc:0.70103 total_loss: 1.1425  loss:1.0696,stance loss: 0.81389 
Train step: 730 acc:0.70306 total_loss: 1.1408  loss:1.3036,stance loss: 1.0522 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.72917 total_loss: 1.093  loss:1.5619,stance loss: 1.3299 
Train step: 750 acc:0.72656 total_loss: 1.0466  loss:1.3086,stance loss: 1.1089 
Train step: 760 acc:0.72356 total_loss: 1.0757  loss:1.7908,stance loss: 1.1582 
Train step: 770 acc:0.73785 total_loss: 1.0526  loss:0.74884,stance loss: 0.54733 
Train step: 780 acc:0.74049 total_loss: 1.0453  loss:1.1952,stance loss: 0.92814 
Train step: 790 acc:0.73884 total_loss: 1.0474  loss:0.95277,stance loss: 0.71035 
Train step: 800 acc:0.73485 total_loss: 1.0403  loss:0.89515,stance loss: 0.61149 
Train step: 810 acc:0.72862 total_loss: 1.0498  loss:1.2296,stance loss: 1.4547 
Train step: 820 acc:0.72965 total_loss: 1.0445  loss:1.1871,stance loss: 0.75823 
Train step: 830 acc:0.72852 total_loss: 1.0542  loss:1.0805,stance loss: 0.76265 
Train step: 840 acc:0.72642 total_loss: 1.0678  loss:1.0855,stance loss: 0.90142 
Train step: 850 acc:0.72144 total_loss: 1.0682  loss:0.81344,stance loss: 0.70483 
Train step: 860 acc:0.72222 total_loss: 1.0681  loss:0.87993,stance loss: 0.63099 
Train step: 870 acc:0.72472 total_loss: 1.0694  loss:1.0159,stance loss: 0.74898 
Train step: 880 acc:0.71918 total_loss: 1.0802  loss:1.6153,stance loss: 1.7261 
Train step: 890 acc:0.72075 total_loss: 1.0749  loss:0.63142,stance loss: 0.46016 
Train step: 900 acc:0.72214 total_loss: 1.0744  loss:1.1839,stance loss: 0.78896 
Train step: 910 acc:0.72585 total_loss: 1.0705  loss:1.4241,stance loss: 1.5666 
Train step: 920 acc:0.72715 total_loss: 1.071  loss:1.1614,stance loss: 0.97557 
Train step: 930 acc:0.72895 total_loss: 1.0696  loss:1.4994,stance loss: 1.358 
Train step: 940 acc:0.72876 total_loss: 1.0691  loss:0.9297,stance loss: 0.75222 
Train step: 950 acc:0.72772 total_loss: 1.0656  loss:0.88196,stance loss: 0.62529 
Train step: 960 acc:0.72871 total_loss: 1.066  loss:0.97281,stance loss: 0.80402 
Train step: 970 acc:0.72855 total_loss: 1.0647  loss:1.196,stance loss: 0.87677 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.875 total_loss: 0.99353  loss:0.99353,stance loss: 0.7747 
Train step: 990 acc:0.77273 total_loss: 0.90076  loss:1.0361,stance loss: 0.86529 
Train step: 1000 acc:0.75298 total_loss: 0.93016  loss:0.75808,stance loss: 0.51415 
Train step: 1010 acc:0.7379 total_loss: 1.0069  loss:1.176,stance loss: 1.4034 
Train step: 1020 acc:0.73628 total_loss: 1.0224  loss:0.76684,stance loss: 0.59364 
Train step: 1030 acc:0.7451 total_loss: 1.0102  loss:0.91027,stance loss: 0.75129 
Train step: 1040 acc:0.74488 total_loss: 1.0088  loss:0.88848,stance loss: 0.79912 
Train step: 1050 acc:0.74912 total_loss: 0.99433  loss:0.54258,stance loss: 0.3913 
Train step: 1060 acc:0.75231 total_loss: 1.0041  loss:0.80087,stance loss: 0.65846 
Train step: 1070 acc:0.75 total_loss: 1.0143  loss:0.90274,stance loss: 0.75323 
Train step: 1080 acc:0.75062 total_loss: 1.007  loss:1.1177,stance loss: 0.83243 
Train step: 1090 acc:0.74775 total_loss: 1.0166  loss:0.74304,stance loss: 0.61427 
Train step: 1100 acc:0.75103 total_loss: 1.0081  loss:0.74922,stance loss: 0.55763 
Train step: 1110 acc:0.75286 total_loss: 0.99948  loss:0.97647,stance loss: 0.74711 
Train step: 1120 acc:0.75133 total_loss: 1.0064  loss:1.1732,stance loss: 1.3979 
Train step: 1130 acc:0.74917 total_loss: 1.0153  loss:0.99022,stance loss: 0.73274 
Train step: 1140 acc:0.74651 total_loss: 1.0218  loss:1.1636,stance loss: 0.96268 
Train step: 1150 acc:0.74817 total_loss: 1.025  loss:1.1477,stance loss: 0.86546 
Train step: 1160 acc:0.75 total_loss: 1.0162  loss:0.66559,stance loss: 0.5298 
Train step: 1170 acc:0.74869 total_loss: 1.0146  loss:0.85449,stance loss: 0.48473 
Train step: 1180 acc:0.74782 total_loss: 1.0138  loss:0.96306,stance loss: 0.76104 
Train step: 1190 acc:0.74911 total_loss: 1.0062  loss:0.69932,stance loss: 0.59818 
Train step: 1200 acc:0.75339 total_loss: 0.99889  loss:0.96806,stance loss: 0.61217 
Train step: 1210 acc:0.75433 total_loss: 0.99574  loss:0.69957,stance loss: 0.52137 
Train step: 1220 acc:0.75519 total_loss: 0.98838  loss:0.8661,stance loss: 0.61398 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 0.88383  loss:0.6596,stance loss: 0.53667 
Train step: 1240 acc:0.73438 total_loss: 0.95124  loss:0.74368,stance loss: 0.51804 
Train step: 1250 acc:0.75 total_loss: 0.92828  loss:1.0643,stance loss: 0.91294 
Train step: 1260 acc:0.76215 total_loss: 0.92668  loss:1.1345,stance loss: 0.80564 
Train step: 1270 acc:0.75815 total_loss: 0.95958  loss:0.89275,stance loss: 0.74053 
Train step: 1280 acc:0.76451 total_loss: 0.92415  loss:0.81835,stance loss: 0.62134 
Train step: 1290 acc:0.7661 total_loss: 0.92051  loss:0.91319,stance loss: 0.72302 
Train step: 1300 acc:0.76645 total_loss: 0.90498  loss:0.90248,stance loss: 0.73953 
Train step: 1310 acc:0.76453 total_loss: 0.9047  loss:0.51184,stance loss: 0.33238 
Train step: 1320 acc:0.76758 total_loss: 0.90393  loss:0.6544,stance loss: 0.56115 
Train step: 1330 acc:0.76946 total_loss: 0.89936  loss:1.3874,stance loss: 1.0731 
Train step: 1340 acc:0.77317 total_loss: 0.89934  loss:1.2438,stance loss: 1.2391 
Train step: 1350 acc:0.77827 total_loss: 0.88978  loss:0.61854,stance loss: 0.58425 
Train step: 1360 acc:0.77941 total_loss: 0.88211  loss:0.85439,stance loss: 0.73188 
Train step: 1370 acc:0.7851 total_loss: 0.87597  loss:1.2217,stance loss: 1.0402 
Train step: 1380 acc:0.78646 total_loss: 0.87824  loss:0.70991,stance loss: 0.49124 
Train step: 1390 acc:0.78389 total_loss: 0.88916  loss:1.1618,stance loss: 0.87283 
Train step: 1400 acc:0.78196 total_loss: 0.89438  loss:0.82462,stance loss: 0.69746 
Train step: 1410 acc:0.78259 total_loss: 0.89715  loss:0.73218,stance loss: 0.53914 
Train step: 1420 acc:0.78603 total_loss: 0.89065  loss:0.82674,stance loss: 0.6826 
Train step: 1430 acc:0.78701 total_loss: 0.8887  loss:0.79375,stance loss: 0.62175 
Train step: 1440 acc:0.78791 total_loss: 0.88604  loss:0.56352,stance loss: 0.51009 
Train step: 1450 acc:0.78789 total_loss: 0.88376  loss:0.61818,stance loss: 0.48061 
Train step: 1460 acc:0.78814 total_loss: 0.87562  loss:0.44091,stance loss: 0.35623 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.9375 total_loss: 0.45858  loss:0.45858,stance loss: 0.29033 
Train step: 1480 acc:0.80682 total_loss: 0.68988  loss:1.0025,stance loss: 0.79772 
Train step: 1490 acc:0.82738 total_loss: 0.69656  loss:0.74727,stance loss: 0.68944 
Train step: 1500 acc:0.84073 total_loss: 0.68453  loss:0.2884,stance loss: 0.071234 
Train step: 1510 acc:0.84909 total_loss: 0.66812  loss:0.43431,stance loss: 0.28711 
Train step: 1520 acc:0.84069 total_loss: 0.69055  loss:0.89421,stance loss: 0.92089 
Train step: 1530 acc:0.83811 total_loss: 0.73182  loss:0.78082,stance loss: 1.1405 
Train step: 1540 acc:0.83539 total_loss: 0.72549  loss:1.0623,stance loss: 0.70163 
Train step: 1550 acc:0.83333 total_loss: 0.73264  loss:0.91239,stance loss: 0.68256 
Train step: 1560 acc:0.82898 total_loss: 0.74932  loss:0.65262,stance loss: 0.63346 
Train step: 1570 acc:0.82735 total_loss: 0.76123  loss:0.80157,stance loss: 1.1569 
Train step: 1580 acc:0.82883 total_loss: 0.75715  loss:0.56037,stance loss: 0.49094 
Train step: 1590 acc:0.82851 total_loss: 0.76276  loss:1.1746,stance loss: 1.4979 
Train step: 1600 acc:0.82443 total_loss: 0.76521  loss:1.2771,stance loss: 0.93637 
Train step: 1610 acc:0.82225 total_loss: 0.77596  loss:1.0291,stance loss: 0.91625 
Train step: 1620 acc:0.82616 total_loss: 0.76999  loss:0.77608,stance loss: 0.77315 
Train step: 1630 acc:0.82531 total_loss: 0.78168  loss:1.1542,stance loss: 1.3298 
Train step: 1640 acc:0.82456 total_loss: 0.7812  loss:0.45327,stance loss: 0.43097 
Train step: 1650 acc:0.82459 total_loss: 0.78112  loss:0.83366,stance loss: 0.73581 
Train step: 1660 acc:0.8233 total_loss: 0.78396  loss:1.0308,stance loss: 0.84769 
Train step: 1670 acc:0.82743 total_loss: 0.77677  loss:0.67614,stance loss: 0.52807 
Train step: 1680 acc:0.82879 total_loss: 0.77752  loss:0.86908,stance loss: 0.72389 
Train step: 1690 acc:0.82862 total_loss: 0.77847  loss:0.8735,stance loss: 0.64365 
Train step: 1700 acc:0.82873 total_loss: 0.77798  loss:0.67279,stance loss: 0.60377 
Train step: 1710 acc:0.82702 total_loss: 0.77845  loss:1.173,stance loss: 0.66319 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.89583 total_loss: 0.51416  loss:0.53573,stance loss: 0.43796 
Train step: 1730 acc:0.87109 total_loss: 0.59037  loss:0.56314,stance loss: 0.47524 
Train step: 1740 acc:0.87981 total_loss: 0.62204  loss:0.26436,stance loss: 0.2406 
Train step: 1750 acc:0.87326 total_loss: 0.61139  loss:0.31838,stance loss: 0.24531 
Train step: 1760 acc:0.87364 total_loss: 0.59833  loss:0.91666,stance loss: 1.2124 
Train step: 1770 acc:0.86719 total_loss: 0.61405  loss:0.23057,stance loss: 0.061796 
Train step: 1780 acc:0.86364 total_loss: 0.62622  loss:0.59232,stance loss: 0.57322 
Train step: 1790 acc:0.8602 total_loss: 0.62945  loss:0.94373,stance loss: 0.88012 
Train step: 1800 acc:0.86119 total_loss: 0.61444  loss:0.60995,stance loss: 0.47429 
Train step: 1810 acc:0.85742 total_loss: 0.6194  loss:0.61422,stance loss: 0.40966 
Train step: 1820 acc:0.86203 total_loss: 0.62169  loss:0.49851,stance loss: 0.41659 
Train step: 1830 acc:0.86153 total_loss: 0.63276  loss:0.67237,stance loss: 0.56324 
Train step: 1840 acc:0.86012 total_loss: 0.62816  loss:0.39846,stance loss: 0.33904 
Train step: 1850 acc:0.86029 total_loss: 0.62903  loss:0.6568,stance loss: 0.50272 
Train step: 1860 acc:0.8583 total_loss: 0.62748  loss:0.67499,stance loss: 0.47271 
Train step: 1870 acc:0.85817 total_loss: 0.62762  loss:1.3208,stance loss: 1.1902 
Train step: 1880 acc:0.8558 total_loss: 0.63691  loss:1.3555,stance loss: 1.186 
Train step: 1890 acc:0.85582 total_loss: 0.63706  loss:0.7475,stance loss: 0.6941 
Train step: 1900 acc:0.85316 total_loss: 0.65627  loss:1.2027,stance loss: 0.8865 
Train step: 1910 acc:0.853 total_loss: 0.65141  loss:0.76811,stance loss: 0.65605 
Train step: 1920 acc:0.85407 total_loss: 0.65613  loss:0.97462,stance loss: 1.3496 
Better F1! Saving model!
Saving model of best f1: 0.4316083885403414
              precision    recall  f1-score   support

           0   0.608333  0.571429  0.589304       511
           1   0.462094  0.752941  0.572707       170
           2   0.328125  0.235075  0.273913       268

    accuracy                       0.508957       949
   macro avg   0.466184  0.519815  0.478641       949
weighted avg   0.503005  0.508957  0.497264       949

Test Acc: 0.5089567966280295 F1_ma:0.4316083885403414
Train step: 1930 acc:0.85475 total_loss: 0.65582  loss:0.30494,stance loss: 0.18921 
Train step: 1940 acc:0.85454 total_loss: 0.65412  loss:1.1153,stance loss: 1.4509 
Train step: 1950 acc:0.85461 total_loss: 0.65373  loss:0.50409,stance loss: 0.33886 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.8125 total_loss: 0.86683  loss:0.86683,stance loss: 0.78412 
Train step: 1970 acc:0.83523 total_loss: 0.68459  loss:0.71134,stance loss: 0.60695 
Train step: 1980 acc:0.88393 total_loss: 0.62114  loss:0.81106,stance loss: 1.121 
Train step: 1990 acc:0.87298 total_loss: 0.61069  loss:0.68743,stance loss: 0.5394 
Train step: 2000 acc:0.8811 total_loss: 0.59172  loss:0.50217,stance loss: 0.31214 
Train step: 2010 acc:0.87623 total_loss: 0.63246  loss:1.1529,stance loss: 1.4243 
Train step: 2020 acc:0.87705 total_loss: 0.61  loss:0.24931,stance loss: 0.16393 
Train step: 2030 acc:0.88116 total_loss: 0.59434  loss:0.24901,stance loss: 0.2006 
Train step: 2040 acc:0.8804 total_loss: 0.60145  loss:0.51161,stance loss: 0.4742 
Train step: 2050 acc:0.88049 total_loss: 0.59512  loss:0.51581,stance loss: 0.42354 
Train step: 2060 acc:0.88304 total_loss: 0.59953  loss:0.26352,stance loss: 0.18106 
Train step: 2070 acc:0.88232 total_loss: 0.59944  loss:0.61014,stance loss: 0.38119 
Train step: 2080 acc:0.88017 total_loss: 0.59676  loss:0.792,stance loss: 0.60585 
Train step: 2090 acc:0.87929 total_loss: 0.59909  loss:0.71949,stance loss: 0.50145 
Train step: 2100 acc:0.8781 total_loss: 0.60997  loss:0.60228,stance loss: 0.56517 
Train step: 2110 acc:0.88038 total_loss: 0.59726  loss:0.19637,stance loss: 0.12164 
Train step: 2120 acc:0.88199 total_loss: 0.59138  loss:0.37635,stance loss: 0.29493 
Train step: 2130 acc:0.87865 total_loss: 0.59271  loss:1.0512,stance loss: 0.95217 
Train step: 2140 acc:0.87811 total_loss: 0.60546  loss:1.1326,stance loss: 1.5014 
Train step: 2150 acc:0.87795 total_loss: 0.60046  loss:0.24589,stance loss: 0.17267 
Train step: 2160 acc:0.87749 total_loss: 0.59798  loss:0.12212,stance loss: 0.057662 
Train step: 2170 acc:0.87589 total_loss: 0.59525  loss:0.28871,stance loss: 0.18894 
Train step: 2180 acc:0.87359 total_loss: 0.59645  loss:0.62292,stance loss: 0.42299 
Train step: 2190 acc:0.87473 total_loss: 0.59221  loss:0.65154,stance loss: 0.53404 
Train step: 2200 acc:0.87578 total_loss: 0.58785  loss:0.37371,stance loss: 0.3709 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.86458 total_loss: 0.43878  loss:0.55486,stance loss: 0.52716 
Train step: 2220 acc:0.87109 total_loss: 0.52457  loss:0.27105,stance loss: 0.13723 
Train step: 2230 acc:0.85337 total_loss: 0.56394  loss:0.66707,stance loss: 0.48816 
Train step: 2240 acc:0.86806 total_loss: 0.55469  loss:0.33065,stance loss: 0.28005 
Train step: 2250 acc:0.86413 total_loss: 0.55668  loss:0.47412,stance loss: 0.37785 
Train step: 2260 acc:0.87946 total_loss: 0.51204  loss:0.42048,stance loss: 0.39487 
Train step: 2270 acc:0.89015 total_loss: 0.49604  loss:0.63438,stance loss: 1.0196 
Train step: 2280 acc:0.88734 total_loss: 0.50675  loss:0.52426,stance loss: 0.41801 
Train step: 2290 acc:0.88517 total_loss: 0.5205  loss:0.65203,stance loss: 0.4898 
Train step: 2300 acc:0.88802 total_loss: 0.51286  loss:0.31342,stance loss: 0.26136 
Train step: 2310 acc:0.89269 total_loss: 0.50785  loss:0.59576,stance loss: 0.40684 
Train step: 2320 acc:0.89224 total_loss: 0.5089  loss:0.51058,stance loss: 0.39139 
Train step: 2330 acc:0.88938 total_loss: 0.51661  loss:0.63394,stance loss: 0.49734 
Train step: 2340 acc:0.892 total_loss: 0.50973  loss:0.78025,stance loss: 0.76845 
Train step: 2350 acc:0.89384 total_loss: 0.50238  loss:0.2897,stance loss: 0.16883 
Train step: 2360 acc:0.89623 total_loss: 0.49454  loss:0.29389,stance loss: 0.26791 
Train step: 2370 acc:0.89797 total_loss: 0.49234  loss:0.32776,stance loss: 0.25936 
Train step: 2380 acc:0.89737 total_loss: 0.49789  loss:0.47237,stance loss: 0.34426 
Train step: 2390 acc:0.89785 total_loss: 0.48977  loss:0.17366,stance loss: 0.0039652 
Train step: 2400 acc:0.89828 total_loss: 0.49468  loss:0.67723,stance loss: 1.0176 
Train step: 2410 acc:0.90018 total_loss: 0.49009  loss:0.10756,stance loss: 0.078434 
Train step: 2420 acc:0.89931 total_loss: 0.48837  loss:0.66535,stance loss: 0.65087 
Train step: 2430 acc:0.89961 total_loss: 0.48652  loss:0.43019,stance loss: 0.36406 
Train step: 2440 acc:0.90016 total_loss: 0.4894  loss:0.79354,stance loss: 1.1614 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.8125 total_loss: 0.46342  loss:0.46342,stance loss: 0.42094 
Train step: 2460 acc:0.93182 total_loss: 0.42804  loss:0.18217,stance loss: 0.043218 
Train step: 2470 acc:0.9375 total_loss: 0.39533  loss:0.2732,stance loss: 0.20046 
Train step: 2480 acc:0.94153 total_loss: 0.37153  loss:0.41823,stance loss: 0.47503 
Train step: 2490 acc:0.93598 total_loss: 0.36892  loss:0.70533,stance loss: 0.48559 
Train step: 2500 acc:0.93505 total_loss: 0.37783  loss:0.13991,stance loss: 0.05663 
Train step: 2510 acc:0.93033 total_loss: 0.37427  loss:0.33807,stance loss: 0.23876 
Train step: 2520 acc:0.9243 total_loss: 0.39371  loss:0.53377,stance loss: 0.46912 
Train step: 2530 acc:0.9213 total_loss: 0.39383  loss:0.53327,stance loss: 0.48176 
Train step: 2540 acc:0.91827 total_loss: 0.40617  loss:0.092397,stance loss: 0.049406 
Train step: 2550 acc:0.91708 total_loss: 0.40751  loss:0.34282,stance loss: 0.25611 
Train step: 2560 acc:0.91498 total_loss: 0.41489  loss:0.39808,stance loss: 0.28287 
Train step: 2570 acc:0.91581 total_loss: 0.4114  loss:0.17047,stance loss: 0.12967 
Train step: 2580 acc:0.91842 total_loss: 0.39952  loss:0.18636,stance loss: 0.13764 
Train step: 2590 acc:0.91977 total_loss: 0.40054  loss:0.33203,stance loss: 0.31917 
Train step: 2600 acc:0.92136 total_loss: 0.39863  loss:0.96746,stance loss: 1.2854 
Train step: 2610 acc:0.9212 total_loss: 0.39964  loss:0.090682,stance loss: 0.051394 
Train step: 2620 acc:0.92361 total_loss: 0.39531  loss:1.1172,stance loss: 1.5411 
Train step: 2630 acc:0.92231 total_loss: 0.39651  loss:0.30967,stance loss: 0.33228 
Train step: 2640 acc:0.9231 total_loss: 0.39387  loss:0.3332,stance loss: 0.29789 
Train step: 2650 acc:0.92226 total_loss: 0.39081  loss:0.49547,stance loss: 0.57638 
Train step: 2660 acc:0.92091 total_loss: 0.39223  loss:0.62868,stance loss: 0.57551 
Train step: 2670 acc:0.91912 total_loss: 0.39497  loss:0.37929,stance loss: 0.29726 
Train step: 2680 acc:0.91991 total_loss: 0.39423  loss:0.078955,stance loss: 0.015415 
Train step: 2690 acc:0.91909 total_loss: 0.39988  loss:0.20239,stance loss: 0.12348 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.94792 total_loss: 0.40307  loss:0.17069,stance loss: 0.13092 
Train step: 2710 acc:0.9375 total_loss: 0.34288  loss:0.32999,stance loss: 0.21708 
Train step: 2720 acc:0.9375 total_loss: 0.3303  loss:0.39398,stance loss: 0.36061 
Train step: 2730 acc:0.92882 total_loss: 0.36794  loss:0.69662,stance loss: 0.84463 
Train step: 2740 acc:0.93207 total_loss: 0.36158  loss:0.29377,stance loss: 0.22306 
Train step: 2750 acc:0.93415 total_loss: 0.35063  loss:0.27105,stance loss: 0.21778 
Train step: 2760 acc:0.93466 total_loss: 0.34182  loss:0.2732,stance loss: 0.052859 
Train step: 2770 acc:0.93832 total_loss: 0.32743  loss:0.23188,stance loss: 0.13709 
Train step: 2780 acc:0.93605 total_loss: 0.33765  loss:0.20598,stance loss: 0.17899 
Train step: 2790 acc:0.9349 total_loss: 0.3397  loss:0.1079,stance loss: 0.056691 
Train step: 2800 acc:0.93101 total_loss: 0.34548  loss:0.2477,stance loss: 0.28072 
Train step: 2810 acc:0.93103 total_loss: 0.34593  loss:0.35575,stance loss: 0.36903 
Train step: 2820 acc:0.92758 total_loss: 0.36109  loss:0.40252,stance loss: 0.2883 
Train step: 2830 acc:0.92647 total_loss: 0.36015  loss:0.24515,stance loss: 0.22213 
Train step: 2840 acc:0.9268 total_loss: 0.35736  loss:0.30356,stance loss: 0.12061 
Train step: 2850 acc:0.92588 total_loss: 0.36455  loss:0.19557,stance loss: 0.16799 
Train step: 2860 acc:0.9262 total_loss: 0.36881  loss:0.60222,stance loss: 0.49061 
Train step: 2870 acc:0.92827 total_loss: 0.3691  loss:0.25656,stance loss: 0.17042 
Train step: 2880 acc:0.92876 total_loss: 0.36827  loss:0.70617,stance loss: 1.1451 
Train step: 2890 acc:0.92921 total_loss: 0.36676  loss:0.2295,stance loss: 0.20117 
Train step: 2900 acc:0.92961 total_loss: 0.36757  loss:0.26091,stance loss: 0.23724 
Train step: 2910 acc:0.9294 total_loss: 0.36483  loss:0.1833,stance loss: 0.19267 
Train step: 2920 acc:0.93003 total_loss: 0.36134  loss:0.053666,stance loss: 0.013201 
Train step: 2930 acc:0.92982 total_loss: 0.36261  loss:0.59196,stance loss: 0.58526 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.31879  loss:0.31879,stance loss: 0.16314 
Train step: 2950 acc:0.96023 total_loss: 0.31573  loss:0.78415,stance loss: 1.0635 
Train step: 2960 acc:0.94643 total_loss: 0.34724  loss:0.02705,stance loss: 0.0026207 
Train step: 2970 acc:0.95161 total_loss: 0.31913  loss:0.25452,stance loss: 0.26458 
Train step: 2980 acc:0.94817 total_loss: 0.31931  loss:0.051174,stance loss: 0.0051174 
Train step: 2990 acc:0.95098 total_loss: 0.31004  loss:0.11307,stance loss: 0.041876 
Train step: 3000 acc:0.95184 total_loss: 0.32401  loss:0.062412,stance loss: 0.018307 
Train step: 3010 acc:0.95511 total_loss: 0.30817  loss:0.027548,stance loss: 0.0021341 
Train step: 3020 acc:0.95448 total_loss: 0.30151  loss:0.037174,stance loss: 0.0050786 
Train step: 3030 acc:0.95536 total_loss: 0.29041  loss:0.41751,stance loss: 0.23502 
Train step: 3040 acc:0.9573 total_loss: 0.28023  loss:0.30605,stance loss: 0.31346 
Train step: 3050 acc:0.95833 total_loss: 0.27563  loss:0.11079,stance loss: 0.078567 
Train step: 3060 acc:0.95764 total_loss: 0.27159  loss:0.12399,stance loss: 0.051664 
Train step: 3070 acc:0.95992 total_loss: 0.2655  loss:0.044695,stance loss: 0.010575 
Train step: 3080 acc:0.95789 total_loss: 0.27329  loss:0.67992,stance loss: 0.49305 
Train step: 3090 acc:0.95613 total_loss: 0.2768  loss:0.28517,stance loss: 0.19649 
Train step: 3100 acc:0.95497 total_loss: 0.28415  loss:1.3601,stance loss: 1.8308 
Train step: 3110 acc:0.95431 total_loss: 0.28796  loss:0.15521,stance loss: 0.076275 
Train step: 3120 acc:0.95511 total_loss: 0.2928  loss:0.55448,stance loss: 1.0159 
Train step: 3130 acc:0.95484 total_loss: 0.29506  loss:0.22834,stance loss: 0.22028 
Train step: 3140 acc:0.95522 total_loss: 0.29406  loss:0.31606,stance loss: 0.1767 
Train step: 3150 acc:0.95468 total_loss: 0.28944  loss:0.56387,stance loss: 0.56858 
Train step: 3160 acc:0.95447 total_loss: 0.28819  loss:0.54775,stance loss: 0.53168 
Train step: 3170 acc:0.95319 total_loss: 0.28877  loss:0.11979,stance loss: 0.038116 
Train step: 3180 acc:0.95306 total_loss: 0.29012  loss:0.72604,stance loss: 0.51287 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.94792 total_loss: 0.18834  loss:0.273,stance loss: 0.211 
Train step: 3200 acc:0.96484 total_loss: 0.20048  loss:0.1395,stance loss: 0.16773 
Train step: 3210 acc:0.96394 total_loss: 0.19229  loss:0.36443,stance loss: 0.32256 
Train step: 3220 acc:0.96007 total_loss: 0.19326  loss:0.26103,stance loss: 0.17152 
Train step: 3230 acc:0.95924 total_loss: 0.22202  loss:0.034691,stance loss: 0.006234 
Train step: 3240 acc:0.96094 total_loss: 0.23116  loss:0.32655,stance loss: 0.25246 
Train step: 3250 acc:0.96402 total_loss: 0.21981  loss:0.045106,stance loss: 0.0029886 
Train step: 3260 acc:0.96053 total_loss: 0.23484  loss:0.13341,stance loss: 0.053534 
Train step: 3270 acc:0.96003 total_loss: 0.23023  loss:0.14936,stance loss: 0.13318 
Train step: 3280 acc:0.96224 total_loss: 0.22456  loss:0.068628,stance loss: 0.023646 
Train step: 3290 acc:0.96285 total_loss: 0.22632  loss:0.051253,stance loss: 0.012327 
Train step: 3300 acc:0.96498 total_loss: 0.22519  loss:0.58775,stance loss: 1.057 
Train step: 3310 acc:0.96379 total_loss: 0.22581  loss:0.76018,stance loss: 1.0756 
Train step: 3320 acc:0.96369 total_loss: 0.22709  loss:0.60036,stance loss: 0.57911 
Train step: 3330 acc:0.96575 total_loss: 0.21681  loss:0.23671,stance loss: 0.201 
Train step: 3340 acc:0.96434 total_loss: 0.22411  loss:0.1435,stance loss: 0.074048 
Train step: 3350 acc:0.96461 total_loss: 0.22593  loss:0.087814,stance loss: 0.046788 
Train step: 3360 acc:0.96378 total_loss: 0.22569  loss:0.03985,stance loss: 0.0088471 
Train step: 3370 acc:0.96337 total_loss: 0.22907  loss:0.089451,stance loss: 0.059401 
Train step: 3380 acc:0.96365 total_loss: 0.23128  loss:0.42979,stance loss: 0.44399 
Train step: 3390 acc:0.96329 total_loss: 0.23373  loss:0.024978,stance loss: 0.005519 
Train step: 3400 acc:0.96181 total_loss: 0.2401  loss:0.55347,stance loss: 0.45632 
Train step: 3410 acc:0.96128 total_loss: 0.2386  loss:0.10013,stance loss: 0.082227 
Train step: 3420 acc:0.96213 total_loss: 0.23491  loss:0.10702,stance loss: 0.088293 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.9375 total_loss: 0.24121  loss:0.24121,stance loss: 0.27542 
Train step: 3440 acc:0.97159 total_loss: 0.16069  loss:0.071442,stance loss: 0.032945 
Train step: 3450 acc:0.96429 total_loss: 0.15886  loss:0.095242,stance loss: 0.10283 
Train step: 3460 acc:0.96573 total_loss: 0.21008  loss:0.056272,stance loss: 0.013205 
Train step: 3470 acc:0.97256 total_loss: 0.18826  loss:0.086609,stance loss: 0.0867 
Train step: 3480 acc:0.97181 total_loss: 0.18377  loss:0.14755,stance loss: 0.15892 
Train step: 3490 acc:0.97029 total_loss: 0.19273  loss:0.077228,stance loss: 0.042436 
Train step: 3500 acc:0.96831 total_loss: 0.18903  loss:0.45462,stance loss: 0.46928 
Train step: 3510 acc:0.96836 total_loss: 0.19378  loss:0.38466,stance loss: 0.25706 
Train step: 3520 acc:0.97047 total_loss: 0.19378  loss:0.069466,stance loss: 0.05092 
Train step: 3530 acc:0.97092 total_loss: 0.21011  loss:0.065196,stance loss: 0.01694 
Train step: 3540 acc:0.97128 total_loss: 0.20729  loss:0.017367,stance loss: 0.00078299 
Train step: 3550 acc:0.97211 total_loss: 0.20251  loss:0.10858,stance loss: 0.070091 
Train step: 3560 acc:0.9709 total_loss: 0.2024  loss:0.57908,stance loss: 0.3834 
Train step: 3570 acc:0.97074 total_loss: 0.20636  loss:0.031678,stance loss: 0.007974 
Train step: 3580 acc:0.96937 total_loss: 0.20817  loss:0.37995,stance loss: 0.40705 
Train step: 3590 acc:0.96972 total_loss: 0.20635  loss:0.58889,stance loss: 1.0728 
Train step: 3600 acc:0.97003 total_loss: 0.20722  loss:0.55351,stance loss: 1.0212 
Train step: 3610 acc:0.96996 total_loss: 0.20266  loss:0.1304,stance loss: 0.10986 
Train step: 3620 acc:0.9699 total_loss: 0.19986  loss:0.17629,stance loss: 0.20146 
Train step: 3630 acc:0.97077 total_loss: 0.19426  loss:0.028836,stance loss: 0.003512 
Train step: 3640 acc:0.97097 total_loss: 0.19429  loss:0.023808,stance loss: 0.012215 
Train step: 3650 acc:0.972 total_loss: 0.19142  loss:0.19993,stance loss: 0.1833 
Train step: 3660 acc:0.97186 total_loss: 0.18975  loss:0.059355,stance loss: 0.030998 
Train step: 3670 acc:0.97225 total_loss: 0.19173  loss:0.012628,stance loss: 0.00061308 
Training finished.


Reload the best model with best f1 0.4316083885403414 from path test_outputs/bert-cross-topic/fm/2023-08-14 17-38-50/state_dict


              precision    recall  f1-score   support

           0   0.608333  0.571429  0.589304       511
           1   0.462094  0.752941  0.572707       170
           2   0.328125  0.235075  0.273913       268

    accuracy                       0.508957       949
   macro avg   0.466184  0.519815  0.478641       949
weighted avg   0.503005  0.508957  0.497264       949

Test Acc: 0.5089567966280295 F1_ma:0.4316083885403414
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4316083885403414
acc: 0.5089567966280295, f1 :0.4786412374012417
classification report: 
              precision    recall  f1-score   support

         Con     0.6083    0.5714    0.5893       511
        None     0.4621    0.7529    0.5727       170
         Pro     0.3281    0.2351    0.2739       268

    accuracy                         0.5090       949
   macro avg     0.4662    0.5198    0.4786       949
weighted avg     0.5030    0.5090    0.4973       949

run_semeval with seed: 31553
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 18-17-36', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31553, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 18-17-36
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.7481  loss:1.7481,stance loss: 1.3063 
Train step: 10 acc:0.35795 total_loss: 1.7012  loss:1.6806,stance loss: 1.2302 
Better F1! Saving model!
Saving model of best f1: 0.23620401337792643
              precision    recall  f1-score   support

           0   0.367816  0.062622  0.107023       511
           1   0.286070  0.676471  0.402098       170
           2   0.289130  0.496269  0.365385       268

    accuracy                       0.295047       949
   macro avg   0.314339  0.411787  0.291502       949
weighted avg   0.330951  0.295047  0.232844       949

Test Acc: 0.2950474183350896 F1_ma:0.23620401337792643
Train step: 20 acc:0.375 total_loss: 1.7017  loss:1.7601,stance loss: 1.3228 
Better F1! Saving model!
Saving model of best f1: 0.3528915428052184
              precision    recall  f1-score   support

           0   0.480405  0.743640  0.583717       511
           1   0.000000  0.000000  0.000000       170
           2   0.164557  0.097015  0.122066       268

    accuracy                       0.427819       949
   macro avg   0.214987  0.280218  0.235261       949
weighted avg   0.305151  0.427819  0.348781       949

Test Acc: 0.42781875658587987 F1_ma:0.3528915428052184
Train step: 30 acc:0.41331 total_loss: 1.6763  loss:1.5166,stance loss: 1.0373 
Train step: 40 acc:0.43445 total_loss: 1.6453  loss:1.6157,stance loss: 1.1804 
Train step: 50 acc:0.43873 total_loss: 1.6325  loss:1.3713,stance loss: 0.88746 
Train step: 60 acc:0.44672 total_loss: 1.6246  loss:1.7566,stance loss: 1.2649 
Train step: 70 acc:0.44982 total_loss: 1.6073  loss:1.3851,stance loss: 1.0206 
Better F1! Saving model!
Saving model of best f1: 0.3629967623723628
              precision    recall  f1-score   support

           0   0.525656  0.902153  0.664265       511
           1   0.375000  0.035294  0.064516       170
           2   0.178571  0.037313  0.061728       268

    accuracy                       0.502634       949
   macro avg   0.359742  0.324920  0.263503       949
weighted avg   0.400650  0.502634  0.386671       949

Test Acc: 0.5026343519494204 F1_ma:0.3629967623723628
Train step: 80 acc:0.45988 total_loss: 1.5908  loss:1.4093,stance loss: 0.98945 
Train step: 90 acc:0.46154 total_loss: 1.592  loss:1.6169,stance loss: 1.2081 
Train step: 100 acc:0.46658 total_loss: 1.5863  loss:1.6095,stance loss: 1.2138 
Train step: 110 acc:0.47297 total_loss: 1.5811  loss:1.6415,stance loss: 1.5511 
Train step: 120 acc:0.47882 total_loss: 1.5761  loss:1.1274,stance loss: 0.59995 
Train step: 130 acc:0.48187 total_loss: 1.5864  loss:1.6562,stance loss: 1.6088 
Train step: 140 acc:0.49069 total_loss: 1.5725  loss:1.2106,stance loss: 0.87007 
Train step: 150 acc:0.49545 total_loss: 1.5678  loss:1.4015,stance loss: 1.0229 
Train step: 160 acc:0.49534 total_loss: 1.5617  loss:1.3681,stance loss: 0.96253 
Train step: 170 acc:0.50402 total_loss: 1.5515  loss:1.3325,stance loss: 0.94327 
Train step: 180 acc:0.50691 total_loss: 1.5467  loss:1.3105,stance loss: 0.87769 
Train step: 190 acc:0.50785 total_loss: 1.5428  loss:1.646,stance loss: 1.1938 
Train step: 200 acc:0.51213 total_loss: 1.5327  loss:1.055,stance loss: 0.59654 
Train step: 210 acc:0.51244 total_loss: 1.5324  loss:1.0346,stance loss: 0.56813 
Train step: 220 acc:0.51697 total_loss: 1.5234  loss:1.3134,stance loss: 0.87841 
Train step: 230 acc:0.52165 total_loss: 1.5174  loss:1.4178,stance loss: 1.1122 
Train step: 240 acc:0.52516 total_loss: 1.511  loss:1.3289,stance loss: 1.02 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.67708 total_loss: 1.2389  loss:1.2261,stance loss: 0.79345 
Train step: 260 acc:0.58984 total_loss: 1.3642  loss:1.4278,stance loss: 1.1458 
Train step: 270 acc:0.59375 total_loss: 1.3442  loss:1.5271,stance loss: 1.2554 
Train step: 280 acc:0.61111 total_loss: 1.3102  loss:0.94698,stance loss: 0.59842 
Train step: 290 acc:0.62364 total_loss: 1.3037  loss:1.2271,stance loss: 0.89275 
Train step: 300 acc:0.61719 total_loss: 1.3125  loss:1.4581,stance loss: 1.0985 
Train step: 310 acc:0.62121 total_loss: 1.3123  loss:1.5932,stance loss: 1.3241 
Train step: 320 acc:0.625 total_loss: 1.3173  loss:1.5058,stance loss: 1.2309 
Train step: 330 acc:0.61047 total_loss: 1.3296  loss:1.6405,stance loss: 1.1579 
Train step: 340 acc:0.62044 total_loss: 1.3183  loss:1.1532,stance loss: 0.77799 
Train step: 350 acc:0.625 total_loss: 1.3282  loss:1.4253,stance loss: 1.2814 
Train step: 360 acc:0.62985 total_loss: 1.3177  loss:1.5108,stance loss: 0.9491 
Train step: 370 acc:0.62996 total_loss: 1.3093  loss:0.87713,stance loss: 0.48094 
Train step: 380 acc:0.63741 total_loss: 1.3037  loss:1.2968,stance loss: 1.0488 
Train step: 390 acc:0.63527 total_loss: 1.3  loss:1.0875,stance loss: 0.80878 
Train step: 400 acc:0.63381 total_loss: 1.2977  loss:1.0514,stance loss: 0.81093 
Train step: 410 acc:0.63705 total_loss: 1.2956  loss:1.6182,stance loss: 1.5925 
Train step: 420 acc:0.63991 total_loss: 1.2989  loss:1.0801,stance loss: 0.77223 
Train step: 430 acc:0.64415 total_loss: 1.2917  loss:1.3283,stance loss: 0.92116 
Train step: 440 acc:0.64636 total_loss: 1.2877  loss:1.0135,stance loss: 0.70629 
Train step: 450 acc:0.64715 total_loss: 1.2844  loss:1.0294,stance loss: 0.64931 
Train step: 460 acc:0.6522 total_loss: 1.2797  loss:0.76792,stance loss: 0.54348 
Train step: 470 acc:0.65404 total_loss: 1.2707  loss:0.86818,stance loss: 0.52773 
Train step: 480 acc:0.65466 total_loss: 1.2717  loss:1.4616,stance loss: 1.589 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.75 total_loss: 1.0051  loss:1.0051,stance loss: 0.57392 
Train step: 500 acc:0.72727 total_loss: 1.1586  loss:1.5504,stance loss: 1.2504 
Train step: 510 acc:0.73512 total_loss: 1.1596  loss:1.0542,stance loss: 0.77986 
Train step: 520 acc:0.70968 total_loss: 1.1965  loss:1.6529,stance loss: 1.8312 
Train step: 530 acc:0.70579 total_loss: 1.1948  loss:1.2097,stance loss: 1.1114 
Train step: 540 acc:0.6973 total_loss: 1.1914  loss:1.0688,stance loss: 0.72772 
Train step: 550 acc:0.69877 total_loss: 1.1705  loss:0.83215,stance loss: 0.58091 
Train step: 560 acc:0.68838 total_loss: 1.1834  loss:1.0718,stance loss: 0.89198 
Train step: 570 acc:0.69136 total_loss: 1.1827  loss:1.1106,stance loss: 0.791 
Train step: 580 acc:0.68956 total_loss: 1.1823  loss:1.1962,stance loss: 0.97827 
Train step: 590 acc:0.68688 total_loss: 1.1832  loss:1.0572,stance loss: 0.73343 
Train step: 600 acc:0.69032 total_loss: 1.1761  loss:1.2124,stance loss: 0.857 
Train step: 610 acc:0.69008 total_loss: 1.1796  loss:0.92782,stance loss: 0.65805 
Train step: 620 acc:0.69179 total_loss: 1.1702  loss:0.70108,stance loss: 0.48194 
Train step: 630 acc:0.69371 total_loss: 1.1691  loss:1.0906,stance loss: 0.79888 
Train step: 640 acc:0.69454 total_loss: 1.1669  loss:1.1578,stance loss: 0.86 
Train step: 650 acc:0.69099 total_loss: 1.1657  loss:1.2096,stance loss: 1.0328 
Better F1! Saving model!
Saving model of best f1: 0.3650517068110351
              precision    recall  f1-score   support

           0   0.575910  0.898239  0.701835       511
           1   0.591241  0.476471  0.527687       170
           2   0.266667  0.014925  0.028269       268

    accuracy                       0.573235       949
   macro avg   0.477939  0.463212  0.419264       949
weighted avg   0.491325  0.573235  0.480422       949

Test Acc: 0.5732349841938883 F1_ma:0.3650517068110351
Train step: 660 acc:0.69152 total_loss: 1.1638  loss:1.63,stance loss: 1.3001 
Train step: 670 acc:0.68992 total_loss: 1.1653  loss:1.1113,stance loss: 0.92624 
Train step: 680 acc:0.69175 total_loss: 1.1662  loss:1.0024,stance loss: 0.84393 
Train step: 690 acc:0.69341 total_loss: 1.1659  loss:1.3133,stance loss: 1.0804 
Train step: 700 acc:0.69461 total_loss: 1.1736  loss:1.4582,stance loss: 1.2373 
Train step: 710 acc:0.694 total_loss: 1.1737  loss:1.1074,stance loss: 0.76286 
Train step: 720 acc:0.69426 total_loss: 1.1756  loss:1.3749,stance loss: 1.588 
Train step: 730 acc:0.69243 total_loss: 1.1803  loss:1.1309,stance loss: 0.94221 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.69792 total_loss: 1.2073  loss:1.0799,stance loss: 0.916 
Train step: 750 acc:0.73438 total_loss: 1.117  loss:1.6267,stance loss: 1.6727 
Train step: 760 acc:0.71394 total_loss: 1.1225  loss:1.2241,stance loss: 1.0012 
Train step: 770 acc:0.71354 total_loss: 1.1432  loss:1.1337,stance loss: 0.90649 
Train step: 780 acc:0.71739 total_loss: 1.1337  loss:1.1948,stance loss: 0.79424 
Train step: 790 acc:0.71763 total_loss: 1.1217  loss:1.2185,stance loss: 1.1018 
Train step: 800 acc:0.7197 total_loss: 1.1312  loss:1.4737,stance loss: 1.1939 
Train step: 810 acc:0.72451 total_loss: 1.1236  loss:0.89853,stance loss: 0.66391 
Train step: 820 acc:0.72311 total_loss: 1.1256  loss:1.1722,stance loss: 0.93063 
Train step: 830 acc:0.7194 total_loss: 1.1333  loss:1.3765,stance loss: 1.364 
Train step: 840 acc:0.72111 total_loss: 1.1238  loss:1.0456,stance loss: 0.83907 
Train step: 850 acc:0.72468 total_loss: 1.1132  loss:0.66645,stance loss: 0.34772 
Train step: 860 acc:0.72421 total_loss: 1.1079  loss:0.8687,stance loss: 0.70226 
Train step: 870 acc:0.72518 total_loss: 1.1019  loss:1.4603,stance loss: 1.11 
Train step: 880 acc:0.72817 total_loss: 1.0965  loss:0.60889,stance loss: 0.39744 
Train step: 890 acc:0.72796 total_loss: 1.0936  loss:0.88542,stance loss: 0.70946 
Train step: 900 acc:0.72553 total_loss: 1.0898  loss:0.82768,stance loss: 0.66498 
Train step: 910 acc:0.7223 total_loss: 1.0903  loss:0.96928,stance loss: 0.76099 
Better F1! Saving model!
Saving model of best f1: 0.38365626165899763
              precision    recall  f1-score   support

           0   0.609195  0.518591  0.560254       511
           1   0.425770  0.894118  0.576850       170
           2   0.280255  0.164179  0.207059       268

    accuracy                       0.485774       949
   macro avg   0.438407  0.525629  0.448054       949
weighted avg   0.483444  0.485774  0.463484       949

Test Acc: 0.4857744994731296 F1_ma:0.38365626165899763
Train step: 920 acc:0.72043 total_loss: 1.0914  loss:1.2807,stance loss: 1.2241 
Train step: 930 acc:0.71684 total_loss: 1.095  loss:0.85958,stance loss: 0.64638 
Train step: 940 acc:0.71602 total_loss: 1.0948  loss:1.671,stance loss: 1.2077 
Train step: 950 acc:0.71209 total_loss: 1.0958  loss:1.1836,stance loss: 0.89468 
Train step: 960 acc:0.71433 total_loss: 1.0892  loss:0.88064,stance loss: 0.69388 
Train step: 970 acc:0.71345 total_loss: 1.0902  loss:1.3924,stance loss: 1.1174 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.9375 total_loss: 0.61476  loss:0.61476,stance loss: 0.43716 
Train step: 990 acc:0.77841 total_loss: 0.88202  loss:1.1837,stance loss: 0.92959 
Train step: 1000 acc:0.80655 total_loss: 0.82516  loss:0.58537,stance loss: 0.39367 
Train step: 1010 acc:0.76815 total_loss: 0.9408  loss:0.83638,stance loss: 0.66875 
Train step: 1020 acc:0.7561 total_loss: 0.97582  loss:1.271,stance loss: 1.0176 
Train step: 1030 acc:0.76838 total_loss: 0.97594  loss:0.82531,stance loss: 0.61245 
Train step: 1040 acc:0.76025 total_loss: 0.98246  loss:0.86917,stance loss: 0.85484 
Train step: 1050 acc:0.75176 total_loss: 0.99522  loss:1.8392,stance loss: 1.8646 
Train step: 1060 acc:0.75694 total_loss: 0.99018  loss:0.78952,stance loss: 0.65971 
Train step: 1070 acc:0.75137 total_loss: 1.0023  loss:0.95044,stance loss: 0.74592 
Train step: 1080 acc:0.75186 total_loss: 1.0039  loss:0.85718,stance loss: 0.62457 
Train step: 1090 acc:0.7545 total_loss: 0.9946  loss:0.85784,stance loss: 0.50807 
Train step: 1100 acc:0.75465 total_loss: 0.99572  loss:1.0763,stance loss: 0.79572 
Train step: 1110 acc:0.75573 total_loss: 0.99393  loss:1.3503,stance loss: 1.4654 
Train step: 1120 acc:0.75621 total_loss: 0.9911  loss:0.95042,stance loss: 0.6397 
Better F1! Saving model!
Saving model of best f1: 0.40486243614205697
              precision    recall  f1-score   support

           0   0.593750  0.632094  0.612322       511
           1   0.444444  0.752941  0.558952       170
           2   0.324786  0.141791  0.197403       268

    accuracy                       0.515279       949
   macro avg   0.454327  0.508942  0.456226       949
weighted avg   0.491048  0.515279  0.485587       949

Test Acc: 0.5152792413066386 F1_ma:0.40486243614205697
Train step: 1130 acc:0.75414 total_loss: 0.99639  loss:0.62452,stance loss: 0.51767 
Train step: 1140 acc:0.75311 total_loss: 1.0009  loss:1.0519,stance loss: 0.80139 
Train step: 1150 acc:0.75329 total_loss: 0.99447  loss:0.95959,stance loss: 0.7111 
Train step: 1160 acc:0.74896 total_loss: 0.99332  loss:1.0545,stance loss: 0.80659 
Train step: 1170 acc:0.74967 total_loss: 0.98847  loss:1.0289,stance loss: 0.91241 
Train step: 1180 acc:0.75 total_loss: 0.98575  loss:0.52816,stance loss: 0.33811 
Train step: 1190 acc:0.75059 total_loss: 0.98452  loss:1.1117,stance loss: 0.92925 
Train step: 1200 acc:0.75198 total_loss: 0.97999  loss:0.80277,stance loss: 0.66084 
Train step: 1210 acc:0.75135 total_loss: 0.97974  loss:0.56535,stance loss: 0.26513 
Train step: 1220 acc:0.74844 total_loss: 0.98309  loss:0.85461,stance loss: 0.61718 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.70833 total_loss: 0.96464  loss:1.5158,stance loss: 1.735 
Train step: 1240 acc:0.75 total_loss: 0.91071  loss:1.2112,stance loss: 1.4866 
Train step: 1250 acc:0.74279 total_loss: 0.96459  loss:1.1627,stance loss: 0.98515 
Train step: 1260 acc:0.73611 total_loss: 0.98009  loss:0.67332,stance loss: 0.53048 
Better F1! Saving model!
Saving model of best f1: 0.4130571249215317
              precision    recall  f1-score   support

           0   0.571138  0.549902  0.560319       511
           1   0.454887  0.711765  0.555046       170
           2   0.319372  0.227612  0.265795       268

    accuracy                       0.487882       949
   macro avg   0.448466  0.496426  0.460387       949
weighted avg   0.479214  0.487882  0.476200       949

Test Acc: 0.48788198103266595 F1_ma:0.4130571249215317
Train step: 1270 acc:0.73913 total_loss: 0.9683  loss:0.73908,stance loss: 0.57393 
Train step: 1280 acc:0.74107 total_loss: 0.9756  loss:0.96143,stance loss: 0.86956 
Train step: 1290 acc:0.74242 total_loss: 0.96581  loss:1.0587,stance loss: 0.84184 
Train step: 1300 acc:0.75247 total_loss: 0.95118  loss:0.97124,stance loss: 0.9343 
Train step: 1310 acc:0.75291 total_loss: 0.9463  loss:0.84202,stance loss: 0.66894 
Train step: 1320 acc:0.75391 total_loss: 0.95191  loss:0.68032,stance loss: 0.57208 
Train step: 1330 acc:0.75649 total_loss: 0.94195  loss:1.0441,stance loss: 0.72836 
Train step: 1340 acc:0.76185 total_loss: 0.94074  loss:0.77331,stance loss: 0.63324 
Train step: 1350 acc:0.7619 total_loss: 0.93734  loss:0.77874,stance loss: 0.60095 
Train step: 1360 acc:0.76562 total_loss: 0.92854  loss:1.0437,stance loss: 1.0928 
Train step: 1370 acc:0.76498 total_loss: 0.92409  loss:0.68908,stance loss: 0.46962 
Train step: 1380 acc:0.76723 total_loss: 0.92442  loss:1.329,stance loss: 1.5629 
Train step: 1390 acc:0.76694 total_loss: 0.91882  loss:0.83639,stance loss: 0.50498 
Train step: 1400 acc:0.7674 total_loss: 0.91858  loss:0.87268,stance loss: 0.71732 
Train step: 1410 acc:0.7705 total_loss: 0.91061  loss:0.90178,stance loss: 0.44007 
Train step: 1420 acc:0.77296 total_loss: 0.91066  loss:0.70963,stance loss: 0.61841 
Train step: 1430 acc:0.77458 total_loss: 0.90268  loss:0.54534,stance loss: 0.42878 
Train step: 1440 acc:0.77517 total_loss: 0.89965  loss:0.79855,stance loss: 0.67054 
Train step: 1450 acc:0.77406 total_loss: 0.89947  loss:0.92727,stance loss: 0.67785 
Train step: 1460 acc:0.77463 total_loss: 0.90153  loss:1.3341,stance loss: 1.1377 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.8125 total_loss: 0.79623  loss:0.79623,stance loss: 0.56919 
Train step: 1480 acc:0.83523 total_loss: 0.87559  loss:1.2962,stance loss: 1.185 
Train step: 1490 acc:0.80357 total_loss: 0.87811  loss:0.69989,stance loss: 0.55351 
Better F1! Saving model!
Saving model of best f1: 0.4163662857581103
              precision    recall  f1-score   support

           0   0.581301  0.559687  0.570289       511
           1   0.441696  0.735294  0.551876       170
           2   0.333333  0.216418  0.262443       268

    accuracy                       0.494204       949
   macro avg   0.452110  0.503800  0.461536       949
weighted avg   0.486266  0.494204  0.480054       949

Test Acc: 0.49420442571127504 F1_ma:0.4163662857581103
Train step: 1500 acc:0.8004 total_loss: 0.85848  loss:0.63812,stance loss: 0.5135 
Train step: 1510 acc:0.79726 total_loss: 0.8748  loss:1.021,stance loss: 1.3044 
Train step: 1520 acc:0.78431 total_loss: 0.90857  loss:1.4827,stance loss: 0.97595 
Train step: 1530 acc:0.79816 total_loss: 0.88371  loss:0.38983,stance loss: 0.28255 
Train step: 1540 acc:0.79754 total_loss: 0.87808  loss:0.55726,stance loss: 0.40896 
Train step: 1550 acc:0.80247 total_loss: 0.86261  loss:0.97267,stance loss: 0.73249 
Train step: 1560 acc:0.79464 total_loss: 0.86425  loss:0.62575,stance loss: 0.3266 
Train step: 1570 acc:0.79332 total_loss: 0.8601  loss:1.097,stance loss: 0.83108 
Train step: 1580 acc:0.79955 total_loss: 0.84045  loss:0.59918,stance loss: 0.46104 
Train step: 1590 acc:0.797 total_loss: 0.84235  loss:0.8933,stance loss: 0.65757 
Train step: 1600 acc:0.79819 total_loss: 0.83918  loss:0.74693,stance loss: 0.56953 
Train step: 1610 acc:0.80186 total_loss: 0.83188  loss:0.95371,stance loss: 0.63635 
Train step: 1620 acc:0.80257 total_loss: 0.82241  loss:0.47435,stance loss: 0.40623 
Train step: 1630 acc:0.80318 total_loss: 0.82436  loss:1.321,stance loss: 1.1704 
Train step: 1640 acc:0.80007 total_loss: 0.82625  loss:0.7734,stance loss: 0.5184 
Train step: 1650 acc:0.79765 total_loss: 0.83148  loss:0.71603,stance loss: 0.65829 
Train step: 1660 acc:0.80268 total_loss: 0.81979  loss:0.63153,stance loss: 0.57278 
Train step: 1670 acc:0.80193 total_loss: 0.82422  loss:1.2783,stance loss: 0.91822 
Train step: 1680 acc:0.80184 total_loss: 0.82276  loss:0.7734,stance loss: 0.56336 
Train step: 1690 acc:0.80402 total_loss: 0.822  loss:0.40112,stance loss: 0.23551 
Train step: 1700 acc:0.80411 total_loss: 0.82262  loss:0.59126,stance loss: 0.53095 
Train step: 1710 acc:0.80679 total_loss: 0.81348  loss:0.41963,stance loss: 0.35216 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.90625 total_loss: 0.56006  loss:0.88384,stance loss: 0.7914 
Train step: 1730 acc:0.85938 total_loss: 0.64735  loss:0.57539,stance loss: 0.48726 
Train step: 1740 acc:0.84856 total_loss: 0.67904  loss:0.55096,stance loss: 0.42364 
Train step: 1750 acc:0.84896 total_loss: 0.68305  loss:0.46784,stance loss: 0.34908 
Train step: 1760 acc:0.83967 total_loss: 0.68797  loss:0.71038,stance loss: 0.52199 
Train step: 1770 acc:0.83259 total_loss: 0.69178  loss:0.89104,stance loss: 0.86358 
Train step: 1780 acc:0.83144 total_loss: 0.68692  loss:0.5318,stance loss: 0.45736 
Train step: 1790 acc:0.83388 total_loss: 0.68227  loss:0.33262,stance loss: 0.18487 
Train step: 1800 acc:0.83648 total_loss: 0.68537  loss:0.81543,stance loss: 0.63438 
Train step: 1810 acc:0.83268 total_loss: 0.68386  loss:0.71048,stance loss: 0.55871 
Train step: 1820 acc:0.8355 total_loss: 0.67781  loss:0.37581,stance loss: 0.24369 
Train step: 1830 acc:0.83244 total_loss: 0.68525  loss:0.80679,stance loss: 0.63242 
Train step: 1840 acc:0.83036 total_loss: 0.69118  loss:0.78092,stance loss: 0.64299 
Train step: 1850 acc:0.83364 total_loss: 0.68993  loss:1.2316,stance loss: 0.7917 
Train step: 1860 acc:0.83134 total_loss: 0.69355  loss:0.78591,stance loss: 0.60523 
Train step: 1870 acc:0.83413 total_loss: 0.68467  loss:0.42661,stance loss: 0.32915 
Train step: 1880 acc:0.83735 total_loss: 0.67655  loss:0.27432,stance loss: 0.16207 
Train step: 1890 acc:0.83771 total_loss: 0.67798  loss:0.51736,stance loss: 0.489 
Train step: 1900 acc:0.83602 total_loss: 0.68069  loss:0.62901,stance loss: 0.46243 
Train step: 1910 acc:0.83673 total_loss: 0.68088  loss:0.27648,stance loss: 0.18529 
Train step: 1920 acc:0.83738 total_loss: 0.67419  loss:0.80376,stance loss: 0.69527 
Train step: 1930 acc:0.83681 total_loss: 0.6795  loss:0.58743,stance loss: 0.43678 
Train step: 1940 acc:0.83656 total_loss: 0.68012  loss:0.84401,stance loss: 0.6107 
Train step: 1950 acc:0.83845 total_loss: 0.67816  loss:0.18064,stance loss: 0.068455 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.8125 total_loss: 0.67336  loss:0.67336,stance loss: 0.4746 
Train step: 1970 acc:0.84091 total_loss: 0.64552  loss:0.7946,stance loss: 0.70016 
Train step: 1980 acc:0.84226 total_loss: 0.6346  loss:0.66988,stance loss: 0.3961 
Train step: 1990 acc:0.85282 total_loss: 0.60769  loss:0.36427,stance loss: 0.29893 
Train step: 2000 acc:0.83994 total_loss: 0.63781  loss:1.0876,stance loss: 0.97806 
Train step: 2010 acc:0.85539 total_loss: 0.62762  loss:0.2479,stance loss: 0.119 
Train step: 2020 acc:0.86578 total_loss: 0.6174  loss:0.15325,stance loss: 0.051087 
Train step: 2030 acc:0.86444 total_loss: 0.62377  loss:0.63195,stance loss: 0.47922 
Train step: 2040 acc:0.8588 total_loss: 0.63018  loss:0.55691,stance loss: 0.45588 
Train step: 2050 acc:0.86401 total_loss: 0.6291  loss:0.47888,stance loss: 0.34505 
Train step: 2060 acc:0.86324 total_loss: 0.63342  loss:0.48223,stance loss: 0.39007 
Train step: 2070 acc:0.86261 total_loss: 0.63125  loss:0.73806,stance loss: 0.57819 
Train step: 2080 acc:0.86312 total_loss: 0.6293  loss:0.75052,stance loss: 0.6748 
Train step: 2090 acc:0.86498 total_loss: 0.62941  loss:0.87524,stance loss: 0.69468 
Train step: 2100 acc:0.86392 total_loss: 0.62407  loss:0.53436,stance loss: 0.32353 
Train step: 2110 acc:0.86548 total_loss: 0.62999  loss:1.4162,stance loss: 1.7124 
Train step: 2120 acc:0.86452 total_loss: 0.62856  loss:0.61086,stance loss: 0.28269 
Train step: 2130 acc:0.86513 total_loss: 0.63193  loss:0.60813,stance loss: 0.47974 
Train step: 2140 acc:0.86671 total_loss: 0.62423  loss:0.3808,stance loss: 0.33912 
Train step: 2150 acc:0.86486 total_loss: 0.62178  loss:0.51027,stance loss: 0.3162 
Train step: 2160 acc:0.86412 total_loss: 0.61819  loss:0.66971,stance loss: 0.52978 
Train step: 2170 acc:0.86197 total_loss: 0.62057  loss:0.24401,stance loss: 0.166 
Train step: 2180 acc:0.86199 total_loss: 0.61728  loss:0.6452,stance loss: 0.65938 
Train step: 2190 acc:0.86174 total_loss: 0.61671  loss:0.64002,stance loss: 0.51036 
Train step: 2200 acc:0.85918 total_loss: 0.62202  loss:1.1157,stance loss: 0.86185 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.82292 total_loss: 0.81759  loss:0.86892,stance loss: 0.58678 
Train step: 2220 acc:0.86719 total_loss: 0.62513  loss:0.37255,stance loss: 0.26505 
Train step: 2230 acc:0.86298 total_loss: 0.59653  loss:0.58609,stance loss: 0.52048 
Train step: 2240 acc:0.87326 total_loss: 0.60289  loss:0.55897,stance loss: 0.51161 
Train step: 2250 acc:0.87228 total_loss: 0.59699  loss:0.63527,stance loss: 0.62136 
Train step: 2260 acc:0.87835 total_loss: 0.58985  loss:0.65516,stance loss: 0.5563 
Train step: 2270 acc:0.87595 total_loss: 0.58878  loss:0.82352,stance loss: 1.2968 
Train step: 2280 acc:0.87664 total_loss: 0.59696  loss:0.78914,stance loss: 0.60517 
Train step: 2290 acc:0.87936 total_loss: 0.59117  loss:0.35243,stance loss: 0.26056 
Train step: 2300 acc:0.88151 total_loss: 0.58636  loss:0.18134,stance loss: 0.12624 
Train step: 2310 acc:0.87913 total_loss: 0.60311  loss:0.51168,stance loss: 0.32025 
Train step: 2320 acc:0.88416 total_loss: 0.58468  loss:0.13605,stance loss: 0.084647 
Train step: 2330 acc:0.88641 total_loss: 0.5788  loss:0.18087,stance loss: 0.11544 
Train step: 2340 acc:0.88603 total_loss: 0.57601  loss:0.65899,stance loss: 1.0493 
Train step: 2350 acc:0.8857 total_loss: 0.56967  loss:0.69727,stance loss: 0.51894 
Train step: 2360 acc:0.88582 total_loss: 0.56657  loss:0.88582,stance loss: 1.2255 
Train step: 2370 acc:0.88554 total_loss: 0.57064  loss:0.42287,stance loss: 0.33584 
Train step: 2380 acc:0.88565 total_loss: 0.56571  loss:0.40557,stance loss: 0.34355 
Train step: 2390 acc:0.88609 total_loss: 0.55907  loss:0.15994,stance loss: 0.093893 
Train step: 2400 acc:0.88329 total_loss: 0.56032  loss:0.36806,stance loss: 0.26426 
Train step: 2410 acc:0.88167 total_loss: 0.55658  loss:0.85355,stance loss: 0.63052 
Train step: 2420 acc:0.88223 total_loss: 0.54874  loss:0.2133,stance loss: 0.1546 
Train step: 2430 acc:0.88191 total_loss: 0.55308  loss:0.75704,stance loss: 1.0746 
Train step: 2440 acc:0.88268 total_loss: 0.55364  loss:0.50385,stance loss: 0.45111 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.75672  loss:0.75672,stance loss: 1.1337 
Train step: 2460 acc:0.92614 total_loss: 0.38303  loss:0.17787,stance loss: 0.074691 
Train step: 2470 acc:0.91667 total_loss: 0.37257  loss:0.21249,stance loss: 0.14214 
Train step: 2480 acc:0.90121 total_loss: 0.44833  loss:1.1906,stance loss: 1.3497 
Train step: 2490 acc:0.90396 total_loss: 0.45511  loss:0.40863,stance loss: 0.31017 
Train step: 2500 acc:0.90196 total_loss: 0.4549  loss:0.63947,stance loss: 0.47576 
Train step: 2510 acc:0.90471 total_loss: 0.4556  loss:0.65006,stance loss: 1.1066 
Train step: 2520 acc:0.90581 total_loss: 0.4567  loss:0.35466,stance loss: 0.32945 
Train step: 2530 acc:0.90586 total_loss: 0.46486  loss:0.55447,stance loss: 0.45611 
Train step: 2540 acc:0.90797 total_loss: 0.46402  loss:0.23528,stance loss: 0.13501 
Train step: 2550 acc:0.91213 total_loss: 0.44917  loss:0.32988,stance loss: 0.35218 
Train step: 2560 acc:0.90878 total_loss: 0.45582  loss:0.26274,stance loss: 0.23949 
Train step: 2570 acc:0.91116 total_loss: 0.44943  loss:0.2488,stance loss: 0.21295 
Train step: 2580 acc:0.91221 total_loss: 0.44148  loss:0.0748,stance loss: 0.024311 
Train step: 2590 acc:0.91445 total_loss: 0.43527  loss:0.92905,stance loss: 0.7657 
Train step: 2600 acc:0.91391 total_loss: 0.43261  loss:0.4303,stance loss: 0.27609 
Train step: 2610 acc:0.91188 total_loss: 0.44023  loss:0.51501,stance loss: 0.45777 
Train step: 2620 acc:0.91301 total_loss: 0.43724  loss:0.19423,stance loss: 0.10535 
Train step: 2630 acc:0.91195 total_loss: 0.44636  loss:0.71244,stance loss: 0.51297 
Train step: 2640 acc:0.91099 total_loss: 0.45465  loss:0.32015,stance loss: 0.23237 
Train step: 2650 acc:0.91045 total_loss: 0.44991  loss:0.092082,stance loss: 0.044952 
Train step: 2660 acc:0.90995 total_loss: 0.44755  loss:0.52026,stance loss: 0.39024 
Train step: 2670 acc:0.90781 total_loss: 0.45776  loss:0.74512,stance loss: 0.55525 
Train step: 2680 acc:0.9072 total_loss: 0.46285  loss:0.69453,stance loss: 1.0427 
Train step: 2690 acc:0.90664 total_loss: 0.46331  loss:0.27843,stance loss: 0.25058 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.90625 total_loss: 0.41974  loss:0.34018,stance loss: 0.30638 
Train step: 2710 acc:0.87109 total_loss: 0.5069  loss:0.48189,stance loss: 0.39714 
Train step: 2720 acc:0.90625 total_loss: 0.41686  loss:0.3543,stance loss: 0.30857 
Train step: 2730 acc:0.91146 total_loss: 0.41175  loss:0.44708,stance loss: 0.28702 
Train step: 2740 acc:0.91848 total_loss: 0.40006  loss:0.1695,stance loss: 0.097478 
Train step: 2750 acc:0.91629 total_loss: 0.40931  loss:0.15993,stance loss: 0.092431 
Train step: 2760 acc:0.9233 total_loss: 0.38427  loss:0.11649,stance loss: 0.048855 
Train step: 2770 acc:0.92105 total_loss: 0.39075  loss:0.24887,stance loss: 0.21228 
Train step: 2780 acc:0.91933 total_loss: 0.40062  loss:1.0703,stance loss: 1.3907 
Train step: 2790 acc:0.91862 total_loss: 0.40668  loss:0.71313,stance loss: 0.66762 
Train step: 2800 acc:0.92158 total_loss: 0.40328  loss:0.37109,stance loss: 0.29806 
Train step: 2810 acc:0.92241 total_loss: 0.39902  loss:0.36003,stance loss: 0.2995 
Train step: 2820 acc:0.92113 total_loss: 0.40475  loss:0.17981,stance loss: 0.15555 
Train step: 2830 acc:0.92325 total_loss: 0.39576  loss:0.28573,stance loss: 0.25474 
Train step: 2840 acc:0.92166 total_loss: 0.40232  loss:0.28146,stance loss: 0.19723 
Train step: 2850 acc:0.92268 total_loss: 0.40113  loss:0.426,stance loss: 0.35527 
Train step: 2860 acc:0.92432 total_loss: 0.392  loss:0.24311,stance loss: 0.13839 
Train step: 2870 acc:0.9233 total_loss: 0.39841  loss:0.99917,stance loss: 0.89665 
Train step: 2880 acc:0.92473 total_loss: 0.39289  loss:0.59561,stance loss: 1.0198 
Train step: 2890 acc:0.92538 total_loss: 0.39324  loss:0.61396,stance loss: 1.0634 
Train step: 2900 acc:0.92567 total_loss: 0.38711  loss:0.13303,stance loss: 0.083009 
Train step: 2910 acc:0.92564 total_loss: 0.3867  loss:0.095435,stance loss: 0.072838 
Train step: 2920 acc:0.92588 total_loss: 0.38548  loss:0.23628,stance loss: 0.17678 
Train step: 2930 acc:0.92638 total_loss: 0.38121  loss:0.12066,stance loss: 0.09553 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:1.0 total_loss: 0.06082  loss:0.06082,stance loss: 0.016959 
Train step: 2950 acc:0.96023 total_loss: 0.27087  loss:0.20059,stance loss: 0.10772 
Train step: 2960 acc:0.93452 total_loss: 0.32444  loss:0.35919,stance loss: 0.32195 
Train step: 2970 acc:0.93952 total_loss: 0.2984  loss:0.58187,stance loss: 0.5949 
Train step: 2980 acc:0.9314 total_loss: 0.3271  loss:0.16408,stance loss: 0.14544 
Train step: 2990 acc:0.9326 total_loss: 0.34277  loss:0.10622,stance loss: 0.020278 
Train step: 3000 acc:0.93545 total_loss: 0.32535  loss:0.078931,stance loss: 0.014842 
Train step: 3010 acc:0.9375 total_loss: 0.31404  loss:0.28875,stance loss: 0.25193 
Train step: 3020 acc:0.93981 total_loss: 0.31148  loss:0.1345,stance loss: 0.060981 
Train step: 3030 acc:0.94299 total_loss: 0.3163  loss:0.083206,stance loss: 0.035239 
Train step: 3040 acc:0.94307 total_loss: 0.32256  loss:0.56449,stance loss: 0.61394 
Train step: 3050 acc:0.94032 total_loss: 0.32729  loss:0.34562,stance loss: 0.29096 
Train step: 3060 acc:0.94163 total_loss: 0.32433  loss:0.19536,stance loss: 0.14763 
Train step: 3070 acc:0.94132 total_loss: 0.33109  loss:0.4586,stance loss: 0.38109 
Train step: 3080 acc:0.94105 total_loss: 0.33212  loss:0.23737,stance loss: 0.03519 
Train step: 3090 acc:0.94123 total_loss: 0.33216  loss:0.27009,stance loss: 0.18443 
Train step: 3100 acc:0.94022 total_loss: 0.33124  loss:0.93302,stance loss: 0.93428 
Train step: 3110 acc:0.94042 total_loss: 0.32822  loss:0.18367,stance loss: 0.13486 
Better F1! Saving model!
Saving model of best f1: 0.426024496671775
              precision    recall  f1-score   support

           0   0.599251  0.626223  0.612440       511
           1   0.427007  0.688235  0.527027       170
           2   0.347518  0.182836  0.239609       268

    accuracy                       0.512118       949
   macro avg   0.457925  0.499098  0.459692       949
weighted avg   0.497306  0.512118  0.491851       949

Test Acc: 0.512118018967334 F1_ma:0.426024496671775
Train step: 3120 acc:0.93854 total_loss: 0.3364  loss:0.30349,stance loss: 0.27585 
Train step: 3130 acc:0.93783 total_loss: 0.33368  loss:0.45303,stance loss: 0.42762 
Train step: 3140 acc:0.93812 total_loss: 0.33454  loss:0.11413,stance loss: 0.070571 
Train step: 3150 acc:0.93928 total_loss: 0.3315  loss:0.034407,stance loss: 0.0027468 
Train step: 3160 acc:0.93891 total_loss: 0.33714  loss:0.31903,stance loss: 0.23695 
Train step: 3170 acc:0.93885 total_loss: 0.34009  loss:0.44887,stance loss: 0.26747 
Train step: 3180 acc:0.93802 total_loss: 0.34977  loss:0.82013,stance loss: 0.72262 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.95833 total_loss: 0.31644  loss:0.10576,stance loss: 0.068592 
Train step: 3200 acc:0.95312 total_loss: 0.3236  loss:0.48338,stance loss: 0.37519 
Train step: 3210 acc:0.94712 total_loss: 0.32379  loss:0.84427,stance loss: 1.1441 
Train step: 3220 acc:0.94618 total_loss: 0.34087  loss:0.24062,stance loss: 0.22123 
Train step: 3230 acc:0.94973 total_loss: 0.32014  loss:0.095333,stance loss: 0.073059 
Train step: 3240 acc:0.94754 total_loss: 0.3111  loss:0.21953,stance loss: 0.084589 
Train step: 3250 acc:0.94886 total_loss: 0.31439  loss:0.12954,stance loss: 0.12748 
Train step: 3260 acc:0.95066 total_loss: 0.30163  loss:0.28478,stance loss: 0.21339 
Train step: 3270 acc:0.94549 total_loss: 0.3124  loss:0.5332,stance loss: 0.17467 
Train step: 3280 acc:0.94596 total_loss: 0.3061  loss:0.15395,stance loss: 0.095513 
Train step: 3290 acc:0.94634 total_loss: 0.31226  loss:0.4185,stance loss: 0.35994 
Train step: 3300 acc:0.9445 total_loss: 0.31424  loss:0.24145,stance loss: 0.14594 
Train step: 3310 acc:0.94494 total_loss: 0.31079  loss:0.32146,stance loss: 0.27476 
Train step: 3320 acc:0.94715 total_loss: 0.30702  loss:0.20251,stance loss: 0.15154 
Train step: 3330 acc:0.94735 total_loss: 0.30735  loss:0.050445,stance loss: 0.020587 
Train step: 3340 acc:0.94752 total_loss: 0.29968  loss:0.29327,stance loss: 0.30064 
Train step: 3350 acc:0.94578 total_loss: 0.30144  loss:0.85246,stance loss: 0.88134 
Train step: 3360 acc:0.9478 total_loss: 0.2963  loss:0.030575,stance loss: 0.0056635 
Train step: 3370 acc:0.94724 total_loss: 0.29688  loss:0.1357,stance loss: 0.10368 
Train step: 3380 acc:0.94739 total_loss: 0.29836  loss:0.034436,stance loss: 0.0044207 
Train step: 3390 acc:0.94691 total_loss: 0.30315  loss:0.070768,stance loss: 0.037404 
Train step: 3400 acc:0.94705 total_loss: 0.30652  loss:1.2121,stance loss: 1.3955 
Train step: 3410 acc:0.9469 total_loss: 0.30512  loss:0.063994,stance loss: 0.012966 
Train step: 3420 acc:0.94783 total_loss: 0.30367  loss:0.2603,stance loss: 0.19636 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.9375 total_loss: 0.34104  loss:0.34104,stance loss: 0.11381 
Train step: 3440 acc:0.92614 total_loss: 0.34107  loss:0.40957,stance loss: 0.36948 
Train step: 3450 acc:0.93155 total_loss: 0.3679  loss:0.044958,stance loss: 0.0048596 
Train step: 3460 acc:0.93145 total_loss: 0.35592  loss:0.04821,stance loss: 0.011282 
Train step: 3470 acc:0.94207 total_loss: 0.32086  loss:0.084501,stance loss: 0.050585 
Train step: 3480 acc:0.94118 total_loss: 0.30395  loss:0.20705,stance loss: 0.16111 
Train step: 3490 acc:0.94262 total_loss: 0.28768  loss:0.50629,stance loss: 0.40342 
Train step: 3500 acc:0.94102 total_loss: 0.31727  loss:0.47471,stance loss: 0.45888 
Train step: 3510 acc:0.94367 total_loss: 0.29878  loss:0.079674,stance loss: 0.049069 
Train step: 3520 acc:0.94505 total_loss: 0.29524  loss:0.57445,stance loss: 1.0389 
Train step: 3530 acc:0.94678 total_loss: 0.29068  loss:0.056446,stance loss: 0.01988 
Train step: 3540 acc:0.94707 total_loss: 0.29814  loss:0.57899,stance loss: 1.0375 
Train step: 3550 acc:0.94835 total_loss: 0.30253  loss:0.54771,stance loss: 1.0105 
Train step: 3560 acc:0.94847 total_loss: 0.30756  loss:0.72147,stance loss: 1.1665 
Train step: 3570 acc:0.95124 total_loss: 0.29398  loss:0.04996,stance loss: 0.020633 
Train step: 3580 acc:0.95323 total_loss: 0.28496  loss:0.12156,stance loss: 0.071676 
Train step: 3590 acc:0.95536 total_loss: 0.27845  loss:0.10023,stance loss: 0.064914 
Train step: 3600 acc:0.95651 total_loss: 0.26841  loss:0.089885,stance loss: 0.031479 
Train step: 3610 acc:0.95477 total_loss: 0.27398  loss:0.52186,stance loss: 0.36251 
Train step: 3620 acc:0.95517 total_loss: 0.27681  loss:0.90289,stance loss: 1.3062 
Train step: 3630 acc:0.95647 total_loss: 0.27425  loss:0.21601,stance loss: 0.17946 
Train step: 3640 acc:0.95616 total_loss: 0.27294  loss:0.02906,stance loss: 0.0057957 
Train step: 3650 acc:0.95645 total_loss: 0.27131  loss:0.41474,stance loss: 0.31555 
Train step: 3660 acc:0.9559 total_loss: 0.27604  loss:0.57839,stance loss: 0.49181 
Train step: 3670 acc:0.95488 total_loss: 0.27534  loss:0.32499,stance loss: 0.23968 
Training finished.


Reload the best model with best f1 0.426024496671775 from path test_outputs/bert-cross-topic/fm/2023-08-14 18-17-36/state_dict


              precision    recall  f1-score   support

           0   0.599251  0.626223  0.612440       511
           1   0.427007  0.688235  0.527027       170
           2   0.347518  0.182836  0.239609       268

    accuracy                       0.512118       949
   macro avg   0.457925  0.499098  0.459692       949
weighted avg   0.497306  0.512118  0.491851       949

Test Acc: 0.512118018967334 F1_ma:0.426024496671775
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.426024496671775
acc: 0.512118018967334, f1 :0.45969200679019223
classification report: 
              precision    recall  f1-score   support

         Con     0.5993    0.6262    0.6124       511
        None     0.4270    0.6882    0.5270       170
         Pro     0.3475    0.1828    0.2396       268

    accuracy                         0.5121       949
   macro avg     0.4579    0.4991    0.4597       949
weighted avg     0.4973    0.5121    0.4919       949

run_semeval with seed: 31554
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 18-56-05', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31554, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 18-56-05
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.9225  loss:1.9225,stance loss: 1.2336 
Train step: 10 acc:0.23295 total_loss: 1.8185  loss:1.7009,stance loss: 1.2252 
Better F1! Saving model!
Saving model of best f1: 0.3486932599724897
              precision    recall  f1-score   support

           0   0.537646  0.992172  0.697387       511
           1   0.166667  0.005882  0.011364       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.535300       949
   macro avg   0.234771  0.332685  0.236250       949
weighted avg   0.319358  0.535300  0.377551       949

Test Acc: 0.5353003161222339 F1_ma:0.3486932599724897
Train step: 20 acc:0.36012 total_loss: 1.7087  loss:1.3495,stance loss: 0.72455 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 30 acc:0.40323 total_loss: 1.6911  loss:1.596,stance loss: 1.0875 
Train step: 40 acc:0.42378 total_loss: 1.6803  loss:1.738,stance loss: 1.2317 
Train step: 50 acc:0.44363 total_loss: 1.6661  loss:1.5342,stance loss: 1.0953 
Train step: 60 acc:0.45082 total_loss: 1.6583  loss:1.7626,stance loss: 1.2761 
Train step: 70 acc:0.46391 total_loss: 1.6409  loss:1.6523,stance loss: 1.2776 
Train step: 80 acc:0.46451 total_loss: 1.6361  loss:1.5508,stance loss: 1.134 
Train step: 90 acc:0.47734 total_loss: 1.621  loss:1.146,stance loss: 0.64668 
Train step: 100 acc:0.48144 total_loss: 1.6216  loss:1.7962,stance loss: 1.7897 
Train step: 110 acc:0.48423 total_loss: 1.6223  loss:1.7457,stance loss: 1.1666 
Train step: 120 acc:0.4876 total_loss: 1.6258  loss:1.7098,stance loss: 1.2442 
Train step: 130 acc:0.49046 total_loss: 1.6271  loss:1.5892,stance loss: 1.2003 
Train step: 140 acc:0.48892 total_loss: 1.6284  loss:1.6641,stance loss: 1.1973 
Train step: 150 acc:0.48675 total_loss: 1.6286  loss:1.6861,stance loss: 1.1418 
Train step: 160 acc:0.49107 total_loss: 1.6209  loss:1.5675,stance loss: 1.2476 
Train step: 170 acc:0.49086 total_loss: 1.6211  loss:1.6995,stance loss: 1.2381 
Train step: 180 acc:0.4962 total_loss: 1.619  loss:1.3783,stance loss: 0.99741 
Train step: 190 acc:0.49705 total_loss: 1.6191  loss:1.6674,stance loss: 1.2231 
Train step: 200 acc:0.50311 total_loss: 1.6139  loss:1.6115,stance loss: 1.1519 
Train step: 210 acc:0.50504 total_loss: 1.6084  loss:1.628,stance loss: 0.92415 
Train step: 220 acc:0.50877 total_loss: 1.601  loss:1.2906,stance loss: 0.93425 
Train step: 230 acc:0.51163 total_loss: 1.5934  loss:0.89798,stance loss: 0.49127 
Train step: 240 acc:0.514 total_loss: 1.5923  loss:1.3913,stance loss: 0.99268 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.63542 total_loss: 1.4385  loss:1.3715,stance loss: 1.0542 
Train step: 260 acc:0.55469 total_loss: 1.5655  loss:1.5569,stance loss: 1.5421 
Train step: 270 acc:0.54087 total_loss: 1.561  loss:1.732,stance loss: 1.1706 
Train step: 280 acc:0.54514 total_loss: 1.5655  loss:1.5113,stance loss: 1.1526 
Train step: 290 acc:0.54212 total_loss: 1.5661  loss:1.6343,stance loss: 1.6841 
Train step: 300 acc:0.54018 total_loss: 1.5704  loss:1.4633,stance loss: 1.1134 
Train step: 310 acc:0.5464 total_loss: 1.5665  loss:1.3446,stance loss: 1.0417 
Train step: 320 acc:0.55345 total_loss: 1.5539  loss:1.4632,stance loss: 1.157 
Train step: 330 acc:0.54797 total_loss: 1.5539  loss:1.5635,stance loss: 1.1294 
Better F1! Saving model!
Saving model of best f1: 0.3514328808446455
              precision    recall  f1-score   support

           0   0.571779  0.911937  0.702866       511
           1   0.477612  0.376471  0.421053       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.558483       949
   macro avg   0.349797  0.429469  0.374639       949
weighted avg   0.393439  0.558483  0.453892       949

Test Acc: 0.5584826132771338 F1_ma:0.3514328808446455
Train step: 340 acc:0.54753 total_loss: 1.5439  loss:1.6604,stance loss: 1.7012 
Train step: 350 acc:0.55542 total_loss: 1.5396  loss:1.4774,stance loss: 1.1527 
Train step: 360 acc:0.55819 total_loss: 1.5331  loss:1.4968,stance loss: 1.181 
Train step: 370 acc:0.55903 total_loss: 1.5301  loss:1.7683,stance loss: 1.7361 
Train step: 380 acc:0.55836 total_loss: 1.5247  loss:1.3104,stance loss: 1.0177 
Train step: 390 acc:0.5595 total_loss: 1.5231  loss:1.4349,stance loss: 1.1422 
Train step: 400 acc:0.5633 total_loss: 1.5176  loss:1.5252,stance loss: 1.0125 
Train step: 410 acc:0.56363 total_loss: 1.5109  loss:1.3364,stance loss: 0.90512 
Train step: 420 acc:0.56392 total_loss: 1.5097  loss:1.4327,stance loss: 1.0328 
Train step: 430 acc:0.56452 total_loss: 1.5034  loss:1.4638,stance loss: 1.0426 
Train step: 440 acc:0.56282 total_loss: 1.5057  loss:1.7993,stance loss: 1.2988 
Train step: 450 acc:0.56553 total_loss: 1.5049  loss:1.2926,stance loss: 0.96316 
Train step: 460 acc:0.56655 total_loss: 1.5003  loss:1.6193,stance loss: 1.5988 
Train step: 470 acc:0.56831 total_loss: 1.4935  loss:1.0082,stance loss: 0.84421 
Train step: 480 acc:0.56992 total_loss: 1.4925  loss:1.311,stance loss: 0.94129 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.375 total_loss: 1.5632  loss:1.5632,stance loss: 1.2237 
Train step: 500 acc:0.61364 total_loss: 1.3429  loss:1.3314,stance loss: 1.1175 
Train step: 510 acc:0.60119 total_loss: 1.3626  loss:1.3415,stance loss: 1.0111 
Train step: 520 acc:0.60685 total_loss: 1.38  loss:1.426,stance loss: 0.9263 
Train step: 530 acc:0.60366 total_loss: 1.3992  loss:1.4344,stance loss: 1.1971 
Better F1! Saving model!
Saving model of best f1: 0.3532303370786517
              precision    recall  f1-score   support

           0   0.550931  0.984344  0.706461       511
           1   0.750000  0.158824  0.262136       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.558483       949
   macro avg   0.433644  0.381056  0.322866       949
weighted avg   0.431007  0.558483  0.427360       949

Test Acc: 0.5584826132771338 F1_ma:0.3532303370786517
Train step: 540 acc:0.60907 total_loss: 1.3782  loss:1.3885,stance loss: 0.83846 
Train step: 550 acc:0.61168 total_loss: 1.3668  loss:1.2459,stance loss: 0.85567 
Better F1! Saving model!
Saving model of best f1: 0.3590677348871085
              precision    recall  f1-score   support

           0   0.571926  0.964775  0.718135       511
           1   0.689655  0.352941  0.466926       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.582719       949
   macro avg   0.420527  0.439239  0.395021       949
weighted avg   0.431502  0.582719  0.470332       949

Test Acc: 0.5827186512118019 F1_ma:0.3590677348871085
Train step: 560 acc:0.61444 total_loss: 1.367  loss:1.3685,stance loss: 1.0508 
Train step: 570 acc:0.62191 total_loss: 1.3669  loss:1.1298,stance loss: 0.94692 
Train step: 580 acc:0.62843 total_loss: 1.3652  loss:1.2645,stance loss: 1.0481 
Train step: 590 acc:0.63057 total_loss: 1.3588  loss:1.123,stance loss: 0.89563 
Train step: 600 acc:0.62725 total_loss: 1.3594  loss:1.2782,stance loss: 0.92698 
Train step: 610 acc:0.6281 total_loss: 1.3522  loss:1.4817,stance loss: 1.2949 
Train step: 620 acc:0.62643 total_loss: 1.3514  loss:1.6596,stance loss: 1.6953 
Train step: 630 acc:0.62766 total_loss: 1.3492  loss:1.533,stance loss: 1.0546 
Train step: 640 acc:0.62624 total_loss: 1.3456  loss:1.309,stance loss: 0.98048 
Train step: 650 acc:0.62694 total_loss: 1.3457  loss:1.2609,stance loss: 0.90535 
Train step: 660 acc:0.62756 total_loss: 1.3392  loss:1.0808,stance loss: 0.86419 
Train step: 670 acc:0.62742 total_loss: 1.334  loss:1.3468,stance loss: 1.0538 
Train step: 680 acc:0.62893 total_loss: 1.3335  loss:1.2048,stance loss: 1.01 
Better F1! Saving model!
Saving model of best f1: 0.40933914231697954
              precision    recall  f1-score   support

           0   0.558081  0.864971  0.678434       511
           1   0.556701  0.317647  0.404494       170
           2   0.383333  0.085821  0.140244       268

    accuracy                       0.546891       949
   macro avg   0.499372  0.422813  0.407724       949
weighted avg   0.508485  0.546891  0.477376       949

Test Acc: 0.5468914646996839 F1_ma:0.40933914231697954
Train step: 690 acc:0.62904 total_loss: 1.3329  loss:1.4726,stance loss: 1.1189 
Train step: 700 acc:0.63092 total_loss: 1.3285  loss:1.1143,stance loss: 0.87828 
Train step: 710 acc:0.63235 total_loss: 1.3309  loss:1.0478,stance loss: 0.88055 
Train step: 720 acc:0.63203 total_loss: 1.3268  loss:1.1853,stance loss: 0.98196 
Train step: 730 acc:0.632 total_loss: 1.3254  loss:1.5303,stance loss: 1.2138 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.72917 total_loss: 1.205  loss:1.2516,stance loss: 1.033 
Train step: 750 acc:0.6875 total_loss: 1.1874  loss:1.3782,stance loss: 1.0425 
Train step: 760 acc:0.67788 total_loss: 1.1659  loss:1.1619,stance loss: 0.87625 
Train step: 770 acc:0.67882 total_loss: 1.1522  loss:1.0123,stance loss: 0.78978 
Train step: 780 acc:0.66576 total_loss: 1.1774  loss:1.2346,stance loss: 0.9896 
Train step: 790 acc:0.66295 total_loss: 1.2027  loss:1.2016,stance loss: 0.91521 
Train step: 800 acc:0.66288 total_loss: 1.2022  loss:1.5808,stance loss: 1.6922 
Train step: 810 acc:0.65954 total_loss: 1.224  loss:1.3589,stance loss: 1.0994 
Train step: 820 acc:0.6657 total_loss: 1.22  loss:1.1668,stance loss: 1.0659 
Train step: 830 acc:0.67122 total_loss: 1.2109  loss:0.85596,stance loss: 0.50843 
Train step: 840 acc:0.67099 total_loss: 1.2106  loss:0.92777,stance loss: 0.77876 
Train step: 850 acc:0.67565 total_loss: 1.1974  loss:0.9357,stance loss: 0.70005 
Better F1! Saving model!
Saving model of best f1: 0.4138775850263091
              precision    recall  f1-score   support

           0   0.598071  0.727984  0.656664       511
           1   0.464844  0.700000  0.558685       170
           2   0.408451  0.108209  0.171091       268

    accuracy                       0.547945       949
   macro avg   0.490455  0.512064  0.462147       949
weighted avg   0.520656  0.547945  0.501985       949

Test Acc: 0.547945205479452 F1_ma:0.4138775850263091
Train step: 860 acc:0.67361 total_loss: 1.2038  loss:0.99741,stance loss: 0.71436 
Better F1! Saving model!
Saving model of best f1: 0.4274535776485883
              precision    recall  f1-score   support

           0   0.579710  0.861057  0.692913       511
           1   0.569343  0.458824  0.508143       170
           2   0.490566  0.097015  0.161994       268

    accuracy                       0.573235       949
   macro avg   0.546540  0.472298  0.454350       949
weighted avg   0.552679  0.573235  0.509881       949

Test Acc: 0.5732349841938883 F1_ma:0.4274535776485883
Train step: 870 acc:0.67647 total_loss: 1.201  loss:0.92632,stance loss: 0.66519 
Train step: 880 acc:0.67551 total_loss: 1.1997  loss:1.0664,stance loss: 0.79803 
Train step: 890 acc:0.67788 total_loss: 1.2025  loss:1.2344,stance loss: 1.296 
Train step: 900 acc:0.6811 total_loss: 1.1993  loss:1.634,stance loss: 1.7145 
Train step: 910 acc:0.68004 total_loss: 1.1975  loss:1.2938,stance loss: 0.95977 
Train step: 920 acc:0.68145 total_loss: 1.1968  loss:1.3826,stance loss: 1.0115 
Better F1! Saving model!
Saving model of best f1: 0.4281704642105734
              precision    recall  f1-score   support

           0   0.588235  0.567515  0.577689       511
           1   0.448029  0.735294  0.556793       170
           2   0.350282  0.231343  0.278652       268

    accuracy                       0.502634       949
   macro avg   0.462182  0.511384  0.471045       949
weighted avg   0.495921  0.502634  0.489497       949

Test Acc: 0.5026343519494204 F1_ma:0.4281704642105734
Train step: 930 acc:0.68208 total_loss: 1.1882  loss:0.90538,stance loss: 0.66132 
Train step: 940 acc:0.68083 total_loss: 1.1892  loss:1.3078,stance loss: 1.0685 
Better F1! Saving model!
Saving model of best f1: 0.4344633683649419
              precision    recall  f1-score   support

           0   0.618280  0.675147  0.645463       511
           1   0.431894  0.764706  0.552017       170
           2   0.444444  0.149254  0.223464       268

    accuracy                       0.542677       949
   macro avg   0.498206  0.529702  0.473648       949
weighted avg   0.535800  0.542677  0.509550       949

Test Acc: 0.5426765015806112 F1_ma:0.4344633683649419
Train step: 950 acc:0.68229 total_loss: 1.1853  loss:1.5,stance loss: 1.1419 
Train step: 960 acc:0.68335 total_loss: 1.1797  loss:0.95833,stance loss: 0.79965 
Train step: 970 acc:0.68591 total_loss: 1.1754  loss:1.2097,stance loss: 1.0272 
Better F1! Saving model!
Saving model of best f1: 0.4590294999821768
              precision    recall  f1-score   support

           0   0.620926  0.708415  0.661792       511
           1   0.450909  0.729412  0.557303       170
           2   0.505495  0.171642  0.256267       268

    accuracy                       0.560590       949
   macro avg   0.525777  0.536489  0.491787       949
weighted avg   0.557872  0.560590  0.528553       949

Test Acc: 0.5605900948366702 F1_ma:0.4590294999821768
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.5625 total_loss: 1.2616  loss:1.2616,stance loss: 0.87942 
Train step: 990 acc:0.71023 total_loss: 1.073  loss:1.0407,stance loss: 0.87472 
Train step: 1000 acc:0.70536 total_loss: 1.1096  loss:1.0832,stance loss: 1.04 
Train step: 1010 acc:0.70968 total_loss: 1.1242  loss:1.5392,stance loss: 1.1957 
Train step: 1020 acc:0.70884 total_loss: 1.0982  loss:1.2435,stance loss: 1.2201 
Train step: 1030 acc:0.72304 total_loss: 1.0981  loss:1.3368,stance loss: 1.5262 
Train step: 1040 acc:0.71209 total_loss: 1.0968  loss:0.99177,stance loss: 0.66763 
Train step: 1050 acc:0.71303 total_loss: 1.0936  loss:0.97121,stance loss: 0.82011 
Train step: 1060 acc:0.71914 total_loss: 1.0834  loss:0.96503,stance loss: 0.8321 
Better F1! Saving model!
Saving model of best f1: 0.47486420574215715
              precision    recall  f1-score   support

           0   0.604959  0.716243  0.655914       511
           1   0.473214  0.623529  0.538071       170
           2   0.475000  0.212687  0.293814       268

    accuracy                       0.557429       949
   macro avg   0.517724  0.517486  0.495933       949
weighted avg   0.544658  0.557429  0.532546       949

Test Acc: 0.5574288724973656 F1_ma:0.47486420574215715
Train step: 1070 acc:0.72184 total_loss: 1.1023  loss:1.1384,stance loss: 0.91821 
Better F1! Saving model!
Saving model of best f1: 0.48399616256759115
              precision    recall  f1-score   support

           0   0.616471  0.512720  0.559829       511
           1   0.458498  0.682353  0.548463       170
           2   0.405904  0.410448  0.408163       268

    accuracy                       0.514226       949
   macro avg   0.493624  0.535174  0.505485       949
weighted avg   0.528708  0.514226  0.514962       949

Test Acc: 0.5142255005268704 F1_ma:0.48399616256759115
Train step: 1080 acc:0.72587 total_loss: 1.0937  loss:1.0388,stance loss: 0.73547 
Train step: 1090 acc:0.72917 total_loss: 1.0742  loss:1.2268,stance loss: 0.85072 
Train step: 1100 acc:0.72986 total_loss: 1.0702  loss:1.1334,stance loss: 0.84188 
Train step: 1110 acc:0.73044 total_loss: 1.0763  loss:0.93256,stance loss: 0.68823 
Train step: 1120 acc:0.73183 total_loss: 1.0727  loss:0.69354,stance loss: 0.5795 
Train step: 1130 acc:0.73055 total_loss: 1.0769  loss:1.4612,stance loss: 1.6089 
Train step: 1140 acc:0.7302 total_loss: 1.0795  loss:1.0776,stance loss: 0.96984 
Train step: 1150 acc:0.73099 total_loss: 1.0702  loss:0.93012,stance loss: 0.7428 
Train step: 1160 acc:0.73101 total_loss: 1.0704  loss:1.8795,stance loss: 1.9398 
Train step: 1170 acc:0.72906 total_loss: 1.0775  loss:1.0561,stance loss: 0.95028 
Train step: 1180 acc:0.73072 total_loss: 1.071  loss:0.98337,stance loss: 0.80067 
Train step: 1190 acc:0.73223 total_loss: 1.0659  loss:0.57003,stance loss: 0.40198 
Train step: 1200 acc:0.73105 total_loss: 1.0691  loss:1.5287,stance loss: 1.7616 
Train step: 1210 acc:0.73187 total_loss: 1.0689  loss:1.1714,stance loss: 0.96952 
Train step: 1220 acc:0.73418 total_loss: 1.0638  loss:0.98849,stance loss: 0.79816 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.75 total_loss: 1.0285  loss:1.1668,stance loss: 1.4372 
Train step: 1240 acc:0.76953 total_loss: 0.90147  loss:1.0241,stance loss: 1.0072 
Train step: 1250 acc:0.78365 total_loss: 0.89859  loss:0.91156,stance loss: 0.75036 
Better F1! Saving model!
Saving model of best f1: 0.487819894172851
              precision    recall  f1-score   support

           0   0.628205  0.671233  0.649007       511
           1   0.439560  0.705882  0.541761       170
           2   0.500000  0.242537  0.326633       268

    accuracy                       0.556375       949
   macro avg   0.522589  0.539884  0.505800       949
weighted avg   0.558207  0.556375  0.538756       949

Test Acc: 0.5563751317175974 F1_ma:0.487819894172851
Train step: 1260 acc:0.7691 total_loss: 0.92722  loss:0.79401,stance loss: 0.67578 
Train step: 1270 acc:0.7731 total_loss: 0.93486  loss:1.0559,stance loss: 0.70594 
Train step: 1280 acc:0.77567 total_loss: 0.93763  loss:0.52997,stance loss: 0.39378 
Train step: 1290 acc:0.77652 total_loss: 0.93568  loss:0.74683,stance loss: 0.65751 
Train step: 1300 acc:0.77138 total_loss: 0.95421  loss:1.2068,stance loss: 0.79253 
Train step: 1310 acc:0.76381 total_loss: 0.95798  loss:0.31866,stance loss: 0.072363 
Train step: 1320 acc:0.76432 total_loss: 0.94669  loss:0.6742,stance loss: 0.60928 
Train step: 1330 acc:0.76887 total_loss: 0.92846  loss:0.69205,stance loss: 0.61077 
Train step: 1340 acc:0.7694 total_loss: 0.93046  loss:0.88201,stance loss: 0.78522 
Train step: 1350 acc:0.76885 total_loss: 0.93991  loss:1.3546,stance loss: 1.0863 
Train step: 1360 acc:0.76976 total_loss: 0.93928  loss:0.94696,stance loss: 1.2396 
Train step: 1370 acc:0.76969 total_loss: 0.94183  loss:1.1922,stance loss: 0.91701 
Train step: 1380 acc:0.77083 total_loss: 0.94178  loss:1.0886,stance loss: 0.89563 
Train step: 1390 acc:0.77184 total_loss: 0.93847  loss:0.95922,stance loss: 0.71251 
Train step: 1400 acc:0.77557 total_loss: 0.93115  loss:0.94794,stance loss: 0.89076 
Train step: 1410 acc:0.77755 total_loss: 0.93055  loss:1.0399,stance loss: 1.0663 
Train step: 1420 acc:0.77519 total_loss: 0.93803  loss:0.67763,stance loss: 0.51018 
Train step: 1430 acc:0.77306 total_loss: 0.94046  loss:1.8368,stance loss: 1.405 
Train step: 1440 acc:0.77459 total_loss: 0.93472  loss:0.80974,stance loss: 0.68035 
Train step: 1450 acc:0.776 total_loss: 0.92706  loss:0.89752,stance loss: 0.74392 
Train step: 1460 acc:0.77569 total_loss: 0.92797  loss:0.62286,stance loss: 0.45554 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.5625 total_loss: 1.4912  loss:1.4912,stance loss: 1.1437 
Train step: 1480 acc:0.78977 total_loss: 0.89733  loss:0.83595,stance loss: 0.73723 
Train step: 1490 acc:0.80357 total_loss: 0.87555  loss:0.52607,stance loss: 0.33015 
Better F1! Saving model!
Saving model of best f1: 0.5001822259601907
              precision    recall  f1-score   support

           0   0.582418  0.726027  0.646341       511
           1   0.537931  0.458824  0.495238       170
           2   0.461078  0.287313  0.354023       268

    accuracy                       0.554268       949
   macro avg   0.527142  0.490721  0.498534       949
weighted avg   0.540182  0.554268  0.536722       949

Test Acc: 0.5542676501580611 F1_ma:0.5001822259601907
Train step: 1500 acc:0.8246 total_loss: 0.79281  loss:0.62786,stance loss: 0.47349 
Train step: 1510 acc:0.81707 total_loss: 0.82415  loss:0.70279,stance loss: 0.56168 
Train step: 1520 acc:0.8174 total_loss: 0.80859  loss:0.88998,stance loss: 0.74269 
Train step: 1530 acc:0.8207 total_loss: 0.80974  loss:0.55774,stance loss: 0.45059 
Train step: 1540 acc:0.81866 total_loss: 0.79879  loss:0.92726,stance loss: 0.7336 
Train step: 1550 acc:0.81867 total_loss: 0.80371  loss:0.94265,stance loss: 0.95796 
Train step: 1560 acc:0.81662 total_loss: 0.8092  loss:0.36191,stance loss: 0.24573 
Train step: 1570 acc:0.81683 total_loss: 0.81503  loss:0.57446,stance loss: 0.44034 
Train step: 1580 acc:0.8125 total_loss: 0.83247  loss:0.90451,stance loss: 0.82187 
Train step: 1590 acc:0.80682 total_loss: 0.83668  loss:0.91088,stance loss: 0.84419 
Train step: 1600 acc:0.80677 total_loss: 0.83122  loss:1.0441,stance loss: 0.83384 
Train step: 1610 acc:0.80674 total_loss: 0.82948  loss:0.74966,stance loss: 0.45893 
Train step: 1620 acc:0.80464 total_loss: 0.83525  loss:0.92915,stance loss: 0.77098 
Train step: 1630 acc:0.80629 total_loss: 0.82539  loss:0.75075,stance loss: 0.66621 
Train step: 1640 acc:0.80775 total_loss: 0.82498  loss:0.34887,stance loss: 0.18518 
Train step: 1650 acc:0.8087 total_loss: 0.8205  loss:0.49049,stance loss: 0.34013 
Train step: 1660 acc:0.80694 total_loss: 0.82311  loss:1.2218,stance loss: 1.0402 
Train step: 1670 acc:0.80566 total_loss: 0.82285  loss:0.46352,stance loss: 0.39683 
Train step: 1680 acc:0.80717 total_loss: 0.81732  loss:0.64586,stance loss: 0.48149 
Train step: 1690 acc:0.80571 total_loss: 0.81866  loss:1.0401,stance loss: 0.89136 
Train step: 1700 acc:0.80709 total_loss: 0.8207  loss:0.42334,stance loss: 0.35602 
Train step: 1710 acc:0.80835 total_loss: 0.82253  loss:0.91461,stance loss: 0.85029 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.89583 total_loss: 0.58371  loss:0.29993,stance loss: 0.10038 
Train step: 1730 acc:0.875 total_loss: 0.71162  loss:0.95556,stance loss: 1.1053 
Better F1! Saving model!
Saving model of best f1: 0.5075479930191973
              precision    recall  f1-score   support

           0   0.570079  0.708415  0.631763       511
           1   0.558824  0.335294  0.419118       170
           2   0.433962  0.343284  0.383333       268

    accuracy                       0.538462       949
   macro avg   0.520955  0.462331  0.478071       949
weighted avg   0.529623  0.538462  0.523513       949

Test Acc: 0.5384615384615384 F1_ma:0.5075479930191973
Train step: 1740 acc:0.86058 total_loss: 0.72938  loss:0.87897,stance loss: 0.69868 
Train step: 1750 acc:0.86285 total_loss: 0.71302  loss:0.60492,stance loss: 0.54495 
Train step: 1760 acc:0.85462 total_loss: 0.74928  loss:0.53593,stance loss: 0.48965 
Train step: 1770 acc:0.84933 total_loss: 0.76919  loss:0.89308,stance loss: 1.3032 
Train step: 1780 acc:0.84186 total_loss: 0.7873  loss:0.72199,stance loss: 0.57153 
Train step: 1790 acc:0.84211 total_loss: 0.78396  loss:0.71919,stance loss: 0.65188 
Train step: 1800 acc:0.84738 total_loss: 0.76394  loss:0.83855,stance loss: 0.79525 
Train step: 1810 acc:0.84505 total_loss: 0.75333  loss:0.40774,stance loss: 0.35627 
Train step: 1820 acc:0.84198 total_loss: 0.75499  loss:0.46316,stance loss: 0.33501 
Train step: 1830 acc:0.84375 total_loss: 0.7438  loss:0.75595,stance loss: 0.71482 
Train step: 1840 acc:0.84871 total_loss: 0.72679  loss:0.24901,stance loss: 0.21617 
Train step: 1850 acc:0.85156 total_loss: 0.7208  loss:0.30153,stance loss: 0.17451 
Train step: 1860 acc:0.84932 total_loss: 0.72134  loss:0.51004,stance loss: 0.24553 
Train step: 1870 acc:0.84736 total_loss: 0.73083  loss:0.61374,stance loss: 0.46476 
Train step: 1880 acc:0.84526 total_loss: 0.73332  loss:1.0986,stance loss: 0.93887 
Train step: 1890 acc:0.84411 total_loss: 0.73689  loss:0.28678,stance loss: 0.10704 
Train step: 1900 acc:0.84207 total_loss: 0.74018  loss:1.2371,stance loss: 0.81521 
Train step: 1910 acc:0.84407 total_loss: 0.73563  loss:0.52578,stance loss: 0.50293 
Train step: 1920 acc:0.84375 total_loss: 0.73333  loss:0.87844,stance loss: 0.82374 
Train step: 1930 acc:0.84433 total_loss: 0.73033  loss:0.76925,stance loss: 0.58823 
Train step: 1940 acc:0.84652 total_loss: 0.71939  loss:0.45466,stance loss: 0.28295 
Train step: 1950 acc:0.8456 total_loss: 0.71921  loss:0.64584,stance loss: 0.59887 
Better F1! Saving model!
Saving model of best f1: 0.5095818676542703
              precision    recall  f1-score   support

           0   0.570261  0.682975  0.621549       511
           1   0.568627  0.341176  0.426471       170
           2   0.425532  0.373134  0.397614       268

    accuracy                       0.534247       949
   macro avg   0.521474  0.465762  0.481878       949
weighted avg   0.529097  0.534247  0.523364       949

Test Acc: 0.5342465753424658 F1_ma:0.5095818676542703
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.9375 total_loss: 1.0859  loss:1.0859,stance loss: 1.375 
Train step: 1970 acc:0.88068 total_loss: 0.59552  loss:0.2717,stance loss: 0.26057 
Train step: 1980 acc:0.87798 total_loss: 0.62532  loss:0.8353,stance loss: 0.8428 
Train step: 1990 acc:0.88105 total_loss: 0.64329  loss:0.64301,stance loss: 1.0599 
Train step: 2000 acc:0.88262 total_loss: 0.62602  loss:0.68045,stance loss: 0.32748 
Train step: 2010 acc:0.87623 total_loss: 0.61657  loss:1.3326,stance loss: 0.77199 
Train step: 2020 acc:0.86783 total_loss: 0.63649  loss:1.3359,stance loss: 1.7979 
Train step: 2030 acc:0.86268 total_loss: 0.64587  loss:0.93685,stance loss: 0.60537 
Train step: 2040 acc:0.8588 total_loss: 0.65452  loss:0.82132,stance loss: 0.81731 
Train step: 2050 acc:0.86126 total_loss: 0.64286  loss:0.36171,stance loss: 0.31979 
Train step: 2060 acc:0.86324 total_loss: 0.63685  loss:0.24466,stance loss: 0.13736 
Train step: 2070 acc:0.86543 total_loss: 0.6348  loss:0.46676,stance loss: 0.2366 
Train step: 2080 acc:0.86932 total_loss: 0.6283  loss:0.67546,stance loss: 0.60436 
Train step: 2090 acc:0.86689 total_loss: 0.63282  loss:0.35184,stance loss: 0.16106 
Train step: 2100 acc:0.86702 total_loss: 0.62455  loss:0.34088,stance loss: 0.19775 
Train step: 2110 acc:0.86838 total_loss: 0.61789  loss:0.47978,stance loss: 0.41204 
Train step: 2120 acc:0.86918 total_loss: 0.61322  loss:1.2242,stance loss: 1.5404 
Train step: 2130 acc:0.86915 total_loss: 0.61232  loss:0.97398,stance loss: 1.4209 
Train step: 2140 acc:0.87017 total_loss: 0.61043  loss:0.62793,stance loss: 0.48387 
Train step: 2150 acc:0.86878 total_loss: 0.62099  loss:0.28993,stance loss: 0.20806 
Train step: 2160 acc:0.87002 total_loss: 0.61928  loss:0.31746,stance loss: 0.25275 
Train step: 2170 acc:0.87204 total_loss: 0.61364  loss:0.50051,stance loss: 0.4507 
Train step: 2180 acc:0.87443 total_loss: 0.60601  loss:0.21731,stance loss: 0.0926 
Train step: 2190 acc:0.87284 total_loss: 0.61323  loss:0.40363,stance loss: 0.24199 
Train step: 2200 acc:0.87318 total_loss: 0.61052  loss:0.13666,stance loss: 0.035332 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.86458 total_loss: 0.61285  loss:0.61471,stance loss: 0.51041 
Train step: 2220 acc:0.90234 total_loss: 0.45961  loss:0.20117,stance loss: 0.12096 
Train step: 2230 acc:0.89663 total_loss: 0.51334  loss:0.88123,stance loss: 0.76084 
Train step: 2240 acc:0.90104 total_loss: 0.53779  loss:0.26937,stance loss: 0.12009 
Train step: 2250 acc:0.89538 total_loss: 0.54256  loss:0.43616,stance loss: 0.32651 
Train step: 2260 acc:0.90067 total_loss: 0.5197  loss:0.3586,stance loss: 0.338 
Train step: 2270 acc:0.89773 total_loss: 0.52721  loss:0.60409,stance loss: 0.47076 
Train step: 2280 acc:0.90132 total_loss: 0.52869  loss:0.36657,stance loss: 0.31392 
Train step: 2290 acc:0.90044 total_loss: 0.53023  loss:0.24732,stance loss: 0.18425 
Train step: 2300 acc:0.89909 total_loss: 0.53756  loss:0.38864,stance loss: 0.32456 
Train step: 2310 acc:0.90153 total_loss: 0.52378  loss:0.13726,stance loss: 0.062163 
Train step: 2320 acc:0.9014 total_loss: 0.52997  loss:0.36854,stance loss: 0.29217 
Train step: 2330 acc:0.90228 total_loss: 0.51728  loss:0.20277,stance loss: 0.19476 
Train step: 2340 acc:0.90303 total_loss: 0.5215  loss:0.96413,stance loss: 1.3262 
Train step: 2350 acc:0.90368 total_loss: 0.51575  loss:0.28675,stance loss: 0.18784 
Train step: 2360 acc:0.90304 total_loss: 0.51377  loss:0.5125,stance loss: 0.38688 
Train step: 2370 acc:0.90211 total_loss: 0.51879  loss:1.1328,stance loss: 0.95343 
Train step: 2380 acc:0.90163 total_loss: 0.5167  loss:0.5518,stance loss: 0.49918 
Train step: 2390 acc:0.90255 total_loss: 0.5126  loss:0.2121,stance loss: 0.076408 
Train step: 2400 acc:0.90115 total_loss: 0.51359  loss:0.4109,stance loss: 0.22428 
Train step: 2410 acc:0.90049 total_loss: 0.51499  loss:0.62191,stance loss: 0.52357 
Train step: 2420 acc:0.90191 total_loss: 0.51129  loss:0.57271,stance loss: 0.41035 
Train step: 2430 acc:0.90072 total_loss: 0.51116  loss:0.9105,stance loss: 1.2157 
Better F1! Saving model!
Saving model of best f1: 0.5104484599165451
              precision    recall  f1-score   support

           0   0.572123  0.690802  0.625887       511
           1   0.529412  0.370588  0.435986       170
           2   0.446009  0.354478  0.395010       268

    accuracy                       0.538462       949
   macro avg   0.515848  0.471956  0.485628       949
weighted avg   0.528857  0.538462  0.526669       949

Test Acc: 0.5384615384615384 F1_ma:0.5104484599165451
Train step: 2440 acc:0.89936 total_loss: 0.5098  loss:0.37785,stance loss: 0.39601 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.8125 total_loss: 0.75425  loss:0.75425,stance loss: 0.6669 
Train step: 2460 acc:0.90909 total_loss: 0.45846  loss:0.54575,stance loss: 0.45448 
Train step: 2470 acc:0.91369 total_loss: 0.51808  loss:0.35532,stance loss: 0.33456 
Train step: 2480 acc:0.90927 total_loss: 0.47233  loss:0.31819,stance loss: 0.22479 
Train step: 2490 acc:0.91463 total_loss: 0.46757  loss:0.16646,stance loss: 0.076442 
Train step: 2500 acc:0.91299 total_loss: 0.4757  loss:0.52186,stance loss: 0.3925 
Train step: 2510 acc:0.90881 total_loss: 0.47635  loss:0.31651,stance loss: 0.24907 
Train step: 2520 acc:0.90405 total_loss: 0.48191  loss:0.43923,stance loss: 0.28115 
Train step: 2530 acc:0.90741 total_loss: 0.46365  loss:0.33677,stance loss: 0.43784 
Train step: 2540 acc:0.90865 total_loss: 0.45154  loss:0.11465,stance loss: 0.057445 
Train step: 2550 acc:0.91089 total_loss: 0.4456  loss:0.15907,stance loss: 0.074515 
Train step: 2560 acc:0.91273 total_loss: 0.4462  loss:0.42748,stance loss: 0.40475 
Train step: 2570 acc:0.91271 total_loss: 0.44668  loss:0.12515,stance loss: 0.050086 
Train step: 2580 acc:0.91412 total_loss: 0.44584  loss:0.36681,stance loss: 0.28886 
Train step: 2590 acc:0.91534 total_loss: 0.44329  loss:0.38957,stance loss: 0.32465 
Train step: 2600 acc:0.91391 total_loss: 0.45226  loss:1.1563,stance loss: 1.5017 
Train step: 2610 acc:0.91382 total_loss: 0.4566  loss:0.80656,stance loss: 0.57861 
Train step: 2620 acc:0.91301 total_loss: 0.46298  loss:0.17886,stance loss: 0.084563 
Train step: 2630 acc:0.91126 total_loss: 0.46466  loss:0.53971,stance loss: 0.68565 
Train step: 2640 acc:0.91067 total_loss: 0.46555  loss:0.28642,stance loss: 0.10379 
Train step: 2650 acc:0.91045 total_loss: 0.46437  loss:0.50936,stance loss: 0.31691 
Train step: 2660 acc:0.91232 total_loss: 0.457  loss:0.61941,stance loss: 0.53502 
Train step: 2670 acc:0.91346 total_loss: 0.45477  loss:0.8115,stance loss: 1.2663 
Train step: 2680 acc:0.91369 total_loss: 0.4539  loss:0.71841,stance loss: 0.47175 
Train step: 2690 acc:0.9139 total_loss: 0.45036  loss:0.45753,stance loss: 0.25486 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.9375 total_loss: 0.31345  loss:0.34905,stance loss: 0.22584 
Train step: 2710 acc:0.9375 total_loss: 0.35429  loss:0.55171,stance loss: 0.39997 
Train step: 2720 acc:0.92788 total_loss: 0.39681  loss:0.14409,stance loss: 0.031424 
Train step: 2730 acc:0.93403 total_loss: 0.39375  loss:0.32046,stance loss: 0.3549 
Train step: 2740 acc:0.9375 total_loss: 0.38322  loss:0.75209,stance loss: 0.58324 
Train step: 2750 acc:0.93638 total_loss: 0.37088  loss:0.40053,stance loss: 0.43825 
Train step: 2760 acc:0.93371 total_loss: 0.37873  loss:0.60963,stance loss: 0.48647 
Train step: 2770 acc:0.93339 total_loss: 0.37091  loss:0.33677,stance loss: 0.31946 
Train step: 2780 acc:0.93241 total_loss: 0.36445  loss:0.050132,stance loss: 0.0064456 
Train step: 2790 acc:0.93229 total_loss: 0.37315  loss:0.32065,stance loss: 0.29851 
Train step: 2800 acc:0.92925 total_loss: 0.37828  loss:0.33643,stance loss: 0.31597 
Train step: 2810 acc:0.92672 total_loss: 0.39075  loss:0.59803,stance loss: 0.48493 
Train step: 2820 acc:0.9256 total_loss: 0.3911  loss:0.13712,stance loss: 0.078339 
Train step: 2830 acc:0.92601 total_loss: 0.39428  loss:0.98191,stance loss: 1.353 
Train step: 2840 acc:0.92723 total_loss: 0.38999  loss:0.37079,stance loss: 0.26638 
Train step: 2850 acc:0.92588 total_loss: 0.39661  loss:0.52227,stance loss: 0.43452 
Train step: 2860 acc:0.92658 total_loss: 0.39379  loss:0.5651,stance loss: 1.0137 
Train step: 2870 acc:0.92578 total_loss: 0.39003  loss:0.056087,stance loss: 0.015722 
Train step: 2880 acc:0.9244 total_loss: 0.39584  loss:0.53828,stance loss: 0.41183 
Train step: 2890 acc:0.92443 total_loss: 0.3916  loss:0.68686,stance loss: 0.69366 
Train step: 2900 acc:0.92415 total_loss: 0.39146  loss:0.77467,stance loss: 1.1661 
Train step: 2910 acc:0.92506 total_loss: 0.38664  loss:0.14362,stance loss: 0.09578 
Train step: 2920 acc:0.92561 total_loss: 0.38776  loss:0.33516,stance loss: 0.24647 
Train step: 2930 acc:0.92717 total_loss: 0.38273  loss:0.83253,stance loss: 0.76847 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:1.0 total_loss: 0.07981  loss:0.07981,stance loss: 0.027105 
Train step: 2950 acc:0.96023 total_loss: 0.25911  loss:0.64776,stance loss: 1.1438 
Train step: 2960 acc:0.94345 total_loss: 0.28684  loss:0.054464,stance loss: 0.017208 
Train step: 2970 acc:0.95363 total_loss: 0.27349  loss:0.14551,stance loss: 0.032707 
Train step: 2980 acc:0.95122 total_loss: 0.27784  loss:0.28046,stance loss: 0.2068 
Train step: 2990 acc:0.95221 total_loss: 0.29188  loss:0.58017,stance loss: 1.0434 
Train step: 3000 acc:0.94775 total_loss: 0.30327  loss:0.040352,stance loss: 0.011453 
Train step: 3010 acc:0.94366 total_loss: 0.3279  loss:0.72113,stance loss: 1.1181 
Train step: 3020 acc:0.94522 total_loss: 0.31419  loss:0.17982,stance loss: 0.1151 
Train step: 3030 acc:0.94299 total_loss: 0.32059  loss:0.097336,stance loss: 0.02382 
Train step: 3040 acc:0.94554 total_loss: 0.31036  loss:0.32375,stance loss: 0.37533 
Train step: 3050 acc:0.9482 total_loss: 0.29547  loss:0.10021,stance loss: 0.03556 
Train step: 3060 acc:0.94731 total_loss: 0.31078  loss:0.75097,stance loss: 0.56801 
Train step: 3070 acc:0.948 total_loss: 0.30699  loss:0.21038,stance loss: 0.16476 
Train step: 3080 acc:0.94814 total_loss: 0.30839  loss:0.89479,stance loss: 1.1308 
Train step: 3090 acc:0.94743 total_loss: 0.30581  loss:0.65342,stance loss: 1.0486 
Train step: 3100 acc:0.94915 total_loss: 0.29493  loss:0.10462,stance loss: 0.0262 
Train step: 3110 acc:0.94773 total_loss: 0.30179  loss:0.63436,stance loss: 1.0248 
Train step: 3120 acc:0.94613 total_loss: 0.30484  loss:0.39765,stance loss: 0.1826 
Train step: 3130 acc:0.94601 total_loss: 0.30889  loss:0.2682,stance loss: 0.25813 
Train step: 3140 acc:0.94558 total_loss: 0.30997  loss:0.53129,stance loss: 0.32065 
Train step: 3150 acc:0.94609 total_loss: 0.31165  loss:0.16155,stance loss: 0.12093 
Train step: 3160 acc:0.94683 total_loss: 0.30706  loss:0.26943,stance loss: 0.12197 
Train step: 3170 acc:0.94778 total_loss: 0.30365  loss:0.053803,stance loss: 0.00029501 
Train step: 3180 acc:0.9471 total_loss: 0.3038  loss:0.066742,stance loss: 0.026008 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.96875 total_loss: 0.21871  loss:0.071148,stance loss: 0.024765 
Train step: 3200 acc:0.97266 total_loss: 0.1873  loss:0.065279,stance loss: 0.031708 
Train step: 3210 acc:0.96394 total_loss: 0.21182  loss:0.054442,stance loss: 0.0083707 
Train step: 3220 acc:0.95312 total_loss: 0.24445  loss:0.42658,stance loss: 0.42563 
Train step: 3230 acc:0.95516 total_loss: 0.24474  loss:0.53506,stance loss: 0.35152 
Train step: 3240 acc:0.95982 total_loss: 0.24347  loss:0.041442,stance loss: 0.0086616 
Train step: 3250 acc:0.96307 total_loss: 0.23027  loss:0.45384,stance loss: 0.35244 
Train step: 3260 acc:0.96135 total_loss: 0.23732  loss:0.469,stance loss: 0.52288 
Train step: 3270 acc:0.95858 total_loss: 0.25692  loss:0.9328,stance loss: 1.3336 
Train step: 3280 acc:0.95573 total_loss: 0.26269  loss:0.11134,stance loss: 0.072999 
Train step: 3290 acc:0.95755 total_loss: 0.25745  loss:0.36891,stance loss: 0.37406 
Train step: 3300 acc:0.95851 total_loss: 0.24735  loss:0.10361,stance loss: 0.071186 
Train step: 3310 acc:0.96081 total_loss: 0.24035  loss:0.031305,stance loss: 0.0028042 
Train step: 3320 acc:0.96094 total_loss: 0.24296  loss:0.066378,stance loss: 0.014985 
Train step: 3330 acc:0.95976 total_loss: 0.24442  loss:0.23394,stance loss: 0.18465 
Train step: 3340 acc:0.95913 total_loss: 0.24516  loss:0.7308,stance loss: 1.0692 
Train step: 3350 acc:0.95896 total_loss: 0.2431  loss:0.10043,stance loss: 0.077432 
Train step: 3360 acc:0.95952 total_loss: 0.23967  loss:0.53576,stance loss: 0.58987 
Train step: 3370 acc:0.958 total_loss: 0.24329  loss:0.21967,stance loss: 0.10091 
Train step: 3380 acc:0.95759 total_loss: 0.24354  loss:1.1185,stance loss: 0.87355 
Train step: 3390 acc:0.95752 total_loss: 0.24268  loss:0.38495,stance loss: 0.22094 
Train step: 3400 acc:0.95602 total_loss: 0.24815  loss:0.31921,stance loss: 0.24922 
Train step: 3410 acc:0.95631 total_loss: 0.24665  loss:0.39294,stance loss: 0.23973 
Train step: 3420 acc:0.95763 total_loss: 0.24424  loss:0.58944,stance loss: 1.0368 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.9375 total_loss: 0.11847  loss:0.11847,stance loss: 0.042627 
Train step: 3440 acc:0.96023 total_loss: 0.15149  loss:0.41324,stance loss: 0.44394 
Train step: 3450 acc:0.96726 total_loss: 0.16226  loss:0.02496,stance loss: 0.0036676 
Train step: 3460 acc:0.96774 total_loss: 0.19628  loss:0.1423,stance loss: 0.10064 
Train step: 3470 acc:0.97104 total_loss: 0.18426  loss:0.065263,stance loss: 0.042066 
Train step: 3480 acc:0.97059 total_loss: 0.1986  loss:0.44578,stance loss: 0.36007 
Train step: 3490 acc:0.96619 total_loss: 0.20499  loss:0.076071,stance loss: 0.0098696 
Train step: 3500 acc:0.96831 total_loss: 0.20649  loss:0.078544,stance loss: 0.054647 
Train step: 3510 acc:0.96605 total_loss: 0.22103  loss:0.43906,stance loss: 0.50846 
Train step: 3520 acc:0.96703 total_loss: 0.21754  loss:0.68437,stance loss: 1.038 
Train step: 3530 acc:0.9672 total_loss: 0.21354  loss:0.039732,stance loss: 0.021838 
Train step: 3540 acc:0.96903 total_loss: 0.20512  loss:0.076918,stance loss: 0.020344 
Train step: 3550 acc:0.97004 total_loss: 0.20401  loss:0.48366,stance loss: 0.55796 
Train step: 3560 acc:0.97137 total_loss: 0.20192  loss:0.15635,stance loss: 0.1525 
Train step: 3570 acc:0.97163 total_loss: 0.2088  loss:0.53151,stance loss: 1.0089 
Train step: 3580 acc:0.97061 total_loss: 0.20443  loss:0.33815,stance loss: 0.15516 
Train step: 3590 acc:0.96972 total_loss: 0.19996  loss:0.34241,stance loss: 0.30042 
Train step: 3600 acc:0.96893 total_loss: 0.20398  loss:0.18007,stance loss: 0.19954 
Train step: 3610 acc:0.96651 total_loss: 0.20775  loss:0.15129,stance loss: 0.028074 
Train step: 3620 acc:0.96597 total_loss: 0.20725  loss:0.047072,stance loss: 0.022062 
Train step: 3630 acc:0.96642 total_loss: 0.20623  loss:0.14191,stance loss: 0.073449 
Train step: 3640 acc:0.96564 total_loss: 0.20588  loss:0.046552,stance loss: 0.0228 
Train step: 3650 acc:0.96578 total_loss: 0.20441  loss:0.10996,stance loss: 0.10983 
Train step: 3660 acc:0.96483 total_loss: 0.20583  loss:0.48353,stance loss: 0.28897 
Train step: 3670 acc:0.96525 total_loss: 0.20872  loss:0.65694,stance loss: 1.0846 
Training finished.


Reload the best model with best f1 0.5104484599165451 from path test_outputs/bert-cross-topic/fm/2023-08-14 18-56-05/state_dict


              precision    recall  f1-score   support

           0   0.572123  0.690802  0.625887       511
           1   0.529412  0.370588  0.435986       170
           2   0.446009  0.354478  0.395010       268

    accuracy                       0.538462       949
   macro avg   0.515848  0.471956  0.485628       949
weighted avg   0.528857  0.538462  0.526669       949

Test Acc: 0.5384615384615384 F1_ma:0.5104484599165451
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.5104484599165451
acc: 0.5384615384615384, f1 :0.48562769300088005
classification report: 
              precision    recall  f1-score   support

         Con     0.5721    0.6908    0.6259       511
        None     0.5294    0.3706    0.4360       170
         Pro     0.4460    0.3545    0.3950       268

    accuracy                         0.5385       949
   macro avg     0.5158    0.4720    0.4856       949
weighted avg     0.5289    0.5385    0.5267       949

run_semeval with seed: 31555
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 19-35-14', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31555, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 19-35-14
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.125 total_loss: 1.8372  loss:1.8372,stance loss: 1.0113 
Train step: 10 acc:0.27273 total_loss: 1.8639  loss:1.5613,stance loss: 0.98239 
Train step: 20 acc:0.28571 total_loss: 1.794  loss:1.4233,stance loss: 0.7718 
Train step: 30 acc:0.28831 total_loss: 1.7675  loss:1.6634,stance loss: 1.1791 
Better F1! Saving model!
Saving model of best f1: 0.2544014084507042
              precision    recall  f1-score   support

           0   0.462400  0.565558  0.508803       511
           1   0.058642  0.111765  0.076923       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.324552       949
   macro avg   0.173681  0.225774  0.195242       949
weighted avg   0.259490  0.324552  0.287750       949

Test Acc: 0.3245521601685985 F1_ma:0.2544014084507042
Train step: 40 acc:0.3186 total_loss: 1.7259  loss:1.6324,stance loss: 1.2026 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 50 acc:0.34559 total_loss: 1.724  loss:1.8646,stance loss: 1.7954 
Train step: 60 acc:0.37295 total_loss: 1.7023  loss:1.5494,stance loss: 1.1006 
Train step: 70 acc:0.38996 total_loss: 1.695  loss:1.7649,stance loss: 1.2704 
Train step: 80 acc:0.39738 total_loss: 1.6904  loss:1.2494,stance loss: 0.73354 
Train step: 90 acc:0.41346 total_loss: 1.6757  loss:1.4933,stance loss: 1.1347 
Train step: 100 acc:0.42079 total_loss: 1.6654  loss:1.4463,stance loss: 1.0321 
Train step: 110 acc:0.4223 total_loss: 1.6663  loss:1.6615,stance loss: 1.2114 
Train step: 120 acc:0.42924 total_loss: 1.6603  loss:1.4391,stance loss: 0.95508 
Train step: 130 acc:0.43702 total_loss: 1.6578  loss:1.6073,stance loss: 1.2906 
Train step: 140 acc:0.43883 total_loss: 1.6588  loss:1.7375,stance loss: 1.2684 
Train step: 150 acc:0.44329 total_loss: 1.6543  loss:1.5557,stance loss: 1.1129 
Train step: 160 acc:0.44915 total_loss: 1.6518  loss:1.6032,stance loss: 1.1748 
Train step: 170 acc:0.45541 total_loss: 1.6473  loss:1.5628,stance loss: 1.1454 
Train step: 180 acc:0.45891 total_loss: 1.6466  loss:1.2075,stance loss: 0.67584 
Train step: 190 acc:0.4627 total_loss: 1.6422  loss:1.5337,stance loss: 0.94644 
Train step: 200 acc:0.46828 total_loss: 1.6404  loss:1.2421,stance loss: 0.85166 
Train step: 210 acc:0.47186 total_loss: 1.6393  loss:1.6166,stance loss: 1.36 
Train step: 220 acc:0.47709 total_loss: 1.6358  loss:1.6507,stance loss: 1.222 
Train step: 230 acc:0.48133 total_loss: 1.6315  loss:1.8178,stance loss: 1.3049 
Train step: 240 acc:0.48548 total_loss: 1.6262  loss:1.8164,stance loss: 1.7692 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.5 total_loss: 1.6191  loss:1.4223,stance loss: 0.9453 
Train step: 260 acc:0.57812 total_loss: 1.5429  loss:1.5216,stance loss: 1.1641 
Train step: 270 acc:0.5625 total_loss: 1.5424  loss:1.6588,stance loss: 1.2331 
Train step: 280 acc:0.54861 total_loss: 1.5486  loss:1.6187,stance loss: 1.2115 
Train step: 290 acc:0.55163 total_loss: 1.5396  loss:1.5347,stance loss: 1.1532 
Train step: 300 acc:0.56362 total_loss: 1.524  loss:1.6825,stance loss: 1.7403 
Train step: 310 acc:0.57102 total_loss: 1.5129  loss:1.6625,stance loss: 1.2812 
Train step: 320 acc:0.56414 total_loss: 1.5267  loss:1.5782,stance loss: 1.1516 
Train step: 330 acc:0.56541 total_loss: 1.5286  loss:1.494,stance loss: 1.1344 
Train step: 340 acc:0.56641 total_loss: 1.5286  loss:1.2656,stance loss: 0.66814 
Train step: 350 acc:0.56545 total_loss: 1.527  loss:1.323,stance loss: 0.94008 
Train step: 360 acc:0.55927 total_loss: 1.5322  loss:1.4873,stance loss: 1.1224 
Better F1! Saving model!
Saving model of best f1: 0.3594018090869036
              precision    recall  f1-score   support

           0   0.547930  0.984344  0.703989       511
           1   0.586207  0.100000  0.170854       170
           2   1.000000  0.007463  0.014815       268

    accuracy                       0.550053       949
   macro avg   0.711379  0.363936  0.296553       949
weighted avg   0.682453  0.550053  0.413861       949

Test Acc: 0.5500526870389885 F1_ma:0.3594018090869036
Train step: 370 acc:0.56101 total_loss: 1.5275  loss:1.4323,stance loss: 1.1086 
Train step: 380 acc:0.56296 total_loss: 1.5275  loss:1.4298,stance loss: 1.0883 
Train step: 390 acc:0.56421 total_loss: 1.5212  loss:1.4592,stance loss: 0.99743 
Train step: 400 acc:0.56731 total_loss: 1.5171  loss:1.3828,stance loss: 1.0635 
Train step: 410 acc:0.56777 total_loss: 1.5133  loss:1.1615,stance loss: 0.74581 
Train step: 420 acc:0.56854 total_loss: 1.513  loss:1.8506,stance loss: 1.5702 
Train step: 430 acc:0.56653 total_loss: 1.517  loss:1.4426,stance loss: 1.0781 
Train step: 440 acc:0.5676 total_loss: 1.5147  loss:1.7007,stance loss: 1.6493 
Train step: 450 acc:0.56948 total_loss: 1.5096  loss:1.7243,stance loss: 1.6168 
Train step: 460 acc:0.57118 total_loss: 1.5035  loss:1.287,stance loss: 0.83487 
Train step: 470 acc:0.5755 total_loss: 1.5008  loss:1.7001,stance loss: 2.0916 
Train step: 480 acc:0.57601 total_loss: 1.4934  loss:1.559,stance loss: 1.4008 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.6875 total_loss: 1.2465  loss:1.2465,stance loss: 0.92203 
Train step: 500 acc:0.64205 total_loss: 1.3163  loss:0.91097,stance loss: 0.39716 
Train step: 510 acc:0.64881 total_loss: 1.2835  loss:1.1469,stance loss: 0.73713 
Train step: 520 acc:0.64718 total_loss: 1.2707  loss:1.2567,stance loss: 0.86692 
Train step: 530 acc:0.63262 total_loss: 1.2959  loss:1.1866,stance loss: 0.93193 
Train step: 540 acc:0.63235 total_loss: 1.2721  loss:1.3155,stance loss: 0.83836 
Train step: 550 acc:0.64037 total_loss: 1.2875  loss:1.3531,stance loss: 1.0624 
Train step: 560 acc:0.63292 total_loss: 1.2971  loss:1.4257,stance loss: 1.1001 
Train step: 570 acc:0.62963 total_loss: 1.2991  loss:1.6119,stance loss: 1.5932 
Train step: 580 acc:0.63805 total_loss: 1.2844  loss:0.74211,stance loss: 0.35811 
Train step: 590 acc:0.64356 total_loss: 1.2762  loss:1.0521,stance loss: 0.82737 
Train step: 600 acc:0.64077 total_loss: 1.2742  loss:1.0653,stance loss: 0.74803 
Train step: 610 acc:0.64824 total_loss: 1.2702  loss:1.2636,stance loss: 1.346 
Train step: 620 acc:0.64552 total_loss: 1.2651  loss:1.7045,stance loss: 1.498 
Train step: 630 acc:0.64583 total_loss: 1.2633  loss:1.0775,stance loss: 0.77636 
Train step: 640 acc:0.64942 total_loss: 1.2614  loss:1.0849,stance loss: 0.82722 
Train step: 650 acc:0.64713 total_loss: 1.2681  loss:1.3943,stance loss: 1.1133 
Train step: 660 acc:0.6473 total_loss: 1.2659  loss:1.4923,stance loss: 1.0809 
Train step: 670 acc:0.64675 total_loss: 1.2635  loss:1.412,stance loss: 1.2614 
Train step: 680 acc:0.64823 total_loss: 1.2619  loss:1.5689,stance loss: 1.2679 
Train step: 690 acc:0.64739 total_loss: 1.2651  loss:1.3478,stance loss: 0.89122 
Train step: 700 acc:0.64662 total_loss: 1.2648  loss:1.1657,stance loss: 0.81246 
Better F1! Saving model!
Saving model of best f1: 0.37148020848461377
              precision    recall  f1-score   support

           0   0.571093  0.951076  0.713656       511
           1   0.612903  0.335294  0.433460       170
           2   0.800000  0.014925  0.029304       268

    accuracy                       0.576396       949
   macro avg   0.661332  0.433765  0.392140       949
weighted avg   0.643227  0.576396  0.470200       949

Test Acc: 0.5763962065331928 F1_ma:0.37148020848461377
Train step: 710 acc:0.64678 total_loss: 1.2645  loss:1.5346,stance loss: 1.2175 
Train step: 720 acc:0.64692 total_loss: 1.2648  loss:0.97811,stance loss: 0.71821 
Train step: 730 acc:0.64782 total_loss: 1.259  loss:1.247,stance loss: 0.90706 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.64583 total_loss: 1.2032  loss:1.2308,stance loss: 0.85048 
Train step: 750 acc:0.67578 total_loss: 1.1915  loss:1.313,stance loss: 1.4647 
Train step: 760 acc:0.69952 total_loss: 1.1299  loss:1.0996,stance loss: 0.79653 
Train step: 770 acc:0.68229 total_loss: 1.145  loss:1.3018,stance loss: 1.0803 
Train step: 780 acc:0.67391 total_loss: 1.1531  loss:1.1138,stance loss: 0.76968 
Train step: 790 acc:0.67634 total_loss: 1.1491  loss:1.2917,stance loss: 1.0167 
Train step: 800 acc:0.67519 total_loss: 1.1618  loss:1.6096,stance loss: 1.5272 
Train step: 810 acc:0.68339 total_loss: 1.1611  loss:1.1414,stance loss: 0.87353 
Train step: 820 acc:0.68605 total_loss: 1.1646  loss:1.1143,stance loss: 0.85184 
Train step: 830 acc:0.68815 total_loss: 1.1713  loss:1.1771,stance loss: 1.3835 
Train step: 840 acc:0.68691 total_loss: 1.1711  loss:0.89614,stance loss: 0.68145 
Train step: 850 acc:0.68966 total_loss: 1.1697  loss:1.0622,stance loss: 0.7984 
Train step: 860 acc:0.68849 total_loss: 1.1674  loss:1.0723,stance loss: 0.8573 
Train step: 870 acc:0.68934 total_loss: 1.161  loss:1.1654,stance loss: 1.0055 
Train step: 880 acc:0.69307 total_loss: 1.1543  loss:0.82583,stance loss: 0.61189 
Train step: 890 acc:0.69351 total_loss: 1.151  loss:1.0582,stance loss: 0.94269 
Train step: 900 acc:0.69239 total_loss: 1.149  loss:1.4362,stance loss: 1.5622 
Train step: 910 acc:0.69425 total_loss: 1.1444  loss:1.1163,stance loss: 0.90045 
Train step: 920 acc:0.68985 total_loss: 1.1504  loss:1.3682,stance loss: 1.0654 
Train step: 930 acc:0.68878 total_loss: 1.1497  loss:1.1873,stance loss: 0.87885 
Train step: 940 acc:0.68811 total_loss: 1.1581  loss:1.491,stance loss: 1.1914 
Train step: 950 acc:0.69039 total_loss: 1.1519  loss:1.2389,stance loss: 1.1061 
Train step: 960 acc:0.69027 total_loss: 1.1483  loss:1.1009,stance loss: 0.91344 
Train step: 970 acc:0.69121 total_loss: 1.1468  loss:1.0753,stance loss: 0.92044 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.6875 total_loss: 0.77413  loss:0.77413,stance loss: 0.5377 
Train step: 990 acc:0.68182 total_loss: 1.0432  loss:1.0997,stance loss: 0.87903 
Better F1! Saving model!
Saving model of best f1: 0.4142132814427056
              precision    recall  f1-score   support

           0   0.606607  0.790607  0.686491       511
           1   0.506224  0.717647  0.593674       170
           2   0.523810  0.082090  0.141935       268

    accuracy                       0.577450       949
   macro avg   0.545547  0.530114  0.474034       949
weighted avg   0.565242  0.577450  0.516080       949

Test Acc: 0.5774499473129611 F1_ma:0.4142132814427056
Train step: 1000 acc:0.6875 total_loss: 1.0843  loss:1.1497,stance loss: 0.93587 
Train step: 1010 acc:0.70565 total_loss: 1.0652  loss:0.79854,stance loss: 0.49946 
Train step: 1020 acc:0.70732 total_loss: 1.0616  loss:1.6846,stance loss: 1.7224 
Train step: 1030 acc:0.71814 total_loss: 1.0485  loss:0.68608,stance loss: 0.48506 
Train step: 1040 acc:0.71824 total_loss: 1.0425  loss:0.82479,stance loss: 0.58937 
Train step: 1050 acc:0.72095 total_loss: 1.0513  loss:1.0595,stance loss: 1.307 
Train step: 1060 acc:0.72222 total_loss: 1.0472  loss:0.93199,stance loss: 0.68796 
Train step: 1070 acc:0.72596 total_loss: 1.0438  loss:0.95019,stance loss: 0.7599 
Train step: 1080 acc:0.71906 total_loss: 1.0552  loss:0.74035,stance loss: 0.43469 
Train step: 1090 acc:0.71565 total_loss: 1.0508  loss:1.1096,stance loss: 0.8102 
Train step: 1100 acc:0.71798 total_loss: 1.0501  loss:0.84885,stance loss: 0.56582 
Train step: 1110 acc:0.7166 total_loss: 1.0431  loss:1.2319,stance loss: 0.7203 
Train step: 1120 acc:0.71631 total_loss: 1.0524  loss:0.80953,stance loss: 0.66532 
Train step: 1130 acc:0.71523 total_loss: 1.0495  loss:1.3416,stance loss: 0.85463 
Train step: 1140 acc:0.71933 total_loss: 1.0447  loss:0.78143,stance loss: 0.52372 
Train step: 1150 acc:0.72149 total_loss: 1.0443  loss:1.0114,stance loss: 0.7527 
Train step: 1160 acc:0.7203 total_loss: 1.0465  loss:0.9437,stance loss: 0.64065 
Train step: 1170 acc:0.72186 total_loss: 1.0419  loss:0.89129,stance loss: 0.8286 
Train step: 1180 acc:0.72295 total_loss: 1.0391  loss:0.89149,stance loss: 0.71175 
Train step: 1190 acc:0.72512 total_loss: 1.0349  loss:0.87001,stance loss: 0.78198 
Train step: 1200 acc:0.72511 total_loss: 1.0345  loss:0.88021,stance loss: 0.74709 
Train step: 1210 acc:0.72267 total_loss: 1.0373  loss:1.1961,stance loss: 1.0743 
Train step: 1220 acc:0.72225 total_loss: 1.0385  loss:1.3462,stance loss: 1.6775 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.78125 total_loss: 0.95405  loss:0.93176,stance loss: 0.68781 
Train step: 1240 acc:0.80078 total_loss: 0.82132  loss:0.81517,stance loss: 0.59136 
Train step: 1250 acc:0.79087 total_loss: 0.84666  loss:0.55673,stance loss: 0.38677 
Train step: 1260 acc:0.77604 total_loss: 0.85799  loss:0.88002,stance loss: 0.64699 
Train step: 1270 acc:0.78125 total_loss: 0.88919  loss:0.90891,stance loss: 0.80271 
Train step: 1280 acc:0.77009 total_loss: 0.90268  loss:1.0342,stance loss: 0.76031 
Train step: 1290 acc:0.76705 total_loss: 0.91242  loss:0.74282,stance loss: 0.63352 
Better F1! Saving model!
Saving model of best f1: 0.42918103374333105
              precision    recall  f1-score   support

           0   0.599509  0.477495  0.531590       511
           1   0.450331  0.800000  0.576271       170
           2   0.345833  0.309701  0.326772       268

    accuracy                       0.487882       949
   macro avg   0.465224  0.529066  0.478211       949
weighted avg   0.501147  0.487882  0.481753       949

Test Acc: 0.48788198103266595 F1_ma:0.42918103374333105
Train step: 1300 acc:0.76809 total_loss: 0.92817  loss:1.1866,stance loss: 1.3814 
Train step: 1310 acc:0.76453 total_loss: 0.92794  loss:1.0564,stance loss: 0.80452 
Train step: 1320 acc:0.76107 total_loss: 0.93619  loss:0.97132,stance loss: 0.80222 
Train step: 1330 acc:0.75708 total_loss: 0.94267  loss:0.64319,stance loss: 0.44548 
Train step: 1340 acc:0.75808 total_loss: 0.94402  loss:0.92991,stance loss: 0.74932 
Train step: 1350 acc:0.76091 total_loss: 0.94011  loss:0.82196,stance loss: 0.63418 
Train step: 1360 acc:0.75965 total_loss: 0.94573  loss:0.7063,stance loss: 0.54315 
Train step: 1370 acc:0.76498 total_loss: 0.93589  loss:0.6838,stance loss: 0.56942 
Train step: 1380 acc:0.76042 total_loss: 0.93659  loss:1.156,stance loss: 0.74891 
Train step: 1390 acc:0.7613 total_loss: 0.93443  loss:0.52772,stance loss: 0.30805 
Train step: 1400 acc:0.76136 total_loss: 0.93485  loss:0.66319,stance loss: 0.57203 
Train step: 1410 acc:0.7584 total_loss: 0.94436  loss:1.2298,stance loss: 0.98071 
Train step: 1420 acc:0.7551 total_loss: 0.95096  loss:1.0924,stance loss: 0.79382 
Train step: 1430 acc:0.75728 total_loss: 0.94305  loss:0.80485,stance loss: 0.74946 
Train step: 1440 acc:0.75752 total_loss: 0.93938  loss:1.0363,stance loss: 0.72846 
Train step: 1450 acc:0.75664 total_loss: 0.94184  loss:1.0173,stance loss: 0.77631 
Train step: 1460 acc:0.7598 total_loss: 0.93598  loss:0.66454,stance loss: 0.51122 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.875 total_loss: 0.78011  loss:0.78011,stance loss: 0.66106 
Train step: 1480 acc:0.78409 total_loss: 0.85016  loss:0.98185,stance loss: 0.80422 
Train step: 1490 acc:0.77976 total_loss: 0.81082  loss:0.58041,stance loss: 0.45503 
Train step: 1500 acc:0.77823 total_loss: 0.87196  loss:1.3973,stance loss: 1.2037 
Train step: 1510 acc:0.77896 total_loss: 0.8452  loss:0.62831,stance loss: 0.51309 
Train step: 1520 acc:0.77941 total_loss: 0.84495  loss:0.59055,stance loss: 0.31107 
Train step: 1530 acc:0.78484 total_loss: 0.84779  loss:0.65725,stance loss: 0.40503 
Train step: 1540 acc:0.78521 total_loss: 0.8408  loss:0.63495,stance loss: 0.53195 
Train step: 1550 acc:0.78781 total_loss: 0.83419  loss:0.69559,stance loss: 0.3572 
Train step: 1560 acc:0.7919 total_loss: 0.82068  loss:0.67528,stance loss: 0.49386 
Train step: 1570 acc:0.79765 total_loss: 0.81966  loss:0.79218,stance loss: 0.61006 
Train step: 1580 acc:0.80236 total_loss: 0.81806  loss:1.2237,stance loss: 1.1043 
Train step: 1590 acc:0.80165 total_loss: 0.82739  loss:0.49817,stance loss: 0.37472 
Train step: 1600 acc:0.79723 total_loss: 0.83476  loss:1.3131,stance loss: 1.1322 
Train step: 1610 acc:0.80009 total_loss: 0.82844  loss:0.67184,stance loss: 0.46972 
Better F1! Saving model!
Saving model of best f1: 0.4303348483040644
              precision    recall  f1-score   support

           0   0.613953  0.774951  0.685121       511
           1   0.462451  0.688235  0.553191       170
           2   0.549020  0.104478  0.175549       268

    accuracy                       0.570074       949
   macro avg   0.541808  0.522555  0.471287       949
weighted avg   0.568476  0.570074  0.517583       949

Test Acc: 0.5700737618545838 F1_ma:0.4303348483040644
Train step: 1620 acc:0.79843 total_loss: 0.82829  loss:0.74697,stance loss: 0.58974 
Train step: 1630 acc:0.80008 total_loss: 0.82126  loss:0.63089,stance loss: 0.49692 
Train step: 1640 acc:0.80154 total_loss: 0.81806  loss:0.49872,stance loss: 0.42481 
Train step: 1650 acc:0.80145 total_loss: 0.81669  loss:0.53834,stance loss: 0.42342 
Train step: 1660 acc:0.80301 total_loss: 0.81375  loss:0.66864,stance loss: 0.54877 
Train step: 1670 acc:0.801 total_loss: 0.8171  loss:0.69302,stance loss: 0.40502 
Train step: 1680 acc:0.80154 total_loss: 0.82085  loss:1.4356,stance loss: 1.6536 
Train step: 1690 acc:0.80288 total_loss: 0.81663  loss:0.70962,stance loss: 0.51157 
Better F1! Saving model!
Saving model of best f1: 0.4368367207080201
              precision    recall  f1-score   support

           0   0.621832  0.624266  0.623047       511
           1   0.439344  0.788235  0.564211       170
           2   0.381679  0.186567  0.250627       268

    accuracy                       0.530032       949
   macro avg   0.480952  0.533023  0.479295       949
weighted avg   0.521322  0.530032  0.507335       949

Test Acc: 0.530031612223393 F1_ma:0.4368367207080201
Train step: 1700 acc:0.80222 total_loss: 0.82004  loss:1.0273,stance loss: 1.0967 
Train step: 1710 acc:0.8029 total_loss: 0.82138  loss:0.48703,stance loss: 0.40149 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.80208 total_loss: 1.1532  loss:1.5184,stance loss: 1.7575 
Train step: 1730 acc:0.83203 total_loss: 0.85267  loss:0.58416,stance loss: 0.56537 
Train step: 1740 acc:0.85096 total_loss: 0.78797  loss:0.87021,stance loss: 0.71184 
Train step: 1750 acc:0.84896 total_loss: 0.7434  loss:0.55065,stance loss: 0.42229 
Train step: 1760 acc:0.84103 total_loss: 0.72731  loss:0.4531,stance loss: 0.34595 
Train step: 1770 acc:0.8404 total_loss: 0.73  loss:0.71744,stance loss: 0.57501 
Train step: 1780 acc:0.84091 total_loss: 0.73138  loss:0.99684,stance loss: 1.4 
Better F1! Saving model!
Saving model of best f1: 0.4376611166712159
              precision    recall  f1-score   support

           0   0.607029  0.743640  0.668426       511
           1   0.460905  0.658824  0.542373       170
           2   0.450000  0.134328  0.206897       268

    accuracy                       0.556375       949
   macro avg   0.505978  0.512264  0.472565       949
weighted avg   0.536507  0.556375  0.515508       949

Test Acc: 0.5563751317175974 F1_ma:0.4376611166712159
Train step: 1790 acc:0.84293 total_loss: 0.72865  loss:0.79483,stance loss: 0.64551 
Train step: 1800 acc:0.84302 total_loss: 0.71844  loss:0.53211,stance loss: 0.44563 
Train step: 1810 acc:0.8431 total_loss: 0.71954  loss:0.66981,stance loss: 0.65261 
Train step: 1820 acc:0.84198 total_loss: 0.73722  loss:0.91187,stance loss: 0.76669 
Train step: 1830 acc:0.84213 total_loss: 0.72804  loss:0.47643,stance loss: 0.11705 
Better F1! Saving model!
Saving model of best f1: 0.4386034186651696
              precision    recall  f1-score   support

           0   0.607914  0.661448  0.633552       511
           1   0.453184  0.711765  0.553776       170
           2   0.380952  0.179104  0.243655       268

    accuracy                       0.534247       949
   macro avg   0.480683  0.517439  0.476994       949
weighted avg   0.516101  0.534247  0.509153       949

Test Acc: 0.5342465753424658 F1_ma:0.4386034186651696
Train step: 1840 acc:0.83929 total_loss: 0.72301  loss:0.85197,stance loss: 0.63697 
Train step: 1850 acc:0.84053 total_loss: 0.71295  loss:1.031,stance loss: 0.99509 
Train step: 1860 acc:0.83604 total_loss: 0.71684  loss:0.84355,stance loss: 0.76273 
Train step: 1870 acc:0.83734 total_loss: 0.713  loss:0.65257,stance loss: 0.58885 
Train step: 1880 acc:0.83509 total_loss: 0.71991  loss:0.86495,stance loss: 0.68394 
Train step: 1890 acc:0.83558 total_loss: 0.7163  loss:0.64451,stance loss: 0.54765 
Better F1! Saving model!
Saving model of best f1: 0.45366498437875513
              precision    recall  f1-score   support

           0   0.597378  0.624266  0.610526       511
           1   0.461224  0.664706  0.544578       170
           2   0.382353  0.242537  0.296804       268

    accuracy                       0.523709       949
   macro avg   0.480319  0.510503  0.483969       949
weighted avg   0.512265  0.523709  0.510117       949

Test Acc: 0.523709167544784 F1_ma:0.45366498437875513
Train step: 1900 acc:0.83434 total_loss: 0.72492  loss:1.1883,stance loss: 1.3697 
Train step: 1910 acc:0.83482 total_loss: 0.72397  loss:0.73635,stance loss: 0.47961 
Train step: 1920 acc:0.83647 total_loss: 0.71966  loss:0.54657,stance loss: 0.40101 
Train step: 1930 acc:0.83796 total_loss: 0.72043  loss:0.9069,stance loss: 0.80078 
Train step: 1940 acc:0.83767 total_loss: 0.72157  loss:0.84946,stance loss: 0.6519 
Train step: 1950 acc:0.83872 total_loss: 0.72325  loss:0.48653,stance loss: 0.38923 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.75 total_loss: 0.7661  loss:0.7661,stance loss: 0.55276 
Train step: 1970 acc:0.875 total_loss: 0.56339  loss:0.33815,stance loss: 0.20884 
Train step: 1980 acc:0.875 total_loss: 0.54253  loss:0.44225,stance loss: 0.2797 
Train step: 1990 acc:0.875 total_loss: 0.58911  loss:1.1124,stance loss: 1.4539 
Train step: 2000 acc:0.88415 total_loss: 0.55506  loss:0.39705,stance loss: 0.35705 
Train step: 2010 acc:0.88235 total_loss: 0.56769  loss:0.4467,stance loss: 0.34048 
Train step: 2020 acc:0.88525 total_loss: 0.55904  loss:0.43871,stance loss: 0.43295 
Train step: 2030 acc:0.88292 total_loss: 0.57243  loss:0.30884,stance loss: 0.20685 
Train step: 2040 acc:0.88117 total_loss: 0.57861  loss:1.1002,stance loss: 0.93849 
Train step: 2050 acc:0.88118 total_loss: 0.5848  loss:0.75427,stance loss: 0.56574 
Train step: 2060 acc:0.87995 total_loss: 0.58386  loss:0.59761,stance loss: 0.48423 
Train step: 2070 acc:0.87782 total_loss: 0.5783  loss:0.62107,stance loss: 0.471 
Train step: 2080 acc:0.87552 total_loss: 0.58647  loss:0.47432,stance loss: 0.44635 
Train step: 2090 acc:0.875 total_loss: 0.58589  loss:0.52139,stance loss: 0.4024 
Train step: 2100 acc:0.8719 total_loss: 0.58967  loss:0.32642,stance loss: 0.21775 
Train step: 2110 acc:0.86921 total_loss: 0.59852  loss:0.47709,stance loss: 0.35639 
Train step: 2120 acc:0.86801 total_loss: 0.59407  loss:0.47934,stance loss: 0.39243 
Train step: 2130 acc:0.86988 total_loss: 0.58835  loss:0.62121,stance loss: 0.63492 
Train step: 2140 acc:0.87258 total_loss: 0.5799  loss:0.29435,stance loss: 0.14449 
Train step: 2150 acc:0.87238 total_loss: 0.58515  loss:0.94556,stance loss: 1.337 
Train step: 2160 acc:0.87407 total_loss: 0.58477  loss:1.2976,stance loss: 1.5214 
Train step: 2170 acc:0.87263 total_loss: 0.58651  loss:1.345,stance loss: 1.0922 
Train step: 2180 acc:0.87217 total_loss: 0.5906  loss:0.72429,stance loss: 0.49233 
Better F1! Saving model!
Saving model of best f1: 0.45656764377991993
              precision    recall  f1-score   support

           0   0.606870  0.622309  0.614493       511
           1   0.450199  0.664706  0.536817       170
           2   0.379310  0.246269  0.298643       268

    accuracy                       0.523709       949
   macro avg   0.478793  0.511095  0.483317       949
weighted avg   0.514541  0.523709  0.511381       949

Test Acc: 0.523709167544784 F1_ma:0.45656764377991993
Train step: 2190 acc:0.87148 total_loss: 0.59155  loss:0.5661,stance loss: 0.44957 
Train step: 2200 acc:0.87318 total_loss: 0.58609  loss:0.34718,stance loss: 0.23556 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.90625 total_loss: 0.36093  loss:0.35056,stance loss: 0.23294 
Train step: 2220 acc:0.89453 total_loss: 0.49122  loss:1.1922,stance loss: 1.6618 
Train step: 2230 acc:0.89183 total_loss: 0.56111  loss:0.57118,stance loss: 0.58807 
Train step: 2240 acc:0.89236 total_loss: 0.57336  loss:0.56824,stance loss: 0.44971 
Train step: 2250 acc:0.8981 total_loss: 0.53246  loss:0.14177,stance loss: 0.086366 
Train step: 2260 acc:0.89621 total_loss: 0.53878  loss:0.65135,stance loss: 1.0429 
Train step: 2270 acc:0.89394 total_loss: 0.54248  loss:0.88636,stance loss: 0.68652 
Train step: 2280 acc:0.8972 total_loss: 0.5395  loss:0.64583,stance loss: 0.55298 
Train step: 2290 acc:0.88953 total_loss: 0.55306  loss:1.1215,stance loss: 1.4617 
Train step: 2300 acc:0.89258 total_loss: 0.53992  loss:0.16871,stance loss: 0.067885 
Train step: 2310 acc:0.88974 total_loss: 0.55263  loss:0.98866,stance loss: 1.4039 
Train step: 2320 acc:0.88847 total_loss: 0.54784  loss:0.5741,stance loss: 0.45693 
Better F1! Saving model!
Saving model of best f1: 0.4588420908217863
              precision    recall  f1-score   support

           0   0.619217  0.681018  0.648649       511
           1   0.444444  0.682353  0.538283       170
           2   0.420635  0.197761  0.269036       268

    accuracy                       0.544784       949
   macro avg   0.494765  0.520377  0.485322       949
weighted avg   0.531829  0.544784  0.521675       949

Test Acc: 0.5447839831401475 F1_ma:0.4588420908217863
Train step: 2330 acc:0.88542 total_loss: 0.56205  loss:1.0332,stance loss: 1.4295 
Train step: 2340 acc:0.88741 total_loss: 0.55865  loss:0.60742,stance loss: 0.58888 
Train step: 2350 acc:0.88784 total_loss: 0.55322  loss:0.52056,stance loss: 0.37158 
Train step: 2360 acc:0.88902 total_loss: 0.55085  loss:0.4082,stance loss: 0.33346 
Train step: 2370 acc:0.89081 total_loss: 0.54492  loss:0.77274,stance loss: 1.211 
Train step: 2380 acc:0.89062 total_loss: 0.54059  loss:0.21314,stance loss: 0.065566 
Train step: 2390 acc:0.89214 total_loss: 0.53911  loss:0.3669,stance loss: 0.22266 
Train step: 2400 acc:0.89254 total_loss: 0.53973  loss:0.57556,stance loss: 0.54144 
Train step: 2410 acc:0.8932 total_loss: 0.53761  loss:0.15765,stance loss: 0.060637 
Train step: 2420 acc:0.89381 total_loss: 0.53501  loss:0.81764,stance loss: 1.2224 
Train step: 2430 acc:0.8927 total_loss: 0.53852  loss:0.65038,stance loss: 1.0614 
Train step: 2440 acc:0.89274 total_loss: 0.53644  loss:0.58963,stance loss: 0.54276 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.8125 total_loss: 0.87406  loss:0.87406,stance loss: 0.64877 
Train step: 2460 acc:0.85227 total_loss: 0.63544  loss:0.77278,stance loss: 1.1265 
Train step: 2470 acc:0.8869 total_loss: 0.5535  loss:0.17328,stance loss: 0.051878 
Train step: 2480 acc:0.89919 total_loss: 0.5472  loss:0.69794,stance loss: 1.0818 
Train step: 2490 acc:0.90549 total_loss: 0.51053  loss:0.53242,stance loss: 0.42899 
Train step: 2500 acc:0.91299 total_loss: 0.47586  loss:0.26936,stance loss: 0.22304 
Train step: 2510 acc:0.91701 total_loss: 0.45557  loss:0.31997,stance loss: 0.31008 
Train step: 2520 acc:0.92165 total_loss: 0.45409  loss:0.21595,stance loss: 0.19412 
Train step: 2530 acc:0.92593 total_loss: 0.44043  loss:0.30047,stance loss: 0.29765 
Train step: 2540 acc:0.92102 total_loss: 0.44835  loss:0.46961,stance loss: 0.20007 
Train step: 2550 acc:0.91832 total_loss: 0.46576  loss:0.34245,stance loss: 0.27595 
Train step: 2560 acc:0.9161 total_loss: 0.4731  loss:0.6154,stance loss: 0.48747 
Train step: 2570 acc:0.91529 total_loss: 0.46955  loss:0.51874,stance loss: 0.46301 
Train step: 2580 acc:0.91317 total_loss: 0.4726  loss:0.45832,stance loss: 0.29648 
Train step: 2590 acc:0.91268 total_loss: 0.47187  loss:0.67163,stance loss: 0.64536 
Train step: 2600 acc:0.91515 total_loss: 0.4687  loss:0.62981,stance loss: 0.53738 
Train step: 2610 acc:0.9146 total_loss: 0.4617  loss:0.2094,stance loss: 0.16668 
Train step: 2620 acc:0.91411 total_loss: 0.46424  loss:0.7003,stance loss: 1.1398 
Train step: 2630 acc:0.91644 total_loss: 0.4556  loss:0.27705,stance loss: 0.15478 
Train step: 2640 acc:0.91754 total_loss: 0.4544  loss:0.26351,stance loss: 0.22421 
Train step: 2650 acc:0.9176 total_loss: 0.44867  loss:0.27344,stance loss: 0.19793 
Train step: 2660 acc:0.91854 total_loss: 0.44523  loss:0.24258,stance loss: 0.076079 
Train step: 2670 acc:0.9177 total_loss: 0.44683  loss:0.35815,stance loss: 0.389 
Train step: 2680 acc:0.91775 total_loss: 0.4433  loss:0.33213,stance loss: 0.22999 
Train step: 2690 acc:0.91598 total_loss: 0.4504  loss:0.42311,stance loss: 0.31401 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.90625 total_loss: 0.56094  loss:0.21486,stance loss: 0.10389 
Train step: 2710 acc:0.92969 total_loss: 0.39206  loss:0.27928,stance loss: 0.16848 
Train step: 2720 acc:0.93269 total_loss: 0.35019  loss:0.091947,stance loss: 0.025903 
Train step: 2730 acc:0.93576 total_loss: 0.36987  loss:0.52869,stance loss: 0.42289 
Train step: 2740 acc:0.93342 total_loss: 0.36726  loss:0.5784,stance loss: 0.60223 
Train step: 2750 acc:0.93862 total_loss: 0.34094  loss:0.12267,stance loss: 0.055461 
Train step: 2760 acc:0.94129 total_loss: 0.33411  loss:0.67479,stance loss: 0.4382 
Train step: 2770 acc:0.94079 total_loss: 0.34615  loss:0.27405,stance loss: 0.19761 
Train step: 2780 acc:0.93605 total_loss: 0.35478  loss:1.1488,stance loss: 1.4469 
Train step: 2790 acc:0.93424 total_loss: 0.36169  loss:0.21606,stance loss: 0.18791 
Train step: 2800 acc:0.9316 total_loss: 0.37201  loss:0.63081,stance loss: 0.61047 
Train step: 2810 acc:0.93211 total_loss: 0.37249  loss:0.78272,stance loss: 1.088 
Train step: 2820 acc:0.93452 total_loss: 0.37015  loss:0.87054,stance loss: 0.82167 
Train step: 2830 acc:0.93566 total_loss: 0.36178  loss:0.66215,stance loss: 1.0495 
Train step: 2840 acc:0.9345 total_loss: 0.36489  loss:0.18953,stance loss: 0.13197 
Train step: 2850 acc:0.93269 total_loss: 0.37356  loss:0.13304,stance loss: 0.029911 
Train step: 2860 acc:0.93185 total_loss: 0.37607  loss:0.43944,stance loss: 0.30877 
Train step: 2870 acc:0.93146 total_loss: 0.37836  loss:0.085122,stance loss: 0.058333 
Train step: 2880 acc:0.93044 total_loss: 0.37789  loss:0.25348,stance loss: 0.2432 
Train step: 2890 acc:0.93017 total_loss: 0.3775  loss:0.30524,stance loss: 0.18582 
Train step: 2900 acc:0.93204 total_loss: 0.36894  loss:0.13177,stance loss: 0.010742 
Train step: 2910 acc:0.93229 total_loss: 0.37253  loss:0.072037,stance loss: 0.016117 
Train step: 2920 acc:0.9328 total_loss: 0.37799  loss:0.33805,stance loss: 0.41865 
Train step: 2930 acc:0.93565 total_loss: 0.36958  loss:0.061665,stance loss: 0.0043854 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:0.9375 total_loss: 0.30393  loss:0.30393,stance loss: 0.21563 
Train step: 2950 acc:0.97159 total_loss: 0.25238  loss:0.33155,stance loss: 0.25482 
Train step: 2960 acc:0.97917 total_loss: 0.23443  loss:0.19279,stance loss: 0.16786 
Train step: 2970 acc:0.96774 total_loss: 0.26058  loss:0.18498,stance loss: 0.090471 
Train step: 2980 acc:0.96951 total_loss: 0.25708  loss:0.16098,stance loss: 0.12782 
Train step: 2990 acc:0.96936 total_loss: 0.2679  loss:0.21609,stance loss: 0.14597 
Train step: 3000 acc:0.96824 total_loss: 0.26588  loss:0.048179,stance loss: 0.0034469 
Train step: 3010 acc:0.96831 total_loss: 0.26806  loss:0.14018,stance loss: 0.095202 
Train step: 3020 acc:0.96682 total_loss: 0.2729  loss:0.41451,stance loss: 0.45631 
Train step: 3030 acc:0.96635 total_loss: 0.26281  loss:0.082936,stance loss: 0.040799 
Train step: 3040 acc:0.96225 total_loss: 0.27942  loss:0.80414,stance loss: 1.1677 
Train step: 3050 acc:0.96059 total_loss: 0.27506  loss:0.088472,stance loss: 0.047748 
Train step: 3060 acc:0.95816 total_loss: 0.28327  loss:0.66177,stance loss: 0.29485 
Train step: 3070 acc:0.95658 total_loss: 0.28911  loss:0.87379,stance loss: 1.07 
Train step: 3080 acc:0.957 total_loss: 0.28882  loss:0.62105,stance loss: 1.0423 
Train step: 3090 acc:0.95364 total_loss: 0.29164  loss:0.40438,stance loss: 0.41313 
Train step: 3100 acc:0.95419 total_loss: 0.29199  loss:0.15069,stance loss: 0.083499 
Train step: 3110 acc:0.95468 total_loss: 0.28615  loss:0.12358,stance loss: 0.061248 
Train step: 3120 acc:0.95269 total_loss: 0.28898  loss:0.30982,stance loss: 0.20322 
Train step: 3130 acc:0.95255 total_loss: 0.28622  loss:0.11376,stance loss: 0.096395 
Train step: 3140 acc:0.95305 total_loss: 0.28068  loss:0.11755,stance loss: 0.10732 
Train step: 3150 acc:0.95231 total_loss: 0.28353  loss:0.14134,stance loss: 0.086872 
Train step: 3160 acc:0.95023 total_loss: 0.28826  loss:0.18339,stance loss: 0.11229 
Train step: 3170 acc:0.94886 total_loss: 0.29403  loss:0.22822,stance loss: 0.22274 
Train step: 3180 acc:0.94761 total_loss: 0.29945  loss:0.37114,stance loss: 0.35134 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.96875 total_loss: 0.18848  loss:0.065321,stance loss: 0.032026 
Train step: 3200 acc:0.96094 total_loss: 0.25467  loss:0.19888,stance loss: 0.11376 
Better F1! Saving model!
Saving model of best f1: 0.4615049656226128
              precision    recall  f1-score   support

           0   0.626486  0.722114  0.670909       511
           1   0.464945  0.741176  0.571429       170
           2   0.505618  0.167910  0.252101       268

    accuracy                       0.569020       949
   macro avg   0.532349  0.543733  0.498146       949
weighted avg   0.563414  0.569020  0.534816       949

Test Acc: 0.5690200210748156 F1_ma:0.4615049656226128
Train step: 3210 acc:0.95673 total_loss: 0.31502  loss:0.064443,stance loss: 0.023733 
Train step: 3220 acc:0.9566 total_loss: 0.29165  loss:0.17179,stance loss: 0.13849 
Train step: 3230 acc:0.96603 total_loss: 0.26574  loss:0.15923,stance loss: 0.11736 
Train step: 3240 acc:0.96317 total_loss: 0.28306  loss:0.13802,stance loss: 0.085996 
Train step: 3250 acc:0.96212 total_loss: 0.28855  loss:0.61942,stance loss: 0.44203 
Train step: 3260 acc:0.96299 total_loss: 0.28438  loss:0.037219,stance loss: 0.0060809 
Train step: 3270 acc:0.96148 total_loss: 0.28463  loss:0.091904,stance loss: 0.083701 
Train step: 3280 acc:0.95898 total_loss: 0.2884  loss:0.21014,stance loss: 0.11042 
Train step: 3290 acc:0.95814 total_loss: 0.281  loss:0.10701,stance loss: 0.10605 
Train step: 3300 acc:0.95851 total_loss: 0.28749  loss:0.0886,stance loss: 0.075448 
Train step: 3310 acc:0.96032 total_loss: 0.27839  loss:0.04882,stance loss: 0.0032056 
Train step: 3320 acc:0.96048 total_loss: 0.28286  loss:0.091206,stance loss: 0.040712 
Train step: 3330 acc:0.96062 total_loss: 0.28405  loss:0.11483,stance loss: 0.072676 
Train step: 3340 acc:0.96154 total_loss: 0.28135  loss:0.080658,stance loss: 0.04388 
Train step: 3350 acc:0.95971 total_loss: 0.2803  loss:0.37733,stance loss: 0.4008 
Train step: 3360 acc:0.96094 total_loss: 0.27689  loss:0.037322,stance loss: 0.0034703 
Better F1! Saving model!
Saving model of best f1: 0.4662775517639201
              precision    recall  f1-score   support

           0   0.639155  0.651663  0.645349       511
           1   0.412141  0.758824  0.534161       170
           2   0.478261  0.205224  0.287206       268

    accuracy                       0.544784       949
   macro avg   0.509852  0.538570  0.488906       949
weighted avg   0.553052  0.544784  0.524291       949

Test Acc: 0.5447839831401475 F1_ma:0.4662775517639201
Train step: 3370 acc:0.96136 total_loss: 0.28278  loss:0.17639,stance loss: 0.10112 
Train step: 3380 acc:0.96173 total_loss: 0.27979  loss:0.07756,stance loss: 0.044984 
Train step: 3390 acc:0.96025 total_loss: 0.28693  loss:0.18358,stance loss: 0.11617 
Train step: 3400 acc:0.95949 total_loss: 0.28673  loss:0.48275,stance loss: 0.20953 
Train step: 3410 acc:0.95935 total_loss: 0.28279  loss:0.21824,stance loss: 0.16853 
Train step: 3420 acc:0.95842 total_loss: 0.28341  loss:0.62299,stance loss: 0.48661 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:1.0 total_loss: 0.051927  loss:0.051927,stance loss: 0.018969 
Train step: 3440 acc:0.97159 total_loss: 0.21634  loss:0.061627,stance loss: 0.03472 
Train step: 3450 acc:0.97024 total_loss: 0.20593  loss:0.099321,stance loss: 0.033732 
Train step: 3460 acc:0.96573 total_loss: 0.22023  loss:0.047307,stance loss: 0.0066776 
Train step: 3470 acc:0.96494 total_loss: 0.19885  loss:0.24326,stance loss: 0.096018 
Train step: 3480 acc:0.96936 total_loss: 0.179  loss:0.060944,stance loss: 0.020654 
Train step: 3490 acc:0.96824 total_loss: 0.1781  loss:0.16451,stance loss: 0.13648 
Train step: 3500 acc:0.96743 total_loss: 0.1934  loss:0.051668,stance loss: 0.013276 
Train step: 3510 acc:0.96836 total_loss: 0.18804  loss:0.17524,stance loss: 0.089038 
Train step: 3520 acc:0.96841 total_loss: 0.19252  loss:0.55803,stance loss: 1.0132 
Train step: 3530 acc:0.9703 total_loss: 0.19657  loss:0.53974,stance loss: 1.0097 
Train step: 3540 acc:0.97072 total_loss: 0.20865  loss:0.069587,stance loss: 0.046571 
Train step: 3550 acc:0.96901 total_loss: 0.22152  loss:0.14606,stance loss: 0.10394 
Train step: 3560 acc:0.96899 total_loss: 0.22686  loss:0.62143,stance loss: 0.33144 
Train step: 3570 acc:0.97074 total_loss: 0.2162  loss:0.030496,stance loss: 0.0048215 
Train step: 3580 acc:0.96978 total_loss: 0.21598  loss:0.19539,stance loss: 0.15121 
Train step: 3590 acc:0.96894 total_loss: 0.2202  loss:0.78042,stance loss: 0.58415 
Train step: 3600 acc:0.96857 total_loss: 0.22118  loss:0.079233,stance loss: 0.032259 
Train step: 3610 acc:0.96685 total_loss: 0.22596  loss:0.14951,stance loss: 0.15987 
Train step: 3620 acc:0.9663 total_loss: 0.22407  loss:0.11481,stance loss: 0.069052 
Train step: 3630 acc:0.96735 total_loss: 0.22046  loss:0.12995,stance loss: 0.04418 
Train step: 3640 acc:0.96682 total_loss: 0.22385  loss:0.034841,stance loss: 0.002172 
Train step: 3650 acc:0.96719 total_loss: 0.22209  loss:0.60785,stance loss: 1.0388 
Train step: 3660 acc:0.96618 total_loss: 0.23287  loss:0.040235,stance loss: 0.011863 
Train step: 3670 acc:0.96577 total_loss: 0.23565  loss:0.06986,stance loss: 0.033153 
Training finished.


Reload the best model with best f1 0.4662775517639201 from path test_outputs/bert-cross-topic/fm/2023-08-14 19-35-14/state_dict


              precision    recall  f1-score   support

           0   0.639155  0.651663  0.645349       511
           1   0.412141  0.758824  0.534161       170
           2   0.478261  0.205224  0.287206       268

    accuracy                       0.544784       949
   macro avg   0.509852  0.538570  0.488906       949
weighted avg   0.553052  0.544784  0.524291       949

Test Acc: 0.5447839831401475 F1_ma:0.4662775517639201
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.4662775517639201
acc: 0.5447839831401475, f1 :0.48890553140369003
classification report: 
              precision    recall  f1-score   support

         Con     0.6392    0.6517    0.6453       511
        None     0.4121    0.7588    0.5342       170
         Pro     0.4783    0.2052    0.2872       268

    accuracy                         0.5448       949
   macro avg     0.5099    0.5386    0.4889       949
weighted avg     0.5531    0.5448    0.5243       949

run_semeval with seed: 31556
Namespace(alpha=0.8, att_heads='4,4', batch_size=16, bert_dim=768, beta=1.2, cluster_times=1, dataset='fm', dataset_files={'train': './datasets/o_fm', 'test': './datasets/fm'}, dev_dir='./datasets/fm', device=device(type='cuda'), dp=0.1, dropout=0.1, embed_dim=300, epochs=15, eval_batch_size=16, eval_steps=10, feature_dim=256, gnn_dims='192,192', hidden_dim=128, initializer='xavier_uniform_', input_features=['concat_bert_indices', 'concat_segments_indices'], l2reg=1e-05, log_path='./log', log_step=10, lr=5e-06, max_seq_len=85, model_class=<class 'models.bert_scl.BERT_SCL'>, model_name='bert-cross-topic', n_gpus=1, num_labels=3, optim_class=<class 'torch.optim.adam.Adam'>, optimizer='adam', output_dim=64, output_dir='test_outputs/bert-cross-topic/fm/2023-08-14 20-14-02', output_par_dir='test_outputs', polarities=[0, 1, 2], pretrained_bert_name='bert-base-uncased', prototype_loss_weight=0.01, relation_dim=100, seed=31556, stance_loss_weight=0.5, temperature=0.07, test_dir='./datasets/fm', train_dir='./datasets/o_fm', type=0)
using model:  bert-cross-topic
running dataset:  fm
output_dir:  test_outputs/bert-cross-topic/fm/2023-08-14 20-14-02
Train loader length: 245
>>>>>>>>>>>>>>>>>>>> epoch:0 <<<<<<<<<<<<<<<<<<<<
Train step: 0 acc:0.25 total_loss: 1.7529  loss:1.7529,stance loss: 1.1977 
Train step: 10 acc:0.47727 total_loss: 1.5287  loss:1.2701,stance loss: 0.72437 
Better F1! Saving model!
Saving model of best f1: 0.35000000000000003
              precision    recall  f1-score   support

           0   0.538462  1.000000  0.700000       511
           1   0.000000  0.000000  0.000000       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.179487  0.333333  0.233333       949
weighted avg   0.289941  0.538462  0.376923       949

Test Acc: 0.5384615384615384 F1_ma:0.35000000000000003
Train step: 20 acc:0.47024 total_loss: 1.5727  loss:1.385,stance loss: 0.82467 
Train step: 30 acc:0.4879 total_loss: 1.5875  loss:1.4362,stance loss: 1.0071 
Train step: 40 acc:0.48628 total_loss: 1.5812  loss:1.6192,stance loss: 1.0984 
Train step: 50 acc:0.47426 total_loss: 1.5933  loss:1.6991,stance loss: 1.2053 
Train step: 60 acc:0.49385 total_loss: 1.5824  loss:1.5748,stance loss: 1.1752 
Train step: 70 acc:0.48239 total_loss: 1.5875  loss:1.9037,stance loss: 1.7338 
Train step: 80 acc:0.47994 total_loss: 1.5846  loss:1.8275,stance loss: 1.8017 
Train step: 90 acc:0.4842 total_loss: 1.5802  loss:1.6015,stance loss: 1.2708 
Better F1! Saving model!
Saving model of best f1: 0.3503097040605644
              precision    recall  f1-score   support

           0   0.540340  0.996086  0.700619       511
           1   0.285714  0.011765  0.022599       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.538462       949
   macro avg   0.275351  0.335950  0.241073       949
weighted avg   0.342134  0.538462  0.381305       949

Test Acc: 0.5384615384615384 F1_ma:0.3503097040605644
Train step: 100 acc:0.48886 total_loss: 1.5796  loss:1.8579,stance loss: 1.8352 
Better F1! Saving model!
Saving model of best f1: 0.35079255685733973
              precision    recall  f1-score   support

           0   0.541489  0.996086  0.701585       511
           1   0.444444  0.023529  0.044693       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.540569       949
   macro avg   0.328645  0.339872  0.248759       949
weighted avg   0.371187  0.540569  0.385783       949

Test Acc: 0.5405690200210748 F1_ma:0.35079255685733973
Train step: 110 acc:0.49099 total_loss: 1.5824  loss:1.5127,stance loss: 1.0893 
Train step: 120 acc:0.48915 total_loss: 1.5772  loss:1.4662,stance loss: 0.98558 
Train step: 130 acc:0.48903 total_loss: 1.5699  loss:1.473,stance loss: 1.0859 
Train step: 140 acc:0.49025 total_loss: 1.5679  loss:1.6355,stance loss: 1.2908 
Train step: 150 acc:0.49089 total_loss: 1.5688  loss:1.5249,stance loss: 1.1046 
Train step: 160 acc:0.49379 total_loss: 1.5612  loss:1.6343,stance loss: 1.4081 
Train step: 170 acc:0.49306 total_loss: 1.5563  loss:1.5145,stance loss: 1.0956 
Train step: 180 acc:0.49655 total_loss: 1.554  loss:1.6324,stance loss: 1.5167 
Train step: 190 acc:0.50033 total_loss: 1.5465  loss:1.3496,stance loss: 0.95791 
Better F1! Saving model!
Saving model of best f1: 0.3515625
              precision    recall  f1-score   support

           0   0.551839  0.968689  0.703125       511
           1   0.442308  0.135294  0.207207       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.545838       949
   macro avg   0.331382  0.367994  0.303444       949
weighted avg   0.376378  0.545838  0.415724       949

Test Acc: 0.5458377239199157 F1_ma:0.3515625
Train step: 200 acc:0.50902 total_loss: 1.5384  loss:1.1242,stance loss: 0.69626 
Better F1! Saving model!
Saving model of best f1: 0.3537771129394166
              precision    recall  f1-score   support

           0   0.572639  0.925636  0.707554       511
           1   0.512195  0.370588  0.430034       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.564805       949
   macro avg   0.361611  0.432075  0.379196       949
weighted avg   0.400097  0.564805  0.458025       949

Test Acc: 0.5648050579557429 F1_ma:0.3537771129394166
Train step: 210 acc:0.51451 total_loss: 1.5331  loss:1.4815,stance loss: 1.1152 
Better F1! Saving model!
Saving model of best f1: 0.3539694100509832
              precision    recall  f1-score   support

           0   0.563805  0.951076  0.707939       511
           1   0.517241  0.264706  0.350195       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.559536       949
   macro avg   0.360349  0.405261  0.352711       949
weighted avg   0.396244  0.559536  0.443930       949

Test Acc: 0.559536354056902 F1_ma:0.3539694100509832
Train step: 220 acc:0.51782 total_loss: 1.5279  loss:1.5022,stance loss: 1.1577 
Train step: 230 acc:0.52083 total_loss: 1.5249  loss:1.571,stance loss: 1.1917 
Train step: 240 acc:0.5236 total_loss: 1.5199  loss:1.6281,stance loss: 1.5609 
>>>>>>>>>>>>>>>>>>>> epoch:1 <<<<<<<<<<<<<<<<<<<<
Train step: 250 acc:0.65625 total_loss: 1.3129  loss:1.2207,stance loss: 0.79551 
Better F1! Saving model!
Saving model of best f1: 0.35539033457249064
              precision    recall  f1-score   support

           0   0.573141  0.935421  0.710781       511
           1   0.582609  0.394118  0.470175       170
           2   0.000000  0.000000  0.000000       268

    accuracy                       0.574289       949
   macro avg   0.385250  0.443179  0.393652       949
weighted avg   0.412981  0.574289  0.466953       949

Test Acc: 0.5742887249736565 F1_ma:0.35539033457249064
Train step: 260 acc:0.64062 total_loss: 1.3877  loss:1.42,stance loss: 1.1154 
Train step: 270 acc:0.62019 total_loss: 1.3748  loss:1.1852,stance loss: 0.79848 
Train step: 280 acc:0.625 total_loss: 1.3625  loss:1.367,stance loss: 0.98256 
Train step: 290 acc:0.61005 total_loss: 1.3683  loss:1.1459,stance loss: 0.56576 
Train step: 300 acc:0.61942 total_loss: 1.3484  loss:1.157,stance loss: 0.77027 
Train step: 310 acc:0.62595 total_loss: 1.3314  loss:1.0961,stance loss: 0.83764 
Train step: 320 acc:0.62829 total_loss: 1.3334  loss:1.4089,stance loss: 0.84514 
Train step: 330 acc:0.63227 total_loss: 1.3248  loss:1.2216,stance loss: 0.92315 
Train step: 340 acc:0.63411 total_loss: 1.3202  loss:1.0227,stance loss: 0.79966 
Train step: 350 acc:0.63325 total_loss: 1.3187  loss:1.358,stance loss: 1.123 
Train step: 360 acc:0.63685 total_loss: 1.3179  loss:1.1818,stance loss: 0.83043 
Train step: 370 acc:0.63641 total_loss: 1.3188  loss:1.2585,stance loss: 0.94285 
Train step: 380 acc:0.63603 total_loss: 1.3191  loss:1.2604,stance loss: 0.92062 
Train step: 390 acc:0.6357 total_loss: 1.3165  loss:1.0772,stance loss: 0.63971 
Train step: 400 acc:0.63782 total_loss: 1.3187  loss:1.6432,stance loss: 1.797 
Train step: 410 acc:0.64194 total_loss: 1.3134  loss:1.0791,stance loss: 0.85137 
Train step: 420 acc:0.64382 total_loss: 1.3095  loss:1.1699,stance loss: 0.90769 
Train step: 430 acc:0.64617 total_loss: 1.3078  loss:1.2917,stance loss: 0.88414 
Train step: 440 acc:0.6486 total_loss: 1.3079  loss:1.6637,stance loss: 1.7867 
Train step: 450 acc:0.65079 total_loss: 1.3012  loss:1.1193,stance loss: 0.86155 
Train step: 460 acc:0.65249 total_loss: 1.2952  loss:1.0925,stance loss: 0.8567 
Train step: 470 acc:0.65487 total_loss: 1.2892  loss:1.0198,stance loss: 0.77285 
Train step: 480 acc:0.65493 total_loss: 1.2895  loss:1.2437,stance loss: 1.1613 
>>>>>>>>>>>>>>>>>>>> epoch:2 <<<<<<<<<<<<<<<<<<<<
Train step: 490 acc:0.6875 total_loss: 1.3673  loss:1.3673,stance loss: 1.1434 
Train step: 500 acc:0.73295 total_loss: 1.1569  loss:1.1244,stance loss: 0.75204 
Train step: 510 acc:0.72321 total_loss: 1.1226  loss:1.1283,stance loss: 0.90632 
Train step: 520 acc:0.74194 total_loss: 1.1016  loss:1.1972,stance loss: 1.0331 
Train step: 530 acc:0.73171 total_loss: 1.1382  loss:1.0283,stance loss: 0.91328 
Train step: 540 acc:0.72672 total_loss: 1.1359  loss:0.82618,stance loss: 0.51054 
Train step: 550 acc:0.73258 total_loss: 1.1195  loss:1.0212,stance loss: 0.89354 
Train step: 560 acc:0.72623 total_loss: 1.124  loss:1.142,stance loss: 0.96438 
Train step: 570 acc:0.72531 total_loss: 1.1171  loss:1.4886,stance loss: 1.1438 
Train step: 580 acc:0.72184 total_loss: 1.1149  loss:0.96768,stance loss: 0.80265 
Train step: 590 acc:0.71535 total_loss: 1.1417  loss:1.2991,stance loss: 0.89154 
Train step: 600 acc:0.71453 total_loss: 1.142  loss:1.1692,stance loss: 0.90777 
Train step: 610 acc:0.71384 total_loss: 1.1407  loss:0.66639,stance loss: 0.48534 
Train step: 620 acc:0.71374 total_loss: 1.14  loss:0.81935,stance loss: 0.5685 
Train step: 630 acc:0.71365 total_loss: 1.1431  loss:1.004,stance loss: 0.72652 
Train step: 640 acc:0.7144 total_loss: 1.1401  loss:1.1074,stance loss: 0.45591 
Train step: 650 acc:0.71506 total_loss: 1.1375  loss:1.2364,stance loss: 0.98379 
Train step: 660 acc:0.71491 total_loss: 1.1436  loss:1.3827,stance loss: 1.0394 
Train step: 670 acc:0.71305 total_loss: 1.141  loss:1.2178,stance loss: 1.0302 
Train step: 680 acc:0.71531 total_loss: 1.135  loss:1.1303,stance loss: 0.95974 
Train step: 690 acc:0.71082 total_loss: 1.14  loss:0.8468,stance loss: 0.64529 
Train step: 700 acc:0.7106 total_loss: 1.136  loss:0.90007,stance loss: 0.69968 
Train step: 710 acc:0.70899 total_loss: 1.134  loss:0.93854,stance loss: 0.64628 
Train step: 720 acc:0.7086 total_loss: 1.1335  loss:1.0465,stance loss: 0.81392 
Train step: 730 acc:0.70773 total_loss: 1.1353  loss:1.2234,stance loss: 0.93066 
>>>>>>>>>>>>>>>>>>>> epoch:3 <<<<<<<<<<<<<<<<<<<<
Train step: 740 acc:0.71875 total_loss: 1.0928  loss:1.1076,stance loss: 0.85639 
Train step: 750 acc:0.72266 total_loss: 1.0481  loss:0.92401,stance loss: 0.77747 
Train step: 760 acc:0.73798 total_loss: 1.0593  loss:0.59837,stance loss: 0.41056 
Train step: 770 acc:0.72049 total_loss: 1.0827  loss:1.4166,stance loss: 1.2097 
Train step: 780 acc:0.72418 total_loss: 1.0715  loss:1.1328,stance loss: 1.01 
Train step: 790 acc:0.7154 total_loss: 1.1057  loss:1.3663,stance loss: 1.2439 
Train step: 800 acc:0.70833 total_loss: 1.1166  loss:1.0214,stance loss: 0.8026 
Train step: 810 acc:0.71382 total_loss: 1.1049  loss:1.1078,stance loss: 1.0544 
Train step: 820 acc:0.71294 total_loss: 1.099  loss:1.3167,stance loss: 1.2178 
Train step: 830 acc:0.70964 total_loss: 1.1019  loss:1.053,stance loss: 0.80195 
Train step: 840 acc:0.71167 total_loss: 1.1036  loss:0.82801,stance loss: 0.61101 
Train step: 850 acc:0.70851 total_loss: 1.1141  loss:1.1606,stance loss: 0.84387 
Train step: 860 acc:0.71181 total_loss: 1.1036  loss:1.5492,stance loss: 1.6037 
Train step: 870 acc:0.71324 total_loss: 1.0961  loss:0.67629,stance loss: 0.4786 
Train step: 880 acc:0.70848 total_loss: 1.1005  loss:1.1895,stance loss: 0.91936 
Better F1! Saving model!
Saving model of best f1: 0.3584663523668214
              precision    recall  f1-score   support

           0   0.594708  0.835616  0.694874       511
           1   0.466960  0.623529  0.534005       170
           2   0.750000  0.011194  0.022059       268

    accuracy                       0.564805       949
   macro avg   0.603889  0.490113  0.416979       949
weighted avg   0.615678  0.564805  0.476052       949

Test Acc: 0.5648050579557429 F1_ma:0.3584663523668214
Train step: 890 acc:0.71034 total_loss: 1.0955  loss:1.1079,stance loss: 0.92337 
Better F1! Saving model!
Saving model of best f1: 0.3783114160472651
              precision    recall  f1-score   support

           0   0.601527  0.771037  0.675815       511
           1   0.449057  0.700000  0.547126       170
           2   0.413793  0.044776  0.080808       268

    accuracy                       0.553214       949
   macro avg   0.488125  0.505271  0.434583       949
weighted avg   0.521197  0.553214  0.484731       949

Test Acc: 0.553213909378293 F1_ma:0.3783114160472651
Train step: 900 acc:0.71197 total_loss: 1.0921  loss:1.2129,stance loss: 0.83546 
Train step: 910 acc:0.71449 total_loss: 1.0839  loss:0.90255,stance loss: 0.54032 
Train step: 920 acc:0.71808 total_loss: 1.0856  loss:1.4857,stance loss: 1.4173 
Train step: 930 acc:0.71397 total_loss: 1.084  loss:0.90227,stance loss: 0.72224 
Train step: 940 acc:0.71238 total_loss: 1.0836  loss:1.1324,stance loss: 0.90094 
Train step: 950 acc:0.71441 total_loss: 1.0797  loss:1.2413,stance loss: 0.96895 
Train step: 960 acc:0.71654 total_loss: 1.0789  loss:1.1475,stance loss: 0.98267 
Better F1! Saving model!
Saving model of best f1: 0.3916352106296241
              precision    recall  f1-score   support

           0   0.585977  0.686888  0.632432       511
           1   0.453846  0.694118  0.548837       170
           2   0.300000  0.100746  0.150838       268

    accuracy                       0.522655       949
   macro avg   0.446608  0.493917  0.444036       949
weighted avg   0.481547  0.522655  0.481454       949

Test Acc: 0.5226554267650158 F1_ma:0.3916352106296241
Train step: 970 acc:0.7161 total_loss: 1.0777  loss:1.4094,stance loss: 1.1418 
>>>>>>>>>>>>>>>>>>>> epoch:4 <<<<<<<<<<<<<<<<<<<<
Train step: 980 acc:0.875 total_loss: 0.89948  loss:0.89948,stance loss: 0.71984 
Train step: 990 acc:0.75 total_loss: 1.1116  loss:1.4361,stance loss: 1.4519 
Train step: 1000 acc:0.75298 total_loss: 1.0291  loss:0.87463,stance loss: 0.67434 
Train step: 1010 acc:0.76815 total_loss: 1.0104  loss:0.68858,stance loss: 0.54437 
Train step: 1020 acc:0.76982 total_loss: 0.97468  loss:0.82318,stance loss: 0.62887 
Train step: 1030 acc:0.76225 total_loss: 1.0162  loss:1.2598,stance loss: 1.2188 
Train step: 1040 acc:0.7582 total_loss: 1.0236  loss:0.76376,stance loss: 0.59369 
Train step: 1050 acc:0.76144 total_loss: 1.0047  loss:0.68609,stance loss: 0.57395 
Train step: 1060 acc:0.75772 total_loss: 1.0032  loss:0.88441,stance loss: 0.79373 
Train step: 1070 acc:0.76236 total_loss: 0.99775  loss:0.75809,stance loss: 0.66252 
Train step: 1080 acc:0.76423 total_loss: 0.9903  loss:0.61866,stance loss: 0.43144 
Train step: 1090 acc:0.76745 total_loss: 0.977  loss:0.89014,stance loss: 0.93112 
Train step: 1100 acc:0.76395 total_loss: 0.97374  loss:0.76836,stance loss: 0.57527 
Train step: 1110 acc:0.76431 total_loss: 0.97887  loss:1.4438,stance loss: 1.1113 
Train step: 1120 acc:0.76463 total_loss: 0.97516  loss:0.90814,stance loss: 0.69456 
Train step: 1130 acc:0.76449 total_loss: 0.97729  loss:0.98326,stance loss: 0.75727 
Train step: 1140 acc:0.76126 total_loss: 0.98097  loss:1.2194,stance loss: 0.94669 
Train step: 1150 acc:0.76023 total_loss: 0.97674  loss:0.56915,stance loss: 0.40722 
Better F1! Saving model!
Saving model of best f1: 0.3936517896828509
              precision    recall  f1-score   support

           0   0.599251  0.626223  0.612440       511
           1   0.403785  0.752941  0.525667       170
           2   0.326531  0.119403  0.174863       268

    accuracy                       0.505796       949
   macro avg   0.443189  0.499522  0.437657       949
weighted avg   0.487219  0.505796  0.473323       949

Test Acc: 0.505795574288725 F1_ma:0.3936517896828509
Train step: 1160 acc:0.76036 total_loss: 0.97082  loss:1.0111,stance loss: 0.81343 
Train step: 1170 acc:0.76276 total_loss: 0.96646  loss:0.95527,stance loss: 1.1917 
Train step: 1180 acc:0.76493 total_loss: 0.95956  loss:0.73117,stance loss: 0.61074 
Train step: 1190 acc:0.76451 total_loss: 0.96197  loss:1.0528,stance loss: 0.79793 
Train step: 1200 acc:0.76216 total_loss: 0.9662  loss:1.0118,stance loss: 0.8564 
Train step: 1210 acc:0.7619 total_loss: 0.96472  loss:0.80953,stance loss: 0.67391 
Train step: 1220 acc:0.76245 total_loss: 0.96057  loss:1.2626,stance loss: 1.5457 
>>>>>>>>>>>>>>>>>>>> epoch:5 <<<<<<<<<<<<<<<<<<<<
Train step: 1230 acc:0.79167 total_loss: 0.81081  loss:0.70675,stance loss: 0.57798 
Train step: 1240 acc:0.78125 total_loss: 0.90584  loss:1.4151,stance loss: 0.89748 
Train step: 1250 acc:0.78125 total_loss: 0.90842  loss:0.8766,stance loss: 0.71821 
Train step: 1260 acc:0.78125 total_loss: 0.87619  loss:0.59067,stance loss: 0.40395 
Train step: 1270 acc:0.77582 total_loss: 0.86784  loss:0.96276,stance loss: 0.6558 
Train step: 1280 acc:0.78013 total_loss: 0.88972  loss:1.1511,stance loss: 1.4762 
Train step: 1290 acc:0.77557 total_loss: 0.89519  loss:1.288,stance loss: 1.1239 
Train step: 1300 acc:0.77549 total_loss: 0.88844  loss:0.91724,stance loss: 0.73788 
Train step: 1310 acc:0.77616 total_loss: 0.89324  loss:1.2468,stance loss: 1.01 
Better F1! Saving model!
Saving model of best f1: 0.3959132083421108
              precision    recall  f1-score   support

           0   0.559441  0.469667  0.510638       511
           1   0.438163  0.729412  0.547461       170
           2   0.299578  0.264925  0.281188       268

    accuracy                       0.458377       949
   macro avg   0.432394  0.488001  0.446429       949
weighted avg   0.464329  0.458377  0.452437       949

Test Acc: 0.458377239199157 F1_ma:0.3959132083421108
Train step: 1320 acc:0.77995 total_loss: 0.88857  loss:0.89279,stance loss: 0.73199 
Train step: 1330 acc:0.7783 total_loss: 0.89506  loss:1.2,stance loss: 1.4324 
Train step: 1340 acc:0.78125 total_loss: 0.89498  loss:1.4779,stance loss: 1.2467 
Train step: 1350 acc:0.78125 total_loss: 0.89529  loss:0.72597,stance loss: 0.59875 
Train step: 1360 acc:0.77987 total_loss: 0.89424  loss:0.70111,stance loss: 0.53206 
Train step: 1370 acc:0.77954 total_loss: 0.89179  loss:1.0398,stance loss: 0.78839 
Train step: 1380 acc:0.77484 total_loss: 0.90507  loss:1.0102,stance loss: 0.7833 
Train step: 1390 acc:0.77523 total_loss: 0.89991  loss:1.5386,stance loss: 1.1979 
Train step: 1400 acc:0.77308 total_loss: 0.9003  loss:1.0695,stance loss: 0.75086 
Train step: 1410 acc:0.77419 total_loss: 0.90394  loss:0.98084,stance loss: 0.86082 
Train step: 1420 acc:0.77392 total_loss: 0.90283  loss:0.77277,stance loss: 0.7336 
Train step: 1430 acc:0.77488 total_loss: 0.897  loss:1.331,stance loss: 1.5023 
Train step: 1440 acc:0.77546 total_loss: 0.89759  loss:1.2777,stance loss: 1.1576 
Better F1! Saving model!
Saving model of best f1: 0.39614872307179994
              precision    recall  f1-score   support

           0   0.564165  0.455969  0.504329       511
           1   0.420875  0.735294  0.535332       170
           2   0.305439  0.272388  0.287968       268

    accuracy                       0.454162       949
   macro avg   0.430160  0.487884  0.442543       949
weighted avg   0.465432  0.454162  0.448782       949

Test Acc: 0.4541622760800843 F1_ma:0.39614872307179994
Train step: 1450 acc:0.77793 total_loss: 0.88924  loss:0.61719,stance loss: 0.59974 
Train step: 1460 acc:0.77834 total_loss: 0.88951  loss:0.88945,stance loss: 0.73129 
>>>>>>>>>>>>>>>>>>>> epoch:6 <<<<<<<<<<<<<<<<<<<<
Train step: 1470 acc:0.625 total_loss: 1.0851  loss:1.0851,stance loss: 0.78809 
Train step: 1480 acc:0.80114 total_loss: 0.84048  loss:0.55499,stance loss: 0.47652 
Train step: 1490 acc:0.78571 total_loss: 0.81542  loss:1.1144,stance loss: 0.90934 
Better F1! Saving model!
Saving model of best f1: 0.4085388041909781
              precision    recall  f1-score   support

           0   0.566820  0.481409  0.520635       511
           1   0.422383  0.688235  0.523490       170
           2   0.315126  0.279851  0.296443       268

    accuracy                       0.461538       949
   macro avg   0.434776  0.483165  0.446856       949
weighted avg   0.469867  0.461538  0.457834       949

Test Acc: 0.46153846153846156 F1_ma:0.4085388041909781
Train step: 1500 acc:0.78226 total_loss: 0.83863  loss:0.76662,stance loss: 0.71804 
Train step: 1510 acc:0.79116 total_loss: 0.80943  loss:0.81768,stance loss: 0.6271 
Train step: 1520 acc:0.80882 total_loss: 0.79277  loss:0.90334,stance loss: 1.2022 
Train step: 1530 acc:0.81455 total_loss: 0.78627  loss:1.1438,stance loss: 1.4003 
Train step: 1540 acc:0.82042 total_loss: 0.77772  loss:0.58189,stance loss: 0.47455 
Train step: 1550 acc:0.8233 total_loss: 0.76578  loss:0.82975,stance loss: 1.0949 
Train step: 1560 acc:0.82555 total_loss: 0.76449  loss:0.89642,stance loss: 0.78708 
Train step: 1570 acc:0.82364 total_loss: 0.75591  loss:0.57527,stance loss: 0.37001 
Train step: 1580 acc:0.82095 total_loss: 0.75586  loss:0.67768,stance loss: 0.40736 
Train step: 1590 acc:0.81921 total_loss: 0.76083  loss:0.88484,stance loss: 0.68522 
Train step: 1600 acc:0.82013 total_loss: 0.75921  loss:0.79058,stance loss: 0.67096 
Train step: 1610 acc:0.82092 total_loss: 0.75908  loss:0.71741,stance loss: 0.59281 
Train step: 1620 acc:0.82285 total_loss: 0.75557  loss:0.67525,stance loss: 0.38201 
Train step: 1630 acc:0.82415 total_loss: 0.75321  loss:0.38589,stance loss: 0.34782 
Train step: 1640 acc:0.82164 total_loss: 0.75755  loss:0.51141,stance loss: 0.44385 
Train step: 1650 acc:0.81837 total_loss: 0.7742  loss:1.3713,stance loss: 1.3287 
Train step: 1660 acc:0.82035 total_loss: 0.77277  loss:0.95005,stance loss: 1.284 
Train step: 1670 acc:0.81965 total_loss: 0.77053  loss:0.58981,stance loss: 0.43109 
Train step: 1680 acc:0.81813 total_loss: 0.77346  loss:1.3988,stance loss: 1.5407 
Train step: 1690 acc:0.81816 total_loss: 0.77456  loss:1.3372,stance loss: 0.94999 
Train step: 1700 acc:0.81872 total_loss: 0.7705  loss:0.93045,stance loss: 0.91342 
Train step: 1710 acc:0.8195 total_loss: 0.76949  loss:1.4362,stance loss: 1.4288 
>>>>>>>>>>>>>>>>>>>> epoch:7 <<<<<<<<<<<<<<<<<<<<
Train step: 1720 acc:0.82292 total_loss: 0.78988  loss:1.2533,stance loss: 1.5728 
Train step: 1730 acc:0.80469 total_loss: 0.75813  loss:0.75618,stance loss: 0.62327 
Better F1! Saving model!
Saving model of best f1: 0.41315792828278963
              precision    recall  f1-score   support

           0   0.564315  0.532290  0.547835       511
           1   0.417625  0.641176  0.505800       170
           2   0.320388  0.246269  0.278481       268

    accuracy                       0.471022       949
   macro avg   0.434109  0.473245  0.444039       949
weighted avg   0.469152  0.471022  0.464239       949

Test Acc: 0.47102212855637515 F1_ma:0.41315792828278963
Train step: 1740 acc:0.84135 total_loss: 0.69697  loss:1.0178,stance loss: 1.3323 
Train step: 1750 acc:0.84028 total_loss: 0.67878  loss:0.74294,stance loss: 0.70852 
Train step: 1760 acc:0.85054 total_loss: 0.67426  loss:0.61243,stance loss: 0.38441 
Train step: 1770 acc:0.85491 total_loss: 0.65645  loss:0.41781,stance loss: 0.28269 
Train step: 1780 acc:0.85606 total_loss: 0.65439  loss:0.60414,stance loss: 0.46673 
Train step: 1790 acc:0.86349 total_loss: 0.63016  loss:0.70857,stance loss: 0.52311 
Train step: 1800 acc:0.85901 total_loss: 0.6322  loss:0.31438,stance loss: 0.23093 
Train step: 1810 acc:0.85156 total_loss: 0.65118  loss:1.1848,stance loss: 0.74437 
Train step: 1820 acc:0.85259 total_loss: 0.65112  loss:0.51812,stance loss: 0.40179 
Train step: 1830 acc:0.8556 total_loss: 0.65049  loss:1.1687,stance loss: 0.65466 
Train step: 1840 acc:0.85218 total_loss: 0.65689  loss:0.54416,stance loss: 0.41164 
Train step: 1850 acc:0.85478 total_loss: 0.65106  loss:0.60078,stance loss: 0.38558 
Train step: 1860 acc:0.85231 total_loss: 0.6536  loss:0.4811,stance loss: 0.37259 
Train step: 1870 acc:0.85216 total_loss: 0.65482  loss:0.76663,stance loss: 0.58577 
Train step: 1880 acc:0.85429 total_loss: 0.65008  loss:0.49166,stance loss: 0.3741 
Train step: 1890 acc:0.8544 total_loss: 0.64639  loss:0.32711,stance loss: 0.19801 
Train step: 1900 acc:0.85114 total_loss: 0.65205  loss:0.88223,stance loss: 0.47312 
Train step: 1910 acc:0.85236 total_loss: 0.64707  loss:0.51976,stance loss: 0.35011 
Train step: 1920 acc:0.85498 total_loss: 0.64245  loss:0.33967,stance loss: 0.29151 
Train step: 1930 acc:0.85417 total_loss: 0.64754  loss:0.62485,stance loss: 0.51962 
Train step: 1940 acc:0.85647 total_loss: 0.64348  loss:0.42166,stance loss: 0.31468 
Train step: 1950 acc:0.85514 total_loss: 0.64634  loss:0.89256,stance loss: 1.3116 
>>>>>>>>>>>>>>>>>>>> epoch:8 <<<<<<<<<<<<<<<<<<<<
Train step: 1960 acc:0.75 total_loss: 1.1208  loss:1.1208,stance loss: 1.2274 
Train step: 1970 acc:0.85795 total_loss: 0.69771  loss:0.60148,stance loss: 0.3729 
Train step: 1980 acc:0.86905 total_loss: 0.58774  loss:0.52181,stance loss: 0.43989 
Train step: 1990 acc:0.86089 total_loss: 0.59932  loss:0.8174,stance loss: 1.0742 
Train step: 2000 acc:0.86585 total_loss: 0.58439  loss:1.0474,stance loss: 1.0467 
Train step: 2010 acc:0.87377 total_loss: 0.56687  loss:0.85003,stance loss: 1.0672 
Train step: 2020 acc:0.87398 total_loss: 0.56685  loss:0.77222,stance loss: 0.72581 
Train step: 2030 acc:0.87324 total_loss: 0.56213  loss:0.12337,stance loss: 0.032149 
Train step: 2040 acc:0.87269 total_loss: 0.55217  loss:0.23051,stance loss: 0.1493 
Train step: 2050 acc:0.87431 total_loss: 0.54301  loss:0.57008,stance loss: 0.43129 
Train step: 2060 acc:0.87809 total_loss: 0.53862  loss:0.33773,stance loss: 0.27127 
Train step: 2070 acc:0.87275 total_loss: 0.55036  loss:0.566,stance loss: 0.53914 
Train step: 2080 acc:0.87345 total_loss: 0.56406  loss:0.46955,stance loss: 0.4367 
Train step: 2090 acc:0.87309 total_loss: 0.56638  loss:0.19283,stance loss: 0.084155 
Train step: 2100 acc:0.875 total_loss: 0.5571  loss:0.5885,stance loss: 0.51 
Train step: 2110 acc:0.87583 total_loss: 0.55992  loss:0.50739,stance loss: 0.33743 
Train step: 2120 acc:0.87772 total_loss: 0.55505  loss:0.55272,stance loss: 0.44555 
Train step: 2130 acc:0.87829 total_loss: 0.55194  loss:0.32275,stance loss: 0.22912 
Train step: 2140 acc:0.87742 total_loss: 0.55328  loss:0.68277,stance loss: 0.56665 
Train step: 2150 acc:0.87827 total_loss: 0.55323  loss:0.21006,stance loss: 0.12302 
Train step: 2160 acc:0.87593 total_loss: 0.56043  loss:0.3751,stance loss: 0.3038 
Train step: 2170 acc:0.87767 total_loss: 0.55761  loss:0.71868,stance loss: 0.64832 
Train step: 2180 acc:0.87839 total_loss: 0.55565  loss:0.6907,stance loss: 0.63687 
Train step: 2190 acc:0.87852 total_loss: 0.5619  loss:0.25319,stance loss: 0.17581 
Train step: 2200 acc:0.87863 total_loss: 0.55998  loss:0.39831,stance loss: 0.28728 
>>>>>>>>>>>>>>>>>>>> epoch:9 <<<<<<<<<<<<<<<<<<<<
Train step: 2210 acc:0.9375 total_loss: 0.36517  loss:0.60293,stance loss: 0.52103 
Train step: 2220 acc:0.90625 total_loss: 0.50769  loss:0.1925,stance loss: 0.112 
Train step: 2230 acc:0.90625 total_loss: 0.46782  loss:0.1605,stance loss: 0.098444 
Train step: 2240 acc:0.90625 total_loss: 0.4532  loss:0.32389,stance loss: 0.27879 
Train step: 2250 acc:0.91033 total_loss: 0.44159  loss:0.34117,stance loss: 0.21251 
Train step: 2260 acc:0.91183 total_loss: 0.43525  loss:0.45938,stance loss: 0.44207 
Train step: 2270 acc:0.91004 total_loss: 0.45353  loss:0.6745,stance loss: 0.49427 
Train step: 2280 acc:0.91201 total_loss: 0.4586  loss:0.43213,stance loss: 0.20837 
Train step: 2290 acc:0.91352 total_loss: 0.4522  loss:0.99305,stance loss: 0.88106 
Train step: 2300 acc:0.91341 total_loss: 0.44954  loss:0.56879,stance loss: 1.0098 
Train step: 2310 acc:0.91038 total_loss: 0.46876  loss:0.53493,stance loss: 0.47471 
Train step: 2320 acc:0.91002 total_loss: 0.46497  loss:0.46095,stance loss: 0.30124 
Train step: 2330 acc:0.90724 total_loss: 0.47569  loss:0.67096,stance loss: 1.0825 
Train step: 2340 acc:0.90717 total_loss: 0.47956  loss:1.7933,stance loss: 2.1271 
Train step: 2350 acc:0.90625 total_loss: 0.48163  loss:0.23871,stance loss: 0.12714 
Train step: 2360 acc:0.90665 total_loss: 0.486  loss:0.8731,stance loss: 0.88772 
Train step: 2370 acc:0.90776 total_loss: 0.48235  loss:0.84372,stance loss: 1.228 
Better F1! Saving model!
Saving model of best f1: 0.4179833285971394
              precision    recall  f1-score   support

           0   0.614251  0.489237  0.544662       511
           1   0.371429  0.764706  0.500000       170
           2   0.348958  0.250000  0.291304       268

    accuracy                       0.471022       949
   macro avg   0.444879  0.501314  0.445322       949
weighted avg   0.495833  0.471022  0.465113       949

Test Acc: 0.47102212855637515 F1_ma:0.4179833285971394
Train step: 2380 acc:0.90767 total_loss: 0.47914  loss:0.55311,stance loss: 0.4856 
Train step: 2390 acc:0.90759 total_loss: 0.47786  loss:0.43982,stance loss: 0.24893 
Train step: 2400 acc:0.90657 total_loss: 0.47792  loss:0.35553,stance loss: 0.34588 
Train step: 2410 acc:0.90625 total_loss: 0.48053  loss:0.36192,stance loss: 0.25871 
Train step: 2420 acc:0.90509 total_loss: 0.48176  loss:0.26567,stance loss: 0.24545 
Train step: 2430 acc:0.90265 total_loss: 0.48436  loss:0.69997,stance loss: 1.0575 
Train step: 2440 acc:0.90148 total_loss: 0.48774  loss:0.6109,stance loss: 0.49648 
>>>>>>>>>>>>>>>>>>>> epoch:10 <<<<<<<<<<<<<<<<<<<<
Train step: 2450 acc:0.9375 total_loss: 0.26795  loss:0.26795,stance loss: 0.17986 
Train step: 2460 acc:0.9375 total_loss: 0.34336  loss:0.29093,stance loss: 0.28984 
Train step: 2470 acc:0.91964 total_loss: 0.32932  loss:0.26372,stance loss: 0.21768 
Train step: 2480 acc:0.91129 total_loss: 0.37319  loss:1.1089,stance loss: 1.0829 
Train step: 2490 acc:0.92073 total_loss: 0.35698  loss:0.38444,stance loss: 0.2767 
Train step: 2500 acc:0.92034 total_loss: 0.36043  loss:0.7969,stance loss: 0.7849 
Train step: 2510 acc:0.91598 total_loss: 0.37404  loss:0.61873,stance loss: 0.49918 
Train step: 2520 acc:0.91373 total_loss: 0.38595  loss:0.15814,stance loss: 0.056308 
Train step: 2530 acc:0.91667 total_loss: 0.38129  loss:0.55636,stance loss: 0.40197 
Train step: 2540 acc:0.91415 total_loss: 0.39541  loss:0.45079,stance loss: 0.30776 
Train step: 2550 acc:0.91399 total_loss: 0.39769  loss:0.57295,stance loss: 0.40715 
Train step: 2560 acc:0.9161 total_loss: 0.39744  loss:0.97981,stance loss: 1.3974 
Train step: 2570 acc:0.91581 total_loss: 0.40251  loss:0.46261,stance loss: 0.43952 
Train step: 2580 acc:0.91794 total_loss: 0.40823  loss:0.11681,stance loss: 0.074302 
Train step: 2590 acc:0.92154 total_loss: 0.40859  loss:0.22781,stance loss: 0.18716 
Train step: 2600 acc:0.92012 total_loss: 0.40942  loss:0.27946,stance loss: 0.1964 
Train step: 2610 acc:0.92197 total_loss: 0.40885  loss:0.60151,stance loss: 0.63235 
Train step: 2620 acc:0.92325 total_loss: 0.40597  loss:0.85439,stance loss: 0.67825 
Train step: 2630 acc:0.92265 total_loss: 0.40202  loss:0.19989,stance loss: 0.033448 
Train step: 2640 acc:0.92114 total_loss: 0.40363  loss:0.24647,stance loss: 0.10661 
Train step: 2650 acc:0.92164 total_loss: 0.40105  loss:0.4562,stance loss: 0.39997 
Train step: 2660 acc:0.9215 total_loss: 0.40691  loss:0.21006,stance loss: 0.091514 
Better F1! Saving model!
Saving model of best f1: 0.4255208143753261
              precision    recall  f1-score   support

           0   0.562241  0.530333  0.545821       511
           1   0.443038  0.617647  0.515971       170
           2   0.330435  0.283582  0.305221       268

    accuracy                       0.476291       949
   macro avg   0.445238  0.477187  0.455671       949
weighted avg   0.475425  0.476291  0.472527       949

Test Acc: 0.47629083245521603 F1_ma:0.4255208143753261
Train step: 2670 acc:0.92138 total_loss: 0.41279  loss:0.77446,stance loss: 0.66296 
Train step: 2680 acc:0.92154 total_loss: 0.40866  loss:0.25378,stance loss: 0.24963 
Train step: 2690 acc:0.92012 total_loss: 0.4121  loss:0.49829,stance loss: 0.41286 
>>>>>>>>>>>>>>>>>>>> epoch:11 <<<<<<<<<<<<<<<<<<<<
Train step: 2700 acc:0.96875 total_loss: 0.21999  loss:0.1906,stance loss: 0.14121 
Train step: 2710 acc:0.94141 total_loss: 0.36615  loss:1.1917,stance loss: 1.3604 
Train step: 2720 acc:0.94712 total_loss: 0.32487  loss:0.18718,stance loss: 0.11046 
Train step: 2730 acc:0.93924 total_loss: 0.34163  loss:0.49563,stance loss: 0.28075 
Train step: 2740 acc:0.94565 total_loss: 0.33996  loss:0.22506,stance loss: 0.02444 
Train step: 2750 acc:0.94531 total_loss: 0.3487  loss:0.39657,stance loss: 0.2457 
Train step: 2760 acc:0.94223 total_loss: 0.35081  loss:0.25125,stance loss: 0.080093 
Train step: 2770 acc:0.94079 total_loss: 0.35583  loss:0.045124,stance loss: 0.01093 
Train step: 2780 acc:0.94331 total_loss: 0.35218  loss:0.17405,stance loss: 0.15474 
Train step: 2790 acc:0.94076 total_loss: 0.36317  loss:0.6858,stance loss: 1.0315 
Train step: 2800 acc:0.9434 total_loss: 0.35601  loss:0.25509,stance loss: 0.16763 
Train step: 2810 acc:0.9445 total_loss: 0.34904  loss:0.039948,stance loss: 0.00097413 
Train step: 2820 acc:0.94444 total_loss: 0.34646  loss:0.12049,stance loss: 0.082557 
Train step: 2830 acc:0.94485 total_loss: 0.34718  loss:0.13087,stance loss: 0.013069 
Train step: 2840 acc:0.9405 total_loss: 0.35521  loss:0.25288,stance loss: 0.21922 
Train step: 2850 acc:0.9399 total_loss: 0.35996  loss:0.15702,stance loss: 0.1267 
Train step: 2860 acc:0.93825 total_loss: 0.37041  loss:0.38426,stance loss: 0.3313 
Train step: 2870 acc:0.93821 total_loss: 0.36647  loss:0.19775,stance loss: 0.10721 
Train step: 2880 acc:0.9375 total_loss: 0.36992  loss:0.42248,stance loss: 0.3487 
Train step: 2890 acc:0.93622 total_loss: 0.372  loss:0.20478,stance loss: 0.16072 
Train step: 2900 acc:0.93447 total_loss: 0.37582  loss:0.2441,stance loss: 0.16582 
Train step: 2910 acc:0.93432 total_loss: 0.37511  loss:0.15484,stance loss: 0.056733 
Train step: 2920 acc:0.93612 total_loss: 0.37208  loss:0.2783,stance loss: 0.21532 
Train step: 2930 acc:0.93591 total_loss: 0.36832  loss:0.21766,stance loss: 0.19448 
>>>>>>>>>>>>>>>>>>>> epoch:12 <<<<<<<<<<<<<<<<<<<<
Train step: 2940 acc:1.0 total_loss: 0.58015  loss:0.58015,stance loss: 1.0134 
Train step: 2950 acc:0.96023 total_loss: 0.33519  loss:0.091884,stance loss: 0.061903 
Train step: 2960 acc:0.95833 total_loss: 0.35903  loss:0.34582,stance loss: 0.23604 
Train step: 2970 acc:0.97177 total_loss: 0.32163  loss:0.6025,stance loss: 1.0551 
Train step: 2980 acc:0.96951 total_loss: 0.30892  loss:0.047802,stance loss: 0.013398 
Train step: 2990 acc:0.96201 total_loss: 0.3253  loss:0.044169,stance loss: 0.0025846 
Train step: 3000 acc:0.96414 total_loss: 0.31247  loss:0.12157,stance loss: 0.022498 
Train step: 3010 acc:0.96039 total_loss: 0.32167  loss:0.88764,stance loss: 1.1033 
Train step: 3020 acc:0.9591 total_loss: 0.32394  loss:0.31662,stance loss: 0.25496 
Train step: 3030 acc:0.96291 total_loss: 0.31135  loss:0.93245,stance loss: 0.95497 
Train step: 3040 acc:0.95978 total_loss: 0.31127  loss:0.087472,stance loss: 0.054431 
Train step: 3050 acc:0.95721 total_loss: 0.32132  loss:0.096453,stance loss: 0.033925 
Train step: 3060 acc:0.95764 total_loss: 0.31987  loss:0.1033,stance loss: 0.044642 
Train step: 3070 acc:0.95515 total_loss: 0.32716  loss:0.39488,stance loss: 0.36091 
Train step: 3080 acc:0.95301 total_loss: 0.32589  loss:0.57367,stance loss: 0.35998 
Train step: 3090 acc:0.95157 total_loss: 0.32935  loss:0.55781,stance loss: 1.0133 
Train step: 3100 acc:0.95109 total_loss: 0.32377  loss:0.036144,stance loss: 0.0043922 
Train step: 3110 acc:0.95066 total_loss: 0.32174  loss:0.57668,stance loss: 1.0291 
Train step: 3120 acc:0.94993 total_loss: 0.32751  loss:1.4047,stance loss: 1.7758 
Train step: 3130 acc:0.94961 total_loss: 0.32444  loss:0.16259,stance loss: 0.071246 
Train step: 3140 acc:0.94838 total_loss: 0.32983  loss:0.12741,stance loss: 0.12797 
Train step: 3150 acc:0.94905 total_loss: 0.32635  loss:0.27785,stance loss: 0.19274 
Train step: 3160 acc:0.9491 total_loss: 0.32568  loss:0.28226,stance loss: 0.17455 
Train step: 3170 acc:0.94913 total_loss: 0.3283  loss:0.32577,stance loss: 0.19003 
Train step: 3180 acc:0.94917 total_loss: 0.32459  loss:0.13729,stance loss: 0.064656 
>>>>>>>>>>>>>>>>>>>> epoch:13 <<<<<<<<<<<<<<<<<<<<
Train step: 3190 acc:0.95833 total_loss: 0.41952  loss:0.6211,stance loss: 1.021 
Train step: 3200 acc:0.95312 total_loss: 0.33173  loss:0.049286,stance loss: 0.013822 
Train step: 3210 acc:0.95433 total_loss: 0.31161  loss:0.1806,stance loss: 0.098832 
Train step: 3220 acc:0.96007 total_loss: 0.28316  loss:0.2599,stance loss: 0.16632 
Train step: 3230 acc:0.96196 total_loss: 0.26498  loss:0.12587,stance loss: 0.069617 
Train step: 3240 acc:0.96094 total_loss: 0.27177  loss:0.26003,stance loss: 0.25986 
Train step: 3250 acc:0.96023 total_loss: 0.28032  loss:0.21415,stance loss: 0.16058 
Train step: 3260 acc:0.96135 total_loss: 0.26447  loss:0.11601,stance loss: 0.069091 
Train step: 3270 acc:0.96003 total_loss: 0.2731  loss:0.55457,stance loss: 1.0122 
Train step: 3280 acc:0.95964 total_loss: 0.26389  loss:0.070109,stance loss: 0.051535 
Train step: 3290 acc:0.9605 total_loss: 0.25409  loss:0.098425,stance loss: 0.043493 
Train step: 3300 acc:0.95905 total_loss: 0.26635  loss:0.13616,stance loss: 0.11737 
Train step: 3310 acc:0.95784 total_loss: 0.2729  loss:0.62764,stance loss: 0.44681 
Train step: 3320 acc:0.95772 total_loss: 0.27378  loss:0.066298,stance loss: 0.046055 
Train step: 3330 acc:0.95762 total_loss: 0.27058  loss:0.31629,stance loss: 0.25711 
Train step: 3340 acc:0.95673 total_loss: 0.26906  loss:0.43785,stance loss: 0.40167 
Train step: 3350 acc:0.95595 total_loss: 0.26615  loss:0.12542,stance loss: 0.061333 
Train step: 3360 acc:0.95561 total_loss: 0.27081  loss:0.55261,stance loss: 1.0143 
Train step: 3370 acc:0.95598 total_loss: 0.27296  loss:0.071606,stance loss: 0.033173 
Train step: 3380 acc:0.9544 total_loss: 0.27608  loss:0.27713,stance loss: 0.27679 
Train step: 3390 acc:0.9557 total_loss: 0.26885  loss:0.25998,stance loss: 0.22417 
Train step: 3400 acc:0.95573 total_loss: 0.26829  loss:0.43969,stance loss: 0.329 
Train step: 3410 acc:0.95741 total_loss: 0.26291  loss:0.67223,stance loss: 1.1472 
Train step: 3420 acc:0.95683 total_loss: 0.26799  loss:0.067451,stance loss: 0.011649 
>>>>>>>>>>>>>>>>>>>> epoch:14 <<<<<<<<<<<<<<<<<<<<
Train step: 3430 acc:0.875 total_loss: 0.38395  loss:0.38395,stance loss: 0.37312 
Train step: 3440 acc:0.96023 total_loss: 0.22968  loss:0.041028,stance loss: 0.0034364 
Better F1! Saving model!
Saving model of best f1: 0.43120060067289123
              precision    recall  f1-score   support

           0   0.559242  0.461840  0.505895       511
           1   0.418803  0.576471  0.485149       170
           2   0.341297  0.373134  0.356506       268

    accuracy                       0.457323       949
   macro avg   0.439781  0.470481  0.449183       949
weighted avg   0.472536  0.457323  0.459991       949

Test Acc: 0.45732349841938885 F1_ma:0.43120060067289123
Train step: 3450 acc:0.95536 total_loss: 0.23657  loss:0.43771,stance loss: 0.3469 
Train step: 3460 acc:0.94758 total_loss: 0.26702  loss:0.56295,stance loss: 0.39981 
Train step: 3470 acc:0.95427 total_loss: 0.28581  loss:0.060928,stance loss: 0.014381 
Train step: 3480 acc:0.95833 total_loss: 0.27491  loss:0.15692,stance loss: 0.063067 
Train step: 3490 acc:0.96107 total_loss: 0.25507  loss:0.15511,stance loss: 0.10356 
Train step: 3500 acc:0.95775 total_loss: 0.27018  loss:0.37631,stance loss: 0.33721 
Train step: 3510 acc:0.96065 total_loss: 0.2617  loss:0.08706,stance loss: 0.041742 
Train step: 3520 acc:0.96223 total_loss: 0.25024  loss:0.23985,stance loss: 0.13044 
Train step: 3530 acc:0.96349 total_loss: 0.25729  loss:0.1575,stance loss: 0.058347 
Train step: 3540 acc:0.96453 total_loss: 0.25115  loss:0.098728,stance loss: 0.066015 
Train step: 3550 acc:0.96643 total_loss: 0.24813  loss:0.084063,stance loss: 0.049794 
Train step: 3560 acc:0.96803 total_loss: 0.24331  loss:0.095752,stance loss: 0.027184 
Train step: 3570 acc:0.96809 total_loss: 0.24633  loss:0.20288,stance loss: 0.18531 
Better F1! Saving model!
Saving model of best f1: 0.43462801388497985
              precision    recall  f1-score   support

           0   0.601124  0.628180  0.614354       511
           1   0.389091  0.629412  0.480899       170
           2   0.371429  0.194030  0.254902       268

    accuracy                       0.505796       949
   macro avg   0.453881  0.483874  0.450052       949
weighted avg   0.498274  0.505796  0.488937       949

Test Acc: 0.505795574288725 F1_ma:0.43462801388497985
Train step: 3580 acc:0.96772 total_loss: 0.23906  loss:0.16273,stance loss: 0.12746 
Train step: 3590 acc:0.96739 total_loss: 0.2467  loss:0.46487,stance loss: 0.42066 
Train step: 3600 acc:0.96747 total_loss: 0.24205  loss:0.3503,stance loss: 0.35915 
Train step: 3610 acc:0.96547 total_loss: 0.24498  loss:0.3619,stance loss: 0.17274 
Train step: 3620 acc:0.96466 total_loss: 0.24925  loss:0.54664,stance loss: 1.0118 
Train step: 3630 acc:0.96362 total_loss: 0.24922  loss:0.031569,stance loss: 0.0077894 
Train step: 3640 acc:0.96475 total_loss: 0.24203  loss:0.050598,stance loss: 0.0088759 
Train step: 3650 acc:0.96521 total_loss: 0.24295  loss:0.2331,stance loss: 0.19084 
Train step: 3660 acc:0.96564 total_loss: 0.24046  loss:0.15259,stance loss: 0.057454 
Train step: 3670 acc:0.96655 total_loss: 0.24161  loss:0.68914,stance loss: 1.0852 
Training finished.


Reload the best model with best f1 0.43462801388497985 from path test_outputs/bert-cross-topic/fm/2023-08-14 20-14-02/state_dict


              precision    recall  f1-score   support

           0   0.601124  0.628180  0.614354       511
           1   0.389091  0.629412  0.480899       170
           2   0.371429  0.194030  0.254902       268

    accuracy                       0.505796       949
   macro avg   0.453881  0.483874  0.450052       949
weighted avg   0.498274  0.505796  0.488937       949

Test Acc: 0.505795574288725 F1_ma:0.43462801388497985
Test dataset: fm
Model: bert-cross-topic
#################### Final results: ####################
F1 avg (Con & Pro): 0.43462801388497985
acc: 0.505795574288725, f1 :0.450051634724818
classification report: 
              precision    recall  f1-score   support

         Con     0.6011    0.6282    0.6144       511
        None     0.3891    0.6294    0.4809       170
         Pro     0.3714    0.1940    0.2549       268

    accuracy                         0.5058       949
   macro avg     0.4539    0.4839    0.4501       949
weighted avg     0.4983    0.5058    0.4889       949

